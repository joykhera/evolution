{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.649596242314924, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.259338235855102, "policy_loss": -0.004938187518048657, "vf_loss": 8.262618587887477, "vf_explained_var": 0.008794079350415991, "kl": 0.008289241858450402, "entropy": 1.6011869585703289, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0397796481217025, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.371690545006404, "policy_loss": -0.0045251283917832315, "vf_loss": 4.375092397165046, "vf_explained_var": 0.0020327394286160745, "kl": 0.005616382717746197, "entropy": 1.6038747943898357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": 211.4, "episode_reward_min": -157.20000000000078, "episode_reward_mean": 44.54444444444421, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 3600, "policy_reward_min": {"prey_policy": -264.70000000000016, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.7, "predator_policy": 177.0}, "policy_reward_mean": {"prey_policy": -12.47777777777786, "predator_policy": 34.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [211.4, 136.29999999999868, 90.29999999999995, 176.19999999999965, -110.00000000000031, 196.99999999999932, 28.900000000000116, -36.699999999999996, -107.30000000000024, 35.400000000000155, 55.49999999999952, 59.20000000000005, 185.6999999999998, 66.09999999999972, -89.0, 1.0, -157.20000000000078, 59.00000000000012], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [27.200000000000067, 141.19999999999996, 27.200000000000138, 109.09999999999943, -103.90000000000074, 135.1999999999996, 131.29999999999993, -21.100000000000154, -6.099999999999831, -250.9, 5.299999999999966, 184.7, 20.000000000000014, -6.100000000000005, 20.000000000000014, -138.70000000000059, -264.70000000000016, -61.60000000000015, 7.399999999999979, -48.99999999999994, 64.3999999999997, -121.89999999999984, 82.09999999999995, -61.899999999999935, 84.80000000000014, 95.89999999999989, 20.000000000000014, 10.10000000000003, 0.0, -178.0, -124.0, 63.0, -214.60000000000025, -121.60000000000011, 20.000000000000014, 25.999999999999964], "policy_predator_policy_reward": [23.0, 20.0, 0.0, 0.0, 59.0, 0.0, 10.0, 56.0, 22.0, 125.0, 0.0, 7.0, 15.0, 0.0, 0.0, 82.0, 52.0, 167.0, 63.0, 14.0, 37.0, 76.0, 0.0, 39.0, 0.0, 5.0, 13.0, 23.0, 0.0, 89.0, 62.0, 0.0, 2.0, 177.0, 13.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.334467818241394, "mean_inference_ms": 3.4153307657408454, "mean_action_processing_ms": 0.501077162313351, "mean_env_wait_ms": 0.48145356205005563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006994936201307509, "StateBufferConnector_ms": 0.05988478660583496, "ViewRequirementAgentConnector_ms": 0.1666883627573649}, "num_episodes": 18, "episode_return_max": 211.4, "episode_return_min": -157.20000000000078, "episode_return_mean": 44.54444444444421, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 125.0553170902703, "num_env_steps_trained_throughput_per_sec": 125.0553170902703, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 31985.853, "restore_workers_time_ms": 0.017, "training_step_time_ms": 31985.801, "sample_time_ms": 2725.896, "learn_time_ms": 29235.596, "learn_throughput": 136.82, "synch_weights_time_ms": 18.293}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 1, "trial_id": "e4caa_00000", "date": "2024-08-13_19-44-49", "timestamp": 1723592689, "time_this_iter_s": 32.07788801193237, "time_total_s": 32.07788801193237, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0324af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.07788801193237, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 92.97608695652173, "ram_util_percent": 84.02826086956522}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.236290606194072, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.25570454168572, "policy_loss": -0.001458347139131061, "vf_loss": 8.255699330536777, "vf_explained_var": 0.006097722905022757, "kl": 0.00731788557147817, "entropy": 1.5912200696253902, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1076880308213057, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.011981376516756, "policy_loss": -0.007249074068201322, "vf_loss": 4.017530820357106, "vf_explained_var": 0.009715750797715767, "kl": 0.008498123313382318, "entropy": 1.6006699322392701, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 270.7000000000003, "episode_reward_min": -157.20000000000078, "episode_reward_mean": 71.4861111111109, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 7200, "policy_reward_min": {"prey_policy": -305.1, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.7, "predator_policy": 177.0}, "policy_reward_mean": {"prey_policy": 1.659722222222148, "predator_policy": 34.083333333333336}, "custom_metrics": {}, "hist_stats": {"episode_reward": [211.4, 136.29999999999868, 90.29999999999995, 176.19999999999965, -110.00000000000031, 196.99999999999932, 28.900000000000116, -36.699999999999996, -107.30000000000024, 35.400000000000155, 55.49999999999952, 59.20000000000005, 185.6999999999998, 66.09999999999972, -89.0, 1.0, -157.20000000000078, 59.00000000000012, 146.0999999999996, 25.60000000000003, 205.39999999999975, 7.400000000000187, 165.0999999999991, 238.39999999999978, -127.00000000000003, 84.79999999999998, 19.399999999999977, 70.49999999999935, 147.49999999999963, 52.10000000000008, 43.499999999999915, 200.19999999999897, 108.0, 144.0, -29.999999999999986, 270.7000000000003], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [27.200000000000067, 141.19999999999996, 27.200000000000138, 109.09999999999943, -103.90000000000074, 135.1999999999996, 131.29999999999993, -21.100000000000154, -6.099999999999831, -250.9, 5.299999999999966, 184.7, 20.000000000000014, -6.100000000000005, 20.000000000000014, -138.70000000000059, -264.70000000000016, -61.60000000000015, 7.399999999999979, -48.99999999999994, 64.3999999999997, -121.89999999999984, 82.09999999999995, -61.899999999999935, 84.80000000000014, 95.89999999999989, 20.000000000000014, 10.10000000000003, 0.0, -178.0, -124.0, 63.0, -214.60000000000025, -121.60000000000011, 20.000000000000014, 25.999999999999964, 84.49999999999989, 11.599999999999987, -173.50000000000003, 52.1, 124.69999999999976, 25.699999999999918, -156.1000000000003, 42.50000000000012, 1.0999999999999617, 154.99999999999977, 138.80000000000004, 74.60000000000002, -4.900000000000006, -305.1, 18.20000000000003, -9.399999999999961, -80.50000000000054, -3.1000000000000294, 20.000000000000014, 9.500000000000018, -18.100000000000065, 113.59999999999957, 107.29999999999997, -146.20000000000027, 67.69999999999995, -110.20000000000009, 40.7000000000002, 159.49999999999974, 108.0, 0.0, 113.0, 31.0, -205.30000000000004, 23.299999999999976, 118.0999999999999, 140.60000000000002], "policy_predator_policy_reward": [23.0, 20.0, 0.0, 0.0, 59.0, 0.0, 10.0, 56.0, 22.0, 125.0, 0.0, 7.0, 15.0, 0.0, 0.0, 82.0, 52.0, 167.0, 63.0, 14.0, 37.0, 76.0, 0.0, 39.0, 0.0, 5.0, 13.0, 23.0, 0.0, 89.0, 62.0, 0.0, 2.0, 177.0, 13.0, 0.0, 39.0, 11.0, 101.0, 46.0, 0.0, 55.0, 60.0, 61.0, 9.0, 0.0, 0.0, 25.0, 23.0, 160.0, 35.0, 41.0, 42.0, 61.0, 38.0, 3.0, 36.0, 16.0, 75.0, 16.0, 0.0, 86.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 104.0, 48.0, 0.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3906811410326756, "mean_inference_ms": 3.5833240892934253, "mean_action_processing_ms": 0.540461214409325, "mean_env_wait_ms": 0.47899080704153235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009732445081075033, "StateBufferConnector_ms": 0.034654471609327525, "ViewRequirementAgentConnector_ms": 0.2668483389748467}, "num_episodes": 18, "episode_return_max": 270.7000000000003, "episode_return_min": -157.20000000000078, "episode_return_mean": 71.4861111111109, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 194.8836413743435, "num_env_steps_trained_throughput_per_sec": 194.8836413743435, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 26255.539, "restore_workers_time_ms": 0.334, "training_step_time_ms": 26255.053, "sample_time_ms": 2952.992, "learn_time_ms": 23278.818, "learn_throughput": 171.83, "synch_weights_time_ms": 18.265}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 2, "trial_id": "e4caa_00000", "date": "2024-08-13_19-45-13", "timestamp": 1723592713, "time_this_iter_s": 20.635723114013672, "time_total_s": 52.713611125946045, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03241f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 52.713611125946045, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 82.81875000000001, "ram_util_percent": 83.990625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5589574371538464, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.350849072138469, "policy_loss": -0.0009114788973299914, "vf_loss": 6.351069561388127, "vf_explained_var": 0.0052009386991066905, "kl": 0.0034549393214618578, "entropy": 1.5957516084272394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1330213906588378, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5772876263926268, "policy_loss": -0.004823441933052092, "vf_loss": 3.580685207957313, "vf_explained_var": 0.014512131201527107, "kl": 0.007129301289331987, "entropy": 1.593015502180372, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 270.7000000000003, "episode_reward_min": -157.20000000000078, "episode_reward_mean": 72.93888888888866, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 10800, "policy_reward_min": {"prey_policy": -305.1, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.7, "predator_policy": 177.0}, "policy_reward_mean": {"prey_policy": 6.858333333333262, "predator_policy": 29.61111111111111}, "custom_metrics": {}, "hist_stats": {"episode_reward": [211.4, 136.29999999999868, 90.29999999999995, 176.19999999999965, -110.00000000000031, 196.99999999999932, 28.900000000000116, -36.699999999999996, -107.30000000000024, 35.400000000000155, 55.49999999999952, 59.20000000000005, 185.6999999999998, 66.09999999999972, -89.0, 1.0, -157.20000000000078, 59.00000000000012, 146.0999999999996, 25.60000000000003, 205.39999999999975, 7.400000000000187, 165.0999999999991, 238.39999999999978, -127.00000000000003, 84.79999999999998, 19.399999999999977, 70.49999999999935, 147.49999999999963, 52.10000000000008, 43.499999999999915, 200.19999999999897, 108.0, 144.0, -29.999999999999986, 270.7000000000003, 38.9000000000003, -61.4999999999998, 126.59999999999921, 14.199999999999939, -4.89999999999983, 54.60000000000044, 109.69999999999918, 153.39999999999915, 83.89999999999947, 167.59999999999857, 144.49999999999858, 170.19999999999928, 124.19999999999959, 84.49999999999989, -11.0, 117.0, 13.299999999999986, 40.0000000000003], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [27.200000000000067, 141.19999999999996, 27.200000000000138, 109.09999999999943, -103.90000000000074, 135.1999999999996, 131.29999999999993, -21.100000000000154, -6.099999999999831, -250.9, 5.299999999999966, 184.7, 20.000000000000014, -6.100000000000005, 20.000000000000014, -138.70000000000059, -264.70000000000016, -61.60000000000015, 7.399999999999979, -48.99999999999994, 64.3999999999997, -121.89999999999984, 82.09999999999995, -61.899999999999935, 84.80000000000014, 95.89999999999989, 20.000000000000014, 10.10000000000003, 0.0, -178.0, -124.0, 63.0, -214.60000000000025, -121.60000000000011, 20.000000000000014, 25.999999999999964, 84.49999999999989, 11.599999999999987, -173.50000000000003, 52.1, 124.69999999999976, 25.699999999999918, -156.1000000000003, 42.50000000000012, 1.0999999999999617, 154.99999999999977, 138.80000000000004, 74.60000000000002, -4.900000000000006, -305.1, 18.20000000000003, -9.399999999999961, -80.50000000000054, -3.1000000000000294, 20.000000000000014, 9.500000000000018, -18.100000000000065, 113.59999999999957, 107.29999999999997, -146.20000000000027, 67.69999999999995, -110.20000000000009, 40.7000000000002, 159.49999999999974, 108.0, 0.0, 113.0, 31.0, -205.30000000000004, 23.299999999999976, 118.0999999999999, 140.60000000000002, 20.000000000000014, 17.899999999999977, -61.59999999999996, -118.89999999999999, 76.09999999999968, 42.50000000000018, 18.500000000000057, -112.3000000000003, -115.60000000000001, 16.699999999999964, 17.000000000000004, 11.600000000000001, 37.70000000000013, 56.00000000000011, 49.69999999999993, 76.69999999999929, -0.9999999999999846, 74.89999999999976, 111.49999999999946, 55.10000000000022, 60.20000000000015, 71.29999999999968, 82.99999999999955, 81.19999999999987, 47.3, 47.900000000000226, 18.500000000000092, 20.000000000000014, 11.0, -171.0, 0.0, 92.0, -64.30000000000035, 11.599999999999946, 20.000000000000014, 20.000000000000014], "policy_predator_policy_reward": [23.0, 20.0, 0.0, 0.0, 59.0, 0.0, 10.0, 56.0, 22.0, 125.0, 0.0, 7.0, 15.0, 0.0, 0.0, 82.0, 52.0, 167.0, 63.0, 14.0, 37.0, 76.0, 0.0, 39.0, 0.0, 5.0, 13.0, 23.0, 0.0, 89.0, 62.0, 0.0, 2.0, 177.0, 13.0, 0.0, 39.0, 11.0, 101.0, 46.0, 0.0, 55.0, 60.0, 61.0, 9.0, 0.0, 0.0, 25.0, 23.0, 160.0, 35.0, 41.0, 42.0, 61.0, 38.0, 3.0, 36.0, 16.0, 75.0, 16.0, 0.0, 86.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 104.0, 48.0, 0.0, 12.0, 1.0, 0.0, 0.0, 119.0, 8.0, 0.0, 58.0, 50.0, 66.0, 28.0, 22.0, 4.0, 0.0, 16.0, 27.0, 0.0, 0.0, 10.0, 0.0, 1.0, 13.0, 0.0, 0.0, 6.0, 2.0, 27.0, 31.0, 15.0, 82.0, 67.0, 3.0, 22.0, 35.0, 31.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4005859725759793, "mean_inference_ms": 3.5843516329477527, "mean_action_processing_ms": 0.5480788266521744, "mean_env_wait_ms": 0.4740313104632302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008986614368580005, "StateBufferConnector_ms": 0.02669338826779966, "ViewRequirementAgentConnector_ms": 0.2328985267215305}, "num_episodes": 18, "episode_return_max": 270.7000000000003, "episode_return_min": -157.20000000000078, "episode_return_mean": 72.93888888888866, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.65495885419844, "num_env_steps_trained_throughput_per_sec": 246.65495885419844, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 22909.358, "restore_workers_time_ms": 0.229, "training_step_time_ms": 22909.017, "sample_time_ms": 2859.549, "learn_time_ms": 20029.413, "learn_throughput": 199.706, "synch_weights_time_ms": 16.175}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 3, "trial_id": "e4caa_00000", "date": "2024-08-13_19-45-30", "timestamp": 1723592730, "time_this_iter_s": 16.270185947418213, "time_total_s": 68.98379707336426, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0324dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 68.98379707336426, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 80.98695652173912, "ram_util_percent": 83.90869565217393}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.200757121834805, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.58247070211582, "policy_loss": -0.000877313266592051, "vf_loss": 6.582330859905828, "vf_explained_var": -0.000702970336984705, "kl": 0.010171609719615093, "entropy": 1.5725240001602778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4588727318735981, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.062450847802339, "policy_loss": -0.004490998238029461, "vf_loss": 5.0656304729047905, "vf_explained_var": 0.01444673427829036, "kl": 0.006556884268392723, "entropy": 1.579161299725689, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": 270.7000000000003, "episode_reward_min": -198.10000000000005, "episode_reward_mean": 59.80833333333312, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 14400, "policy_reward_min": {"prey_policy": -305.1, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.7, "predator_policy": 177.0}, "policy_reward_mean": {"prey_policy": -0.7138888888889636, "predator_policy": 30.618055555555557}, "custom_metrics": {}, "hist_stats": {"episode_reward": [211.4, 136.29999999999868, 90.29999999999995, 176.19999999999965, -110.00000000000031, 196.99999999999932, 28.900000000000116, -36.699999999999996, -107.30000000000024, 35.400000000000155, 55.49999999999952, 59.20000000000005, 185.6999999999998, 66.09999999999972, -89.0, 1.0, -157.20000000000078, 59.00000000000012, 146.0999999999996, 25.60000000000003, 205.39999999999975, 7.400000000000187, 165.0999999999991, 238.39999999999978, -127.00000000000003, 84.79999999999998, 19.399999999999977, 70.49999999999935, 147.49999999999963, 52.10000000000008, 43.499999999999915, 200.19999999999897, 108.0, 144.0, -29.999999999999986, 270.7000000000003, 38.9000000000003, -61.4999999999998, 126.59999999999921, 14.199999999999939, -4.89999999999983, 54.60000000000044, 109.69999999999918, 153.39999999999915, 83.89999999999947, 167.59999999999857, 144.49999999999858, 170.19999999999928, 124.19999999999959, 84.49999999999989, -11.0, 117.0, 13.299999999999986, 40.0000000000003, 51.000000000000206, 40.0000000000003, 167.7999999999995, 49.39999999999982, -150.50000000000014, -10.900000000000006, -19.499999999999645, 164.39999999999915, 56.20000000000046, -27.899999999999814, 67.39999999999904, -13.400000000000007, -198.10000000000005, 1.9000000000000765, 25.0, -9.0, 103.19999999999985, 70.49999999999889], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [27.200000000000067, 141.19999999999996, 27.200000000000138, 109.09999999999943, -103.90000000000074, 135.1999999999996, 131.29999999999993, -21.100000000000154, -6.099999999999831, -250.9, 5.299999999999966, 184.7, 20.000000000000014, -6.100000000000005, 20.000000000000014, -138.70000000000059, -264.70000000000016, -61.60000000000015, 7.399999999999979, -48.99999999999994, 64.3999999999997, -121.89999999999984, 82.09999999999995, -61.899999999999935, 84.80000000000014, 95.89999999999989, 20.000000000000014, 10.10000000000003, 0.0, -178.0, -124.0, 63.0, -214.60000000000025, -121.60000000000011, 20.000000000000014, 25.999999999999964, 84.49999999999989, 11.599999999999987, -173.50000000000003, 52.1, 124.69999999999976, 25.699999999999918, -156.1000000000003, 42.50000000000012, 1.0999999999999617, 154.99999999999977, 138.80000000000004, 74.60000000000002, -4.900000000000006, -305.1, 18.20000000000003, -9.399999999999961, -80.50000000000054, -3.1000000000000294, 20.000000000000014, 9.500000000000018, -18.100000000000065, 113.59999999999957, 107.29999999999997, -146.20000000000027, 67.69999999999995, -110.20000000000009, 40.7000000000002, 159.49999999999974, 108.0, 0.0, 113.0, 31.0, -205.30000000000004, 23.299999999999976, 118.0999999999999, 140.60000000000002, 20.000000000000014, 17.899999999999977, -61.59999999999996, -118.89999999999999, 76.09999999999968, 42.50000000000018, 18.500000000000057, -112.3000000000003, -115.60000000000001, 16.699999999999964, 17.000000000000004, 11.600000000000001, 37.70000000000013, 56.00000000000011, 49.69999999999993, 76.69999999999929, -0.9999999999999846, 74.89999999999976, 111.49999999999946, 55.10000000000022, 60.20000000000015, 71.29999999999968, 82.99999999999955, 81.19999999999987, 47.3, 47.900000000000226, 18.500000000000092, 20.000000000000014, 11.0, -171.0, 0.0, 92.0, -64.30000000000035, 11.599999999999946, 20.000000000000014, 20.000000000000014, -73.00000000000038, 67.99999999999969, 20.000000000000014, 20.000000000000014, 82.10000000000012, 40.69999999999993, 61.69999999999989, -91.30000000000022, -96.69999999999996, -188.80000000000052, -42.99999999999977, -64.90000000000012, -95.50000000000061, 20.000000000000014, 22.700000000000173, 124.69999999999985, 20.90000000000003, 35.300000000000225, 21.499999999999993, -138.40000000000026, 34.09999999999937, -78.69999999999999, -91.30000000000004, -30.09999999999983, -101.80000000000005, -217.30000000000013, -3.100000000000042, -61.00000000000027, -11.0, 0.0, -50.0, -44.0, -107.50000000000041, 124.70000000000005, -11.500000000000037, 59.000000000000185], "policy_predator_policy_reward": [23.0, 20.0, 0.0, 0.0, 59.0, 0.0, 10.0, 56.0, 22.0, 125.0, 0.0, 7.0, 15.0, 0.0, 0.0, 82.0, 52.0, 167.0, 63.0, 14.0, 37.0, 76.0, 0.0, 39.0, 0.0, 5.0, 13.0, 23.0, 0.0, 89.0, 62.0, 0.0, 2.0, 177.0, 13.0, 0.0, 39.0, 11.0, 101.0, 46.0, 0.0, 55.0, 60.0, 61.0, 9.0, 0.0, 0.0, 25.0, 23.0, 160.0, 35.0, 41.0, 42.0, 61.0, 38.0, 3.0, 36.0, 16.0, 75.0, 16.0, 0.0, 86.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 104.0, 48.0, 0.0, 12.0, 1.0, 0.0, 0.0, 119.0, 8.0, 0.0, 58.0, 50.0, 66.0, 28.0, 22.0, 4.0, 0.0, 16.0, 27.0, 0.0, 0.0, 10.0, 0.0, 1.0, 13.0, 0.0, 0.0, 6.0, 2.0, 27.0, 31.0, 15.0, 82.0, 67.0, 3.0, 22.0, 35.0, 31.0, 0.0, 0.0, 56.0, 0.0, 0.0, 0.0, 0.0, 45.0, 53.0, 26.0, 0.0, 135.0, 27.0, 70.0, 1.0, 55.0, 10.0, 7.0, 0.0, 0.0, 84.0, 5.0, 69.0, 43.0, 66.0, 42.0, 121.0, 0.0, 14.0, 52.0, 17.0, 19.0, 45.0, 40.0, 45.0, 41.0, 8.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4143121710273954, "mean_inference_ms": 3.589803781843999, "mean_action_processing_ms": 0.5534354291207325, "mean_env_wait_ms": 0.47528166337230243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04516707526312934, "StateBufferConnector_ms": 0.021079348193274602, "ViewRequirementAgentConnector_ms": 0.22821095254686144}, "num_episodes": 18, "episode_return_max": 270.7000000000003, "episode_return_min": -198.10000000000005, "episode_return_mean": 59.80833333333312, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 236.442533999962, "num_env_steps_trained_throughput_per_sec": 236.442533999962, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 21411.378, "restore_workers_time_ms": 0.175, "training_step_time_ms": 21411.112, "sample_time_ms": 2898.056, "learn_time_ms": 18479.341, "learn_throughput": 216.458, "synch_weights_time_ms": 30.519}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 4, "trial_id": "e4caa_00000", "date": "2024-08-13_19-45-47", "timestamp": 1723592747, "time_this_iter_s": 17.029337882995605, "time_total_s": 86.01313495635986, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b283fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 86.01313495635986, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 78.82916666666667, "ram_util_percent": 83.47083333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2061434809177642, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.005404359196859, "policy_loss": -0.0026867476939938214, "vf_loss": 4.0068858948964925, "vf_explained_var": -0.0028731625231485517, "kl": 0.012052112450074383, "entropy": 1.5564807772005678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4789358958838479, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.304715531969827, "policy_loss": -0.006057847829821406, "vf_loss": 2.3091265295548413, "vf_explained_var": 0.017266976581048712, "kl": 0.008234225327218788, "entropy": 1.5648625603428594, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 270.7000000000003, "episode_reward_min": -231.20000000000118, "episode_reward_mean": 49.46969696969674, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 19800, "policy_reward_min": {"prey_policy": -305.1, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 184.7, "predator_policy": 179.0}, "policy_reward_mean": {"prey_policy": -5.866161616161692, "predator_policy": 30.6010101010101}, "custom_metrics": {}, "hist_stats": {"episode_reward": [211.4, 136.29999999999868, 90.29999999999995, 176.19999999999965, -110.00000000000031, 196.99999999999932, 28.900000000000116, -36.699999999999996, -107.30000000000024, 35.400000000000155, 55.49999999999952, 59.20000000000005, 185.6999999999998, 66.09999999999972, -89.0, 1.0, -157.20000000000078, 59.00000000000012, 146.0999999999996, 25.60000000000003, 205.39999999999975, 7.400000000000187, 165.0999999999991, 238.39999999999978, -127.00000000000003, 84.79999999999998, 19.399999999999977, 70.49999999999935, 147.49999999999963, 52.10000000000008, 43.499999999999915, 200.19999999999897, 108.0, 144.0, -29.999999999999986, 270.7000000000003, 38.9000000000003, -61.4999999999998, 126.59999999999921, 14.199999999999939, -4.89999999999983, 54.60000000000044, 109.69999999999918, 153.39999999999915, 83.89999999999947, 167.59999999999857, 144.49999999999858, 170.19999999999928, 124.19999999999959, 84.49999999999989, -11.0, 117.0, 13.299999999999986, 40.0000000000003, 51.000000000000206, 40.0000000000003, 167.7999999999995, 49.39999999999982, -150.50000000000014, -10.900000000000006, -19.499999999999645, 164.39999999999915, 56.20000000000046, -27.899999999999814, 67.39999999999904, -13.400000000000007, -198.10000000000005, 1.9000000000000765, 25.0, -9.0, 103.19999999999985, 70.49999999999889, -139.00000000000074, 74.69999999999965, 96.89999999999972, -7.399999999999855, -231.20000000000118, 77.89999999999992, 160.19999999999877, 40.0000000000003, 101.09999999999854, -80.70000000000005, -10.599999999999815, -24.999999999999545, 135.79999999999893, 64.70000000000037, 97.59999999999815, 42.200000000000045, -8.799999999999931, 41.00000000000032, 40.30000000000016, 1.499999999999971, -15.199999999999557, -121.0, -10.0, 6.0, 187.8999999999991, 35.70000000000024, 36.70000000000024], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [27.200000000000067, 141.19999999999996, 27.200000000000138, 109.09999999999943, -103.90000000000074, 135.1999999999996, 131.29999999999993, -21.100000000000154, -6.099999999999831, -250.9, 5.299999999999966, 184.7, 20.000000000000014, -6.100000000000005, 20.000000000000014, -138.70000000000059, -264.70000000000016, -61.60000000000015, 7.399999999999979, -48.99999999999994, 64.3999999999997, -121.89999999999984, 82.09999999999995, -61.899999999999935, 84.80000000000014, 95.89999999999989, 20.000000000000014, 10.10000000000003, 0.0, -178.0, -124.0, 63.0, -214.60000000000025, -121.60000000000011, 20.000000000000014, 25.999999999999964, 84.49999999999989, 11.599999999999987, -173.50000000000003, 52.1, 124.69999999999976, 25.699999999999918, -156.1000000000003, 42.50000000000012, 1.0999999999999617, 154.99999999999977, 138.80000000000004, 74.60000000000002, -4.900000000000006, -305.1, 18.20000000000003, -9.399999999999961, -80.50000000000054, -3.1000000000000294, 20.000000000000014, 9.500000000000018, -18.100000000000065, 113.59999999999957, 107.29999999999997, -146.20000000000027, 67.69999999999995, -110.20000000000009, 40.7000000000002, 159.49999999999974, 108.0, 0.0, 113.0, 31.0, -205.30000000000004, 23.299999999999976, 118.0999999999999, 140.60000000000002, 20.000000000000014, 17.899999999999977, -61.59999999999996, -118.89999999999999, 76.09999999999968, 42.50000000000018, 18.500000000000057, -112.3000000000003, -115.60000000000001, 16.699999999999964, 17.000000000000004, 11.600000000000001, 37.70000000000013, 56.00000000000011, 49.69999999999993, 76.69999999999929, -0.9999999999999846, 74.89999999999976, 111.49999999999946, 55.10000000000022, 60.20000000000015, 71.29999999999968, 82.99999999999955, 81.19999999999987, 47.3, 47.900000000000226, 18.500000000000092, 20.000000000000014, 11.0, -171.0, 0.0, 92.0, -64.30000000000035, 11.599999999999946, 20.000000000000014, 20.000000000000014, -73.00000000000038, 67.99999999999969, 20.000000000000014, 20.000000000000014, 82.10000000000012, 40.69999999999993, 61.69999999999989, -91.30000000000022, -96.69999999999996, -188.80000000000052, -42.99999999999977, -64.90000000000012, -95.50000000000061, 20.000000000000014, 22.700000000000173, 124.69999999999985, 20.90000000000003, 35.300000000000225, 21.499999999999993, -138.40000000000026, 34.09999999999937, -78.69999999999999, -91.30000000000004, -30.09999999999983, -101.80000000000005, -217.30000000000013, -3.100000000000042, -61.00000000000027, -11.0, 0.0, -50.0, -44.0, -107.50000000000041, 124.70000000000005, -11.500000000000037, 59.000000000000185, -64.00000000000003, -241.00000000000037, 20.000000000000014, 43.70000000000017, 15.799999999999946, 46.099999999999994, 20.000000000000014, -72.40000000000055, -242.50000000000043, -120.70000000000056, 91.39999999999992, -95.50000000000054, 25.700000000000124, 132.49999999999957, 20.000000000000014, 20.000000000000014, 71.8999999999996, 15.199999999999969, -184.90000000000018, -233.8, -124.30000000000047, 31.70000000000021, -59.50000000000008, -29.49999999999976, 99.79999999999967, 20.000000000000014, -0.4000000000000383, 40.100000000000215, 53.30000000000023, 44.300000000000246, 13.999999999999988, -80.80000000000031, -74.80000000000024, 20.000000000000014, 7.999999999999973, 20.000000000000014, 34.40000000000007, -87.10000000000011, -99.1000000000003, -30.399999999999757, -87.10000000000082, 20.900000000000027, -211.0, -70.0, -4.0, -16.0, 0.0, 4.0, 164.89999999999984, 20.000000000000014, -3.099999999999958, 21.80000000000004, 20.000000000000014, 13.699999999999966], "policy_predator_policy_reward": [23.0, 20.0, 0.0, 0.0, 59.0, 0.0, 10.0, 56.0, 22.0, 125.0, 0.0, 7.0, 15.0, 0.0, 0.0, 82.0, 52.0, 167.0, 63.0, 14.0, 37.0, 76.0, 0.0, 39.0, 0.0, 5.0, 13.0, 23.0, 0.0, 89.0, 62.0, 0.0, 2.0, 177.0, 13.0, 0.0, 39.0, 11.0, 101.0, 46.0, 0.0, 55.0, 60.0, 61.0, 9.0, 0.0, 0.0, 25.0, 23.0, 160.0, 35.0, 41.0, 42.0, 61.0, 38.0, 3.0, 36.0, 16.0, 75.0, 16.0, 0.0, 86.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 104.0, 48.0, 0.0, 12.0, 1.0, 0.0, 0.0, 119.0, 8.0, 0.0, 58.0, 50.0, 66.0, 28.0, 22.0, 4.0, 0.0, 16.0, 27.0, 0.0, 0.0, 10.0, 0.0, 1.0, 13.0, 0.0, 0.0, 6.0, 2.0, 27.0, 31.0, 15.0, 82.0, 67.0, 3.0, 22.0, 35.0, 31.0, 0.0, 0.0, 56.0, 0.0, 0.0, 0.0, 0.0, 45.0, 53.0, 26.0, 0.0, 135.0, 27.0, 70.0, 1.0, 55.0, 10.0, 7.0, 0.0, 0.0, 84.0, 5.0, 69.0, 43.0, 66.0, 42.0, 121.0, 0.0, 14.0, 52.0, 17.0, 19.0, 45.0, 40.0, 45.0, 41.0, 8.0, 15.0, 126.0, 40.0, 0.0, 11.0, 33.0, 2.0, 12.0, 33.0, 0.0, 132.0, 3.0, 79.0, 0.0, 2.0, 0.0, 0.0, 14.0, 0.0, 179.0, 159.0, 13.0, 69.0, 37.0, 27.0, 16.0, 0.0, 8.0, 17.0, 0.0, 0.0, 54.0, 55.0, 46.0, 0.0, 13.0, 0.0, 31.0, 62.0, 46.0, 85.0, 0.0, 51.0, 73.0, 87.0, 10.0, 0.0, 0.0, 2.0, 0.0, 3.0, 0.0, 17.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.418519483549962, "mean_inference_ms": 3.584437903146862, "mean_action_processing_ms": 0.5537231375625483, "mean_env_wait_ms": 0.4769335600346782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036450949582186615, "StateBufferConnector_ms": 0.016257497999403212, "ViewRequirementAgentConnector_ms": 0.22462859298243668}, "num_episodes": 27, "episode_return_max": 270.7000000000003, "episode_return_min": -231.20000000000118, "episode_return_mean": 49.46969696969674, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 236.53394496856325, "num_env_steps_trained_throughput_per_sec": 236.53394496856325, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 20511.285, "restore_workers_time_ms": 0.146, "training_step_time_ms": 20511.057, "sample_time_ms": 2851.31, "learn_time_ms": 17624.74, "learn_throughput": 226.954, "synch_weights_time_ms": 32.171}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 5, "trial_id": "e4caa_00000", "date": "2024-08-13_19-46-04", "timestamp": 1723592764, "time_this_iter_s": 16.959216833114624, "time_total_s": 102.97235178947449, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03a4280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 102.97235178947449, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 78.28750000000001, "ram_util_percent": 83.575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9736124158220947, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.329382132727003, "policy_loss": -0.004073629698533782, "vf_loss": 6.332364426971113, "vf_explained_var": 0.0066833343770768905, "kl": 0.010913161354178658, "entropy": 1.536297205768565, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.253430955056791, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.085821712332428, "policy_loss": -0.007212776641321994, "vf_loss": 4.0911433462112665, "vf_explained_var": 0.044599159243245604, "kl": 0.009455705714731973, "entropy": 1.5494480771362467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 270.7000000000003, "episode_reward_min": -409.89999999999907, "episode_reward_mean": 37.031999999999805, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -332.0000000000002, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 164.89999999999984, "predator_policy": 222.0}, "policy_reward_mean": {"prey_policy": -13.189000000000078, "predator_policy": 31.705}, "custom_metrics": {}, "hist_stats": {"episode_reward": [59.00000000000012, 146.0999999999996, 25.60000000000003, 205.39999999999975, 7.400000000000187, 165.0999999999991, 238.39999999999978, -127.00000000000003, 84.79999999999998, 19.399999999999977, 70.49999999999935, 147.49999999999963, 52.10000000000008, 43.499999999999915, 200.19999999999897, 108.0, 144.0, -29.999999999999986, 270.7000000000003, 38.9000000000003, -61.4999999999998, 126.59999999999921, 14.199999999999939, -4.89999999999983, 54.60000000000044, 109.69999999999918, 153.39999999999915, 83.89999999999947, 167.59999999999857, 144.49999999999858, 170.19999999999928, 124.19999999999959, 84.49999999999989, -11.0, 117.0, 13.299999999999986, 40.0000000000003, 51.000000000000206, 40.0000000000003, 167.7999999999995, 49.39999999999982, -150.50000000000014, -10.900000000000006, -19.499999999999645, 164.39999999999915, 56.20000000000046, -27.899999999999814, 67.39999999999904, -13.400000000000007, -198.10000000000005, 1.9000000000000765, 25.0, -9.0, 103.19999999999985, 70.49999999999889, -139.00000000000074, 74.69999999999965, 96.89999999999972, -7.399999999999855, -231.20000000000118, 77.89999999999992, 160.19999999999877, 40.0000000000003, 101.09999999999854, -80.70000000000005, -10.599999999999815, -24.999999999999545, 135.79999999999893, 64.70000000000037, 97.59999999999815, 42.200000000000045, -8.799999999999931, 41.00000000000032, 40.30000000000016, 1.499999999999971, -15.199999999999557, -121.0, -10.0, 6.0, 187.8999999999991, 35.70000000000024, 36.70000000000024, 63.70000000000024, -100.50000000000063, 93.99999999999834, -45.79999999999996, 41.40000000000019, 40.90000000000031, 60.00000000000036, -8.899999999999816, 64.09999999999947, 29.800000000000175, -289.5000000000002, 84.59999999999897, -127.60000000000036, 85.39999999999921, 28.0, -51.0, -10.19999999999973, -409.89999999999907], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.000000000000014, 25.999999999999964, 84.49999999999989, 11.599999999999987, -173.50000000000003, 52.1, 124.69999999999976, 25.699999999999918, -156.1000000000003, 42.50000000000012, 1.0999999999999617, 154.99999999999977, 138.80000000000004, 74.60000000000002, -4.900000000000006, -305.1, 18.20000000000003, -9.399999999999961, -80.50000000000054, -3.1000000000000294, 20.000000000000014, 9.500000000000018, -18.100000000000065, 113.59999999999957, 107.29999999999997, -146.20000000000027, 67.69999999999995, -110.20000000000009, 40.7000000000002, 159.49999999999974, 108.0, 0.0, 113.0, 31.0, -205.30000000000004, 23.299999999999976, 118.0999999999999, 140.60000000000002, 20.000000000000014, 17.899999999999977, -61.59999999999996, -118.89999999999999, 76.09999999999968, 42.50000000000018, 18.500000000000057, -112.3000000000003, -115.60000000000001, 16.699999999999964, 17.000000000000004, 11.600000000000001, 37.70000000000013, 56.00000000000011, 49.69999999999993, 76.69999999999929, -0.9999999999999846, 74.89999999999976, 111.49999999999946, 55.10000000000022, 60.20000000000015, 71.29999999999968, 82.99999999999955, 81.19999999999987, 47.3, 47.900000000000226, 18.500000000000092, 20.000000000000014, 11.0, -171.0, 0.0, 92.0, -64.30000000000035, 11.599999999999946, 20.000000000000014, 20.000000000000014, -73.00000000000038, 67.99999999999969, 20.000000000000014, 20.000000000000014, 82.10000000000012, 40.69999999999993, 61.69999999999989, -91.30000000000022, -96.69999999999996, -188.80000000000052, -42.99999999999977, -64.90000000000012, -95.50000000000061, 20.000000000000014, 22.700000000000173, 124.69999999999985, 20.90000000000003, 35.300000000000225, 21.499999999999993, -138.40000000000026, 34.09999999999937, -78.69999999999999, -91.30000000000004, -30.09999999999983, -101.80000000000005, -217.30000000000013, -3.100000000000042, -61.00000000000027, -11.0, 0.0, -50.0, -44.0, -107.50000000000041, 124.70000000000005, -11.500000000000037, 59.000000000000185, -64.00000000000003, -241.00000000000037, 20.000000000000014, 43.70000000000017, 15.799999999999946, 46.099999999999994, 20.000000000000014, -72.40000000000055, -242.50000000000043, -120.70000000000056, 91.39999999999992, -95.50000000000054, 25.700000000000124, 132.49999999999957, 20.000000000000014, 20.000000000000014, 71.8999999999996, 15.199999999999969, -184.90000000000018, -233.8, -124.30000000000047, 31.70000000000021, -59.50000000000008, -29.49999999999976, 99.79999999999967, 20.000000000000014, -0.4000000000000383, 40.100000000000215, 53.30000000000023, 44.300000000000246, 13.999999999999988, -80.80000000000031, -74.80000000000024, 20.000000000000014, 7.999999999999973, 20.000000000000014, 34.40000000000007, -87.10000000000011, -99.1000000000003, -30.399999999999757, -87.10000000000082, 20.900000000000027, -211.0, -70.0, -4.0, -16.0, 0.0, 4.0, 164.89999999999984, 20.000000000000014, -3.099999999999958, 21.80000000000004, 20.000000000000014, 13.699999999999966, 17.00000000000007, 34.700000000000095, 13.699999999999946, -242.20000000000036, 55.10000000000022, 38.900000000000254, -101.80000000000032, -22.000000000000043, 59.600000000000065, -110.20000000000022, 20.000000000000014, 20.900000000000027, 20.000000000000014, -12.999999999999913, 41.89999999999956, -227.80000000000024, 33.50000000000014, -6.400000000000016, -226.60000000000002, 70.39999999999972, -242.50000000000003, -232.00000000000043, 61.70000000000019, 20.900000000000027, -99.7000000000008, -219.9000000000001, 56.90000000000011, 21.50000000000025, 28.0, 0.0, 31.0, -178.0, 28.1, -91.3000000000005, -332.0000000000002, -299.9000000000001], "policy_predator_policy_reward": [13.0, 0.0, 39.0, 11.0, 101.0, 46.0, 0.0, 55.0, 60.0, 61.0, 9.0, 0.0, 0.0, 25.0, 23.0, 160.0, 35.0, 41.0, 42.0, 61.0, 38.0, 3.0, 36.0, 16.0, 75.0, 16.0, 0.0, 86.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 104.0, 48.0, 0.0, 12.0, 1.0, 0.0, 0.0, 119.0, 8.0, 0.0, 58.0, 50.0, 66.0, 28.0, 22.0, 4.0, 0.0, 16.0, 27.0, 0.0, 0.0, 10.0, 0.0, 1.0, 13.0, 0.0, 0.0, 6.0, 2.0, 27.0, 31.0, 15.0, 82.0, 67.0, 3.0, 22.0, 35.0, 31.0, 0.0, 0.0, 56.0, 0.0, 0.0, 0.0, 0.0, 45.0, 53.0, 26.0, 0.0, 135.0, 27.0, 70.0, 1.0, 55.0, 10.0, 7.0, 0.0, 0.0, 84.0, 5.0, 69.0, 43.0, 66.0, 42.0, 121.0, 0.0, 14.0, 52.0, 17.0, 19.0, 45.0, 40.0, 45.0, 41.0, 8.0, 15.0, 126.0, 40.0, 0.0, 11.0, 33.0, 2.0, 12.0, 33.0, 0.0, 132.0, 3.0, 79.0, 0.0, 2.0, 0.0, 0.0, 14.0, 0.0, 179.0, 159.0, 13.0, 69.0, 37.0, 27.0, 16.0, 0.0, 8.0, 17.0, 0.0, 0.0, 54.0, 55.0, 46.0, 0.0, 13.0, 0.0, 31.0, 62.0, 46.0, 85.0, 0.0, 51.0, 73.0, 87.0, 10.0, 0.0, 0.0, 2.0, 0.0, 3.0, 0.0, 17.0, 0.0, 3.0, 12.0, 0.0, 128.0, 0.0, 0.0, 0.0, 45.0, 33.0, 61.0, 31.0, 0.0, 0.0, 40.0, 13.0, 79.0, 98.0, 5.0, 32.0, 77.0, 109.0, 0.0, 185.0, 2.0, 0.0, 6.0, 186.0, 7.0, 0.0, 0.0, 0.0, 0.0, 96.0, 0.0, 53.0, 0.0, 222.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.430210565333362, "mean_inference_ms": 3.6019922720590314, "mean_action_processing_ms": 0.5603786231959235, "mean_env_wait_ms": 0.4734615496788008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.035703301429748535, "StateBufferConnector_ms": 0.005961775779724121, "ViewRequirementAgentConnector_ms": 0.2622191905975342}, "num_episodes": 18, "episode_return_max": 270.7000000000003, "episode_return_min": -409.89999999999907, "episode_return_mean": 37.031999999999805, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 122.49751645816949, "num_env_steps_trained_throughput_per_sec": 122.49751645816949, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 22535.028, "restore_workers_time_ms": 0.127, "training_step_time_ms": 22534.823, "sample_time_ms": 2805.268, "learn_time_ms": 19694.173, "learn_throughput": 203.106, "synch_weights_time_ms": 31.858}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 6, "trial_id": "e4caa_00000", "date": "2024-08-13_19-46-37", "timestamp": 1723592797, "time_this_iter_s": 32.80395293235779, "time_total_s": 135.77630472183228, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b02c5ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 135.77630472183228, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 92.41521739130435, "ram_util_percent": 84.78260869565219}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6307230353828461, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.07342553466716, "policy_loss": -0.004574749723234505, "vf_loss": 8.0768195719946, "vf_explained_var": 0.00777941557465407, "kl": 0.011807082405139996, "entropy": 1.511363797528403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5440460929794917, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.519448459211481, "policy_loss": -0.008117447419230032, "vf_loss": 7.525390257658782, "vf_explained_var": 0.02974177876477519, "kl": 0.010878296711087955, "entropy": 1.5221938136393431, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "env_runners": {"episode_reward_max": 270.7000000000003, "episode_reward_min": -409.89999999999907, "episode_reward_mean": 2.847999999999828, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -332.0000000000002, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 164.89999999999984, "predator_policy": 222.0}, "policy_reward_mean": {"prey_policy": -37.95600000000006, "predator_policy": 39.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [270.7000000000003, 38.9000000000003, -61.4999999999998, 126.59999999999921, 14.199999999999939, -4.89999999999983, 54.60000000000044, 109.69999999999918, 153.39999999999915, 83.89999999999947, 167.59999999999857, 144.49999999999858, 170.19999999999928, 124.19999999999959, 84.49999999999989, -11.0, 117.0, 13.299999999999986, 40.0000000000003, 51.000000000000206, 40.0000000000003, 167.7999999999995, 49.39999999999982, -150.50000000000014, -10.900000000000006, -19.499999999999645, 164.39999999999915, 56.20000000000046, -27.899999999999814, 67.39999999999904, -13.400000000000007, -198.10000000000005, 1.9000000000000765, 25.0, -9.0, 103.19999999999985, 70.49999999999889, -139.00000000000074, 74.69999999999965, 96.89999999999972, -7.399999999999855, -231.20000000000118, 77.89999999999992, 160.19999999999877, 40.0000000000003, 101.09999999999854, -80.70000000000005, -10.599999999999815, -24.999999999999545, 135.79999999999893, 64.70000000000037, 97.59999999999815, 42.200000000000045, -8.799999999999931, 41.00000000000032, 40.30000000000016, 1.499999999999971, -15.199999999999557, -121.0, -10.0, 6.0, 187.8999999999991, 35.70000000000024, 36.70000000000024, 63.70000000000024, -100.50000000000063, 93.99999999999834, -45.79999999999996, 41.40000000000019, 40.90000000000031, 60.00000000000036, -8.899999999999816, 64.09999999999947, 29.800000000000175, -289.5000000000002, 84.59999999999897, -127.60000000000036, 85.39999999999921, 28.0, -51.0, -10.19999999999973, -409.89999999999907, -185.49999999999983, 47.79999999999914, -6.599999999999753, -54.49999999999985, 35.600000000000236, -106.49999999999991, -65.30000000000003, -212.40000000000012, -191.09999999999997, -212.70000000000013, -144.9000000000002, -181.5000000000005, -132.40000000000003, -31.199999999999605, 36.0, -273.0, -15.599999999999866, -164.60000000000008], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [118.0999999999999, 140.60000000000002, 20.000000000000014, 17.899999999999977, -61.59999999999996, -118.89999999999999, 76.09999999999968, 42.50000000000018, 18.500000000000057, -112.3000000000003, -115.60000000000001, 16.699999999999964, 17.000000000000004, 11.600000000000001, 37.70000000000013, 56.00000000000011, 49.69999999999993, 76.69999999999929, -0.9999999999999846, 74.89999999999976, 111.49999999999946, 55.10000000000022, 60.20000000000015, 71.29999999999968, 82.99999999999955, 81.19999999999987, 47.3, 47.900000000000226, 18.500000000000092, 20.000000000000014, 11.0, -171.0, 0.0, 92.0, -64.30000000000035, 11.599999999999946, 20.000000000000014, 20.000000000000014, -73.00000000000038, 67.99999999999969, 20.000000000000014, 20.000000000000014, 82.10000000000012, 40.69999999999993, 61.69999999999989, -91.30000000000022, -96.69999999999996, -188.80000000000052, -42.99999999999977, -64.90000000000012, -95.50000000000061, 20.000000000000014, 22.700000000000173, 124.69999999999985, 20.90000000000003, 35.300000000000225, 21.499999999999993, -138.40000000000026, 34.09999999999937, -78.69999999999999, -91.30000000000004, -30.09999999999983, -101.80000000000005, -217.30000000000013, -3.100000000000042, -61.00000000000027, -11.0, 0.0, -50.0, -44.0, -107.50000000000041, 124.70000000000005, -11.500000000000037, 59.000000000000185, -64.00000000000003, -241.00000000000037, 20.000000000000014, 43.70000000000017, 15.799999999999946, 46.099999999999994, 20.000000000000014, -72.40000000000055, -242.50000000000043, -120.70000000000056, 91.39999999999992, -95.50000000000054, 25.700000000000124, 132.49999999999957, 20.000000000000014, 20.000000000000014, 71.8999999999996, 15.199999999999969, -184.90000000000018, -233.8, -124.30000000000047, 31.70000000000021, -59.50000000000008, -29.49999999999976, 99.79999999999967, 20.000000000000014, -0.4000000000000383, 40.100000000000215, 53.30000000000023, 44.300000000000246, 13.999999999999988, -80.80000000000031, -74.80000000000024, 20.000000000000014, 7.999999999999973, 20.000000000000014, 34.40000000000007, -87.10000000000011, -99.1000000000003, -30.399999999999757, -87.10000000000082, 20.900000000000027, -211.0, -70.0, -4.0, -16.0, 0.0, 4.0, 164.89999999999984, 20.000000000000014, -3.099999999999958, 21.80000000000004, 20.000000000000014, 13.699999999999966, 17.00000000000007, 34.700000000000095, 13.699999999999946, -242.20000000000036, 55.10000000000022, 38.900000000000254, -101.80000000000032, -22.000000000000043, 59.600000000000065, -110.20000000000022, 20.000000000000014, 20.900000000000027, 20.000000000000014, -12.999999999999913, 41.89999999999956, -227.80000000000024, 33.50000000000014, -6.400000000000016, -226.60000000000002, 70.39999999999972, -242.50000000000003, -232.00000000000043, 61.70000000000019, 20.900000000000027, -99.7000000000008, -219.9000000000001, 56.90000000000011, 21.50000000000025, 28.0, 0.0, 31.0, -178.0, 28.1, -91.3000000000005, -332.0000000000002, -299.9000000000001, -174.9999999999999, -266.5, -32.19999999999988, 20.000000000000014, -31.599999999999888, -22.00000000000001, -11.200000000000008, -175.30000000000013, 15.799999999999963, 15.799999999999962, -217.3000000000001, -158.19999999999987, -85.00000000000003, -133.3000000000001, -204.70000000000002, -204.70000000000005, -292.9, -50.20000000000019, -269.79999999999933, -175.89999999999995, -288.7, -95.20000000000023, -78.70000000000017, -227.80000000000024, -85.0, -138.4000000000001, -34.59999999999975, -76.60000000000042, 99.0, -267.0, -206.0, -218.0, 23.60000000000008, -224.20000000000002, -204.29999999999998, -121.30000000000024], "policy_predator_policy_reward": [0.0, 12.0, 1.0, 0.0, 0.0, 119.0, 8.0, 0.0, 58.0, 50.0, 66.0, 28.0, 22.0, 4.0, 0.0, 16.0, 27.0, 0.0, 0.0, 10.0, 0.0, 1.0, 13.0, 0.0, 0.0, 6.0, 2.0, 27.0, 31.0, 15.0, 82.0, 67.0, 3.0, 22.0, 35.0, 31.0, 0.0, 0.0, 56.0, 0.0, 0.0, 0.0, 0.0, 45.0, 53.0, 26.0, 0.0, 135.0, 27.0, 70.0, 1.0, 55.0, 10.0, 7.0, 0.0, 0.0, 84.0, 5.0, 69.0, 43.0, 66.0, 42.0, 121.0, 0.0, 14.0, 52.0, 17.0, 19.0, 45.0, 40.0, 45.0, 41.0, 8.0, 15.0, 126.0, 40.0, 0.0, 11.0, 33.0, 2.0, 12.0, 33.0, 0.0, 132.0, 3.0, 79.0, 0.0, 2.0, 0.0, 0.0, 14.0, 0.0, 179.0, 159.0, 13.0, 69.0, 37.0, 27.0, 16.0, 0.0, 8.0, 17.0, 0.0, 0.0, 54.0, 55.0, 46.0, 0.0, 13.0, 0.0, 31.0, 62.0, 46.0, 85.0, 0.0, 51.0, 73.0, 87.0, 10.0, 0.0, 0.0, 2.0, 0.0, 3.0, 0.0, 17.0, 0.0, 3.0, 12.0, 0.0, 128.0, 0.0, 0.0, 0.0, 45.0, 33.0, 61.0, 31.0, 0.0, 0.0, 40.0, 13.0, 79.0, 98.0, 5.0, 32.0, 77.0, 109.0, 0.0, 185.0, 2.0, 0.0, 6.0, 186.0, 7.0, 0.0, 0.0, 0.0, 0.0, 96.0, 0.0, 53.0, 0.0, 222.0, 111.0, 145.0, 16.0, 44.0, 0.0, 47.0, 39.0, 93.0, 4.0, 0.0, 110.0, 159.0, 85.0, 68.0, 93.0, 104.0, 149.0, 3.0, 73.0, 160.0, 93.0, 146.0, 0.0, 125.0, 8.0, 83.0, 0.0, 80.0, 50.0, 154.0, 42.0, 109.0, 71.0, 114.0, 31.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4216109405099673, "mean_inference_ms": 3.5580271103132337, "mean_action_processing_ms": 0.5541751563820789, "mean_env_wait_ms": 0.47113618410451613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.034221768379211426, "StateBufferConnector_ms": 0.004822134971618652, "ViewRequirementAgentConnector_ms": 0.2542532682418823}, "num_episodes": 18, "episode_return_max": 270.7000000000003, "episode_return_min": -409.89999999999907, "episode_return_mean": 2.847999999999828, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 246.238508271479, "num_env_steps_trained_throughput_per_sec": 246.238508271479, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 21636.371, "restore_workers_time_ms": 0.112, "training_step_time_ms": 21636.186, "sample_time_ms": 2785.739, "learn_time_ms": 18816.063, "learn_throughput": 212.584, "synch_weights_time_ms": 30.702}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "training_iteration": 7, "trial_id": "e4caa_00000", "date": "2024-08-13_19-46-53", "timestamp": 1723592813, "time_this_iter_s": 16.371755123138428, "time_total_s": 152.1480598449707, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b02a5b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 152.1480598449707, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 76.05217391304348, "ram_util_percent": 83.80434782608698}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.568708604290372, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.751592783700852, "policy_loss": -0.006844598820639981, "vf_loss": 6.756946203191444, "vf_explained_var": 0.011665220708443374, "kl": 0.014911914626906185, "entropy": 1.4709069224261733, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5145783842240692, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.884956803145232, "policy_loss": -0.0056840772957358725, "vf_loss": 6.888915193143975, "vf_explained_var": 0.012185163724990119, "kl": 0.008628369488430838, "entropy": 1.523791029339745, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 14175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "env_runners": {"episode_reward_max": 187.8999999999991, "episode_reward_min": -409.89999999999907, "episode_reward_mean": -26.479000000000134, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -355.89999999999986, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 164.89999999999984, "predator_policy": 222.0}, "policy_reward_mean": {"prey_policy": -61.75950000000006, "predator_policy": 48.52}, "custom_metrics": {}, "hist_stats": {"episode_reward": [40.0000000000003, 51.000000000000206, 40.0000000000003, 167.7999999999995, 49.39999999999982, -150.50000000000014, -10.900000000000006, -19.499999999999645, 164.39999999999915, 56.20000000000046, -27.899999999999814, 67.39999999999904, -13.400000000000007, -198.10000000000005, 1.9000000000000765, 25.0, -9.0, 103.19999999999985, 70.49999999999889, -139.00000000000074, 74.69999999999965, 96.89999999999972, -7.399999999999855, -231.20000000000118, 77.89999999999992, 160.19999999999877, 40.0000000000003, 101.09999999999854, -80.70000000000005, -10.599999999999815, -24.999999999999545, 135.79999999999893, 64.70000000000037, 97.59999999999815, 42.200000000000045, -8.799999999999931, 41.00000000000032, 40.30000000000016, 1.499999999999971, -15.199999999999557, -121.0, -10.0, 6.0, 187.8999999999991, 35.70000000000024, 36.70000000000024, 63.70000000000024, -100.50000000000063, 93.99999999999834, -45.79999999999996, 41.40000000000019, 40.90000000000031, 60.00000000000036, -8.899999999999816, 64.09999999999947, 29.800000000000175, -289.5000000000002, 84.59999999999897, -127.60000000000036, 85.39999999999921, 28.0, -51.0, -10.19999999999973, -409.89999999999907, -185.49999999999983, 47.79999999999914, -6.599999999999753, -54.49999999999985, 35.600000000000236, -106.49999999999991, -65.30000000000003, -212.40000000000012, -191.09999999999997, -212.70000000000013, -144.9000000000002, -181.5000000000005, -132.40000000000003, -31.199999999999605, 36.0, -273.0, -15.599999999999866, -164.60000000000008, -89.29999999999988, -179.20000000000002, -39.89999999999975, -71.09999999999971, -27.499999999999815, -160.80000000000024, -215.30000000000078, -161.90000000000106, 94.9999999999992, -101.40000000000059, -109.69999999999993, 49.40000000000043, -67.60000000000002, 40.0000000000003, -205.0, 0.0, -130.1000000000004, 37.599999999999795], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.000000000000014, 20.000000000000014, -73.00000000000038, 67.99999999999969, 20.000000000000014, 20.000000000000014, 82.10000000000012, 40.69999999999993, 61.69999999999989, -91.30000000000022, -96.69999999999996, -188.80000000000052, -42.99999999999977, -64.90000000000012, -95.50000000000061, 20.000000000000014, 22.700000000000173, 124.69999999999985, 20.90000000000003, 35.300000000000225, 21.499999999999993, -138.40000000000026, 34.09999999999937, -78.69999999999999, -91.30000000000004, -30.09999999999983, -101.80000000000005, -217.30000000000013, -3.100000000000042, -61.00000000000027, -11.0, 0.0, -50.0, -44.0, -107.50000000000041, 124.70000000000005, -11.500000000000037, 59.000000000000185, -64.00000000000003, -241.00000000000037, 20.000000000000014, 43.70000000000017, 15.799999999999946, 46.099999999999994, 20.000000000000014, -72.40000000000055, -242.50000000000043, -120.70000000000056, 91.39999999999992, -95.50000000000054, 25.700000000000124, 132.49999999999957, 20.000000000000014, 20.000000000000014, 71.8999999999996, 15.199999999999969, -184.90000000000018, -233.8, -124.30000000000047, 31.70000000000021, -59.50000000000008, -29.49999999999976, 99.79999999999967, 20.000000000000014, -0.4000000000000383, 40.100000000000215, 53.30000000000023, 44.300000000000246, 13.999999999999988, -80.80000000000031, -74.80000000000024, 20.000000000000014, 7.999999999999973, 20.000000000000014, 34.40000000000007, -87.10000000000011, -99.1000000000003, -30.399999999999757, -87.10000000000082, 20.900000000000027, -211.0, -70.0, -4.0, -16.0, 0.0, 4.0, 164.89999999999984, 20.000000000000014, -3.099999999999958, 21.80000000000004, 20.000000000000014, 13.699999999999966, 17.00000000000007, 34.700000000000095, 13.699999999999946, -242.20000000000036, 55.10000000000022, 38.900000000000254, -101.80000000000032, -22.000000000000043, 59.600000000000065, -110.20000000000022, 20.000000000000014, 20.900000000000027, 20.000000000000014, -12.999999999999913, 41.89999999999956, -227.80000000000024, 33.50000000000014, -6.400000000000016, -226.60000000000002, 70.39999999999972, -242.50000000000003, -232.00000000000043, 61.70000000000019, 20.900000000000027, -99.7000000000008, -219.9000000000001, 56.90000000000011, 21.50000000000025, 28.0, 0.0, 31.0, -178.0, 28.1, -91.3000000000005, -332.0000000000002, -299.9000000000001, -174.9999999999999, -266.5, -32.19999999999988, 20.000000000000014, -31.599999999999888, -22.00000000000001, -11.200000000000008, -175.30000000000013, 15.799999999999963, 15.799999999999962, -217.3000000000001, -158.19999999999987, -85.00000000000003, -133.3000000000001, -204.70000000000002, -204.70000000000005, -292.9, -50.20000000000019, -269.79999999999933, -175.89999999999995, -288.7, -95.20000000000023, -78.70000000000017, -227.80000000000024, -85.0, -138.4000000000001, -34.59999999999975, -76.60000000000042, 99.0, -267.0, -206.0, -218.0, 23.60000000000008, -224.20000000000002, -204.29999999999998, -121.30000000000024, -185.50000000000009, -122.80000000000004, -194.20000000000002, -190.0, -21.999999999999844, -157.9000000000004, -55.60000000000022, -116.5, -135.10000000000002, -9.399999999999958, -195.10000000000005, -162.7000000000002, -196.30000000000052, -268.9999999999998, -42.99999999999976, -355.89999999999986, -0.6999999999999384, 28.700000000000124, -60.70000000000018, -267.69999999999953, -80.80000000000004, -145.90000000000003, 11.599999999999978, 21.80000000000004, -45.39999999999999, -194.2000000000001, 20.000000000000014, 20.000000000000014, -173.0, -185.0, 0.0, 0.0, -150.10000000000036, -211.00000000000003, -158.8, 61.40000000000015], "policy_predator_policy_reward": [0.0, 0.0, 56.0, 0.0, 0.0, 0.0, 0.0, 45.0, 53.0, 26.0, 0.0, 135.0, 27.0, 70.0, 1.0, 55.0, 10.0, 7.0, 0.0, 0.0, 84.0, 5.0, 69.0, 43.0, 66.0, 42.0, 121.0, 0.0, 14.0, 52.0, 17.0, 19.0, 45.0, 40.0, 45.0, 41.0, 8.0, 15.0, 126.0, 40.0, 0.0, 11.0, 33.0, 2.0, 12.0, 33.0, 0.0, 132.0, 3.0, 79.0, 0.0, 2.0, 0.0, 0.0, 14.0, 0.0, 179.0, 159.0, 13.0, 69.0, 37.0, 27.0, 16.0, 0.0, 8.0, 17.0, 0.0, 0.0, 54.0, 55.0, 46.0, 0.0, 13.0, 0.0, 31.0, 62.0, 46.0, 85.0, 0.0, 51.0, 73.0, 87.0, 10.0, 0.0, 0.0, 2.0, 0.0, 3.0, 0.0, 17.0, 0.0, 3.0, 12.0, 0.0, 128.0, 0.0, 0.0, 0.0, 45.0, 33.0, 61.0, 31.0, 0.0, 0.0, 40.0, 13.0, 79.0, 98.0, 5.0, 32.0, 77.0, 109.0, 0.0, 185.0, 2.0, 0.0, 6.0, 186.0, 7.0, 0.0, 0.0, 0.0, 0.0, 96.0, 0.0, 53.0, 0.0, 222.0, 111.0, 145.0, 16.0, 44.0, 0.0, 47.0, 39.0, 93.0, 4.0, 0.0, 110.0, 159.0, 85.0, 68.0, 93.0, 104.0, 149.0, 3.0, 73.0, 160.0, 93.0, 146.0, 0.0, 125.0, 8.0, 83.0, 0.0, 80.0, 50.0, 154.0, 42.0, 109.0, 71.0, 114.0, 31.0, 130.0, 104.0, 115.0, 100.0, 105.0, 73.0, 67.0, 101.0, 0.0, 40.0, 77.0, 99.0, 98.0, 135.0, 115.0, 65.0, 172.0, 36.0, 31.0, 135.0, 92.0, 79.0, 38.0, 16.0, 0.0, 59.0, 113.0, 0.0, 0.0, 77.0, 76.0, 0.0, 0.0, 119.0, 112.0, 26.0, 109.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4333889980615782, "mean_inference_ms": 3.5725999633501955, "mean_action_processing_ms": 0.5537719744763507, "mean_env_wait_ms": 0.47672842921460173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03376734256744385, "StateBufferConnector_ms": 0.003959178924560547, "ViewRequirementAgentConnector_ms": 0.27246224880218506}, "num_episodes": 18, "episode_return_max": 187.8999999999991, "episode_return_min": -409.89999999999907, "episode_return_mean": -26.479000000000134, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 206.07367973319765, "num_env_steps_trained_throughput_per_sec": 206.07367973319765, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 21358.142, "restore_workers_time_ms": 0.1, "training_step_time_ms": 21357.975, "sample_time_ms": 2937.151, "learn_time_ms": 18387.769, "learn_throughput": 217.536, "synch_weights_time_ms": 29.643}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "training_iteration": 8, "trial_id": "e4caa_00000", "date": "2024-08-13_19-47-13", "timestamp": 1723592833, "time_this_iter_s": 19.54579210281372, "time_total_s": 171.69385194778442, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2844b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 171.69385194778442, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 81.57142857142857, "ram_util_percent": 84.10714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5969632141962253, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.0908052428058848, "policy_loss": -0.007817261224789988, "vf_loss": 3.097064683803175, "vf_explained_var": 0.019387645065469087, "kl": 0.015578284440222679, "entropy": 1.4689110915496866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5541827290461807, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6085490019863875, "policy_loss": -0.0073555464180009, "vf_loss": 2.6141138460270312, "vf_explained_var": -0.0034045998066190688, "kl": 0.008953524794882126, "entropy": 1.5262330932591959, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 16065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "env_runners": {"episode_reward_max": 187.8999999999991, "episode_reward_min": -409.89999999999907, "episode_reward_mean": -29.029000000000106, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -355.89999999999986, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 164.89999999999984, "predator_policy": 222.0}, "policy_reward_mean": {"prey_policy": -63.72450000000004, "predator_policy": 49.21}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-7.399999999999855, -231.20000000000118, 77.89999999999992, 160.19999999999877, 40.0000000000003, 101.09999999999854, -80.70000000000005, -10.599999999999815, -24.999999999999545, 135.79999999999893, 64.70000000000037, 97.59999999999815, 42.200000000000045, -8.799999999999931, 41.00000000000032, 40.30000000000016, 1.499999999999971, -15.199999999999557, -121.0, -10.0, 6.0, 187.8999999999991, 35.70000000000024, 36.70000000000024, 63.70000000000024, -100.50000000000063, 93.99999999999834, -45.79999999999996, 41.40000000000019, 40.90000000000031, 60.00000000000036, -8.899999999999816, 64.09999999999947, 29.800000000000175, -289.5000000000002, 84.59999999999897, -127.60000000000036, 85.39999999999921, 28.0, -51.0, -10.19999999999973, -409.89999999999907, -185.49999999999983, 47.79999999999914, -6.599999999999753, -54.49999999999985, 35.600000000000236, -106.49999999999991, -65.30000000000003, -212.40000000000012, -191.09999999999997, -212.70000000000013, -144.9000000000002, -181.5000000000005, -132.40000000000003, -31.199999999999605, 36.0, -273.0, -15.599999999999866, -164.60000000000008, -89.29999999999988, -179.20000000000002, -39.89999999999975, -71.09999999999971, -27.499999999999815, -160.80000000000024, -215.30000000000078, -161.90000000000106, 94.9999999999992, -101.40000000000059, -109.69999999999993, 49.40000000000043, -67.60000000000002, 40.0000000000003, -205.0, 0.0, -130.1000000000004, 37.599999999999795, -3.5000000000000533, 53.1000000000004, 40.0000000000003, -20.599999999999696, -16.099999999999504, 56.20000000000051, -168.90000000000126, 139.69999999999877, 58.100000000000435, -3.1999999999999598, 94.09999999999843, -3.199999999999944, -94.90000000000052, -10.099999999999653, 11.30000000000021, 43.40000000000037, 45.300000000000296, 9.099999999999978, -1.0, -12.0, -18.700000000000045, -12.999999999999842], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.000000000000014, -72.40000000000055, -242.50000000000043, -120.70000000000056, 91.39999999999992, -95.50000000000054, 25.700000000000124, 132.49999999999957, 20.000000000000014, 20.000000000000014, 71.8999999999996, 15.199999999999969, -184.90000000000018, -233.8, -124.30000000000047, 31.70000000000021, -59.50000000000008, -29.49999999999976, 99.79999999999967, 20.000000000000014, -0.4000000000000383, 40.100000000000215, 53.30000000000023, 44.300000000000246, 13.999999999999988, -80.80000000000031, -74.80000000000024, 20.000000000000014, 7.999999999999973, 20.000000000000014, 34.40000000000007, -87.10000000000011, -99.1000000000003, -30.399999999999757, -87.10000000000082, 20.900000000000027, -211.0, -70.0, -4.0, -16.0, 0.0, 4.0, 164.89999999999984, 20.000000000000014, -3.099999999999958, 21.80000000000004, 20.000000000000014, 13.699999999999966, 17.00000000000007, 34.700000000000095, 13.699999999999946, -242.20000000000036, 55.10000000000022, 38.900000000000254, -101.80000000000032, -22.000000000000043, 59.600000000000065, -110.20000000000022, 20.000000000000014, 20.900000000000027, 20.000000000000014, -12.999999999999913, 41.89999999999956, -227.80000000000024, 33.50000000000014, -6.400000000000016, -226.60000000000002, 70.39999999999972, -242.50000000000003, -232.00000000000043, 61.70000000000019, 20.900000000000027, -99.7000000000008, -219.9000000000001, 56.90000000000011, 21.50000000000025, 28.0, 0.0, 31.0, -178.0, 28.1, -91.3000000000005, -332.0000000000002, -299.9000000000001, -174.9999999999999, -266.5, -32.19999999999988, 20.000000000000014, -31.599999999999888, -22.00000000000001, -11.200000000000008, -175.30000000000013, 15.799999999999963, 15.799999999999962, -217.3000000000001, -158.19999999999987, -85.00000000000003, -133.3000000000001, -204.70000000000002, -204.70000000000005, -292.9, -50.20000000000019, -269.79999999999933, -175.89999999999995, -288.7, -95.20000000000023, -78.70000000000017, -227.80000000000024, -85.0, -138.4000000000001, -34.59999999999975, -76.60000000000042, 99.0, -267.0, -206.0, -218.0, 23.60000000000008, -224.20000000000002, -204.29999999999998, -121.30000000000024, -185.50000000000009, -122.80000000000004, -194.20000000000002, -190.0, -21.999999999999844, -157.9000000000004, -55.60000000000022, -116.5, -135.10000000000002, -9.399999999999958, -195.10000000000005, -162.7000000000002, -196.30000000000052, -268.9999999999998, -42.99999999999976, -355.89999999999986, -0.6999999999999384, 28.700000000000124, -60.70000000000018, -267.69999999999953, -80.80000000000004, -145.90000000000003, 11.599999999999978, 21.80000000000004, -45.39999999999999, -194.2000000000001, 20.000000000000014, 20.000000000000014, -173.0, -185.0, 0.0, 0.0, -150.10000000000036, -211.00000000000003, -158.8, 61.40000000000015, -174.50000000000009, 20.000000000000014, 20.000000000000014, -16.899999999999842, 20.000000000000014, 20.000000000000014, -11.799999999999846, -98.8000000000003, -17.79999999999974, -49.299999999999876, 20.000000000000014, 36.20000000000025, -127.00000000000068, -166.9000000000006, 20.000000000000014, 118.6999999999995, 25.100000000000108, 20.000000000000014, -4.600000000000014, -139.60000000000036, 9.499999999999995, 62.60000000000019, -26.199999999999754, -42.99999999999988, -151.00000000000054, -271.9, -17.79999999999974, -40.29999999999979, -89.20000000000003, 9.500000000000062, 34.40000000000024, -0.9999999999999992, -121.59999999999995, 29.900000000000222, 8.899999999999983, -68.80000000000081, -2.0, 0.0, -6.0, -18.0, -93.40000000000005, 13.699999999999967, 20.000000000000014, -127.00000000000043], "policy_predator_policy_reward": [12.0, 33.0, 0.0, 132.0, 3.0, 79.0, 0.0, 2.0, 0.0, 0.0, 14.0, 0.0, 179.0, 159.0, 13.0, 69.0, 37.0, 27.0, 16.0, 0.0, 8.0, 17.0, 0.0, 0.0, 54.0, 55.0, 46.0, 0.0, 13.0, 0.0, 31.0, 62.0, 46.0, 85.0, 0.0, 51.0, 73.0, 87.0, 10.0, 0.0, 0.0, 2.0, 0.0, 3.0, 0.0, 17.0, 0.0, 3.0, 12.0, 0.0, 128.0, 0.0, 0.0, 0.0, 45.0, 33.0, 61.0, 31.0, 0.0, 0.0, 40.0, 13.0, 79.0, 98.0, 5.0, 32.0, 77.0, 109.0, 0.0, 185.0, 2.0, 0.0, 6.0, 186.0, 7.0, 0.0, 0.0, 0.0, 0.0, 96.0, 0.0, 53.0, 0.0, 222.0, 111.0, 145.0, 16.0, 44.0, 0.0, 47.0, 39.0, 93.0, 4.0, 0.0, 110.0, 159.0, 85.0, 68.0, 93.0, 104.0, 149.0, 3.0, 73.0, 160.0, 93.0, 146.0, 0.0, 125.0, 8.0, 83.0, 0.0, 80.0, 50.0, 154.0, 42.0, 109.0, 71.0, 114.0, 31.0, 130.0, 104.0, 115.0, 100.0, 105.0, 73.0, 67.0, 101.0, 0.0, 40.0, 77.0, 99.0, 98.0, 135.0, 115.0, 65.0, 172.0, 36.0, 31.0, 135.0, 92.0, 79.0, 38.0, 16.0, 0.0, 59.0, 113.0, 0.0, 0.0, 77.0, 76.0, 0.0, 0.0, 119.0, 112.0, 26.0, 109.0, 65.0, 86.0, 29.0, 21.0, 0.0, 0.0, 71.0, 19.0, 18.0, 33.0, 0.0, 0.0, 106.0, 19.0, 0.0, 1.0, 0.0, 13.0, 86.0, 55.0, 18.0, 4.0, 48.0, 18.0, 178.0, 150.0, 48.0, 0.0, 30.0, 61.0, 0.0, 10.0, 74.0, 63.0, 32.0, 37.0, 1.0, 0.0, 9.0, 3.0, 48.0, 13.0, 44.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6714189940781075, "mean_inference_ms": 4.3132697873949795, "mean_action_processing_ms": 0.6530840393423059, "mean_env_wait_ms": 0.5340595885889508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0720515251159668, "StateBufferConnector_ms": 0.004906654357910156, "ViewRequirementAgentConnector_ms": 1.3307225704193115}, "num_episodes": 22, "episode_return_max": 187.8999999999991, "episode_return_min": -409.89999999999907, "episode_return_mean": -29.029000000000106, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 71.93814166135289, "num_env_steps_trained_throughput_per_sec": 71.93814166135289, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 25163.166, "restore_workers_time_ms": 0.112, "training_step_time_ms": 25162.987, "sample_time_ms": 5275.355, "learn_time_ms": 19850.125, "learn_throughput": 201.51, "synch_weights_time_ms": 32.785}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "training_iteration": 9, "trial_id": "e4caa_00000", "date": "2024-08-13_19-48-09", "timestamp": 1723592889, "time_this_iter_s": 55.833778858184814, "time_total_s": 227.52763080596924, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03713a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 227.52763080596924, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 96.734375, "ram_util_percent": 84.3296875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7217490160276019, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.1812444330523255, "policy_loss": -0.004089130314249329, "vf_loss": 3.1848242356032923, "vf_explained_var": 0.07731780797716171, "kl": 0.005093288667156413, "entropy": 1.4777412557728076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6082547771867621, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5466801922472697, "policy_loss": -0.004325893894577074, "vf_loss": 1.549969875055646, "vf_explained_var": 0.021181292161739692, "kl": 0.005181065724978166, "entropy": 1.5267665785456461, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 17955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 183.9999999999988, "episode_reward_min": -409.89999999999907, "episode_reward_mean": -23.40100000000013, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -355.89999999999986, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 134.29999999999964, "predator_policy": 222.0}, "policy_reward_mean": {"prey_policy": -57.67550000000003, "predator_policy": 45.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [36.70000000000024, 63.70000000000024, -100.50000000000063, 93.99999999999834, -45.79999999999996, 41.40000000000019, 40.90000000000031, 60.00000000000036, -8.899999999999816, 64.09999999999947, 29.800000000000175, -289.5000000000002, 84.59999999999897, -127.60000000000036, 85.39999999999921, 28.0, -51.0, -10.19999999999973, -409.89999999999907, -185.49999999999983, 47.79999999999914, -6.599999999999753, -54.49999999999985, 35.600000000000236, -106.49999999999991, -65.30000000000003, -212.40000000000012, -191.09999999999997, -212.70000000000013, -144.9000000000002, -181.5000000000005, -132.40000000000003, -31.199999999999605, 36.0, -273.0, -15.599999999999866, -164.60000000000008, -89.29999999999988, -179.20000000000002, -39.89999999999975, -71.09999999999971, -27.499999999999815, -160.80000000000024, -215.30000000000078, -161.90000000000106, 94.9999999999992, -101.40000000000059, -109.69999999999993, 49.40000000000043, -67.60000000000002, 40.0000000000003, -205.0, 0.0, -130.1000000000004, 37.599999999999795, -3.5000000000000533, 53.1000000000004, 40.0000000000003, -20.599999999999696, -16.099999999999504, 56.20000000000051, -168.90000000000126, 139.69999999999877, 58.100000000000435, -3.1999999999999598, 94.09999999999843, -3.199999999999944, -94.90000000000052, -10.099999999999653, 11.30000000000021, 43.40000000000037, 45.300000000000296, 9.099999999999978, -1.0, -12.0, -18.700000000000045, -12.999999999999842, 32.90000000000018, 112.89999999999841, 31.200000000000156, 37.80000000000027, -28.199999999999626, 7.500000000000005, 183.9999999999988, 74.19999999999973, -4.39999999999973, 8.000000000000103, 19.799999999999994, -15.400000000000063, 98.49999999999852, 144.49999999999898, 28.20000000000013, 107.39999999999924, 116.3999999999985, -6.0, -29.0, -15.0, 93.09999999999874, 45.40000000000034, 41.000000000000306], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.000000000000014, 13.699999999999966, 17.00000000000007, 34.700000000000095, 13.699999999999946, -242.20000000000036, 55.10000000000022, 38.900000000000254, -101.80000000000032, -22.000000000000043, 59.600000000000065, -110.20000000000022, 20.000000000000014, 20.900000000000027, 20.000000000000014, -12.999999999999913, 41.89999999999956, -227.80000000000024, 33.50000000000014, -6.400000000000016, -226.60000000000002, 70.39999999999972, -242.50000000000003, -232.00000000000043, 61.70000000000019, 20.900000000000027, -99.7000000000008, -219.9000000000001, 56.90000000000011, 21.50000000000025, 28.0, 0.0, 31.0, -178.0, 28.1, -91.3000000000005, -332.0000000000002, -299.9000000000001, -174.9999999999999, -266.5, -32.19999999999988, 20.000000000000014, -31.599999999999888, -22.00000000000001, -11.200000000000008, -175.30000000000013, 15.799999999999963, 15.799999999999962, -217.3000000000001, -158.19999999999987, -85.00000000000003, -133.3000000000001, -204.70000000000002, -204.70000000000005, -292.9, -50.20000000000019, -269.79999999999933, -175.89999999999995, -288.7, -95.20000000000023, -78.70000000000017, -227.80000000000024, -85.0, -138.4000000000001, -34.59999999999975, -76.60000000000042, 99.0, -267.0, -206.0, -218.0, 23.60000000000008, -224.20000000000002, -204.29999999999998, -121.30000000000024, -185.50000000000009, -122.80000000000004, -194.20000000000002, -190.0, -21.999999999999844, -157.9000000000004, -55.60000000000022, -116.5, -135.10000000000002, -9.399999999999958, -195.10000000000005, -162.7000000000002, -196.30000000000052, -268.9999999999998, -42.99999999999976, -355.89999999999986, -0.6999999999999384, 28.700000000000124, -60.70000000000018, -267.69999999999953, -80.80000000000004, -145.90000000000003, 11.599999999999978, 21.80000000000004, -45.39999999999999, -194.2000000000001, 20.000000000000014, 20.000000000000014, -173.0, -185.0, 0.0, 0.0, -150.10000000000036, -211.00000000000003, -158.8, 61.40000000000015, -174.50000000000009, 20.000000000000014, 20.000000000000014, -16.899999999999842, 20.000000000000014, 20.000000000000014, -11.799999999999846, -98.8000000000003, -17.79999999999974, -49.299999999999876, 20.000000000000014, 36.20000000000025, -127.00000000000068, -166.9000000000006, 20.000000000000014, 118.6999999999995, 25.100000000000108, 20.000000000000014, -4.600000000000014, -139.60000000000036, 9.499999999999995, 62.60000000000019, -26.199999999999754, -42.99999999999988, -151.00000000000054, -271.9, -17.79999999999974, -40.29999999999979, -89.20000000000003, 9.500000000000062, 34.40000000000024, -0.9999999999999992, -121.59999999999995, 29.900000000000222, 8.899999999999983, -68.80000000000081, -2.0, 0.0, -6.0, -18.0, -93.40000000000005, 13.699999999999967, 20.000000000000014, -127.00000000000043, 26.000000000000135, -24.099999999999746, 49.400000000000205, 54.50000000000019, -44.79999999999985, 20.000000000000014, 44.30000000000022, -53.50000000000019, 22.700000000000053, -145.9000000000006, -6.399999999999979, -45.099999999999774, 86.59999999999948, 97.39999999999938, -11.499999999999819, 58.700000000000216, -1.0000000000000098, -30.39999999999978, -28.29999999999975, -6.699999999999921, 20.000000000000014, -23.19999999999979, 24.20000000000008, -286.6, 20.000000000000014, 78.4999999999993, 134.29999999999964, -2.799999999999972, -16.599999999999767, 21.80000000000004, 22.10000000000012, 80.29999999999959, 45.20000000000023, 66.20000000000002, -12.0, 0.0, -58.0, 0.0, -14.0, -16.0, 97.39999999999935, -28.29999999999979, 25.40000000000011, 20.000000000000014, 20.000000000000014, 16.999999999999964], "policy_predator_policy_reward": [0.0, 3.0, 12.0, 0.0, 128.0, 0.0, 0.0, 0.0, 45.0, 33.0, 61.0, 31.0, 0.0, 0.0, 40.0, 13.0, 79.0, 98.0, 5.0, 32.0, 77.0, 109.0, 0.0, 185.0, 2.0, 0.0, 6.0, 186.0, 7.0, 0.0, 0.0, 0.0, 0.0, 96.0, 0.0, 53.0, 0.0, 222.0, 111.0, 145.0, 16.0, 44.0, 0.0, 47.0, 39.0, 93.0, 4.0, 0.0, 110.0, 159.0, 85.0, 68.0, 93.0, 104.0, 149.0, 3.0, 73.0, 160.0, 93.0, 146.0, 0.0, 125.0, 8.0, 83.0, 0.0, 80.0, 50.0, 154.0, 42.0, 109.0, 71.0, 114.0, 31.0, 130.0, 104.0, 115.0, 100.0, 105.0, 73.0, 67.0, 101.0, 0.0, 40.0, 77.0, 99.0, 98.0, 135.0, 115.0, 65.0, 172.0, 36.0, 31.0, 135.0, 92.0, 79.0, 38.0, 16.0, 0.0, 59.0, 113.0, 0.0, 0.0, 77.0, 76.0, 0.0, 0.0, 119.0, 112.0, 26.0, 109.0, 65.0, 86.0, 29.0, 21.0, 0.0, 0.0, 71.0, 19.0, 18.0, 33.0, 0.0, 0.0, 106.0, 19.0, 0.0, 1.0, 0.0, 13.0, 86.0, 55.0, 18.0, 4.0, 48.0, 18.0, 178.0, 150.0, 48.0, 0.0, 30.0, 61.0, 0.0, 10.0, 74.0, 63.0, 32.0, 37.0, 1.0, 0.0, 9.0, 3.0, 48.0, 13.0, 44.0, 50.0, 0.0, 31.0, 9.0, 0.0, 25.0, 31.0, 35.0, 12.0, 54.0, 41.0, 31.0, 28.0, 0.0, 0.0, 15.0, 12.0, 27.0, 0.0, 21.0, 22.0, 19.0, 4.0, 130.0, 117.0, 0.0, 0.0, 0.0, 13.0, 23.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 6.0, 10.0, 19.0, 14.0, 1.0, 7.0, 17.0, 0.0, 0.0, 4.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.917449732200475, "mean_inference_ms": 5.156549704038745, "mean_action_processing_ms": 0.7876344982548992, "mean_env_wait_ms": 0.6047772202589217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0769350528717041, "StateBufferConnector_ms": 0.0059299468994140625, "ViewRequirementAgentConnector_ms": 1.4917207956314087}, "num_episodes": 23, "episode_return_max": 183.9999999999988, "episode_return_min": -409.89999999999907, "episode_return_mean": -23.40100000000013, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.71427586217897, "num_env_steps_trained_throughput_per_sec": 103.71427586217897, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 26503.6, "restore_workers_time_ms": 0.103, "training_step_time_ms": 26503.433, "sample_time_ms": 5603.779, "learn_time_ms": 20855.243, "learn_throughput": 191.798, "synch_weights_time_ms": 38.607}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 10, "trial_id": "e4caa_00000", "date": "2024-08-13_19-48-49", "timestamp": 1723592929, "time_this_iter_s": 39.665833950042725, "time_total_s": 267.19346475601196, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03a44c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 267.19346475601196, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 93.20188679245283, "ram_util_percent": 84.15283018867925}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7027534566070668, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9607235913554195, "policy_loss": -0.006117405495532449, "vf_loss": 3.965433797003731, "vf_explained_var": 0.01730612976841195, "kl": 0.014072104029277959, "entropy": 1.4235368587983348, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.342107383299757, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.167243903276151, "policy_loss": -0.010182949249933243, "vf_loss": 2.1748451902122095, "vf_explained_var": 0.007826490471602748, "kl": 0.01290827909243297, "entropy": 1.519703495691693, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 19845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "env_runners": {"episode_reward_max": 183.9999999999988, "episode_reward_min": -409.89999999999907, "episode_reward_mean": -19.12200000000012, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -355.89999999999986, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 134.29999999999964, "predator_policy": 222.0}, "policy_reward_mean": {"prey_policy": -52.29100000000003, "predator_policy": 42.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-409.89999999999907, -185.49999999999983, 47.79999999999914, -6.599999999999753, -54.49999999999985, 35.600000000000236, -106.49999999999991, -65.30000000000003, -212.40000000000012, -191.09999999999997, -212.70000000000013, -144.9000000000002, -181.5000000000005, -132.40000000000003, -31.199999999999605, 36.0, -273.0, -15.599999999999866, -164.60000000000008, -89.29999999999988, -179.20000000000002, -39.89999999999975, -71.09999999999971, -27.499999999999815, -160.80000000000024, -215.30000000000078, -161.90000000000106, 94.9999999999992, -101.40000000000059, -109.69999999999993, 49.40000000000043, -67.60000000000002, 40.0000000000003, -205.0, 0.0, -130.1000000000004, 37.599999999999795, -3.5000000000000533, 53.1000000000004, 40.0000000000003, -20.599999999999696, -16.099999999999504, 56.20000000000051, -168.90000000000126, 139.69999999999877, 58.100000000000435, -3.1999999999999598, 94.09999999999843, -3.199999999999944, -94.90000000000052, -10.099999999999653, 11.30000000000021, 43.40000000000037, 45.300000000000296, 9.099999999999978, -1.0, -12.0, -18.700000000000045, -12.999999999999842, 32.90000000000018, 112.89999999999841, 31.200000000000156, 37.80000000000027, -28.199999999999626, 7.500000000000005, 183.9999999999988, 74.19999999999973, -4.39999999999973, 8.000000000000103, 19.799999999999994, -15.400000000000063, 98.49999999999852, 144.49999999999898, 28.20000000000013, 107.39999999999924, 116.3999999999985, -6.0, -29.0, -15.0, 93.09999999999874, 45.40000000000034, 41.000000000000306, 34.3000000000003, 6.5000000000000515, 14.700000000000022, -56.19999999999992, -45.39999999999969, 59.70000000000016, -1.7999999999997862, -13.399999999999741, 100.19999999999905, 61.80000000000033, 89.29999999999923, 56.500000000000504, 94.19999999999868, 14.69999999999998, 8.0, 57.0, 6.1, -63.20000000000148], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-332.0000000000002, -299.9000000000001, -174.9999999999999, -266.5, -32.19999999999988, 20.000000000000014, -31.599999999999888, -22.00000000000001, -11.200000000000008, -175.30000000000013, 15.799999999999963, 15.799999999999962, -217.3000000000001, -158.19999999999987, -85.00000000000003, -133.3000000000001, -204.70000000000002, -204.70000000000005, -292.9, -50.20000000000019, -269.79999999999933, -175.89999999999995, -288.7, -95.20000000000023, -78.70000000000017, -227.80000000000024, -85.0, -138.4000000000001, -34.59999999999975, -76.60000000000042, 99.0, -267.0, -206.0, -218.0, 23.60000000000008, -224.20000000000002, -204.29999999999998, -121.30000000000024, -185.50000000000009, -122.80000000000004, -194.20000000000002, -190.0, -21.999999999999844, -157.9000000000004, -55.60000000000022, -116.5, -135.10000000000002, -9.399999999999958, -195.10000000000005, -162.7000000000002, -196.30000000000052, -268.9999999999998, -42.99999999999976, -355.89999999999986, -0.6999999999999384, 28.700000000000124, -60.70000000000018, -267.69999999999953, -80.80000000000004, -145.90000000000003, 11.599999999999978, 21.80000000000004, -45.39999999999999, -194.2000000000001, 20.000000000000014, 20.000000000000014, -173.0, -185.0, 0.0, 0.0, -150.10000000000036, -211.00000000000003, -158.8, 61.40000000000015, -174.50000000000009, 20.000000000000014, 20.000000000000014, -16.899999999999842, 20.000000000000014, 20.000000000000014, -11.799999999999846, -98.8000000000003, -17.79999999999974, -49.299999999999876, 20.000000000000014, 36.20000000000025, -127.00000000000068, -166.9000000000006, 20.000000000000014, 118.6999999999995, 25.100000000000108, 20.000000000000014, -4.600000000000014, -139.60000000000036, 9.499999999999995, 62.60000000000019, -26.199999999999754, -42.99999999999988, -151.00000000000054, -271.9, -17.79999999999974, -40.29999999999979, -89.20000000000003, 9.500000000000062, 34.40000000000024, -0.9999999999999992, -121.59999999999995, 29.900000000000222, 8.899999999999983, -68.80000000000081, -2.0, 0.0, -6.0, -18.0, -93.40000000000005, 13.699999999999967, 20.000000000000014, -127.00000000000043, 26.000000000000135, -24.099999999999746, 49.400000000000205, 54.50000000000019, -44.79999999999985, 20.000000000000014, 44.30000000000022, -53.50000000000019, 22.700000000000053, -145.9000000000006, -6.399999999999979, -45.099999999999774, 86.59999999999948, 97.39999999999938, -11.499999999999819, 58.700000000000216, -1.0000000000000098, -30.39999999999978, -28.29999999999975, -6.699999999999921, 20.000000000000014, -23.19999999999979, 24.20000000000008, -286.6, 20.000000000000014, 78.4999999999993, 134.29999999999964, -2.799999999999972, -16.599999999999767, 21.80000000000004, 22.10000000000012, 80.29999999999959, 45.20000000000023, 66.20000000000002, -12.0, 0.0, -58.0, 0.0, -14.0, -16.0, 97.39999999999935, -28.29999999999979, 25.40000000000011, 20.000000000000014, 20.000000000000014, 16.999999999999964, 20.90000000000003, 7.399999999999963, 15.79999999999996, -64.30000000000084, -3.099999999999958, -5.1999999999999265, 1.700000000000047, -145.89999999999992, -55.60000000000004, -59.800000000000196, -1.3000000000000047, 20.000000000000014, 20.000000000000014, -59.800000000000566, -45.09999999999987, -31.299999999999862, -4.9000000000000075, 55.10000000000022, 14.899999999999961, 20.90000000000003, 78.49999999999972, -26.199999999999847, 13.699999999999969, 39.80000000000025, 66.19999999999992, 20.000000000000014, -3.0999999999999615, -5.199999999999948, 0.0, 8.0, 17.0, 18.0, -19.899999999999817, -18.999999999999744, -28.899999999999807, -88.30000000000078], "policy_predator_policy_reward": [0.0, 222.0, 111.0, 145.0, 16.0, 44.0, 0.0, 47.0, 39.0, 93.0, 4.0, 0.0, 110.0, 159.0, 85.0, 68.0, 93.0, 104.0, 149.0, 3.0, 73.0, 160.0, 93.0, 146.0, 0.0, 125.0, 8.0, 83.0, 0.0, 80.0, 50.0, 154.0, 42.0, 109.0, 71.0, 114.0, 31.0, 130.0, 104.0, 115.0, 100.0, 105.0, 73.0, 67.0, 101.0, 0.0, 40.0, 77.0, 99.0, 98.0, 135.0, 115.0, 65.0, 172.0, 36.0, 31.0, 135.0, 92.0, 79.0, 38.0, 16.0, 0.0, 59.0, 113.0, 0.0, 0.0, 77.0, 76.0, 0.0, 0.0, 119.0, 112.0, 26.0, 109.0, 65.0, 86.0, 29.0, 21.0, 0.0, 0.0, 71.0, 19.0, 18.0, 33.0, 0.0, 0.0, 106.0, 19.0, 0.0, 1.0, 0.0, 13.0, 86.0, 55.0, 18.0, 4.0, 48.0, 18.0, 178.0, 150.0, 48.0, 0.0, 30.0, 61.0, 0.0, 10.0, 74.0, 63.0, 32.0, 37.0, 1.0, 0.0, 9.0, 3.0, 48.0, 13.0, 44.0, 50.0, 0.0, 31.0, 9.0, 0.0, 25.0, 31.0, 35.0, 12.0, 54.0, 41.0, 31.0, 28.0, 0.0, 0.0, 15.0, 12.0, 27.0, 0.0, 21.0, 22.0, 19.0, 4.0, 130.0, 117.0, 0.0, 0.0, 0.0, 13.0, 23.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 6.0, 10.0, 19.0, 14.0, 1.0, 7.0, 17.0, 0.0, 0.0, 4.0, 0.0, 0.0, 6.0, 20.0, 35.0, 12.0, 11.0, 19.0, 69.0, 25.0, 45.0, 30.0, 11.0, 38.0, 0.0, 23.0, 40.0, 0.0, 50.0, 8.0, 18.0, 37.0, 0.0, 3.0, 0.0, 8.0, 0.0, 0.0, 23.0, 0.0, 0.0, 1.0, 21.0, 38.0, 7.0, 54.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1083135170081806, "mean_inference_ms": 5.7551175251642555, "mean_action_processing_ms": 0.8748142547568952, "mean_env_wait_ms": 0.6565234906392758, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07762742042541504, "StateBufferConnector_ms": 0.005939841270446777, "ViewRequirementAgentConnector_ms": 1.4487470388412476}, "num_episodes": 18, "episode_return_max": 183.9999999999988, "episode_return_min": -409.89999999999907, "episode_return_mean": -19.12200000000012, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 188.99829590551735, "num_env_steps_trained_throughput_per_sec": 188.99829590551735, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 25421.439, "restore_workers_time_ms": 0.105, "training_step_time_ms": 25421.267, "sample_time_ms": 5600.736, "learn_time_ms": 19775.072, "learn_throughput": 202.275, "synch_weights_time_ms": 39.082}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "training_iteration": 11, "trial_id": "e4caa_00000", "date": "2024-08-13_19-49-10", "timestamp": 1723592950, "time_this_iter_s": 21.26027226448059, "time_total_s": 288.45373702049255, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b036b0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 288.45373702049255, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 88.63870967741937, "ram_util_percent": 84.02258064516127}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6478931119833042, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.037911934575076, "policy_loss": -0.003134224287766431, "vf_loss": 6.040383588952362, "vf_explained_var": 0.018014847033869023, "kl": 0.006625796155824104, "entropy": 1.4333226686432248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2301595852961615, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5171518931313166, "policy_loss": -0.011902704860315357, "vf_loss": 3.5258174382820333, "vf_explained_var": 0.016096445902314765, "kl": 0.016185804539041445, "entropy": 1.4882871064559493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 21735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "env_runners": {"episode_reward_max": 183.9999999999988, "episode_reward_min": -215.30000000000078, "episode_reward_mean": 0.019999999999780443, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -355.89999999999986, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 134.29999999999964, "predator_policy": 178.0}, "policy_reward_mean": {"prey_policy": -33.84500000000002, "predator_policy": 33.855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-164.60000000000008, -89.29999999999988, -179.20000000000002, -39.89999999999975, -71.09999999999971, -27.499999999999815, -160.80000000000024, -215.30000000000078, -161.90000000000106, 94.9999999999992, -101.40000000000059, -109.69999999999993, 49.40000000000043, -67.60000000000002, 40.0000000000003, -205.0, 0.0, -130.1000000000004, 37.599999999999795, -3.5000000000000533, 53.1000000000004, 40.0000000000003, -20.599999999999696, -16.099999999999504, 56.20000000000051, -168.90000000000126, 139.69999999999877, 58.100000000000435, -3.1999999999999598, 94.09999999999843, -3.199999999999944, -94.90000000000052, -10.099999999999653, 11.30000000000021, 43.40000000000037, 45.300000000000296, 9.099999999999978, -1.0, -12.0, -18.700000000000045, -12.999999999999842, 32.90000000000018, 112.89999999999841, 31.200000000000156, 37.80000000000027, -28.199999999999626, 7.500000000000005, 183.9999999999988, 74.19999999999973, -4.39999999999973, 8.000000000000103, 19.799999999999994, -15.400000000000063, 98.49999999999852, 144.49999999999898, 28.20000000000013, 107.39999999999924, 116.3999999999985, -6.0, -29.0, -15.0, 93.09999999999874, 45.40000000000034, 41.000000000000306, 34.3000000000003, 6.5000000000000515, 14.700000000000022, -56.19999999999992, -45.39999999999969, 59.70000000000016, -1.7999999999997862, -13.399999999999741, 100.19999999999905, 61.80000000000033, 89.29999999999923, 56.500000000000504, 94.19999999999868, 14.69999999999998, 8.0, 57.0, 6.1, -63.20000000000148, -40.59999999999994, -96.7000000000015, 87.69999999999881, -61.00000000000032, 79.99999999999926, 18.29999999999876, 113.7999999999987, -18.99999999999963, -101.30000000000072, 16.599999999999977, -142.1000000000011, 30.900000000000176, 166.5999999999988, -190.20000000000024, 19.0, -24.0, -116.59999999999971, 69.0999999999994], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-204.29999999999998, -121.30000000000024, -185.50000000000009, -122.80000000000004, -194.20000000000002, -190.0, -21.999999999999844, -157.9000000000004, -55.60000000000022, -116.5, -135.10000000000002, -9.399999999999958, -195.10000000000005, -162.7000000000002, -196.30000000000052, -268.9999999999998, -42.99999999999976, -355.89999999999986, -0.6999999999999384, 28.700000000000124, -60.70000000000018, -267.69999999999953, -80.80000000000004, -145.90000000000003, 11.599999999999978, 21.80000000000004, -45.39999999999999, -194.2000000000001, 20.000000000000014, 20.000000000000014, -173.0, -185.0, 0.0, 0.0, -150.10000000000036, -211.00000000000003, -158.8, 61.40000000000015, -174.50000000000009, 20.000000000000014, 20.000000000000014, -16.899999999999842, 20.000000000000014, 20.000000000000014, -11.799999999999846, -98.8000000000003, -17.79999999999974, -49.299999999999876, 20.000000000000014, 36.20000000000025, -127.00000000000068, -166.9000000000006, 20.000000000000014, 118.6999999999995, 25.100000000000108, 20.000000000000014, -4.600000000000014, -139.60000000000036, 9.499999999999995, 62.60000000000019, -26.199999999999754, -42.99999999999988, -151.00000000000054, -271.9, -17.79999999999974, -40.29999999999979, -89.20000000000003, 9.500000000000062, 34.40000000000024, -0.9999999999999992, -121.59999999999995, 29.900000000000222, 8.899999999999983, -68.80000000000081, -2.0, 0.0, -6.0, -18.0, -93.40000000000005, 13.699999999999967, 20.000000000000014, -127.00000000000043, 26.000000000000135, -24.099999999999746, 49.400000000000205, 54.50000000000019, -44.79999999999985, 20.000000000000014, 44.30000000000022, -53.50000000000019, 22.700000000000053, -145.9000000000006, -6.399999999999979, -45.099999999999774, 86.59999999999948, 97.39999999999938, -11.499999999999819, 58.700000000000216, -1.0000000000000098, -30.39999999999978, -28.29999999999975, -6.699999999999921, 20.000000000000014, -23.19999999999979, 24.20000000000008, -286.6, 20.000000000000014, 78.4999999999993, 134.29999999999964, -2.799999999999972, -16.599999999999767, 21.80000000000004, 22.10000000000012, 80.29999999999959, 45.20000000000023, 66.20000000000002, -12.0, 0.0, -58.0, 0.0, -14.0, -16.0, 97.39999999999935, -28.29999999999979, 25.40000000000011, 20.000000000000014, 20.000000000000014, 16.999999999999964, 20.90000000000003, 7.399999999999963, 15.79999999999996, -64.30000000000084, -3.099999999999958, -5.1999999999999265, 1.700000000000047, -145.89999999999992, -55.60000000000004, -59.800000000000196, -1.3000000000000047, 20.000000000000014, 20.000000000000014, -59.800000000000566, -45.09999999999987, -31.299999999999862, -4.9000000000000075, 55.10000000000022, 14.899999999999961, 20.90000000000003, 78.49999999999972, -26.199999999999847, 13.699999999999969, 39.80000000000025, 66.19999999999992, 20.000000000000014, -3.0999999999999615, -5.199999999999948, 0.0, 8.0, 17.0, 18.0, -19.899999999999817, -18.999999999999744, -28.899999999999807, -88.30000000000078, -51.39999999999978, -26.19999999999999, -177.4000000000006, -70.30000000000089, 32.60000000000023, 55.10000000000023, -46.29999999999999, -108.70000000000003, 7.399999999999965, 56.60000000000018, -19.899999999999917, 3.200000000000145, 71.29999999999963, 42.50000000000023, -45.099999999999774, -37.89999999999984, -177.4000000000005, -28.899999999999892, -24.099999999999746, 13.699999999999964, -153.70000000000053, -72.39999999999986, -45.09999999999976, 20.000000000000014, 108.1999999999995, 43.400000000000176, -141.70000000000013, -128.50000000000014, 6.0, -10.0, 5.0, -126.0, -114.40000000000003, -125.2, -16.899999999999945, 67.99999999999962], "policy_predator_policy_reward": [31.0, 130.0, 104.0, 115.0, 100.0, 105.0, 73.0, 67.0, 101.0, 0.0, 40.0, 77.0, 99.0, 98.0, 135.0, 115.0, 65.0, 172.0, 36.0, 31.0, 135.0, 92.0, 79.0, 38.0, 16.0, 0.0, 59.0, 113.0, 0.0, 0.0, 77.0, 76.0, 0.0, 0.0, 119.0, 112.0, 26.0, 109.0, 65.0, 86.0, 29.0, 21.0, 0.0, 0.0, 71.0, 19.0, 18.0, 33.0, 0.0, 0.0, 106.0, 19.0, 0.0, 1.0, 0.0, 13.0, 86.0, 55.0, 18.0, 4.0, 48.0, 18.0, 178.0, 150.0, 48.0, 0.0, 30.0, 61.0, 0.0, 10.0, 74.0, 63.0, 32.0, 37.0, 1.0, 0.0, 9.0, 3.0, 48.0, 13.0, 44.0, 50.0, 0.0, 31.0, 9.0, 0.0, 25.0, 31.0, 35.0, 12.0, 54.0, 41.0, 31.0, 28.0, 0.0, 0.0, 15.0, 12.0, 27.0, 0.0, 21.0, 22.0, 19.0, 4.0, 130.0, 117.0, 0.0, 0.0, 0.0, 13.0, 23.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 6.0, 10.0, 19.0, 14.0, 1.0, 7.0, 17.0, 0.0, 0.0, 4.0, 0.0, 0.0, 6.0, 20.0, 35.0, 12.0, 11.0, 19.0, 69.0, 25.0, 45.0, 30.0, 11.0, 38.0, 0.0, 23.0, 40.0, 0.0, 50.0, 8.0, 18.0, 37.0, 0.0, 3.0, 0.0, 8.0, 0.0, 0.0, 23.0, 0.0, 0.0, 1.0, 21.0, 38.0, 7.0, 54.0, 0.0, 37.0, 0.0, 63.0, 88.0, 0.0, 0.0, 5.0, 89.0, 7.0, 9.0, 0.0, 35.0, 0.0, 0.0, 55.0, 9.0, 22.0, 83.0, 11.0, 16.0, 84.0, 0.0, 29.0, 27.0, 8.0, 7.0, 80.0, 0.0, 0.0, 23.0, 57.0, 40.0, 58.0, 65.0, 0.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2896236079082084, "mean_inference_ms": 6.326191275743035, "mean_action_processing_ms": 0.9585458555970889, "mean_env_wait_ms": 0.7053056909718615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07759082317352295, "StateBufferConnector_ms": 0.005956768989562988, "ViewRequirementAgentConnector_ms": 1.4434809684753418}, "num_episodes": 18, "episode_return_max": 183.9999999999988, "episode_return_min": -215.30000000000078, "episode_return_mean": 0.019999999999780443, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 188.31396307217125, "num_env_steps_trained_throughput_per_sec": 188.31396307217125, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 25493.03, "restore_workers_time_ms": 0.041, "training_step_time_ms": 25492.944, "sample_time_ms": 5637.476, "learn_time_ms": 19809.305, "learn_throughput": 201.925, "synch_weights_time_ms": 39.738}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "training_iteration": 12, "trial_id": "e4caa_00000", "date": "2024-08-13_19-49-32", "timestamp": 1723592972, "time_this_iter_s": 21.374049186706543, "time_total_s": 309.8277862071991, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28534c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 309.8277862071991, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 84.02333333333334, "ram_util_percent": 83.97666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.301951530307689, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.669809805148493, "policy_loss": -0.008368546038708359, "vf_loss": 9.677116959687893, "vf_explained_var": 0.03048536802725817, "kl": 0.010613892637213974, "entropy": 1.4454026092297185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2878137225984896, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.74144475674503, "policy_loss": -0.009804569611020346, "vf_loss": 8.74897154878687, "vf_explained_var": 0.019385329598472233, "kl": 0.01138884137832272, "entropy": 1.4817307441322891, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 23625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "env_runners": {"episode_reward_max": 249.0, "episode_reward_min": -327.9000000000001, "episode_reward_mean": -1.7160000000002258, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -318.1, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 181.10000000000002, "predator_policy": 178.0}, "policy_reward_mean": {"prey_policy": -33.558000000000035, "predator_policy": 32.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [37.599999999999795, -3.5000000000000533, 53.1000000000004, 40.0000000000003, -20.599999999999696, -16.099999999999504, 56.20000000000051, -168.90000000000126, 139.69999999999877, 58.100000000000435, -3.1999999999999598, 94.09999999999843, -3.199999999999944, -94.90000000000052, -10.099999999999653, 11.30000000000021, 43.40000000000037, 45.300000000000296, 9.099999999999978, -1.0, -12.0, -18.700000000000045, -12.999999999999842, 32.90000000000018, 112.89999999999841, 31.200000000000156, 37.80000000000027, -28.199999999999626, 7.500000000000005, 183.9999999999988, 74.19999999999973, -4.39999999999973, 8.000000000000103, 19.799999999999994, -15.400000000000063, 98.49999999999852, 144.49999999999898, 28.20000000000013, 107.39999999999924, 116.3999999999985, -6.0, -29.0, -15.0, 93.09999999999874, 45.40000000000034, 41.000000000000306, 34.3000000000003, 6.5000000000000515, 14.700000000000022, -56.19999999999992, -45.39999999999969, 59.70000000000016, -1.7999999999997862, -13.399999999999741, 100.19999999999905, 61.80000000000033, 89.29999999999923, 56.500000000000504, 94.19999999999868, 14.69999999999998, 8.0, 57.0, 6.1, -63.20000000000148, -40.59999999999994, -96.7000000000015, 87.69999999999881, -61.00000000000032, 79.99999999999926, 18.29999999999876, 113.7999999999987, -18.99999999999963, -101.30000000000072, 16.599999999999977, -142.1000000000011, 30.900000000000176, 166.5999999999988, -190.20000000000024, 19.0, -24.0, -116.59999999999971, 69.0999999999994, -1.5999999999998495, -29.099999999999994, -103.99999999999986, -210.59999999999982, -111.50000000000173, -261.09999999999997, 66.39999999999881, 101.00000000000006, -72.40000000000009, -202.9000000000001, -18.80000000000053, -257.79999999999984, 36.20000000000045, -327.9000000000001, -126.0, 249.0, -276.7000000000004, -164.80000000000013], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-158.8, 61.40000000000015, -174.50000000000009, 20.000000000000014, 20.000000000000014, -16.899999999999842, 20.000000000000014, 20.000000000000014, -11.799999999999846, -98.8000000000003, -17.79999999999974, -49.299999999999876, 20.000000000000014, 36.20000000000025, -127.00000000000068, -166.9000000000006, 20.000000000000014, 118.6999999999995, 25.100000000000108, 20.000000000000014, -4.600000000000014, -139.60000000000036, 9.499999999999995, 62.60000000000019, -26.199999999999754, -42.99999999999988, -151.00000000000054, -271.9, -17.79999999999974, -40.29999999999979, -89.20000000000003, 9.500000000000062, 34.40000000000024, -0.9999999999999992, -121.59999999999995, 29.900000000000222, 8.899999999999983, -68.80000000000081, -2.0, 0.0, -6.0, -18.0, -93.40000000000005, 13.699999999999967, 20.000000000000014, -127.00000000000043, 26.000000000000135, -24.099999999999746, 49.400000000000205, 54.50000000000019, -44.79999999999985, 20.000000000000014, 44.30000000000022, -53.50000000000019, 22.700000000000053, -145.9000000000006, -6.399999999999979, -45.099999999999774, 86.59999999999948, 97.39999999999938, -11.499999999999819, 58.700000000000216, -1.0000000000000098, -30.39999999999978, -28.29999999999975, -6.699999999999921, 20.000000000000014, -23.19999999999979, 24.20000000000008, -286.6, 20.000000000000014, 78.4999999999993, 134.29999999999964, -2.799999999999972, -16.599999999999767, 21.80000000000004, 22.10000000000012, 80.29999999999959, 45.20000000000023, 66.20000000000002, -12.0, 0.0, -58.0, 0.0, -14.0, -16.0, 97.39999999999935, -28.29999999999979, 25.40000000000011, 20.000000000000014, 20.000000000000014, 16.999999999999964, 20.90000000000003, 7.399999999999963, 15.79999999999996, -64.30000000000084, -3.099999999999958, -5.1999999999999265, 1.700000000000047, -145.89999999999992, -55.60000000000004, -59.800000000000196, -1.3000000000000047, 20.000000000000014, 20.000000000000014, -59.800000000000566, -45.09999999999987, -31.299999999999862, -4.9000000000000075, 55.10000000000022, 14.899999999999961, 20.90000000000003, 78.49999999999972, -26.199999999999847, 13.699999999999969, 39.80000000000025, 66.19999999999992, 20.000000000000014, -3.0999999999999615, -5.199999999999948, 0.0, 8.0, 17.0, 18.0, -19.899999999999817, -18.999999999999744, -28.899999999999807, -88.30000000000078, -51.39999999999978, -26.19999999999999, -177.4000000000006, -70.30000000000089, 32.60000000000023, 55.10000000000023, -46.29999999999999, -108.70000000000003, 7.399999999999965, 56.60000000000018, -19.899999999999917, 3.200000000000145, 71.29999999999963, 42.50000000000023, -45.099999999999774, -37.89999999999984, -177.4000000000005, -28.899999999999892, -24.099999999999746, 13.699999999999964, -153.70000000000053, -72.39999999999986, -45.09999999999976, 20.000000000000014, 108.1999999999995, 43.400000000000176, -141.70000000000013, -128.50000000000014, 6.0, -10.0, 5.0, -126.0, -114.40000000000003, -125.2, -16.899999999999945, 67.99999999999962, -15.999999999999778, -10.599999999999794, 8.299999999999981, -246.40000000000015, -116.79999999999991, -107.2, -156.40000000000003, -257.2000000000003, -80.80000000000086, -78.70000000000087, -190.0, -263.1, 66.19999999999939, -17.80000000000002, 181.10000000000002, -240.10000000000022, -82.9, -56.499999999999936, -187.90000000000006, -227.00000000000006, -59.199999999999896, -40.59999999999994, -274.0000000000002, -214.8, 24.200000000000216, -1.0000000000000053, -318.1, -281.80000000000007, -55.0, -206.0, 83.0, 108.0, -213.10000000000025, -211.60000000000022, -187.90000000000003, -163.9], "policy_predator_policy_reward": [26.0, 109.0, 65.0, 86.0, 29.0, 21.0, 0.0, 0.0, 71.0, 19.0, 18.0, 33.0, 0.0, 0.0, 106.0, 19.0, 0.0, 1.0, 0.0, 13.0, 86.0, 55.0, 18.0, 4.0, 48.0, 18.0, 178.0, 150.0, 48.0, 0.0, 30.0, 61.0, 0.0, 10.0, 74.0, 63.0, 32.0, 37.0, 1.0, 0.0, 9.0, 3.0, 48.0, 13.0, 44.0, 50.0, 0.0, 31.0, 9.0, 0.0, 25.0, 31.0, 35.0, 12.0, 54.0, 41.0, 31.0, 28.0, 0.0, 0.0, 15.0, 12.0, 27.0, 0.0, 21.0, 22.0, 19.0, 4.0, 130.0, 117.0, 0.0, 0.0, 0.0, 13.0, 23.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 6.0, 10.0, 19.0, 14.0, 1.0, 7.0, 17.0, 0.0, 0.0, 4.0, 0.0, 0.0, 6.0, 20.0, 35.0, 12.0, 11.0, 19.0, 69.0, 25.0, 45.0, 30.0, 11.0, 38.0, 0.0, 23.0, 40.0, 0.0, 50.0, 8.0, 18.0, 37.0, 0.0, 3.0, 0.0, 8.0, 0.0, 0.0, 23.0, 0.0, 0.0, 1.0, 21.0, 38.0, 7.0, 54.0, 0.0, 37.0, 0.0, 63.0, 88.0, 0.0, 0.0, 5.0, 89.0, 7.0, 9.0, 0.0, 35.0, 0.0, 0.0, 55.0, 9.0, 22.0, 83.0, 11.0, 16.0, 84.0, 0.0, 29.0, 27.0, 8.0, 7.0, 80.0, 0.0, 0.0, 23.0, 57.0, 40.0, 58.0, 65.0, 0.0, 18.0, 0.0, 25.0, 107.0, 102.0, 0.0, 120.0, 75.0, 128.0, 0.0, 48.0, 72.0, 120.0, 18.0, 0.0, 116.0, 44.0, 67.0, 0.0, 105.0, 107.0, 44.0, 37.0, 143.0, 88.0, 1.0, 12.0, 129.0, 143.0, 118.0, 17.0, 31.0, 27.0, 25.0, 123.0, 76.0, 111.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.441440756567143, "mean_inference_ms": 6.823052470206562, "mean_action_processing_ms": 1.0313568700960585, "mean_env_wait_ms": 0.7446095019095844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07787251472473145, "StateBufferConnector_ms": 0.007994413375854492, "ViewRequirementAgentConnector_ms": 1.4265542030334473}, "num_episodes": 18, "episode_return_max": 249.0, "episode_return_min": -327.9000000000001, "episode_return_mean": -1.7160000000002258, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 201.52856554061333, "num_env_steps_trained_throughput_per_sec": 201.52856554061333, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 25856.162, "restore_workers_time_ms": 0.048, "training_step_time_ms": 25856.069, "sample_time_ms": 5660.005, "learn_time_ms": 20149.0, "learn_throughput": 198.521, "synch_weights_time_ms": 40.634}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "training_iteration": 13, "trial_id": "e4caa_00000", "date": "2024-08-13_19-49-52", "timestamp": 1723592992, "time_this_iter_s": 19.91746497154236, "time_total_s": 329.74525117874146, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03910d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 329.74525117874146, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 83.46551724137932, "ram_util_percent": 83.91379310344827}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5394369129150633, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.393162530566018, "policy_loss": -0.005828972574737337, "vf_loss": 9.397927868555463, "vf_explained_var": 0.08544096467356202, "kl": 0.010636532154944329, "entropy": 1.475607915151687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4782672498591993, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.12469610133499, "policy_loss": -0.010251871614578974, "vf_loss": 8.132164512866389, "vf_explained_var": 0.0011693501598620541, "kl": 0.013917300455849267, "entropy": 1.4674870084833216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 25515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "env_runners": {"episode_reward_max": 376.0, "episode_reward_min": -451.79999999999995, "episode_reward_mean": -28.88500000000023, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.6, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 213.0}, "policy_reward_mean": {"prey_policy": -63.72750000000005, "predator_policy": 49.285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-28.199999999999626, 7.500000000000005, 183.9999999999988, 74.19999999999973, -4.39999999999973, 8.000000000000103, 19.799999999999994, -15.400000000000063, 98.49999999999852, 144.49999999999898, 28.20000000000013, 107.39999999999924, 116.3999999999985, -6.0, -29.0, -15.0, 93.09999999999874, 45.40000000000034, 41.000000000000306, 34.3000000000003, 6.5000000000000515, 14.700000000000022, -56.19999999999992, -45.39999999999969, 59.70000000000016, -1.7999999999997862, -13.399999999999741, 100.19999999999905, 61.80000000000033, 89.29999999999923, 56.500000000000504, 94.19999999999868, 14.69999999999998, 8.0, 57.0, 6.1, -63.20000000000148, -40.59999999999994, -96.7000000000015, 87.69999999999881, -61.00000000000032, 79.99999999999926, 18.29999999999876, 113.7999999999987, -18.99999999999963, -101.30000000000072, 16.599999999999977, -142.1000000000011, 30.900000000000176, 166.5999999999988, -190.20000000000024, 19.0, -24.0, -116.59999999999971, 69.0999999999994, -1.5999999999998495, -29.099999999999994, -103.99999999999986, -210.59999999999982, -111.50000000000173, -261.09999999999997, 66.39999999999881, 101.00000000000006, -72.40000000000009, -202.9000000000001, -18.80000000000053, -257.79999999999984, 36.20000000000045, -327.9000000000001, -126.0, 249.0, -276.7000000000004, -164.80000000000013, -264.5000000000001, -73.3, -320.40000000000003, 43.399999999999864, 41.50000000000018, -260.09999999999997, -219.20000000000044, 219.99999999999952, -400.8999999999998, -307.4000000000001, -451.79999999999995, -21.60000000000001, -256.10000000000014, 91.79999999999995, 200.79999999999993, -39.49999999999997, 229.99999999999991, 183.09999999999937, -97.7000000000002, -110.89999999999996, -103.19999999999996, -298.0, 376.0, 28.0, -444.50000000000006, -197.10000000000002, 172.1999999999995], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [22.700000000000053, -145.9000000000006, -6.399999999999979, -45.099999999999774, 86.59999999999948, 97.39999999999938, -11.499999999999819, 58.700000000000216, -1.0000000000000098, -30.39999999999978, -28.29999999999975, -6.699999999999921, 20.000000000000014, -23.19999999999979, 24.20000000000008, -286.6, 20.000000000000014, 78.4999999999993, 134.29999999999964, -2.799999999999972, -16.599999999999767, 21.80000000000004, 22.10000000000012, 80.29999999999959, 45.20000000000023, 66.20000000000002, -12.0, 0.0, -58.0, 0.0, -14.0, -16.0, 97.39999999999935, -28.29999999999979, 25.40000000000011, 20.000000000000014, 20.000000000000014, 16.999999999999964, 20.90000000000003, 7.399999999999963, 15.79999999999996, -64.30000000000084, -3.099999999999958, -5.1999999999999265, 1.700000000000047, -145.89999999999992, -55.60000000000004, -59.800000000000196, -1.3000000000000047, 20.000000000000014, 20.000000000000014, -59.800000000000566, -45.09999999999987, -31.299999999999862, -4.9000000000000075, 55.10000000000022, 14.899999999999961, 20.90000000000003, 78.49999999999972, -26.199999999999847, 13.699999999999969, 39.80000000000025, 66.19999999999992, 20.000000000000014, -3.0999999999999615, -5.199999999999948, 0.0, 8.0, 17.0, 18.0, -19.899999999999817, -18.999999999999744, -28.899999999999807, -88.30000000000078, -51.39999999999978, -26.19999999999999, -177.4000000000006, -70.30000000000089, 32.60000000000023, 55.10000000000023, -46.29999999999999, -108.70000000000003, 7.399999999999965, 56.60000000000018, -19.899999999999917, 3.200000000000145, 71.29999999999963, 42.50000000000023, -45.099999999999774, -37.89999999999984, -177.4000000000005, -28.899999999999892, -24.099999999999746, 13.699999999999964, -153.70000000000053, -72.39999999999986, -45.09999999999976, 20.000000000000014, 108.1999999999995, 43.400000000000176, -141.70000000000013, -128.50000000000014, 6.0, -10.0, 5.0, -126.0, -114.40000000000003, -125.2, -16.899999999999945, 67.99999999999962, -15.999999999999778, -10.599999999999794, 8.299999999999981, -246.40000000000015, -116.79999999999991, -107.2, -156.40000000000003, -257.2000000000003, -80.80000000000086, -78.70000000000087, -190.0, -263.1, 66.19999999999939, -17.80000000000002, 181.10000000000002, -240.10000000000022, -82.9, -56.499999999999936, -187.90000000000006, -227.00000000000006, -59.199999999999896, -40.59999999999994, -274.0000000000002, -214.8, 24.200000000000216, -1.0000000000000053, -318.1, -281.80000000000007, -55.0, -206.0, 83.0, 108.0, -213.10000000000025, -211.60000000000022, -187.90000000000003, -163.9, -328.5999999999999, -190.90000000000003, -391.6, 41.299999999999955, -271.90000000000003, -347.5, -116.80000000000005, -58.800000000000075, 93.80000000000001, -253.3, -354.7000000000001, -167.40000000000003, -185.50000000000017, -204.70000000000027, 141.49999999999991, 78.49999999999982, -285.8, -384.1, -195.70000000000005, -330.70000000000005, -360.0999999999999, -372.69999999999993, -246.70000000000002, -57.90000000000005, -192.10000000000005, -169.0000000000001, -240.4, 120.19999999999999, -178.9, 187.7, -242.50000000000003, 26.0, -113.80000000000001, 165.79999999999993, 48.80000000000014, 134.30000000000004, -155.50000000000009, -92.19999999999999, -154.30000000000007, -130.60000000000005, -282.4, -68.80000000000007, -232.0, -278.0, 200.0, 176.0, -320.0, 75.0, -322.3, -299.20000000000005, -190.0, -192.10000000000002, 91.99999999999997, -56.80000000000003], "policy_predator_policy_reward": [54.0, 41.0, 31.0, 28.0, 0.0, 0.0, 15.0, 12.0, 27.0, 0.0, 21.0, 22.0, 19.0, 4.0, 130.0, 117.0, 0.0, 0.0, 0.0, 13.0, 23.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 6.0, 10.0, 19.0, 14.0, 1.0, 7.0, 17.0, 0.0, 0.0, 4.0, 0.0, 0.0, 6.0, 20.0, 35.0, 12.0, 11.0, 19.0, 69.0, 25.0, 45.0, 30.0, 11.0, 38.0, 0.0, 23.0, 40.0, 0.0, 50.0, 8.0, 18.0, 37.0, 0.0, 3.0, 0.0, 8.0, 0.0, 0.0, 23.0, 0.0, 0.0, 1.0, 21.0, 38.0, 7.0, 54.0, 0.0, 37.0, 0.0, 63.0, 88.0, 0.0, 0.0, 5.0, 89.0, 7.0, 9.0, 0.0, 35.0, 0.0, 0.0, 55.0, 9.0, 22.0, 83.0, 11.0, 16.0, 84.0, 0.0, 29.0, 27.0, 8.0, 7.0, 80.0, 0.0, 0.0, 23.0, 57.0, 40.0, 58.0, 65.0, 0.0, 18.0, 0.0, 25.0, 107.0, 102.0, 0.0, 120.0, 75.0, 128.0, 0.0, 48.0, 72.0, 120.0, 18.0, 0.0, 116.0, 44.0, 67.0, 0.0, 105.0, 107.0, 44.0, 37.0, 143.0, 88.0, 1.0, 12.0, 129.0, 143.0, 118.0, 17.0, 31.0, 27.0, 25.0, 123.0, 76.0, 111.0, 104.0, 151.0, 141.0, 136.0, 127.0, 172.0, 133.0, 86.0, 134.0, 67.0, 193.0, 69.0, 113.0, 58.0, 0.0, 0.0, 213.0, 56.0, 165.0, 54.0, 111.0, 170.0, 163.0, 120.0, 0.0, 105.0, 120.0, 92.0, 99.0, 93.0, 109.0, 68.0, 96.0, 82.0, 0.0, 0.0, 84.0, 66.0, 96.0, 78.0, 120.0, 128.0, 129.0, 83.0, 0.0, 0.0, 141.0, 132.0, 168.0, 9.0, 95.0, 90.0, 71.0, 66.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3813800231818028, "mean_inference_ms": 6.618636541186634, "mean_action_processing_ms": 1.0183557636238276, "mean_env_wait_ms": 0.7327681094408822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013601422309875488, "StateBufferConnector_ms": 0.006973981857299805, "ViewRequirementAgentConnector_ms": 0.352167010307312}, "num_episodes": 27, "episode_return_max": 376.0, "episode_return_min": -451.79999999999995, "episode_return_mean": -28.88500000000023, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 204.89254680196248, "num_env_steps_trained_throughput_per_sec": 204.89254680196248, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 26116.662, "restore_workers_time_ms": 0.048, "training_step_time_ms": 26116.568, "sample_time_ms": 5593.996, "learn_time_ms": 20479.618, "learn_throughput": 195.316, "synch_weights_time_ms": 35.89}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "training_iteration": 14, "trial_id": "e4caa_00000", "date": "2024-08-13_19-50-11", "timestamp": 1723593011, "time_this_iter_s": 19.591689825057983, "time_total_s": 349.33694100379944, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28531f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 349.33694100379944, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 84.57407407407408, "ram_util_percent": 83.79629629629632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9905317396713944, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.648892224276507, "policy_loss": -0.005454314006098285, "vf_loss": 8.652540852531555, "vf_explained_var": 0.11137860234452303, "kl": 0.018056862571207873, "entropy": 1.4700890617395834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.339888295499736, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.829365691936836, "policy_loss": -0.0073889175806904125, "vf_loss": 7.835152334132522, "vf_explained_var": 0.00351817942170239, "kl": 0.008011379626220878, "entropy": 1.4415592020781582, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 27405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 376.0, "episode_reward_min": -451.79999999999995, "episode_reward_mean": -36.0860000000002, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -391.6, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 213.0}, "policy_reward_mean": {"prey_policy": -81.58800000000005, "predator_policy": 63.545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [41.000000000000306, 34.3000000000003, 6.5000000000000515, 14.700000000000022, -56.19999999999992, -45.39999999999969, 59.70000000000016, -1.7999999999997862, -13.399999999999741, 100.19999999999905, 61.80000000000033, 89.29999999999923, 56.500000000000504, 94.19999999999868, 14.69999999999998, 8.0, 57.0, 6.1, -63.20000000000148, -40.59999999999994, -96.7000000000015, 87.69999999999881, -61.00000000000032, 79.99999999999926, 18.29999999999876, 113.7999999999987, -18.99999999999963, -101.30000000000072, 16.599999999999977, -142.1000000000011, 30.900000000000176, 166.5999999999988, -190.20000000000024, 19.0, -24.0, -116.59999999999971, 69.0999999999994, -1.5999999999998495, -29.099999999999994, -103.99999999999986, -210.59999999999982, -111.50000000000173, -261.09999999999997, 66.39999999999881, 101.00000000000006, -72.40000000000009, -202.9000000000001, -18.80000000000053, -257.79999999999984, 36.20000000000045, -327.9000000000001, -126.0, 249.0, -276.7000000000004, -164.80000000000013, -264.5000000000001, -73.3, -320.40000000000003, 43.399999999999864, 41.50000000000018, -260.09999999999997, -219.20000000000044, 219.99999999999952, -400.8999999999998, -307.4000000000001, -451.79999999999995, -21.60000000000001, -256.10000000000014, 91.79999999999995, 200.79999999999993, -39.49999999999997, 229.99999999999991, 183.09999999999937, -97.7000000000002, -110.89999999999996, -103.19999999999996, -298.0, 376.0, 28.0, -444.50000000000006, -197.10000000000002, 172.1999999999995, 65.69999999999959, -169.90000000000003, -167.99999999999994, 39.900000000000276, 85.49999999999932, 48.20000000000031, 127.40000000000005, -6.900000000000016, 99.39999999999964, 234.39999999999932, -292.70000000000005, 40.40000000000017, 0.5999999999999468, 66.79999999999956, -50.0, 111.0, 96.49999999999963, -219.39999999999992], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [20.000000000000014, 16.999999999999964, 20.90000000000003, 7.399999999999963, 15.79999999999996, -64.30000000000084, -3.099999999999958, -5.1999999999999265, 1.700000000000047, -145.89999999999992, -55.60000000000004, -59.800000000000196, -1.3000000000000047, 20.000000000000014, 20.000000000000014, -59.800000000000566, -45.09999999999987, -31.299999999999862, -4.9000000000000075, 55.10000000000022, 14.899999999999961, 20.90000000000003, 78.49999999999972, -26.199999999999847, 13.699999999999969, 39.80000000000025, 66.19999999999992, 20.000000000000014, -3.0999999999999615, -5.199999999999948, 0.0, 8.0, 17.0, 18.0, -19.899999999999817, -18.999999999999744, -28.899999999999807, -88.30000000000078, -51.39999999999978, -26.19999999999999, -177.4000000000006, -70.30000000000089, 32.60000000000023, 55.10000000000023, -46.29999999999999, -108.70000000000003, 7.399999999999965, 56.60000000000018, -19.899999999999917, 3.200000000000145, 71.29999999999963, 42.50000000000023, -45.099999999999774, -37.89999999999984, -177.4000000000005, -28.899999999999892, -24.099999999999746, 13.699999999999964, -153.70000000000053, -72.39999999999986, -45.09999999999976, 20.000000000000014, 108.1999999999995, 43.400000000000176, -141.70000000000013, -128.50000000000014, 6.0, -10.0, 5.0, -126.0, -114.40000000000003, -125.2, -16.899999999999945, 67.99999999999962, -15.999999999999778, -10.599999999999794, 8.299999999999981, -246.40000000000015, -116.79999999999991, -107.2, -156.40000000000003, -257.2000000000003, -80.80000000000086, -78.70000000000087, -190.0, -263.1, 66.19999999999939, -17.80000000000002, 181.10000000000002, -240.10000000000022, -82.9, -56.499999999999936, -187.90000000000006, -227.00000000000006, -59.199999999999896, -40.59999999999994, -274.0000000000002, -214.8, 24.200000000000216, -1.0000000000000053, -318.1, -281.80000000000007, -55.0, -206.0, 83.0, 108.0, -213.10000000000025, -211.60000000000022, -187.90000000000003, -163.9, -328.5999999999999, -190.90000000000003, -391.6, 41.299999999999955, -271.90000000000003, -347.5, -116.80000000000005, -58.800000000000075, 93.80000000000001, -253.3, -354.7000000000001, -167.40000000000003, -185.50000000000017, -204.70000000000027, 141.49999999999991, 78.49999999999982, -285.8, -384.1, -195.70000000000005, -330.70000000000005, -360.0999999999999, -372.69999999999993, -246.70000000000002, -57.90000000000005, -192.10000000000005, -169.0000000000001, -240.4, 120.19999999999999, -178.9, 187.7, -242.50000000000003, 26.0, -113.80000000000001, 165.79999999999993, 48.80000000000014, 134.30000000000004, -155.50000000000009, -92.19999999999999, -154.30000000000007, -130.60000000000005, -282.4, -68.80000000000007, -232.0, -278.0, 200.0, 176.0, -320.0, 75.0, -322.3, -299.20000000000005, -190.0, -192.10000000000002, 91.99999999999997, -56.80000000000003, 120.79999999999956, -321.1, -278.3, -221.60000000000002, -156.40000000000003, -160.60000000000002, -240.4, 44.30000000000012, 43.40000000000015, -154.90000000000003, 44.600000000000136, -114.40000000000003, 134.3, -208.9, -347.5, 47.60000000000013, 141.49999999999963, -368.1, 129.80000000000004, 104.59999999999957, -254.3, -240.4, -200.10000000000002, 60.500000000000064, 8.600000000000009, -250.00000000000003, 7.699999999999848, 19.10000000000013, -317.0, 40.0, -32.0, 116.0, 153.79999999999973, -241.3, -189.99999999999997, -303.4000000000002], "policy_predator_policy_reward": [4.0, 0.0, 0.0, 6.0, 20.0, 35.0, 12.0, 11.0, 19.0, 69.0, 25.0, 45.0, 30.0, 11.0, 38.0, 0.0, 23.0, 40.0, 0.0, 50.0, 8.0, 18.0, 37.0, 0.0, 3.0, 0.0, 8.0, 0.0, 0.0, 23.0, 0.0, 0.0, 1.0, 21.0, 38.0, 7.0, 54.0, 0.0, 37.0, 0.0, 63.0, 88.0, 0.0, 0.0, 5.0, 89.0, 7.0, 9.0, 0.0, 35.0, 0.0, 0.0, 55.0, 9.0, 22.0, 83.0, 11.0, 16.0, 84.0, 0.0, 29.0, 27.0, 8.0, 7.0, 80.0, 0.0, 0.0, 23.0, 57.0, 40.0, 58.0, 65.0, 0.0, 18.0, 0.0, 25.0, 107.0, 102.0, 0.0, 120.0, 75.0, 128.0, 0.0, 48.0, 72.0, 120.0, 18.0, 0.0, 116.0, 44.0, 67.0, 0.0, 105.0, 107.0, 44.0, 37.0, 143.0, 88.0, 1.0, 12.0, 129.0, 143.0, 118.0, 17.0, 31.0, 27.0, 25.0, 123.0, 76.0, 111.0, 104.0, 151.0, 141.0, 136.0, 127.0, 172.0, 133.0, 86.0, 134.0, 67.0, 193.0, 69.0, 113.0, 58.0, 0.0, 0.0, 213.0, 56.0, 165.0, 54.0, 111.0, 170.0, 163.0, 120.0, 0.0, 105.0, 120.0, 92.0, 99.0, 93.0, 109.0, 68.0, 96.0, 82.0, 0.0, 0.0, 84.0, 66.0, 96.0, 78.0, 120.0, 128.0, 129.0, 83.0, 0.0, 0.0, 141.0, 132.0, 168.0, 9.0, 95.0, 90.0, 71.0, 66.0, 122.0, 144.0, 117.0, 213.0, 65.0, 84.0, 103.0, 133.0, 85.0, 112.0, 61.0, 57.0, 95.0, 107.0, 175.0, 118.0, 142.0, 184.0, 0.0, 0.0, 138.0, 64.0, 74.0, 106.0, 118.0, 124.0, 40.0, 0.0, 80.0, 147.0, 13.0, 14.0, 140.0, 44.0, 172.0, 102.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3207490778648467, "mean_inference_ms": 6.442928693141733, "mean_action_processing_ms": 0.9613798161494107, "mean_env_wait_ms": 0.7140668940071376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006844520568847656, "StateBufferConnector_ms": 0.008359670639038086, "ViewRequirementAgentConnector_ms": 0.273881196975708}, "num_episodes": 18, "episode_return_max": 376.0, "episode_return_min": -451.79999999999995, "episode_return_mean": -36.0860000000002, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 189.03401403405968, "num_env_steps_trained_throughput_per_sec": 189.03401403405968, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 26541.593, "restore_workers_time_ms": 0.046, "training_step_time_ms": 26541.5, "sample_time_ms": 5740.112, "learn_time_ms": 20759.541, "learn_throughput": 192.682, "synch_weights_time_ms": 33.917}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 15, "trial_id": "e4caa_00000", "date": "2024-08-13_19-50-33", "timestamp": 1723593033, "time_this_iter_s": 21.207675218582153, "time_total_s": 370.5446162223816, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03a4940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 370.5446162223816, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 86.32580645161292, "ram_util_percent": 83.70967741935483}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4079903949820807, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.120046555554426, "policy_loss": -0.005208949250336638, "vf_loss": 8.123488691370323, "vf_explained_var": 0.1628956205945797, "kl": 0.017667805460951418, "entropy": 1.4851916218560839, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2897241664468926, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.537865002950032, "policy_loss": -0.005367545148840657, "vf_loss": 5.541669262275494, "vf_explained_var": 0.002726406142825172, "kl": 0.007816421989419932, "entropy": 1.4402386091373585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 29295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "env_runners": {"episode_reward_max": 376.0, "episode_reward_min": -451.79999999999995, "episode_reward_mean": -37.43000000000025, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -397.5, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 213.0}, "policy_reward_mean": {"prey_policy": -95.37000000000006, "predator_policy": 76.655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-63.20000000000148, -40.59999999999994, -96.7000000000015, 87.69999999999881, -61.00000000000032, 79.99999999999926, 18.29999999999876, 113.7999999999987, -18.99999999999963, -101.30000000000072, 16.599999999999977, -142.1000000000011, 30.900000000000176, 166.5999999999988, -190.20000000000024, 19.0, -24.0, -116.59999999999971, 69.0999999999994, -1.5999999999998495, -29.099999999999994, -103.99999999999986, -210.59999999999982, -111.50000000000173, -261.09999999999997, 66.39999999999881, 101.00000000000006, -72.40000000000009, -202.9000000000001, -18.80000000000053, -257.79999999999984, 36.20000000000045, -327.9000000000001, -126.0, 249.0, -276.7000000000004, -164.80000000000013, -264.5000000000001, -73.3, -320.40000000000003, 43.399999999999864, 41.50000000000018, -260.09999999999997, -219.20000000000044, 219.99999999999952, -400.8999999999998, -307.4000000000001, -451.79999999999995, -21.60000000000001, -256.10000000000014, 91.79999999999995, 200.79999999999993, -39.49999999999997, 229.99999999999991, 183.09999999999937, -97.7000000000002, -110.89999999999996, -103.19999999999996, -298.0, 376.0, 28.0, -444.50000000000006, -197.10000000000002, 172.1999999999995, 65.69999999999959, -169.90000000000003, -167.99999999999994, 39.900000000000276, 85.49999999999932, 48.20000000000031, 127.40000000000005, -6.900000000000016, 99.39999999999964, 234.39999999999932, -292.70000000000005, 40.40000000000017, 0.5999999999999468, 66.79999999999956, -50.0, 111.0, 96.49999999999963, -219.39999999999992, -272.50000000000006, 61.20000000000013, -318.6999999999999, 66.89999999999966, 155.19999999999894, 192.3999999999993, 106.89999999999965, 159.499999999999, -258.9, 157.79999999999882, 57.10000000000015, 100.59999999999954, 36.90000000000015, 133.5999999999988, -290.0, 89.0, 173.19999999999888, 42.60000000000018], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-28.899999999999807, -88.30000000000078, -51.39999999999978, -26.19999999999999, -177.4000000000006, -70.30000000000089, 32.60000000000023, 55.10000000000023, -46.29999999999999, -108.70000000000003, 7.399999999999965, 56.60000000000018, -19.899999999999917, 3.200000000000145, 71.29999999999963, 42.50000000000023, -45.099999999999774, -37.89999999999984, -177.4000000000005, -28.899999999999892, -24.099999999999746, 13.699999999999964, -153.70000000000053, -72.39999999999986, -45.09999999999976, 20.000000000000014, 108.1999999999995, 43.400000000000176, -141.70000000000013, -128.50000000000014, 6.0, -10.0, 5.0, -126.0, -114.40000000000003, -125.2, -16.899999999999945, 67.99999999999962, -15.999999999999778, -10.599999999999794, 8.299999999999981, -246.40000000000015, -116.79999999999991, -107.2, -156.40000000000003, -257.2000000000003, -80.80000000000086, -78.70000000000087, -190.0, -263.1, 66.19999999999939, -17.80000000000002, 181.10000000000002, -240.10000000000022, -82.9, -56.499999999999936, -187.90000000000006, -227.00000000000006, -59.199999999999896, -40.59999999999994, -274.0000000000002, -214.8, 24.200000000000216, -1.0000000000000053, -318.1, -281.80000000000007, -55.0, -206.0, 83.0, 108.0, -213.10000000000025, -211.60000000000022, -187.90000000000003, -163.9, -328.5999999999999, -190.90000000000003, -391.6, 41.299999999999955, -271.90000000000003, -347.5, -116.80000000000005, -58.800000000000075, 93.80000000000001, -253.3, -354.7000000000001, -167.40000000000003, -185.50000000000017, -204.70000000000027, 141.49999999999991, 78.49999999999982, -285.8, -384.1, -195.70000000000005, -330.70000000000005, -360.0999999999999, -372.69999999999993, -246.70000000000002, -57.90000000000005, -192.10000000000005, -169.0000000000001, -240.4, 120.19999999999999, -178.9, 187.7, -242.50000000000003, 26.0, -113.80000000000001, 165.79999999999993, 48.80000000000014, 134.30000000000004, -155.50000000000009, -92.19999999999999, -154.30000000000007, -130.60000000000005, -282.4, -68.80000000000007, -232.0, -278.0, 200.0, 176.0, -320.0, 75.0, -322.3, -299.20000000000005, -190.0, -192.10000000000002, 91.99999999999997, -56.80000000000003, 120.79999999999956, -321.1, -278.3, -221.60000000000002, -156.40000000000003, -160.60000000000002, -240.4, 44.30000000000012, 43.40000000000015, -154.90000000000003, 44.600000000000136, -114.40000000000003, 134.3, -208.9, -347.5, 47.60000000000013, 141.49999999999963, -368.1, 129.80000000000004, 104.59999999999957, -254.3, -240.4, -200.10000000000002, 60.500000000000064, 8.600000000000009, -250.00000000000003, 7.699999999999848, 19.10000000000013, -317.0, 40.0, -32.0, 116.0, 153.79999999999973, -241.3, -189.99999999999997, -303.4000000000002, -238.3, -236.20000000000002, 65.30000000000004, -360.1, -308.6, -350.10000000000025, 98.29999999999964, -282.4, 71.2999999999996, 83.89999999999964, 91.09999999999982, 89.29999999999967, 64.7000000000001, 3.1999999999999793, 79.09999999999951, 52.400000000000105, -345.1, -269.8, 26.600000000000037, 126.19999999999958, 66.19999999999999, -322.1, -374.0999999999999, 103.69999999999953, 97.39999999999945, -355.5, 29.90000000000007, 103.69999999999945, -278.0, -286.0, 47.0, 42.0, 63.200000000000145, 109.99999999999943, -397.5, 58.100000000000186], "policy_predator_policy_reward": [54.0, 0.0, 37.0, 0.0, 63.0, 88.0, 0.0, 0.0, 5.0, 89.0, 7.0, 9.0, 0.0, 35.0, 0.0, 0.0, 55.0, 9.0, 22.0, 83.0, 11.0, 16.0, 84.0, 0.0, 29.0, 27.0, 8.0, 7.0, 80.0, 0.0, 0.0, 23.0, 57.0, 40.0, 58.0, 65.0, 0.0, 18.0, 0.0, 25.0, 107.0, 102.0, 0.0, 120.0, 75.0, 128.0, 0.0, 48.0, 72.0, 120.0, 18.0, 0.0, 116.0, 44.0, 67.0, 0.0, 105.0, 107.0, 44.0, 37.0, 143.0, 88.0, 1.0, 12.0, 129.0, 143.0, 118.0, 17.0, 31.0, 27.0, 25.0, 123.0, 76.0, 111.0, 104.0, 151.0, 141.0, 136.0, 127.0, 172.0, 133.0, 86.0, 134.0, 67.0, 193.0, 69.0, 113.0, 58.0, 0.0, 0.0, 213.0, 56.0, 165.0, 54.0, 111.0, 170.0, 163.0, 120.0, 0.0, 105.0, 120.0, 92.0, 99.0, 93.0, 109.0, 68.0, 96.0, 82.0, 0.0, 0.0, 84.0, 66.0, 96.0, 78.0, 120.0, 128.0, 129.0, 83.0, 0.0, 0.0, 141.0, 132.0, 168.0, 9.0, 95.0, 90.0, 71.0, 66.0, 122.0, 144.0, 117.0, 213.0, 65.0, 84.0, 103.0, 133.0, 85.0, 112.0, 61.0, 57.0, 95.0, 107.0, 175.0, 118.0, 142.0, 184.0, 0.0, 0.0, 138.0, 64.0, 74.0, 106.0, 118.0, 124.0, 40.0, 0.0, 80.0, 147.0, 13.0, 14.0, 140.0, 44.0, 172.0, 102.0, 79.0, 123.0, 180.0, 176.0, 208.0, 132.0, 116.0, 135.0, 0.0, 0.0, 0.0, 12.0, 23.0, 16.0, 27.0, 1.0, 152.0, 204.0, 5.0, 0.0, 155.0, 158.0, 198.0, 173.0, 171.0, 124.0, 0.0, 0.0, 126.0, 148.0, 0.0, 0.0, 0.0, 0.0, 188.0, 194.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2593665755487784, "mean_inference_ms": 6.279159029202233, "mean_action_processing_ms": 0.933096066153632, "mean_env_wait_ms": 0.6987621876331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00592803955078125, "StateBufferConnector_ms": 0.008510589599609375, "ViewRequirementAgentConnector_ms": 0.21975290775299072}, "num_episodes": 18, "episode_return_max": 376.0, "episode_return_min": -451.79999999999995, "episode_return_mean": -37.43000000000025, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 220.9714759355849, "num_env_steps_trained_throughput_per_sec": 220.9714759355849, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 25086.408, "restore_workers_time_ms": 0.044, "training_step_time_ms": 25086.319, "sample_time_ms": 5702.315, "learn_time_ms": 19343.976, "learn_throughput": 206.783, "synch_weights_time_ms": 32.614}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "training_iteration": 16, "trial_id": "e4caa_00000", "date": "2024-08-13_19-50-51", "timestamp": 1723593051, "time_this_iter_s": 18.14553713798523, "time_total_s": 388.6901533603668, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0384c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 388.6901533603668, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 79.32000000000001, "ram_util_percent": 83.71600000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9612084867462278, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.719415248638738, "policy_loss": -0.006192526078866745, "vf_loss": 8.724045795864528, "vf_explained_var": 0.15480762221825817, "kl": 0.01561999937837771, "entropy": 1.46120482380428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.006224689139891, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.105653818322237, "policy_loss": -0.007382285879880545, "vf_loss": 7.1114473428675735, "vf_explained_var": -0.0008239649590991793, "kl": 0.007943765054282759, "entropy": 1.428465302280648, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 31185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "env_runners": {"episode_reward_max": 376.0, "episode_reward_min": -451.79999999999995, "episode_reward_mean": -35.589000000000176, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -456.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 248.0}, "policy_reward_mean": {"prey_policy": -109.17450000000004, "predator_policy": 91.38}, "custom_metrics": {}, "hist_stats": {"episode_reward": [69.0999999999994, -1.5999999999998495, -29.099999999999994, -103.99999999999986, -210.59999999999982, -111.50000000000173, -261.09999999999997, 66.39999999999881, 101.00000000000006, -72.40000000000009, -202.9000000000001, -18.80000000000053, -257.79999999999984, 36.20000000000045, -327.9000000000001, -126.0, 249.0, -276.7000000000004, -164.80000000000013, -264.5000000000001, -73.3, -320.40000000000003, 43.399999999999864, 41.50000000000018, -260.09999999999997, -219.20000000000044, 219.99999999999952, -400.8999999999998, -307.4000000000001, -451.79999999999995, -21.60000000000001, -256.10000000000014, 91.79999999999995, 200.79999999999993, -39.49999999999997, 229.99999999999991, 183.09999999999937, -97.7000000000002, -110.89999999999996, -103.19999999999996, -298.0, 376.0, 28.0, -444.50000000000006, -197.10000000000002, 172.1999999999995, 65.69999999999959, -169.90000000000003, -167.99999999999994, 39.900000000000276, 85.49999999999932, 48.20000000000031, 127.40000000000005, -6.900000000000016, 99.39999999999964, 234.39999999999932, -292.70000000000005, 40.40000000000017, 0.5999999999999468, 66.79999999999956, -50.0, 111.0, 96.49999999999963, -219.39999999999992, -272.50000000000006, 61.20000000000013, -318.6999999999999, 66.89999999999966, 155.19999999999894, 192.3999999999993, 106.89999999999965, 159.499999999999, -258.9, 157.79999999999882, 57.10000000000015, 100.59999999999954, 36.90000000000015, 133.5999999999988, -290.0, 89.0, 173.19999999999888, 42.60000000000018, 35.30000000000024, 62.500000000000135, 250.49999999999952, 184.89999999999978, -278.5, 255.5999999999995, 193.69999999999916, -8.399999999999899, 46.70000000000025, 10.900000000000118, 103.49999999999983, 148.49999999999883, -335.29999999999995, -43.09999999999976, -109.0, -330.0, 57.000000000000114, -382.5], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-16.899999999999945, 67.99999999999962, -15.999999999999778, -10.599999999999794, 8.299999999999981, -246.40000000000015, -116.79999999999991, -107.2, -156.40000000000003, -257.2000000000003, -80.80000000000086, -78.70000000000087, -190.0, -263.1, 66.19999999999939, -17.80000000000002, 181.10000000000002, -240.10000000000022, -82.9, -56.499999999999936, -187.90000000000006, -227.00000000000006, -59.199999999999896, -40.59999999999994, -274.0000000000002, -214.8, 24.200000000000216, -1.0000000000000053, -318.1, -281.80000000000007, -55.0, -206.0, 83.0, 108.0, -213.10000000000025, -211.60000000000022, -187.90000000000003, -163.9, -328.5999999999999, -190.90000000000003, -391.6, 41.299999999999955, -271.90000000000003, -347.5, -116.80000000000005, -58.800000000000075, 93.80000000000001, -253.3, -354.7000000000001, -167.40000000000003, -185.50000000000017, -204.70000000000027, 141.49999999999991, 78.49999999999982, -285.8, -384.1, -195.70000000000005, -330.70000000000005, -360.0999999999999, -372.69999999999993, -246.70000000000002, -57.90000000000005, -192.10000000000005, -169.0000000000001, -240.4, 120.19999999999999, -178.9, 187.7, -242.50000000000003, 26.0, -113.80000000000001, 165.79999999999993, 48.80000000000014, 134.30000000000004, -155.50000000000009, -92.19999999999999, -154.30000000000007, -130.60000000000005, -282.4, -68.80000000000007, -232.0, -278.0, 200.0, 176.0, -320.0, 75.0, -322.3, -299.20000000000005, -190.0, -192.10000000000002, 91.99999999999997, -56.80000000000003, 120.79999999999956, -321.1, -278.3, -221.60000000000002, -156.40000000000003, -160.60000000000002, -240.4, 44.30000000000012, 43.40000000000015, -154.90000000000003, 44.600000000000136, -114.40000000000003, 134.3, -208.9, -347.5, 47.60000000000013, 141.49999999999963, -368.1, 129.80000000000004, 104.59999999999957, -254.3, -240.4, -200.10000000000002, 60.500000000000064, 8.600000000000009, -250.00000000000003, 7.699999999999848, 19.10000000000013, -317.0, 40.0, -32.0, 116.0, 153.79999999999973, -241.3, -189.99999999999997, -303.4000000000002, -238.3, -236.20000000000002, 65.30000000000004, -360.1, -308.6, -350.10000000000025, 98.29999999999964, -282.4, 71.2999999999996, 83.89999999999964, 91.09999999999982, 89.29999999999967, 64.7000000000001, 3.1999999999999793, 79.09999999999951, 52.400000000000105, -345.1, -269.8, 26.600000000000037, 126.19999999999958, 66.19999999999999, -322.1, -374.0999999999999, 103.69999999999953, 97.39999999999945, -355.5, 29.90000000000007, 103.69999999999945, -278.0, -286.0, 47.0, 42.0, 63.200000000000145, 109.99999999999943, -397.5, 58.100000000000186, 16.100000000000012, -17.799999999999756, 71.29999999999968, -409.80000000000007, 164.9, 80.60000000000005, 95.59999999999974, 89.29999999999991, -295.0, -279.5, 59.29999999999999, 194.29999999999998, 53.30000000000014, 121.39999999999975, -377.4, 20.000000000000014, -241.8, 33.50000000000011, 73.69999999999989, -446.8, -279.9, 142.3999999999998, 57.80000000000019, 88.69999999999945, -387.40000000000003, -250.9, 23.600000000000062, -346.7000000000001, -456.0, -50.0, -424.0, -344.0, -276.5, 78.50000000000007, -382.0, -342.5], "policy_predator_policy_reward": [0.0, 18.0, 0.0, 25.0, 107.0, 102.0, 0.0, 120.0, 75.0, 128.0, 0.0, 48.0, 72.0, 120.0, 18.0, 0.0, 116.0, 44.0, 67.0, 0.0, 105.0, 107.0, 44.0, 37.0, 143.0, 88.0, 1.0, 12.0, 129.0, 143.0, 118.0, 17.0, 31.0, 27.0, 25.0, 123.0, 76.0, 111.0, 104.0, 151.0, 141.0, 136.0, 127.0, 172.0, 133.0, 86.0, 134.0, 67.0, 193.0, 69.0, 113.0, 58.0, 0.0, 0.0, 213.0, 56.0, 165.0, 54.0, 111.0, 170.0, 163.0, 120.0, 0.0, 105.0, 120.0, 92.0, 99.0, 93.0, 109.0, 68.0, 96.0, 82.0, 0.0, 0.0, 84.0, 66.0, 96.0, 78.0, 120.0, 128.0, 129.0, 83.0, 0.0, 0.0, 141.0, 132.0, 168.0, 9.0, 95.0, 90.0, 71.0, 66.0, 122.0, 144.0, 117.0, 213.0, 65.0, 84.0, 103.0, 133.0, 85.0, 112.0, 61.0, 57.0, 95.0, 107.0, 175.0, 118.0, 142.0, 184.0, 0.0, 0.0, 138.0, 64.0, 74.0, 106.0, 118.0, 124.0, 40.0, 0.0, 80.0, 147.0, 13.0, 14.0, 140.0, 44.0, 172.0, 102.0, 79.0, 123.0, 180.0, 176.0, 208.0, 132.0, 116.0, 135.0, 0.0, 0.0, 0.0, 12.0, 23.0, 16.0, 27.0, 1.0, 152.0, 204.0, 5.0, 0.0, 155.0, 158.0, 198.0, 173.0, 171.0, 124.0, 0.0, 0.0, 126.0, 148.0, 0.0, 0.0, 0.0, 0.0, 188.0, 194.0, 19.0, 18.0, 198.0, 203.0, 0.0, 5.0, 0.0, 0.0, 128.0, 168.0, 2.0, 0.0, 15.0, 4.0, 175.0, 174.0, 97.0, 158.0, 230.0, 154.0, 93.0, 148.0, 0.0, 2.0, 190.0, 113.0, 109.0, 171.0, 167.0, 230.0, 190.0, 248.0, 155.0, 100.0, 126.0, 216.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1990077402490154, "mean_inference_ms": 6.117799026609427, "mean_action_processing_ms": 0.906201535037942, "mean_env_wait_ms": 0.6840349572598605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005958676338195801, "StateBufferConnector_ms": 0.008475065231323242, "ViewRequirementAgentConnector_ms": 0.18673229217529297}, "num_episodes": 18, "episode_return_max": 376.0, "episode_return_min": -451.79999999999995, "episode_return_mean": -35.589000000000176, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 195.2734448317894, "num_env_steps_trained_throughput_per_sec": 195.2734448317894, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 25510.375, "restore_workers_time_ms": 0.044, "training_step_time_ms": 25510.288, "sample_time_ms": 5674.638, "learn_time_ms": 19794.47, "learn_throughput": 202.077, "synch_weights_time_ms": 34.077}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "training_iteration": 17, "trial_id": "e4caa_00000", "date": "2024-08-13_19-51-11", "timestamp": 1723593071, "time_this_iter_s": 20.61303973197937, "time_total_s": 409.3031930923462, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b286a5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 409.3031930923462, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 80.18666666666667, "ram_util_percent": 83.71666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7704400399059215, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.436042029769332, "policy_loss": -0.00644087439240326, "vf_loss": 9.441083351518742, "vf_explained_var": 0.1627874688181297, "kl": 0.013995674076343516, "entropy": 1.471493908841774, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0221807186250333, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.85646018426885, "policy_loss": -0.007043230631906126, "vf_loss": 5.861954071155932, "vf_explained_var": 8.763547927614242e-05, "kl": 0.007746674151991259, "entropy": 1.4382571117587821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 33075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "env_runners": {"episode_reward_max": 394.20000000000005, "episode_reward_min": -451.79999999999995, "episode_reward_mean": -14.242000000000171, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -456.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 278.0}, "policy_reward_mean": {"prey_policy": -108.51600000000006, "predator_policy": 101.395}, "custom_metrics": {}, "hist_stats": {"episode_reward": [43.399999999999864, 41.50000000000018, -260.09999999999997, -219.20000000000044, 219.99999999999952, -400.8999999999998, -307.4000000000001, -451.79999999999995, -21.60000000000001, -256.10000000000014, 91.79999999999995, 200.79999999999993, -39.49999999999997, 229.99999999999991, 183.09999999999937, -97.7000000000002, -110.89999999999996, -103.19999999999996, -298.0, 376.0, 28.0, -444.50000000000006, -197.10000000000002, 172.1999999999995, 65.69999999999959, -169.90000000000003, -167.99999999999994, 39.900000000000276, 85.49999999999932, 48.20000000000031, 127.40000000000005, -6.900000000000016, 99.39999999999964, 234.39999999999932, -292.70000000000005, 40.40000000000017, 0.5999999999999468, 66.79999999999956, -50.0, 111.0, 96.49999999999963, -219.39999999999992, -272.50000000000006, 61.20000000000013, -318.6999999999999, 66.89999999999966, 155.19999999999894, 192.3999999999993, 106.89999999999965, 159.499999999999, -258.9, 157.79999999999882, 57.10000000000015, 100.59999999999954, 36.90000000000015, 133.5999999999988, -290.0, 89.0, 173.19999999999888, 42.60000000000018, 35.30000000000024, 62.500000000000135, 250.49999999999952, 184.89999999999978, -278.5, 255.5999999999995, 193.69999999999916, -8.399999999999899, 46.70000000000025, 10.900000000000118, 103.49999999999983, 148.49999999999883, -335.29999999999995, -43.09999999999976, -109.0, -330.0, 57.000000000000114, -382.5, 83.99999999999977, -360.1, 89.60000000000004, 209.49999999999895, 113.29999999999954, 264.39999999999975, 45.500000000000114, 53.30000000000012, 165.39999999999975, -391.7, 130.69999999999987, 300.1999999999997, 80.40000000000003, -317.6, 218.19999999999956, -306.1, -258.80000000000007, 201.0999999999994, -257.0, -255.0, -370.5, 394.20000000000005], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-116.80000000000005, -58.800000000000075, 93.80000000000001, -253.3, -354.7000000000001, -167.40000000000003, -185.50000000000017, -204.70000000000027, 141.49999999999991, 78.49999999999982, -285.8, -384.1, -195.70000000000005, -330.70000000000005, -360.0999999999999, -372.69999999999993, -246.70000000000002, -57.90000000000005, -192.10000000000005, -169.0000000000001, -240.4, 120.19999999999999, -178.9, 187.7, -242.50000000000003, 26.0, -113.80000000000001, 165.79999999999993, 48.80000000000014, 134.30000000000004, -155.50000000000009, -92.19999999999999, -154.30000000000007, -130.60000000000005, -282.4, -68.80000000000007, -232.0, -278.0, 200.0, 176.0, -320.0, 75.0, -322.3, -299.20000000000005, -190.0, -192.10000000000002, 91.99999999999997, -56.80000000000003, 120.79999999999956, -321.1, -278.3, -221.60000000000002, -156.40000000000003, -160.60000000000002, -240.4, 44.30000000000012, 43.40000000000015, -154.90000000000003, 44.600000000000136, -114.40000000000003, 134.3, -208.9, -347.5, 47.60000000000013, 141.49999999999963, -368.1, 129.80000000000004, 104.59999999999957, -254.3, -240.4, -200.10000000000002, 60.500000000000064, 8.600000000000009, -250.00000000000003, 7.699999999999848, 19.10000000000013, -317.0, 40.0, -32.0, 116.0, 153.79999999999973, -241.3, -189.99999999999997, -303.4000000000002, -238.3, -236.20000000000002, 65.30000000000004, -360.1, -308.6, -350.10000000000025, 98.29999999999964, -282.4, 71.2999999999996, 83.89999999999964, 91.09999999999982, 89.29999999999967, 64.7000000000001, 3.1999999999999793, 79.09999999999951, 52.400000000000105, -345.1, -269.8, 26.600000000000037, 126.19999999999958, 66.19999999999999, -322.1, -374.0999999999999, 103.69999999999953, 97.39999999999945, -355.5, 29.90000000000007, 103.69999999999945, -278.0, -286.0, 47.0, 42.0, 63.200000000000145, 109.99999999999943, -397.5, 58.100000000000186, 16.100000000000012, -17.799999999999756, 71.29999999999968, -409.80000000000007, 164.9, 80.60000000000005, 95.59999999999974, 89.29999999999991, -295.0, -279.5, 59.29999999999999, 194.29999999999998, 53.30000000000014, 121.39999999999975, -377.4, 20.000000000000014, -241.8, 33.50000000000011, 73.69999999999989, -446.8, -279.9, 142.3999999999998, 57.80000000000019, 88.69999999999945, -387.40000000000003, -250.9, 23.600000000000062, -346.7000000000001, -456.0, -50.0, -424.0, -344.0, -276.5, 78.50000000000007, -382.0, -342.5, 62.900000000000084, -219.90000000000003, -435.8, -439.29999999999995, -448.0, 158.59999999999977, 108.79999999999961, 88.69999999999933, 28.39999999999999, 68.89999999999986, 159.5, 92.89999999999968, 88.39999999999998, -355.9, 64.10000000000014, -306.8, 80.30000000000005, 61.10000000000011, -406.8, -350.9, 144.19999999999982, -262.5, 126.20000000000007, 161.0, -167.19999999999993, 59.60000000000011, -367.6, -357.0, 86.60000000000001, 131.5999999999998, -411.9, -331.2, -330.9, -327.9, 64.99999999999996, 136.09999999999974, -320.0, -356.0, -270.0, -396.0, -451.8, -449.69999999999993, 192.2, 200.0], "policy_predator_policy_reward": [133.0, 86.0, 134.0, 67.0, 193.0, 69.0, 113.0, 58.0, 0.0, 0.0, 213.0, 56.0, 165.0, 54.0, 111.0, 170.0, 163.0, 120.0, 0.0, 105.0, 120.0, 92.0, 99.0, 93.0, 109.0, 68.0, 96.0, 82.0, 0.0, 0.0, 84.0, 66.0, 96.0, 78.0, 120.0, 128.0, 129.0, 83.0, 0.0, 0.0, 141.0, 132.0, 168.0, 9.0, 95.0, 90.0, 71.0, 66.0, 122.0, 144.0, 117.0, 213.0, 65.0, 84.0, 103.0, 133.0, 85.0, 112.0, 61.0, 57.0, 95.0, 107.0, 175.0, 118.0, 142.0, 184.0, 0.0, 0.0, 138.0, 64.0, 74.0, 106.0, 118.0, 124.0, 40.0, 0.0, 80.0, 147.0, 13.0, 14.0, 140.0, 44.0, 172.0, 102.0, 79.0, 123.0, 180.0, 176.0, 208.0, 132.0, 116.0, 135.0, 0.0, 0.0, 0.0, 12.0, 23.0, 16.0, 27.0, 1.0, 152.0, 204.0, 5.0, 0.0, 155.0, 158.0, 198.0, 173.0, 171.0, 124.0, 0.0, 0.0, 126.0, 148.0, 0.0, 0.0, 0.0, 0.0, 188.0, 194.0, 19.0, 18.0, 198.0, 203.0, 0.0, 5.0, 0.0, 0.0, 128.0, 168.0, 2.0, 0.0, 15.0, 4.0, 175.0, 174.0, 97.0, 158.0, 230.0, 154.0, 93.0, 148.0, 0.0, 2.0, 190.0, 113.0, 109.0, 171.0, 167.0, 230.0, 190.0, 248.0, 155.0, 100.0, 126.0, 216.0, 117.0, 124.0, 277.0, 238.0, 166.0, 213.0, 0.0, 12.0, 16.0, 0.0, 0.0, 12.0, 177.0, 136.0, 140.0, 156.0, 24.0, 0.0, 130.0, 236.0, 141.0, 108.0, 0.0, 13.0, 96.0, 92.0, 149.0, 258.0, 0.0, 0.0, 205.0, 232.0, 185.0, 215.0, 0.0, 0.0, 210.0, 209.0, 219.0, 192.0, 278.0, 253.0, 0.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1542956707368166, "mean_inference_ms": 5.964093891817315, "mean_action_processing_ms": 0.8853013318229241, "mean_env_wait_ms": 0.6737541180910409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005330681800842285, "StateBufferConnector_ms": 0.005973100662231445, "ViewRequirementAgentConnector_ms": 0.23506104946136475}, "num_episodes": 22, "episode_return_max": 394.20000000000005, "episode_return_min": -451.79999999999995, "episode_return_mean": -14.242000000000171, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 189.59513230568376, "num_env_steps_trained_throughput_per_sec": 189.59513230568376, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 25679.082, "restore_workers_time_ms": 0.046, "training_step_time_ms": 25678.989, "sample_time_ms": 5676.821, "learn_time_ms": 19961.165, "learn_throughput": 200.389, "synch_weights_time_ms": 33.735}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "training_iteration": 18, "trial_id": "e4caa_00000", "date": "2024-08-13_19-51-33", "timestamp": 1723593093, "time_this_iter_s": 21.155683755874634, "time_total_s": 430.4588768482208, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b035f1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 430.4588768482208, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 82.01666666666667, "ram_util_percent": 83.59666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9435242302203304, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.045499311174666, "policy_loss": -0.0045982665410659535, "vf_loss": 9.048979123433432, "vf_explained_var": 0.2114988315357733, "kl": 0.011184443294536264, "entropy": 1.4435313094860662, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0135644323138333, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.499842364952047, "policy_loss": -0.0101587214541656, "vf_loss": 6.508119640653096, "vf_explained_var": 0.0008795054185958135, "kl": 0.00940715635019104, "entropy": 1.4156134214350786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 34965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "env_runners": {"episode_reward_max": 394.20000000000005, "episode_reward_min": -432.90000000000003, "episode_reward_mean": 25.900999999999843, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -465.69999999999993, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 278.0}, "policy_reward_mean": {"prey_policy": -91.77450000000005, "predator_policy": 104.725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [172.1999999999995, 65.69999999999959, -169.90000000000003, -167.99999999999994, 39.900000000000276, 85.49999999999932, 48.20000000000031, 127.40000000000005, -6.900000000000016, 99.39999999999964, 234.39999999999932, -292.70000000000005, 40.40000000000017, 0.5999999999999468, 66.79999999999956, -50.0, 111.0, 96.49999999999963, -219.39999999999992, -272.50000000000006, 61.20000000000013, -318.6999999999999, 66.89999999999966, 155.19999999999894, 192.3999999999993, 106.89999999999965, 159.499999999999, -258.9, 157.79999999999882, 57.10000000000015, 100.59999999999954, 36.90000000000015, 133.5999999999988, -290.0, 89.0, 173.19999999999888, 42.60000000000018, 35.30000000000024, 62.500000000000135, 250.49999999999952, 184.89999999999978, -278.5, 255.5999999999995, 193.69999999999916, -8.399999999999899, 46.70000000000025, 10.900000000000118, 103.49999999999983, 148.49999999999883, -335.29999999999995, -43.09999999999976, -109.0, -330.0, 57.000000000000114, -382.5, 83.99999999999977, -360.1, 89.60000000000004, 209.49999999999895, 113.29999999999954, 264.39999999999975, 45.500000000000114, 53.30000000000012, 165.39999999999975, -391.7, 130.69999999999987, 300.1999999999997, 80.40000000000003, -317.6, 218.19999999999956, -306.1, -258.80000000000007, 201.0999999999994, -257.0, -255.0, -370.5, 394.20000000000005, -295.20000000000005, 23.00000000000018, 162.8999999999998, 113.49999999999977, 101.79999999999993, 70.2, 301.3999999999998, 155.99999999999997, 64.70000000000013, 121.1, -432.90000000000003, 120.70000000000006, 319.60000000000093, -60.599999999999866, 293.1000000000006, 207.8999999999995, 232.59999999999923, -129.0, 53.0, 326.0, 246.99999999999974, 208.99999999999955, 15.100000000000271], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [91.99999999999997, -56.80000000000003, 120.79999999999956, -321.1, -278.3, -221.60000000000002, -156.40000000000003, -160.60000000000002, -240.4, 44.30000000000012, 43.40000000000015, -154.90000000000003, 44.600000000000136, -114.40000000000003, 134.3, -208.9, -347.5, 47.60000000000013, 141.49999999999963, -368.1, 129.80000000000004, 104.59999999999957, -254.3, -240.4, -200.10000000000002, 60.500000000000064, 8.600000000000009, -250.00000000000003, 7.699999999999848, 19.10000000000013, -317.0, 40.0, -32.0, 116.0, 153.79999999999973, -241.3, -189.99999999999997, -303.4000000000002, -238.3, -236.20000000000002, 65.30000000000004, -360.1, -308.6, -350.10000000000025, 98.29999999999964, -282.4, 71.2999999999996, 83.89999999999964, 91.09999999999982, 89.29999999999967, 64.7000000000001, 3.1999999999999793, 79.09999999999951, 52.400000000000105, -345.1, -269.8, 26.600000000000037, 126.19999999999958, 66.19999999999999, -322.1, -374.0999999999999, 103.69999999999953, 97.39999999999945, -355.5, 29.90000000000007, 103.69999999999945, -278.0, -286.0, 47.0, 42.0, 63.200000000000145, 109.99999999999943, -397.5, 58.100000000000186, 16.100000000000012, -17.799999999999756, 71.29999999999968, -409.80000000000007, 164.9, 80.60000000000005, 95.59999999999974, 89.29999999999991, -295.0, -279.5, 59.29999999999999, 194.29999999999998, 53.30000000000014, 121.39999999999975, -377.4, 20.000000000000014, -241.8, 33.50000000000011, 73.69999999999989, -446.8, -279.9, 142.3999999999998, 57.80000000000019, 88.69999999999945, -387.40000000000003, -250.9, 23.600000000000062, -346.7000000000001, -456.0, -50.0, -424.0, -344.0, -276.5, 78.50000000000007, -382.0, -342.5, 62.900000000000084, -219.90000000000003, -435.8, -439.29999999999995, -448.0, 158.59999999999977, 108.79999999999961, 88.69999999999933, 28.39999999999999, 68.89999999999986, 159.5, 92.89999999999968, 88.39999999999998, -355.9, 64.10000000000014, -306.8, 80.30000000000005, 61.10000000000011, -406.8, -350.9, 144.19999999999982, -262.5, 126.20000000000007, 161.0, -167.19999999999993, 59.60000000000011, -367.6, -357.0, 86.60000000000001, 131.5999999999998, -411.9, -331.2, -330.9, -327.9, 64.99999999999996, 136.09999999999974, -320.0, -356.0, -270.0, -396.0, -451.8, -449.69999999999993, 192.2, 200.0, -327.6, -295.6, 47.00000000000005, -302.99999999999994, -204.09999999999997, 121.99999999999987, -290.8, 116.29999999999978, -247.9, 121.69999999999996, 65.00000000000007, -280.8, 165.79999999999995, 128.6, -423.6, 167.59999999999997, 88.39999999999971, -465.69999999999993, -450.9999999999999, 154.09999999999997, -393.3, -391.6, 147.8, -332.1000000000003, 167.5999999999999, 145.99999999999974, -305.5, -9.099999999999984, 125.30000000000001, 129.79999999999973, 53.60000000000007, 143.29999999999978, 43.4000000000002, 189.19999999999996, -398.0, -131.0, -236.0, 68.0, 152.0, 174.0, 100.99999999999991, 145.99999999999986, -44.20000000000019, 108.19999999999978, -13.600000000000039, -160.29999999999993], "policy_predator_policy_reward": [71.0, 66.0, 122.0, 144.0, 117.0, 213.0, 65.0, 84.0, 103.0, 133.0, 85.0, 112.0, 61.0, 57.0, 95.0, 107.0, 175.0, 118.0, 142.0, 184.0, 0.0, 0.0, 138.0, 64.0, 74.0, 106.0, 118.0, 124.0, 40.0, 0.0, 80.0, 147.0, 13.0, 14.0, 140.0, 44.0, 172.0, 102.0, 79.0, 123.0, 180.0, 176.0, 208.0, 132.0, 116.0, 135.0, 0.0, 0.0, 0.0, 12.0, 23.0, 16.0, 27.0, 1.0, 152.0, 204.0, 5.0, 0.0, 155.0, 158.0, 198.0, 173.0, 171.0, 124.0, 0.0, 0.0, 126.0, 148.0, 0.0, 0.0, 0.0, 0.0, 188.0, 194.0, 19.0, 18.0, 198.0, 203.0, 0.0, 5.0, 0.0, 0.0, 128.0, 168.0, 2.0, 0.0, 15.0, 4.0, 175.0, 174.0, 97.0, 158.0, 230.0, 154.0, 93.0, 148.0, 0.0, 2.0, 190.0, 113.0, 109.0, 171.0, 167.0, 230.0, 190.0, 248.0, 155.0, 100.0, 126.0, 216.0, 117.0, 124.0, 277.0, 238.0, 166.0, 213.0, 0.0, 12.0, 16.0, 0.0, 0.0, 12.0, 177.0, 136.0, 140.0, 156.0, 24.0, 0.0, 130.0, 236.0, 141.0, 108.0, 0.0, 13.0, 96.0, 92.0, 149.0, 258.0, 0.0, 0.0, 205.0, 232.0, 185.0, 215.0, 0.0, 0.0, 210.0, 209.0, 219.0, 192.0, 278.0, 253.0, 0.0, 2.0, 174.0, 154.0, 118.0, 161.0, 103.0, 142.0, 160.0, 128.0, 121.0, 107.0, 122.0, 164.0, 7.0, 0.0, 210.0, 202.0, 204.0, 238.0, 192.0, 226.0, 195.0, 157.0, 177.0, 128.0, 0.0, 6.0, 100.0, 154.0, 26.0, 12.0, 11.0, 0.0, 0.0, 0.0, 180.0, 220.0, 123.0, 98.0, 0.0, 0.0, 0.0, 0.0, 62.0, 83.0, 91.0, 98.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.09075349772722, "mean_inference_ms": 5.845102270861084, "mean_action_processing_ms": 0.8588004276324733, "mean_env_wait_ms": 0.658651151280255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006029486656188965, "StateBufferConnector_ms": 0.006813764572143555, "ViewRequirementAgentConnector_ms": 0.2404998540878296}, "num_episodes": 23, "episode_return_max": 394.20000000000005, "episode_return_min": -432.90000000000003, "episode_return_mean": 25.900999999999843, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.81555442149744, "num_env_steps_trained_throughput_per_sec": 210.81555442149744, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 22016.14, "restore_workers_time_ms": 0.026, "training_step_time_ms": 22016.071, "sample_time_ms": 3509.612, "learn_time_ms": 18470.902, "learn_throughput": 216.557, "synch_weights_time_ms": 29.477}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "training_iteration": 19, "trial_id": "e4caa_00000", "date": "2024-08-13_19-51-52", "timestamp": 1723593112, "time_this_iter_s": 19.025149822235107, "time_total_s": 449.48402667045593, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03840d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 449.48402667045593, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 79.02592592592592, "ram_util_percent": 83.7074074074074}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.271883551658146, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.07415571767817, "policy_loss": -0.0035361047335235136, "vf_loss": 9.076518176346228, "vf_explained_var": 0.2597006731878513, "kl": 0.011736575544354208, "entropy": 1.5069633160318647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.019620700756078, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.212202732020585, "policy_loss": -0.007289764614253447, "vf_loss": 3.218053823867172, "vf_explained_var": 0.0006421918276125792, "kl": 0.007193377767645196, "entropy": 1.4142062068616272, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 36855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 394.20000000000005, "episode_reward_min": -432.90000000000003, "episode_reward_mean": 56.44499999999987, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -465.69999999999993, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 278.0}, "policy_reward_mean": {"prey_policy": -67.91250000000005, "predator_policy": 96.135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-219.39999999999992, -272.50000000000006, 61.20000000000013, -318.6999999999999, 66.89999999999966, 155.19999999999894, 192.3999999999993, 106.89999999999965, 159.499999999999, -258.9, 157.79999999999882, 57.10000000000015, 100.59999999999954, 36.90000000000015, 133.5999999999988, -290.0, 89.0, 173.19999999999888, 42.60000000000018, 35.30000000000024, 62.500000000000135, 250.49999999999952, 184.89999999999978, -278.5, 255.5999999999995, 193.69999999999916, -8.399999999999899, 46.70000000000025, 10.900000000000118, 103.49999999999983, 148.49999999999883, -335.29999999999995, -43.09999999999976, -109.0, -330.0, 57.000000000000114, -382.5, 83.99999999999977, -360.1, 89.60000000000004, 209.49999999999895, 113.29999999999954, 264.39999999999975, 45.500000000000114, 53.30000000000012, 165.39999999999975, -391.7, 130.69999999999987, 300.1999999999997, 80.40000000000003, -317.6, 218.19999999999956, -306.1, -258.80000000000007, 201.0999999999994, -257.0, -255.0, -370.5, 394.20000000000005, -295.20000000000005, 23.00000000000018, 162.8999999999998, 113.49999999999977, 101.79999999999993, 70.2, 301.3999999999998, 155.99999999999997, 64.70000000000013, 121.1, -432.90000000000003, 120.70000000000006, 319.60000000000093, -60.599999999999866, 293.1000000000006, 207.8999999999995, 232.59999999999923, -129.0, 53.0, 326.0, 246.99999999999974, 208.99999999999955, 15.100000000000271, 41.50000000000026, 320.70000000000005, -36.899999999999885, 290.39999999999975, 312.7, 290.3000000000005, 243.39999999999955, 255.09999999999965, 112.29999999999997, 259.99999999999994, 137.30000000000004, 238.89999999999995, 300.9999999999998, 311.9000000000006, -168.0, 184.0, 144.89999999999984, 315.3999999999995], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-189.99999999999997, -303.4000000000002, -238.3, -236.20000000000002, 65.30000000000004, -360.1, -308.6, -350.10000000000025, 98.29999999999964, -282.4, 71.2999999999996, 83.89999999999964, 91.09999999999982, 89.29999999999967, 64.7000000000001, 3.1999999999999793, 79.09999999999951, 52.400000000000105, -345.1, -269.8, 26.600000000000037, 126.19999999999958, 66.19999999999999, -322.1, -374.0999999999999, 103.69999999999953, 97.39999999999945, -355.5, 29.90000000000007, 103.69999999999945, -278.0, -286.0, 47.0, 42.0, 63.200000000000145, 109.99999999999943, -397.5, 58.100000000000186, 16.100000000000012, -17.799999999999756, 71.29999999999968, -409.80000000000007, 164.9, 80.60000000000005, 95.59999999999974, 89.29999999999991, -295.0, -279.5, 59.29999999999999, 194.29999999999998, 53.30000000000014, 121.39999999999975, -377.4, 20.000000000000014, -241.8, 33.50000000000011, 73.69999999999989, -446.8, -279.9, 142.3999999999998, 57.80000000000019, 88.69999999999945, -387.40000000000003, -250.9, 23.600000000000062, -346.7000000000001, -456.0, -50.0, -424.0, -344.0, -276.5, 78.50000000000007, -382.0, -342.5, 62.900000000000084, -219.90000000000003, -435.8, -439.29999999999995, -448.0, 158.59999999999977, 108.79999999999961, 88.69999999999933, 28.39999999999999, 68.89999999999986, 159.5, 92.89999999999968, 88.39999999999998, -355.9, 64.10000000000014, -306.8, 80.30000000000005, 61.10000000000011, -406.8, -350.9, 144.19999999999982, -262.5, 126.20000000000007, 161.0, -167.19999999999993, 59.60000000000011, -367.6, -357.0, 86.60000000000001, 131.5999999999998, -411.9, -331.2, -330.9, -327.9, 64.99999999999996, 136.09999999999974, -320.0, -356.0, -270.0, -396.0, -451.8, -449.69999999999993, 192.2, 200.0, -327.6, -295.6, 47.00000000000005, -302.99999999999994, -204.09999999999997, 121.99999999999987, -290.8, 116.29999999999978, -247.9, 121.69999999999996, 65.00000000000007, -280.8, 165.79999999999995, 128.6, -423.6, 167.59999999999997, 88.39999999999971, -465.69999999999993, -450.9999999999999, 154.09999999999997, -393.3, -391.6, 147.8, -332.1000000000003, 167.5999999999999, 145.99999999999974, -305.5, -9.099999999999984, 125.30000000000001, 129.79999999999973, 53.60000000000007, 143.29999999999978, 43.4000000000002, 189.19999999999996, -398.0, -131.0, -236.0, 68.0, 152.0, 174.0, 100.99999999999991, 145.99999999999986, -44.20000000000019, 108.19999999999978, -13.600000000000039, -160.29999999999993, -244.60000000000002, 46.1000000000002, 178.1, 137.59999999999997, 20.000000000000014, -250.90000000000006, 186.5, 86.90000000000002, 138.79999999999998, 173.89999999999995, 88.99999999999962, 197.3, 183.79999999999998, 59.600000000000016, 157.39999999999998, 76.69999999999999, -277.8, 109.1, 168.79999999999995, 81.19999999999969, -229.9, 180.2, 92.89999999999998, 145.99999999999997, 109.09999999999951, 191.89999999999995, 170.29999999999998, 128.59999999999985, -176.0, -284.0, 65.0, 119.0, 141.19999999999985, -370.3, 194.60000000000002, 120.79999999999978], "policy_predator_policy_reward": [172.0, 102.0, 79.0, 123.0, 180.0, 176.0, 208.0, 132.0, 116.0, 135.0, 0.0, 0.0, 0.0, 12.0, 23.0, 16.0, 27.0, 1.0, 152.0, 204.0, 5.0, 0.0, 155.0, 158.0, 198.0, 173.0, 171.0, 124.0, 0.0, 0.0, 126.0, 148.0, 0.0, 0.0, 0.0, 0.0, 188.0, 194.0, 19.0, 18.0, 198.0, 203.0, 0.0, 5.0, 0.0, 0.0, 128.0, 168.0, 2.0, 0.0, 15.0, 4.0, 175.0, 174.0, 97.0, 158.0, 230.0, 154.0, 93.0, 148.0, 0.0, 2.0, 190.0, 113.0, 109.0, 171.0, 167.0, 230.0, 190.0, 248.0, 155.0, 100.0, 126.0, 216.0, 117.0, 124.0, 277.0, 238.0, 166.0, 213.0, 0.0, 12.0, 16.0, 0.0, 0.0, 12.0, 177.0, 136.0, 140.0, 156.0, 24.0, 0.0, 130.0, 236.0, 141.0, 108.0, 0.0, 13.0, 96.0, 92.0, 149.0, 258.0, 0.0, 0.0, 205.0, 232.0, 185.0, 215.0, 0.0, 0.0, 210.0, 209.0, 219.0, 192.0, 278.0, 253.0, 0.0, 2.0, 174.0, 154.0, 118.0, 161.0, 103.0, 142.0, 160.0, 128.0, 121.0, 107.0, 122.0, 164.0, 7.0, 0.0, 210.0, 202.0, 204.0, 238.0, 192.0, 226.0, 195.0, 157.0, 177.0, 128.0, 0.0, 6.0, 100.0, 154.0, 26.0, 12.0, 11.0, 0.0, 0.0, 0.0, 180.0, 220.0, 123.0, 98.0, 0.0, 0.0, 0.0, 0.0, 62.0, 83.0, 91.0, 98.0, 116.0, 124.0, 5.0, 0.0, 101.0, 93.0, 0.0, 17.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 5.0, 16.0, 147.0, 134.0, 8.0, 2.0, 68.0, 119.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 135.0, 157.0, 0.0, 0.0, 168.0, 206.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.042241086908407, "mean_inference_ms": 5.723569030171505, "mean_action_processing_ms": 0.8391900498602715, "mean_env_wait_ms": 0.6452485152859431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0072896480560302734, "StateBufferConnector_ms": 0.004713892936706543, "ViewRequirementAgentConnector_ms": 0.22848296165466309}, "num_episodes": 18, "episode_return_max": 394.20000000000005, "episode_return_min": -432.90000000000003, "episode_return_mean": 56.44499999999987, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 191.86975833024476, "num_env_steps_trained_throughput_per_sec": 191.86975833024476, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 20244.138, "restore_workers_time_ms": 0.026, "training_step_time_ms": 20244.068, "sample_time_ms": 2850.176, "learn_time_ms": 17365.756, "learn_throughput": 230.338, "synch_weights_time_ms": 22.799}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 20, "trial_id": "e4caa_00000", "date": "2024-08-13_19-52-13", "timestamp": 1723593133, "time_this_iter_s": 20.904353141784668, "time_total_s": 470.3883798122406, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0278af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 470.3883798122406, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 83.25172413793103, "ram_util_percent": 83.6862068965517}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.370167323805037, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.07367146507142, "policy_loss": -0.011887763551727095, "vf_loss": 9.083742804502053, "vf_explained_var": 0.3445496295495008, "kl": 0.018164611517642693, "entropy": 1.4980789102574505, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2243767354381148, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.8240982588636814, "policy_loss": -0.00957928200254818, "vf_loss": 2.831879496952844, "vf_explained_var": 0.00025963483664093824, "kl": 0.008990200773784592, "entropy": 1.3934099492572602, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 38745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "env_runners": {"episode_reward_max": 394.20000000000005, "episode_reward_min": -432.90000000000003, "episode_reward_mean": 92.2529999999999, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -465.69999999999993, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 278.0}, "policy_reward_mean": {"prey_policy": -39.54850000000004, "predator_policy": 85.675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [42.60000000000018, 35.30000000000024, 62.500000000000135, 250.49999999999952, 184.89999999999978, -278.5, 255.5999999999995, 193.69999999999916, -8.399999999999899, 46.70000000000025, 10.900000000000118, 103.49999999999983, 148.49999999999883, -335.29999999999995, -43.09999999999976, -109.0, -330.0, 57.000000000000114, -382.5, 83.99999999999977, -360.1, 89.60000000000004, 209.49999999999895, 113.29999999999954, 264.39999999999975, 45.500000000000114, 53.30000000000012, 165.39999999999975, -391.7, 130.69999999999987, 300.1999999999997, 80.40000000000003, -317.6, 218.19999999999956, -306.1, -258.80000000000007, 201.0999999999994, -257.0, -255.0, -370.5, 394.20000000000005, -295.20000000000005, 23.00000000000018, 162.8999999999998, 113.49999999999977, 101.79999999999993, 70.2, 301.3999999999998, 155.99999999999997, 64.70000000000013, 121.1, -432.90000000000003, 120.70000000000006, 319.60000000000093, -60.599999999999866, 293.1000000000006, 207.8999999999995, 232.59999999999923, -129.0, 53.0, 326.0, 246.99999999999974, 208.99999999999955, 15.100000000000271, 41.50000000000026, 320.70000000000005, -36.899999999999885, 290.39999999999975, 312.7, 290.3000000000005, 243.39999999999955, 255.09999999999965, 112.29999999999997, 259.99999999999994, 137.30000000000004, 238.89999999999995, 300.9999999999998, 311.9000000000006, -168.0, 184.0, 144.89999999999984, 315.3999999999995, 230.0999999999993, 223.59999999999928, 345.10000000000053, 332.4999999999999, 95.49999999999969, 258.0999999999996, 40.9000000000003, 140.7999999999997, 334.29999999999984, 265.89999999999975, 94.40000000000003, 295.60000000000076, 42.50000000000013, 157.19999999999982, 95.0, 231.0, 182.19999999999953, 346.8999999999999], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-397.5, 58.100000000000186, 16.100000000000012, -17.799999999999756, 71.29999999999968, -409.80000000000007, 164.9, 80.60000000000005, 95.59999999999974, 89.29999999999991, -295.0, -279.5, 59.29999999999999, 194.29999999999998, 53.30000000000014, 121.39999999999975, -377.4, 20.000000000000014, -241.8, 33.50000000000011, 73.69999999999989, -446.8, -279.9, 142.3999999999998, 57.80000000000019, 88.69999999999945, -387.40000000000003, -250.9, 23.600000000000062, -346.7000000000001, -456.0, -50.0, -424.0, -344.0, -276.5, 78.50000000000007, -382.0, -342.5, 62.900000000000084, -219.90000000000003, -435.8, -439.29999999999995, -448.0, 158.59999999999977, 108.79999999999961, 88.69999999999933, 28.39999999999999, 68.89999999999986, 159.5, 92.89999999999968, 88.39999999999998, -355.9, 64.10000000000014, -306.8, 80.30000000000005, 61.10000000000011, -406.8, -350.9, 144.19999999999982, -262.5, 126.20000000000007, 161.0, -167.19999999999993, 59.60000000000011, -367.6, -357.0, 86.60000000000001, 131.5999999999998, -411.9, -331.2, -330.9, -327.9, 64.99999999999996, 136.09999999999974, -320.0, -356.0, -270.0, -396.0, -451.8, -449.69999999999993, 192.2, 200.0, -327.6, -295.6, 47.00000000000005, -302.99999999999994, -204.09999999999997, 121.99999999999987, -290.8, 116.29999999999978, -247.9, 121.69999999999996, 65.00000000000007, -280.8, 165.79999999999995, 128.6, -423.6, 167.59999999999997, 88.39999999999971, -465.69999999999993, -450.9999999999999, 154.09999999999997, -393.3, -391.6, 147.8, -332.1000000000003, 167.5999999999999, 145.99999999999974, -305.5, -9.099999999999984, 125.30000000000001, 129.79999999999973, 53.60000000000007, 143.29999999999978, 43.4000000000002, 189.19999999999996, -398.0, -131.0, -236.0, 68.0, 152.0, 174.0, 100.99999999999991, 145.99999999999986, -44.20000000000019, 108.19999999999978, -13.600000000000039, -160.29999999999993, -244.60000000000002, 46.1000000000002, 178.1, 137.59999999999997, 20.000000000000014, -250.90000000000006, 186.5, 86.90000000000002, 138.79999999999998, 173.89999999999995, 88.99999999999962, 197.3, 183.79999999999998, 59.600000000000016, 157.39999999999998, 76.69999999999999, -277.8, 109.1, 168.79999999999995, 81.19999999999969, -229.9, 180.2, 92.89999999999998, 145.99999999999997, 109.09999999999951, 191.89999999999995, 170.29999999999998, 128.59999999999985, -176.0, -284.0, 65.0, 119.0, 141.19999999999985, -370.3, 194.60000000000002, 120.79999999999978, 134.0, 85.09999999999994, 23.60000000000001, 200.0, 182.89999999999995, 162.1999999999999, 150.7999999999998, 172.7, -265.59999999999934, 136.09999999999988, 51.20000000000015, 191.89999999999995, 20.900000000000013, 20.000000000000014, -101.20000000000041, 128.0, 166.7, 167.59999999999985, 96.49999999999996, 169.3999999999998, -364.29999999999995, 139.70000000000002, 110.2999999999997, 170.3, -81.10000000000043, 17.60000000000006, -172.6, 174.8, 8.0, 84.0, 94.0, 124.0, -17.199999999999832, 160.39999999999978, 181.99999999999994, 164.89999999999998], "policy_predator_policy_reward": [188.0, 194.0, 19.0, 18.0, 198.0, 203.0, 0.0, 5.0, 0.0, 0.0, 128.0, 168.0, 2.0, 0.0, 15.0, 4.0, 175.0, 174.0, 97.0, 158.0, 230.0, 154.0, 93.0, 148.0, 0.0, 2.0, 190.0, 113.0, 109.0, 171.0, 167.0, 230.0, 190.0, 248.0, 155.0, 100.0, 126.0, 216.0, 117.0, 124.0, 277.0, 238.0, 166.0, 213.0, 0.0, 12.0, 16.0, 0.0, 0.0, 12.0, 177.0, 136.0, 140.0, 156.0, 24.0, 0.0, 130.0, 236.0, 141.0, 108.0, 0.0, 13.0, 96.0, 92.0, 149.0, 258.0, 0.0, 0.0, 205.0, 232.0, 185.0, 215.0, 0.0, 0.0, 210.0, 209.0, 219.0, 192.0, 278.0, 253.0, 0.0, 2.0, 174.0, 154.0, 118.0, 161.0, 103.0, 142.0, 160.0, 128.0, 121.0, 107.0, 122.0, 164.0, 7.0, 0.0, 210.0, 202.0, 204.0, 238.0, 192.0, 226.0, 195.0, 157.0, 177.0, 128.0, 0.0, 6.0, 100.0, 154.0, 26.0, 12.0, 11.0, 0.0, 0.0, 0.0, 180.0, 220.0, 123.0, 98.0, 0.0, 0.0, 0.0, 0.0, 62.0, 83.0, 91.0, 98.0, 116.0, 124.0, 5.0, 0.0, 101.0, 93.0, 0.0, 17.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 5.0, 16.0, 147.0, 134.0, 8.0, 2.0, 68.0, 119.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 135.0, 157.0, 0.0, 0.0, 168.0, 206.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 129.0, 96.0, 7.0, 8.0, 0.0, 0.0, 63.0, 51.0, 0.0, 0.0, 0.0, 0.0, 136.0, 183.0, 2.0, 13.0, 64.0, 42.0, 88.0, 67.0, 0.0, 3.0, 0.0, 13.0, 15.0, 24.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.998553777232267, "mean_inference_ms": 5.613138223002258, "mean_action_processing_ms": 0.8214500117229947, "mean_env_wait_ms": 0.6328134591481731, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012431621551513672, "StateBufferConnector_ms": 0.004895925521850586, "ViewRequirementAgentConnector_ms": 0.20440387725830078}, "num_episodes": 18, "episode_return_max": 394.20000000000005, "episode_return_min": -432.90000000000003, "episode_return_mean": 92.2529999999999, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.90019749211177, "num_env_steps_trained_throughput_per_sec": 207.90019749211177, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 20051.714, "restore_workers_time_ms": 0.024, "training_step_time_ms": 20051.65, "sample_time_ms": 2799.715, "learn_time_ms": 17225.091, "learn_throughput": 232.219, "synch_weights_time_ms": 22.425}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "training_iteration": 21, "trial_id": "e4caa_00000", "date": "2024-08-13_19-52-32", "timestamp": 1723593152, "time_this_iter_s": 19.30115795135498, "time_total_s": 489.6895377635956, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2853310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 489.6895377635956, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 81.71785714285714, "ram_util_percent": 83.82857142857145}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9354908193545366, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.814190760112943, "policy_loss": -0.009169858567374784, "vf_loss": 8.821756828398932, "vf_explained_var": 0.24257933910561616, "kl": 0.016037733768646832, "entropy": 1.5077171649251666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1514747960936456, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7302513355773593, "policy_loss": -0.0075379039532943535, "vf_loss": 0.736808951356739, "vf_explained_var": 0.03737781549256945, "kl": 0.00490143726709561, "entropy": 1.3816709531678093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 40635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "env_runners": {"episode_reward_max": 394.20000000000005, "episode_reward_min": -432.90000000000003, "episode_reward_mean": 131.62399999999994, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -465.69999999999993, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 278.0}, "policy_reward_mean": {"prey_policy": -2.848000000000038, "predator_policy": 68.66}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-382.5, 83.99999999999977, -360.1, 89.60000000000004, 209.49999999999895, 113.29999999999954, 264.39999999999975, 45.500000000000114, 53.30000000000012, 165.39999999999975, -391.7, 130.69999999999987, 300.1999999999997, 80.40000000000003, -317.6, 218.19999999999956, -306.1, -258.80000000000007, 201.0999999999994, -257.0, -255.0, -370.5, 394.20000000000005, -295.20000000000005, 23.00000000000018, 162.8999999999998, 113.49999999999977, 101.79999999999993, 70.2, 301.3999999999998, 155.99999999999997, 64.70000000000013, 121.1, -432.90000000000003, 120.70000000000006, 319.60000000000093, -60.599999999999866, 293.1000000000006, 207.8999999999995, 232.59999999999923, -129.0, 53.0, 326.0, 246.99999999999974, 208.99999999999955, 15.100000000000271, 41.50000000000026, 320.70000000000005, -36.899999999999885, 290.39999999999975, 312.7, 290.3000000000005, 243.39999999999955, 255.09999999999965, 112.29999999999997, 259.99999999999994, 137.30000000000004, 238.89999999999995, 300.9999999999998, 311.9000000000006, -168.0, 184.0, 144.89999999999984, 315.3999999999995, 230.0999999999993, 223.59999999999928, 345.10000000000053, 332.4999999999999, 95.49999999999969, 258.0999999999996, 40.9000000000003, 140.7999999999997, 334.29999999999984, 265.89999999999975, 94.40000000000003, 295.60000000000076, 42.50000000000013, 157.19999999999982, 95.0, 231.0, 182.19999999999953, 346.8999999999999, 311.8, 199.19999999999985, 303.40000000000015, 315.5, 157.29999999999978, 301.09999999999997, 195.0999999999998, 201.99999999999935, 189.6000000000002, 346.0, 334.8000000000002, 105.09999999999994, 160.9999999999997, 306.4000000000003, -32.0, 331.0, 327.5999999999998, 169.59999999999948], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-382.0, -342.5, 62.900000000000084, -219.90000000000003, -435.8, -439.29999999999995, -448.0, 158.59999999999977, 108.79999999999961, 88.69999999999933, 28.39999999999999, 68.89999999999986, 159.5, 92.89999999999968, 88.39999999999998, -355.9, 64.10000000000014, -306.8, 80.30000000000005, 61.10000000000011, -406.8, -350.9, 144.19999999999982, -262.5, 126.20000000000007, 161.0, -167.19999999999993, 59.60000000000011, -367.6, -357.0, 86.60000000000001, 131.5999999999998, -411.9, -331.2, -330.9, -327.9, 64.99999999999996, 136.09999999999974, -320.0, -356.0, -270.0, -396.0, -451.8, -449.69999999999993, 192.2, 200.0, -327.6, -295.6, 47.00000000000005, -302.99999999999994, -204.09999999999997, 121.99999999999987, -290.8, 116.29999999999978, -247.9, 121.69999999999996, 65.00000000000007, -280.8, 165.79999999999995, 128.6, -423.6, 167.59999999999997, 88.39999999999971, -465.69999999999993, -450.9999999999999, 154.09999999999997, -393.3, -391.6, 147.8, -332.1000000000003, 167.5999999999999, 145.99999999999974, -305.5, -9.099999999999984, 125.30000000000001, 129.79999999999973, 53.60000000000007, 143.29999999999978, 43.4000000000002, 189.19999999999996, -398.0, -131.0, -236.0, 68.0, 152.0, 174.0, 100.99999999999991, 145.99999999999986, -44.20000000000019, 108.19999999999978, -13.600000000000039, -160.29999999999993, -244.60000000000002, 46.1000000000002, 178.1, 137.59999999999997, 20.000000000000014, -250.90000000000006, 186.5, 86.90000000000002, 138.79999999999998, 173.89999999999995, 88.99999999999962, 197.3, 183.79999999999998, 59.600000000000016, 157.39999999999998, 76.69999999999999, -277.8, 109.1, 168.79999999999995, 81.19999999999969, -229.9, 180.2, 92.89999999999998, 145.99999999999997, 109.09999999999951, 191.89999999999995, 170.29999999999998, 128.59999999999985, -176.0, -284.0, 65.0, 119.0, 141.19999999999985, -370.3, 194.60000000000002, 120.79999999999978, 134.0, 85.09999999999994, 23.60000000000001, 200.0, 182.89999999999995, 162.1999999999999, 150.7999999999998, 172.7, -265.59999999999934, 136.09999999999988, 51.20000000000015, 191.89999999999995, 20.900000000000013, 20.000000000000014, -101.20000000000041, 128.0, 166.7, 167.59999999999985, 96.49999999999996, 169.3999999999998, -364.29999999999995, 139.70000000000002, 110.2999999999997, 170.3, -81.10000000000043, 17.60000000000006, -172.6, 174.8, 8.0, 84.0, 94.0, 124.0, -17.199999999999832, 160.39999999999978, 181.99999999999994, 164.89999999999998, 166.7, 145.10000000000002, 80.60000000000004, 77.59999999999994, 147.79999999999995, 149.6, 181.1, 115.40000000000002, 120.8, -11.499999999999917, 114.5, 155.6, -170.20000000000022, 176.3, 179.3, 13.699999999999964, 55.40000000000003, 99.19999999999997, 172.1, 173.89999999999998, 123.7999999999999, 200.0, 20.000000000000014, 37.09999999999998, -47.19999999999981, 162.20000000000002, 158.59999999999977, 147.8, -180.0, 0.0, 197.0, 133.0, 140.89999999999984, 175.7, 20.000000000000014, 149.6], "policy_predator_policy_reward": [126.0, 216.0, 117.0, 124.0, 277.0, 238.0, 166.0, 213.0, 0.0, 12.0, 16.0, 0.0, 0.0, 12.0, 177.0, 136.0, 140.0, 156.0, 24.0, 0.0, 130.0, 236.0, 141.0, 108.0, 0.0, 13.0, 96.0, 92.0, 149.0, 258.0, 0.0, 0.0, 205.0, 232.0, 185.0, 215.0, 0.0, 0.0, 210.0, 209.0, 219.0, 192.0, 278.0, 253.0, 0.0, 2.0, 174.0, 154.0, 118.0, 161.0, 103.0, 142.0, 160.0, 128.0, 121.0, 107.0, 122.0, 164.0, 7.0, 0.0, 210.0, 202.0, 204.0, 238.0, 192.0, 226.0, 195.0, 157.0, 177.0, 128.0, 0.0, 6.0, 100.0, 154.0, 26.0, 12.0, 11.0, 0.0, 0.0, 0.0, 180.0, 220.0, 123.0, 98.0, 0.0, 0.0, 0.0, 0.0, 62.0, 83.0, 91.0, 98.0, 116.0, 124.0, 5.0, 0.0, 101.0, 93.0, 0.0, 17.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 5.0, 16.0, 147.0, 134.0, 8.0, 2.0, 68.0, 119.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 135.0, 157.0, 0.0, 0.0, 168.0, 206.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 129.0, 96.0, 7.0, 8.0, 0.0, 0.0, 63.0, 51.0, 0.0, 0.0, 0.0, 0.0, 136.0, 183.0, 2.0, 13.0, 64.0, 42.0, 88.0, 67.0, 0.0, 3.0, 0.0, 13.0, 15.0, 24.0, 0.0, 0.0, 0.0, 0.0, 28.0, 13.0, 6.0, 0.0, 4.0, 15.0, 12.0, 36.0, 27.0, 4.0, 102.0, 87.0, 3.0, 6.0, 20.0, 15.0, 0.0, 0.0, 11.0, 0.0, 40.0, 8.0, 20.0, 26.0, 0.0, 0.0, 87.0, 61.0, 1.0, 0.0, 11.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9592025151896713, "mean_inference_ms": 5.512557820223422, "mean_action_processing_ms": 0.8051197867789592, "mean_env_wait_ms": 0.621051658617869, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012883305549621582, "StateBufferConnector_ms": 0.004987478256225586, "ViewRequirementAgentConnector_ms": 0.20826172828674316}, "num_episodes": 18, "episode_return_max": 394.20000000000005, "episode_return_min": -432.90000000000003, "episode_return_mean": 131.62399999999994, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 202.1638617198673, "num_env_steps_trained_throughput_per_sec": 202.1638617198673, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 19906.195, "restore_workers_time_ms": 0.024, "training_step_time_ms": 19906.131, "sample_time_ms": 2669.957, "learn_time_ms": 17209.059, "learn_throughput": 232.436, "synch_weights_time_ms": 22.445}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "training_iteration": 22, "trial_id": "e4caa_00000", "date": "2024-08-13_19-52-52", "timestamp": 1723593172, "time_this_iter_s": 19.86038827896118, "time_total_s": 509.54992604255676, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03a25e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 509.54992604255676, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 82.7857142857143, "ram_util_percent": 83.51785714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9539763027713413, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.05769681981001, "policy_loss": -0.0031386605296382514, "vf_loss": 9.059721161574913, "vf_explained_var": 0.13325439316255075, "kl": 0.011143267751120458, "entropy": 1.5090983658240587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1100258839981896, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7266099634309294, "policy_loss": -0.009976071145424925, "vf_loss": 0.7358316339315876, "vf_explained_var": 0.09895732374418349, "kl": 0.007544025683593667, "entropy": 1.3432885566085735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 42525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "env_runners": {"episode_reward_max": 395.0, "episode_reward_min": -432.90000000000003, "episode_reward_mean": 225.91499999999996, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -465.69999999999993, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 238.0}, "policy_reward_mean": {"prey_policy": 75.86249999999997, "predator_policy": 37.095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [101.79999999999993, 70.2, 301.3999999999998, 155.99999999999997, 64.70000000000013, 121.1, -432.90000000000003, 120.70000000000006, 319.60000000000093, -60.599999999999866, 293.1000000000006, 207.8999999999995, 232.59999999999923, -129.0, 53.0, 326.0, 246.99999999999974, 208.99999999999955, 15.100000000000271, 41.50000000000026, 320.70000000000005, -36.899999999999885, 290.39999999999975, 312.7, 290.3000000000005, 243.39999999999955, 255.09999999999965, 112.29999999999997, 259.99999999999994, 137.30000000000004, 238.89999999999995, 300.9999999999998, 311.9000000000006, -168.0, 184.0, 144.89999999999984, 315.3999999999995, 230.0999999999993, 223.59999999999928, 345.10000000000053, 332.4999999999999, 95.49999999999969, 258.0999999999996, 40.9000000000003, 140.7999999999997, 334.29999999999984, 265.89999999999975, 94.40000000000003, 295.60000000000076, 42.50000000000013, 157.19999999999982, 95.0, 231.0, 182.19999999999953, 346.8999999999999, 311.8, 199.19999999999985, 303.40000000000015, 315.5, 157.29999999999978, 301.09999999999997, 195.0999999999998, 201.99999999999935, 189.6000000000002, 346.0, 334.8000000000002, 105.09999999999994, 160.9999999999997, 306.4000000000003, -32.0, 331.0, 327.5999999999998, 169.59999999999948, 306.2, 346.69999999999993, 305.59999999999997, 293.8, 344.4, 341.2, 368.0999999999999, 175.69999999999948, 182.49999999999946, 341.10000000000025, 344.1, 345.9, 311.39999999999964, 374.2, 333.00000000000034, 304.9999999999999, 388.6, 343.10000000000014, 365.2999999999999, 325.2999999999999, 319.9, 381.0, 395.0, 306.0, 335.69999999999993, 385.6000000000001, 319.4000000000001], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-247.9, 121.69999999999996, 65.00000000000007, -280.8, 165.79999999999995, 128.6, -423.6, 167.59999999999997, 88.39999999999971, -465.69999999999993, -450.9999999999999, 154.09999999999997, -393.3, -391.6, 147.8, -332.1000000000003, 167.5999999999999, 145.99999999999974, -305.5, -9.099999999999984, 125.30000000000001, 129.79999999999973, 53.60000000000007, 143.29999999999978, 43.4000000000002, 189.19999999999996, -398.0, -131.0, -236.0, 68.0, 152.0, 174.0, 100.99999999999991, 145.99999999999986, -44.20000000000019, 108.19999999999978, -13.600000000000039, -160.29999999999993, -244.60000000000002, 46.1000000000002, 178.1, 137.59999999999997, 20.000000000000014, -250.90000000000006, 186.5, 86.90000000000002, 138.79999999999998, 173.89999999999995, 88.99999999999962, 197.3, 183.79999999999998, 59.600000000000016, 157.39999999999998, 76.69999999999999, -277.8, 109.1, 168.79999999999995, 81.19999999999969, -229.9, 180.2, 92.89999999999998, 145.99999999999997, 109.09999999999951, 191.89999999999995, 170.29999999999998, 128.59999999999985, -176.0, -284.0, 65.0, 119.0, 141.19999999999985, -370.3, 194.60000000000002, 120.79999999999978, 134.0, 85.09999999999994, 23.60000000000001, 200.0, 182.89999999999995, 162.1999999999999, 150.7999999999998, 172.7, -265.59999999999934, 136.09999999999988, 51.20000000000015, 191.89999999999995, 20.900000000000013, 20.000000000000014, -101.20000000000041, 128.0, 166.7, 167.59999999999985, 96.49999999999996, 169.3999999999998, -364.29999999999995, 139.70000000000002, 110.2999999999997, 170.3, -81.10000000000043, 17.60000000000006, -172.6, 174.8, 8.0, 84.0, 94.0, 124.0, -17.199999999999832, 160.39999999999978, 181.99999999999994, 164.89999999999998, 166.7, 145.10000000000002, 80.60000000000004, 77.59999999999994, 147.79999999999995, 149.6, 181.1, 115.40000000000002, 120.8, -11.499999999999917, 114.5, 155.6, -170.20000000000022, 176.3, 179.3, 13.699999999999964, 55.40000000000003, 99.19999999999997, 172.1, 173.89999999999998, 123.7999999999999, 200.0, 20.000000000000014, 37.09999999999998, -47.19999999999981, 162.20000000000002, 158.59999999999977, 147.8, -180.0, 0.0, 197.0, 133.0, 140.89999999999984, 175.7, 20.000000000000014, 149.6, 144.20000000000002, 143.0, 170.0, 166.70000000000002, 134.0, 149.60000000000002, 128.6, 123.2, 173.89999999999998, 153.5, 117.2, 200.0, 182.0, 184.1, -11.799999999999818, 159.5, 20.90000000000003, 137.6, 139.0999999999999, 185.0, 188.0, 133.1, 182.90000000000003, 158.0, 133.40000000000006, 167.0, 199.1, 163.1, 166.09999999999997, 164.9, 155.0, 116.00000000000003, 194.6, 191.0, 172.99999999999997, 169.1, 188.0, 170.2999999999999, 159.4999999999999, 165.8, 149.9, 146.0, 181.0, 200.0, 200.0, 195.0, 166.0, 112.0, 160.7, 155.0, 191.89999999999998, 193.70000000000002, 144.79999999999998, 149.6], "policy_predator_policy_reward": [121.0, 107.0, 122.0, 164.0, 7.0, 0.0, 210.0, 202.0, 204.0, 238.0, 192.0, 226.0, 195.0, 157.0, 177.0, 128.0, 0.0, 6.0, 100.0, 154.0, 26.0, 12.0, 11.0, 0.0, 0.0, 0.0, 180.0, 220.0, 123.0, 98.0, 0.0, 0.0, 0.0, 0.0, 62.0, 83.0, 91.0, 98.0, 116.0, 124.0, 5.0, 0.0, 101.0, 93.0, 0.0, 17.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 5.0, 16.0, 147.0, 134.0, 8.0, 2.0, 68.0, 119.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 135.0, 157.0, 0.0, 0.0, 168.0, 206.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 129.0, 96.0, 7.0, 8.0, 0.0, 0.0, 63.0, 51.0, 0.0, 0.0, 0.0, 0.0, 136.0, 183.0, 2.0, 13.0, 64.0, 42.0, 88.0, 67.0, 0.0, 3.0, 0.0, 13.0, 15.0, 24.0, 0.0, 0.0, 0.0, 0.0, 28.0, 13.0, 6.0, 0.0, 4.0, 15.0, 12.0, 36.0, 27.0, 4.0, 102.0, 87.0, 3.0, 6.0, 20.0, 15.0, 0.0, 0.0, 11.0, 0.0, 40.0, 8.0, 20.0, 26.0, 0.0, 0.0, 87.0, 61.0, 1.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 19.0, 10.0, 0.0, 0.0, 22.0, 21.0, 21.0, 17.0, 0.0, 12.0, 12.0, 2.0, 0.0, 28.0, 0.0, 11.0, 13.0, 17.0, 0.0, 19.0, 4.0, 5.0, 0.0, 0.0, 11.0, 0.0, 12.0, 0.0, 2.0, 19.0, 15.0, 3.0, 0.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 18.0, 6.0, 0.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 20.0, 0.0, 0.0, 12.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8941481804894897, "mean_inference_ms": 5.344107250635175, "mean_action_processing_ms": 0.7912326593191623, "mean_env_wait_ms": 0.6036096665682805, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013179898262023926, "StateBufferConnector_ms": 0.005795598030090332, "ViewRequirementAgentConnector_ms": 0.20038294792175293}, "num_episodes": 27, "episode_return_max": 395.0, "episode_return_min": -432.90000000000003, "episode_return_mean": 225.91499999999996, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 193.6324158719707, "num_env_steps_trained_throughput_per_sec": 193.6324158719707, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 19987.134, "restore_workers_time_ms": 0.017, "training_step_time_ms": 19987.079, "sample_time_ms": 2625.042, "learn_time_ms": 17335.344, "learn_throughput": 230.742, "synch_weights_time_ms": 21.955}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "training_iteration": 23, "trial_id": "e4caa_00000", "date": "2024-08-13_19-53-13", "timestamp": 1723593193, "time_this_iter_s": 20.698830127716064, "time_total_s": 530.2487561702728, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b035e160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 530.2487561702728, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 86.41034482758621, "ram_util_percent": 83.8206896551724}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.269151768072572, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.098280697272568, "policy_loss": -0.0034752358165052203, "vf_loss": 9.1004211486332, "vf_explained_var": 0.262904363397568, "kl": 0.01334770675901947, "entropy": 1.5273561999911354, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0134498644127417, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.935818962082661, "policy_loss": -0.00928123391494549, "vf_loss": 0.9442319782638046, "vf_explained_var": 0.05302797653687694, "kl": 0.008682189084473843, "entropy": 1.307214633623759, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 44415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "env_runners": {"episode_reward_max": 395.0, "episode_reward_min": -168.0, "episode_reward_mean": 258.2829999999999, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -370.3, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 206.0}, "policy_reward_mean": {"prey_policy": 107.90149999999998, "predator_policy": 21.24}, "custom_metrics": {}, "hist_stats": {"episode_reward": [15.100000000000271, 41.50000000000026, 320.70000000000005, -36.899999999999885, 290.39999999999975, 312.7, 290.3000000000005, 243.39999999999955, 255.09999999999965, 112.29999999999997, 259.99999999999994, 137.30000000000004, 238.89999999999995, 300.9999999999998, 311.9000000000006, -168.0, 184.0, 144.89999999999984, 315.3999999999995, 230.0999999999993, 223.59999999999928, 345.10000000000053, 332.4999999999999, 95.49999999999969, 258.0999999999996, 40.9000000000003, 140.7999999999997, 334.29999999999984, 265.89999999999975, 94.40000000000003, 295.60000000000076, 42.50000000000013, 157.19999999999982, 95.0, 231.0, 182.19999999999953, 346.8999999999999, 311.8, 199.19999999999985, 303.40000000000015, 315.5, 157.29999999999978, 301.09999999999997, 195.0999999999998, 201.99999999999935, 189.6000000000002, 346.0, 334.8000000000002, 105.09999999999994, 160.9999999999997, 306.4000000000003, -32.0, 331.0, 327.5999999999998, 169.59999999999948, 306.2, 346.69999999999993, 305.59999999999997, 293.8, 344.4, 341.2, 368.0999999999999, 175.69999999999948, 182.49999999999946, 341.10000000000025, 344.1, 345.9, 311.39999999999964, 374.2, 333.00000000000034, 304.9999999999999, 388.6, 343.10000000000014, 365.2999999999999, 325.2999999999999, 319.9, 381.0, 395.0, 306.0, 335.69999999999993, 385.6000000000001, 319.4000000000001, 175.89999999999958, 317.7000000000004, 368.5, 305.3, 285.8, 315.1, 357.69999999999993, 298.6999999999997, 196.19999999999996, 334.20000000000005, 349.6000000000002, 315.0, 382.9000000000002, 184.89999999999952, 293.0, 329.0, 271.0999999999997, 357.8], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-13.600000000000039, -160.29999999999993, -244.60000000000002, 46.1000000000002, 178.1, 137.59999999999997, 20.000000000000014, -250.90000000000006, 186.5, 86.90000000000002, 138.79999999999998, 173.89999999999995, 88.99999999999962, 197.3, 183.79999999999998, 59.600000000000016, 157.39999999999998, 76.69999999999999, -277.8, 109.1, 168.79999999999995, 81.19999999999969, -229.9, 180.2, 92.89999999999998, 145.99999999999997, 109.09999999999951, 191.89999999999995, 170.29999999999998, 128.59999999999985, -176.0, -284.0, 65.0, 119.0, 141.19999999999985, -370.3, 194.60000000000002, 120.79999999999978, 134.0, 85.09999999999994, 23.60000000000001, 200.0, 182.89999999999995, 162.1999999999999, 150.7999999999998, 172.7, -265.59999999999934, 136.09999999999988, 51.20000000000015, 191.89999999999995, 20.900000000000013, 20.000000000000014, -101.20000000000041, 128.0, 166.7, 167.59999999999985, 96.49999999999996, 169.3999999999998, -364.29999999999995, 139.70000000000002, 110.2999999999997, 170.3, -81.10000000000043, 17.60000000000006, -172.6, 174.8, 8.0, 84.0, 94.0, 124.0, -17.199999999999832, 160.39999999999978, 181.99999999999994, 164.89999999999998, 166.7, 145.10000000000002, 80.60000000000004, 77.59999999999994, 147.79999999999995, 149.6, 181.1, 115.40000000000002, 120.8, -11.499999999999917, 114.5, 155.6, -170.20000000000022, 176.3, 179.3, 13.699999999999964, 55.40000000000003, 99.19999999999997, 172.1, 173.89999999999998, 123.7999999999999, 200.0, 20.000000000000014, 37.09999999999998, -47.19999999999981, 162.20000000000002, 158.59999999999977, 147.8, -180.0, 0.0, 197.0, 133.0, 140.89999999999984, 175.7, 20.000000000000014, 149.6, 144.20000000000002, 143.0, 170.0, 166.70000000000002, 134.0, 149.60000000000002, 128.6, 123.2, 173.89999999999998, 153.5, 117.2, 200.0, 182.0, 184.1, -11.799999999999818, 159.5, 20.90000000000003, 137.6, 139.0999999999999, 185.0, 188.0, 133.1, 182.90000000000003, 158.0, 133.40000000000006, 167.0, 199.1, 163.1, 166.09999999999997, 164.9, 155.0, 116.00000000000003, 194.6, 191.0, 172.99999999999997, 169.1, 188.0, 170.2999999999999, 159.4999999999999, 165.8, 149.9, 146.0, 181.0, 200.0, 200.0, 195.0, 166.0, 112.0, 160.7, 155.0, 191.89999999999998, 193.70000000000002, 144.79999999999998, 149.6, 140.60000000000008, 26.30000000000012, 116.00000000000001, 175.6999999999999, 200.0, 168.5, 162.8, 105.5, 107.0, 147.8, 155.0, 145.1, 182.9, 174.79999999999987, 151.69999999999987, 130.99999999999994, 48.20000000000012, 95.00000000000001, 200.0, 108.20000000000002, 191.9, 157.69999999999996, 119.0, 149.0, 190.09999999999994, 192.8, 153.5, 16.399999999999977, 116.0, 148.0, 168.0, 134.0, 77.59999999999944, 192.49999999999997, 182.0, 153.8], "policy_predator_policy_reward": [91.0, 98.0, 116.0, 124.0, 5.0, 0.0, 101.0, 93.0, 0.0, 17.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 5.0, 16.0, 147.0, 134.0, 8.0, 2.0, 68.0, 119.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 135.0, 157.0, 0.0, 0.0, 168.0, 206.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 129.0, 96.0, 7.0, 8.0, 0.0, 0.0, 63.0, 51.0, 0.0, 0.0, 0.0, 0.0, 136.0, 183.0, 2.0, 13.0, 64.0, 42.0, 88.0, 67.0, 0.0, 3.0, 0.0, 13.0, 15.0, 24.0, 0.0, 0.0, 0.0, 0.0, 28.0, 13.0, 6.0, 0.0, 4.0, 15.0, 12.0, 36.0, 27.0, 4.0, 102.0, 87.0, 3.0, 6.0, 20.0, 15.0, 0.0, 0.0, 11.0, 0.0, 40.0, 8.0, 20.0, 26.0, 0.0, 0.0, 87.0, 61.0, 1.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 19.0, 10.0, 0.0, 0.0, 22.0, 21.0, 21.0, 17.0, 0.0, 12.0, 12.0, 2.0, 0.0, 28.0, 0.0, 11.0, 13.0, 17.0, 0.0, 19.0, 4.0, 5.0, 0.0, 0.0, 11.0, 0.0, 12.0, 0.0, 2.0, 19.0, 15.0, 3.0, 0.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 18.0, 6.0, 0.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 20.0, 0.0, 0.0, 12.0, 13.0, 0.0, 9.0, 8.0, 18.0, 0.0, 0.0, 21.0, 16.0, 0.0, 31.0, 0.0, 15.0, 0.0, 0.0, 5.0, 11.0, 33.0, 20.0, 17.0, 9.0, 0.0, 0.0, 33.0, 14.0, 0.0, 0.0, 15.0, 0.0, 0.0, 29.0, 3.0, 24.0, 1.0, 0.0, 12.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8572647826621, "mean_inference_ms": 5.248997343093099, "mean_action_processing_ms": 0.7628678457532903, "mean_env_wait_ms": 0.589339383624539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013909459114074707, "StateBufferConnector_ms": 0.004952073097229004, "ViewRequirementAgentConnector_ms": 0.19816076755523682}, "num_episodes": 18, "episode_return_max": 395.0, "episode_return_min": -168.0, "episode_return_mean": 258.2829999999999, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.20359969659273, "num_env_steps_trained_throughput_per_sec": 207.20359969659273, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 19965.36, "restore_workers_time_ms": 0.017, "training_step_time_ms": 19965.304, "sample_time_ms": 2610.468, "learn_time_ms": 17329.33, "learn_throughput": 230.823, "synch_weights_time_ms": 21.313}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "training_iteration": 24, "trial_id": "e4caa_00000", "date": "2024-08-13_19-53-32", "timestamp": 1723593212, "time_this_iter_s": 19.361576080322266, "time_total_s": 549.6103322505951, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2853280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 549.6103322505951, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 79.55555555555556, "ram_util_percent": 83.46296296296296}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9139555447158358, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.408539483408449, "policy_loss": 0.0022952302202592216, "vf_loss": 9.405091552128868, "vf_explained_var": 0.030860428614591165, "kl": 0.01152709733609559, "entropy": 1.5391670209390145, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0522139423107975, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8118088336217971, "policy_loss": -0.007091685462861307, "vf_loss": 0.8181788812199282, "vf_explained_var": 0.1083383628930995, "kl": 0.0072163847558856286, "entropy": 1.3082455745449773, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": -32.0, "episode_reward_mean": 283.98599999999993, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -364.29999999999995, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 183.0}, "policy_reward_mean": {"prey_policy": 127.95799999999997, "predator_policy": 14.035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [315.3999999999995, 230.0999999999993, 223.59999999999928, 345.10000000000053, 332.4999999999999, 95.49999999999969, 258.0999999999996, 40.9000000000003, 140.7999999999997, 334.29999999999984, 265.89999999999975, 94.40000000000003, 295.60000000000076, 42.50000000000013, 157.19999999999982, 95.0, 231.0, 182.19999999999953, 346.8999999999999, 311.8, 199.19999999999985, 303.40000000000015, 315.5, 157.29999999999978, 301.09999999999997, 195.0999999999998, 201.99999999999935, 189.6000000000002, 346.0, 334.8000000000002, 105.09999999999994, 160.9999999999997, 306.4000000000003, -32.0, 331.0, 327.5999999999998, 169.59999999999948, 306.2, 346.69999999999993, 305.59999999999997, 293.8, 344.4, 341.2, 368.0999999999999, 175.69999999999948, 182.49999999999946, 341.10000000000025, 344.1, 345.9, 311.39999999999964, 374.2, 333.00000000000034, 304.9999999999999, 388.6, 343.10000000000014, 365.2999999999999, 325.2999999999999, 319.9, 381.0, 395.0, 306.0, 335.69999999999993, 385.6000000000001, 319.4000000000001, 175.89999999999958, 317.7000000000004, 368.5, 305.3, 285.8, 315.1, 357.69999999999993, 298.6999999999997, 196.19999999999996, 334.20000000000005, 349.6000000000002, 315.0, 382.9000000000002, 184.89999999999952, 293.0, 329.0, 271.0999999999997, 357.8, 351.9, 263.19999999999993, 292.20000000000005, 374.2, 348.5, 318.0, 338.0, 284.70000000000005, 318.5, 346.9000000000001, 368.6, 336.5, 398.2, 344.0, 168.0, 291.0, 339.20000000000005, 343.30000000000007], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [194.60000000000002, 120.79999999999978, 134.0, 85.09999999999994, 23.60000000000001, 200.0, 182.89999999999995, 162.1999999999999, 150.7999999999998, 172.7, -265.59999999999934, 136.09999999999988, 51.20000000000015, 191.89999999999995, 20.900000000000013, 20.000000000000014, -101.20000000000041, 128.0, 166.7, 167.59999999999985, 96.49999999999996, 169.3999999999998, -364.29999999999995, 139.70000000000002, 110.2999999999997, 170.3, -81.10000000000043, 17.60000000000006, -172.6, 174.8, 8.0, 84.0, 94.0, 124.0, -17.199999999999832, 160.39999999999978, 181.99999999999994, 164.89999999999998, 166.7, 145.10000000000002, 80.60000000000004, 77.59999999999994, 147.79999999999995, 149.6, 181.1, 115.40000000000002, 120.8, -11.499999999999917, 114.5, 155.6, -170.20000000000022, 176.3, 179.3, 13.699999999999964, 55.40000000000003, 99.19999999999997, 172.1, 173.89999999999998, 123.7999999999999, 200.0, 20.000000000000014, 37.09999999999998, -47.19999999999981, 162.20000000000002, 158.59999999999977, 147.8, -180.0, 0.0, 197.0, 133.0, 140.89999999999984, 175.7, 20.000000000000014, 149.6, 144.20000000000002, 143.0, 170.0, 166.70000000000002, 134.0, 149.60000000000002, 128.6, 123.2, 173.89999999999998, 153.5, 117.2, 200.0, 182.0, 184.1, -11.799999999999818, 159.5, 20.90000000000003, 137.6, 139.0999999999999, 185.0, 188.0, 133.1, 182.90000000000003, 158.0, 133.40000000000006, 167.0, 199.1, 163.1, 166.09999999999997, 164.9, 155.0, 116.00000000000003, 194.6, 191.0, 172.99999999999997, 169.1, 188.0, 170.2999999999999, 159.4999999999999, 165.8, 149.9, 146.0, 181.0, 200.0, 200.0, 195.0, 166.0, 112.0, 160.7, 155.0, 191.89999999999998, 193.70000000000002, 144.79999999999998, 149.6, 140.60000000000008, 26.30000000000012, 116.00000000000001, 175.6999999999999, 200.0, 168.5, 162.8, 105.5, 107.0, 147.8, 155.0, 145.1, 182.9, 174.79999999999987, 151.69999999999987, 130.99999999999994, 48.20000000000012, 95.00000000000001, 200.0, 108.20000000000002, 191.9, 157.69999999999996, 119.0, 149.0, 190.09999999999994, 192.8, 153.5, 16.399999999999977, 116.0, 148.0, 168.0, 134.0, 77.59999999999944, 192.49999999999997, 182.0, 153.8, 173.9, 158.0, 113.0, 105.19999999999993, 120.80000000000003, 139.39999999999998, 198.2, 173.0, 162.5, 176.0, 196.4, 83.6, 177.2, 156.8, 123.8, 137.89999999999998, 125.0, 150.5, 185.3, 143.59999999999997, 197.0, 164.6, 155.6, 164.89999999999998, 198.2, 200.0, 152.60000000000002, 172.4, 110.0, 19.0, 94.0, 153.0, 134.0, 198.2, 160.1, 165.2], "policy_predator_policy_reward": [0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 5.0, 129.0, 96.0, 7.0, 8.0, 0.0, 0.0, 63.0, 51.0, 0.0, 0.0, 0.0, 0.0, 136.0, 183.0, 2.0, 13.0, 64.0, 42.0, 88.0, 67.0, 0.0, 3.0, 0.0, 13.0, 15.0, 24.0, 0.0, 0.0, 0.0, 0.0, 28.0, 13.0, 6.0, 0.0, 4.0, 15.0, 12.0, 36.0, 27.0, 4.0, 102.0, 87.0, 3.0, 6.0, 20.0, 15.0, 0.0, 0.0, 11.0, 0.0, 40.0, 8.0, 20.0, 26.0, 0.0, 0.0, 87.0, 61.0, 1.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 19.0, 10.0, 0.0, 0.0, 22.0, 21.0, 21.0, 17.0, 0.0, 12.0, 12.0, 2.0, 0.0, 28.0, 0.0, 11.0, 13.0, 17.0, 0.0, 19.0, 4.0, 5.0, 0.0, 0.0, 11.0, 0.0, 12.0, 0.0, 2.0, 19.0, 15.0, 3.0, 0.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 18.0, 6.0, 0.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 20.0, 0.0, 0.0, 12.0, 13.0, 0.0, 9.0, 8.0, 18.0, 0.0, 0.0, 21.0, 16.0, 0.0, 31.0, 0.0, 15.0, 0.0, 0.0, 5.0, 11.0, 33.0, 20.0, 17.0, 9.0, 0.0, 0.0, 33.0, 14.0, 0.0, 0.0, 15.0, 0.0, 0.0, 29.0, 3.0, 24.0, 1.0, 0.0, 12.0, 10.0, 6.0, 14.0, 44.0, 1.0, 13.0, 19.0, 0.0, 3.0, 10.0, 0.0, 28.0, 10.0, 0.0, 4.0, 23.0, 0.0, 18.0, 25.0, 0.0, 18.0, 0.0, 7.0, 16.0, 0.0, 0.0, 0.0, 16.0, 3.0, 13.0, 26.0, 12.0, 32.0, 0.0, 7.0, 0.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8235135027218488, "mean_inference_ms": 5.160800228789876, "mean_action_processing_ms": 0.8052425984787667, "mean_env_wait_ms": 0.5784330401161409, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012325167655944824, "StateBufferConnector_ms": 0.005108833312988281, "ViewRequirementAgentConnector_ms": 0.20833492279052734}, "num_episodes": 18, "episode_return_max": 398.2, "episode_return_min": -32.0, "episode_return_mean": 283.98599999999993, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 173.90012927131963, "num_env_steps_trained_throughput_per_sec": 173.90012927131963, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 20149.51, "restore_workers_time_ms": 0.018, "training_step_time_ms": 20149.454, "sample_time_ms": 2813.348, "learn_time_ms": 17311.025, "learn_throughput": 231.067, "synch_weights_time_ms": 21.713}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 25, "trial_id": "e4caa_00000", "date": "2024-08-13_19-53-55", "timestamp": 1723593235, "time_this_iter_s": 23.094029903411865, "time_total_s": 572.704362154007, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b036b550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 572.704362154007, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 80.36060606060606, "ram_util_percent": 83.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.437989859385465, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.171717399516433, "policy_loss": -0.0005442163914382931, "vf_loss": 9.170394313650787, "vf_explained_var": 0.06496060897433568, "kl": 0.018673192833027027, "entropy": 1.5001976152576466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.120418663299273, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.129372987671504, "policy_loss": -0.013095809608481076, "vf_loss": 1.1409385028339567, "vf_explained_var": 0.08154247898273367, "kl": 0.015302970954403009, "entropy": 1.2551136392134208, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 48195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": -32.0, "episode_reward_mean": 303.436, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -180.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 102.0}, "policy_reward_mean": {"prey_policy": 140.393, "predator_policy": 11.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [346.8999999999999, 311.8, 199.19999999999985, 303.40000000000015, 315.5, 157.29999999999978, 301.09999999999997, 195.0999999999998, 201.99999999999935, 189.6000000000002, 346.0, 334.8000000000002, 105.09999999999994, 160.9999999999997, 306.4000000000003, -32.0, 331.0, 327.5999999999998, 169.59999999999948, 306.2, 346.69999999999993, 305.59999999999997, 293.8, 344.4, 341.2, 368.0999999999999, 175.69999999999948, 182.49999999999946, 341.10000000000025, 344.1, 345.9, 311.39999999999964, 374.2, 333.00000000000034, 304.9999999999999, 388.6, 343.10000000000014, 365.2999999999999, 325.2999999999999, 319.9, 381.0, 395.0, 306.0, 335.69999999999993, 385.6000000000001, 319.4000000000001, 175.89999999999958, 317.7000000000004, 368.5, 305.3, 285.8, 315.1, 357.69999999999993, 298.6999999999997, 196.19999999999996, 334.20000000000005, 349.6000000000002, 315.0, 382.9000000000002, 184.89999999999952, 293.0, 329.0, 271.0999999999997, 357.8, 351.9, 263.19999999999993, 292.20000000000005, 374.2, 348.5, 318.0, 338.0, 284.70000000000005, 318.5, 346.9000000000001, 368.6, 336.5, 398.2, 344.0, 168.0, 291.0, 339.20000000000005, 343.30000000000007, 363.5, 221.3, 278.29999999999995, 233.0, 339.0, 373.2000000000004, 335.20000000000005, 209.0, 370.40000000000003, 344.79999999999995, 361.3, 368.80000000000064, 305.6, 214.5999999999998, 328.0, 339.0, 300.69999999999993, 339.39999999999986], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [181.99999999999994, 164.89999999999998, 166.7, 145.10000000000002, 80.60000000000004, 77.59999999999994, 147.79999999999995, 149.6, 181.1, 115.40000000000002, 120.8, -11.499999999999917, 114.5, 155.6, -170.20000000000022, 176.3, 179.3, 13.699999999999964, 55.40000000000003, 99.19999999999997, 172.1, 173.89999999999998, 123.7999999999999, 200.0, 20.000000000000014, 37.09999999999998, -47.19999999999981, 162.20000000000002, 158.59999999999977, 147.8, -180.0, 0.0, 197.0, 133.0, 140.89999999999984, 175.7, 20.000000000000014, 149.6, 144.20000000000002, 143.0, 170.0, 166.70000000000002, 134.0, 149.60000000000002, 128.6, 123.2, 173.89999999999998, 153.5, 117.2, 200.0, 182.0, 184.1, -11.799999999999818, 159.5, 20.90000000000003, 137.6, 139.0999999999999, 185.0, 188.0, 133.1, 182.90000000000003, 158.0, 133.40000000000006, 167.0, 199.1, 163.1, 166.09999999999997, 164.9, 155.0, 116.00000000000003, 194.6, 191.0, 172.99999999999997, 169.1, 188.0, 170.2999999999999, 159.4999999999999, 165.8, 149.9, 146.0, 181.0, 200.0, 200.0, 195.0, 166.0, 112.0, 160.7, 155.0, 191.89999999999998, 193.70000000000002, 144.79999999999998, 149.6, 140.60000000000008, 26.30000000000012, 116.00000000000001, 175.6999999999999, 200.0, 168.5, 162.8, 105.5, 107.0, 147.8, 155.0, 145.1, 182.9, 174.79999999999987, 151.69999999999987, 130.99999999999994, 48.20000000000012, 95.00000000000001, 200.0, 108.20000000000002, 191.9, 157.69999999999996, 119.0, 149.0, 190.09999999999994, 192.8, 153.5, 16.399999999999977, 116.0, 148.0, 168.0, 134.0, 77.59999999999944, 192.49999999999997, 182.0, 153.8, 173.9, 158.0, 113.0, 105.19999999999993, 120.80000000000003, 139.39999999999998, 198.2, 173.0, 162.5, 176.0, 196.4, 83.6, 177.2, 156.8, 123.8, 137.89999999999998, 125.0, 150.5, 185.3, 143.59999999999997, 197.0, 164.6, 155.6, 164.89999999999998, 198.2, 200.0, 152.60000000000002, 172.4, 110.0, 19.0, 94.0, 153.0, 134.0, 198.2, 160.1, 165.2, 179.0, 177.5, 146.0, 23.29999999999997, 152.0, 80.30000000000001, -3.3999999999999915, 157.4, 197.0, 113.0, 180.49999999999994, 190.69999999999996, 180.2, 155.0, 119.6, 13.399999999999991, 161.29999999999998, 190.1, 138.50000000000003, 173.29999999999998, 174.79999999999984, 186.5, 166.69999999999985, 199.1, 149.6, 134.0, 140.3, 56.30000000000003, 130.0, 178.0, 147.0, 170.0, 140.0, 121.69999999999996, 199.1, 125.29999999999993], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 28.0, 13.0, 6.0, 0.0, 4.0, 15.0, 12.0, 36.0, 27.0, 4.0, 102.0, 87.0, 3.0, 6.0, 20.0, 15.0, 0.0, 0.0, 11.0, 0.0, 40.0, 8.0, 20.0, 26.0, 0.0, 0.0, 87.0, 61.0, 1.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 19.0, 10.0, 0.0, 0.0, 22.0, 21.0, 21.0, 17.0, 0.0, 12.0, 12.0, 2.0, 0.0, 28.0, 0.0, 11.0, 13.0, 17.0, 0.0, 19.0, 4.0, 5.0, 0.0, 0.0, 11.0, 0.0, 12.0, 0.0, 2.0, 19.0, 15.0, 3.0, 0.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 18.0, 6.0, 0.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 20.0, 0.0, 0.0, 12.0, 13.0, 0.0, 9.0, 8.0, 18.0, 0.0, 0.0, 21.0, 16.0, 0.0, 31.0, 0.0, 15.0, 0.0, 0.0, 5.0, 11.0, 33.0, 20.0, 17.0, 9.0, 0.0, 0.0, 33.0, 14.0, 0.0, 0.0, 15.0, 0.0, 0.0, 29.0, 3.0, 24.0, 1.0, 0.0, 12.0, 10.0, 6.0, 14.0, 44.0, 1.0, 13.0, 19.0, 0.0, 3.0, 10.0, 0.0, 28.0, 10.0, 0.0, 4.0, 23.0, 0.0, 18.0, 25.0, 0.0, 18.0, 0.0, 7.0, 16.0, 0.0, 0.0, 0.0, 16.0, 3.0, 13.0, 26.0, 12.0, 32.0, 0.0, 7.0, 0.0, 18.0, 0.0, 7.0, 17.0, 35.0, 15.0, 31.0, 0.0, 79.0, 2.0, 27.0, 0.0, 2.0, 0.0, 0.0, 64.0, 12.0, 12.0, 7.0, 24.0, 9.0, 0.0, 0.0, 3.0, 0.0, 0.0, 22.0, 18.0, 0.0, 3.0, 17.0, 12.0, 10.0, 0.0, 39.0, 15.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.799337533057054, "mean_inference_ms": 5.100744177334509, "mean_action_processing_ms": 0.8500130397105744, "mean_env_wait_ms": 0.5710828460293803, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010166525840759277, "StateBufferConnector_ms": 0.0045909881591796875, "ViewRequirementAgentConnector_ms": 0.22935950756072998}, "num_episodes": 18, "episode_return_max": 398.2, "episode_return_min": -32.0, "episode_return_mean": 303.436, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 169.8803049332972, "num_env_steps_trained_throughput_per_sec": 169.8803049332972, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 20693.922, "restore_workers_time_ms": 0.02, "training_step_time_ms": 20693.861, "sample_time_ms": 3026.789, "learn_time_ms": 17641.289, "learn_throughput": 226.741, "synch_weights_time_ms": 21.909}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "training_iteration": 26, "trial_id": "e4caa_00000", "date": "2024-08-13_19-54-19", "timestamp": 1723593259, "time_this_iter_s": 23.62824821472168, "time_total_s": 596.3326103687286, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03a4430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 596.3326103687286, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 88.37575757575758, "ram_util_percent": 83.82121212121211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.462647016370107, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 9.040644664108438, "policy_loss": -0.003562158160158014, "vf_loss": 9.042894720148157, "vf_explained_var": 0.14984109174637567, "kl": 0.01312098712864022, "entropy": 1.4722742528511734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0310192256377488, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7240524660342584, "policy_loss": -0.005297216286429416, "vf_loss": 1.7283483258315495, "vf_explained_var": 0.04703804443752955, "kl": 0.01001359703195868, "entropy": 1.1889329646630262, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 50085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 95.60000000000002, "episode_reward_mean": 309.81, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -85.29999999999995, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 87.0}, "policy_reward_mean": {"prey_policy": 142.7, "predator_policy": 12.205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [293.8, 344.4, 341.2, 368.0999999999999, 175.69999999999948, 182.49999999999946, 341.10000000000025, 344.1, 345.9, 311.39999999999964, 374.2, 333.00000000000034, 304.9999999999999, 388.6, 343.10000000000014, 365.2999999999999, 325.2999999999999, 319.9, 381.0, 395.0, 306.0, 335.69999999999993, 385.6000000000001, 319.4000000000001, 175.89999999999958, 317.7000000000004, 368.5, 305.3, 285.8, 315.1, 357.69999999999993, 298.6999999999997, 196.19999999999996, 334.20000000000005, 349.6000000000002, 315.0, 382.9000000000002, 184.89999999999952, 293.0, 329.0, 271.0999999999997, 357.8, 351.9, 263.19999999999993, 292.20000000000005, 374.2, 348.5, 318.0, 338.0, 284.70000000000005, 318.5, 346.9000000000001, 368.6, 336.5, 398.2, 344.0, 168.0, 291.0, 339.20000000000005, 343.30000000000007, 363.5, 221.3, 278.29999999999995, 233.0, 339.0, 373.2000000000004, 335.20000000000005, 209.0, 370.40000000000003, 344.79999999999995, 361.3, 368.80000000000064, 305.6, 214.5999999999998, 328.0, 339.0, 300.69999999999993, 339.39999999999986, 256.4, 348.7000000000001, 361.6, 311.5999999999999, 320.0, 253.89999999999986, 340.0, 280.5, 95.60000000000002, 342.4, 175.59999999999997, 340.5000000000001, 332.19999999999993, 158.2, 372.9, 144.2, 295.1, 339.4, 284.0, 325.0, 299.49999999999994, 189.99999999999994], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [128.6, 123.2, 173.89999999999998, 153.5, 117.2, 200.0, 182.0, 184.1, -11.799999999999818, 159.5, 20.90000000000003, 137.6, 139.0999999999999, 185.0, 188.0, 133.1, 182.90000000000003, 158.0, 133.40000000000006, 167.0, 199.1, 163.1, 166.09999999999997, 164.9, 155.0, 116.00000000000003, 194.6, 191.0, 172.99999999999997, 169.1, 188.0, 170.2999999999999, 159.4999999999999, 165.8, 149.9, 146.0, 181.0, 200.0, 200.0, 195.0, 166.0, 112.0, 160.7, 155.0, 191.89999999999998, 193.70000000000002, 144.79999999999998, 149.6, 140.60000000000008, 26.30000000000012, 116.00000000000001, 175.6999999999999, 200.0, 168.5, 162.8, 105.5, 107.0, 147.8, 155.0, 145.1, 182.9, 174.79999999999987, 151.69999999999987, 130.99999999999994, 48.20000000000012, 95.00000000000001, 200.0, 108.20000000000002, 191.9, 157.69999999999996, 119.0, 149.0, 190.09999999999994, 192.8, 153.5, 16.399999999999977, 116.0, 148.0, 168.0, 134.0, 77.59999999999944, 192.49999999999997, 182.0, 153.8, 173.9, 158.0, 113.0, 105.19999999999993, 120.80000000000003, 139.39999999999998, 198.2, 173.0, 162.5, 176.0, 196.4, 83.6, 177.2, 156.8, 123.8, 137.89999999999998, 125.0, 150.5, 185.3, 143.59999999999997, 197.0, 164.6, 155.6, 164.89999999999998, 198.2, 200.0, 152.60000000000002, 172.4, 110.0, 19.0, 94.0, 153.0, 134.0, 198.2, 160.1, 165.2, 179.0, 177.5, 146.0, 23.29999999999997, 152.0, 80.30000000000001, -3.3999999999999915, 157.4, 197.0, 113.0, 180.49999999999994, 190.69999999999996, 180.2, 155.0, 119.6, 13.399999999999991, 161.29999999999998, 190.1, 138.50000000000003, 173.29999999999998, 174.79999999999984, 186.5, 166.69999999999985, 199.1, 149.6, 134.0, 140.3, 56.30000000000003, 130.0, 178.0, 147.0, 170.0, 140.0, 121.69999999999996, 199.1, 125.29999999999993, 91.99999999999997, 124.4, 170.29999999999998, 178.3999999999999, 164.0, 185.59999999999994, 151.39999999999998, 138.2, 92.6, 196.4, 108.79999999999993, 94.1, 161.0, 161.0, 139.4, 88.10000000000002, 74.9, -85.29999999999995, 185.0, 130.4, -4.600000000000001, 111.19999999999997, 115.4, 190.09999999999994, 161.6, 140.59999999999997, 38.9, 47.3, 185.0, 182.9, 28.699999999999996, 30.50000000000002, 157.09999999999997, 104.0, 169.4, 149.0, 129.0, 120.0, 141.0, 165.0, 161.3, 135.20000000000002, -35.2, 123.19999999999997], "policy_predator_policy_reward": [21.0, 21.0, 17.0, 0.0, 12.0, 12.0, 2.0, 0.0, 28.0, 0.0, 11.0, 13.0, 17.0, 0.0, 19.0, 4.0, 5.0, 0.0, 0.0, 11.0, 0.0, 12.0, 0.0, 2.0, 19.0, 15.0, 3.0, 0.0, 1.0, 0.0, 4.0, 3.0, 0.0, 0.0, 18.0, 6.0, 0.0, 0.0, 0.0, 0.0, 28.0, 0.0, 0.0, 20.0, 0.0, 0.0, 12.0, 13.0, 0.0, 9.0, 8.0, 18.0, 0.0, 0.0, 21.0, 16.0, 0.0, 31.0, 0.0, 15.0, 0.0, 0.0, 5.0, 11.0, 33.0, 20.0, 17.0, 9.0, 0.0, 0.0, 33.0, 14.0, 0.0, 0.0, 15.0, 0.0, 0.0, 29.0, 3.0, 24.0, 1.0, 0.0, 12.0, 10.0, 6.0, 14.0, 44.0, 1.0, 13.0, 19.0, 0.0, 3.0, 10.0, 0.0, 28.0, 10.0, 0.0, 4.0, 23.0, 0.0, 18.0, 25.0, 0.0, 18.0, 0.0, 7.0, 16.0, 0.0, 0.0, 0.0, 16.0, 3.0, 13.0, 26.0, 12.0, 32.0, 0.0, 7.0, 0.0, 18.0, 0.0, 7.0, 17.0, 35.0, 15.0, 31.0, 0.0, 79.0, 2.0, 27.0, 0.0, 2.0, 0.0, 0.0, 64.0, 12.0, 12.0, 7.0, 24.0, 9.0, 0.0, 0.0, 3.0, 0.0, 0.0, 22.0, 18.0, 0.0, 3.0, 17.0, 12.0, 10.0, 0.0, 39.0, 15.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 12.0, 22.0, 0.0, 31.0, 0.0, 15.0, 36.0, 18.0, 0.0, 40.0, 13.0, 19.0, 87.0, 5.0, 22.0, 67.0, 2.0, 24.0, 11.0, 16.0, 14.0, 0.0, 72.0, 5.0, 0.0, 57.0, 28.0, 23.0, 11.0, 17.0, 4.0, 11.0, 24.0, 1.0, 18.0, 0.0, 3.0, 87.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.782667880007078, "mean_inference_ms": 5.041385186840309, "mean_action_processing_ms": 0.9056305179597046, "mean_env_wait_ms": 0.5665965050752222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023712158203125, "StateBufferConnector_ms": 0.005596637725830078, "ViewRequirementAgentConnector_ms": 0.25040316581726074}, "num_episodes": 22, "episode_return_max": 398.2, "episode_return_min": 95.60000000000002, "episode_return_mean": 309.81, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.97514991137277, "num_env_steps_trained_throughput_per_sec": 207.97514991137277, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 20568.819, "restore_workers_time_ms": 0.02, "training_step_time_ms": 20568.757, "sample_time_ms": 3084.973, "learn_time_ms": 17460.312, "learn_throughput": 229.091, "synch_weights_time_ms": 19.348}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "training_iteration": 27, "trial_id": "e4caa_00000", "date": "2024-08-13_19-54-38", "timestamp": 1723593278, "time_this_iter_s": 19.285247802734375, "time_total_s": 615.617858171463, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b289a4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 615.617858171463, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 85.08928571428574, "ram_util_percent": 83.77142857142859}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.064201951815338, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.912448673904258, "policy_loss": 0.000801521950036721, "vf_loss": 8.909631541670946, "vf_explained_var": 0.08272902735326657, "kl": 0.02015600003890988, "entropy": 1.4855045510347558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9718014287097113, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9218864149832853, "policy_loss": -0.006302352418147382, "vf_loss": 1.9275064276639746, "vf_explained_var": 0.01749071680679523, "kl": 0.006823359137325453, "entropy": 1.0498829970599481, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 51975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 94.0, "episode_reward_mean": 292.406, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -171.7, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 123.0}, "policy_reward_mean": {"prey_policy": 130.56799999999998, "predator_policy": 15.635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.4000000000001, 175.89999999999958, 317.7000000000004, 368.5, 305.3, 285.8, 315.1, 357.69999999999993, 298.6999999999997, 196.19999999999996, 334.20000000000005, 349.6000000000002, 315.0, 382.9000000000002, 184.89999999999952, 293.0, 329.0, 271.0999999999997, 357.8, 351.9, 263.19999999999993, 292.20000000000005, 374.2, 348.5, 318.0, 338.0, 284.70000000000005, 318.5, 346.9000000000001, 368.6, 336.5, 398.2, 344.0, 168.0, 291.0, 339.20000000000005, 343.30000000000007, 363.5, 221.3, 278.29999999999995, 233.0, 339.0, 373.2000000000004, 335.20000000000005, 209.0, 370.40000000000003, 344.79999999999995, 361.3, 368.80000000000064, 305.6, 214.5999999999998, 328.0, 339.0, 300.69999999999993, 339.39999999999986, 256.4, 348.7000000000001, 361.6, 311.5999999999999, 320.0, 253.89999999999986, 340.0, 280.5, 95.60000000000002, 342.4, 175.59999999999997, 340.5000000000001, 332.19999999999993, 158.2, 372.9, 144.2, 295.1, 339.4, 284.0, 325.0, 299.49999999999994, 189.99999999999994, 185.5, 165.49999999999997, 128.89999999999998, 339.5, 252.8999999999998, 243.69999999999962, 169.2, 316.29999999999995, 272.9, 231.09999999999968, 352.9000000000002, 183.8, 358.7000000000004, 310.8999999999998, 318.4999999999999, 94.0, 184.09999999999985, 243.0, 241.0, 368.0, 345.7000000000003, 258.6999999999994, 300.6999999999999], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [144.79999999999998, 149.6, 140.60000000000008, 26.30000000000012, 116.00000000000001, 175.6999999999999, 200.0, 168.5, 162.8, 105.5, 107.0, 147.8, 155.0, 145.1, 182.9, 174.79999999999987, 151.69999999999987, 130.99999999999994, 48.20000000000012, 95.00000000000001, 200.0, 108.20000000000002, 191.9, 157.69999999999996, 119.0, 149.0, 190.09999999999994, 192.8, 153.5, 16.399999999999977, 116.0, 148.0, 168.0, 134.0, 77.59999999999944, 192.49999999999997, 182.0, 153.8, 173.9, 158.0, 113.0, 105.19999999999993, 120.80000000000003, 139.39999999999998, 198.2, 173.0, 162.5, 176.0, 196.4, 83.6, 177.2, 156.8, 123.8, 137.89999999999998, 125.0, 150.5, 185.3, 143.59999999999997, 197.0, 164.6, 155.6, 164.89999999999998, 198.2, 200.0, 152.60000000000002, 172.4, 110.0, 19.0, 94.0, 153.0, 134.0, 198.2, 160.1, 165.2, 179.0, 177.5, 146.0, 23.29999999999997, 152.0, 80.30000000000001, -3.3999999999999915, 157.4, 197.0, 113.0, 180.49999999999994, 190.69999999999996, 180.2, 155.0, 119.6, 13.399999999999991, 161.29999999999998, 190.1, 138.50000000000003, 173.29999999999998, 174.79999999999984, 186.5, 166.69999999999985, 199.1, 149.6, 134.0, 140.3, 56.30000000000003, 130.0, 178.0, 147.0, 170.0, 140.0, 121.69999999999996, 199.1, 125.29999999999993, 91.99999999999997, 124.4, 170.29999999999998, 178.3999999999999, 164.0, 185.59999999999994, 151.39999999999998, 138.2, 92.6, 196.4, 108.79999999999993, 94.1, 161.0, 161.0, 139.4, 88.10000000000002, 74.9, -85.29999999999995, 185.0, 130.4, -4.600000000000001, 111.19999999999997, 115.4, 190.09999999999994, 161.6, 140.59999999999997, 38.9, 47.3, 185.0, 182.9, 28.699999999999996, 30.50000000000002, 157.09999999999997, 104.0, 169.4, 149.0, 129.0, 120.0, 141.0, 165.0, 161.3, 135.20000000000002, -35.2, 123.19999999999997, 108.80000000000001, 22.700000000000003, 0.19999999999989626, 107.30000000000001, 127.39999999999998, -164.5, 144.7999999999999, 175.69999999999996, 77.59999999999982, 128.3, 106.09999999999997, 98.59999999999978, 176.89999999999998, -171.7, 163.99999999999977, 152.29999999999984, 49.399999999999906, 177.50000000000003, 141.49999999999991, 59.600000000000065, 164.89999999999995, 173.0, 116.0, -2.1999999999999886, 145.6999999999999, 200.0, 157.69999999999985, 153.20000000000002, 186.2, 116.29999999999995, -37.0, 11.0, 85.69999999999997, 58.40000000000001, 69.0, 161.0, 108.0, 89.0, 179.0, 184.0, 200.0, 118.69999999999993, 163.10000000000002, 95.59999999999948, 151.39999999999992, 125.3], "policy_predator_policy_reward": [12.0, 13.0, 0.0, 9.0, 8.0, 18.0, 0.0, 0.0, 21.0, 16.0, 0.0, 31.0, 0.0, 15.0, 0.0, 0.0, 5.0, 11.0, 33.0, 20.0, 17.0, 9.0, 0.0, 0.0, 33.0, 14.0, 0.0, 0.0, 15.0, 0.0, 0.0, 29.0, 3.0, 24.0, 1.0, 0.0, 12.0, 10.0, 6.0, 14.0, 44.0, 1.0, 13.0, 19.0, 0.0, 3.0, 10.0, 0.0, 28.0, 10.0, 0.0, 4.0, 23.0, 0.0, 18.0, 25.0, 0.0, 18.0, 0.0, 7.0, 16.0, 0.0, 0.0, 0.0, 16.0, 3.0, 13.0, 26.0, 12.0, 32.0, 0.0, 7.0, 0.0, 18.0, 0.0, 7.0, 17.0, 35.0, 15.0, 31.0, 0.0, 79.0, 2.0, 27.0, 0.0, 2.0, 0.0, 0.0, 64.0, 12.0, 12.0, 7.0, 24.0, 9.0, 0.0, 0.0, 3.0, 0.0, 0.0, 22.0, 18.0, 0.0, 3.0, 17.0, 12.0, 10.0, 0.0, 39.0, 15.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 12.0, 22.0, 0.0, 31.0, 0.0, 15.0, 36.0, 18.0, 0.0, 40.0, 13.0, 19.0, 87.0, 5.0, 22.0, 67.0, 2.0, 24.0, 11.0, 16.0, 14.0, 0.0, 72.0, 5.0, 0.0, 57.0, 28.0, 23.0, 11.0, 17.0, 4.0, 11.0, 24.0, 1.0, 18.0, 0.0, 3.0, 87.0, 15.0, 9.0, 45.0, 0.0, 58.0, 45.0, 121.0, 19.0, 0.0, 0.0, 47.0, 25.0, 14.0, 41.0, 123.0, 0.0, 0.0, 10.0, 36.0, 0.0, 30.0, 15.0, 0.0, 8.0, 62.0, 0.0, 13.0, 0.0, 0.0, 0.0, 16.0, 60.0, 60.0, 38.0, 2.0, 0.0, 13.0, 44.0, 0.0, 0.0, 5.0, 14.0, 13.0, 0.0, 0.0, 24.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7539308192801712, "mean_inference_ms": 4.993076143947025, "mean_action_processing_ms": 0.9594793894766989, "mean_env_wait_ms": 0.5594314058434883, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023943305015563965, "StateBufferConnector_ms": 0.004712462425231934, "ViewRequirementAgentConnector_ms": 0.20166027545928955}, "num_episodes": 23, "episode_return_max": 398.2, "episode_return_min": 94.0, "episode_return_mean": 292.406, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 213.10383872592448, "num_env_steps_trained_throughput_per_sec": 213.10383872592448, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 20336.079, "restore_workers_time_ms": 0.019, "training_step_time_ms": 20336.021, "sample_time_ms": 2907.079, "learn_time_ms": 17404.556, "learn_throughput": 229.825, "synch_weights_time_ms": 20.264}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "training_iteration": 28, "trial_id": "e4caa_00000", "date": "2024-08-13_19-54-57", "timestamp": 1723593297, "time_this_iter_s": 18.87235403060913, "time_total_s": 634.4902122020721, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03a5280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 634.4902122020721, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 84.33461538461539, "ram_util_percent": 83.78846153846156}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7622785785841564, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.453019978003526, "policy_loss": -0.0024308297639619066, "vf_loss": 8.453330742114435, "vf_explained_var": -0.028359429451523633, "kl": 0.014134011379229067, "entropy": 1.4829589751031664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9066256182218986, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5332860743557966, "policy_loss": -0.008702929298487053, "vf_loss": 1.5411558396601803, "vf_explained_var": 0.03585340093683313, "kl": 0.008331642741415232, "entropy": 0.948096050850298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 53865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 94.0, "episode_reward_mean": 282.26, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -171.7, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 123.0}, "policy_reward_mean": {"prey_policy": 124.72499999999997, "predator_policy": 16.405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [357.8, 351.9, 263.19999999999993, 292.20000000000005, 374.2, 348.5, 318.0, 338.0, 284.70000000000005, 318.5, 346.9000000000001, 368.6, 336.5, 398.2, 344.0, 168.0, 291.0, 339.20000000000005, 343.30000000000007, 363.5, 221.3, 278.29999999999995, 233.0, 339.0, 373.2000000000004, 335.20000000000005, 209.0, 370.40000000000003, 344.79999999999995, 361.3, 368.80000000000064, 305.6, 214.5999999999998, 328.0, 339.0, 300.69999999999993, 339.39999999999986, 256.4, 348.7000000000001, 361.6, 311.5999999999999, 320.0, 253.89999999999986, 340.0, 280.5, 95.60000000000002, 342.4, 175.59999999999997, 340.5000000000001, 332.19999999999993, 158.2, 372.9, 144.2, 295.1, 339.4, 284.0, 325.0, 299.49999999999994, 189.99999999999994, 185.5, 165.49999999999997, 128.89999999999998, 339.5, 252.8999999999998, 243.69999999999962, 169.2, 316.29999999999995, 272.9, 231.09999999999968, 352.9000000000002, 183.8, 358.7000000000004, 310.8999999999998, 318.4999999999999, 94.0, 184.09999999999985, 243.0, 241.0, 368.0, 345.7000000000003, 258.6999999999994, 300.6999999999999, 225.6999999999999, 240.69999999999928, 115.59999999999988, 320.60000000000093, 183.2999999999998, 268.29999999999967, 269.4999999999997, 338.0000000000002, 295.30000000000007, 195.29999999999978, 246.9999999999996, 325.30000000000064, 256.1999999999995, 185.79999999999995, 238.0, 231.0, 203.69999999999987, 246.09999999999968], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [182.0, 153.8, 173.9, 158.0, 113.0, 105.19999999999993, 120.80000000000003, 139.39999999999998, 198.2, 173.0, 162.5, 176.0, 196.4, 83.6, 177.2, 156.8, 123.8, 137.89999999999998, 125.0, 150.5, 185.3, 143.59999999999997, 197.0, 164.6, 155.6, 164.89999999999998, 198.2, 200.0, 152.60000000000002, 172.4, 110.0, 19.0, 94.0, 153.0, 134.0, 198.2, 160.1, 165.2, 179.0, 177.5, 146.0, 23.29999999999997, 152.0, 80.30000000000001, -3.3999999999999915, 157.4, 197.0, 113.0, 180.49999999999994, 190.69999999999996, 180.2, 155.0, 119.6, 13.399999999999991, 161.29999999999998, 190.1, 138.50000000000003, 173.29999999999998, 174.79999999999984, 186.5, 166.69999999999985, 199.1, 149.6, 134.0, 140.3, 56.30000000000003, 130.0, 178.0, 147.0, 170.0, 140.0, 121.69999999999996, 199.1, 125.29999999999993, 91.99999999999997, 124.4, 170.29999999999998, 178.3999999999999, 164.0, 185.59999999999994, 151.39999999999998, 138.2, 92.6, 196.4, 108.79999999999993, 94.1, 161.0, 161.0, 139.4, 88.10000000000002, 74.9, -85.29999999999995, 185.0, 130.4, -4.600000000000001, 111.19999999999997, 115.4, 190.09999999999994, 161.6, 140.59999999999997, 38.9, 47.3, 185.0, 182.9, 28.699999999999996, 30.50000000000002, 157.09999999999997, 104.0, 169.4, 149.0, 129.0, 120.0, 141.0, 165.0, 161.3, 135.20000000000002, -35.2, 123.19999999999997, 108.80000000000001, 22.700000000000003, 0.19999999999989626, 107.30000000000001, 127.39999999999998, -164.5, 144.7999999999999, 175.69999999999996, 77.59999999999982, 128.3, 106.09999999999997, 98.59999999999978, 176.89999999999998, -171.7, 163.99999999999977, 152.29999999999984, 49.399999999999906, 177.50000000000003, 141.49999999999991, 59.600000000000065, 164.89999999999995, 173.0, 116.0, -2.1999999999999886, 145.6999999999999, 200.0, 157.69999999999985, 153.20000000000002, 186.2, 116.29999999999995, -37.0, 11.0, 85.69999999999997, 58.40000000000001, 69.0, 161.0, 108.0, 89.0, 179.0, 184.0, 200.0, 118.69999999999993, 163.10000000000002, 95.59999999999948, 151.39999999999992, 125.3, 101.0, 76.70000000000006, 146.89999999999986, 93.79999999999961, 67.4, -32.79999999999998, 168.4999999999998, 151.09999999999982, 102.20000000000007, 46.10000000000009, 127.39999999999999, 128.89999999999998, 150.4999999999999, 118.99999999999969, 145.69999999999996, 179.29999999999987, 107.29999999999981, 172.99999999999983, 31.10000000000005, 129.19999999999987, 80.30000000000005, 166.6999999999999, 194.59999999999997, 130.69999999999973, 124.09999999999997, 124.09999999999977, 38.600000000000016, 39.2, 11.0, 151.0, 96.0, 115.0, 14.900000000000006, 129.7999999999999, 95.59999999999994, 150.4999999999999], "policy_predator_policy_reward": [12.0, 10.0, 6.0, 14.0, 44.0, 1.0, 13.0, 19.0, 0.0, 3.0, 10.0, 0.0, 28.0, 10.0, 0.0, 4.0, 23.0, 0.0, 18.0, 25.0, 0.0, 18.0, 0.0, 7.0, 16.0, 0.0, 0.0, 0.0, 16.0, 3.0, 13.0, 26.0, 12.0, 32.0, 0.0, 7.0, 0.0, 18.0, 0.0, 7.0, 17.0, 35.0, 15.0, 31.0, 0.0, 79.0, 2.0, 27.0, 0.0, 2.0, 0.0, 0.0, 64.0, 12.0, 12.0, 7.0, 24.0, 9.0, 0.0, 0.0, 3.0, 0.0, 0.0, 22.0, 18.0, 0.0, 3.0, 17.0, 12.0, 10.0, 0.0, 39.0, 15.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 12.0, 22.0, 0.0, 31.0, 0.0, 15.0, 36.0, 18.0, 0.0, 40.0, 13.0, 19.0, 87.0, 5.0, 22.0, 67.0, 2.0, 24.0, 11.0, 16.0, 14.0, 0.0, 72.0, 5.0, 0.0, 57.0, 28.0, 23.0, 11.0, 17.0, 4.0, 11.0, 24.0, 1.0, 18.0, 0.0, 3.0, 87.0, 15.0, 9.0, 45.0, 0.0, 58.0, 45.0, 121.0, 19.0, 0.0, 0.0, 47.0, 25.0, 14.0, 41.0, 123.0, 0.0, 0.0, 10.0, 36.0, 0.0, 30.0, 15.0, 0.0, 8.0, 62.0, 0.0, 13.0, 0.0, 0.0, 0.0, 16.0, 60.0, 60.0, 38.0, 2.0, 0.0, 13.0, 44.0, 0.0, 0.0, 5.0, 14.0, 13.0, 0.0, 0.0, 24.0, 0.0, 0.0, 48.0, 0.0, 0.0, 64.0, 17.0, 0.0, 1.0, 30.0, 5.0, 12.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 15.0, 0.0, 35.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 39.0, 69.0, 27.0, 49.0, 15.0, 5.0, 59.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7382805427322139, "mean_inference_ms": 4.957455352010423, "mean_action_processing_ms": 1.0021829709719623, "mean_env_wait_ms": 0.5561822163380679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023369312286376953, "StateBufferConnector_ms": 0.004746079444885254, "ViewRequirementAgentConnector_ms": 0.2145674228668213}, "num_episodes": 18, "episode_return_max": 398.2, "episode_return_min": 94.0, "episode_return_mean": 282.26, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 196.63657912968625, "num_env_steps_trained_throughput_per_sec": 196.63657912968625, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 20472.895, "restore_workers_time_ms": 0.019, "training_step_time_ms": 20472.837, "sample_time_ms": 2937.727, "learn_time_ms": 17509.847, "learn_throughput": 228.443, "synch_weights_time_ms": 21.221}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "training_iteration": 29, "trial_id": "e4caa_00000", "date": "2024-08-13_19-55-18", "timestamp": 1723593318, "time_this_iter_s": 20.46177387237549, "time_total_s": 654.9519860744476, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b286ab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 654.9519860744476, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 86.46551724137933, "ram_util_percent": 83.58275862068966}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1968202776063688, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.565820565551677, "policy_loss": -0.004695600235253257, "vf_loss": 8.56803456134897, "vf_explained_var": 0.0015100976777455164, "kl": 0.016544103853744805, "entropy": 1.4947565201098325, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0114247287076616, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.511357237863793, "policy_loss": -0.005262325330213619, "vf_loss": 2.515967172163504, "vf_explained_var": 0.028298614264796018, "kl": 0.006523756239961966, "entropy": 0.9016699647777295, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 55755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 391.9, "episode_reward_min": 76.60000000000004, "episode_reward_mean": 268.76199999999994, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -286.6, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 147.0}, "policy_reward_mean": {"prey_policy": 114.08599999999997, "predator_policy": 20.295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [343.30000000000007, 363.5, 221.3, 278.29999999999995, 233.0, 339.0, 373.2000000000004, 335.20000000000005, 209.0, 370.40000000000003, 344.79999999999995, 361.3, 368.80000000000064, 305.6, 214.5999999999998, 328.0, 339.0, 300.69999999999993, 339.39999999999986, 256.4, 348.7000000000001, 361.6, 311.5999999999999, 320.0, 253.89999999999986, 340.0, 280.5, 95.60000000000002, 342.4, 175.59999999999997, 340.5000000000001, 332.19999999999993, 158.2, 372.9, 144.2, 295.1, 339.4, 284.0, 325.0, 299.49999999999994, 189.99999999999994, 185.5, 165.49999999999997, 128.89999999999998, 339.5, 252.8999999999998, 243.69999999999962, 169.2, 316.29999999999995, 272.9, 231.09999999999968, 352.9000000000002, 183.8, 358.7000000000004, 310.8999999999998, 318.4999999999999, 94.0, 184.09999999999985, 243.0, 241.0, 368.0, 345.7000000000003, 258.6999999999994, 300.6999999999999, 225.6999999999999, 240.69999999999928, 115.59999999999988, 320.60000000000093, 183.2999999999998, 268.29999999999967, 269.4999999999997, 338.0000000000002, 295.30000000000007, 195.29999999999978, 246.9999999999996, 325.30000000000064, 256.1999999999995, 185.79999999999995, 238.0, 231.0, 203.69999999999987, 246.09999999999968, 76.60000000000004, 361.4, 268.4999999999999, 299.5, 306.8000000000002, 81.40000000000002, 305.0, 391.9, 290.79999999999995, 191.1, 214.99999999999986, 120.49999999999999, 199.49999999999991, 329.2999999999999, 299.0, 197.0, 245.19999999999987, 311.10000000000036], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [160.1, 165.2, 179.0, 177.5, 146.0, 23.29999999999997, 152.0, 80.30000000000001, -3.3999999999999915, 157.4, 197.0, 113.0, 180.49999999999994, 190.69999999999996, 180.2, 155.0, 119.6, 13.399999999999991, 161.29999999999998, 190.1, 138.50000000000003, 173.29999999999998, 174.79999999999984, 186.5, 166.69999999999985, 199.1, 149.6, 134.0, 140.3, 56.30000000000003, 130.0, 178.0, 147.0, 170.0, 140.0, 121.69999999999996, 199.1, 125.29999999999993, 91.99999999999997, 124.4, 170.29999999999998, 178.3999999999999, 164.0, 185.59999999999994, 151.39999999999998, 138.2, 92.6, 196.4, 108.79999999999993, 94.1, 161.0, 161.0, 139.4, 88.10000000000002, 74.9, -85.29999999999995, 185.0, 130.4, -4.600000000000001, 111.19999999999997, 115.4, 190.09999999999994, 161.6, 140.59999999999997, 38.9, 47.3, 185.0, 182.9, 28.699999999999996, 30.50000000000002, 157.09999999999997, 104.0, 169.4, 149.0, 129.0, 120.0, 141.0, 165.0, 161.3, 135.20000000000002, -35.2, 123.19999999999997, 108.80000000000001, 22.700000000000003, 0.19999999999989626, 107.30000000000001, 127.39999999999998, -164.5, 144.7999999999999, 175.69999999999996, 77.59999999999982, 128.3, 106.09999999999997, 98.59999999999978, 176.89999999999998, -171.7, 163.99999999999977, 152.29999999999984, 49.399999999999906, 177.50000000000003, 141.49999999999991, 59.600000000000065, 164.89999999999995, 173.0, 116.0, -2.1999999999999886, 145.6999999999999, 200.0, 157.69999999999985, 153.20000000000002, 186.2, 116.29999999999995, -37.0, 11.0, 85.69999999999997, 58.40000000000001, 69.0, 161.0, 108.0, 89.0, 179.0, 184.0, 200.0, 118.69999999999993, 163.10000000000002, 95.59999999999948, 151.39999999999992, 125.3, 101.0, 76.70000000000006, 146.89999999999986, 93.79999999999961, 67.4, -32.79999999999998, 168.4999999999998, 151.09999999999982, 102.20000000000007, 46.10000000000009, 127.39999999999999, 128.89999999999998, 150.4999999999999, 118.99999999999969, 145.69999999999996, 179.29999999999987, 107.29999999999981, 172.99999999999983, 31.10000000000005, 129.19999999999987, 80.30000000000005, 166.6999999999999, 194.59999999999997, 130.69999999999973, 124.09999999999997, 124.09999999999977, 38.600000000000016, 39.2, 11.0, 151.0, 96.0, 115.0, 14.900000000000006, 129.7999999999999, 95.59999999999994, 150.4999999999999, 118.09999999999988, -158.5, 182.0, 166.4, 111.5, 116.00000000000003, 125.0, 138.50000000000003, 120.19999999999996, 149.6, 59.3, -112.9, 150.49999999999977, 147.4999999999998, 194.60000000000002, 197.29999999999998, 124.09999999999994, 133.70000000000005, -22.0, 145.09999999999994, 4.1000000000000085, 116.89999999999989, -286.6, 154.1, 171.2, -63.700000000000074, 163.6999999999999, 158.6, 137.0, 142.0, 97.0, 13.0, 157.70000000000002, -20.500000000000007, 152.89999999999998, 138.1999999999999], "policy_predator_policy_reward": [0.0, 18.0, 0.0, 7.0, 17.0, 35.0, 15.0, 31.0, 0.0, 79.0, 2.0, 27.0, 0.0, 2.0, 0.0, 0.0, 64.0, 12.0, 12.0, 7.0, 24.0, 9.0, 0.0, 0.0, 3.0, 0.0, 0.0, 22.0, 18.0, 0.0, 3.0, 17.0, 12.0, 10.0, 0.0, 39.0, 15.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 12.0, 22.0, 0.0, 31.0, 0.0, 15.0, 36.0, 18.0, 0.0, 40.0, 13.0, 19.0, 87.0, 5.0, 22.0, 67.0, 2.0, 24.0, 11.0, 16.0, 14.0, 0.0, 72.0, 5.0, 0.0, 57.0, 28.0, 23.0, 11.0, 17.0, 4.0, 11.0, 24.0, 1.0, 18.0, 0.0, 3.0, 87.0, 15.0, 9.0, 45.0, 0.0, 58.0, 45.0, 121.0, 19.0, 0.0, 0.0, 47.0, 25.0, 14.0, 41.0, 123.0, 0.0, 0.0, 10.0, 36.0, 0.0, 30.0, 15.0, 0.0, 8.0, 62.0, 0.0, 13.0, 0.0, 0.0, 0.0, 16.0, 60.0, 60.0, 38.0, 2.0, 0.0, 13.0, 44.0, 0.0, 0.0, 5.0, 14.0, 13.0, 0.0, 0.0, 24.0, 0.0, 0.0, 48.0, 0.0, 0.0, 64.0, 17.0, 0.0, 1.0, 30.0, 5.0, 12.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 15.0, 0.0, 35.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 39.0, 69.0, 27.0, 49.0, 15.0, 5.0, 59.0, 0.0, 0.0, 0.0, 22.0, 95.0, 0.0, 13.0, 41.0, 0.0, 27.0, 9.0, 18.0, 19.0, 21.0, 114.0, 7.0, 0.0, 0.0, 0.0, 16.0, 17.0, 68.0, 0.0, 42.0, 52.0, 147.0, 106.0, 92.0, 0.0, 0.0, 7.0, 20.0, 0.0, 49.0, 38.0, 42.0, 66.0, 20.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7234245201389724, "mean_inference_ms": 4.9230942155643085, "mean_action_processing_ms": 0.9900483209309744, "mean_env_wait_ms": 0.5531345047642062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02175164222717285, "StateBufferConnector_ms": 0.004549860954284668, "ViewRequirementAgentConnector_ms": 0.20639264583587646}, "num_episodes": 18, "episode_return_max": 391.9, "episode_return_min": 76.60000000000004, "episode_return_mean": 268.76199999999994, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 211.70399496207258, "num_env_steps_trained_throughput_per_sec": 211.70399496207258, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 20277.578, "restore_workers_time_ms": 0.018, "training_step_time_ms": 20277.522, "sample_time_ms": 2976.295, "learn_time_ms": 17276.676, "learn_throughput": 231.526, "synch_weights_time_ms": 21.131}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 30, "trial_id": "e4caa_00000", "date": "2024-08-13_19-55-37", "timestamp": 1723593337, "time_this_iter_s": 18.93469214439392, "time_total_s": 673.8866782188416, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03a4940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 673.8866782188416, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 85.10000000000001, "ram_util_percent": 83.73703703703703}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6103842038326164, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.046315793385581, "policy_loss": -0.0011215602257165802, "vf_loss": 8.044991120585689, "vf_explained_var": 0.17245698946493643, "kl": 0.016308210396087774, "entropy": 1.5158512896330898, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8988382567015906, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6747556231955372, "policy_loss": -0.0064579340690875025, "vf_loss": 1.6804036311371617, "vf_explained_var": 0.03271328191908579, "kl": 0.00809921526741106, "entropy": 0.8641941321274591, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 57645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "env_runners": {"episode_reward_max": 391.9, "episode_reward_min": 76.60000000000004, "episode_reward_mean": 259.36, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -286.6, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 147.0}, "policy_reward_mean": {"prey_policy": 107.93999999999997, "predator_policy": 21.74}, "custom_metrics": {}, "hist_stats": {"episode_reward": [339.39999999999986, 256.4, 348.7000000000001, 361.6, 311.5999999999999, 320.0, 253.89999999999986, 340.0, 280.5, 95.60000000000002, 342.4, 175.59999999999997, 340.5000000000001, 332.19999999999993, 158.2, 372.9, 144.2, 295.1, 339.4, 284.0, 325.0, 299.49999999999994, 189.99999999999994, 185.5, 165.49999999999997, 128.89999999999998, 339.5, 252.8999999999998, 243.69999999999962, 169.2, 316.29999999999995, 272.9, 231.09999999999968, 352.9000000000002, 183.8, 358.7000000000004, 310.8999999999998, 318.4999999999999, 94.0, 184.09999999999985, 243.0, 241.0, 368.0, 345.7000000000003, 258.6999999999994, 300.6999999999999, 225.6999999999999, 240.69999999999928, 115.59999999999988, 320.60000000000093, 183.2999999999998, 268.29999999999967, 269.4999999999997, 338.0000000000002, 295.30000000000007, 195.29999999999978, 246.9999999999996, 325.30000000000064, 256.1999999999995, 185.79999999999995, 238.0, 231.0, 203.69999999999987, 246.09999999999968, 76.60000000000004, 361.4, 268.4999999999999, 299.5, 306.8000000000002, 81.40000000000002, 305.0, 391.9, 290.79999999999995, 191.1, 214.99999999999986, 120.49999999999999, 199.49999999999991, 329.2999999999999, 299.0, 197.0, 245.19999999999987, 311.10000000000036, 330.20000000000005, 151.89999999999984, 246.09999999999977, 366.4000000000002, 234.2999999999997, 180.19999999999965, 260.69999999999976, 107.70000000000002, 314.5000000000008, 343.10000000000025, 123.69999999999982, 272.0999999999999, 280.6000000000007, 188.39999999999966, 308.0, 317.0, 327.2000000000003, 336.7], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [199.1, 125.29999999999993, 91.99999999999997, 124.4, 170.29999999999998, 178.3999999999999, 164.0, 185.59999999999994, 151.39999999999998, 138.2, 92.6, 196.4, 108.79999999999993, 94.1, 161.0, 161.0, 139.4, 88.10000000000002, 74.9, -85.29999999999995, 185.0, 130.4, -4.600000000000001, 111.19999999999997, 115.4, 190.09999999999994, 161.6, 140.59999999999997, 38.9, 47.3, 185.0, 182.9, 28.699999999999996, 30.50000000000002, 157.09999999999997, 104.0, 169.4, 149.0, 129.0, 120.0, 141.0, 165.0, 161.3, 135.20000000000002, -35.2, 123.19999999999997, 108.80000000000001, 22.700000000000003, 0.19999999999989626, 107.30000000000001, 127.39999999999998, -164.5, 144.7999999999999, 175.69999999999996, 77.59999999999982, 128.3, 106.09999999999997, 98.59999999999978, 176.89999999999998, -171.7, 163.99999999999977, 152.29999999999984, 49.399999999999906, 177.50000000000003, 141.49999999999991, 59.600000000000065, 164.89999999999995, 173.0, 116.0, -2.1999999999999886, 145.6999999999999, 200.0, 157.69999999999985, 153.20000000000002, 186.2, 116.29999999999995, -37.0, 11.0, 85.69999999999997, 58.40000000000001, 69.0, 161.0, 108.0, 89.0, 179.0, 184.0, 200.0, 118.69999999999993, 163.10000000000002, 95.59999999999948, 151.39999999999992, 125.3, 101.0, 76.70000000000006, 146.89999999999986, 93.79999999999961, 67.4, -32.79999999999998, 168.4999999999998, 151.09999999999982, 102.20000000000007, 46.10000000000009, 127.39999999999999, 128.89999999999998, 150.4999999999999, 118.99999999999969, 145.69999999999996, 179.29999999999987, 107.29999999999981, 172.99999999999983, 31.10000000000005, 129.19999999999987, 80.30000000000005, 166.6999999999999, 194.59999999999997, 130.69999999999973, 124.09999999999997, 124.09999999999977, 38.600000000000016, 39.2, 11.0, 151.0, 96.0, 115.0, 14.900000000000006, 129.7999999999999, 95.59999999999994, 150.4999999999999, 118.09999999999988, -158.5, 182.0, 166.4, 111.5, 116.00000000000003, 125.0, 138.50000000000003, 120.19999999999996, 149.6, 59.3, -112.9, 150.49999999999977, 147.4999999999998, 194.60000000000002, 197.29999999999998, 124.09999999999994, 133.70000000000005, -22.0, 145.09999999999994, 4.1000000000000085, 116.89999999999989, -286.6, 154.1, 171.2, -63.700000000000074, 163.6999999999999, 158.6, 137.0, 142.0, 97.0, 13.0, 157.70000000000002, -20.500000000000007, 152.89999999999998, 138.1999999999999, 180.2, 125.0, 97.69999999999987, -47.800000000000004, 76.69999999999999, 133.39999999999986, 176.89999999999995, 183.5, 52.70000000000002, 137.5999999999998, 74.30000000000005, 80.89999999999996, 140.59999999999982, 43.099999999999994, 159.49999999999974, -149.8000000000002, 158.59999999999985, 146.89999999999986, 177.19999999999996, 164.90000000000003, -204.4, 163.09999999999982, 43.700000000000024, 136.4, 101.59999999999988, 139.99999999999991, 92.60000000000002, 63.80000000000004, 157.0, 150.0, 156.0, 161.0, 156.5, 154.6999999999998, 173.89999999999998, 156.79999999999995], "policy_predator_policy_reward": [15.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 12.0, 22.0, 0.0, 31.0, 0.0, 15.0, 36.0, 18.0, 0.0, 40.0, 13.0, 19.0, 87.0, 5.0, 22.0, 67.0, 2.0, 24.0, 11.0, 16.0, 14.0, 0.0, 72.0, 5.0, 0.0, 57.0, 28.0, 23.0, 11.0, 17.0, 4.0, 11.0, 24.0, 1.0, 18.0, 0.0, 3.0, 87.0, 15.0, 9.0, 45.0, 0.0, 58.0, 45.0, 121.0, 19.0, 0.0, 0.0, 47.0, 25.0, 14.0, 41.0, 123.0, 0.0, 0.0, 10.0, 36.0, 0.0, 30.0, 15.0, 0.0, 8.0, 62.0, 0.0, 13.0, 0.0, 0.0, 0.0, 16.0, 60.0, 60.0, 38.0, 2.0, 0.0, 13.0, 44.0, 0.0, 0.0, 5.0, 14.0, 13.0, 0.0, 0.0, 24.0, 0.0, 0.0, 48.0, 0.0, 0.0, 64.0, 17.0, 0.0, 1.0, 30.0, 5.0, 12.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 15.0, 0.0, 35.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 39.0, 69.0, 27.0, 49.0, 15.0, 5.0, 59.0, 0.0, 0.0, 0.0, 22.0, 95.0, 0.0, 13.0, 41.0, 0.0, 27.0, 9.0, 18.0, 19.0, 21.0, 114.0, 7.0, 0.0, 0.0, 0.0, 16.0, 17.0, 68.0, 0.0, 42.0, 52.0, 147.0, 106.0, 92.0, 0.0, 0.0, 7.0, 20.0, 0.0, 49.0, 38.0, 42.0, 66.0, 20.0, 0.0, 25.0, 0.0, 17.0, 85.0, 36.0, 0.0, 0.0, 6.0, 19.0, 25.0, 8.0, 17.0, 31.0, 46.0, 45.0, 53.0, 0.0, 9.0, 0.0, 1.0, 38.0, 127.0, 44.0, 48.0, 14.0, 25.0, 32.0, 0.0, 1.0, 0.0, 0.0, 0.0, 6.0, 10.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7044380171123388, "mean_inference_ms": 4.876774485633128, "mean_action_processing_ms": 0.9731910979579104, "mean_env_wait_ms": 0.5486763272060294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018897175788879395, "StateBufferConnector_ms": 0.005158901214599609, "ViewRequirementAgentConnector_ms": 0.1774590015411377}, "num_episodes": 18, "episode_return_max": 391.9, "episode_return_min": 76.60000000000004, "episode_return_mean": 259.36, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 215.42728682423768, "num_env_steps_trained_throughput_per_sec": 215.42728682423768, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 20210.353, "restore_workers_time_ms": 0.019, "training_step_time_ms": 20210.292, "sample_time_ms": 3009.309, "learn_time_ms": 17175.74, "learn_throughput": 232.887, "synch_weights_time_ms": 21.651}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "training_iteration": 31, "trial_id": "e4caa_00000", "date": "2024-08-13_19-55-55", "timestamp": 1723593355, "time_this_iter_s": 18.66205096244812, "time_total_s": 692.5487291812897, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03a2940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 692.5487291812897, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 83.7576923076923, "ram_util_percent": 83.48461538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5849085128181195, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.69239385191095, "policy_loss": -0.0019387890108018403, "vf_loss": 7.6924898508364565, "vf_explained_var": 0.01320127529441995, "kl": 0.012285159003431828, "entropy": 1.5001284445404375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0740427080127928, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3450894662942836, "policy_loss": -0.005874258806071584, "vf_loss": 1.3506061330358818, "vf_explained_var": 0.03289924718084789, "kl": 0.003575902465899984, "entropy": 0.6845715200459516, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 59535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "env_runners": {"episode_reward_max": 391.9, "episode_reward_min": 76.60000000000004, "episode_reward_mean": 256.828, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -286.6, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 147.0}, "policy_reward_mean": {"prey_policy": 108.41399999999994, "predator_policy": 20.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [252.8999999999998, 243.69999999999962, 169.2, 316.29999999999995, 272.9, 231.09999999999968, 352.9000000000002, 183.8, 358.7000000000004, 310.8999999999998, 318.4999999999999, 94.0, 184.09999999999985, 243.0, 241.0, 368.0, 345.7000000000003, 258.6999999999994, 300.6999999999999, 225.6999999999999, 240.69999999999928, 115.59999999999988, 320.60000000000093, 183.2999999999998, 268.29999999999967, 269.4999999999997, 338.0000000000002, 295.30000000000007, 195.29999999999978, 246.9999999999996, 325.30000000000064, 256.1999999999995, 185.79999999999995, 238.0, 231.0, 203.69999999999987, 246.09999999999968, 76.60000000000004, 361.4, 268.4999999999999, 299.5, 306.8000000000002, 81.40000000000002, 305.0, 391.9, 290.79999999999995, 191.1, 214.99999999999986, 120.49999999999999, 199.49999999999991, 329.2999999999999, 299.0, 197.0, 245.19999999999987, 311.10000000000036, 330.20000000000005, 151.89999999999984, 246.09999999999977, 366.4000000000002, 234.2999999999997, 180.19999999999965, 260.69999999999976, 107.70000000000002, 314.5000000000008, 343.10000000000025, 123.69999999999982, 272.0999999999999, 280.6000000000007, 188.39999999999966, 308.0, 317.0, 327.2000000000003, 336.7, 231.09999999999985, 287.9000000000003, 258.2, 242.09999999999994, 245.09999999999974, 306.7000000000003, 308.60000000000053, 296.1999999999999, 271.1999999999995, 280.59999999999957, 223.49999999999991, 218.49999999999986, 300.79999999999995, 280.4999999999999, 303.4000000000001, 267.09999999999957, 223.89999999999984, 257.5999999999999, 142.29999999999998, 184.89999999999995, 295.9000000000001, 263.0, 292.0, 265.0, 222.0999999999998, 326.00000000000006, 278.6999999999997], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [77.59999999999982, 128.3, 106.09999999999997, 98.59999999999978, 176.89999999999998, -171.7, 163.99999999999977, 152.29999999999984, 49.399999999999906, 177.50000000000003, 141.49999999999991, 59.600000000000065, 164.89999999999995, 173.0, 116.0, -2.1999999999999886, 145.6999999999999, 200.0, 157.69999999999985, 153.20000000000002, 186.2, 116.29999999999995, -37.0, 11.0, 85.69999999999997, 58.40000000000001, 69.0, 161.0, 108.0, 89.0, 179.0, 184.0, 200.0, 118.69999999999993, 163.10000000000002, 95.59999999999948, 151.39999999999992, 125.3, 101.0, 76.70000000000006, 146.89999999999986, 93.79999999999961, 67.4, -32.79999999999998, 168.4999999999998, 151.09999999999982, 102.20000000000007, 46.10000000000009, 127.39999999999999, 128.89999999999998, 150.4999999999999, 118.99999999999969, 145.69999999999996, 179.29999999999987, 107.29999999999981, 172.99999999999983, 31.10000000000005, 129.19999999999987, 80.30000000000005, 166.6999999999999, 194.59999999999997, 130.69999999999973, 124.09999999999997, 124.09999999999977, 38.600000000000016, 39.2, 11.0, 151.0, 96.0, 115.0, 14.900000000000006, 129.7999999999999, 95.59999999999994, 150.4999999999999, 118.09999999999988, -158.5, 182.0, 166.4, 111.5, 116.00000000000003, 125.0, 138.50000000000003, 120.19999999999996, 149.6, 59.3, -112.9, 150.49999999999977, 147.4999999999998, 194.60000000000002, 197.29999999999998, 124.09999999999994, 133.70000000000005, -22.0, 145.09999999999994, 4.1000000000000085, 116.89999999999989, -286.6, 154.1, 171.2, -63.700000000000074, 163.6999999999999, 158.6, 137.0, 142.0, 97.0, 13.0, 157.70000000000002, -20.500000000000007, 152.89999999999998, 138.1999999999999, 180.2, 125.0, 97.69999999999987, -47.800000000000004, 76.69999999999999, 133.39999999999986, 176.89999999999995, 183.5, 52.70000000000002, 137.5999999999998, 74.30000000000005, 80.89999999999996, 140.59999999999982, 43.099999999999994, 159.49999999999974, -149.8000000000002, 158.59999999999985, 146.89999999999986, 177.19999999999996, 164.90000000000003, -204.4, 163.09999999999982, 43.700000000000024, 136.4, 101.59999999999988, 139.99999999999991, 92.60000000000002, 63.80000000000004, 157.0, 150.0, 156.0, 161.0, 156.5, 154.6999999999998, 173.89999999999998, 156.79999999999995, 148.39999999999998, 52.700000000000095, 186.49999999999994, 58.40000000000001, 100.69999999999982, 141.4999999999999, 153.79999999999998, 23.300000000000004, 86.00000000000003, 127.09999999999987, 133.39999999999978, 170.29999999999995, 133.09999999999988, 168.4999999999998, 145.09999999999988, 136.09999999999997, 119.29999999999994, 146.89999999999998, 114.49999999999983, 154.09999999999974, 10.39999999999994, 154.09999999999985, 32.900000000000006, 137.59999999999988, 138.7999999999996, 140.0, 113.29999999999984, 144.20000000000005, 127.99999999999984, 160.39999999999995, 131.6, 111.49999999999963, 173.89999999999984, -25.0, 59.60000000000004, 163.9999999999999, 86.9, -22.60000000000006, -4.299999999999997, 126.19999999999999, 130.69999999999993, 162.1999999999999, 119.0, 117.0, 144.0, 126.0, 134.0, 111.0, 56.599999999999994, 108.49999999999991, 142.1, 164.89999999999992, 134.29999999999995, 127.40000000000003], "policy_predator_policy_reward": [0.0, 47.0, 25.0, 14.0, 41.0, 123.0, 0.0, 0.0, 10.0, 36.0, 0.0, 30.0, 15.0, 0.0, 8.0, 62.0, 0.0, 13.0, 0.0, 0.0, 0.0, 16.0, 60.0, 60.0, 38.0, 2.0, 0.0, 13.0, 44.0, 0.0, 0.0, 5.0, 14.0, 13.0, 0.0, 0.0, 24.0, 0.0, 0.0, 48.0, 0.0, 0.0, 64.0, 17.0, 0.0, 1.0, 30.0, 5.0, 12.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 15.0, 0.0, 35.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 39.0, 69.0, 27.0, 49.0, 15.0, 5.0, 59.0, 0.0, 0.0, 0.0, 22.0, 95.0, 0.0, 13.0, 41.0, 0.0, 27.0, 9.0, 18.0, 19.0, 21.0, 114.0, 7.0, 0.0, 0.0, 0.0, 16.0, 17.0, 68.0, 0.0, 42.0, 52.0, 147.0, 106.0, 92.0, 0.0, 0.0, 7.0, 20.0, 0.0, 49.0, 38.0, 42.0, 66.0, 20.0, 0.0, 25.0, 0.0, 17.0, 85.0, 36.0, 0.0, 0.0, 6.0, 19.0, 25.0, 8.0, 17.0, 31.0, 46.0, 45.0, 53.0, 0.0, 9.0, 0.0, 1.0, 38.0, 127.0, 44.0, 48.0, 14.0, 25.0, 32.0, 0.0, 1.0, 0.0, 0.0, 0.0, 6.0, 10.0, 6.0, 0.0, 0.0, 30.0, 25.0, 18.0, 13.0, 3.0, 0.0, 65.0, 32.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 15.0, 5.0, 0.0, 0.0, 12.0, 0.0, 59.0, 5.0, 43.0, 10.0, 12.0, 11.0, 12.0, 15.0, 0.0, 0.0, 24.0, 75.0, 0.0, 1.0, 33.0, 61.0, 17.0, 63.0, 0.0, 3.0, 0.0, 21.0, 6.0, 22.0, 0.0, 20.0, 0.0, 47.0, 10.0, 19.0, 0.0, 17.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6775283187952843, "mean_inference_ms": 4.813740507390117, "mean_action_processing_ms": 0.9593804308389583, "mean_env_wait_ms": 0.5443668324757255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053751468658447266, "StateBufferConnector_ms": 0.00424039363861084, "ViewRequirementAgentConnector_ms": 0.21452796459197998}, "num_episodes": 27, "episode_return_max": 391.9, "episode_return_min": 76.60000000000004, "episode_return_mean": 256.828, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 201.72544031297977, "num_env_steps_trained_throughput_per_sec": 201.72544031297977, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 20214.653, "restore_workers_time_ms": 0.019, "training_step_time_ms": 20214.592, "sample_time_ms": 3112.747, "learn_time_ms": 17077.04, "learn_throughput": 234.233, "synch_weights_time_ms": 21.081}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "training_iteration": 32, "trial_id": "e4caa_00000", "date": "2024-08-13_19-56-15", "timestamp": 1723593375, "time_this_iter_s": 19.887490034103394, "time_total_s": 712.4362192153931, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29095e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 712.4362192153931, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 82.19285714285715, "ram_util_percent": 83.62857142857142}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6237990549001746, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.698276872231216, "policy_loss": -0.0060371747196075465, "vf_loss": 7.702142471989626, "vf_explained_var": 0.10498341255717808, "kl": 0.014477168084618275, "entropy": 1.4963028866777974, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0065349079313732, "cur_kl_coeff": 0.05, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.882568076647148, "policy_loss": -0.005824601721935093, "vf_loss": 0.8881454543067665, "vf_explained_var": 0.015152019041555899, "kl": 0.004944490661793367, "entropy": 0.6492481481776666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 61425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "env_runners": {"episode_reward_max": 391.9, "episode_reward_min": 76.60000000000004, "episode_reward_mean": 259.816, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -286.6, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.29999999999998, "predator_policy": 147.0}, "policy_reward_mean": {"prey_policy": 111.46299999999995, "predator_policy": 18.445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.6999999999999, 225.6999999999999, 240.69999999999928, 115.59999999999988, 320.60000000000093, 183.2999999999998, 268.29999999999967, 269.4999999999997, 338.0000000000002, 295.30000000000007, 195.29999999999978, 246.9999999999996, 325.30000000000064, 256.1999999999995, 185.79999999999995, 238.0, 231.0, 203.69999999999987, 246.09999999999968, 76.60000000000004, 361.4, 268.4999999999999, 299.5, 306.8000000000002, 81.40000000000002, 305.0, 391.9, 290.79999999999995, 191.1, 214.99999999999986, 120.49999999999999, 199.49999999999991, 329.2999999999999, 299.0, 197.0, 245.19999999999987, 311.10000000000036, 330.20000000000005, 151.89999999999984, 246.09999999999977, 366.4000000000002, 234.2999999999997, 180.19999999999965, 260.69999999999976, 107.70000000000002, 314.5000000000008, 343.10000000000025, 123.69999999999982, 272.0999999999999, 280.6000000000007, 188.39999999999966, 308.0, 317.0, 327.2000000000003, 336.7, 231.09999999999985, 287.9000000000003, 258.2, 242.09999999999994, 245.09999999999974, 306.7000000000003, 308.60000000000053, 296.1999999999999, 271.1999999999995, 280.59999999999957, 223.49999999999991, 218.49999999999986, 300.79999999999995, 280.4999999999999, 303.4000000000001, 267.09999999999957, 223.89999999999984, 257.5999999999999, 142.29999999999998, 184.89999999999995, 295.9000000000001, 263.0, 292.0, 265.0, 222.0999999999998, 326.00000000000006, 278.6999999999997, 190.79999999999976, 285.59999999999985, 336.4999999999998, 300.30000000000007, 309.80000000000007, 334.4000000000001, 344.20000000000084, 274.9, 260.5999999999998, 301.0, 310.8999999999995, 237.9999999999995, 315.2999999999997, 236.3999999999995, 318.0, 296.0, 213.39999999999992, 178.09999999999985], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [151.39999999999992, 125.3, 101.0, 76.70000000000006, 146.89999999999986, 93.79999999999961, 67.4, -32.79999999999998, 168.4999999999998, 151.09999999999982, 102.20000000000007, 46.10000000000009, 127.39999999999999, 128.89999999999998, 150.4999999999999, 118.99999999999969, 145.69999999999996, 179.29999999999987, 107.29999999999981, 172.99999999999983, 31.10000000000005, 129.19999999999987, 80.30000000000005, 166.6999999999999, 194.59999999999997, 130.69999999999973, 124.09999999999997, 124.09999999999977, 38.600000000000016, 39.2, 11.0, 151.0, 96.0, 115.0, 14.900000000000006, 129.7999999999999, 95.59999999999994, 150.4999999999999, 118.09999999999988, -158.5, 182.0, 166.4, 111.5, 116.00000000000003, 125.0, 138.50000000000003, 120.19999999999996, 149.6, 59.3, -112.9, 150.49999999999977, 147.4999999999998, 194.60000000000002, 197.29999999999998, 124.09999999999994, 133.70000000000005, -22.0, 145.09999999999994, 4.1000000000000085, 116.89999999999989, -286.6, 154.1, 171.2, -63.700000000000074, 163.6999999999999, 158.6, 137.0, 142.0, 97.0, 13.0, 157.70000000000002, -20.500000000000007, 152.89999999999998, 138.1999999999999, 180.2, 125.0, 97.69999999999987, -47.800000000000004, 76.69999999999999, 133.39999999999986, 176.89999999999995, 183.5, 52.70000000000002, 137.5999999999998, 74.30000000000005, 80.89999999999996, 140.59999999999982, 43.099999999999994, 159.49999999999974, -149.8000000000002, 158.59999999999985, 146.89999999999986, 177.19999999999996, 164.90000000000003, -204.4, 163.09999999999982, 43.700000000000024, 136.4, 101.59999999999988, 139.99999999999991, 92.60000000000002, 63.80000000000004, 157.0, 150.0, 156.0, 161.0, 156.5, 154.6999999999998, 173.89999999999998, 156.79999999999995, 148.39999999999998, 52.700000000000095, 186.49999999999994, 58.40000000000001, 100.69999999999982, 141.4999999999999, 153.79999999999998, 23.300000000000004, 86.00000000000003, 127.09999999999987, 133.39999999999978, 170.29999999999995, 133.09999999999988, 168.4999999999998, 145.09999999999988, 136.09999999999997, 119.29999999999994, 146.89999999999998, 114.49999999999983, 154.09999999999974, 10.39999999999994, 154.09999999999985, 32.900000000000006, 137.59999999999988, 138.7999999999996, 140.0, 113.29999999999984, 144.20000000000005, 127.99999999999984, 160.39999999999995, 131.6, 111.49999999999963, 173.89999999999984, -25.0, 59.60000000000004, 163.9999999999999, 86.9, -22.60000000000006, -4.299999999999997, 126.19999999999999, 130.69999999999993, 162.1999999999999, 119.0, 117.0, 144.0, 126.0, 134.0, 111.0, 56.599999999999994, 108.49999999999991, 142.1, 164.89999999999992, 134.29999999999995, 127.40000000000003, 60.200000000000045, 83.60000000000002, 139.99999999999972, 140.59999999999974, 147.5, 172.99999999999994, 148.39999999999998, 134.8999999999998, 130.39999999999998, 169.39999999999986, 150.20000000000005, 180.19999999999993, 163.0999999999998, 181.0999999999999, 159.49999999999991, 88.4, 5.300000000000008, 170.29999999999987, 148.69999999999982, 152.29999999999976, 145.99999999999986, 164.8999999999998, 164.89999999999995, 73.1, 179.60000000000002, 130.69999999999985, 90.49999999999984, 110.89999999999989, 167.0, 142.0, 166.0, 130.0, 125.00000000000003, 22.40000000000002, 37.10000000000003, 88.99999999999994], "policy_predator_policy_reward": [24.0, 0.0, 0.0, 48.0, 0.0, 0.0, 64.0, 17.0, 0.0, 1.0, 30.0, 5.0, 12.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 15.0, 0.0, 35.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 39.0, 69.0, 27.0, 49.0, 15.0, 5.0, 59.0, 0.0, 0.0, 0.0, 22.0, 95.0, 0.0, 13.0, 41.0, 0.0, 27.0, 9.0, 18.0, 19.0, 21.0, 114.0, 7.0, 0.0, 0.0, 0.0, 16.0, 17.0, 68.0, 0.0, 42.0, 52.0, 147.0, 106.0, 92.0, 0.0, 0.0, 7.0, 20.0, 0.0, 49.0, 38.0, 42.0, 66.0, 20.0, 0.0, 25.0, 0.0, 17.0, 85.0, 36.0, 0.0, 0.0, 6.0, 19.0, 25.0, 8.0, 17.0, 31.0, 46.0, 45.0, 53.0, 0.0, 9.0, 0.0, 1.0, 38.0, 127.0, 44.0, 48.0, 14.0, 25.0, 32.0, 0.0, 1.0, 0.0, 0.0, 0.0, 6.0, 10.0, 6.0, 0.0, 0.0, 30.0, 25.0, 18.0, 13.0, 3.0, 0.0, 65.0, 32.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 15.0, 5.0, 0.0, 0.0, 12.0, 0.0, 59.0, 5.0, 43.0, 10.0, 12.0, 11.0, 12.0, 15.0, 0.0, 0.0, 24.0, 75.0, 0.0, 1.0, 33.0, 61.0, 17.0, 63.0, 0.0, 3.0, 0.0, 21.0, 6.0, 22.0, 0.0, 20.0, 0.0, 47.0, 10.0, 19.0, 0.0, 17.0, 0.0, 34.0, 13.0, 5.0, 0.0, 14.0, 2.0, 7.0, 10.0, 0.0, 10.0, 4.0, 0.0, 0.0, 0.0, 12.0, 15.0, 58.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 35.0, 0.0, 9.0, 0.0, 0.0, 16.0, 50.0, 11.0, 41.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.664025184028736, "mean_inference_ms": 4.782635776298034, "mean_action_processing_ms": 0.9382733387715209, "mean_env_wait_ms": 0.5390776625745173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004979968070983887, "StateBufferConnector_ms": 0.004366755485534668, "ViewRequirementAgentConnector_ms": 0.2309972047805786}, "num_episodes": 18, "episode_return_max": 391.9, "episode_return_min": 76.60000000000004, "episode_return_mean": 259.816, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 223.82056206907058, "num_env_steps_trained_throughput_per_sec": 223.82056206907058, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 19936.03, "restore_workers_time_ms": 0.019, "training_step_time_ms": 19935.967, "sample_time_ms": 3136.178, "learn_time_ms": 16774.952, "learn_throughput": 238.451, "synch_weights_time_ms": 21.159}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "training_iteration": 33, "trial_id": "e4caa_00000", "date": "2024-08-13_19-56-33", "timestamp": 1723593393, "time_this_iter_s": 17.922671794891357, "time_total_s": 730.3588910102844, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b035e1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 730.3588910102844, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 81.95199999999998, "ram_util_percent": 83.704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6064670218992485, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.830189003010906, "policy_loss": -0.010056386793416644, "vf_loss": 7.837524385553189, "vf_explained_var": 0.15863950441754054, "kl": 0.018140076209586093, "entropy": 1.4816863644060003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1432040295430592, "cur_kl_coeff": 0.025, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9682224007195266, "policy_loss": -0.0043224755497205825, "vf_loss": 0.9724552322711263, "vf_explained_var": 0.04529332704644985, "kl": 0.0035857519426306136, "entropy": 0.5490868588761678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 63315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "env_runners": {"episode_reward_max": 391.9, "episode_reward_min": 54.80000000000006, "episode_reward_mean": 262.274, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -286.6, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 197.29999999999998, "predator_policy": 147.0}, "policy_reward_mean": {"prey_policy": 112.86199999999994, "predator_policy": 18.275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [246.09999999999968, 76.60000000000004, 361.4, 268.4999999999999, 299.5, 306.8000000000002, 81.40000000000002, 305.0, 391.9, 290.79999999999995, 191.1, 214.99999999999986, 120.49999999999999, 199.49999999999991, 329.2999999999999, 299.0, 197.0, 245.19999999999987, 311.10000000000036, 330.20000000000005, 151.89999999999984, 246.09999999999977, 366.4000000000002, 234.2999999999997, 180.19999999999965, 260.69999999999976, 107.70000000000002, 314.5000000000008, 343.10000000000025, 123.69999999999982, 272.0999999999999, 280.6000000000007, 188.39999999999966, 308.0, 317.0, 327.2000000000003, 336.7, 231.09999999999985, 287.9000000000003, 258.2, 242.09999999999994, 245.09999999999974, 306.7000000000003, 308.60000000000053, 296.1999999999999, 271.1999999999995, 280.59999999999957, 223.49999999999991, 218.49999999999986, 300.79999999999995, 280.4999999999999, 303.4000000000001, 267.09999999999957, 223.89999999999984, 257.5999999999999, 142.29999999999998, 184.89999999999995, 295.9000000000001, 263.0, 292.0, 265.0, 222.0999999999998, 326.00000000000006, 278.6999999999997, 190.79999999999976, 285.59999999999985, 336.4999999999998, 300.30000000000007, 309.80000000000007, 334.4000000000001, 344.20000000000084, 274.9, 260.5999999999998, 301.0, 310.8999999999995, 237.9999999999995, 315.2999999999997, 236.3999999999995, 318.0, 296.0, 213.39999999999992, 178.09999999999985, 290.3999999999998, 208.79999999999978, 224.19999999999965, 54.80000000000006, 289.00000000000006, 304.9000000000001, 275.0, 266.2999999999998, 201.8999999999998, 312.9, 307.3000000000001, 310.9, 312.7000000000001, 221.49999999999991, 312.0, 196.0, 294.40000000000055, 302.8000000000003], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [95.59999999999994, 150.4999999999999, 118.09999999999988, -158.5, 182.0, 166.4, 111.5, 116.00000000000003, 125.0, 138.50000000000003, 120.19999999999996, 149.6, 59.3, -112.9, 150.49999999999977, 147.4999999999998, 194.60000000000002, 197.29999999999998, 124.09999999999994, 133.70000000000005, -22.0, 145.09999999999994, 4.1000000000000085, 116.89999999999989, -286.6, 154.1, 171.2, -63.700000000000074, 163.6999999999999, 158.6, 137.0, 142.0, 97.0, 13.0, 157.70000000000002, -20.500000000000007, 152.89999999999998, 138.1999999999999, 180.2, 125.0, 97.69999999999987, -47.800000000000004, 76.69999999999999, 133.39999999999986, 176.89999999999995, 183.5, 52.70000000000002, 137.5999999999998, 74.30000000000005, 80.89999999999996, 140.59999999999982, 43.099999999999994, 159.49999999999974, -149.8000000000002, 158.59999999999985, 146.89999999999986, 177.19999999999996, 164.90000000000003, -204.4, 163.09999999999982, 43.700000000000024, 136.4, 101.59999999999988, 139.99999999999991, 92.60000000000002, 63.80000000000004, 157.0, 150.0, 156.0, 161.0, 156.5, 154.6999999999998, 173.89999999999998, 156.79999999999995, 148.39999999999998, 52.700000000000095, 186.49999999999994, 58.40000000000001, 100.69999999999982, 141.4999999999999, 153.79999999999998, 23.300000000000004, 86.00000000000003, 127.09999999999987, 133.39999999999978, 170.29999999999995, 133.09999999999988, 168.4999999999998, 145.09999999999988, 136.09999999999997, 119.29999999999994, 146.89999999999998, 114.49999999999983, 154.09999999999974, 10.39999999999994, 154.09999999999985, 32.900000000000006, 137.59999999999988, 138.7999999999996, 140.0, 113.29999999999984, 144.20000000000005, 127.99999999999984, 160.39999999999995, 131.6, 111.49999999999963, 173.89999999999984, -25.0, 59.60000000000004, 163.9999999999999, 86.9, -22.60000000000006, -4.299999999999997, 126.19999999999999, 130.69999999999993, 162.1999999999999, 119.0, 117.0, 144.0, 126.0, 134.0, 111.0, 56.599999999999994, 108.49999999999991, 142.1, 164.89999999999992, 134.29999999999995, 127.40000000000003, 60.200000000000045, 83.60000000000002, 139.99999999999972, 140.59999999999974, 147.5, 172.99999999999994, 148.39999999999998, 134.8999999999998, 130.39999999999998, 169.39999999999986, 150.20000000000005, 180.19999999999993, 163.0999999999998, 181.0999999999999, 159.49999999999991, 88.4, 5.300000000000008, 170.29999999999987, 148.69999999999982, 152.29999999999976, 145.99999999999986, 164.8999999999998, 164.89999999999995, 73.1, 179.60000000000002, 130.69999999999985, 90.49999999999984, 110.89999999999989, 167.0, 142.0, 166.0, 130.0, 125.00000000000003, 22.40000000000002, 37.10000000000003, 88.99999999999994, 159.1999999999998, 111.19999999999986, 17.299999999999997, 123.4999999999998, 89.59999999999985, 83.59999999999997, 48.80000000000001, -85.00000000000017, 158.59999999999985, 124.39999999999979, 126.19999999999955, 175.7, 155.90000000000003, 79.1, 98.29999999999957, 142.99999999999997, 95.9, 82.99999999999977, 123.79999999999995, 172.09999999999985, 131.59999999999962, 175.6999999999999, 134.29999999999984, 176.59999999999994, 187.39999999999998, 125.29999999999967, 111.1999999999998, 77.3, 156.0, 156.0, 121.0, -16.0, 160.99999999999994, 124.39999999999958, 145.09999999999982, 133.69999999999996], "policy_predator_policy_reward": [0.0, 0.0, 22.0, 95.0, 0.0, 13.0, 41.0, 0.0, 27.0, 9.0, 18.0, 19.0, 21.0, 114.0, 7.0, 0.0, 0.0, 0.0, 16.0, 17.0, 68.0, 0.0, 42.0, 52.0, 147.0, 106.0, 92.0, 0.0, 0.0, 7.0, 20.0, 0.0, 49.0, 38.0, 42.0, 66.0, 20.0, 0.0, 25.0, 0.0, 17.0, 85.0, 36.0, 0.0, 0.0, 6.0, 19.0, 25.0, 8.0, 17.0, 31.0, 46.0, 45.0, 53.0, 0.0, 9.0, 0.0, 1.0, 38.0, 127.0, 44.0, 48.0, 14.0, 25.0, 32.0, 0.0, 1.0, 0.0, 0.0, 0.0, 6.0, 10.0, 6.0, 0.0, 0.0, 30.0, 25.0, 18.0, 13.0, 3.0, 0.0, 65.0, 32.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 15.0, 5.0, 0.0, 0.0, 12.0, 0.0, 59.0, 5.0, 43.0, 10.0, 12.0, 11.0, 12.0, 15.0, 0.0, 0.0, 24.0, 75.0, 0.0, 1.0, 33.0, 61.0, 17.0, 63.0, 0.0, 3.0, 0.0, 21.0, 6.0, 22.0, 0.0, 20.0, 0.0, 47.0, 10.0, 19.0, 0.0, 17.0, 0.0, 34.0, 13.0, 5.0, 0.0, 14.0, 2.0, 7.0, 10.0, 0.0, 10.0, 4.0, 0.0, 0.0, 0.0, 12.0, 15.0, 58.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 35.0, 0.0, 9.0, 0.0, 0.0, 16.0, 50.0, 11.0, 41.0, 20.0, 0.0, 57.0, 11.0, 35.0, 16.0, 86.0, 5.0, 0.0, 6.0, 3.0, 0.0, 40.0, 0.0, 1.0, 24.0, 0.0, 23.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 22.0, 0.0, 0.0, 54.0, 37.0, 3.0, 6.0, 4.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.649378678323698, "mean_inference_ms": 4.7464665091834926, "mean_action_processing_ms": 0.9251340077414636, "mean_env_wait_ms": 0.5351685996210613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00629878044128418, "StateBufferConnector_ms": 0.004327654838562012, "ViewRequirementAgentConnector_ms": 0.23314905166625977}, "num_episodes": 18, "episode_return_max": 391.9, "episode_return_min": 54.80000000000006, "episode_return_mean": 262.274, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 221.97691334868244, "num_env_steps_trained_throughput_per_sec": 221.97691334868244, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 19807.55, "restore_workers_time_ms": 0.019, "training_step_time_ms": 19807.488, "sample_time_ms": 3137.738, "learn_time_ms": 16644.497, "learn_throughput": 240.32, "synch_weights_time_ms": 21.367}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "training_iteration": 34, "trial_id": "e4caa_00000", "date": "2024-08-13_19-56-51", "timestamp": 1723593411, "time_this_iter_s": 18.112924814224243, "time_total_s": 748.4718158245087, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2909b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 748.4718158245087, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 77.99615384615385, "ram_util_percent": 83.59615384615384}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.1222539218329874, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.441888811474755, "policy_loss": 0.006630499310244525, "vf_loss": 6.432333410858477, "vf_explained_var": 0.0642875417830452, "kl": 0.01949936627428444, "entropy": 1.5443637614527708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.173711666669795, "cur_kl_coeff": 0.0125, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0595682217961266, "policy_loss": -0.004999883469839693, "vf_loss": 1.0645196621380155, "vf_explained_var": 0.04332005362662058, "kl": 0.0038752936252997856, "entropy": 0.3883236175334012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 65205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 371.8999999999999, "episode_reward_min": 54.80000000000006, "episode_reward_mean": 275.371, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -204.4, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 190.1, "predator_policy": 127.0}, "policy_reward_mean": {"prey_policy": 123.34549999999992, "predator_policy": 14.34}, "custom_metrics": {}, "hist_stats": {"episode_reward": [311.10000000000036, 330.20000000000005, 151.89999999999984, 246.09999999999977, 366.4000000000002, 234.2999999999997, 180.19999999999965, 260.69999999999976, 107.70000000000002, 314.5000000000008, 343.10000000000025, 123.69999999999982, 272.0999999999999, 280.6000000000007, 188.39999999999966, 308.0, 317.0, 327.2000000000003, 336.7, 231.09999999999985, 287.9000000000003, 258.2, 242.09999999999994, 245.09999999999974, 306.7000000000003, 308.60000000000053, 296.1999999999999, 271.1999999999995, 280.59999999999957, 223.49999999999991, 218.49999999999986, 300.79999999999995, 280.4999999999999, 303.4000000000001, 267.09999999999957, 223.89999999999984, 257.5999999999999, 142.29999999999998, 184.89999999999995, 295.9000000000001, 263.0, 292.0, 265.0, 222.0999999999998, 326.00000000000006, 278.6999999999997, 190.79999999999976, 285.59999999999985, 336.4999999999998, 300.30000000000007, 309.80000000000007, 334.4000000000001, 344.20000000000084, 274.9, 260.5999999999998, 301.0, 310.8999999999995, 237.9999999999995, 315.2999999999997, 236.3999999999995, 318.0, 296.0, 213.39999999999992, 178.09999999999985, 290.3999999999998, 208.79999999999978, 224.19999999999965, 54.80000000000006, 289.00000000000006, 304.9000000000001, 275.0, 266.2999999999998, 201.8999999999998, 312.9, 307.3000000000001, 310.9, 312.7000000000001, 221.49999999999991, 312.0, 196.0, 294.40000000000055, 302.8000000000003, 278.39999999999986, 274.1, 319.8999999999997, 350.5000000000006, 310.0000000000001, 371.8999999999999, 332.1999999999999, 308.4999999999998, 315.6, 342.4, 286.79999999999995, 367.1, 322.6999999999998, 284.4, 318.0, 352.0, 286.3999999999999, 313.39999999999975], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [152.89999999999998, 138.1999999999999, 180.2, 125.0, 97.69999999999987, -47.800000000000004, 76.69999999999999, 133.39999999999986, 176.89999999999995, 183.5, 52.70000000000002, 137.5999999999998, 74.30000000000005, 80.89999999999996, 140.59999999999982, 43.099999999999994, 159.49999999999974, -149.8000000000002, 158.59999999999985, 146.89999999999986, 177.19999999999996, 164.90000000000003, -204.4, 163.09999999999982, 43.700000000000024, 136.4, 101.59999999999988, 139.99999999999991, 92.60000000000002, 63.80000000000004, 157.0, 150.0, 156.0, 161.0, 156.5, 154.6999999999998, 173.89999999999998, 156.79999999999995, 148.39999999999998, 52.700000000000095, 186.49999999999994, 58.40000000000001, 100.69999999999982, 141.4999999999999, 153.79999999999998, 23.300000000000004, 86.00000000000003, 127.09999999999987, 133.39999999999978, 170.29999999999995, 133.09999999999988, 168.4999999999998, 145.09999999999988, 136.09999999999997, 119.29999999999994, 146.89999999999998, 114.49999999999983, 154.09999999999974, 10.39999999999994, 154.09999999999985, 32.900000000000006, 137.59999999999988, 138.7999999999996, 140.0, 113.29999999999984, 144.20000000000005, 127.99999999999984, 160.39999999999995, 131.6, 111.49999999999963, 173.89999999999984, -25.0, 59.60000000000004, 163.9999999999999, 86.9, -22.60000000000006, -4.299999999999997, 126.19999999999999, 130.69999999999993, 162.1999999999999, 119.0, 117.0, 144.0, 126.0, 134.0, 111.0, 56.599999999999994, 108.49999999999991, 142.1, 164.89999999999992, 134.29999999999995, 127.40000000000003, 60.200000000000045, 83.60000000000002, 139.99999999999972, 140.59999999999974, 147.5, 172.99999999999994, 148.39999999999998, 134.8999999999998, 130.39999999999998, 169.39999999999986, 150.20000000000005, 180.19999999999993, 163.0999999999998, 181.0999999999999, 159.49999999999991, 88.4, 5.300000000000008, 170.29999999999987, 148.69999999999982, 152.29999999999976, 145.99999999999986, 164.8999999999998, 164.89999999999995, 73.1, 179.60000000000002, 130.69999999999985, 90.49999999999984, 110.89999999999989, 167.0, 142.0, 166.0, 130.0, 125.00000000000003, 22.40000000000002, 37.10000000000003, 88.99999999999994, 159.1999999999998, 111.19999999999986, 17.299999999999997, 123.4999999999998, 89.59999999999985, 83.59999999999997, 48.80000000000001, -85.00000000000017, 158.59999999999985, 124.39999999999979, 126.19999999999955, 175.7, 155.90000000000003, 79.1, 98.29999999999957, 142.99999999999997, 95.9, 82.99999999999977, 123.79999999999995, 172.09999999999985, 131.59999999999962, 175.6999999999999, 134.29999999999984, 176.59999999999994, 187.39999999999998, 125.29999999999967, 111.1999999999998, 77.3, 156.0, 156.0, 121.0, -16.0, 160.99999999999994, 124.39999999999958, 145.09999999999982, 133.69999999999996, 137.89999999999986, 117.5, 175.6999999999999, 28.40000000000001, 162.1999999999998, 157.69999999999993, 165.79999999999993, 184.6999999999999, 153.19999999999996, 147.7999999999999, 190.1, 180.79999999999998, 170.29999999999998, 155.8999999999999, 133.69999999999993, 162.79999999999984, 177.79999999999995, 114.80000000000001, 184.7, 157.7, 105.80000000000001, 143.0, 178.4, 157.7, 120.50000000000003, 189.19999999999993, 113.0, 118.4, 152.0, 166.0, 188.0, 135.0, 164.29999999999998, 85.10000000000002, 164.9, 132.49999999999977], "policy_predator_policy_reward": [20.0, 0.0, 25.0, 0.0, 17.0, 85.0, 36.0, 0.0, 0.0, 6.0, 19.0, 25.0, 8.0, 17.0, 31.0, 46.0, 45.0, 53.0, 0.0, 9.0, 0.0, 1.0, 38.0, 127.0, 44.0, 48.0, 14.0, 25.0, 32.0, 0.0, 1.0, 0.0, 0.0, 0.0, 6.0, 10.0, 6.0, 0.0, 0.0, 30.0, 25.0, 18.0, 13.0, 3.0, 0.0, 65.0, 32.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 15.0, 5.0, 0.0, 0.0, 12.0, 0.0, 59.0, 5.0, 43.0, 10.0, 12.0, 11.0, 12.0, 15.0, 0.0, 0.0, 24.0, 75.0, 0.0, 1.0, 33.0, 61.0, 17.0, 63.0, 0.0, 3.0, 0.0, 21.0, 6.0, 22.0, 0.0, 20.0, 0.0, 47.0, 10.0, 19.0, 0.0, 17.0, 0.0, 34.0, 13.0, 5.0, 0.0, 14.0, 2.0, 7.0, 10.0, 0.0, 10.0, 4.0, 0.0, 0.0, 0.0, 12.0, 15.0, 58.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 35.0, 0.0, 9.0, 0.0, 0.0, 16.0, 50.0, 11.0, 41.0, 20.0, 0.0, 57.0, 11.0, 35.0, 16.0, 86.0, 5.0, 0.0, 6.0, 3.0, 0.0, 40.0, 0.0, 1.0, 24.0, 0.0, 23.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 22.0, 0.0, 0.0, 54.0, 37.0, 3.0, 6.0, 4.0, 20.0, 0.0, 23.0, 20.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 1.0, 0.0, 6.0, 0.0, 0.0, 12.0, 23.0, 0.0, 0.0, 0.0, 11.0, 27.0, 18.0, 13.0, 13.0, 0.0, 22.0, 31.0, 0.0, 0.0, 13.0, 16.0, 6.0, 31.0, 8.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.635636471353469, "mean_inference_ms": 4.712534043128807, "mean_action_processing_ms": 0.9129210489917355, "mean_env_wait_ms": 0.5314892426737433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006327986717224121, "StateBufferConnector_ms": 0.004354000091552734, "ViewRequirementAgentConnector_ms": 0.2449721097946167}, "num_episodes": 18, "episode_return_max": 371.8999999999999, "episode_return_min": 54.80000000000006, "episode_return_mean": 275.371, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 187.62218154337717, "num_env_steps_trained_throughput_per_sec": 187.62218154337717, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 19639.322, "restore_workers_time_ms": 0.017, "training_step_time_ms": 19639.263, "sample_time_ms": 2776.91, "learn_time_ms": 16834.602, "learn_throughput": 237.606, "synch_weights_time_ms": 23.798}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 35, "trial_id": "e4caa_00000", "date": "2024-08-13_19-57-13", "timestamp": 1723593433, "time_this_iter_s": 21.35408592224121, "time_total_s": 769.8259017467499, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03a4430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 769.8259017467499, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 85.49333333333334, "ram_util_percent": 83.22666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.917545263098661, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.361995836540505, "policy_loss": 0.001658252382000524, "vf_loss": 6.358106262469418, "vf_explained_var": 0.0813701623331302, "kl": 0.014875500965612404, "entropy": 1.5586022848174685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.281629551907696, "cur_kl_coeff": 0.00625, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7218853961853755, "policy_loss": -0.005060036029548399, "vf_loss": 1.7269261170316625, "vf_explained_var": 0.0494385337388074, "kl": 0.0030903803055264446, "entropy": 0.34235556790279964, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 67095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "env_runners": {"episode_reward_max": 377.5, "episode_reward_min": 54.80000000000006, "episode_reward_mean": 286.2249999999999, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -85.00000000000017, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.1, "predator_policy": 86.0}, "policy_reward_mean": {"prey_policy": 129.9074999999999, "predator_policy": 13.205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [242.09999999999994, 245.09999999999974, 306.7000000000003, 308.60000000000053, 296.1999999999999, 271.1999999999995, 280.59999999999957, 223.49999999999991, 218.49999999999986, 300.79999999999995, 280.4999999999999, 303.4000000000001, 267.09999999999957, 223.89999999999984, 257.5999999999999, 142.29999999999998, 184.89999999999995, 295.9000000000001, 263.0, 292.0, 265.0, 222.0999999999998, 326.00000000000006, 278.6999999999997, 190.79999999999976, 285.59999999999985, 336.4999999999998, 300.30000000000007, 309.80000000000007, 334.4000000000001, 344.20000000000084, 274.9, 260.5999999999998, 301.0, 310.8999999999995, 237.9999999999995, 315.2999999999997, 236.3999999999995, 318.0, 296.0, 213.39999999999992, 178.09999999999985, 290.3999999999998, 208.79999999999978, 224.19999999999965, 54.80000000000006, 289.00000000000006, 304.9000000000001, 275.0, 266.2999999999998, 201.8999999999998, 312.9, 307.3000000000001, 310.9, 312.7000000000001, 221.49999999999991, 312.0, 196.0, 294.40000000000055, 302.8000000000003, 278.39999999999986, 274.1, 319.8999999999997, 350.5000000000006, 310.0000000000001, 371.8999999999999, 332.1999999999999, 308.4999999999998, 315.6, 342.4, 286.79999999999995, 367.1, 322.6999999999998, 284.4, 318.0, 352.0, 286.3999999999999, 313.39999999999975, 327.0, 203.2, 263.19999999999993, 351.4, 245.1, 357.29999999999995, 298.59999999999974, 276.79999999999995, 345.9999999999998, 333.69999999999993, 377.5, 354.1000000000001, 343.4, 318.1, 321.5, 287.5, 325.09999999999997, 225.59999999999974, 283.0, 345.0, 339.70000000000016, 339.69999999999976], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [153.79999999999998, 23.300000000000004, 86.00000000000003, 127.09999999999987, 133.39999999999978, 170.29999999999995, 133.09999999999988, 168.4999999999998, 145.09999999999988, 136.09999999999997, 119.29999999999994, 146.89999999999998, 114.49999999999983, 154.09999999999974, 10.39999999999994, 154.09999999999985, 32.900000000000006, 137.59999999999988, 138.7999999999996, 140.0, 113.29999999999984, 144.20000000000005, 127.99999999999984, 160.39999999999995, 131.6, 111.49999999999963, 173.89999999999984, -25.0, 59.60000000000004, 163.9999999999999, 86.9, -22.60000000000006, -4.299999999999997, 126.19999999999999, 130.69999999999993, 162.1999999999999, 119.0, 117.0, 144.0, 126.0, 134.0, 111.0, 56.599999999999994, 108.49999999999991, 142.1, 164.89999999999992, 134.29999999999995, 127.40000000000003, 60.200000000000045, 83.60000000000002, 139.99999999999972, 140.59999999999974, 147.5, 172.99999999999994, 148.39999999999998, 134.8999999999998, 130.39999999999998, 169.39999999999986, 150.20000000000005, 180.19999999999993, 163.0999999999998, 181.0999999999999, 159.49999999999991, 88.4, 5.300000000000008, 170.29999999999987, 148.69999999999982, 152.29999999999976, 145.99999999999986, 164.8999999999998, 164.89999999999995, 73.1, 179.60000000000002, 130.69999999999985, 90.49999999999984, 110.89999999999989, 167.0, 142.0, 166.0, 130.0, 125.00000000000003, 22.40000000000002, 37.10000000000003, 88.99999999999994, 159.1999999999998, 111.19999999999986, 17.299999999999997, 123.4999999999998, 89.59999999999985, 83.59999999999997, 48.80000000000001, -85.00000000000017, 158.59999999999985, 124.39999999999979, 126.19999999999955, 175.7, 155.90000000000003, 79.1, 98.29999999999957, 142.99999999999997, 95.9, 82.99999999999977, 123.79999999999995, 172.09999999999985, 131.59999999999962, 175.6999999999999, 134.29999999999984, 176.59999999999994, 187.39999999999998, 125.29999999999967, 111.1999999999998, 77.3, 156.0, 156.0, 121.0, -16.0, 160.99999999999994, 124.39999999999958, 145.09999999999982, 133.69999999999996, 137.89999999999986, 117.5, 175.6999999999999, 28.40000000000001, 162.1999999999998, 157.69999999999993, 165.79999999999993, 184.6999999999999, 153.19999999999996, 147.7999999999999, 190.1, 180.79999999999998, 170.29999999999998, 155.8999999999999, 133.69999999999993, 162.79999999999984, 177.79999999999995, 114.80000000000001, 184.7, 157.7, 105.80000000000001, 143.0, 178.4, 157.7, 120.50000000000003, 189.19999999999993, 113.0, 118.4, 152.0, 166.0, 188.0, 135.0, 164.29999999999998, 85.10000000000002, 164.9, 132.49999999999977, 141.49999999999997, 180.5, -1.8999999999999986, 94.1, 183.79999999999995, 34.39999999999996, 171.2, 171.19999999999996, 129.5, 74.60000000000001, 147.5, 192.8, 154.99999999999983, 128.60000000000002, 175.7, -37.9, 162.19999999999996, 183.79999999999995, 161.8999999999999, 153.79999999999998, 178.39999999999986, 199.1, 185.59999999999994, 168.50000000000006, 182.9, 156.5, 145.7, 163.4, 177.2, 116.30000000000001, 36.5, 185.0, 114.19999999999996, 191.89999999999995, 45.80000000000006, 132.79999999999995, 20.0, 195.0, 146.0, 193.0, 163.09999999999997, 167.6, 168.49999999999997, 171.20000000000005], "policy_predator_policy_reward": [0.0, 65.0, 32.0, 0.0, 0.0, 3.0, 7.0, 0.0, 0.0, 15.0, 5.0, 0.0, 0.0, 12.0, 0.0, 59.0, 5.0, 43.0, 10.0, 12.0, 11.0, 12.0, 15.0, 0.0, 0.0, 24.0, 75.0, 0.0, 1.0, 33.0, 61.0, 17.0, 63.0, 0.0, 3.0, 0.0, 21.0, 6.0, 22.0, 0.0, 20.0, 0.0, 47.0, 10.0, 19.0, 0.0, 17.0, 0.0, 34.0, 13.0, 5.0, 0.0, 14.0, 2.0, 7.0, 10.0, 0.0, 10.0, 4.0, 0.0, 0.0, 0.0, 12.0, 15.0, 58.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 35.0, 0.0, 9.0, 0.0, 0.0, 16.0, 50.0, 11.0, 41.0, 20.0, 0.0, 57.0, 11.0, 35.0, 16.0, 86.0, 5.0, 0.0, 6.0, 3.0, 0.0, 40.0, 0.0, 1.0, 24.0, 0.0, 23.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 22.0, 0.0, 0.0, 54.0, 37.0, 3.0, 6.0, 4.0, 20.0, 0.0, 23.0, 20.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 1.0, 0.0, 6.0, 0.0, 0.0, 12.0, 23.0, 0.0, 0.0, 0.0, 11.0, 27.0, 18.0, 13.0, 13.0, 0.0, 22.0, 31.0, 0.0, 0.0, 13.0, 16.0, 6.0, 31.0, 8.0, 8.0, 5.0, 0.0, 67.0, 44.0, 0.0, 45.0, 0.0, 9.0, 41.0, 0.0, 16.0, 1.0, 9.0, 6.0, 60.0, 79.0, 0.0, 0.0, 10.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 1.0, 8.0, 28.0, 0.0, 13.0, 53.0, 0.0, 19.0, 35.0, 12.0, 50.0, 18.0, 0.0, 6.0, 0.0, 9.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6227467657758934, "mean_inference_ms": 4.670595484236803, "mean_action_processing_ms": 0.8986549841072059, "mean_env_wait_ms": 0.5282164077397735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008310675621032715, "StateBufferConnector_ms": 0.0036499500274658203, "ViewRequirementAgentConnector_ms": 0.2497720718383789}, "num_episodes": 22, "episode_return_max": 377.5, "episode_return_min": 54.80000000000006, "episode_return_mean": 286.2249999999999, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 222.01338150332236, "num_env_steps_trained_throughput_per_sec": 222.01338150332236, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 19086.416, "restore_workers_time_ms": 0.016, "training_step_time_ms": 19086.36, "sample_time_ms": 2567.478, "learn_time_ms": 16491.248, "learn_throughput": 242.553, "synch_weights_time_ms": 23.942}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "training_iteration": 36, "trial_id": "e4caa_00000", "date": "2024-08-13_19-57-31", "timestamp": 1723593451, "time_this_iter_s": 18.06833815574646, "time_total_s": 787.8942399024963, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03a28b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 787.8942399024963, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 82.32, "ram_util_percent": 83.33200000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2004596125511897, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.754241686270981, "policy_loss": -0.006356568996198278, "vf_loss": 7.757804133400085, "vf_explained_var": 0.09391336690181147, "kl": 0.01862744343845068, "entropy": 1.5137633422064403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4059631791695084, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9735218374186723, "policy_loss": -0.008126898934059436, "vf_loss": 1.9816304755589318, "vf_explained_var": 0.05484463288670494, "kl": 0.005843467250077397, "entropy": 0.39027127457989585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 68985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "env_runners": {"episode_reward_max": 377.5, "episode_reward_min": 54.80000000000006, "episode_reward_mean": 282.79099999999994, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -85.00000000000017, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.1, "predator_policy": 86.0}, "policy_reward_mean": {"prey_policy": 127.73049999999994, "predator_policy": 13.665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [278.6999999999997, 190.79999999999976, 285.59999999999985, 336.4999999999998, 300.30000000000007, 309.80000000000007, 334.4000000000001, 344.20000000000084, 274.9, 260.5999999999998, 301.0, 310.8999999999995, 237.9999999999995, 315.2999999999997, 236.3999999999995, 318.0, 296.0, 213.39999999999992, 178.09999999999985, 290.3999999999998, 208.79999999999978, 224.19999999999965, 54.80000000000006, 289.00000000000006, 304.9000000000001, 275.0, 266.2999999999998, 201.8999999999998, 312.9, 307.3000000000001, 310.9, 312.7000000000001, 221.49999999999991, 312.0, 196.0, 294.40000000000055, 302.8000000000003, 278.39999999999986, 274.1, 319.8999999999997, 350.5000000000006, 310.0000000000001, 371.8999999999999, 332.1999999999999, 308.4999999999998, 315.6, 342.4, 286.79999999999995, 367.1, 322.6999999999998, 284.4, 318.0, 352.0, 286.3999999999999, 313.39999999999975, 327.0, 203.2, 263.19999999999993, 351.4, 245.1, 357.29999999999995, 298.59999999999974, 276.79999999999995, 345.9999999999998, 333.69999999999993, 377.5, 354.1000000000001, 343.4, 318.1, 321.5, 287.5, 325.09999999999997, 225.59999999999974, 283.0, 345.0, 339.70000000000016, 339.69999999999976, 268.09999999999997, 311.1000000000004, 198.29999999999978, 323.30000000000047, 152.89999999999978, 246.2, 273.2999999999998, 190.9999999999999, 154.6, 223.89999999999924, 247.59999999999985, 289.0, 334.0000000000002, 281.2999999999997, 278.1, 269.39999999999975, 165.49999999999991, 330.0, 165.0, 255.0, 322.5, 241.59999999999948, 151.89999999999978], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [134.29999999999995, 127.40000000000003, 60.200000000000045, 83.60000000000002, 139.99999999999972, 140.59999999999974, 147.5, 172.99999999999994, 148.39999999999998, 134.8999999999998, 130.39999999999998, 169.39999999999986, 150.20000000000005, 180.19999999999993, 163.0999999999998, 181.0999999999999, 159.49999999999991, 88.4, 5.300000000000008, 170.29999999999987, 148.69999999999982, 152.29999999999976, 145.99999999999986, 164.8999999999998, 164.89999999999995, 73.1, 179.60000000000002, 130.69999999999985, 90.49999999999984, 110.89999999999989, 167.0, 142.0, 166.0, 130.0, 125.00000000000003, 22.40000000000002, 37.10000000000003, 88.99999999999994, 159.1999999999998, 111.19999999999986, 17.299999999999997, 123.4999999999998, 89.59999999999985, 83.59999999999997, 48.80000000000001, -85.00000000000017, 158.59999999999985, 124.39999999999979, 126.19999999999955, 175.7, 155.90000000000003, 79.1, 98.29999999999957, 142.99999999999997, 95.9, 82.99999999999977, 123.79999999999995, 172.09999999999985, 131.59999999999962, 175.6999999999999, 134.29999999999984, 176.59999999999994, 187.39999999999998, 125.29999999999967, 111.1999999999998, 77.3, 156.0, 156.0, 121.0, -16.0, 160.99999999999994, 124.39999999999958, 145.09999999999982, 133.69999999999996, 137.89999999999986, 117.5, 175.6999999999999, 28.40000000000001, 162.1999999999998, 157.69999999999993, 165.79999999999993, 184.6999999999999, 153.19999999999996, 147.7999999999999, 190.1, 180.79999999999998, 170.29999999999998, 155.8999999999999, 133.69999999999993, 162.79999999999984, 177.79999999999995, 114.80000000000001, 184.7, 157.7, 105.80000000000001, 143.0, 178.4, 157.7, 120.50000000000003, 189.19999999999993, 113.0, 118.4, 152.0, 166.0, 188.0, 135.0, 164.29999999999998, 85.10000000000002, 164.9, 132.49999999999977, 141.49999999999997, 180.5, -1.8999999999999986, 94.1, 183.79999999999995, 34.39999999999996, 171.2, 171.19999999999996, 129.5, 74.60000000000001, 147.5, 192.8, 154.99999999999983, 128.60000000000002, 175.7, -37.9, 162.19999999999996, 183.79999999999995, 161.8999999999999, 153.79999999999998, 178.39999999999986, 199.1, 185.59999999999994, 168.50000000000006, 182.9, 156.5, 145.7, 163.4, 177.2, 116.30000000000001, 36.5, 185.0, 114.19999999999996, 191.89999999999995, 45.80000000000006, 132.79999999999995, 20.0, 195.0, 146.0, 193.0, 163.09999999999997, 167.6, 168.49999999999997, 171.20000000000005, 87.79999999999998, 134.29999999999987, 158.5999999999998, 117.5, 81.50000000000006, 75.8, 149.5999999999997, 172.69999999999987, 22.700000000000077, 87.19999999999996, 35.6, 131.60000000000002, 122.59999999999985, 106.69999999999996, 4.399999999999984, 122.59999999999991, 88.70000000000002, -0.09999999999999254, 79.3999999999997, 132.4999999999996, 6.499999999999986, 157.09999999999982, 172.4, 74.6, 168.4999999999999, 159.50000000000003, 124.99999999999996, 143.2999999999998, 118.09999999999997, 140.0, 145.9999999999999, 118.3999999999997, -74.20000000000007, 145.69999999999982, 156.0, 165.0, 69.0, 83.0, 113.0, 110.0, 144.79999999999995, 154.69999999999996, 118.0999999999997, 123.49999999999986, 71.30000000000004, 32.600000000000065], "policy_predator_policy_reward": [17.0, 0.0, 34.0, 13.0, 5.0, 0.0, 14.0, 2.0, 7.0, 10.0, 0.0, 10.0, 4.0, 0.0, 0.0, 0.0, 12.0, 15.0, 58.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 35.0, 0.0, 9.0, 0.0, 0.0, 16.0, 50.0, 11.0, 41.0, 20.0, 0.0, 57.0, 11.0, 35.0, 16.0, 86.0, 5.0, 0.0, 6.0, 3.0, 0.0, 40.0, 0.0, 1.0, 24.0, 0.0, 23.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 22.0, 0.0, 0.0, 54.0, 37.0, 3.0, 6.0, 4.0, 20.0, 0.0, 23.0, 20.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 1.0, 0.0, 6.0, 0.0, 0.0, 12.0, 23.0, 0.0, 0.0, 0.0, 11.0, 27.0, 18.0, 13.0, 13.0, 0.0, 22.0, 31.0, 0.0, 0.0, 13.0, 16.0, 6.0, 31.0, 8.0, 8.0, 5.0, 0.0, 67.0, 44.0, 0.0, 45.0, 0.0, 9.0, 41.0, 0.0, 16.0, 1.0, 9.0, 6.0, 60.0, 79.0, 0.0, 0.0, 10.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 1.0, 8.0, 28.0, 0.0, 13.0, 53.0, 0.0, 19.0, 35.0, 12.0, 50.0, 18.0, 0.0, 6.0, 0.0, 9.0, 0.0, 0.0, 19.0, 27.0, 23.0, 12.0, 0.0, 41.0, 1.0, 0.0, 25.0, 18.0, 35.0, 44.0, 36.0, 8.0, 0.0, 64.0, 4.0, 62.0, 0.0, 12.0, 28.0, 56.0, 40.0, 2.0, 0.0, 6.0, 13.0, 0.0, 3.0, 17.0, 5.0, 0.0, 47.0, 47.0, 9.0, 0.0, 13.0, 0.0, 4.0, 28.0, 10.0, 13.0, 0.0, 0.0, 5.0, 43.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6001796093421283, "mean_inference_ms": 4.621624095361165, "mean_action_processing_ms": 0.8821549517075228, "mean_env_wait_ms": 0.5208645908447596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010487675666809082, "StateBufferConnector_ms": 0.003829479217529297, "ViewRequirementAgentConnector_ms": 0.19730031490325928}, "num_episodes": 23, "episode_return_max": 377.5, "episode_return_min": 54.80000000000006, "episode_return_mean": 282.79099999999994, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 224.08835600496303, "num_env_steps_trained_throughput_per_sec": 224.08835600496303, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 18948.12, "restore_workers_time_ms": 0.016, "training_step_time_ms": 18948.064, "sample_time_ms": 2477.795, "learn_time_ms": 16440.493, "learn_throughput": 243.302, "synch_weights_time_ms": 26.211}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "training_iteration": 37, "trial_id": "e4caa_00000", "date": "2024-08-13_19-57-49", "timestamp": 1723593469, "time_this_iter_s": 17.97415590286255, "time_total_s": 805.8683958053589, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2886790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 805.8683958053589, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 80.7076923076923, "ram_util_percent": 83.6346153846154}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.580432492715341, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.876819422131493, "policy_loss": 0.002563403332458129, "vf_loss": 6.872101585953324, "vf_explained_var": 0.21957302765240744, "kl": 0.01436274134019995, "entropy": 1.502808162838063, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2461759523897575, "cur_kl_coeff": 0.003125, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6548433124703705, "policy_loss": -0.003937460388741875, "vf_loss": 1.6587695808006973, "vf_explained_var": 0.11000130318460011, "kl": 0.0035818345858015096, "entropy": 0.4328063139839778, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 70875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "env_runners": {"episode_reward_max": 377.5, "episode_reward_min": 54.80000000000006, "episode_reward_mean": 281.53299999999996, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -85.00000000000017, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.1, "predator_policy": 86.0}, "policy_reward_mean": {"prey_policy": 127.04149999999994, "predator_policy": 13.725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [178.09999999999985, 290.3999999999998, 208.79999999999978, 224.19999999999965, 54.80000000000006, 289.00000000000006, 304.9000000000001, 275.0, 266.2999999999998, 201.8999999999998, 312.9, 307.3000000000001, 310.9, 312.7000000000001, 221.49999999999991, 312.0, 196.0, 294.40000000000055, 302.8000000000003, 278.39999999999986, 274.1, 319.8999999999997, 350.5000000000006, 310.0000000000001, 371.8999999999999, 332.1999999999999, 308.4999999999998, 315.6, 342.4, 286.79999999999995, 367.1, 322.6999999999998, 284.4, 318.0, 352.0, 286.3999999999999, 313.39999999999975, 327.0, 203.2, 263.19999999999993, 351.4, 245.1, 357.29999999999995, 298.59999999999974, 276.79999999999995, 345.9999999999998, 333.69999999999993, 377.5, 354.1000000000001, 343.4, 318.1, 321.5, 287.5, 325.09999999999997, 225.59999999999974, 283.0, 345.0, 339.70000000000016, 339.69999999999976, 268.09999999999997, 311.1000000000004, 198.29999999999978, 323.30000000000047, 152.89999999999978, 246.2, 273.2999999999998, 190.9999999999999, 154.6, 223.89999999999924, 247.59999999999985, 289.0, 334.0000000000002, 281.2999999999997, 278.1, 269.39999999999975, 165.49999999999991, 330.0, 165.0, 255.0, 322.5, 241.59999999999948, 151.89999999999978, 340.6000000000002, 318.0999999999999, 228.0, 324.1999999999998, 294.10000000000014, 237.0999999999995, 310.49999999999983, 290.60000000000014, 297.90000000000055, 253.19999999999973, 310.7000000000003, 335.5999999999997, 292.90000000000083, 120.39999999999978, 321.0, 169.0, 240.7999999999997, 334.3], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [37.10000000000003, 88.99999999999994, 159.1999999999998, 111.19999999999986, 17.299999999999997, 123.4999999999998, 89.59999999999985, 83.59999999999997, 48.80000000000001, -85.00000000000017, 158.59999999999985, 124.39999999999979, 126.19999999999955, 175.7, 155.90000000000003, 79.1, 98.29999999999957, 142.99999999999997, 95.9, 82.99999999999977, 123.79999999999995, 172.09999999999985, 131.59999999999962, 175.6999999999999, 134.29999999999984, 176.59999999999994, 187.39999999999998, 125.29999999999967, 111.1999999999998, 77.3, 156.0, 156.0, 121.0, -16.0, 160.99999999999994, 124.39999999999958, 145.09999999999982, 133.69999999999996, 137.89999999999986, 117.5, 175.6999999999999, 28.40000000000001, 162.1999999999998, 157.69999999999993, 165.79999999999993, 184.6999999999999, 153.19999999999996, 147.7999999999999, 190.1, 180.79999999999998, 170.29999999999998, 155.8999999999999, 133.69999999999993, 162.79999999999984, 177.79999999999995, 114.80000000000001, 184.7, 157.7, 105.80000000000001, 143.0, 178.4, 157.7, 120.50000000000003, 189.19999999999993, 113.0, 118.4, 152.0, 166.0, 188.0, 135.0, 164.29999999999998, 85.10000000000002, 164.9, 132.49999999999977, 141.49999999999997, 180.5, -1.8999999999999986, 94.1, 183.79999999999995, 34.39999999999996, 171.2, 171.19999999999996, 129.5, 74.60000000000001, 147.5, 192.8, 154.99999999999983, 128.60000000000002, 175.7, -37.9, 162.19999999999996, 183.79999999999995, 161.8999999999999, 153.79999999999998, 178.39999999999986, 199.1, 185.59999999999994, 168.50000000000006, 182.9, 156.5, 145.7, 163.4, 177.2, 116.30000000000001, 36.5, 185.0, 114.19999999999996, 191.89999999999995, 45.80000000000006, 132.79999999999995, 20.0, 195.0, 146.0, 193.0, 163.09999999999997, 167.6, 168.49999999999997, 171.20000000000005, 87.79999999999998, 134.29999999999987, 158.5999999999998, 117.5, 81.50000000000006, 75.8, 149.5999999999997, 172.69999999999987, 22.700000000000077, 87.19999999999996, 35.6, 131.60000000000002, 122.59999999999985, 106.69999999999996, 4.399999999999984, 122.59999999999991, 88.70000000000002, -0.09999999999999254, 79.3999999999997, 132.4999999999996, 6.499999999999986, 157.09999999999982, 172.4, 74.6, 168.4999999999999, 159.50000000000003, 124.99999999999996, 143.2999999999998, 118.09999999999997, 140.0, 145.9999999999999, 118.3999999999997, -74.20000000000007, 145.69999999999982, 156.0, 165.0, 69.0, 83.0, 113.0, 110.0, 144.79999999999995, 154.69999999999996, 118.0999999999997, 123.49999999999986, 71.30000000000004, 32.600000000000065, 179.29999999999995, 161.3, 164.89999999999986, 153.2, 121.69999999999997, 74.3, 133.09999999999997, 172.09999999999997, 137.89999999999986, 144.2, 87.50000000000004, 149.59999999999977, 180.19999999999996, 95.30000000000001, 103.39999999999992, 162.20000000000002, 161.2999999999999, 113.59999999999985, 119.00000000000003, 120.20000000000003, 170.29999999999987, 130.39999999999986, 175.69999999999993, 152.89999999999984, 164.8999999999998, 127.99999999999966, 52.4, 20.000000000000014, 107.0, 189.0, 146.0, -33.0, 47.60000000000008, 162.19999999999993, 119.89999999999998, 196.4], "policy_predator_policy_reward": [11.0, 41.0, 20.0, 0.0, 57.0, 11.0, 35.0, 16.0, 86.0, 5.0, 0.0, 6.0, 3.0, 0.0, 40.0, 0.0, 1.0, 24.0, 0.0, 23.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 22.0, 0.0, 0.0, 54.0, 37.0, 3.0, 6.0, 4.0, 20.0, 0.0, 23.0, 20.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 1.0, 0.0, 6.0, 0.0, 0.0, 12.0, 23.0, 0.0, 0.0, 0.0, 11.0, 27.0, 18.0, 13.0, 13.0, 0.0, 22.0, 31.0, 0.0, 0.0, 13.0, 16.0, 6.0, 31.0, 8.0, 8.0, 5.0, 0.0, 67.0, 44.0, 0.0, 45.0, 0.0, 9.0, 41.0, 0.0, 16.0, 1.0, 9.0, 6.0, 60.0, 79.0, 0.0, 0.0, 10.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 1.0, 8.0, 28.0, 0.0, 13.0, 53.0, 0.0, 19.0, 35.0, 12.0, 50.0, 18.0, 0.0, 6.0, 0.0, 9.0, 0.0, 0.0, 19.0, 27.0, 23.0, 12.0, 0.0, 41.0, 1.0, 0.0, 25.0, 18.0, 35.0, 44.0, 36.0, 8.0, 0.0, 64.0, 4.0, 62.0, 0.0, 12.0, 28.0, 56.0, 40.0, 2.0, 0.0, 6.0, 13.0, 0.0, 3.0, 17.0, 5.0, 0.0, 47.0, 47.0, 9.0, 0.0, 13.0, 0.0, 4.0, 28.0, 10.0, 13.0, 0.0, 0.0, 5.0, 43.0, 0.0, 0.0, 0.0, 0.0, 32.0, 0.0, 10.0, 9.0, 0.0, 12.0, 0.0, 0.0, 23.0, 12.0, 0.0, 25.0, 10.0, 13.0, 5.0, 9.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 48.0, 0.0, 0.0, 25.0, 22.0, 34.0, 0.0, 31.0, 5.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5862514355480584, "mean_inference_ms": 4.582884442117784, "mean_action_processing_ms": 0.8698782270146921, "mean_env_wait_ms": 0.5163875021559052, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010420560836791992, "StateBufferConnector_ms": 0.003702402114868164, "ViewRequirementAgentConnector_ms": 0.20427143573760986}, "num_episodes": 18, "episode_return_max": 377.5, "episode_return_min": 54.80000000000006, "episode_return_mean": 281.53299999999996, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 195.59274833453935, "num_env_steps_trained_throughput_per_sec": 195.59274833453935, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 19116.166, "restore_workers_time_ms": 0.015, "training_step_time_ms": 19116.112, "sample_time_ms": 2533.264, "learn_time_ms": 16548.613, "learn_throughput": 241.712, "synch_weights_time_ms": 30.856}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "training_iteration": 38, "trial_id": "e4caa_00000", "date": "2024-08-13_19-58-09", "timestamp": 1723593489, "time_this_iter_s": 20.519129276275635, "time_total_s": 826.3875250816345, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2863430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 826.3875250816345, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 85.7344827586207, "ram_util_percent": 83.58965517241379}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.198707626200227, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.326881202818855, "policy_loss": -0.002082889115009161, "vf_loss": 7.327604315016004, "vf_explained_var": 0.11546759006207583, "kl": 0.009065196998858159, "entropy": 1.5087784726783713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.400148535105917, "cur_kl_coeff": 0.0015625, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3702108747744686, "policy_loss": -0.0027231698571186925, "vf_loss": 2.3729276648904913, "vf_explained_var": 0.01957524847732019, "kl": 0.004084187680344634, "entropy": 0.2989529951224251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 72765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "env_runners": {"episode_reward_max": 377.5, "episode_reward_min": -77.0, "episode_reward_mean": 278.07899999999995, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -206.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.1, "predator_policy": 136.0}, "policy_reward_mean": {"prey_policy": 123.75449999999995, "predator_policy": 15.285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [302.8000000000003, 278.39999999999986, 274.1, 319.8999999999997, 350.5000000000006, 310.0000000000001, 371.8999999999999, 332.1999999999999, 308.4999999999998, 315.6, 342.4, 286.79999999999995, 367.1, 322.6999999999998, 284.4, 318.0, 352.0, 286.3999999999999, 313.39999999999975, 327.0, 203.2, 263.19999999999993, 351.4, 245.1, 357.29999999999995, 298.59999999999974, 276.79999999999995, 345.9999999999998, 333.69999999999993, 377.5, 354.1000000000001, 343.4, 318.1, 321.5, 287.5, 325.09999999999997, 225.59999999999974, 283.0, 345.0, 339.70000000000016, 339.69999999999976, 268.09999999999997, 311.1000000000004, 198.29999999999978, 323.30000000000047, 152.89999999999978, 246.2, 273.2999999999998, 190.9999999999999, 154.6, 223.89999999999924, 247.59999999999985, 289.0, 334.0000000000002, 281.2999999999997, 278.1, 269.39999999999975, 165.49999999999991, 330.0, 165.0, 255.0, 322.5, 241.59999999999948, 151.89999999999978, 340.6000000000002, 318.0999999999999, 228.0, 324.1999999999998, 294.10000000000014, 237.0999999999995, 310.49999999999983, 290.60000000000014, 297.90000000000055, 253.19999999999973, 310.7000000000003, 335.5999999999997, 292.90000000000083, 120.39999999999978, 321.0, 169.0, 240.7999999999997, 334.3, 224.19999999999968, 307.1999999999999, 240.79999999999976, 265.89999999999986, 356.9, 306.80000000000007, 278.80000000000007, 267.2999999999997, 269.8999999999999, 260.40000000000003, 153.10000000000002, 27.800000000000157, 237.39999999999975, 357.70000000000005, -77.0, 163.0, 290.69999999999965, 284.80000000000103], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [145.09999999999982, 133.69999999999996, 137.89999999999986, 117.5, 175.6999999999999, 28.40000000000001, 162.1999999999998, 157.69999999999993, 165.79999999999993, 184.6999999999999, 153.19999999999996, 147.7999999999999, 190.1, 180.79999999999998, 170.29999999999998, 155.8999999999999, 133.69999999999993, 162.79999999999984, 177.79999999999995, 114.80000000000001, 184.7, 157.7, 105.80000000000001, 143.0, 178.4, 157.7, 120.50000000000003, 189.19999999999993, 113.0, 118.4, 152.0, 166.0, 188.0, 135.0, 164.29999999999998, 85.10000000000002, 164.9, 132.49999999999977, 141.49999999999997, 180.5, -1.8999999999999986, 94.1, 183.79999999999995, 34.39999999999996, 171.2, 171.19999999999996, 129.5, 74.60000000000001, 147.5, 192.8, 154.99999999999983, 128.60000000000002, 175.7, -37.9, 162.19999999999996, 183.79999999999995, 161.8999999999999, 153.79999999999998, 178.39999999999986, 199.1, 185.59999999999994, 168.50000000000006, 182.9, 156.5, 145.7, 163.4, 177.2, 116.30000000000001, 36.5, 185.0, 114.19999999999996, 191.89999999999995, 45.80000000000006, 132.79999999999995, 20.0, 195.0, 146.0, 193.0, 163.09999999999997, 167.6, 168.49999999999997, 171.20000000000005, 87.79999999999998, 134.29999999999987, 158.5999999999998, 117.5, 81.50000000000006, 75.8, 149.5999999999997, 172.69999999999987, 22.700000000000077, 87.19999999999996, 35.6, 131.60000000000002, 122.59999999999985, 106.69999999999996, 4.399999999999984, 122.59999999999991, 88.70000000000002, -0.09999999999999254, 79.3999999999997, 132.4999999999996, 6.499999999999986, 157.09999999999982, 172.4, 74.6, 168.4999999999999, 159.50000000000003, 124.99999999999996, 143.2999999999998, 118.09999999999997, 140.0, 145.9999999999999, 118.3999999999997, -74.20000000000007, 145.69999999999982, 156.0, 165.0, 69.0, 83.0, 113.0, 110.0, 144.79999999999995, 154.69999999999996, 118.0999999999997, 123.49999999999986, 71.30000000000004, 32.600000000000065, 179.29999999999995, 161.3, 164.89999999999986, 153.2, 121.69999999999997, 74.3, 133.09999999999997, 172.09999999999997, 137.89999999999986, 144.2, 87.50000000000004, 149.59999999999977, 180.19999999999996, 95.30000000000001, 103.39999999999992, 162.20000000000002, 161.2999999999999, 113.59999999999985, 119.00000000000003, 120.20000000000003, 170.29999999999987, 130.39999999999986, 175.69999999999993, 152.89999999999984, 164.8999999999998, 127.99999999999966, 52.4, 20.000000000000014, 107.0, 189.0, 146.0, -33.0, 47.60000000000008, 162.19999999999993, 119.89999999999998, 196.4, 70.10000000000002, 121.0999999999998, 153.20000000000002, 131.0, 106.10000000000002, 103.69999999999982, 109.09999999999998, 156.79999999999998, 179.29999999999998, 173.5999999999999, 117.79999999999993, 182.0, 43.70000000000001, 187.1, 145.6999999999999, 92.6, 179.29999999999998, 47.6, 110.29999999999998, 106.09999999999994, -66.40000000000009, 126.49999999999997, -74.2000000000003, -19.0, 108.19999999999985, 75.19999999999999, 177.49999999999991, 180.19999999999987, -90.0, -206.0, 130.0, -48.0, 163.3999999999998, 116.30000000000007, 156.79999999999984, 127.99999999999986], "policy_predator_policy_reward": [4.0, 20.0, 0.0, 23.0, 20.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 1.0, 0.0, 6.0, 0.0, 0.0, 12.0, 23.0, 0.0, 0.0, 0.0, 11.0, 27.0, 18.0, 13.0, 13.0, 0.0, 22.0, 31.0, 0.0, 0.0, 13.0, 16.0, 6.0, 31.0, 8.0, 8.0, 5.0, 0.0, 67.0, 44.0, 0.0, 45.0, 0.0, 9.0, 41.0, 0.0, 16.0, 1.0, 9.0, 6.0, 60.0, 79.0, 0.0, 0.0, 10.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 1.0, 8.0, 28.0, 0.0, 13.0, 53.0, 0.0, 19.0, 35.0, 12.0, 50.0, 18.0, 0.0, 6.0, 0.0, 9.0, 0.0, 0.0, 19.0, 27.0, 23.0, 12.0, 0.0, 41.0, 1.0, 0.0, 25.0, 18.0, 35.0, 44.0, 36.0, 8.0, 0.0, 64.0, 4.0, 62.0, 0.0, 12.0, 28.0, 56.0, 40.0, 2.0, 0.0, 6.0, 13.0, 0.0, 3.0, 17.0, 5.0, 0.0, 47.0, 47.0, 9.0, 0.0, 13.0, 0.0, 4.0, 28.0, 10.0, 13.0, 0.0, 0.0, 5.0, 43.0, 0.0, 0.0, 0.0, 0.0, 32.0, 0.0, 10.0, 9.0, 0.0, 12.0, 0.0, 0.0, 23.0, 12.0, 0.0, 25.0, 10.0, 13.0, 5.0, 9.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 48.0, 0.0, 0.0, 25.0, 22.0, 34.0, 0.0, 31.0, 5.0, 13.0, 31.0, 2.0, 6.0, 17.0, 16.0, 15.0, 0.0, 0.0, 4.0, 0.0, 7.0, 0.0, 1.0, 47.0, 17.0, 12.0, 43.0, 0.0, 13.0, 31.0, 83.0, 10.0, 89.0, 32.0, 37.0, 17.0, 0.0, 0.0, 83.0, 136.0, 30.0, 51.0, 4.0, 7.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5741559900204505, "mean_inference_ms": 4.552352228833573, "mean_action_processing_ms": 0.8593217353998301, "mean_env_wait_ms": 0.5128160521000913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009815573692321777, "StateBufferConnector_ms": 0.0036160945892333984, "ViewRequirementAgentConnector_ms": 0.2080550193786621}, "num_episodes": 18, "episode_return_max": 377.5, "episode_return_min": -77.0, "episode_return_mean": 278.07899999999995, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 197.8105715979864, "num_env_steps_trained_throughput_per_sec": 197.8105715979864, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 19104.093, "restore_workers_time_ms": 0.015, "training_step_time_ms": 19104.038, "sample_time_ms": 2585.31, "learn_time_ms": 16484.456, "learn_throughput": 242.653, "synch_weights_time_ms": 30.693}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "training_iteration": 39, "trial_id": "e4caa_00000", "date": "2024-08-13_19-58-30", "timestamp": 1723593510, "time_this_iter_s": 20.29048490524292, "time_total_s": 846.6780099868774, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b289a820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 846.6780099868774, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 88.2857142857143, "ram_util_percent": 83.53571428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9475290206374316, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.79243315035704, "policy_loss": -0.007975294478188353, "vf_loss": 7.798709728856566, "vf_explained_var": 0.05443180761640034, "kl": 0.011324652192647512, "entropy": 1.5114773921234899, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6070317048559744, "cur_kl_coeff": 0.00078125, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.472853859139498, "policy_loss": -0.0038552940268779083, "vf_loss": 3.476706330233781, "vf_explained_var": 0.013479619997519034, "kl": 0.0036115723118109117, "entropy": 0.3244822003065594, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 74655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 377.5, "episode_reward_min": -105.90000000000023, "episode_reward_mean": 252.17799999999997, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -243.70000000000005, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 199.1, "predator_policy": 147.0}, "policy_reward_mean": {"prey_policy": 107.03399999999993, "predator_policy": 19.055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.4, 245.1, 357.29999999999995, 298.59999999999974, 276.79999999999995, 345.9999999999998, 333.69999999999993, 377.5, 354.1000000000001, 343.4, 318.1, 321.5, 287.5, 325.09999999999997, 225.59999999999974, 283.0, 345.0, 339.70000000000016, 339.69999999999976, 268.09999999999997, 311.1000000000004, 198.29999999999978, 323.30000000000047, 152.89999999999978, 246.2, 273.2999999999998, 190.9999999999999, 154.6, 223.89999999999924, 247.59999999999985, 289.0, 334.0000000000002, 281.2999999999997, 278.1, 269.39999999999975, 165.49999999999991, 330.0, 165.0, 255.0, 322.5, 241.59999999999948, 151.89999999999978, 340.6000000000002, 318.0999999999999, 228.0, 324.1999999999998, 294.10000000000014, 237.0999999999995, 310.49999999999983, 290.60000000000014, 297.90000000000055, 253.19999999999973, 310.7000000000003, 335.5999999999997, 292.90000000000083, 120.39999999999978, 321.0, 169.0, 240.7999999999997, 334.3, 224.19999999999968, 307.1999999999999, 240.79999999999976, 265.89999999999986, 356.9, 306.80000000000007, 278.80000000000007, 267.2999999999997, 269.8999999999999, 260.40000000000003, 153.10000000000002, 27.800000000000157, 237.39999999999975, 357.70000000000005, -77.0, 163.0, 290.69999999999965, 284.80000000000103, 145.49999999999983, 136.19999999999993, -32.40000000000001, 176.8, 297.5000000000001, 221.69999999999976, 304.90000000000055, 285.9000000000002, 292.0, 275.7999999999997, 227.60000000000002, 122.50000000000006, 321.7, 258.99999999999955, 193.09999999999928, 124.99999999999977, 142.89999999999992, 216.3999999999997, 182.0, 278.0, 174.1999999999998, -105.90000000000023], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [171.2, 171.19999999999996, 129.5, 74.60000000000001, 147.5, 192.8, 154.99999999999983, 128.60000000000002, 175.7, -37.9, 162.19999999999996, 183.79999999999995, 161.8999999999999, 153.79999999999998, 178.39999999999986, 199.1, 185.59999999999994, 168.50000000000006, 182.9, 156.5, 145.7, 163.4, 177.2, 116.30000000000001, 36.5, 185.0, 114.19999999999996, 191.89999999999995, 45.80000000000006, 132.79999999999995, 20.0, 195.0, 146.0, 193.0, 163.09999999999997, 167.6, 168.49999999999997, 171.20000000000005, 87.79999999999998, 134.29999999999987, 158.5999999999998, 117.5, 81.50000000000006, 75.8, 149.5999999999997, 172.69999999999987, 22.700000000000077, 87.19999999999996, 35.6, 131.60000000000002, 122.59999999999985, 106.69999999999996, 4.399999999999984, 122.59999999999991, 88.70000000000002, -0.09999999999999254, 79.3999999999997, 132.4999999999996, 6.499999999999986, 157.09999999999982, 172.4, 74.6, 168.4999999999999, 159.50000000000003, 124.99999999999996, 143.2999999999998, 118.09999999999997, 140.0, 145.9999999999999, 118.3999999999997, -74.20000000000007, 145.69999999999982, 156.0, 165.0, 69.0, 83.0, 113.0, 110.0, 144.79999999999995, 154.69999999999996, 118.0999999999997, 123.49999999999986, 71.30000000000004, 32.600000000000065, 179.29999999999995, 161.3, 164.89999999999986, 153.2, 121.69999999999997, 74.3, 133.09999999999997, 172.09999999999997, 137.89999999999986, 144.2, 87.50000000000004, 149.59999999999977, 180.19999999999996, 95.30000000000001, 103.39999999999992, 162.20000000000002, 161.2999999999999, 113.59999999999985, 119.00000000000003, 120.20000000000003, 170.29999999999987, 130.39999999999986, 175.69999999999993, 152.89999999999984, 164.8999999999998, 127.99999999999966, 52.4, 20.000000000000014, 107.0, 189.0, 146.0, -33.0, 47.60000000000008, 162.19999999999993, 119.89999999999998, 196.4, 70.10000000000002, 121.0999999999998, 153.20000000000002, 131.0, 106.10000000000002, 103.69999999999982, 109.09999999999998, 156.79999999999998, 179.29999999999998, 173.5999999999999, 117.79999999999993, 182.0, 43.70000000000001, 187.1, 145.6999999999999, 92.6, 179.29999999999998, 47.6, 110.29999999999998, 106.09999999999994, -66.40000000000009, 126.49999999999997, -74.2000000000003, -19.0, 108.19999999999985, 75.19999999999999, 177.49999999999991, 180.19999999999987, -90.0, -206.0, 130.0, -48.0, 163.3999999999998, 116.30000000000007, 156.79999999999984, 127.99999999999986, -9.400000000000183, 68.89999999999996, -25.900000000000055, 103.10000000000011, 5.0000000000000036, -186.4, -2.799999999999983, 128.60000000000002, 136.39999999999995, 148.09999999999985, 155.29999999999984, 7.399999999999963, 135.19999999999985, 157.69999999999993, 127.99999999999999, 149.89999999999992, 163.0999999999998, 128.89999999999998, 176.5999999999999, 99.19999999999993, 142.39999999999998, 48.19999999999999, -134.80000000000018, 152.3, 129.8, 191.89999999999995, 110.00000000000004, 136.99999999999986, 124.09999999999994, 43.999999999999936, 77.90000000000002, -16.900000000000055, -79.6, 126.49999999999989, 158.59999999999985, -47.2000000000002, 116.0, 24.0, 120.0, 147.0, 108.19999999999985, -22.0, -243.70000000000005, -140.2000000000002], "policy_predator_policy_reward": [0.0, 9.0, 41.0, 0.0, 16.0, 1.0, 9.0, 6.0, 60.0, 79.0, 0.0, 0.0, 10.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 1.0, 8.0, 28.0, 0.0, 13.0, 53.0, 0.0, 19.0, 35.0, 12.0, 50.0, 18.0, 0.0, 6.0, 0.0, 9.0, 0.0, 0.0, 19.0, 27.0, 23.0, 12.0, 0.0, 41.0, 1.0, 0.0, 25.0, 18.0, 35.0, 44.0, 36.0, 8.0, 0.0, 64.0, 4.0, 62.0, 0.0, 12.0, 28.0, 56.0, 40.0, 2.0, 0.0, 6.0, 13.0, 0.0, 3.0, 17.0, 5.0, 0.0, 47.0, 47.0, 9.0, 0.0, 13.0, 0.0, 4.0, 28.0, 10.0, 13.0, 0.0, 0.0, 5.0, 43.0, 0.0, 0.0, 0.0, 0.0, 32.0, 0.0, 10.0, 9.0, 0.0, 12.0, 0.0, 0.0, 23.0, 12.0, 0.0, 25.0, 10.0, 13.0, 5.0, 9.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 48.0, 0.0, 0.0, 25.0, 22.0, 34.0, 0.0, 31.0, 5.0, 13.0, 31.0, 2.0, 6.0, 17.0, 16.0, 15.0, 0.0, 0.0, 4.0, 0.0, 7.0, 0.0, 1.0, 47.0, 17.0, 12.0, 43.0, 0.0, 13.0, 31.0, 83.0, 10.0, 89.0, 32.0, 37.0, 17.0, 0.0, 0.0, 83.0, 136.0, 30.0, 51.0, 4.0, 7.0, 0.0, 0.0, 57.0, 29.0, 55.0, 4.0, 101.0, 48.0, 51.0, 0.0, 0.0, 13.0, 54.0, 5.0, 5.0, 7.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 26.0, 11.0, 3.0, 102.0, 0.0, 0.0, 6.0, 6.0, 24.0, 1.0, 55.0, 9.0, 39.0, 57.0, 51.0, 54.0, 42.0, 0.0, 0.0, 11.0, 48.0, 40.0, 131.0, 147.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.570240807648716, "mean_inference_ms": 4.537046009807218, "mean_action_processing_ms": 0.8505906747695522, "mean_env_wait_ms": 0.5124253936417636, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009797334671020508, "StateBufferConnector_ms": 0.00533139705657959, "ViewRequirementAgentConnector_ms": 0.22133827209472656}, "num_episodes": 22, "episode_return_max": 377.5, "episode_return_min": -105.90000000000023, "episode_return_mean": 252.17799999999997, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 193.490409955887, "num_env_steps_trained_throughput_per_sec": 193.490409955887, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 19281.948, "restore_workers_time_ms": 0.016, "training_step_time_ms": 19281.892, "sample_time_ms": 2858.488, "learn_time_ms": 16387.209, "learn_throughput": 244.093, "synch_weights_time_ms": 31.374}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 40, "trial_id": "e4caa_00000", "date": "2024-08-13_19-58-51", "timestamp": 1723593531, "time_this_iter_s": 20.76980996131897, "time_total_s": 867.4478199481964, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b286aaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 867.4478199481964, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 85.78666666666665, "ram_util_percent": 83.01333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8328133566985056, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.083892463754724, "policy_loss": -0.001817522144373802, "vf_loss": 8.08472435941141, "vf_explained_var": 0.026968271202511256, "kl": 0.006570929023621233, "entropy": 1.5088864656352492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.322578436073172, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.023596867240926, "policy_loss": -0.007287335189837943, "vf_loss": 2.0308819488873557, "vf_explained_var": 0.04562746387310129, "kl": 0.005779195252530006, "entropy": 0.33254324524963974, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 76545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "env_runners": {"episode_reward_max": 357.70000000000005, "episode_reward_min": -105.90000000000023, "episode_reward_mean": 232.07099999999988, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -243.70000000000005, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.4, "predator_policy": 147.0}, "policy_reward_mean": {"prey_policy": 95.05049999999994, "predator_policy": 20.985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [152.89999999999978, 246.2, 273.2999999999998, 190.9999999999999, 154.6, 223.89999999999924, 247.59999999999985, 289.0, 334.0000000000002, 281.2999999999997, 278.1, 269.39999999999975, 165.49999999999991, 330.0, 165.0, 255.0, 322.5, 241.59999999999948, 151.89999999999978, 340.6000000000002, 318.0999999999999, 228.0, 324.1999999999998, 294.10000000000014, 237.0999999999995, 310.49999999999983, 290.60000000000014, 297.90000000000055, 253.19999999999973, 310.7000000000003, 335.5999999999997, 292.90000000000083, 120.39999999999978, 321.0, 169.0, 240.7999999999997, 334.3, 224.19999999999968, 307.1999999999999, 240.79999999999976, 265.89999999999986, 356.9, 306.80000000000007, 278.80000000000007, 267.2999999999997, 269.8999999999999, 260.40000000000003, 153.10000000000002, 27.800000000000157, 237.39999999999975, 357.70000000000005, -77.0, 163.0, 290.69999999999965, 284.80000000000103, 145.49999999999983, 136.19999999999993, -32.40000000000001, 176.8, 297.5000000000001, 221.69999999999976, 304.90000000000055, 285.9000000000002, 292.0, 275.7999999999997, 227.60000000000002, 122.50000000000006, 321.7, 258.99999999999955, 193.09999999999928, 124.99999999999977, 142.89999999999992, 216.3999999999997, 182.0, 278.0, 174.1999999999998, -105.90000000000023, 322.60000000000025, 200.799999999999, 251.59999999999985, 282.99999999999966, 22.50000000000003, 198.29999999999964, 253.39999999999972, 178.69999999999976, 281.50000000000034, 266.90000000000003, 304.6999999999996, 275.29999999999984, 302.7999999999996, 153.29999999999995, 140.8999999999999, 39.60000000000002, 303.7000000000004, 229.0, 286.0, 152.0, 182.10000000000008, 257.4999999999997, 272.9999999999999], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [22.700000000000077, 87.19999999999996, 35.6, 131.60000000000002, 122.59999999999985, 106.69999999999996, 4.399999999999984, 122.59999999999991, 88.70000000000002, -0.09999999999999254, 79.3999999999997, 132.4999999999996, 6.499999999999986, 157.09999999999982, 172.4, 74.6, 168.4999999999999, 159.50000000000003, 124.99999999999996, 143.2999999999998, 118.09999999999997, 140.0, 145.9999999999999, 118.3999999999997, -74.20000000000007, 145.69999999999982, 156.0, 165.0, 69.0, 83.0, 113.0, 110.0, 144.79999999999995, 154.69999999999996, 118.0999999999997, 123.49999999999986, 71.30000000000004, 32.600000000000065, 179.29999999999995, 161.3, 164.89999999999986, 153.2, 121.69999999999997, 74.3, 133.09999999999997, 172.09999999999997, 137.89999999999986, 144.2, 87.50000000000004, 149.59999999999977, 180.19999999999996, 95.30000000000001, 103.39999999999992, 162.20000000000002, 161.2999999999999, 113.59999999999985, 119.00000000000003, 120.20000000000003, 170.29999999999987, 130.39999999999986, 175.69999999999993, 152.89999999999984, 164.8999999999998, 127.99999999999966, 52.4, 20.000000000000014, 107.0, 189.0, 146.0, -33.0, 47.60000000000008, 162.19999999999993, 119.89999999999998, 196.4, 70.10000000000002, 121.0999999999998, 153.20000000000002, 131.0, 106.10000000000002, 103.69999999999982, 109.09999999999998, 156.79999999999998, 179.29999999999998, 173.5999999999999, 117.79999999999993, 182.0, 43.70000000000001, 187.1, 145.6999999999999, 92.6, 179.29999999999998, 47.6, 110.29999999999998, 106.09999999999994, -66.40000000000009, 126.49999999999997, -74.2000000000003, -19.0, 108.19999999999985, 75.19999999999999, 177.49999999999991, 180.19999999999987, -90.0, -206.0, 130.0, -48.0, 163.3999999999998, 116.30000000000007, 156.79999999999984, 127.99999999999986, -9.400000000000183, 68.89999999999996, -25.900000000000055, 103.10000000000011, 5.0000000000000036, -186.4, -2.799999999999983, 128.60000000000002, 136.39999999999995, 148.09999999999985, 155.29999999999984, 7.399999999999963, 135.19999999999985, 157.69999999999993, 127.99999999999999, 149.89999999999992, 163.0999999999998, 128.89999999999998, 176.5999999999999, 99.19999999999993, 142.39999999999998, 48.19999999999999, -134.80000000000018, 152.3, 129.8, 191.89999999999995, 110.00000000000004, 136.99999999999986, 124.09999999999994, 43.999999999999936, 77.90000000000002, -16.900000000000055, -79.6, 126.49999999999989, 158.59999999999985, -47.2000000000002, 116.0, 24.0, 120.0, 147.0, 108.19999999999985, -22.0, -243.70000000000005, -140.2000000000002, 159.49999999999983, 163.10000000000005, 101.89999999999995, 92.89999999999952, 124.39999999999995, 96.2, 155.89999999999986, 127.09999999999972, -107.50000000000014, -6.999999999999998, -40.29999999999993, 161.5999999999998, 137.89999999999992, 102.49999999999977, 146.29999999999987, -40.59999999999997, 118.40000000000006, 145.09999999999982, 140.59999999999977, 113.29999999999977, 176.59999999999997, 124.10000000000005, 104.30000000000004, 145.99999999999994, 178.39999999999986, 124.3999999999998, 123.79999999999988, -83.50000000000006, -67.30000000000034, 141.1999999999998, 79.09999999999977, -176.50000000000017, 150.49999999999986, 153.19999999999985, 15.0, 134.0, 139.0, 128.0, 138.0, -71.0, 46.1, 91.99999999999997, 116.59999999999998, 110.89999999999978, 95.89999999999995, 145.09999999999968], "policy_predator_policy_reward": [25.0, 18.0, 35.0, 44.0, 36.0, 8.0, 0.0, 64.0, 4.0, 62.0, 0.0, 12.0, 28.0, 56.0, 40.0, 2.0, 0.0, 6.0, 13.0, 0.0, 3.0, 17.0, 5.0, 0.0, 47.0, 47.0, 9.0, 0.0, 13.0, 0.0, 4.0, 28.0, 10.0, 13.0, 0.0, 0.0, 5.0, 43.0, 0.0, 0.0, 0.0, 0.0, 32.0, 0.0, 10.0, 9.0, 0.0, 12.0, 0.0, 0.0, 23.0, 12.0, 0.0, 25.0, 10.0, 13.0, 5.0, 9.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 48.0, 0.0, 0.0, 25.0, 22.0, 34.0, 0.0, 31.0, 5.0, 13.0, 31.0, 2.0, 6.0, 17.0, 16.0, 15.0, 0.0, 0.0, 4.0, 0.0, 7.0, 0.0, 1.0, 47.0, 17.0, 12.0, 43.0, 0.0, 13.0, 31.0, 83.0, 10.0, 89.0, 32.0, 37.0, 17.0, 0.0, 0.0, 83.0, 136.0, 30.0, 51.0, 4.0, 7.0, 0.0, 0.0, 57.0, 29.0, 55.0, 4.0, 101.0, 48.0, 51.0, 0.0, 0.0, 13.0, 54.0, 5.0, 5.0, 7.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 26.0, 11.0, 3.0, 102.0, 0.0, 0.0, 6.0, 6.0, 24.0, 1.0, 55.0, 9.0, 39.0, 57.0, 51.0, 54.0, 42.0, 0.0, 0.0, 11.0, 48.0, 40.0, 131.0, 147.0, 0.0, 0.0, 0.0, 6.0, 0.0, 31.0, 0.0, 0.0, 39.0, 98.0, 36.0, 41.0, 13.0, 0.0, 26.0, 47.0, 4.0, 14.0, 0.0, 13.0, 4.0, 0.0, 16.0, 9.0, 0.0, 0.0, 93.0, 20.0, 21.0, 46.0, 2.0, 135.0, 0.0, 0.0, 80.0, 0.0, 7.0, 12.0, 17.0, 68.0, 25.0, 19.0, 26.0, 4.0, 1.0, 31.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5625498155486992, "mean_inference_ms": 4.53700744590182, "mean_action_processing_ms": 0.8498972101669102, "mean_env_wait_ms": 0.5126631333932622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0077980756759643555, "StateBufferConnector_ms": 0.005279064178466797, "ViewRequirementAgentConnector_ms": 0.3038994073867798}, "num_episodes": 23, "episode_return_max": 357.70000000000005, "episode_return_min": -105.90000000000023, "episode_return_mean": 232.07099999999988, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 179.9059471924026, "num_env_steps_trained_throughput_per_sec": 179.9059471924026, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 19648.558, "restore_workers_time_ms": 0.016, "training_step_time_ms": 19648.505, "sample_time_ms": 3000.616, "learn_time_ms": 16612.836, "learn_throughput": 240.778, "synch_weights_time_ms": 30.455}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "training_iteration": 41, "trial_id": "e4caa_00000", "date": "2024-08-13_19-59-13", "timestamp": 1723593553, "time_this_iter_s": 22.309635162353516, "time_total_s": 889.7574551105499, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29098b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 889.7574551105499, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 86.88064516129033, "ram_util_percent": 82.89677419354838}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.213666993789572, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.8680631246516315, "policy_loss": -0.004921340102714206, "vf_loss": 7.871044382973323, "vf_explained_var": 0.018590011735441822, "kl": 0.012933605996474196, "entropy": 1.5020966366485313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5457851717238704, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3661233100941574, "policy_loss": -0.004956443205465952, "vf_loss": 3.37107450558395, "vf_explained_var": 0.185779016106217, "kl": 0.013444726256928035, "entropy": 0.3222871192469799, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 78435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "env_runners": {"episode_reward_max": 357.70000000000005, "episode_reward_min": -147.80000000000013, "episode_reward_mean": 220.44599999999988, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -267.70000000000016, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.4, "predator_policy": 180.0}, "policy_reward_mean": {"prey_policy": 86.56799999999994, "predator_policy": 23.655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [151.89999999999978, 340.6000000000002, 318.0999999999999, 228.0, 324.1999999999998, 294.10000000000014, 237.0999999999995, 310.49999999999983, 290.60000000000014, 297.90000000000055, 253.19999999999973, 310.7000000000003, 335.5999999999997, 292.90000000000083, 120.39999999999978, 321.0, 169.0, 240.7999999999997, 334.3, 224.19999999999968, 307.1999999999999, 240.79999999999976, 265.89999999999986, 356.9, 306.80000000000007, 278.80000000000007, 267.2999999999997, 269.8999999999999, 260.40000000000003, 153.10000000000002, 27.800000000000157, 237.39999999999975, 357.70000000000005, -77.0, 163.0, 290.69999999999965, 284.80000000000103, 145.49999999999983, 136.19999999999993, -32.40000000000001, 176.8, 297.5000000000001, 221.69999999999976, 304.90000000000055, 285.9000000000002, 292.0, 275.7999999999997, 227.60000000000002, 122.50000000000006, 321.7, 258.99999999999955, 193.09999999999928, 124.99999999999977, 142.89999999999992, 216.3999999999997, 182.0, 278.0, 174.1999999999998, -105.90000000000023, 322.60000000000025, 200.799999999999, 251.59999999999985, 282.99999999999966, 22.50000000000003, 198.29999999999964, 253.39999999999972, 178.69999999999976, 281.50000000000034, 266.90000000000003, 304.6999999999996, 275.29999999999984, 302.7999999999996, 153.29999999999995, 140.8999999999999, 39.60000000000002, 303.7000000000004, 229.0, 286.0, 152.0, 182.10000000000008, 257.4999999999997, 272.9999999999999, -0.09999999999996945, 281.1999999999997, 287.1999999999998, 236.09999999999968, 294.39999999999986, 252.99999999999963, -147.80000000000013, 149.7999999999996, -25.700000000000408, 240.19999999999993, 232.1999999999998, 78.10000000000005, 241.2999999999997, 267.09999999999985, 245.0, 250.0, 304.80000000000007, 71.59999999999981], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [71.30000000000004, 32.600000000000065, 179.29999999999995, 161.3, 164.89999999999986, 153.2, 121.69999999999997, 74.3, 133.09999999999997, 172.09999999999997, 137.89999999999986, 144.2, 87.50000000000004, 149.59999999999977, 180.19999999999996, 95.30000000000001, 103.39999999999992, 162.20000000000002, 161.2999999999999, 113.59999999999985, 119.00000000000003, 120.20000000000003, 170.29999999999987, 130.39999999999986, 175.69999999999993, 152.89999999999984, 164.8999999999998, 127.99999999999966, 52.4, 20.000000000000014, 107.0, 189.0, 146.0, -33.0, 47.60000000000008, 162.19999999999993, 119.89999999999998, 196.4, 70.10000000000002, 121.0999999999998, 153.20000000000002, 131.0, 106.10000000000002, 103.69999999999982, 109.09999999999998, 156.79999999999998, 179.29999999999998, 173.5999999999999, 117.79999999999993, 182.0, 43.70000000000001, 187.1, 145.6999999999999, 92.6, 179.29999999999998, 47.6, 110.29999999999998, 106.09999999999994, -66.40000000000009, 126.49999999999997, -74.2000000000003, -19.0, 108.19999999999985, 75.19999999999999, 177.49999999999991, 180.19999999999987, -90.0, -206.0, 130.0, -48.0, 163.3999999999998, 116.30000000000007, 156.79999999999984, 127.99999999999986, -9.400000000000183, 68.89999999999996, -25.900000000000055, 103.10000000000011, 5.0000000000000036, -186.4, -2.799999999999983, 128.60000000000002, 136.39999999999995, 148.09999999999985, 155.29999999999984, 7.399999999999963, 135.19999999999985, 157.69999999999993, 127.99999999999999, 149.89999999999992, 163.0999999999998, 128.89999999999998, 176.5999999999999, 99.19999999999993, 142.39999999999998, 48.19999999999999, -134.80000000000018, 152.3, 129.8, 191.89999999999995, 110.00000000000004, 136.99999999999986, 124.09999999999994, 43.999999999999936, 77.90000000000002, -16.900000000000055, -79.6, 126.49999999999989, 158.59999999999985, -47.2000000000002, 116.0, 24.0, 120.0, 147.0, 108.19999999999985, -22.0, -243.70000000000005, -140.2000000000002, 159.49999999999983, 163.10000000000005, 101.89999999999995, 92.89999999999952, 124.39999999999995, 96.2, 155.89999999999986, 127.09999999999972, -107.50000000000014, -6.999999999999998, -40.29999999999993, 161.5999999999998, 137.89999999999992, 102.49999999999977, 146.29999999999987, -40.59999999999997, 118.40000000000006, 145.09999999999982, 140.59999999999977, 113.29999999999977, 176.59999999999997, 124.10000000000005, 104.30000000000004, 145.99999999999994, 178.39999999999986, 124.3999999999998, 123.79999999999988, -83.50000000000006, -67.30000000000034, 141.1999999999998, 79.09999999999977, -176.50000000000017, 150.49999999999986, 153.19999999999985, 15.0, 134.0, 139.0, 128.0, 138.0, -71.0, 46.1, 91.99999999999997, 116.59999999999998, 110.89999999999978, 95.89999999999995, 145.09999999999968, -139.90000000000012, 9.800000000000008, 104.59999999999987, 176.5999999999999, 87.5, 166.69999999999987, 110.89999999999986, 99.2, 32.29999999999996, 187.1, 132.19999999999985, 93.79999999999988, -267.70000000000016, -60.10000000000002, 148.69999999999976, -79.89999999999998, -103.00000000000028, -21.699999999999953, 58.09999999999998, 154.10000000000002, 124.39999999999992, 78.79999999999993, 75.50000000000004, -90.40000000000003, 37.99999999999979, 161.2999999999999, 110.59999999999995, 129.49999999999991, 94.0, 110.0, 127.0, 109.0, 121.39999999999998, 157.39999999999995, -176.50000000000014, 16.099999999999966], "policy_predator_policy_reward": [5.0, 43.0, 0.0, 0.0, 0.0, 0.0, 32.0, 0.0, 10.0, 9.0, 0.0, 12.0, 0.0, 0.0, 23.0, 12.0, 0.0, 25.0, 10.0, 13.0, 5.0, 9.0, 0.0, 10.0, 7.0, 0.0, 0.0, 0.0, 48.0, 0.0, 0.0, 25.0, 22.0, 34.0, 0.0, 31.0, 5.0, 13.0, 31.0, 2.0, 6.0, 17.0, 16.0, 15.0, 0.0, 0.0, 4.0, 0.0, 7.0, 0.0, 1.0, 47.0, 17.0, 12.0, 43.0, 0.0, 13.0, 31.0, 83.0, 10.0, 89.0, 32.0, 37.0, 17.0, 0.0, 0.0, 83.0, 136.0, 30.0, 51.0, 4.0, 7.0, 0.0, 0.0, 57.0, 29.0, 55.0, 4.0, 101.0, 48.0, 51.0, 0.0, 0.0, 13.0, 54.0, 5.0, 5.0, 7.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 26.0, 11.0, 3.0, 102.0, 0.0, 0.0, 6.0, 6.0, 24.0, 1.0, 55.0, 9.0, 39.0, 57.0, 51.0, 54.0, 42.0, 0.0, 0.0, 11.0, 48.0, 40.0, 131.0, 147.0, 0.0, 0.0, 0.0, 6.0, 0.0, 31.0, 0.0, 0.0, 39.0, 98.0, 36.0, 41.0, 13.0, 0.0, 26.0, 47.0, 4.0, 14.0, 0.0, 13.0, 4.0, 0.0, 16.0, 9.0, 0.0, 0.0, 93.0, 20.0, 21.0, 46.0, 2.0, 135.0, 0.0, 0.0, 80.0, 0.0, 7.0, 12.0, 17.0, 68.0, 25.0, 19.0, 26.0, 4.0, 1.0, 31.0, 0.0, 130.0, 0.0, 0.0, 33.0, 0.0, 6.0, 20.0, 34.0, 41.0, 12.0, 15.0, 0.0, 180.0, 0.0, 81.0, 0.0, 99.0, 20.0, 8.0, 29.0, 0.0, 93.0, 0.0, 0.0, 42.0, 23.0, 4.0, 25.0, 16.0, 0.0, 14.0, 0.0, 26.0, 131.0, 101.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5657612206915195, "mean_inference_ms": 4.546901609603769, "mean_action_processing_ms": 0.8408297860615214, "mean_env_wait_ms": 0.5133228765794584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005333900451660156, "StateBufferConnector_ms": 0.009230256080627441, "ViewRequirementAgentConnector_ms": 0.3483070135116577}, "num_episodes": 18, "episode_return_max": 357.70000000000005, "episode_return_min": -147.80000000000013, "episode_return_mean": 220.44599999999988, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 198.95315959152433, "num_env_steps_trained_throughput_per_sec": 198.95315959152433, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 19676.188, "restore_workers_time_ms": 0.016, "training_step_time_ms": 19676.135, "sample_time_ms": 3056.209, "learn_time_ms": 16584.359, "learn_throughput": 241.191, "synch_weights_time_ms": 30.691}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "training_iteration": 42, "trial_id": "e4caa_00000", "date": "2024-08-13_19-59-33", "timestamp": 1723593573, "time_this_iter_s": 20.133177280426025, "time_total_s": 909.890632390976, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2863ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 909.890632390976, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 82.62068965517241, "ram_util_percent": 82.95862068965516}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7655402358877597, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 8.31303726832072, "policy_loss": -0.003576184323343335, "vf_loss": 8.315165605494585, "vf_explained_var": -0.013732871239778226, "kl": 0.009652220259699012, "entropy": 1.4929299980875046, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.582573615527027, "cur_kl_coeff": 0.000390625, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.616868963884929, "policy_loss": -0.003957304464549654, "vf_loss": 1.620824760419351, "vf_explained_var": 0.05890274889885433, "kl": 0.0038668838375874727, "entropy": 0.23835497533991223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 80325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "env_runners": {"episode_reward_max": 357.70000000000005, "episode_reward_min": -147.80000000000013, "episode_reward_mean": 210.76399999999984, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -267.70000000000016, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 196.4, "predator_policy": 180.0}, "policy_reward_mean": {"prey_policy": 79.55199999999994, "predator_policy": 25.83}, "custom_metrics": {}, "hist_stats": {"episode_reward": [334.3, 224.19999999999968, 307.1999999999999, 240.79999999999976, 265.89999999999986, 356.9, 306.80000000000007, 278.80000000000007, 267.2999999999997, 269.8999999999999, 260.40000000000003, 153.10000000000002, 27.800000000000157, 237.39999999999975, 357.70000000000005, -77.0, 163.0, 290.69999999999965, 284.80000000000103, 145.49999999999983, 136.19999999999993, -32.40000000000001, 176.8, 297.5000000000001, 221.69999999999976, 304.90000000000055, 285.9000000000002, 292.0, 275.7999999999997, 227.60000000000002, 122.50000000000006, 321.7, 258.99999999999955, 193.09999999999928, 124.99999999999977, 142.89999999999992, 216.3999999999997, 182.0, 278.0, 174.1999999999998, -105.90000000000023, 322.60000000000025, 200.799999999999, 251.59999999999985, 282.99999999999966, 22.50000000000003, 198.29999999999964, 253.39999999999972, 178.69999999999976, 281.50000000000034, 266.90000000000003, 304.6999999999996, 275.29999999999984, 302.7999999999996, 153.29999999999995, 140.8999999999999, 39.60000000000002, 303.7000000000004, 229.0, 286.0, 152.0, 182.10000000000008, 257.4999999999997, 272.9999999999999, -0.09999999999996945, 281.1999999999997, 287.1999999999998, 236.09999999999968, 294.39999999999986, 252.99999999999963, -147.80000000000013, 149.7999999999996, -25.700000000000408, 240.19999999999993, 232.1999999999998, 78.10000000000005, 241.2999999999997, 267.09999999999985, 245.0, 250.0, 304.80000000000007, 71.59999999999981, 293.20000000000005, -30.900000000000055, 194.1999999999997, 263.69999999999936, 130.39999999999998, 257.09999999999957, 266.79999999999944, 274.79999999999967, 311.8000000000003, 245.9999999999995, 219.19999999999973, 175.09999999999977, 249.89999999999966, 158.0999999999999, 201.0, 254.0, 200.89999999999958, 203.09999999999934], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [119.89999999999998, 196.4, 70.10000000000002, 121.0999999999998, 153.20000000000002, 131.0, 106.10000000000002, 103.69999999999982, 109.09999999999998, 156.79999999999998, 179.29999999999998, 173.5999999999999, 117.79999999999993, 182.0, 43.70000000000001, 187.1, 145.6999999999999, 92.6, 179.29999999999998, 47.6, 110.29999999999998, 106.09999999999994, -66.40000000000009, 126.49999999999997, -74.2000000000003, -19.0, 108.19999999999985, 75.19999999999999, 177.49999999999991, 180.19999999999987, -90.0, -206.0, 130.0, -48.0, 163.3999999999998, 116.30000000000007, 156.79999999999984, 127.99999999999986, -9.400000000000183, 68.89999999999996, -25.900000000000055, 103.10000000000011, 5.0000000000000036, -186.4, -2.799999999999983, 128.60000000000002, 136.39999999999995, 148.09999999999985, 155.29999999999984, 7.399999999999963, 135.19999999999985, 157.69999999999993, 127.99999999999999, 149.89999999999992, 163.0999999999998, 128.89999999999998, 176.5999999999999, 99.19999999999993, 142.39999999999998, 48.19999999999999, -134.80000000000018, 152.3, 129.8, 191.89999999999995, 110.00000000000004, 136.99999999999986, 124.09999999999994, 43.999999999999936, 77.90000000000002, -16.900000000000055, -79.6, 126.49999999999989, 158.59999999999985, -47.2000000000002, 116.0, 24.0, 120.0, 147.0, 108.19999999999985, -22.0, -243.70000000000005, -140.2000000000002, 159.49999999999983, 163.10000000000005, 101.89999999999995, 92.89999999999952, 124.39999999999995, 96.2, 155.89999999999986, 127.09999999999972, -107.50000000000014, -6.999999999999998, -40.29999999999993, 161.5999999999998, 137.89999999999992, 102.49999999999977, 146.29999999999987, -40.59999999999997, 118.40000000000006, 145.09999999999982, 140.59999999999977, 113.29999999999977, 176.59999999999997, 124.10000000000005, 104.30000000000004, 145.99999999999994, 178.39999999999986, 124.3999999999998, 123.79999999999988, -83.50000000000006, -67.30000000000034, 141.1999999999998, 79.09999999999977, -176.50000000000017, 150.49999999999986, 153.19999999999985, 15.0, 134.0, 139.0, 128.0, 138.0, -71.0, 46.1, 91.99999999999997, 116.59999999999998, 110.89999999999978, 95.89999999999995, 145.09999999999968, -139.90000000000012, 9.800000000000008, 104.59999999999987, 176.5999999999999, 87.5, 166.69999999999987, 110.89999999999986, 99.2, 32.29999999999996, 187.1, 132.19999999999985, 93.79999999999988, -267.70000000000016, -60.10000000000002, 148.69999999999976, -79.89999999999998, -103.00000000000028, -21.699999999999953, 58.09999999999998, 154.10000000000002, 124.39999999999992, 78.79999999999993, 75.50000000000004, -90.40000000000003, 37.99999999999979, 161.2999999999999, 110.59999999999995, 129.49999999999991, 94.0, 110.0, 127.0, 109.0, 121.39999999999998, 157.39999999999995, -176.50000000000014, 16.099999999999966, 170.2999999999998, 110.89999999999995, -235.2999999999999, 34.40000000000004, 53.000000000000064, 66.20000000000003, 112.99999999999982, 148.69999999999985, -79.30000000000004, 118.69999999999987, 139.69999999999985, 100.40000000000003, 112.69999999999993, 154.09999999999982, 145.99999999999991, 126.79999999999993, 172.09999999999982, 139.69999999999996, 88.69999999999999, 134.2999999999998, 57.80000000000003, 100.40000000000002, 65.60000000000005, 72.5, 58.70000000000008, 162.19999999999985, 18.499999999999957, 26.599999999999916, 130.0, -17.0, 102.0, 133.0, 6.799999999999871, 121.09999999999974, 122.2999999999997, 72.79999999999976], "policy_predator_policy_reward": [5.0, 13.0, 31.0, 2.0, 6.0, 17.0, 16.0, 15.0, 0.0, 0.0, 4.0, 0.0, 7.0, 0.0, 1.0, 47.0, 17.0, 12.0, 43.0, 0.0, 13.0, 31.0, 83.0, 10.0, 89.0, 32.0, 37.0, 17.0, 0.0, 0.0, 83.0, 136.0, 30.0, 51.0, 4.0, 7.0, 0.0, 0.0, 57.0, 29.0, 55.0, 4.0, 101.0, 48.0, 51.0, 0.0, 0.0, 13.0, 54.0, 5.0, 5.0, 7.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 26.0, 11.0, 3.0, 102.0, 0.0, 0.0, 6.0, 6.0, 24.0, 1.0, 55.0, 9.0, 39.0, 57.0, 51.0, 54.0, 42.0, 0.0, 0.0, 11.0, 48.0, 40.0, 131.0, 147.0, 0.0, 0.0, 0.0, 6.0, 0.0, 31.0, 0.0, 0.0, 39.0, 98.0, 36.0, 41.0, 13.0, 0.0, 26.0, 47.0, 4.0, 14.0, 0.0, 13.0, 4.0, 0.0, 16.0, 9.0, 0.0, 0.0, 93.0, 20.0, 21.0, 46.0, 2.0, 135.0, 0.0, 0.0, 80.0, 0.0, 7.0, 12.0, 17.0, 68.0, 25.0, 19.0, 26.0, 4.0, 1.0, 31.0, 0.0, 130.0, 0.0, 0.0, 33.0, 0.0, 6.0, 20.0, 34.0, 41.0, 12.0, 15.0, 0.0, 180.0, 0.0, 81.0, 0.0, 99.0, 20.0, 8.0, 29.0, 0.0, 93.0, 0.0, 0.0, 42.0, 23.0, 4.0, 25.0, 16.0, 0.0, 14.0, 0.0, 26.0, 131.0, 101.0, 12.0, 0.0, 33.0, 137.0, 25.0, 50.0, 0.0, 2.0, 91.0, 0.0, 11.0, 6.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 14.0, 39.0, 22.0, 30.0, 7.0, 2.0, 27.0, 46.0, 67.0, 41.0, 47.0, 2.0, 17.0, 40.0, 33.0, 8.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5665436574327753, "mean_inference_ms": 4.552998175027279, "mean_action_processing_ms": 0.8374454934100427, "mean_env_wait_ms": 0.5149765850490515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005358576774597168, "StateBufferConnector_ms": 0.009276509284973145, "ViewRequirementAgentConnector_ms": 0.3218405246734619}, "num_episodes": 18, "episode_return_max": 357.70000000000005, "episode_return_min": -147.80000000000013, "episode_return_mean": 210.76399999999984, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 188.7428919984259, "num_env_steps_trained_throughput_per_sec": 188.7428919984259, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 20008.328, "restore_workers_time_ms": 0.016, "training_step_time_ms": 20008.274, "sample_time_ms": 3013.454, "learn_time_ms": 16958.552, "learn_throughput": 235.869, "synch_weights_time_ms": 31.34}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "training_iteration": 43, "trial_id": "e4caa_00000", "date": "2024-08-13_19-59-55", "timestamp": 1723593595, "time_this_iter_s": 21.26837134361267, "time_total_s": 931.1590037345886, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b282f940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 931.1590037345886, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 81.70000000000003, "ram_util_percent": 83.54333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.280778511239108, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.530707670898034, "policy_loss": -0.005501191321484468, "vf_loss": 7.534708021052931, "vf_explained_var": 0.046808346396400816, "kl": 0.010005547506649184, "entropy": 1.4881105782493713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4642362733366627, "cur_kl_coeff": 0.0001953125, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2024638748358167, "policy_loss": -0.005699735708416454, "vf_loss": 1.2081629559634224, "vf_explained_var": 0.06810340370450702, "kl": 0.003360741833724535, "entropy": 0.21461821788202518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 82215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "env_runners": {"episode_reward_max": 353.70000000000005, "episode_reward_min": -147.80000000000013, "episode_reward_mean": 216.14099999999988, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -267.70000000000016, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 191.89999999999995, "predator_policy": 180.0}, "policy_reward_mean": {"prey_policy": 83.60049999999993, "predator_policy": 24.47}, "custom_metrics": {}, "hist_stats": {"episode_reward": [284.80000000000103, 145.49999999999983, 136.19999999999993, -32.40000000000001, 176.8, 297.5000000000001, 221.69999999999976, 304.90000000000055, 285.9000000000002, 292.0, 275.7999999999997, 227.60000000000002, 122.50000000000006, 321.7, 258.99999999999955, 193.09999999999928, 124.99999999999977, 142.89999999999992, 216.3999999999997, 182.0, 278.0, 174.1999999999998, -105.90000000000023, 322.60000000000025, 200.799999999999, 251.59999999999985, 282.99999999999966, 22.50000000000003, 198.29999999999964, 253.39999999999972, 178.69999999999976, 281.50000000000034, 266.90000000000003, 304.6999999999996, 275.29999999999984, 302.7999999999996, 153.29999999999995, 140.8999999999999, 39.60000000000002, 303.7000000000004, 229.0, 286.0, 152.0, 182.10000000000008, 257.4999999999997, 272.9999999999999, -0.09999999999996945, 281.1999999999997, 287.1999999999998, 236.09999999999968, 294.39999999999986, 252.99999999999963, -147.80000000000013, 149.7999999999996, -25.700000000000408, 240.19999999999993, 232.1999999999998, 78.10000000000005, 241.2999999999997, 267.09999999999985, 245.0, 250.0, 304.80000000000007, 71.59999999999981, 293.20000000000005, -30.900000000000055, 194.1999999999997, 263.69999999999936, 130.39999999999998, 257.09999999999957, 266.79999999999944, 274.79999999999967, 311.8000000000003, 245.9999999999995, 219.19999999999973, 175.09999999999977, 249.89999999999966, 158.0999999999999, 201.0, 254.0, 200.89999999999958, 203.09999999999934, 298.69999999999965, 298.4, 296.50000000000045, 310.2000000000002, 287.49999999999955, 340.60000000000025, 180.99999999999983, 353.70000000000005, 255.79999999999964, 318.2999999999998, 230.89999999999972, 287.8000000000003, 296.49999999999966, 271.5000000000001, 150.0, 232.0, 105.79999999999995, 287.69999999999993], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [156.79999999999984, 127.99999999999986, -9.400000000000183, 68.89999999999996, -25.900000000000055, 103.10000000000011, 5.0000000000000036, -186.4, -2.799999999999983, 128.60000000000002, 136.39999999999995, 148.09999999999985, 155.29999999999984, 7.399999999999963, 135.19999999999985, 157.69999999999993, 127.99999999999999, 149.89999999999992, 163.0999999999998, 128.89999999999998, 176.5999999999999, 99.19999999999993, 142.39999999999998, 48.19999999999999, -134.80000000000018, 152.3, 129.8, 191.89999999999995, 110.00000000000004, 136.99999999999986, 124.09999999999994, 43.999999999999936, 77.90000000000002, -16.900000000000055, -79.6, 126.49999999999989, 158.59999999999985, -47.2000000000002, 116.0, 24.0, 120.0, 147.0, 108.19999999999985, -22.0, -243.70000000000005, -140.2000000000002, 159.49999999999983, 163.10000000000005, 101.89999999999995, 92.89999999999952, 124.39999999999995, 96.2, 155.89999999999986, 127.09999999999972, -107.50000000000014, -6.999999999999998, -40.29999999999993, 161.5999999999998, 137.89999999999992, 102.49999999999977, 146.29999999999987, -40.59999999999997, 118.40000000000006, 145.09999999999982, 140.59999999999977, 113.29999999999977, 176.59999999999997, 124.10000000000005, 104.30000000000004, 145.99999999999994, 178.39999999999986, 124.3999999999998, 123.79999999999988, -83.50000000000006, -67.30000000000034, 141.1999999999998, 79.09999999999977, -176.50000000000017, 150.49999999999986, 153.19999999999985, 15.0, 134.0, 139.0, 128.0, 138.0, -71.0, 46.1, 91.99999999999997, 116.59999999999998, 110.89999999999978, 95.89999999999995, 145.09999999999968, -139.90000000000012, 9.800000000000008, 104.59999999999987, 176.5999999999999, 87.5, 166.69999999999987, 110.89999999999986, 99.2, 32.29999999999996, 187.1, 132.19999999999985, 93.79999999999988, -267.70000000000016, -60.10000000000002, 148.69999999999976, -79.89999999999998, -103.00000000000028, -21.699999999999953, 58.09999999999998, 154.10000000000002, 124.39999999999992, 78.79999999999993, 75.50000000000004, -90.40000000000003, 37.99999999999979, 161.2999999999999, 110.59999999999995, 129.49999999999991, 94.0, 110.0, 127.0, 109.0, 121.39999999999998, 157.39999999999995, -176.50000000000014, 16.099999999999966, 170.2999999999998, 110.89999999999995, -235.2999999999999, 34.40000000000004, 53.000000000000064, 66.20000000000003, 112.99999999999982, 148.69999999999985, -79.30000000000004, 118.69999999999987, 139.69999999999985, 100.40000000000003, 112.69999999999993, 154.09999999999982, 145.99999999999991, 126.79999999999993, 172.09999999999982, 139.69999999999996, 88.69999999999999, 134.2999999999998, 57.80000000000003, 100.40000000000002, 65.60000000000005, 72.5, 58.70000000000008, 162.19999999999985, 18.499999999999957, 26.599999999999916, 130.0, -17.0, 102.0, 133.0, 6.799999999999871, 121.09999999999974, 122.2999999999997, 72.79999999999976, 153.49999999999983, 138.19999999999996, 91.09999999999997, 161.2999999999998, 154.09999999999985, 133.39999999999986, 137.29999999999993, 164.8999999999999, 141.79999999999976, 136.69999999999976, 182.9, 157.69999999999982, 124.39999999999993, -36.400000000000105, 170.2999999999999, 181.39999999999998, 169.39999999999995, 85.40000000000005, 95.00000000000003, 188.29999999999995, 136.99999999999997, 53.900000000000034, 152.29999999999987, 132.4999999999999, 163.99999999999994, 132.49999999999997, 129.79999999999995, 133.69999999999993, -142.0, 168.0, 148.0, 14.0, -30.400000000000098, 21.20000000000006, 165.19999999999987, 105.5], "policy_predator_policy_reward": [0.0, 0.0, 57.0, 29.0, 55.0, 4.0, 101.0, 48.0, 51.0, 0.0, 0.0, 13.0, 54.0, 5.0, 5.0, 7.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 26.0, 11.0, 3.0, 102.0, 0.0, 0.0, 6.0, 6.0, 24.0, 1.0, 55.0, 9.0, 39.0, 57.0, 51.0, 54.0, 42.0, 0.0, 0.0, 11.0, 48.0, 40.0, 131.0, 147.0, 0.0, 0.0, 0.0, 6.0, 0.0, 31.0, 0.0, 0.0, 39.0, 98.0, 36.0, 41.0, 13.0, 0.0, 26.0, 47.0, 4.0, 14.0, 0.0, 13.0, 4.0, 0.0, 16.0, 9.0, 0.0, 0.0, 93.0, 20.0, 21.0, 46.0, 2.0, 135.0, 0.0, 0.0, 80.0, 0.0, 7.0, 12.0, 17.0, 68.0, 25.0, 19.0, 26.0, 4.0, 1.0, 31.0, 0.0, 130.0, 0.0, 0.0, 33.0, 0.0, 6.0, 20.0, 34.0, 41.0, 12.0, 15.0, 0.0, 180.0, 0.0, 81.0, 0.0, 99.0, 20.0, 8.0, 29.0, 0.0, 93.0, 0.0, 0.0, 42.0, 23.0, 4.0, 25.0, 16.0, 0.0, 14.0, 0.0, 26.0, 131.0, 101.0, 12.0, 0.0, 33.0, 137.0, 25.0, 50.0, 0.0, 2.0, 91.0, 0.0, 11.0, 6.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 14.0, 39.0, 22.0, 30.0, 7.0, 2.0, 27.0, 46.0, 67.0, 41.0, 47.0, 2.0, 17.0, 40.0, 33.0, 8.0, 0.0, 2.0, 5.0, 32.0, 14.0, 9.0, 0.0, 0.0, 8.0, 5.0, 4.0, 0.0, 0.0, 68.0, 25.0, 0.0, 2.0, 0.0, 1.0, 19.0, 16.0, 40.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 8.0, 24.0, 100.0, 31.0, 39.0, 59.0, 56.0, 17.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5724059976350402, "mean_inference_ms": 4.57238122197819, "mean_action_processing_ms": 0.8356957572832934, "mean_env_wait_ms": 0.5179246512122855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004781842231750488, "StateBufferConnector_ms": 0.010834217071533203, "ViewRequirementAgentConnector_ms": 0.3632698059082031}, "num_episodes": 18, "episode_return_max": 353.70000000000005, "episode_return_min": -147.80000000000013, "episode_return_mean": 216.14099999999988, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 132.1684102753995, "num_env_steps_trained_throughput_per_sec": 132.1684102753995, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 21232.78, "restore_workers_time_ms": 0.016, "training_step_time_ms": 21232.726, "sample_time_ms": 3389.149, "learn_time_ms": 17807.887, "learn_throughput": 224.62, "synch_weights_time_ms": 30.829}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "training_iteration": 44, "trial_id": "e4caa_00000", "date": "2024-08-13_20-00-25", "timestamp": 1723593625, "time_this_iter_s": 30.350166082382202, "time_total_s": 961.5091698169708, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29099d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 961.5091698169708, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 93.50697674418605, "ram_util_percent": 83.9139534883721}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.62425298659259, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.66697408358256, "policy_loss": -0.003767530685512438, "vf_loss": 6.66952890063089, "vf_explained_var": 0.06939745157484024, "kl": 0.008084674063571313, "entropy": 1.491824881109611, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6476575338808948, "cur_kl_coeff": 9.765625e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2718152687032387, "policy_loss": -0.005414422922003915, "vf_loss": 1.2772293261750034, "vf_explained_var": 0.034438797405787876, "kl": 0.003771800427554409, "entropy": 0.1956660627372681, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 84105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 376.4000000000002, "episode_reward_min": -147.80000000000013, "episode_reward_mean": 230.24399999999986, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -267.70000000000016, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.2, "predator_policy": 180.0}, "policy_reward_mean": {"prey_policy": 92.33699999999993, "predator_policy": 22.785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-105.90000000000023, 322.60000000000025, 200.799999999999, 251.59999999999985, 282.99999999999966, 22.50000000000003, 198.29999999999964, 253.39999999999972, 178.69999999999976, 281.50000000000034, 266.90000000000003, 304.6999999999996, 275.29999999999984, 302.7999999999996, 153.29999999999995, 140.8999999999999, 39.60000000000002, 303.7000000000004, 229.0, 286.0, 152.0, 182.10000000000008, 257.4999999999997, 272.9999999999999, -0.09999999999996945, 281.1999999999997, 287.1999999999998, 236.09999999999968, 294.39999999999986, 252.99999999999963, -147.80000000000013, 149.7999999999996, -25.700000000000408, 240.19999999999993, 232.1999999999998, 78.10000000000005, 241.2999999999997, 267.09999999999985, 245.0, 250.0, 304.80000000000007, 71.59999999999981, 293.20000000000005, -30.900000000000055, 194.1999999999997, 263.69999999999936, 130.39999999999998, 257.09999999999957, 266.79999999999944, 274.79999999999967, 311.8000000000003, 245.9999999999995, 219.19999999999973, 175.09999999999977, 249.89999999999966, 158.0999999999999, 201.0, 254.0, 200.89999999999958, 203.09999999999934, 298.69999999999965, 298.4, 296.50000000000045, 310.2000000000002, 287.49999999999955, 340.60000000000025, 180.99999999999983, 353.70000000000005, 255.79999999999964, 318.2999999999998, 230.89999999999972, 287.8000000000003, 296.49999999999966, 271.5000000000001, 150.0, 232.0, 105.79999999999995, 287.69999999999993, 300.69999999999993, 202.69999999999996, 324.4000000000001, 215.3999999999999, 311.4000000000002, 285.0999999999998, 240.49999999999957, 317.79999999999995, 280.70000000000005, 331.60000000000065, 228.0999999999999, 281.30000000000007, 171.19999999999982, 312.29999999999995, 316.3000000000002, 307.2999999999999, 204.19999999999953, 376.4000000000002, 84.0, 307.0, 282.0999999999999, 360.9000000000001], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-243.70000000000005, -140.2000000000002, 159.49999999999983, 163.10000000000005, 101.89999999999995, 92.89999999999952, 124.39999999999995, 96.2, 155.89999999999986, 127.09999999999972, -107.50000000000014, -6.999999999999998, -40.29999999999993, 161.5999999999998, 137.89999999999992, 102.49999999999977, 146.29999999999987, -40.59999999999997, 118.40000000000006, 145.09999999999982, 140.59999999999977, 113.29999999999977, 176.59999999999997, 124.10000000000005, 104.30000000000004, 145.99999999999994, 178.39999999999986, 124.3999999999998, 123.79999999999988, -83.50000000000006, -67.30000000000034, 141.1999999999998, 79.09999999999977, -176.50000000000017, 150.49999999999986, 153.19999999999985, 15.0, 134.0, 139.0, 128.0, 138.0, -71.0, 46.1, 91.99999999999997, 116.59999999999998, 110.89999999999978, 95.89999999999995, 145.09999999999968, -139.90000000000012, 9.800000000000008, 104.59999999999987, 176.5999999999999, 87.5, 166.69999999999987, 110.89999999999986, 99.2, 32.29999999999996, 187.1, 132.19999999999985, 93.79999999999988, -267.70000000000016, -60.10000000000002, 148.69999999999976, -79.89999999999998, -103.00000000000028, -21.699999999999953, 58.09999999999998, 154.10000000000002, 124.39999999999992, 78.79999999999993, 75.50000000000004, -90.40000000000003, 37.99999999999979, 161.2999999999999, 110.59999999999995, 129.49999999999991, 94.0, 110.0, 127.0, 109.0, 121.39999999999998, 157.39999999999995, -176.50000000000014, 16.099999999999966, 170.2999999999998, 110.89999999999995, -235.2999999999999, 34.40000000000004, 53.000000000000064, 66.20000000000003, 112.99999999999982, 148.69999999999985, -79.30000000000004, 118.69999999999987, 139.69999999999985, 100.40000000000003, 112.69999999999993, 154.09999999999982, 145.99999999999991, 126.79999999999993, 172.09999999999982, 139.69999999999996, 88.69999999999999, 134.2999999999998, 57.80000000000003, 100.40000000000002, 65.60000000000005, 72.5, 58.70000000000008, 162.19999999999985, 18.499999999999957, 26.599999999999916, 130.0, -17.0, 102.0, 133.0, 6.799999999999871, 121.09999999999974, 122.2999999999997, 72.79999999999976, 153.49999999999983, 138.19999999999996, 91.09999999999997, 161.2999999999998, 154.09999999999985, 133.39999999999986, 137.29999999999993, 164.8999999999999, 141.79999999999976, 136.69999999999976, 182.9, 157.69999999999982, 124.39999999999993, -36.400000000000105, 170.2999999999999, 181.39999999999998, 169.39999999999995, 85.40000000000005, 95.00000000000003, 188.29999999999995, 136.99999999999997, 53.900000000000034, 152.29999999999987, 132.4999999999999, 163.99999999999994, 132.49999999999997, 129.79999999999995, 133.69999999999993, -142.0, 168.0, 148.0, 14.0, -30.400000000000098, 21.20000000000006, 165.19999999999987, 105.5, 99.79999999999993, 179.89999999999998, 81.20000000000002, 57.500000000000036, 176.6, 147.79999999999984, 53.00000000000002, 112.39999999999992, 133.69999999999993, 166.69999999999996, 155.89999999999984, 81.20000000000002, 125.59999999999982, 47.90000000000001, 122.59999999999998, 180.2, 128.89999999999995, 144.79999999999987, 159.49999999999977, 172.09999999999985, 97.70000000000003, 34.40000000000004, 114.19999999999999, 157.0999999999999, 70.4, 42.800000000000026, 133.99999999999997, 152.2999999999999, 150.4999999999997, 165.7999999999998, 95.00000000000003, 179.2999999999999, 8.000000000000012, 144.1999999999997, 198.2, 177.1999999999999, 43.0, -74.0, 156.0, 151.0, 146.0, 127.1, 175.99999999999991, 182.89999999999992], "policy_predator_policy_reward": [131.0, 147.0, 0.0, 0.0, 0.0, 6.0, 0.0, 31.0, 0.0, 0.0, 39.0, 98.0, 36.0, 41.0, 13.0, 0.0, 26.0, 47.0, 4.0, 14.0, 0.0, 13.0, 4.0, 0.0, 16.0, 9.0, 0.0, 0.0, 93.0, 20.0, 21.0, 46.0, 2.0, 135.0, 0.0, 0.0, 80.0, 0.0, 7.0, 12.0, 17.0, 68.0, 25.0, 19.0, 26.0, 4.0, 1.0, 31.0, 0.0, 130.0, 0.0, 0.0, 33.0, 0.0, 6.0, 20.0, 34.0, 41.0, 12.0, 15.0, 0.0, 180.0, 0.0, 81.0, 0.0, 99.0, 20.0, 8.0, 29.0, 0.0, 93.0, 0.0, 0.0, 42.0, 23.0, 4.0, 25.0, 16.0, 0.0, 14.0, 0.0, 26.0, 131.0, 101.0, 12.0, 0.0, 33.0, 137.0, 25.0, 50.0, 0.0, 2.0, 91.0, 0.0, 11.0, 6.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 14.0, 39.0, 22.0, 30.0, 7.0, 2.0, 27.0, 46.0, 67.0, 41.0, 47.0, 2.0, 17.0, 40.0, 33.0, 8.0, 0.0, 2.0, 5.0, 32.0, 14.0, 9.0, 0.0, 0.0, 8.0, 5.0, 4.0, 0.0, 0.0, 68.0, 25.0, 0.0, 2.0, 0.0, 1.0, 19.0, 16.0, 40.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 8.0, 24.0, 100.0, 31.0, 39.0, 59.0, 56.0, 17.0, 0.0, 1.0, 20.0, 32.0, 32.0, 0.0, 0.0, 7.0, 43.0, 0.0, 11.0, 15.0, 33.0, 47.0, 20.0, 0.0, 15.0, 0.0, 7.0, 0.0, 0.0, 54.0, 42.0, 10.0, 0.0, 58.0, 0.0, 7.0, 19.0, 0.0, 0.0, 24.0, 9.0, 52.0, 0.0, 1.0, 0.0, 30.0, 85.0, 0.0, 0.0, 2.0, 7.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5753523688569535, "mean_inference_ms": 4.581229267914292, "mean_action_processing_ms": 0.8321371196529163, "mean_env_wait_ms": 0.5190905506280312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004885077476501465, "StateBufferConnector_ms": 0.01397550106048584, "ViewRequirementAgentConnector_ms": 0.361430287361145}, "num_episodes": 22, "episode_return_max": 376.4000000000002, "episode_return_min": -147.80000000000013, "episode_return_mean": 230.24399999999986, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 107.75828118987067, "num_env_steps_trained_throughput_per_sec": 107.75828118987067, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 22812.848, "restore_workers_time_ms": 0.017, "training_step_time_ms": 22812.793, "sample_time_ms": 3439.67, "learn_time_ms": 19323.658, "learn_throughput": 207.0, "synch_weights_time_ms": 44.379}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 45, "trial_id": "e4caa_00000", "date": "2024-08-13_20-01-02", "timestamp": 1723593662, "time_this_iter_s": 37.22383904457092, "time_total_s": 998.7330088615417, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b0384b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 998.7330088615417, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 96.58431372549018, "ram_util_percent": 84.06078431372552}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.129084609330646, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.815005070822579, "policy_loss": -6.548140035380446e-05, "vf_loss": 5.812219084381426, "vf_explained_var": 0.10360471909008329, "kl": 0.019009878406064787, "entropy": 1.5258252837039805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9626438926530894, "cur_kl_coeff": 4.8828125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.205673245052812, "policy_loss": -0.0049556974888281535, "vf_loss": 1.2106287607124873, "vf_explained_var": 0.042138160126549855, "kl": 0.0037236680146814235, "entropy": 0.26623338984433936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 85995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "env_runners": {"episode_reward_max": 378.40000000000015, "episode_reward_min": -147.80000000000013, "episode_reward_mean": 257.9729999999999, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -267.70000000000016, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 180.0}, "policy_reward_mean": {"prey_policy": 110.07149999999994, "predator_policy": 18.915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [272.9999999999999, -0.09999999999996945, 281.1999999999997, 287.1999999999998, 236.09999999999968, 294.39999999999986, 252.99999999999963, -147.80000000000013, 149.7999999999996, -25.700000000000408, 240.19999999999993, 232.1999999999998, 78.10000000000005, 241.2999999999997, 267.09999999999985, 245.0, 250.0, 304.80000000000007, 71.59999999999981, 293.20000000000005, -30.900000000000055, 194.1999999999997, 263.69999999999936, 130.39999999999998, 257.09999999999957, 266.79999999999944, 274.79999999999967, 311.8000000000003, 245.9999999999995, 219.19999999999973, 175.09999999999977, 249.89999999999966, 158.0999999999999, 201.0, 254.0, 200.89999999999958, 203.09999999999934, 298.69999999999965, 298.4, 296.50000000000045, 310.2000000000002, 287.49999999999955, 340.60000000000025, 180.99999999999983, 353.70000000000005, 255.79999999999964, 318.2999999999998, 230.89999999999972, 287.8000000000003, 296.49999999999966, 271.5000000000001, 150.0, 232.0, 105.79999999999995, 287.69999999999993, 300.69999999999993, 202.69999999999996, 324.4000000000001, 215.3999999999999, 311.4000000000002, 285.0999999999998, 240.49999999999957, 317.79999999999995, 280.70000000000005, 331.60000000000065, 228.0999999999999, 281.30000000000007, 171.19999999999982, 312.29999999999995, 316.3000000000002, 307.2999999999999, 204.19999999999953, 376.4000000000002, 84.0, 307.0, 282.0999999999999, 360.9000000000001, 344.2000000000003, 339.9999999999999, 325.5, 340.70000000000016, 345.10000000000025, 275.09999999999997, 363.4000000000003, 298.9999999999999, 230.4999999999999, 321.9000000000002, 333.79999999999995, 300.19999999999993, 347.70000000000005, 318.60000000000025, 355.50000000000006, 378.40000000000015, 318.60000000000014, 320.0, 343.0, 326.0, 338.99999999999983, 320.29999999999995, 366.7000000000003], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [95.89999999999995, 145.09999999999968, -139.90000000000012, 9.800000000000008, 104.59999999999987, 176.5999999999999, 87.5, 166.69999999999987, 110.89999999999986, 99.2, 32.29999999999996, 187.1, 132.19999999999985, 93.79999999999988, -267.70000000000016, -60.10000000000002, 148.69999999999976, -79.89999999999998, -103.00000000000028, -21.699999999999953, 58.09999999999998, 154.10000000000002, 124.39999999999992, 78.79999999999993, 75.50000000000004, -90.40000000000003, 37.99999999999979, 161.2999999999999, 110.59999999999995, 129.49999999999991, 94.0, 110.0, 127.0, 109.0, 121.39999999999998, 157.39999999999995, -176.50000000000014, 16.099999999999966, 170.2999999999998, 110.89999999999995, -235.2999999999999, 34.40000000000004, 53.000000000000064, 66.20000000000003, 112.99999999999982, 148.69999999999985, -79.30000000000004, 118.69999999999987, 139.69999999999985, 100.40000000000003, 112.69999999999993, 154.09999999999982, 145.99999999999991, 126.79999999999993, 172.09999999999982, 139.69999999999996, 88.69999999999999, 134.2999999999998, 57.80000000000003, 100.40000000000002, 65.60000000000005, 72.5, 58.70000000000008, 162.19999999999985, 18.499999999999957, 26.599999999999916, 130.0, -17.0, 102.0, 133.0, 6.799999999999871, 121.09999999999974, 122.2999999999997, 72.79999999999976, 153.49999999999983, 138.19999999999996, 91.09999999999997, 161.2999999999998, 154.09999999999985, 133.39999999999986, 137.29999999999993, 164.8999999999999, 141.79999999999976, 136.69999999999976, 182.9, 157.69999999999982, 124.39999999999993, -36.400000000000105, 170.2999999999999, 181.39999999999998, 169.39999999999995, 85.40000000000005, 95.00000000000003, 188.29999999999995, 136.99999999999997, 53.900000000000034, 152.29999999999987, 132.4999999999999, 163.99999999999994, 132.49999999999997, 129.79999999999995, 133.69999999999993, -142.0, 168.0, 148.0, 14.0, -30.400000000000098, 21.20000000000006, 165.19999999999987, 105.5, 99.79999999999993, 179.89999999999998, 81.20000000000002, 57.500000000000036, 176.6, 147.79999999999984, 53.00000000000002, 112.39999999999992, 133.69999999999993, 166.69999999999996, 155.89999999999984, 81.20000000000002, 125.59999999999982, 47.90000000000001, 122.59999999999998, 180.2, 128.89999999999995, 144.79999999999987, 159.49999999999977, 172.09999999999985, 97.70000000000003, 34.40000000000004, 114.19999999999999, 157.0999999999999, 70.4, 42.800000000000026, 133.99999999999997, 152.2999999999999, 150.4999999999997, 165.7999999999998, 95.00000000000003, 179.2999999999999, 8.000000000000012, 144.1999999999997, 198.2, 177.1999999999999, 43.0, -74.0, 156.0, 151.0, 146.0, 127.1, 175.99999999999991, 182.89999999999992, 166.69999999999993, 177.49999999999991, 165.49999999999997, 162.49999999999994, 166.69999999999993, 150.79999999999995, 175.69999999999996, 160.99999999999994, 176.59999999999994, 168.5, 131.89999999999998, 81.2, 183.79999999999995, 176.5999999999999, 144.20000000000005, 123.80000000000001, 185.59999999999994, -24.10000000000003, 126.49999999999994, 148.3999999999999, 158.5999999999999, 168.2, 131.59999999999985, 158.59999999999997, 97.4, 197.29999999999998, 148.6999999999999, 158.9, 135.5, 200.0, 181.09999999999997, 197.3, 176.59999999999997, 113.0, 171.0, 135.0, 143.0, 188.0, 168.0, 158.0, 134.90000000000003, 187.09999999999997, 191.89999999999998, 61.4, 178.39999999999992, 188.29999999999998], "policy_predator_policy_reward": [1.0, 31.0, 0.0, 130.0, 0.0, 0.0, 33.0, 0.0, 6.0, 20.0, 34.0, 41.0, 12.0, 15.0, 0.0, 180.0, 0.0, 81.0, 0.0, 99.0, 20.0, 8.0, 29.0, 0.0, 93.0, 0.0, 0.0, 42.0, 23.0, 4.0, 25.0, 16.0, 0.0, 14.0, 0.0, 26.0, 131.0, 101.0, 12.0, 0.0, 33.0, 137.0, 25.0, 50.0, 0.0, 2.0, 91.0, 0.0, 11.0, 6.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 14.0, 39.0, 22.0, 30.0, 7.0, 2.0, 27.0, 46.0, 67.0, 41.0, 47.0, 2.0, 17.0, 40.0, 33.0, 8.0, 0.0, 2.0, 5.0, 32.0, 14.0, 9.0, 0.0, 0.0, 8.0, 5.0, 4.0, 0.0, 0.0, 68.0, 25.0, 0.0, 2.0, 0.0, 1.0, 19.0, 16.0, 40.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 8.0, 24.0, 100.0, 31.0, 39.0, 59.0, 56.0, 17.0, 0.0, 1.0, 20.0, 32.0, 32.0, 0.0, 0.0, 7.0, 43.0, 0.0, 11.0, 15.0, 33.0, 47.0, 20.0, 0.0, 15.0, 0.0, 7.0, 0.0, 0.0, 54.0, 42.0, 10.0, 0.0, 58.0, 0.0, 7.0, 19.0, 0.0, 0.0, 24.0, 9.0, 52.0, 0.0, 1.0, 0.0, 30.0, 85.0, 0.0, 0.0, 2.0, 7.0, 2.0, 0.0, 0.0, 0.0, 12.0, 0.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 24.0, 38.0, 3.0, 0.0, 13.0, 18.0, 69.0, 0.0, 26.0, 21.0, 6.0, 1.0, 1.0, 9.0, 31.0, 22.0, 11.0, 0.0, 15.0, 5.0, 0.0, 0.0, 29.0, 0.0, 0.0, 14.0, 12.0, 0.0, 0.0, 0.0, 0.0, 17.0, 34.0, 33.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.586034720072467, "mean_inference_ms": 4.607402732709378, "mean_action_processing_ms": 0.8296212269904525, "mean_env_wait_ms": 0.5236628841695044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013715863227844238, "StateBufferConnector_ms": 0.014144062995910645, "ViewRequirementAgentConnector_ms": 0.3410691022872925}, "num_episodes": 23, "episode_return_max": 378.40000000000015, "episode_return_min": -147.80000000000013, "episode_return_mean": 257.9729999999999, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 144.26845539935394, "num_env_steps_trained_throughput_per_sec": 144.26845539935394, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 736000, "timers": {"training_iteration_time_ms": 23783.764, "restore_workers_time_ms": 0.017, "training_step_time_ms": 23783.708, "sample_time_ms": 3886.968, "learn_time_ms": 19845.732, "learn_throughput": 201.555, "synch_weights_time_ms": 45.096}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 736000, "num_agent_steps_trained": 736000}, "done": false, "training_iteration": 46, "trial_id": "e4caa_00000", "date": "2024-08-13_20-01-30", "timestamp": 1723593690, "time_this_iter_s": 27.967012882232666, "time_total_s": 1026.7000217437744, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b282f1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1026.7000217437744, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 90.05641025641026, "ram_util_percent": 84.18974358974359}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3480875749752004, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.713098402376528, "policy_loss": -0.003791122448201927, "vf_loss": 6.7144822090391125, "vf_explained_var": 0.007016023756965758, "kl": 0.016048798574375103, "entropy": 1.4939548870243093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5763929276396988, "cur_kl_coeff": 2.44140625e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7975863701452024, "policy_loss": -0.0033040123646733937, "vf_loss": 2.8008903627042416, "vf_explained_var": 0.018737223255571235, "kl": 0.0030735536373966686, "entropy": 0.19189382512418052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 87885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "env_runners": {"episode_reward_max": 378.40000000000015, "episode_reward_min": -30.900000000000055, "episode_reward_mean": 270.86699999999996, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -235.2999999999999, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 137.0}, "policy_reward_mean": {"prey_policy": 117.49349999999995, "predator_policy": 17.94}, "custom_metrics": {}, "hist_stats": {"episode_reward": [71.59999999999981, 293.20000000000005, -30.900000000000055, 194.1999999999997, 263.69999999999936, 130.39999999999998, 257.09999999999957, 266.79999999999944, 274.79999999999967, 311.8000000000003, 245.9999999999995, 219.19999999999973, 175.09999999999977, 249.89999999999966, 158.0999999999999, 201.0, 254.0, 200.89999999999958, 203.09999999999934, 298.69999999999965, 298.4, 296.50000000000045, 310.2000000000002, 287.49999999999955, 340.60000000000025, 180.99999999999983, 353.70000000000005, 255.79999999999964, 318.2999999999998, 230.89999999999972, 287.8000000000003, 296.49999999999966, 271.5000000000001, 150.0, 232.0, 105.79999999999995, 287.69999999999993, 300.69999999999993, 202.69999999999996, 324.4000000000001, 215.3999999999999, 311.4000000000002, 285.0999999999998, 240.49999999999957, 317.79999999999995, 280.70000000000005, 331.60000000000065, 228.0999999999999, 281.30000000000007, 171.19999999999982, 312.29999999999995, 316.3000000000002, 307.2999999999999, 204.19999999999953, 376.4000000000002, 84.0, 307.0, 282.0999999999999, 360.9000000000001, 344.2000000000003, 339.9999999999999, 325.5, 340.70000000000016, 345.10000000000025, 275.09999999999997, 363.4000000000003, 298.9999999999999, 230.4999999999999, 321.9000000000002, 333.79999999999995, 300.19999999999993, 347.70000000000005, 318.60000000000025, 355.50000000000006, 378.40000000000015, 318.60000000000014, 320.0, 343.0, 326.0, 338.99999999999983, 320.29999999999995, 366.7000000000003, 306.6999999999999, 306.89999999999964, 153.29999999999987, 250.39999999999952, 123.30000000000004, 325.19999999999993, 231.79999999999993, 372.50000000000017, 359.1000000000005, 203.5, 324.1, 308.6, 323.5999999999999, 80.40000000000009, 244.0, 331.0, 307.1999999999999, 197.59999999999957], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [-176.50000000000014, 16.099999999999966, 170.2999999999998, 110.89999999999995, -235.2999999999999, 34.40000000000004, 53.000000000000064, 66.20000000000003, 112.99999999999982, 148.69999999999985, -79.30000000000004, 118.69999999999987, 139.69999999999985, 100.40000000000003, 112.69999999999993, 154.09999999999982, 145.99999999999991, 126.79999999999993, 172.09999999999982, 139.69999999999996, 88.69999999999999, 134.2999999999998, 57.80000000000003, 100.40000000000002, 65.60000000000005, 72.5, 58.70000000000008, 162.19999999999985, 18.499999999999957, 26.599999999999916, 130.0, -17.0, 102.0, 133.0, 6.799999999999871, 121.09999999999974, 122.2999999999997, 72.79999999999976, 153.49999999999983, 138.19999999999996, 91.09999999999997, 161.2999999999998, 154.09999999999985, 133.39999999999986, 137.29999999999993, 164.8999999999999, 141.79999999999976, 136.69999999999976, 182.9, 157.69999999999982, 124.39999999999993, -36.400000000000105, 170.2999999999999, 181.39999999999998, 169.39999999999995, 85.40000000000005, 95.00000000000003, 188.29999999999995, 136.99999999999997, 53.900000000000034, 152.29999999999987, 132.4999999999999, 163.99999999999994, 132.49999999999997, 129.79999999999995, 133.69999999999993, -142.0, 168.0, 148.0, 14.0, -30.400000000000098, 21.20000000000006, 165.19999999999987, 105.5, 99.79999999999993, 179.89999999999998, 81.20000000000002, 57.500000000000036, 176.6, 147.79999999999984, 53.00000000000002, 112.39999999999992, 133.69999999999993, 166.69999999999996, 155.89999999999984, 81.20000000000002, 125.59999999999982, 47.90000000000001, 122.59999999999998, 180.2, 128.89999999999995, 144.79999999999987, 159.49999999999977, 172.09999999999985, 97.70000000000003, 34.40000000000004, 114.19999999999999, 157.0999999999999, 70.4, 42.800000000000026, 133.99999999999997, 152.2999999999999, 150.4999999999997, 165.7999999999998, 95.00000000000003, 179.2999999999999, 8.000000000000012, 144.1999999999997, 198.2, 177.1999999999999, 43.0, -74.0, 156.0, 151.0, 146.0, 127.1, 175.99999999999991, 182.89999999999992, 166.69999999999993, 177.49999999999991, 165.49999999999997, 162.49999999999994, 166.69999999999993, 150.79999999999995, 175.69999999999996, 160.99999999999994, 176.59999999999994, 168.5, 131.89999999999998, 81.2, 183.79999999999995, 176.5999999999999, 144.20000000000005, 123.80000000000001, 185.59999999999994, -24.10000000000003, 126.49999999999994, 148.3999999999999, 158.5999999999999, 168.2, 131.59999999999985, 158.59999999999997, 97.4, 197.29999999999998, 148.6999999999999, 158.9, 135.5, 200.0, 181.09999999999997, 197.3, 176.59999999999997, 113.0, 171.0, 135.0, 143.0, 188.0, 168.0, 158.0, 134.90000000000003, 187.09999999999997, 191.89999999999998, 61.4, 178.39999999999992, 188.29999999999998, 161.29999999999993, 133.39999999999992, 151.70000000000005, 153.19999999999982, 107.29999999999998, -21.999999999999957, 157.7, 91.69999999999989, -67.9, 75.20000000000005, 36.80000000000001, 184.39999999999998, 59.90000000000003, 119.89999999999995, 171.79999999999995, 193.7, 191.89999999999998, 165.19999999999987, -61.0, 159.5, 88.99999999999997, 184.1, 167.59999999999985, 124.99999999999989, 136.7, 182.8999999999999, -40.000000000000085, -1.6000000000002537, 51.0, 144.0, 160.0, 160.0, 178.3999999999999, 123.7999999999997, 116.29999999999967, 20.29999999999999], "policy_predator_policy_reward": [131.0, 101.0, 12.0, 0.0, 33.0, 137.0, 25.0, 50.0, 0.0, 2.0, 91.0, 0.0, 11.0, 6.0, 0.0, 0.0, 1.0, 1.0, 0.0, 0.0, 9.0, 14.0, 39.0, 22.0, 30.0, 7.0, 2.0, 27.0, 46.0, 67.0, 41.0, 47.0, 2.0, 17.0, 40.0, 33.0, 8.0, 0.0, 2.0, 5.0, 32.0, 14.0, 9.0, 0.0, 0.0, 8.0, 5.0, 4.0, 0.0, 0.0, 68.0, 25.0, 0.0, 2.0, 0.0, 1.0, 19.0, 16.0, 40.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 8.0, 24.0, 100.0, 31.0, 39.0, 59.0, 56.0, 17.0, 0.0, 1.0, 20.0, 32.0, 32.0, 0.0, 0.0, 7.0, 43.0, 0.0, 11.0, 15.0, 33.0, 47.0, 20.0, 0.0, 15.0, 0.0, 7.0, 0.0, 0.0, 54.0, 42.0, 10.0, 0.0, 58.0, 0.0, 7.0, 19.0, 0.0, 0.0, 24.0, 9.0, 52.0, 0.0, 1.0, 0.0, 30.0, 85.0, 0.0, 0.0, 2.0, 7.0, 2.0, 0.0, 0.0, 0.0, 12.0, 0.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 24.0, 38.0, 3.0, 0.0, 13.0, 18.0, 69.0, 0.0, 26.0, 21.0, 6.0, 1.0, 1.0, 9.0, 31.0, 22.0, 11.0, 0.0, 15.0, 5.0, 0.0, 0.0, 29.0, 0.0, 0.0, 14.0, 12.0, 0.0, 0.0, 0.0, 0.0, 17.0, 34.0, 33.0, 0.0, 0.0, 12.0, 0.0, 0.0, 2.0, 0.0, 68.0, 1.0, 0.0, 82.0, 34.0, 51.0, 53.0, 19.0, 33.0, 0.0, 7.0, 0.0, 2.0, 18.0, 87.0, 33.0, 18.0, 0.0, 16.0, 0.0, 4.0, 37.0, 85.0, 42.0, 7.0, 0.0, 11.0, 5.0, 0.0, 56.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5964998610357926, "mean_inference_ms": 4.640386351343391, "mean_action_processing_ms": 0.8291799306012018, "mean_env_wait_ms": 0.527969132801284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015416264533996582, "StateBufferConnector_ms": 0.010348677635192871, "ViewRequirementAgentConnector_ms": 0.3907099962234497}, "num_episodes": 18, "episode_return_max": 378.40000000000015, "episode_return_min": -30.900000000000055, "episode_return_mean": 270.86699999999996, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 129.44391511254955, "num_env_steps_trained_throughput_per_sec": 129.44391511254955, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 752000, "timers": {"training_iteration_time_ms": 25088.896, "restore_workers_time_ms": 0.018, "training_step_time_ms": 25088.837, "sample_time_ms": 4285.566, "learn_time_ms": 20748.204, "learn_throughput": 192.788, "synch_weights_time_ms": 44.953}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 752000, "num_agent_steps_trained": 752000}, "done": false, "training_iteration": 47, "trial_id": "e4caa_00000", "date": "2024-08-13_20-02-02", "timestamp": 1723593722, "time_this_iter_s": 30.974626064300537, "time_total_s": 1057.674647808075, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b282ff70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1057.674647808075, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 91.02499999999999, "ram_util_percent": 84.10227272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.556735691065511, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.469446193351947, "policy_loss": -0.00628203794264072, "vf_loss": 7.474079061942126, "vf_explained_var": 0.028152506692068917, "kl": 0.01099440264623221, "entropy": 1.4943851250189322, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7861303009684124, "cur_kl_coeff": 1.220703125e-05, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.509476847875686, "policy_loss": -0.005501121167763673, "vf_loss": 1.5149779465148059, "vf_explained_var": 0.044435699023897685, "kl": 0.003506741254692602, "entropy": 0.21486459565225732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 89775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "env_runners": {"episode_reward_max": 378.40000000000015, "episode_reward_min": -14.300000000000132, "episode_reward_mean": 271.01399999999995, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -142.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 100.0}, "policy_reward_mean": {"prey_policy": 117.61199999999994, "predator_policy": 17.895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [203.09999999999934, 298.69999999999965, 298.4, 296.50000000000045, 310.2000000000002, 287.49999999999955, 340.60000000000025, 180.99999999999983, 353.70000000000005, 255.79999999999964, 318.2999999999998, 230.89999999999972, 287.8000000000003, 296.49999999999966, 271.5000000000001, 150.0, 232.0, 105.79999999999995, 287.69999999999993, 300.69999999999993, 202.69999999999996, 324.4000000000001, 215.3999999999999, 311.4000000000002, 285.0999999999998, 240.49999999999957, 317.79999999999995, 280.70000000000005, 331.60000000000065, 228.0999999999999, 281.30000000000007, 171.19999999999982, 312.29999999999995, 316.3000000000002, 307.2999999999999, 204.19999999999953, 376.4000000000002, 84.0, 307.0, 282.0999999999999, 360.9000000000001, 344.2000000000003, 339.9999999999999, 325.5, 340.70000000000016, 345.10000000000025, 275.09999999999997, 363.4000000000003, 298.9999999999999, 230.4999999999999, 321.9000000000002, 333.79999999999995, 300.19999999999993, 347.70000000000005, 318.60000000000025, 355.50000000000006, 378.40000000000015, 318.60000000000014, 320.0, 343.0, 326.0, 338.99999999999983, 320.29999999999995, 366.7000000000003, 306.6999999999999, 306.89999999999964, 153.29999999999987, 250.39999999999952, 123.30000000000004, 325.19999999999993, 231.79999999999993, 372.50000000000017, 359.1000000000005, 203.5, 324.1, 308.6, 323.5999999999999, 80.40000000000009, 244.0, 331.0, 307.1999999999999, 197.59999999999957, 287.6999999999998, 302.8, 284.9999999999999, 174.19999999999985, 54.4000000000001, 216.8999999999998, 162.39999999999972, 297.49999999999966, 152.89999999999998, 232.69999999999962, 191.29999999999944, 264.0, 251.2999999999998, 281.1999999999999, 210.0, 245.0, -14.300000000000132, 156.59999999999985], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [122.2999999999997, 72.79999999999976, 153.49999999999983, 138.19999999999996, 91.09999999999997, 161.2999999999998, 154.09999999999985, 133.39999999999986, 137.29999999999993, 164.8999999999999, 141.79999999999976, 136.69999999999976, 182.9, 157.69999999999982, 124.39999999999993, -36.400000000000105, 170.2999999999999, 181.39999999999998, 169.39999999999995, 85.40000000000005, 95.00000000000003, 188.29999999999995, 136.99999999999997, 53.900000000000034, 152.29999999999987, 132.4999999999999, 163.99999999999994, 132.49999999999997, 129.79999999999995, 133.69999999999993, -142.0, 168.0, 148.0, 14.0, -30.400000000000098, 21.20000000000006, 165.19999999999987, 105.5, 99.79999999999993, 179.89999999999998, 81.20000000000002, 57.500000000000036, 176.6, 147.79999999999984, 53.00000000000002, 112.39999999999992, 133.69999999999993, 166.69999999999996, 155.89999999999984, 81.20000000000002, 125.59999999999982, 47.90000000000001, 122.59999999999998, 180.2, 128.89999999999995, 144.79999999999987, 159.49999999999977, 172.09999999999985, 97.70000000000003, 34.40000000000004, 114.19999999999999, 157.0999999999999, 70.4, 42.800000000000026, 133.99999999999997, 152.2999999999999, 150.4999999999997, 165.7999999999998, 95.00000000000003, 179.2999999999999, 8.000000000000012, 144.1999999999997, 198.2, 177.1999999999999, 43.0, -74.0, 156.0, 151.0, 146.0, 127.1, 175.99999999999991, 182.89999999999992, 166.69999999999993, 177.49999999999991, 165.49999999999997, 162.49999999999994, 166.69999999999993, 150.79999999999995, 175.69999999999996, 160.99999999999994, 176.59999999999994, 168.5, 131.89999999999998, 81.2, 183.79999999999995, 176.5999999999999, 144.20000000000005, 123.80000000000001, 185.59999999999994, -24.10000000000003, 126.49999999999994, 148.3999999999999, 158.5999999999999, 168.2, 131.59999999999985, 158.59999999999997, 97.4, 197.29999999999998, 148.6999999999999, 158.9, 135.5, 200.0, 181.09999999999997, 197.3, 176.59999999999997, 113.0, 171.0, 135.0, 143.0, 188.0, 168.0, 158.0, 134.90000000000003, 187.09999999999997, 191.89999999999998, 61.4, 178.39999999999992, 188.29999999999998, 161.29999999999993, 133.39999999999992, 151.70000000000005, 153.19999999999982, 107.29999999999998, -21.999999999999957, 157.7, 91.69999999999989, -67.9, 75.20000000000005, 36.80000000000001, 184.39999999999998, 59.90000000000003, 119.89999999999995, 171.79999999999995, 193.7, 191.89999999999998, 165.19999999999987, -61.0, 159.5, 88.99999999999997, 184.1, 167.59999999999985, 124.99999999999989, 136.7, 182.8999999999999, -40.000000000000085, -1.6000000000002537, 51.0, 144.0, 160.0, 160.0, 178.3999999999999, 123.7999999999997, 116.29999999999967, 20.29999999999999, 97.70000000000005, 172.99999999999986, 125.30000000000007, 177.49999999999994, 42.2, 174.79999999999987, -58.600000000000136, 156.7999999999998, 5.600000000000094, -50.2, 59.30000000000006, 98.6, 55.70000000000004, 64.70000000000002, 165.79999999999998, 127.69999999999973, -19.300000000000153, 81.20000000000002, 118.09999999999995, 110.59999999999997, -85.0000000000002, 125.29999999999966, 111.49999999999991, 117.49999999999994, 51.50000000000001, 129.79999999999995, 154.09999999999982, 127.09999999999997, 35.0, 124.0, 130.0, 86.0, -104.80000000000021, -65.50000000000009, 156.4999999999998, -82.90000000000016], "policy_predator_policy_reward": [8.0, 0.0, 2.0, 5.0, 32.0, 14.0, 9.0, 0.0, 0.0, 8.0, 5.0, 4.0, 0.0, 0.0, 68.0, 25.0, 0.0, 2.0, 0.0, 1.0, 19.0, 16.0, 40.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 8.0, 24.0, 100.0, 31.0, 39.0, 59.0, 56.0, 17.0, 0.0, 1.0, 20.0, 32.0, 32.0, 0.0, 0.0, 7.0, 43.0, 0.0, 11.0, 15.0, 33.0, 47.0, 20.0, 0.0, 15.0, 0.0, 7.0, 0.0, 0.0, 54.0, 42.0, 10.0, 0.0, 58.0, 0.0, 7.0, 19.0, 0.0, 0.0, 24.0, 9.0, 52.0, 0.0, 1.0, 0.0, 30.0, 85.0, 0.0, 0.0, 2.0, 7.0, 2.0, 0.0, 0.0, 0.0, 12.0, 0.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 24.0, 38.0, 3.0, 0.0, 13.0, 18.0, 69.0, 0.0, 26.0, 21.0, 6.0, 1.0, 1.0, 9.0, 31.0, 22.0, 11.0, 0.0, 15.0, 5.0, 0.0, 0.0, 29.0, 0.0, 0.0, 14.0, 12.0, 0.0, 0.0, 0.0, 0.0, 17.0, 34.0, 33.0, 0.0, 0.0, 12.0, 0.0, 0.0, 2.0, 0.0, 68.0, 1.0, 0.0, 82.0, 34.0, 51.0, 53.0, 19.0, 33.0, 0.0, 7.0, 0.0, 2.0, 18.0, 87.0, 33.0, 18.0, 0.0, 16.0, 0.0, 4.0, 37.0, 85.0, 42.0, 7.0, 0.0, 11.0, 5.0, 0.0, 56.0, 5.0, 17.0, 0.0, 0.0, 0.0, 45.0, 23.0, 0.0, 76.0, 0.0, 99.0, 31.0, 28.0, 42.0, 0.0, 3.0, 1.0, 18.0, 73.0, 4.0, 0.0, 76.0, 75.0, 9.0, 26.0, 25.0, 45.0, 0.0, 0.0, 7.0, 44.0, 19.0, 10.0, 70.0, 86.0, 4.0, 79.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6114360461577775, "mean_inference_ms": 4.685635351004844, "mean_action_processing_ms": 0.8306153494947762, "mean_env_wait_ms": 0.5333082923392398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01811075210571289, "StateBufferConnector_ms": 0.031932830810546875, "ViewRequirementAgentConnector_ms": 0.4011176824569702}, "num_episodes": 18, "episode_return_max": 378.40000000000015, "episode_return_min": -14.300000000000132, "episode_return_mean": 271.01399999999995, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 151.84148441842876, "num_env_steps_trained_throughput_per_sec": 151.84148441842876, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 768000, "timers": {"training_iteration_time_ms": 25678.157, "restore_workers_time_ms": 0.018, "training_step_time_ms": 25678.096, "sample_time_ms": 4482.092, "learn_time_ms": 21145.903, "learn_throughput": 189.162, "synch_weights_time_ms": 39.519}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 768000, "num_agent_steps_trained": 768000}, "done": false, "training_iteration": 48, "trial_id": "e4caa_00000", "date": "2024-08-13_20-02-28", "timestamp": 1723593748, "time_this_iter_s": 26.39582085609436, "time_total_s": 1084.0704686641693, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b289a790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1084.0704686641693, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 91.6054054054054, "ram_util_percent": 84.0108108108108}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6553169013331175, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 7.344485402737976, "policy_loss": -0.007294588475414212, "vf_loss": 7.349985372704803, "vf_explained_var": 0.07882259109663585, "kl": 0.01196420157563504, "entropy": 1.4945728321554799, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6108679748086072, "cur_kl_coeff": 6.103515625e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7851141534785113, "policy_loss": -0.002866231581619965, "vf_loss": 1.78798039331638, "vf_explained_var": 0.010602628932428108, "kl": 0.002392856042247366, "entropy": 0.16267575509649104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 91665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "env_runners": {"episode_reward_max": 378.40000000000015, "episode_reward_min": -14.300000000000132, "episode_reward_mean": 270.474, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -104.80000000000021, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 102.0}, "policy_reward_mean": {"prey_policy": 118.05699999999993, "predator_policy": 17.18}, "custom_metrics": {}, "hist_stats": {"episode_reward": [215.3999999999999, 311.4000000000002, 285.0999999999998, 240.49999999999957, 317.79999999999995, 280.70000000000005, 331.60000000000065, 228.0999999999999, 281.30000000000007, 171.19999999999982, 312.29999999999995, 316.3000000000002, 307.2999999999999, 204.19999999999953, 376.4000000000002, 84.0, 307.0, 282.0999999999999, 360.9000000000001, 344.2000000000003, 339.9999999999999, 325.5, 340.70000000000016, 345.10000000000025, 275.09999999999997, 363.4000000000003, 298.9999999999999, 230.4999999999999, 321.9000000000002, 333.79999999999995, 300.19999999999993, 347.70000000000005, 318.60000000000025, 355.50000000000006, 378.40000000000015, 318.60000000000014, 320.0, 343.0, 326.0, 338.99999999999983, 320.29999999999995, 366.7000000000003, 306.6999999999999, 306.89999999999964, 153.29999999999987, 250.39999999999952, 123.30000000000004, 325.19999999999993, 231.79999999999993, 372.50000000000017, 359.1000000000005, 203.5, 324.1, 308.6, 323.5999999999999, 80.40000000000009, 244.0, 331.0, 307.1999999999999, 197.59999999999957, 287.6999999999998, 302.8, 284.9999999999999, 174.19999999999985, 54.4000000000001, 216.8999999999998, 162.39999999999972, 297.49999999999966, 152.89999999999998, 232.69999999999962, 191.29999999999944, 264.0, 251.2999999999998, 281.1999999999999, 210.0, 245.0, -14.300000000000132, 156.59999999999985, -9.200000000000323, 228.0999999999992, 290.90000000000003, 290.5999999999998, 307.70000000000005, 287.99999999999955, 247.19999999999925, 194.19999999999968, 326.30000000000024, 303.00000000000057, 204.59999999999994, 363.1000000000006, 249.5999999999998, 285.29999999999984, 281.8, 236.19999999999976, 284.1999999999998, 291.9999999999997, 310.0, 230.0, 245.49999999999957, 330.69999999999993], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [53.00000000000002, 112.39999999999992, 133.69999999999993, 166.69999999999996, 155.89999999999984, 81.20000000000002, 125.59999999999982, 47.90000000000001, 122.59999999999998, 180.2, 128.89999999999995, 144.79999999999987, 159.49999999999977, 172.09999999999985, 97.70000000000003, 34.40000000000004, 114.19999999999999, 157.0999999999999, 70.4, 42.800000000000026, 133.99999999999997, 152.2999999999999, 150.4999999999997, 165.7999999999998, 95.00000000000003, 179.2999999999999, 8.000000000000012, 144.1999999999997, 198.2, 177.1999999999999, 43.0, -74.0, 156.0, 151.0, 146.0, 127.1, 175.99999999999991, 182.89999999999992, 166.69999999999993, 177.49999999999991, 165.49999999999997, 162.49999999999994, 166.69999999999993, 150.79999999999995, 175.69999999999996, 160.99999999999994, 176.59999999999994, 168.5, 131.89999999999998, 81.2, 183.79999999999995, 176.5999999999999, 144.20000000000005, 123.80000000000001, 185.59999999999994, -24.10000000000003, 126.49999999999994, 148.3999999999999, 158.5999999999999, 168.2, 131.59999999999985, 158.59999999999997, 97.4, 197.29999999999998, 148.6999999999999, 158.9, 135.5, 200.0, 181.09999999999997, 197.3, 176.59999999999997, 113.0, 171.0, 135.0, 143.0, 188.0, 168.0, 158.0, 134.90000000000003, 187.09999999999997, 191.89999999999998, 61.4, 178.39999999999992, 188.29999999999998, 161.29999999999993, 133.39999999999992, 151.70000000000005, 153.19999999999982, 107.29999999999998, -21.999999999999957, 157.7, 91.69999999999989, -67.9, 75.20000000000005, 36.80000000000001, 184.39999999999998, 59.90000000000003, 119.89999999999995, 171.79999999999995, 193.7, 191.89999999999998, 165.19999999999987, -61.0, 159.5, 88.99999999999997, 184.1, 167.59999999999985, 124.99999999999989, 136.7, 182.8999999999999, -40.000000000000085, -1.6000000000002537, 51.0, 144.0, 160.0, 160.0, 178.3999999999999, 123.7999999999997, 116.29999999999967, 20.29999999999999, 97.70000000000005, 172.99999999999986, 125.30000000000007, 177.49999999999994, 42.2, 174.79999999999987, -58.600000000000136, 156.7999999999998, 5.600000000000094, -50.2, 59.30000000000006, 98.6, 55.70000000000004, 64.70000000000002, 165.79999999999998, 127.69999999999973, -19.300000000000153, 81.20000000000002, 118.09999999999995, 110.59999999999997, -85.0000000000002, 125.29999999999966, 111.49999999999991, 117.49999999999994, 51.50000000000001, 129.79999999999995, 154.09999999999982, 127.09999999999997, 35.0, 124.0, 130.0, 86.0, -104.80000000000021, -65.50000000000009, 156.4999999999998, -82.90000000000016, -96.70000000000033, -14.500000000000078, 112.69999999999973, 115.39999999999961, 127.69999999999987, 162.20000000000005, 151.39999999999992, 123.2, 164.90000000000003, 126.79999999999988, 150.49999999999991, 135.49999999999983, 107.89999999999995, 125.29999999999971, 163.1, 1.0999999999999885, 154.7, 158.59999999999977, 164.59999999999982, 130.39999999999992, 2.299999999999997, 152.29999999999993, 182.89999999999992, 180.19999999999993, 162.1999999999999, 37.40000000000002, 167.6, 61.70000000000003, 118.99999999999979, 147.79999999999993, 19.100000000000026, 136.1, 150.50000000000003, 130.69999999999985, 108.19999999999999, 174.79999999999984, 149.0, 161.0, 125.0, 88.0, 88.6999999999999, 102.8, 163.99999999999997, 166.69999999999985], "policy_predator_policy_reward": [7.0, 43.0, 0.0, 11.0, 15.0, 33.0, 47.0, 20.0, 0.0, 15.0, 0.0, 7.0, 0.0, 0.0, 54.0, 42.0, 10.0, 0.0, 58.0, 0.0, 7.0, 19.0, 0.0, 0.0, 24.0, 9.0, 52.0, 0.0, 1.0, 0.0, 30.0, 85.0, 0.0, 0.0, 2.0, 7.0, 2.0, 0.0, 0.0, 0.0, 12.0, 0.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 24.0, 38.0, 3.0, 0.0, 13.0, 18.0, 69.0, 0.0, 26.0, 21.0, 6.0, 1.0, 1.0, 9.0, 31.0, 22.0, 11.0, 0.0, 15.0, 5.0, 0.0, 0.0, 29.0, 0.0, 0.0, 14.0, 12.0, 0.0, 0.0, 0.0, 0.0, 17.0, 34.0, 33.0, 0.0, 0.0, 12.0, 0.0, 0.0, 2.0, 0.0, 68.0, 1.0, 0.0, 82.0, 34.0, 51.0, 53.0, 19.0, 33.0, 0.0, 7.0, 0.0, 2.0, 18.0, 87.0, 33.0, 18.0, 0.0, 16.0, 0.0, 4.0, 37.0, 85.0, 42.0, 7.0, 0.0, 11.0, 5.0, 0.0, 56.0, 5.0, 17.0, 0.0, 0.0, 0.0, 45.0, 23.0, 0.0, 76.0, 0.0, 99.0, 31.0, 28.0, 42.0, 0.0, 3.0, 1.0, 18.0, 73.0, 4.0, 0.0, 76.0, 75.0, 9.0, 26.0, 25.0, 45.0, 0.0, 0.0, 7.0, 44.0, 19.0, 10.0, 70.0, 86.0, 4.0, 79.0, 0.0, 102.0, 0.0, 0.0, 0.0, 1.0, 0.0, 16.0, 11.0, 5.0, 2.0, 0.0, 7.0, 7.0, 24.0, 6.0, 13.0, 0.0, 0.0, 8.0, 11.0, 39.0, 0.0, 0.0, 0.0, 50.0, 32.0, 24.0, 15.0, 0.0, 51.0, 30.0, 3.0, 0.0, 0.0, 9.0, 0.0, 0.0, 17.0, 0.0, 27.0, 27.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6258077984620638, "mean_inference_ms": 4.724328841062228, "mean_action_processing_ms": 0.8301045671233672, "mean_env_wait_ms": 0.5385291050410841, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0201185941696167, "StateBufferConnector_ms": 0.025747179985046387, "ViewRequirementAgentConnector_ms": 0.3451725244522095}, "num_episodes": 22, "episode_return_max": 378.40000000000015, "episode_return_min": -14.300000000000132, "episode_return_mean": 270.474, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 157.92279035143613, "num_env_steps_trained_throughput_per_sec": 157.92279035143613, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 784000, "timers": {"training_iteration_time_ms": 26188.904, "restore_workers_time_ms": 0.019, "training_step_time_ms": 26188.843, "sample_time_ms": 4446.728, "learn_time_ms": 21692.894, "learn_throughput": 184.392, "synch_weights_time_ms": 38.915}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 784000, "num_agent_steps_trained": 784000}, "done": false, "training_iteration": 49, "trial_id": "e4caa_00000", "date": "2024-08-13_20-02-53", "timestamp": 1723593773, "time_this_iter_s": 25.36850094795227, "time_total_s": 1109.4389696121216, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b289a820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1109.4389696121216, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 91.225, "ram_util_percent": 82.6138888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4670666851379255, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.5315342676071895, "policy_loss": -0.0011283386061362252, "vf_loss": 5.530994480375259, "vf_explained_var": -0.006873990776677611, "kl": 0.011120973910029664, "entropy": 1.5252558708821655, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1266964219076923, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.04854236128469, "policy_loss": -0.00036759440215531166, "vf_loss": 3.048909957131381, "vf_explained_var": 0.05266995108316815, "kl": 0.006262992831517982, "entropy": 0.20489420414601683, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 93555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 379.5999999999999, "episode_reward_min": -326.79999999999995, "episode_reward_mean": 263.08899999999994, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -295.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 182.0}, "policy_reward_mean": {"prey_policy": 110.49449999999996, "predator_policy": 21.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [345.10000000000025, 275.09999999999997, 363.4000000000003, 298.9999999999999, 230.4999999999999, 321.9000000000002, 333.79999999999995, 300.19999999999993, 347.70000000000005, 318.60000000000025, 355.50000000000006, 378.40000000000015, 318.60000000000014, 320.0, 343.0, 326.0, 338.99999999999983, 320.29999999999995, 366.7000000000003, 306.6999999999999, 306.89999999999964, 153.29999999999987, 250.39999999999952, 123.30000000000004, 325.19999999999993, 231.79999999999993, 372.50000000000017, 359.1000000000005, 203.5, 324.1, 308.6, 323.5999999999999, 80.40000000000009, 244.0, 331.0, 307.1999999999999, 197.59999999999957, 287.6999999999998, 302.8, 284.9999999999999, 174.19999999999985, 54.4000000000001, 216.8999999999998, 162.39999999999972, 297.49999999999966, 152.89999999999998, 232.69999999999962, 191.29999999999944, 264.0, 251.2999999999998, 281.1999999999999, 210.0, 245.0, -14.300000000000132, 156.59999999999985, -9.200000000000323, 228.0999999999992, 290.90000000000003, 290.5999999999998, 307.70000000000005, 287.99999999999955, 247.19999999999925, 194.19999999999968, 326.30000000000024, 303.00000000000057, 204.59999999999994, 363.1000000000006, 249.5999999999998, 285.29999999999984, 281.8, 236.19999999999976, 284.1999999999998, 291.9999999999997, 310.0, 230.0, 245.49999999999957, 330.69999999999993, 323.5, 233.79999999999998, 379.5999999999999, -13.700000000000003, 303.69999999999993, 185.69999999999993, 293.29999999999995, 364.4, 343.30000000000007, 363.8, 133.1, 67.49999999999996, -326.79999999999995, 314.5, 221.70000000000005, 336.79999999999984, 307.29999999999995, 307.0, 352.0, 339.0, 311.1999999999997, 331.7000000000004, 353.0999999999999], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [176.59999999999994, 168.5, 131.89999999999998, 81.2, 183.79999999999995, 176.5999999999999, 144.20000000000005, 123.80000000000001, 185.59999999999994, -24.10000000000003, 126.49999999999994, 148.3999999999999, 158.5999999999999, 168.2, 131.59999999999985, 158.59999999999997, 97.4, 197.29999999999998, 148.6999999999999, 158.9, 135.5, 200.0, 181.09999999999997, 197.3, 176.59999999999997, 113.0, 171.0, 135.0, 143.0, 188.0, 168.0, 158.0, 134.90000000000003, 187.09999999999997, 191.89999999999998, 61.4, 178.39999999999992, 188.29999999999998, 161.29999999999993, 133.39999999999992, 151.70000000000005, 153.19999999999982, 107.29999999999998, -21.999999999999957, 157.7, 91.69999999999989, -67.9, 75.20000000000005, 36.80000000000001, 184.39999999999998, 59.90000000000003, 119.89999999999995, 171.79999999999995, 193.7, 191.89999999999998, 165.19999999999987, -61.0, 159.5, 88.99999999999997, 184.1, 167.59999999999985, 124.99999999999989, 136.7, 182.8999999999999, -40.000000000000085, -1.6000000000002537, 51.0, 144.0, 160.0, 160.0, 178.3999999999999, 123.7999999999997, 116.29999999999967, 20.29999999999999, 97.70000000000005, 172.99999999999986, 125.30000000000007, 177.49999999999994, 42.2, 174.79999999999987, -58.600000000000136, 156.7999999999998, 5.600000000000094, -50.2, 59.30000000000006, 98.6, 55.70000000000004, 64.70000000000002, 165.79999999999998, 127.69999999999973, -19.300000000000153, 81.20000000000002, 118.09999999999995, 110.59999999999997, -85.0000000000002, 125.29999999999966, 111.49999999999991, 117.49999999999994, 51.50000000000001, 129.79999999999995, 154.09999999999982, 127.09999999999997, 35.0, 124.0, 130.0, 86.0, -104.80000000000021, -65.50000000000009, 156.4999999999998, -82.90000000000016, -96.70000000000033, -14.500000000000078, 112.69999999999973, 115.39999999999961, 127.69999999999987, 162.20000000000005, 151.39999999999992, 123.2, 164.90000000000003, 126.79999999999988, 150.49999999999991, 135.49999999999983, 107.89999999999995, 125.29999999999971, 163.1, 1.0999999999999885, 154.7, 158.59999999999977, 164.59999999999982, 130.39999999999992, 2.299999999999997, 152.29999999999993, 182.89999999999992, 180.19999999999993, 162.1999999999999, 37.40000000000002, 167.6, 61.70000000000003, 118.99999999999979, 147.79999999999993, 19.100000000000026, 136.1, 150.50000000000003, 130.69999999999985, 108.19999999999999, 174.79999999999984, 149.0, 161.0, 125.0, 88.0, 88.6999999999999, 102.8, 163.99999999999997, 166.69999999999985, 182.9, 131.6, -88.0, 144.79999999999998, 186.49999999999997, 190.09999999999997, -295.0, 68.3, 176.0, 82.69999999999999, -13.900000000000006, 107.59999999999994, 74.90000000000003, 160.39999999999986, 170.0, 187.39999999999992, 172.09999999999988, 171.1999999999999, 164.3, 195.5, -118.0, 82.1, -35.50000000000004, -10.0, -257.79999999999995, -253.0, 78.5, 194.0, -107.80000000000001, 159.49999999999983, 118.70000000000005, 184.1, 133.39999999999995, 152.89999999999998, 146.0, 158.0, 174.0, 154.0, 159.0, 180.0, 148.0999999999998, 157.0999999999999, 186.5, 141.19999999999987, 140.3, 192.79999999999995], "policy_predator_policy_reward": [0.0, 0.0, 24.0, 38.0, 3.0, 0.0, 13.0, 18.0, 69.0, 0.0, 26.0, 21.0, 6.0, 1.0, 1.0, 9.0, 31.0, 22.0, 11.0, 0.0, 15.0, 5.0, 0.0, 0.0, 29.0, 0.0, 0.0, 14.0, 12.0, 0.0, 0.0, 0.0, 0.0, 17.0, 34.0, 33.0, 0.0, 0.0, 12.0, 0.0, 0.0, 2.0, 0.0, 68.0, 1.0, 0.0, 82.0, 34.0, 51.0, 53.0, 19.0, 33.0, 0.0, 7.0, 0.0, 2.0, 18.0, 87.0, 33.0, 18.0, 0.0, 16.0, 0.0, 4.0, 37.0, 85.0, 42.0, 7.0, 0.0, 11.0, 5.0, 0.0, 56.0, 5.0, 17.0, 0.0, 0.0, 0.0, 45.0, 23.0, 0.0, 76.0, 0.0, 99.0, 31.0, 28.0, 42.0, 0.0, 3.0, 1.0, 18.0, 73.0, 4.0, 0.0, 76.0, 75.0, 9.0, 26.0, 25.0, 45.0, 0.0, 0.0, 7.0, 44.0, 19.0, 10.0, 70.0, 86.0, 4.0, 79.0, 0.0, 102.0, 0.0, 0.0, 0.0, 1.0, 0.0, 16.0, 11.0, 5.0, 2.0, 0.0, 7.0, 7.0, 24.0, 6.0, 13.0, 0.0, 0.0, 8.0, 11.0, 39.0, 0.0, 0.0, 0.0, 50.0, 32.0, 24.0, 15.0, 0.0, 51.0, 30.0, 3.0, 0.0, 0.0, 9.0, 0.0, 0.0, 17.0, 0.0, 27.0, 27.0, 0.0, 0.0, 0.0, 9.0, 88.0, 89.0, 3.0, 0.0, 48.0, 165.0, 42.0, 3.0, 71.0, 21.0, 34.0, 24.0, 0.0, 7.0, 0.0, 0.0, 2.0, 2.0, 31.0, 138.0, 101.0, 12.0, 182.0, 2.0, 40.0, 2.0, 85.0, 85.0, 13.0, 21.0, 10.0, 11.0, 3.0, 0.0, 12.0, 12.0, 0.0, 0.0, 4.0, 2.0, 0.0, 4.0, 13.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6288694983213245, "mean_inference_ms": 4.753818324356665, "mean_action_processing_ms": 0.8336193574354749, "mean_env_wait_ms": 0.5441500740264154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024786949157714844, "StateBufferConnector_ms": 0.0255582332611084, "ViewRequirementAgentConnector_ms": 0.334078311920166}, "num_episodes": 23, "episode_return_max": 379.5999999999999, "episode_return_min": -326.79999999999995, "episode_return_mean": 263.08899999999994, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 207.59919845987804, "num_env_steps_trained_throughput_per_sec": 207.59919845987804, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 26048.407, "restore_workers_time_ms": 0.018, "training_step_time_ms": 26048.348, "sample_time_ms": 4165.046, "learn_time_ms": 21835.356, "learn_throughput": 183.189, "synch_weights_time_ms": 38.146}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 50, "trial_id": "e4caa_00000", "date": "2024-08-13_20-03-13", "timestamp": 1723593793, "time_this_iter_s": 19.32589316368103, "time_total_s": 1128.7648627758026, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29099d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1128.7648627758026, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 83.34285714285714, "ram_util_percent": 76.06428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9307873704761422, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.204378763077751, "policy_loss": -0.005005966600464293, "vf_loss": 6.207618808998633, "vf_explained_var": 0.006149853978838239, "kl": 0.011772915811829055, "entropy": 1.4982265493857168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8011582910699189, "cur_kl_coeff": 3.0517578125e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8903760108998213, "policy_loss": -0.0030622871453435253, "vf_loss": 3.893438301641474, "vf_explained_var": 0.06771820550242429, "kl": 0.0028799039858983283, "entropy": 0.2166628289553854, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 95445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "env_runners": {"episode_reward_max": 379.5999999999999, "episode_reward_min": -326.79999999999995, "episode_reward_mean": 242.35699999999997, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -309.7, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 198.2, "predator_policy": 182.0}, "policy_reward_mean": {"prey_policy": 95.52849999999995, "predator_policy": 25.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [366.7000000000003, 306.6999999999999, 306.89999999999964, 153.29999999999987, 250.39999999999952, 123.30000000000004, 325.19999999999993, 231.79999999999993, 372.50000000000017, 359.1000000000005, 203.5, 324.1, 308.6, 323.5999999999999, 80.40000000000009, 244.0, 331.0, 307.1999999999999, 197.59999999999957, 287.6999999999998, 302.8, 284.9999999999999, 174.19999999999985, 54.4000000000001, 216.8999999999998, 162.39999999999972, 297.49999999999966, 152.89999999999998, 232.69999999999962, 191.29999999999944, 264.0, 251.2999999999998, 281.1999999999999, 210.0, 245.0, -14.300000000000132, 156.59999999999985, -9.200000000000323, 228.0999999999992, 290.90000000000003, 290.5999999999998, 307.70000000000005, 287.99999999999955, 247.19999999999925, 194.19999999999968, 326.30000000000024, 303.00000000000057, 204.59999999999994, 363.1000000000006, 249.5999999999998, 285.29999999999984, 281.8, 236.19999999999976, 284.1999999999998, 291.9999999999997, 310.0, 230.0, 245.49999999999957, 330.69999999999993, 323.5, 233.79999999999998, 379.5999999999999, -13.700000000000003, 303.69999999999993, 185.69999999999993, 293.29999999999995, 364.4, 343.30000000000007, 363.8, 133.1, 67.49999999999996, -326.79999999999995, 314.5, 221.70000000000005, 336.79999999999984, 307.29999999999995, 307.0, 352.0, 339.0, 311.1999999999997, 331.7000000000004, 353.0999999999999, 330.4999999999998, 215.7999999999999, 355.00000000000006, -21.000000000000007, 163.6, 303.00000000000006, 241.99999999999983, -224.50000000000003, 301.8999999999999, 285.00000000000057, 275.69999999999993, 339.00000000000017, -53.2, 57.50000000000001, 283.0, 228.0, 364.4, 317.1999999999998], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [178.39999999999992, 188.29999999999998, 161.29999999999993, 133.39999999999992, 151.70000000000005, 153.19999999999982, 107.29999999999998, -21.999999999999957, 157.7, 91.69999999999989, -67.9, 75.20000000000005, 36.80000000000001, 184.39999999999998, 59.90000000000003, 119.89999999999995, 171.79999999999995, 193.7, 191.89999999999998, 165.19999999999987, -61.0, 159.5, 88.99999999999997, 184.1, 167.59999999999985, 124.99999999999989, 136.7, 182.8999999999999, -40.000000000000085, -1.6000000000002537, 51.0, 144.0, 160.0, 160.0, 178.3999999999999, 123.7999999999997, 116.29999999999967, 20.29999999999999, 97.70000000000005, 172.99999999999986, 125.30000000000007, 177.49999999999994, 42.2, 174.79999999999987, -58.600000000000136, 156.7999999999998, 5.600000000000094, -50.2, 59.30000000000006, 98.6, 55.70000000000004, 64.70000000000002, 165.79999999999998, 127.69999999999973, -19.300000000000153, 81.20000000000002, 118.09999999999995, 110.59999999999997, -85.0000000000002, 125.29999999999966, 111.49999999999991, 117.49999999999994, 51.50000000000001, 129.79999999999995, 154.09999999999982, 127.09999999999997, 35.0, 124.0, 130.0, 86.0, -104.80000000000021, -65.50000000000009, 156.4999999999998, -82.90000000000016, -96.70000000000033, -14.500000000000078, 112.69999999999973, 115.39999999999961, 127.69999999999987, 162.20000000000005, 151.39999999999992, 123.2, 164.90000000000003, 126.79999999999988, 150.49999999999991, 135.49999999999983, 107.89999999999995, 125.29999999999971, 163.1, 1.0999999999999885, 154.7, 158.59999999999977, 164.59999999999982, 130.39999999999992, 2.299999999999997, 152.29999999999993, 182.89999999999992, 180.19999999999993, 162.1999999999999, 37.40000000000002, 167.6, 61.70000000000003, 118.99999999999979, 147.79999999999993, 19.100000000000026, 136.1, 150.50000000000003, 130.69999999999985, 108.19999999999999, 174.79999999999984, 149.0, 161.0, 125.0, 88.0, 88.6999999999999, 102.8, 163.99999999999997, 166.69999999999985, 182.9, 131.6, -88.0, 144.79999999999998, 186.49999999999997, 190.09999999999997, -295.0, 68.3, 176.0, 82.69999999999999, -13.900000000000006, 107.59999999999994, 74.90000000000003, 160.39999999999986, 170.0, 187.39999999999992, 172.09999999999988, 171.1999999999999, 164.3, 195.5, -118.0, 82.1, -35.50000000000004, -10.0, -257.79999999999995, -253.0, 78.5, 194.0, -107.80000000000001, 159.49999999999983, 118.70000000000005, 184.1, 133.39999999999995, 152.89999999999998, 146.0, 158.0, 174.0, 154.0, 159.0, 180.0, 148.0999999999998, 157.0999999999999, 186.5, 141.19999999999987, 140.3, 192.79999999999995, 144.20000000000005, 185.3, 68.6, -2.8000000000000824, 181.1, 173.89999999999998, -205.9, 11.899999999999999, -45.69999999999999, 77.3, 163.7, 131.2999999999998, 157.9999999999999, 34.999999999999986, -98.80000000000001, -309.7, 198.2, 67.70000000000003, 48.79999999999997, 180.19999999999987, 89.9, 102.80000000000001, 178.39999999999995, 152.6, 62.599999999999994, -272.8, -224.79999999999998, 134.29999999999976, 134.0, 71.0, -19.0, 163.0, 161.9, 195.5, 179.29999999999987, 119.9], "policy_predator_policy_reward": [0.0, 0.0, 12.0, 0.0, 0.0, 2.0, 0.0, 68.0, 1.0, 0.0, 82.0, 34.0, 51.0, 53.0, 19.0, 33.0, 0.0, 7.0, 0.0, 2.0, 18.0, 87.0, 33.0, 18.0, 0.0, 16.0, 0.0, 4.0, 37.0, 85.0, 42.0, 7.0, 0.0, 11.0, 5.0, 0.0, 56.0, 5.0, 17.0, 0.0, 0.0, 0.0, 45.0, 23.0, 0.0, 76.0, 0.0, 99.0, 31.0, 28.0, 42.0, 0.0, 3.0, 1.0, 18.0, 73.0, 4.0, 0.0, 76.0, 75.0, 9.0, 26.0, 25.0, 45.0, 0.0, 0.0, 7.0, 44.0, 19.0, 10.0, 70.0, 86.0, 4.0, 79.0, 0.0, 102.0, 0.0, 0.0, 0.0, 1.0, 0.0, 16.0, 11.0, 5.0, 2.0, 0.0, 7.0, 7.0, 24.0, 6.0, 13.0, 0.0, 0.0, 8.0, 11.0, 39.0, 0.0, 0.0, 0.0, 50.0, 32.0, 24.0, 15.0, 0.0, 51.0, 30.0, 3.0, 0.0, 0.0, 9.0, 0.0, 0.0, 17.0, 0.0, 27.0, 27.0, 0.0, 0.0, 0.0, 9.0, 88.0, 89.0, 3.0, 0.0, 48.0, 165.0, 42.0, 3.0, 71.0, 21.0, 34.0, 24.0, 0.0, 7.0, 0.0, 0.0, 2.0, 2.0, 31.0, 138.0, 101.0, 12.0, 182.0, 2.0, 40.0, 2.0, 85.0, 85.0, 13.0, 21.0, 10.0, 11.0, 3.0, 0.0, 12.0, 12.0, 0.0, 0.0, 4.0, 2.0, 0.0, 4.0, 13.0, 7.0, 0.0, 1.0, 80.0, 70.0, 0.0, 0.0, 130.0, 43.0, 24.0, 108.0, 7.0, 1.0, 19.0, 30.0, 8.0, 176.0, 12.0, 24.0, 17.0, 39.0, 31.0, 52.0, 1.0, 7.0, 157.0, 0.0, 141.0, 7.0, 35.0, 43.0, 72.0, 12.0, 4.0, 3.0, 18.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6340948971352334, "mean_inference_ms": 4.76725788985834, "mean_action_processing_ms": 0.8279132545415748, "mean_env_wait_ms": 0.5448336685706405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017222285270690918, "StateBufferConnector_ms": 0.025555133819580078, "ViewRequirementAgentConnector_ms": 0.29498839378356934}, "num_episodes": 18, "episode_return_max": 379.5999999999999, "episode_return_min": -326.79999999999995, "episode_return_mean": 242.35699999999997, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 99.94592373799448, "num_env_steps_trained_throughput_per_sec": 99.94592373799448, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 816000, "timers": {"training_iteration_time_ms": 27827.186, "restore_workers_time_ms": 0.017, "training_step_time_ms": 27827.128, "sample_time_ms": 4196.557, "learn_time_ms": 23580.855, "learn_throughput": 169.629, "synch_weights_time_ms": 39.445}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 816000, "num_agent_steps_trained": 816000}, "done": false, "training_iteration": 51, "trial_id": "e4caa_00000", "date": "2024-08-13_20-03-53", "timestamp": 1723593833, "time_this_iter_s": 40.131136894226074, "time_total_s": 1168.8959996700287, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2958790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1168.8959996700287, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 94.3327272727273, "ram_util_percent": 83.14}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4916728216819664, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.025558655602591, "policy_loss": -0.004583092744181317, "vf_loss": 6.028784750630616, "vf_explained_var": 0.059558130729766116, "kl": 0.009046656666394497, "entropy": 1.4927695818679043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.488484856139415, "cur_kl_coeff": 1.52587890625e-06, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9270911356128713, "policy_loss": -0.0031340116753228128, "vf_loss": 1.9302251503896461, "vf_explained_var": 0.07230549240238453, "kl": 0.003151724253276368, "entropy": 0.19768990495059857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 97335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "env_runners": {"episode_reward_max": 383.79999999999995, "episode_reward_min": -326.79999999999995, "episode_reward_mean": 242.5119999999999, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -309.7, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 182.0}, "policy_reward_mean": {"prey_policy": 95.87099999999995, "predator_policy": 25.385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [197.59999999999957, 287.6999999999998, 302.8, 284.9999999999999, 174.19999999999985, 54.4000000000001, 216.8999999999998, 162.39999999999972, 297.49999999999966, 152.89999999999998, 232.69999999999962, 191.29999999999944, 264.0, 251.2999999999998, 281.1999999999999, 210.0, 245.0, -14.300000000000132, 156.59999999999985, -9.200000000000323, 228.0999999999992, 290.90000000000003, 290.5999999999998, 307.70000000000005, 287.99999999999955, 247.19999999999925, 194.19999999999968, 326.30000000000024, 303.00000000000057, 204.59999999999994, 363.1000000000006, 249.5999999999998, 285.29999999999984, 281.8, 236.19999999999976, 284.1999999999998, 291.9999999999997, 310.0, 230.0, 245.49999999999957, 330.69999999999993, 323.5, 233.79999999999998, 379.5999999999999, -13.700000000000003, 303.69999999999993, 185.69999999999993, 293.29999999999995, 364.4, 343.30000000000007, 363.8, 133.1, 67.49999999999996, -326.79999999999995, 314.5, 221.70000000000005, 336.79999999999984, 307.29999999999995, 307.0, 352.0, 339.0, 311.1999999999997, 331.7000000000004, 353.0999999999999, 330.4999999999998, 215.7999999999999, 355.00000000000006, -21.000000000000007, 163.6, 303.00000000000006, 241.99999999999983, -224.50000000000003, 301.8999999999999, 285.00000000000057, 275.69999999999993, 339.00000000000017, -53.2, 57.50000000000001, 283.0, 228.0, 364.4, 317.1999999999998, 169.39999999999995, 281.20000000000044, 257.79999999999984, 325.2999999999996, 263.79999999999984, 365.1, 250.4999999999998, 202.69999999999973, 145.79999999999995, 283.5999999999999, 383.79999999999995, 219.1999999999996, 308.6999999999997, 297.39999999999964, 194.0, 305.0, 357.0, 323.4999999999997], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [116.29999999999967, 20.29999999999999, 97.70000000000005, 172.99999999999986, 125.30000000000007, 177.49999999999994, 42.2, 174.79999999999987, -58.600000000000136, 156.7999999999998, 5.600000000000094, -50.2, 59.30000000000006, 98.6, 55.70000000000004, 64.70000000000002, 165.79999999999998, 127.69999999999973, -19.300000000000153, 81.20000000000002, 118.09999999999995, 110.59999999999997, -85.0000000000002, 125.29999999999966, 111.49999999999991, 117.49999999999994, 51.50000000000001, 129.79999999999995, 154.09999999999982, 127.09999999999997, 35.0, 124.0, 130.0, 86.0, -104.80000000000021, -65.50000000000009, 156.4999999999998, -82.90000000000016, -96.70000000000033, -14.500000000000078, 112.69999999999973, 115.39999999999961, 127.69999999999987, 162.20000000000005, 151.39999999999992, 123.2, 164.90000000000003, 126.79999999999988, 150.49999999999991, 135.49999999999983, 107.89999999999995, 125.29999999999971, 163.1, 1.0999999999999885, 154.7, 158.59999999999977, 164.59999999999982, 130.39999999999992, 2.299999999999997, 152.29999999999993, 182.89999999999992, 180.19999999999993, 162.1999999999999, 37.40000000000002, 167.6, 61.70000000000003, 118.99999999999979, 147.79999999999993, 19.100000000000026, 136.1, 150.50000000000003, 130.69999999999985, 108.19999999999999, 174.79999999999984, 149.0, 161.0, 125.0, 88.0, 88.6999999999999, 102.8, 163.99999999999997, 166.69999999999985, 182.9, 131.6, -88.0, 144.79999999999998, 186.49999999999997, 190.09999999999997, -295.0, 68.3, 176.0, 82.69999999999999, -13.900000000000006, 107.59999999999994, 74.90000000000003, 160.39999999999986, 170.0, 187.39999999999992, 172.09999999999988, 171.1999999999999, 164.3, 195.5, -118.0, 82.1, -35.50000000000004, -10.0, -257.79999999999995, -253.0, 78.5, 194.0, -107.80000000000001, 159.49999999999983, 118.70000000000005, 184.1, 133.39999999999995, 152.89999999999998, 146.0, 158.0, 174.0, 154.0, 159.0, 180.0, 148.0999999999998, 157.0999999999999, 186.5, 141.19999999999987, 140.3, 192.79999999999995, 144.20000000000005, 185.3, 68.6, -2.8000000000000824, 181.1, 173.89999999999998, -205.9, 11.899999999999999, -45.69999999999999, 77.3, 163.7, 131.2999999999998, 157.9999999999999, 34.999999999999986, -98.80000000000001, -309.7, 198.2, 67.70000000000003, 48.79999999999997, 180.19999999999987, 89.9, 102.80000000000001, 178.39999999999995, 152.6, 62.599999999999994, -272.8, -224.79999999999998, 134.29999999999976, 134.0, 71.0, -19.0, 163.0, 161.9, 195.5, 179.29999999999987, 119.9, 154.99999999999994, -76.60000000000002, 146.89999999999998, 134.29999999999993, 37.10000000000002, 175.69999999999996, 155.89999999999975, 169.39999999999995, 1.4000000000000057, 151.39999999999975, 167.29999999999998, 192.8, 154.0999999999998, 46.39999999999998, 57.2, 99.50000000000009, 138.19999999999987, -84.40000000000006, 147.7999999999998, 54.8, 183.79999999999998, 200.0, 140.89999999999995, 29.30000000000009, 113.0, 184.70000000000002, 135.19999999999965, 162.2, 9.0, 132.0, 160.0, 122.0, 198.2, 141.8, 156.8, 166.69999999999982], "policy_predator_policy_reward": [56.0, 5.0, 17.0, 0.0, 0.0, 0.0, 45.0, 23.0, 0.0, 76.0, 0.0, 99.0, 31.0, 28.0, 42.0, 0.0, 3.0, 1.0, 18.0, 73.0, 4.0, 0.0, 76.0, 75.0, 9.0, 26.0, 25.0, 45.0, 0.0, 0.0, 7.0, 44.0, 19.0, 10.0, 70.0, 86.0, 4.0, 79.0, 0.0, 102.0, 0.0, 0.0, 0.0, 1.0, 0.0, 16.0, 11.0, 5.0, 2.0, 0.0, 7.0, 7.0, 24.0, 6.0, 13.0, 0.0, 0.0, 8.0, 11.0, 39.0, 0.0, 0.0, 0.0, 50.0, 32.0, 24.0, 15.0, 0.0, 51.0, 30.0, 3.0, 0.0, 0.0, 9.0, 0.0, 0.0, 17.0, 0.0, 27.0, 27.0, 0.0, 0.0, 0.0, 9.0, 88.0, 89.0, 3.0, 0.0, 48.0, 165.0, 42.0, 3.0, 71.0, 21.0, 34.0, 24.0, 0.0, 7.0, 0.0, 0.0, 2.0, 2.0, 31.0, 138.0, 101.0, 12.0, 182.0, 2.0, 40.0, 2.0, 85.0, 85.0, 13.0, 21.0, 10.0, 11.0, 3.0, 0.0, 12.0, 12.0, 0.0, 0.0, 4.0, 2.0, 0.0, 4.0, 13.0, 7.0, 0.0, 1.0, 80.0, 70.0, 0.0, 0.0, 130.0, 43.0, 24.0, 108.0, 7.0, 1.0, 19.0, 30.0, 8.0, 176.0, 12.0, 24.0, 17.0, 39.0, 31.0, 52.0, 1.0, 7.0, 157.0, 0.0, 141.0, 7.0, 35.0, 43.0, 72.0, 12.0, 4.0, 3.0, 18.0, 0.0, 91.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 0.0, 63.0, 48.0, 4.0, 1.0, 50.0, 0.0, 32.0, 14.0, 2.0, 90.0, 40.0, 41.0, 0.0, 0.0, 0.0, 49.0, 0.0, 11.0, 0.0, 0.0, 53.0, 0.0, 11.0, 12.0, 2.0, 15.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6342313945403018, "mean_inference_ms": 4.771327992158592, "mean_action_processing_ms": 0.8251069929316708, "mean_env_wait_ms": 0.5458525234146473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015576601028442383, "StateBufferConnector_ms": 0.028089404106140137, "ViewRequirementAgentConnector_ms": 0.22231948375701904}, "num_episodes": 18, "episode_return_max": 383.79999999999995, "episode_return_min": -326.79999999999995, "episode_return_mean": 242.5119999999999, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 116.42470274297703, "num_env_steps_trained_throughput_per_sec": 116.42470274297703, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 832000, "timers": {"training_iteration_time_ms": 29252.361, "restore_workers_time_ms": 0.029, "training_step_time_ms": 29252.288, "sample_time_ms": 4236.282, "learn_time_ms": 24964.965, "learn_throughput": 160.225, "synch_weights_time_ms": 39.434}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 832000, "num_agent_steps_trained": 832000}, "done": false, "training_iteration": 52, "trial_id": "e4caa_00000", "date": "2024-08-13_20-04-28", "timestamp": 1723593868, "time_this_iter_s": 34.45309400558472, "time_total_s": 1203.3490936756134, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b03a28b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1203.3490936756134, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 91.61489361702127, "ram_util_percent": 84.05106382978724}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.8279732945104126, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.184672772821295, "policy_loss": -0.0026867913954432996, "vf_loss": 5.18652946520104, "vf_explained_var": 0.08250973404399932, "kl": 0.005534101571011396, "entropy": 1.5017140835681289, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8425320344154166, "cur_kl_coeff": 7.62939453125e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4090651263635625, "policy_loss": -0.0008320053127747049, "vf_loss": 1.409897128425578, "vf_explained_var": 0.09556060893825753, "kl": 0.001978327731735926, "entropy": 0.17642689361458733, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 99225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "env_runners": {"episode_reward_max": 383.79999999999995, "episode_reward_min": -326.79999999999995, "episode_reward_mean": 251.77499999999992, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -309.7, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 182.0}, "policy_reward_mean": {"prey_policy": 100.79749999999994, "predator_policy": 25.09}, "custom_metrics": {}, "hist_stats": {"episode_reward": [156.59999999999985, -9.200000000000323, 228.0999999999992, 290.90000000000003, 290.5999999999998, 307.70000000000005, 287.99999999999955, 247.19999999999925, 194.19999999999968, 326.30000000000024, 303.00000000000057, 204.59999999999994, 363.1000000000006, 249.5999999999998, 285.29999999999984, 281.8, 236.19999999999976, 284.1999999999998, 291.9999999999997, 310.0, 230.0, 245.49999999999957, 330.69999999999993, 323.5, 233.79999999999998, 379.5999999999999, -13.700000000000003, 303.69999999999993, 185.69999999999993, 293.29999999999995, 364.4, 343.30000000000007, 363.8, 133.1, 67.49999999999996, -326.79999999999995, 314.5, 221.70000000000005, 336.79999999999984, 307.29999999999995, 307.0, 352.0, 339.0, 311.1999999999997, 331.7000000000004, 353.0999999999999, 330.4999999999998, 215.7999999999999, 355.00000000000006, -21.000000000000007, 163.6, 303.00000000000006, 241.99999999999983, -224.50000000000003, 301.8999999999999, 285.00000000000057, 275.69999999999993, 339.00000000000017, -53.2, 57.50000000000001, 283.0, 228.0, 364.4, 317.1999999999998, 169.39999999999995, 281.20000000000044, 257.79999999999984, 325.2999999999996, 263.79999999999984, 365.1, 250.4999999999998, 202.69999999999973, 145.79999999999995, 283.5999999999999, 383.79999999999995, 219.1999999999996, 308.6999999999997, 297.39999999999964, 194.0, 305.0, 357.0, 323.4999999999997, 288.39999999999986, 312.6, 260.79999999999984, 295.8000000000005, -34.10000000000012, 191.8, 266.0999999999999, 363.19999999999993, 244.4000000000001, 362.70000000000016, 312.8, 337.0, 284.60000000000014, 325.7, 215.0, 278.0, 232.49999999999972, 181.59999999999997], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [156.4999999999998, -82.90000000000016, -96.70000000000033, -14.500000000000078, 112.69999999999973, 115.39999999999961, 127.69999999999987, 162.20000000000005, 151.39999999999992, 123.2, 164.90000000000003, 126.79999999999988, 150.49999999999991, 135.49999999999983, 107.89999999999995, 125.29999999999971, 163.1, 1.0999999999999885, 154.7, 158.59999999999977, 164.59999999999982, 130.39999999999992, 2.299999999999997, 152.29999999999993, 182.89999999999992, 180.19999999999993, 162.1999999999999, 37.40000000000002, 167.6, 61.70000000000003, 118.99999999999979, 147.79999999999993, 19.100000000000026, 136.1, 150.50000000000003, 130.69999999999985, 108.19999999999999, 174.79999999999984, 149.0, 161.0, 125.0, 88.0, 88.6999999999999, 102.8, 163.99999999999997, 166.69999999999985, 182.9, 131.6, -88.0, 144.79999999999998, 186.49999999999997, 190.09999999999997, -295.0, 68.3, 176.0, 82.69999999999999, -13.900000000000006, 107.59999999999994, 74.90000000000003, 160.39999999999986, 170.0, 187.39999999999992, 172.09999999999988, 171.1999999999999, 164.3, 195.5, -118.0, 82.1, -35.50000000000004, -10.0, -257.79999999999995, -253.0, 78.5, 194.0, -107.80000000000001, 159.49999999999983, 118.70000000000005, 184.1, 133.39999999999995, 152.89999999999998, 146.0, 158.0, 174.0, 154.0, 159.0, 180.0, 148.0999999999998, 157.0999999999999, 186.5, 141.19999999999987, 140.3, 192.79999999999995, 144.20000000000005, 185.3, 68.6, -2.8000000000000824, 181.1, 173.89999999999998, -205.9, 11.899999999999999, -45.69999999999999, 77.3, 163.7, 131.2999999999998, 157.9999999999999, 34.999999999999986, -98.80000000000001, -309.7, 198.2, 67.70000000000003, 48.79999999999997, 180.19999999999987, 89.9, 102.80000000000001, 178.39999999999995, 152.6, 62.599999999999994, -272.8, -224.79999999999998, 134.29999999999976, 134.0, 71.0, -19.0, 163.0, 161.9, 195.5, 179.29999999999987, 119.9, 154.99999999999994, -76.60000000000002, 146.89999999999998, 134.29999999999993, 37.10000000000002, 175.69999999999996, 155.89999999999975, 169.39999999999995, 1.4000000000000057, 151.39999999999975, 167.29999999999998, 192.8, 154.0999999999998, 46.39999999999998, 57.2, 99.50000000000009, 138.19999999999987, -84.40000000000006, 147.7999999999998, 54.8, 183.79999999999998, 200.0, 140.89999999999995, 29.30000000000009, 113.0, 184.70000000000002, 135.19999999999965, 162.2, 9.0, 132.0, 160.0, 122.0, 198.2, 141.8, 156.8, 166.69999999999982, -8.199999999999996, 167.60000000000002, 163.39999999999998, 108.19999999999999, 186.49999999999994, 11.300000000000058, 165.1999999999999, 113.59999999999982, -15.100000000000023, -121.00000000000009, 164.0, -125.19999999999999, 140.60000000000002, 81.5, 163.69999999999985, 195.49999999999997, 116.00000000000003, 124.39999999999999, 197.29999999999998, 163.39999999999998, 200.0, 63.800000000000004, 174.8, 162.2, 104.59999999999997, 163.9999999999999, 157.09999999999997, 161.59999999999994, 3.0, 103.0, 162.0, 54.0, -26.499999999999936, 200.0, 88.4, 0.20000000000001705], "policy_predator_policy_reward": [4.0, 79.0, 0.0, 102.0, 0.0, 0.0, 0.0, 1.0, 0.0, 16.0, 11.0, 5.0, 2.0, 0.0, 7.0, 7.0, 24.0, 6.0, 13.0, 0.0, 0.0, 8.0, 11.0, 39.0, 0.0, 0.0, 0.0, 50.0, 32.0, 24.0, 15.0, 0.0, 51.0, 30.0, 3.0, 0.0, 0.0, 9.0, 0.0, 0.0, 17.0, 0.0, 27.0, 27.0, 0.0, 0.0, 0.0, 9.0, 88.0, 89.0, 3.0, 0.0, 48.0, 165.0, 42.0, 3.0, 71.0, 21.0, 34.0, 24.0, 0.0, 7.0, 0.0, 0.0, 2.0, 2.0, 31.0, 138.0, 101.0, 12.0, 182.0, 2.0, 40.0, 2.0, 85.0, 85.0, 13.0, 21.0, 10.0, 11.0, 3.0, 0.0, 12.0, 12.0, 0.0, 0.0, 4.0, 2.0, 0.0, 4.0, 13.0, 7.0, 0.0, 1.0, 80.0, 70.0, 0.0, 0.0, 130.0, 43.0, 24.0, 108.0, 7.0, 1.0, 19.0, 30.0, 8.0, 176.0, 12.0, 24.0, 17.0, 39.0, 31.0, 52.0, 1.0, 7.0, 157.0, 0.0, 141.0, 7.0, 35.0, 43.0, 72.0, 12.0, 4.0, 3.0, 18.0, 0.0, 91.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 0.0, 63.0, 48.0, 4.0, 1.0, 50.0, 0.0, 32.0, 14.0, 2.0, 90.0, 40.0, 41.0, 0.0, 0.0, 0.0, 49.0, 0.0, 11.0, 0.0, 0.0, 53.0, 0.0, 11.0, 12.0, 2.0, 15.0, 0.0, 0.0, 62.0, 67.0, 19.0, 22.0, 41.0, 22.0, 5.0, 12.0, 0.0, 102.0, 97.0, 56.0, 35.0, 9.0, 4.0, 0.0, 2.0, 2.0, 2.0, 0.0, 6.0, 43.0, 0.0, 0.0, 4.0, 12.0, 7.0, 0.0, 57.0, 52.0, 36.0, 26.0, 0.0, 59.0, 57.0, 36.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6399860218026856, "mean_inference_ms": 4.800341140522332, "mean_action_processing_ms": 0.8267472331566615, "mean_env_wait_ms": 0.5507544309568293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012906074523925781, "StateBufferConnector_ms": 0.00655055046081543, "ViewRequirementAgentConnector_ms": 0.20927822589874268}, "num_episodes": 18, "episode_return_max": 383.79999999999995, "episode_return_min": -326.79999999999995, "episode_return_mean": 251.77499999999992, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 130.7931092400747, "num_env_steps_trained_throughput_per_sec": 130.7931092400747, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 848000, "timers": {"training_iteration_time_ms": 30191.341, "restore_workers_time_ms": 0.029, "training_step_time_ms": 30191.267, "sample_time_ms": 5039.233, "learn_time_ms": 25100.407, "learn_throughput": 159.36, "synch_weights_time_ms": 39.551}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 848000, "num_agent_steps_trained": 848000}, "done": false, "training_iteration": 53, "trial_id": "e4caa_00000", "date": "2024-08-13_20-04-58", "timestamp": 1723593898, "time_this_iter_s": 30.683207988739014, "time_total_s": 1234.0323016643524, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b282f700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1234.0323016643524, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 88.5139534883721, "ram_util_percent": 84.05813953488371}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4458388162353053, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.414327102868015, "policy_loss": -0.004829855370409196, "vf_loss": 5.417508934666871, "vf_explained_var": 0.04235842641068514, "kl": 0.010986902292359671, "entropy": 1.4980372847072663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6090956946371724, "cur_kl_coeff": 3.814697265625e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.51747158734256, "policy_loss": -0.00414189426524062, "vf_loss": 2.5216134842741424, "vf_explained_var": 0.06381337330454871, "kl": 0.003495661225510623, "entropy": 0.14423796816004647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 101115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "env_runners": {"episode_reward_max": 383.79999999999995, "episode_reward_min": -326.79999999999995, "episode_reward_mean": 260.078, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -309.7, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 182.0}, "policy_reward_mean": {"prey_policy": 104.29899999999998, "predator_policy": 25.74}, "custom_metrics": {}, "hist_stats": {"episode_reward": [330.69999999999993, 323.5, 233.79999999999998, 379.5999999999999, -13.700000000000003, 303.69999999999993, 185.69999999999993, 293.29999999999995, 364.4, 343.30000000000007, 363.8, 133.1, 67.49999999999996, -326.79999999999995, 314.5, 221.70000000000005, 336.79999999999984, 307.29999999999995, 307.0, 352.0, 339.0, 311.1999999999997, 331.7000000000004, 353.0999999999999, 330.4999999999998, 215.7999999999999, 355.00000000000006, -21.000000000000007, 163.6, 303.00000000000006, 241.99999999999983, -224.50000000000003, 301.8999999999999, 285.00000000000057, 275.69999999999993, 339.00000000000017, -53.2, 57.50000000000001, 283.0, 228.0, 364.4, 317.1999999999998, 169.39999999999995, 281.20000000000044, 257.79999999999984, 325.2999999999996, 263.79999999999984, 365.1, 250.4999999999998, 202.69999999999973, 145.79999999999995, 283.5999999999999, 383.79999999999995, 219.1999999999996, 308.6999999999997, 297.39999999999964, 194.0, 305.0, 357.0, 323.4999999999997, 288.39999999999986, 312.6, 260.79999999999984, 295.8000000000005, -34.10000000000012, 191.8, 266.0999999999999, 363.19999999999993, 244.4000000000001, 362.70000000000016, 312.8, 337.0, 284.60000000000014, 325.7, 215.0, 278.0, 232.49999999999972, 181.59999999999997, 338.3999999999999, 380.70000000000005, 347.80000000000007, 307.19999999999993, 198.89999999999984, 295.2, 326.40000000000015, 145.50000000000006, 345.10000000000025, 350.5000000000003, 177.29999999999993, 227.5999999999999, 342.4000000000005, 276.0, 208.70000000000005, 282.4999999999999, 341.4999999999998, 305.99999999999994, 306.0, 239.0, 333.8000000000005, 359.49999999999983], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [163.99999999999997, 166.69999999999985, 182.9, 131.6, -88.0, 144.79999999999998, 186.49999999999997, 190.09999999999997, -295.0, 68.3, 176.0, 82.69999999999999, -13.900000000000006, 107.59999999999994, 74.90000000000003, 160.39999999999986, 170.0, 187.39999999999992, 172.09999999999988, 171.1999999999999, 164.3, 195.5, -118.0, 82.1, -35.50000000000004, -10.0, -257.79999999999995, -253.0, 78.5, 194.0, -107.80000000000001, 159.49999999999983, 118.70000000000005, 184.1, 133.39999999999995, 152.89999999999998, 146.0, 158.0, 174.0, 154.0, 159.0, 180.0, 148.0999999999998, 157.0999999999999, 186.5, 141.19999999999987, 140.3, 192.79999999999995, 144.20000000000005, 185.3, 68.6, -2.8000000000000824, 181.1, 173.89999999999998, -205.9, 11.899999999999999, -45.69999999999999, 77.3, 163.7, 131.2999999999998, 157.9999999999999, 34.999999999999986, -98.80000000000001, -309.7, 198.2, 67.70000000000003, 48.79999999999997, 180.19999999999987, 89.9, 102.80000000000001, 178.39999999999995, 152.6, 62.599999999999994, -272.8, -224.79999999999998, 134.29999999999976, 134.0, 71.0, -19.0, 163.0, 161.9, 195.5, 179.29999999999987, 119.9, 154.99999999999994, -76.60000000000002, 146.89999999999998, 134.29999999999993, 37.10000000000002, 175.69999999999996, 155.89999999999975, 169.39999999999995, 1.4000000000000057, 151.39999999999975, 167.29999999999998, 192.8, 154.0999999999998, 46.39999999999998, 57.2, 99.50000000000009, 138.19999999999987, -84.40000000000006, 147.7999999999998, 54.8, 183.79999999999998, 200.0, 140.89999999999995, 29.30000000000009, 113.0, 184.70000000000002, 135.19999999999965, 162.2, 9.0, 132.0, 160.0, 122.0, 198.2, 141.8, 156.8, 166.69999999999982, -8.199999999999996, 167.60000000000002, 163.39999999999998, 108.19999999999999, 186.49999999999994, 11.300000000000058, 165.1999999999999, 113.59999999999982, -15.100000000000023, -121.00000000000009, 164.0, -125.19999999999999, 140.60000000000002, 81.5, 163.69999999999985, 195.49999999999997, 116.00000000000003, 124.39999999999999, 197.29999999999998, 163.39999999999998, 200.0, 63.800000000000004, 174.8, 162.2, 104.59999999999997, 163.9999999999999, 157.09999999999997, 161.59999999999994, 3.0, 103.0, 162.0, 54.0, -26.499999999999936, 200.0, 88.4, 0.20000000000001705, 143.60000000000002, 177.79999999999993, 184.7, 194.0, 174.8, 149.0, 164.59999999999997, 134.59999999999988, 159.4999999999999, -67.6, 177.5, 79.7, 143.60000000000002, 174.79999999999995, -134.50000000000009, 173.00000000000003, 160.39999999999995, 184.69999999999996, 174.79999999999993, 175.69999999999996, -16.60000000000001, 119.89999999999995, 123.50000000000001, 40.1, 163.09999999999997, 179.29999999999993, 159.7999999999998, 72.2, 49.40000000000003, 80.30000000000001, 171.49999999999991, 68.0, 156.79999999999998, 184.69999999999993, 127.70000000000002, 149.3, 165.0, 120.0, 158.0, 12.0, 124.99999999999983, 192.8, 190.09999999999994, 169.39999999999986], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 9.0, 88.0, 89.0, 3.0, 0.0, 48.0, 165.0, 42.0, 3.0, 71.0, 21.0, 34.0, 24.0, 0.0, 7.0, 0.0, 0.0, 2.0, 2.0, 31.0, 138.0, 101.0, 12.0, 182.0, 2.0, 40.0, 2.0, 85.0, 85.0, 13.0, 21.0, 10.0, 11.0, 3.0, 0.0, 12.0, 12.0, 0.0, 0.0, 4.0, 2.0, 0.0, 4.0, 13.0, 7.0, 0.0, 1.0, 80.0, 70.0, 0.0, 0.0, 130.0, 43.0, 24.0, 108.0, 7.0, 1.0, 19.0, 30.0, 8.0, 176.0, 12.0, 24.0, 17.0, 39.0, 31.0, 52.0, 1.0, 7.0, 157.0, 0.0, 141.0, 7.0, 35.0, 43.0, 72.0, 12.0, 4.0, 3.0, 18.0, 0.0, 91.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 0.0, 63.0, 48.0, 4.0, 1.0, 50.0, 0.0, 32.0, 14.0, 2.0, 90.0, 40.0, 41.0, 0.0, 0.0, 0.0, 49.0, 0.0, 11.0, 0.0, 0.0, 53.0, 0.0, 11.0, 12.0, 2.0, 15.0, 0.0, 0.0, 62.0, 67.0, 19.0, 22.0, 41.0, 22.0, 5.0, 12.0, 0.0, 102.0, 97.0, 56.0, 35.0, 9.0, 4.0, 0.0, 2.0, 2.0, 2.0, 0.0, 6.0, 43.0, 0.0, 0.0, 4.0, 12.0, 7.0, 0.0, 57.0, 52.0, 36.0, 26.0, 0.0, 59.0, 57.0, 36.0, 10.0, 7.0, 0.0, 2.0, 7.0, 17.0, 2.0, 6.0, 82.0, 25.0, 0.0, 38.0, 8.0, 0.0, 107.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 71.0, 21.0, 43.0, 0.0, 0.0, 42.0, 2.0, 40.0, 39.0, 10.0, 33.0, 0.0, 0.0, 13.0, 16.0, 10.0, 11.0, 62.0, 7.0, 4.0, 12.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6466377595175499, "mean_inference_ms": 4.834780500973321, "mean_action_processing_ms": 0.8289906703610588, "mean_env_wait_ms": 0.5565838147410878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012230634689331055, "StateBufferConnector_ms": 0.007375240325927734, "ViewRequirementAgentConnector_ms": 0.21463751792907715}, "num_episodes": 22, "episode_return_max": 383.79999999999995, "episode_return_min": -326.79999999999995, "episode_return_mean": 260.078, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 179.6257590407515, "num_env_steps_trained_throughput_per_sec": 179.6257590407515, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 864000, "timers": {"training_iteration_time_ms": 29391.751, "restore_workers_time_ms": 0.029, "training_step_time_ms": 29391.678, "sample_time_ms": 4711.821, "learn_time_ms": 24626.641, "learn_throughput": 162.426, "synch_weights_time_ms": 41.211}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 864000, "num_agent_steps_trained": 864000}, "done": false, "training_iteration": 54, "trial_id": "e4caa_00000", "date": "2024-08-13_20-05-21", "timestamp": 1723593921, "time_this_iter_s": 22.353243827819824, "time_total_s": 1256.3855454921722, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29584c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1256.3855454921722, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 85.371875, "ram_util_percent": 83.696875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3686035117144306, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 6.166711196192988, "policy_loss": -0.013411477424460586, "vf_loss": 6.178269977670498, "vf_explained_var": 0.17241579306819452, "kl": 0.012351386560602043, "entropy": 1.4998614642985915, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.500889197638426, "cur_kl_coeff": 1.9073486328125e-07, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3690918609263405, "policy_loss": -0.005114445557926225, "vf_loss": 1.3742063051178341, "vf_explained_var": 0.018200854491935207, "kl": 0.0023178197075474304, "entropy": 0.14397956236960396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 103005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 383.79999999999995, "episode_reward_min": -224.50000000000003, "episode_reward_mean": 268.50499999999994, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -309.7, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 176.0}, "policy_reward_mean": {"prey_policy": 111.68249999999996, "predator_policy": 22.57}, "custom_metrics": {}, "hist_stats": {"episode_reward": [353.0999999999999, 330.4999999999998, 215.7999999999999, 355.00000000000006, -21.000000000000007, 163.6, 303.00000000000006, 241.99999999999983, -224.50000000000003, 301.8999999999999, 285.00000000000057, 275.69999999999993, 339.00000000000017, -53.2, 57.50000000000001, 283.0, 228.0, 364.4, 317.1999999999998, 169.39999999999995, 281.20000000000044, 257.79999999999984, 325.2999999999996, 263.79999999999984, 365.1, 250.4999999999998, 202.69999999999973, 145.79999999999995, 283.5999999999999, 383.79999999999995, 219.1999999999996, 308.6999999999997, 297.39999999999964, 194.0, 305.0, 357.0, 323.4999999999997, 288.39999999999986, 312.6, 260.79999999999984, 295.8000000000005, -34.10000000000012, 191.8, 266.0999999999999, 363.19999999999993, 244.4000000000001, 362.70000000000016, 312.8, 337.0, 284.60000000000014, 325.7, 215.0, 278.0, 232.49999999999972, 181.59999999999997, 338.3999999999999, 380.70000000000005, 347.80000000000007, 307.19999999999993, 198.89999999999984, 295.2, 326.40000000000015, 145.50000000000006, 345.10000000000025, 350.5000000000003, 177.29999999999993, 227.5999999999999, 342.4000000000005, 276.0, 208.70000000000005, 282.4999999999999, 341.4999999999998, 305.99999999999994, 306.0, 239.0, 333.8000000000005, 359.49999999999983, 320.8000000000002, 268.9000000000004, 348.6, 352.30000000000007, 314.5000000000004, 288.39999999999986, 283.70000000000005, 372.90000000000026, 369.80000000000007, 319.89999999999986, 336.5000000000004, 200.99999999999994, 282.0999999999996, 326.5, 305.5000000000001, 263.09999999999985, 308.5, -71.0, 262.0, 257.0, 271.69999999999993, 323.10000000000014, 340.0000000000002], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [140.3, 192.79999999999995, 144.20000000000005, 185.3, 68.6, -2.8000000000000824, 181.1, 173.89999999999998, -205.9, 11.899999999999999, -45.69999999999999, 77.3, 163.7, 131.2999999999998, 157.9999999999999, 34.999999999999986, -98.80000000000001, -309.7, 198.2, 67.70000000000003, 48.79999999999997, 180.19999999999987, 89.9, 102.80000000000001, 178.39999999999995, 152.6, 62.599999999999994, -272.8, -224.79999999999998, 134.29999999999976, 134.0, 71.0, -19.0, 163.0, 161.9, 195.5, 179.29999999999987, 119.9, 154.99999999999994, -76.60000000000002, 146.89999999999998, 134.29999999999993, 37.10000000000002, 175.69999999999996, 155.89999999999975, 169.39999999999995, 1.4000000000000057, 151.39999999999975, 167.29999999999998, 192.8, 154.0999999999998, 46.39999999999998, 57.2, 99.50000000000009, 138.19999999999987, -84.40000000000006, 147.7999999999998, 54.8, 183.79999999999998, 200.0, 140.89999999999995, 29.30000000000009, 113.0, 184.70000000000002, 135.19999999999965, 162.2, 9.0, 132.0, 160.0, 122.0, 198.2, 141.8, 156.8, 166.69999999999982, -8.199999999999996, 167.60000000000002, 163.39999999999998, 108.19999999999999, 186.49999999999994, 11.300000000000058, 165.1999999999999, 113.59999999999982, -15.100000000000023, -121.00000000000009, 164.0, -125.19999999999999, 140.60000000000002, 81.5, 163.69999999999985, 195.49999999999997, 116.00000000000003, 124.39999999999999, 197.29999999999998, 163.39999999999998, 200.0, 63.800000000000004, 174.8, 162.2, 104.59999999999997, 163.9999999999999, 157.09999999999997, 161.59999999999994, 3.0, 103.0, 162.0, 54.0, -26.499999999999936, 200.0, 88.4, 0.20000000000001705, 143.60000000000002, 177.79999999999993, 184.7, 194.0, 174.8, 149.0, 164.59999999999997, 134.59999999999988, 159.4999999999999, -67.6, 177.5, 79.7, 143.60000000000002, 174.79999999999995, -134.50000000000009, 173.00000000000003, 160.39999999999995, 184.69999999999996, 174.79999999999993, 175.69999999999996, -16.60000000000001, 119.89999999999995, 123.50000000000001, 40.1, 163.09999999999997, 179.29999999999993, 159.7999999999998, 72.2, 49.40000000000003, 80.30000000000001, 171.49999999999991, 68.0, 156.79999999999998, 184.69999999999993, 127.70000000000002, 149.3, 165.0, 120.0, 158.0, 12.0, 124.99999999999983, 192.8, 190.09999999999994, 169.39999999999986, 160.39999999999995, 160.39999999999998, 73.0999999999998, 165.79999999999978, 155.6, 176.0, 161.29999999999987, 191.0, 136.99999999999977, 177.49999999999997, 116.0, 118.40000000000003, 101.89999999999995, 147.79999999999995, 167.89999999999995, 200.0, 172.09999999999997, 190.69999999999996, 150.5, 169.3999999999999, 154.9999999999998, 174.49999999999997, -2.199999999999994, 108.2, 138.19999999999993, 128.89999999999992, 152.3, 153.19999999999993, 156.79999999999998, 148.69999999999993, 127.99999999999986, 70.1, 144.8, 124.7, -268.0, 18.0, 111.0, 151.0, 60.0, 156.0, 52.10000000000001, 110.59999999999985, 142.39999999999992, 157.7, 182.89999999999992, 154.1], "policy_predator_policy_reward": [13.0, 7.0, 0.0, 1.0, 80.0, 70.0, 0.0, 0.0, 130.0, 43.0, 24.0, 108.0, 7.0, 1.0, 19.0, 30.0, 8.0, 176.0, 12.0, 24.0, 17.0, 39.0, 31.0, 52.0, 1.0, 7.0, 157.0, 0.0, 141.0, 7.0, 35.0, 43.0, 72.0, 12.0, 4.0, 3.0, 18.0, 0.0, 91.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 0.0, 63.0, 48.0, 4.0, 1.0, 50.0, 0.0, 32.0, 14.0, 2.0, 90.0, 40.0, 41.0, 0.0, 0.0, 0.0, 49.0, 0.0, 11.0, 0.0, 0.0, 53.0, 0.0, 11.0, 12.0, 2.0, 15.0, 0.0, 0.0, 62.0, 67.0, 19.0, 22.0, 41.0, 22.0, 5.0, 12.0, 0.0, 102.0, 97.0, 56.0, 35.0, 9.0, 4.0, 0.0, 2.0, 2.0, 2.0, 0.0, 6.0, 43.0, 0.0, 0.0, 4.0, 12.0, 7.0, 0.0, 57.0, 52.0, 36.0, 26.0, 0.0, 59.0, 57.0, 36.0, 10.0, 7.0, 0.0, 2.0, 7.0, 17.0, 2.0, 6.0, 82.0, 25.0, 0.0, 38.0, 8.0, 0.0, 107.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 71.0, 21.0, 43.0, 0.0, 0.0, 42.0, 2.0, 40.0, 39.0, 10.0, 33.0, 0.0, 0.0, 13.0, 16.0, 10.0, 11.0, 62.0, 7.0, 4.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 12.0, 5.0, 0.0, 0.0, 0.0, 0.0, 13.0, 41.0, 4.0, 30.0, 1.0, 4.0, 6.0, 1.0, 0.0, 0.0, 7.0, 0.0, 64.0, 31.0, 2.0, 13.0, 6.0, 15.0, 0.0, 0.0, 43.0, 22.0, 23.0, 16.0, 53.0, 126.0, 0.0, 0.0, 22.0, 19.0, 48.0, 61.0, 13.0, 10.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6550013320756827, "mean_inference_ms": 4.872114505247861, "mean_action_processing_ms": 0.8315594915639177, "mean_env_wait_ms": 0.5627014106007214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007573366165161133, "StateBufferConnector_ms": 0.01479184627532959, "ViewRequirementAgentConnector_ms": 0.19798600673675537}, "num_episodes": 23, "episode_return_max": 383.79999999999995, "episode_return_min": -224.50000000000003, "episode_return_mean": 268.50499999999994, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 172.062955873276, "num_env_steps_trained_throughput_per_sec": 172.062955873276, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 28004.47, "restore_workers_time_ms": 0.029, "training_step_time_ms": 28004.396, "sample_time_ms": 4670.514, "learn_time_ms": 23291.843, "learn_throughput": 171.734, "synch_weights_time_ms": 30.261}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 55, "trial_id": "e4caa_00000", "date": "2024-08-13_20-05-44", "timestamp": 1723593944, "time_this_iter_s": 23.419352054595947, "time_total_s": 1279.8048975467682, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29583a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1279.8048975467682, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 90.98181818181818, "ram_util_percent": 83.62727272727274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4485225512552513, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8374246286967444, "policy_loss": -0.004074573362241228, "vf_loss": 3.8406264062911744, "vf_explained_var": 0.1600170342379777, "kl": 0.0058186907804810215, "entropy": 1.4973749093908482, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5465482878937293, "cur_kl_coeff": 9.5367431640625e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5420762091402023, "policy_loss": -0.0038920616819745017, "vf_loss": 1.5459682700179873, "vf_explained_var": 0.0375113843610047, "kl": 0.0034607371623707646, "entropy": 0.13704623689569492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 104895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "env_runners": {"episode_reward_max": 388.3, "episode_reward_min": -71.0, "episode_reward_mean": 290.341, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -268.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 126.0}, "policy_reward_mean": {"prey_policy": 127.20049999999998, "predator_policy": 17.97}, "custom_metrics": {}, "hist_stats": {"episode_reward": [317.1999999999998, 169.39999999999995, 281.20000000000044, 257.79999999999984, 325.2999999999996, 263.79999999999984, 365.1, 250.4999999999998, 202.69999999999973, 145.79999999999995, 283.5999999999999, 383.79999999999995, 219.1999999999996, 308.6999999999997, 297.39999999999964, 194.0, 305.0, 357.0, 323.4999999999997, 288.39999999999986, 312.6, 260.79999999999984, 295.8000000000005, -34.10000000000012, 191.8, 266.0999999999999, 363.19999999999993, 244.4000000000001, 362.70000000000016, 312.8, 337.0, 284.60000000000014, 325.7, 215.0, 278.0, 232.49999999999972, 181.59999999999997, 338.3999999999999, 380.70000000000005, 347.80000000000007, 307.19999999999993, 198.89999999999984, 295.2, 326.40000000000015, 145.50000000000006, 345.10000000000025, 350.5000000000003, 177.29999999999993, 227.5999999999999, 342.4000000000005, 276.0, 208.70000000000005, 282.4999999999999, 341.4999999999998, 305.99999999999994, 306.0, 239.0, 333.8000000000005, 359.49999999999983, 320.8000000000002, 268.9000000000004, 348.6, 352.30000000000007, 314.5000000000004, 288.39999999999986, 283.70000000000005, 372.90000000000026, 369.80000000000007, 319.89999999999986, 336.5000000000004, 200.99999999999994, 282.0999999999996, 326.5, 305.5000000000001, 263.09999999999985, 308.5, -71.0, 262.0, 257.0, 271.69999999999993, 323.10000000000014, 340.0000000000002, 343.0999999999999, 383.79999999999995, 364.0999999999999, 380.0, 207.39999999999998, 317.59999999999985, 357.2, 373.9000000000002, 388.3, 367.6000000000001, 308.5, 291.5999999999999, 382.5, 343.5999999999999, 288.0, 232.0, 291.9, 361.29999999999995], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [179.29999999999987, 119.9, 154.99999999999994, -76.60000000000002, 146.89999999999998, 134.29999999999993, 37.10000000000002, 175.69999999999996, 155.89999999999975, 169.39999999999995, 1.4000000000000057, 151.39999999999975, 167.29999999999998, 192.8, 154.0999999999998, 46.39999999999998, 57.2, 99.50000000000009, 138.19999999999987, -84.40000000000006, 147.7999999999998, 54.8, 183.79999999999998, 200.0, 140.89999999999995, 29.30000000000009, 113.0, 184.70000000000002, 135.19999999999965, 162.2, 9.0, 132.0, 160.0, 122.0, 198.2, 141.8, 156.8, 166.69999999999982, -8.199999999999996, 167.60000000000002, 163.39999999999998, 108.19999999999999, 186.49999999999994, 11.300000000000058, 165.1999999999999, 113.59999999999982, -15.100000000000023, -121.00000000000009, 164.0, -125.19999999999999, 140.60000000000002, 81.5, 163.69999999999985, 195.49999999999997, 116.00000000000003, 124.39999999999999, 197.29999999999998, 163.39999999999998, 200.0, 63.800000000000004, 174.8, 162.2, 104.59999999999997, 163.9999999999999, 157.09999999999997, 161.59999999999994, 3.0, 103.0, 162.0, 54.0, -26.499999999999936, 200.0, 88.4, 0.20000000000001705, 143.60000000000002, 177.79999999999993, 184.7, 194.0, 174.8, 149.0, 164.59999999999997, 134.59999999999988, 159.4999999999999, -67.6, 177.5, 79.7, 143.60000000000002, 174.79999999999995, -134.50000000000009, 173.00000000000003, 160.39999999999995, 184.69999999999996, 174.79999999999993, 175.69999999999996, -16.60000000000001, 119.89999999999995, 123.50000000000001, 40.1, 163.09999999999997, 179.29999999999993, 159.7999999999998, 72.2, 49.40000000000003, 80.30000000000001, 171.49999999999991, 68.0, 156.79999999999998, 184.69999999999993, 127.70000000000002, 149.3, 165.0, 120.0, 158.0, 12.0, 124.99999999999983, 192.8, 190.09999999999994, 169.39999999999986, 160.39999999999995, 160.39999999999998, 73.0999999999998, 165.79999999999978, 155.6, 176.0, 161.29999999999987, 191.0, 136.99999999999977, 177.49999999999997, 116.0, 118.40000000000003, 101.89999999999995, 147.79999999999995, 167.89999999999995, 200.0, 172.09999999999997, 190.69999999999996, 150.5, 169.3999999999999, 154.9999999999998, 174.49999999999997, -2.199999999999994, 108.2, 138.19999999999993, 128.89999999999992, 152.3, 153.19999999999993, 156.79999999999998, 148.69999999999993, 127.99999999999986, 70.1, 144.8, 124.7, -268.0, 18.0, 111.0, 151.0, 60.0, 156.0, 52.10000000000001, 110.59999999999985, 142.39999999999992, 157.7, 182.89999999999992, 154.1, 180.2, 152.89999999999998, 188.29999999999995, 195.5, 182.60000000000002, 174.49999999999997, 191.6, 187.39999999999998, 164.9, -71.50000000000003, 172.3999999999999, 120.20000000000002, 165.8, 169.4, 180.2, 193.69999999999996, 192.8, 195.5, 167.59999999999985, 200.0, 153.5, 122.0, 128.60000000000002, 125.0, 186.8, 193.69999999999996, 156.19999999999993, 175.39999999999998, 44.0, 181.0, 14.0, 144.0, 83.60000000000002, 164.29999999999998, 169.4, 182.89999999999992], "policy_predator_policy_reward": [18.0, 0.0, 91.0, 0.0, 0.0, 0.0, 0.0, 45.0, 0.0, 0.0, 63.0, 48.0, 4.0, 1.0, 50.0, 0.0, 32.0, 14.0, 2.0, 90.0, 40.0, 41.0, 0.0, 0.0, 0.0, 49.0, 0.0, 11.0, 0.0, 0.0, 53.0, 0.0, 11.0, 12.0, 2.0, 15.0, 0.0, 0.0, 62.0, 67.0, 19.0, 22.0, 41.0, 22.0, 5.0, 12.0, 0.0, 102.0, 97.0, 56.0, 35.0, 9.0, 4.0, 0.0, 2.0, 2.0, 2.0, 0.0, 6.0, 43.0, 0.0, 0.0, 4.0, 12.0, 7.0, 0.0, 57.0, 52.0, 36.0, 26.0, 0.0, 59.0, 57.0, 36.0, 10.0, 7.0, 0.0, 2.0, 7.0, 17.0, 2.0, 6.0, 82.0, 25.0, 0.0, 38.0, 8.0, 0.0, 107.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 71.0, 21.0, 43.0, 0.0, 0.0, 42.0, 2.0, 40.0, 39.0, 10.0, 33.0, 0.0, 0.0, 13.0, 16.0, 10.0, 11.0, 62.0, 7.0, 4.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 12.0, 5.0, 0.0, 0.0, 0.0, 0.0, 13.0, 41.0, 4.0, 30.0, 1.0, 4.0, 6.0, 1.0, 0.0, 0.0, 7.0, 0.0, 64.0, 31.0, 2.0, 13.0, 6.0, 15.0, 0.0, 0.0, 43.0, 22.0, 23.0, 16.0, 53.0, 126.0, 0.0, 0.0, 22.0, 19.0, 48.0, 61.0, 13.0, 10.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 78.0, 36.0, 0.0, 25.0, 7.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 6.0, 36.0, 2.0, 0.0, 2.0, 11.0, 1.0, 34.0, 29.0, 61.0, 13.0, 38.0, 6.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6625582930124978, "mean_inference_ms": 4.904865658622339, "mean_action_processing_ms": 0.833938236435473, "mean_env_wait_ms": 0.5679048640856418, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00795900821685791, "StateBufferConnector_ms": 0.018687963485717773, "ViewRequirementAgentConnector_ms": 0.20968937873840332}, "num_episodes": 18, "episode_return_max": 388.3, "episode_return_min": -71.0, "episode_return_mean": 290.341, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 146.35887841114211, "num_env_steps_trained_throughput_per_sec": 146.35887841114211, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 896000, "timers": {"training_iteration_time_ms": 27964.869, "restore_workers_time_ms": 0.028, "training_step_time_ms": 27964.791, "sample_time_ms": 4535.6, "learn_time_ms": 23384.654, "learn_throughput": 171.052, "synch_weights_time_ms": 33.801}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 896000, "num_agent_steps_trained": 896000}, "done": false, "training_iteration": 56, "trial_id": "e4caa_00000", "date": "2024-08-13_20-06-12", "timestamp": 1723593972, "time_this_iter_s": 27.60730004310608, "time_total_s": 1307.4121975898743, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b282f9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1307.4121975898743, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 93.72307692307693, "ram_util_percent": 83.53076923076924}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.082401201397023, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.815184208829567, "policy_loss": -0.0015915550160955972, "vf_loss": 3.815784732500712, "vf_explained_var": 0.10221483568665843, "kl": 0.006606883371800584, "entropy": 1.518466288828976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8610004357402288, "cur_kl_coeff": 4.76837158203125e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4215105917403308, "policy_loss": -0.004017096524811769, "vf_loss": 1.4255276858175874, "vf_explained_var": 0.051350201437712975, "kl": 0.0018915054981052176, "entropy": 0.11869815494963731, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 106785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "env_runners": {"episode_reward_max": 388.4, "episode_reward_min": -71.0, "episode_reward_mean": 297.00300000000004, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -268.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 126.0}, "policy_reward_mean": {"prey_policy": 131.06149999999997, "predator_policy": 17.44}, "custom_metrics": {}, "hist_stats": {"episode_reward": [323.4999999999997, 288.39999999999986, 312.6, 260.79999999999984, 295.8000000000005, -34.10000000000012, 191.8, 266.0999999999999, 363.19999999999993, 244.4000000000001, 362.70000000000016, 312.8, 337.0, 284.60000000000014, 325.7, 215.0, 278.0, 232.49999999999972, 181.59999999999997, 338.3999999999999, 380.70000000000005, 347.80000000000007, 307.19999999999993, 198.89999999999984, 295.2, 326.40000000000015, 145.50000000000006, 345.10000000000025, 350.5000000000003, 177.29999999999993, 227.5999999999999, 342.4000000000005, 276.0, 208.70000000000005, 282.4999999999999, 341.4999999999998, 305.99999999999994, 306.0, 239.0, 333.8000000000005, 359.49999999999983, 320.8000000000002, 268.9000000000004, 348.6, 352.30000000000007, 314.5000000000004, 288.39999999999986, 283.70000000000005, 372.90000000000026, 369.80000000000007, 319.89999999999986, 336.5000000000004, 200.99999999999994, 282.0999999999996, 326.5, 305.5000000000001, 263.09999999999985, 308.5, -71.0, 262.0, 257.0, 271.69999999999993, 323.10000000000014, 340.0000000000002, 343.0999999999999, 383.79999999999995, 364.0999999999999, 380.0, 207.39999999999998, 317.59999999999985, 357.2, 373.9000000000002, 388.3, 367.6000000000001, 308.5, 291.5999999999999, 382.5, 343.5999999999999, 288.0, 232.0, 291.9, 361.29999999999995, 275.79999999999984, 374.79999999999995, 323.2999999999999, 347.10000000000025, 186.19999999999987, 296.9000000000001, 388.4, 294.4, 343.80000000000007, 364.50000000000006, 312.3, 295.2000000000003, 283.0999999999999, 308.2, 333.0, 381.0, 267.7999999999998, 217.89999999999995], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [156.8, 166.69999999999982, -8.199999999999996, 167.60000000000002, 163.39999999999998, 108.19999999999999, 186.49999999999994, 11.300000000000058, 165.1999999999999, 113.59999999999982, -15.100000000000023, -121.00000000000009, 164.0, -125.19999999999999, 140.60000000000002, 81.5, 163.69999999999985, 195.49999999999997, 116.00000000000003, 124.39999999999999, 197.29999999999998, 163.39999999999998, 200.0, 63.800000000000004, 174.8, 162.2, 104.59999999999997, 163.9999999999999, 157.09999999999997, 161.59999999999994, 3.0, 103.0, 162.0, 54.0, -26.499999999999936, 200.0, 88.4, 0.20000000000001705, 143.60000000000002, 177.79999999999993, 184.7, 194.0, 174.8, 149.0, 164.59999999999997, 134.59999999999988, 159.4999999999999, -67.6, 177.5, 79.7, 143.60000000000002, 174.79999999999995, -134.50000000000009, 173.00000000000003, 160.39999999999995, 184.69999999999996, 174.79999999999993, 175.69999999999996, -16.60000000000001, 119.89999999999995, 123.50000000000001, 40.1, 163.09999999999997, 179.29999999999993, 159.7999999999998, 72.2, 49.40000000000003, 80.30000000000001, 171.49999999999991, 68.0, 156.79999999999998, 184.69999999999993, 127.70000000000002, 149.3, 165.0, 120.0, 158.0, 12.0, 124.99999999999983, 192.8, 190.09999999999994, 169.39999999999986, 160.39999999999995, 160.39999999999998, 73.0999999999998, 165.79999999999978, 155.6, 176.0, 161.29999999999987, 191.0, 136.99999999999977, 177.49999999999997, 116.0, 118.40000000000003, 101.89999999999995, 147.79999999999995, 167.89999999999995, 200.0, 172.09999999999997, 190.69999999999996, 150.5, 169.3999999999999, 154.9999999999998, 174.49999999999997, -2.199999999999994, 108.2, 138.19999999999993, 128.89999999999992, 152.3, 153.19999999999993, 156.79999999999998, 148.69999999999993, 127.99999999999986, 70.1, 144.8, 124.7, -268.0, 18.0, 111.0, 151.0, 60.0, 156.0, 52.10000000000001, 110.59999999999985, 142.39999999999992, 157.7, 182.89999999999992, 154.1, 180.2, 152.89999999999998, 188.29999999999995, 195.5, 182.60000000000002, 174.49999999999997, 191.6, 187.39999999999998, 164.9, -71.50000000000003, 172.3999999999999, 120.20000000000002, 165.8, 169.4, 180.2, 193.69999999999996, 192.8, 195.5, 167.59999999999985, 200.0, 153.5, 122.0, 128.60000000000002, 125.0, 186.8, 193.69999999999996, 156.19999999999993, 175.39999999999998, 44.0, 181.0, 14.0, 144.0, 83.60000000000002, 164.29999999999998, 169.4, 182.89999999999992, 181.69999999999996, 49.10000000000001, 188.29999999999998, 186.5, 160.7, 116.6, 148.99999999999991, 190.1, -13.900000000000006, 115.09999999999987, 64.69999999999997, 189.2, 198.2, 186.2, 98.30000000000001, 154.1, 192.49999999999997, 131.3, 190.4, 172.09999999999997, 163.4, 116.9, 49.100000000000016, 199.1, 92.6, 150.49999999999994, 198.2, 65.0, 181.0, 128.0, 200.0, 172.0, 134.5999999999998, 81.2, 101.9, 74.0], "policy_predator_policy_reward": [0.0, 0.0, 62.0, 67.0, 19.0, 22.0, 41.0, 22.0, 5.0, 12.0, 0.0, 102.0, 97.0, 56.0, 35.0, 9.0, 4.0, 0.0, 2.0, 2.0, 2.0, 0.0, 6.0, 43.0, 0.0, 0.0, 4.0, 12.0, 7.0, 0.0, 57.0, 52.0, 36.0, 26.0, 0.0, 59.0, 57.0, 36.0, 10.0, 7.0, 0.0, 2.0, 7.0, 17.0, 2.0, 6.0, 82.0, 25.0, 0.0, 38.0, 8.0, 0.0, 107.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 71.0, 21.0, 43.0, 0.0, 0.0, 42.0, 2.0, 40.0, 39.0, 10.0, 33.0, 0.0, 0.0, 13.0, 16.0, 10.0, 11.0, 62.0, 7.0, 4.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 12.0, 5.0, 0.0, 0.0, 0.0, 0.0, 13.0, 41.0, 4.0, 30.0, 1.0, 4.0, 6.0, 1.0, 0.0, 0.0, 7.0, 0.0, 64.0, 31.0, 2.0, 13.0, 6.0, 15.0, 0.0, 0.0, 43.0, 22.0, 23.0, 16.0, 53.0, 126.0, 0.0, 0.0, 22.0, 19.0, 48.0, 61.0, 13.0, 10.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 78.0, 36.0, 0.0, 25.0, 7.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 6.0, 36.0, 2.0, 0.0, 2.0, 11.0, 1.0, 34.0, 29.0, 61.0, 13.0, 38.0, 6.0, 0.0, 9.0, 0.0, 45.0, 0.0, 0.0, 30.0, 16.0, 8.0, 0.0, 62.0, 23.0, 40.0, 3.0, 4.0, 0.0, 33.0, 9.0, 20.0, 0.0, 0.0, 2.0, 28.0, 4.0, 0.0, 47.0, 6.0, 34.0, 10.0, 35.0, 17.0, 7.0, 9.0, 0.0, 2.0, 50.0, 0.0, 42.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6683870745163767, "mean_inference_ms": 4.931852022486953, "mean_action_processing_ms": 0.8357471879447371, "mean_env_wait_ms": 0.5721316262472828, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007763385772705078, "StateBufferConnector_ms": 0.01872551441192627, "ViewRequirementAgentConnector_ms": 0.23994982242584229}, "num_episodes": 18, "episode_return_max": 388.4, "episode_return_min": -71.0, "episode_return_mean": 297.00300000000004, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 176.6987288703343, "num_env_steps_trained_throughput_per_sec": 176.6987288703343, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 912000, "timers": {"training_iteration_time_ms": 27138.467, "restore_workers_time_ms": 0.028, "training_step_time_ms": 27138.391, "sample_time_ms": 4256.289, "learn_time_ms": 22842.694, "learn_throughput": 175.111, "synch_weights_time_ms": 32.727}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 912000, "num_agent_steps_trained": 912000}, "done": false, "training_iteration": 57, "trial_id": "e4caa_00000", "date": "2024-08-13_20-06-35", "timestamp": 1723593995, "time_this_iter_s": 22.707037210464478, "time_total_s": 1330.1192348003387, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28869d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1330.1192348003387, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 87.978125, "ram_util_percent": 82.665625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.3870943420463138, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.323402557991169, "policy_loss": -0.007995224318826797, "vf_loss": 3.3300149254067235, "vf_explained_var": 0.12118314488854988, "kl": 0.009218982099633512, "entropy": 1.4895758587216574, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0675024008151714, "cur_kl_coeff": 2.384185791015625e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1427800676179312, "policy_loss": -0.002458520291038055, "vf_loss": 1.1452385866610462, "vf_explained_var": 0.03909203804359234, "kl": 0.002601668041392635, "entropy": 0.13882427668129957, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 108675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "env_runners": {"episode_reward_max": 388.4, "episode_reward_min": -71.0, "episode_reward_mean": 307.899, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -268.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 126.0}, "policy_reward_mean": {"prey_policy": 138.14449999999997, "predator_policy": 15.805}, "custom_metrics": {}, "hist_stats": {"episode_reward": [307.19999999999993, 198.89999999999984, 295.2, 326.40000000000015, 145.50000000000006, 345.10000000000025, 350.5000000000003, 177.29999999999993, 227.5999999999999, 342.4000000000005, 276.0, 208.70000000000005, 282.4999999999999, 341.4999999999998, 305.99999999999994, 306.0, 239.0, 333.8000000000005, 359.49999999999983, 320.8000000000002, 268.9000000000004, 348.6, 352.30000000000007, 314.5000000000004, 288.39999999999986, 283.70000000000005, 372.90000000000026, 369.80000000000007, 319.89999999999986, 336.5000000000004, 200.99999999999994, 282.0999999999996, 326.5, 305.5000000000001, 263.09999999999985, 308.5, -71.0, 262.0, 257.0, 271.69999999999993, 323.10000000000014, 340.0000000000002, 343.0999999999999, 383.79999999999995, 364.0999999999999, 380.0, 207.39999999999998, 317.59999999999985, 357.2, 373.9000000000002, 388.3, 367.6000000000001, 308.5, 291.5999999999999, 382.5, 343.5999999999999, 288.0, 232.0, 291.9, 361.29999999999995, 275.79999999999984, 374.79999999999995, 323.2999999999999, 347.10000000000025, 186.19999999999987, 296.9000000000001, 388.4, 294.4, 343.80000000000007, 364.50000000000006, 312.3, 295.2000000000003, 283.0999999999999, 308.2, 333.0, 381.0, 267.7999999999998, 217.89999999999995, 265.0, 378.4000000000002, 286.0999999999999, 329.8000000000002, 334.40000000000003, 335.5000000000001, 377.50000000000045, 319.1, 324.0000000000002, 278.09999999999997, 332.4, 256.6999999999998, 363.79999999999995, 358.1, 324.1, 368.5, 314.79999999999995, 280.0000000000002, 310.0, 355.0, 353.3000000000002, 354.2999999999999], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [164.59999999999997, 134.59999999999988, 159.4999999999999, -67.6, 177.5, 79.7, 143.60000000000002, 174.79999999999995, -134.50000000000009, 173.00000000000003, 160.39999999999995, 184.69999999999996, 174.79999999999993, 175.69999999999996, -16.60000000000001, 119.89999999999995, 123.50000000000001, 40.1, 163.09999999999997, 179.29999999999993, 159.7999999999998, 72.2, 49.40000000000003, 80.30000000000001, 171.49999999999991, 68.0, 156.79999999999998, 184.69999999999993, 127.70000000000002, 149.3, 165.0, 120.0, 158.0, 12.0, 124.99999999999983, 192.8, 190.09999999999994, 169.39999999999986, 160.39999999999995, 160.39999999999998, 73.0999999999998, 165.79999999999978, 155.6, 176.0, 161.29999999999987, 191.0, 136.99999999999977, 177.49999999999997, 116.0, 118.40000000000003, 101.89999999999995, 147.79999999999995, 167.89999999999995, 200.0, 172.09999999999997, 190.69999999999996, 150.5, 169.3999999999999, 154.9999999999998, 174.49999999999997, -2.199999999999994, 108.2, 138.19999999999993, 128.89999999999992, 152.3, 153.19999999999993, 156.79999999999998, 148.69999999999993, 127.99999999999986, 70.1, 144.8, 124.7, -268.0, 18.0, 111.0, 151.0, 60.0, 156.0, 52.10000000000001, 110.59999999999985, 142.39999999999992, 157.7, 182.89999999999992, 154.1, 180.2, 152.89999999999998, 188.29999999999995, 195.5, 182.60000000000002, 174.49999999999997, 191.6, 187.39999999999998, 164.9, -71.50000000000003, 172.3999999999999, 120.20000000000002, 165.8, 169.4, 180.2, 193.69999999999996, 192.8, 195.5, 167.59999999999985, 200.0, 153.5, 122.0, 128.60000000000002, 125.0, 186.8, 193.69999999999996, 156.19999999999993, 175.39999999999998, 44.0, 181.0, 14.0, 144.0, 83.60000000000002, 164.29999999999998, 169.4, 182.89999999999992, 181.69999999999996, 49.10000000000001, 188.29999999999998, 186.5, 160.7, 116.6, 148.99999999999991, 190.1, -13.900000000000006, 115.09999999999987, 64.69999999999997, 189.2, 198.2, 186.2, 98.30000000000001, 154.1, 192.49999999999997, 131.3, 190.4, 172.09999999999997, 163.4, 116.9, 49.100000000000016, 199.1, 92.6, 150.49999999999994, 198.2, 65.0, 181.0, 128.0, 200.0, 172.0, 134.5999999999998, 81.2, 101.9, 74.0, 5.600000000000001, 196.4, 181.99999999999994, 196.4, 64.10000000000002, 179.0, 191.9, 119.89999999999992, 191.0, 121.4, 172.09999999999997, 121.4, 196.39999999999998, 181.0999999999999, 95.3, 192.79999999999995, 186.49999999999994, 108.5, 38.0, 181.09999999999997, 187.1, 77.3, 173.89999999999992, 36.800000000000026, 188.29999999999998, 165.5, 194.0, 124.1, 110.89999999999995, 189.20000000000002, 198.2, 161.29999999999995, 156.79999999999995, 133.99999999999997, 187.39999999999992, 41.6, 178.0, 71.0, 184.0, 171.0, 145.09999999999997, 189.2, 184.1, 159.19999999999993], "policy_predator_policy_reward": [2.0, 6.0, 82.0, 25.0, 0.0, 38.0, 8.0, 0.0, 107.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 71.0, 21.0, 43.0, 0.0, 0.0, 42.0, 2.0, 40.0, 39.0, 10.0, 33.0, 0.0, 0.0, 13.0, 16.0, 10.0, 11.0, 62.0, 7.0, 4.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 12.0, 5.0, 0.0, 0.0, 0.0, 0.0, 13.0, 41.0, 4.0, 30.0, 1.0, 4.0, 6.0, 1.0, 0.0, 0.0, 7.0, 0.0, 64.0, 31.0, 2.0, 13.0, 6.0, 15.0, 0.0, 0.0, 43.0, 22.0, 23.0, 16.0, 53.0, 126.0, 0.0, 0.0, 22.0, 19.0, 48.0, 61.0, 13.0, 10.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 78.0, 36.0, 0.0, 25.0, 7.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 6.0, 36.0, 2.0, 0.0, 2.0, 11.0, 1.0, 34.0, 29.0, 61.0, 13.0, 38.0, 6.0, 0.0, 9.0, 0.0, 45.0, 0.0, 0.0, 30.0, 16.0, 8.0, 0.0, 62.0, 23.0, 40.0, 3.0, 4.0, 0.0, 33.0, 9.0, 20.0, 0.0, 0.0, 2.0, 28.0, 4.0, 0.0, 47.0, 6.0, 34.0, 10.0, 35.0, 17.0, 7.0, 9.0, 0.0, 2.0, 50.0, 0.0, 42.0, 33.0, 30.0, 0.0, 0.0, 43.0, 0.0, 18.0, 0.0, 0.0, 22.0, 22.0, 20.0, 0.0, 0.0, 31.0, 0.0, 29.0, 0.0, 5.0, 54.0, 31.0, 37.0, 0.0, 46.0, 0.0, 10.0, 16.0, 24.0, 24.0, 0.0, 0.0, 9.0, 7.0, 17.0, 51.0, 0.0, 26.0, 35.0, 0.0, 0.0, 9.0, 10.0, 5.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.66814567829096, "mean_inference_ms": 4.928118873384397, "mean_action_processing_ms": 0.8310572625264159, "mean_env_wait_ms": 0.5721112928000235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007678389549255371, "StateBufferConnector_ms": 0.016124606132507324, "ViewRequirementAgentConnector_ms": 0.27211952209472656}, "num_episodes": 22, "episode_return_max": 388.4, "episode_return_min": -71.0, "episode_return_mean": 307.899, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 160.63964875396627, "num_env_steps_trained_throughput_per_sec": 160.63964875396627, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 928000, "timers": {"training_iteration_time_ms": 26994.186, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26994.11, "sample_time_ms": 4111.334, "learn_time_ms": 22844.283, "learn_throughput": 175.099, "synch_weights_time_ms": 32.044}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 928000, "num_agent_steps_trained": 928000}, "done": false, "training_iteration": 58, "trial_id": "e4caa_00000", "date": "2024-08-13_20-07-00", "timestamp": 1723594020, "time_this_iter_s": 24.974334955215454, "time_total_s": 1355.0935697555542, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b296e4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1355.0935697555542, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 87.59444444444445, "ram_util_percent": 83.18333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1437675455259897, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.7039952895628714, "policy_loss": -0.005300910907018949, "vf_loss": 2.707915590175245, "vf_explained_var": 0.132587680520204, "kl": 0.009204117622120325, "entropy": 1.491530191898346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5577529838555073, "cur_kl_coeff": 1.1920928955078126e-08, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8283455092124838, "policy_loss": -0.0017272201563827891, "vf_loss": 0.8300727287455211, "vf_explained_var": 0.10144596068316666, "kl": 0.002050030425923682, "entropy": 0.107507425727983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 110565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "env_runners": {"episode_reward_max": 388.4, "episode_reward_min": -71.0, "episode_reward_mean": 319.691, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -268.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 126.0}, "policy_reward_mean": {"prey_policy": 146.06549999999996, "predator_policy": 13.78}, "custom_metrics": {}, "hist_stats": {"episode_reward": [359.49999999999983, 320.8000000000002, 268.9000000000004, 348.6, 352.30000000000007, 314.5000000000004, 288.39999999999986, 283.70000000000005, 372.90000000000026, 369.80000000000007, 319.89999999999986, 336.5000000000004, 200.99999999999994, 282.0999999999996, 326.5, 305.5000000000001, 263.09999999999985, 308.5, -71.0, 262.0, 257.0, 271.69999999999993, 323.10000000000014, 340.0000000000002, 343.0999999999999, 383.79999999999995, 364.0999999999999, 380.0, 207.39999999999998, 317.59999999999985, 357.2, 373.9000000000002, 388.3, 367.6000000000001, 308.5, 291.5999999999999, 382.5, 343.5999999999999, 288.0, 232.0, 291.9, 361.29999999999995, 275.79999999999984, 374.79999999999995, 323.2999999999999, 347.10000000000025, 186.19999999999987, 296.9000000000001, 388.4, 294.4, 343.80000000000007, 364.50000000000006, 312.3, 295.2000000000003, 283.0999999999999, 308.2, 333.0, 381.0, 267.7999999999998, 217.89999999999995, 265.0, 378.4000000000002, 286.0999999999999, 329.8000000000002, 334.40000000000003, 335.5000000000001, 377.50000000000045, 319.1, 324.0000000000002, 278.09999999999997, 332.4, 256.6999999999998, 363.79999999999995, 358.1, 324.1, 368.5, 314.79999999999995, 280.0000000000002, 310.0, 355.0, 353.3000000000002, 354.2999999999999, 341.6, 353.4, 368.70000000000005, 382.00000000000006, 358.5999999999999, 229.39999999999998, 277.0000000000001, 367.1, 315.8, 329.1, 329.59999999999997, 372.0999999999999, 375.50000000000017, 351.0000000000001, 317.0, 386.0, 368.1000000000002, 366.8], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [190.09999999999994, 169.39999999999986, 160.39999999999995, 160.39999999999998, 73.0999999999998, 165.79999999999978, 155.6, 176.0, 161.29999999999987, 191.0, 136.99999999999977, 177.49999999999997, 116.0, 118.40000000000003, 101.89999999999995, 147.79999999999995, 167.89999999999995, 200.0, 172.09999999999997, 190.69999999999996, 150.5, 169.3999999999999, 154.9999999999998, 174.49999999999997, -2.199999999999994, 108.2, 138.19999999999993, 128.89999999999992, 152.3, 153.19999999999993, 156.79999999999998, 148.69999999999993, 127.99999999999986, 70.1, 144.8, 124.7, -268.0, 18.0, 111.0, 151.0, 60.0, 156.0, 52.10000000000001, 110.59999999999985, 142.39999999999992, 157.7, 182.89999999999992, 154.1, 180.2, 152.89999999999998, 188.29999999999995, 195.5, 182.60000000000002, 174.49999999999997, 191.6, 187.39999999999998, 164.9, -71.50000000000003, 172.3999999999999, 120.20000000000002, 165.8, 169.4, 180.2, 193.69999999999996, 192.8, 195.5, 167.59999999999985, 200.0, 153.5, 122.0, 128.60000000000002, 125.0, 186.8, 193.69999999999996, 156.19999999999993, 175.39999999999998, 44.0, 181.0, 14.0, 144.0, 83.60000000000002, 164.29999999999998, 169.4, 182.89999999999992, 181.69999999999996, 49.10000000000001, 188.29999999999998, 186.5, 160.7, 116.6, 148.99999999999991, 190.1, -13.900000000000006, 115.09999999999987, 64.69999999999997, 189.2, 198.2, 186.2, 98.30000000000001, 154.1, 192.49999999999997, 131.3, 190.4, 172.09999999999997, 163.4, 116.9, 49.100000000000016, 199.1, 92.6, 150.49999999999994, 198.2, 65.0, 181.0, 128.0, 200.0, 172.0, 134.5999999999998, 81.2, 101.9, 74.0, 5.600000000000001, 196.4, 181.99999999999994, 196.4, 64.10000000000002, 179.0, 191.9, 119.89999999999992, 191.0, 121.4, 172.09999999999997, 121.4, 196.39999999999998, 181.0999999999999, 95.3, 192.79999999999995, 186.49999999999994, 108.5, 38.0, 181.09999999999997, 187.1, 77.3, 173.89999999999992, 36.800000000000026, 188.29999999999998, 165.5, 194.0, 124.1, 110.89999999999995, 189.20000000000002, 198.2, 161.29999999999995, 156.79999999999995, 133.99999999999997, 187.39999999999992, 41.6, 178.0, 71.0, 184.0, 171.0, 145.09999999999997, 189.2, 184.1, 159.19999999999993, 164.0, 164.59999999999997, 152.0, 184.39999999999998, 163.1, 185.6, 191.89999999999998, 190.1, 182.89999999999998, 166.69999999999996, 83.0, 94.39999999999999, 141.2, 96.79999999999995, 179.9, 180.2, 128.90000000000003, 164.89999999999992, 115.1, 179.0, 176.59999999999997, 122.0, 192.79999999999995, 179.3, 199.1, 163.39999999999995, 178.39999999999998, 161.6, 180.0, 116.0, 196.0, 190.0, 197.29999999999998, 168.79999999999995, 186.5, 170.3], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 12.0, 5.0, 0.0, 0.0, 0.0, 0.0, 13.0, 41.0, 4.0, 30.0, 1.0, 4.0, 6.0, 1.0, 0.0, 0.0, 7.0, 0.0, 64.0, 31.0, 2.0, 13.0, 6.0, 15.0, 0.0, 0.0, 43.0, 22.0, 23.0, 16.0, 53.0, 126.0, 0.0, 0.0, 22.0, 19.0, 48.0, 61.0, 13.0, 10.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 78.0, 36.0, 0.0, 25.0, 7.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 6.0, 36.0, 2.0, 0.0, 2.0, 11.0, 1.0, 34.0, 29.0, 61.0, 13.0, 38.0, 6.0, 0.0, 9.0, 0.0, 45.0, 0.0, 0.0, 30.0, 16.0, 8.0, 0.0, 62.0, 23.0, 40.0, 3.0, 4.0, 0.0, 33.0, 9.0, 20.0, 0.0, 0.0, 2.0, 28.0, 4.0, 0.0, 47.0, 6.0, 34.0, 10.0, 35.0, 17.0, 7.0, 9.0, 0.0, 2.0, 50.0, 0.0, 42.0, 33.0, 30.0, 0.0, 0.0, 43.0, 0.0, 18.0, 0.0, 0.0, 22.0, 22.0, 20.0, 0.0, 0.0, 31.0, 0.0, 29.0, 0.0, 5.0, 54.0, 31.0, 37.0, 0.0, 46.0, 0.0, 10.0, 16.0, 24.0, 24.0, 0.0, 0.0, 9.0, 7.0, 17.0, 51.0, 0.0, 26.0, 35.0, 0.0, 0.0, 9.0, 10.0, 5.0, 6.0, 5.0, 8.0, 0.0, 17.0, 12.0, 8.0, 0.0, 0.0, 9.0, 0.0, 0.0, 52.0, 5.0, 34.0, 1.0, 6.0, 13.0, 9.0, 16.0, 19.0, 7.0, 24.0, 0.0, 0.0, 5.0, 8.0, 11.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 2.0, 5.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.662271681587548, "mean_inference_ms": 4.920699056813393, "mean_action_processing_ms": 0.8277808814044773, "mean_env_wait_ms": 0.5710568219221861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006346225738525391, "StateBufferConnector_ms": 0.015500187873840332, "ViewRequirementAgentConnector_ms": 0.2600637674331665}, "num_episodes": 18, "episode_return_max": 388.4, "episode_return_min": -71.0, "episode_return_mean": 319.691, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 179.1557064196781, "num_env_steps_trained_throughput_per_sec": 179.1557064196781, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 944000, "timers": {"training_iteration_time_ms": 26693.997, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26693.921, "sample_time_ms": 4102.601, "learn_time_ms": 22552.058, "learn_throughput": 177.367, "synch_weights_time_ms": 32.264}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 944000, "num_agent_steps_trained": 944000}, "done": false, "training_iteration": 59, "trial_id": "e4caa_00000", "date": "2024-08-13_20-07-22", "timestamp": 1723594042, "time_this_iter_s": 22.4968478679657, "time_total_s": 1377.59041762352, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b296eee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1377.59041762352, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 86.009375, "ram_util_percent": 83.771875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9358536947025824, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.677073271880074, "policy_loss": -0.006023788560556356, "vf_loss": 2.681924843346631, "vf_explained_var": 0.15353118834041413, "kl": 0.00781474763848444, "entropy": 1.5050838637604285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2043159720916596, "cur_kl_coeff": 5.960464477539063e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5986140273629673, "policy_loss": -0.005110263885750322, "vf_loss": 0.6037242923838594, "vf_explained_var": 0.1978936564039301, "kl": 0.0013299312053835378, "entropy": 0.11212509049782678, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 112455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 391.90000000000003, "episode_reward_min": 186.19999999999987, "episode_reward_mean": 334.172, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -71.50000000000003, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 78.0}, "policy_reward_mean": {"prey_policy": 155.50599999999997, "predator_policy": 11.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [340.0000000000002, 343.0999999999999, 383.79999999999995, 364.0999999999999, 380.0, 207.39999999999998, 317.59999999999985, 357.2, 373.9000000000002, 388.3, 367.6000000000001, 308.5, 291.5999999999999, 382.5, 343.5999999999999, 288.0, 232.0, 291.9, 361.29999999999995, 275.79999999999984, 374.79999999999995, 323.2999999999999, 347.10000000000025, 186.19999999999987, 296.9000000000001, 388.4, 294.4, 343.80000000000007, 364.50000000000006, 312.3, 295.2000000000003, 283.0999999999999, 308.2, 333.0, 381.0, 267.7999999999998, 217.89999999999995, 265.0, 378.4000000000002, 286.0999999999999, 329.8000000000002, 334.40000000000003, 335.5000000000001, 377.50000000000045, 319.1, 324.0000000000002, 278.09999999999997, 332.4, 256.6999999999998, 363.79999999999995, 358.1, 324.1, 368.5, 314.79999999999995, 280.0000000000002, 310.0, 355.0, 353.3000000000002, 354.2999999999999, 341.6, 353.4, 368.70000000000005, 382.00000000000006, 358.5999999999999, 229.39999999999998, 277.0000000000001, 367.1, 315.8, 329.1, 329.59999999999997, 372.0999999999999, 375.50000000000017, 351.0000000000001, 317.0, 386.0, 368.1000000000002, 366.8, 382.9, 374.79999999999995, 377.49999999999994, 391.90000000000003, 360.6, 380.19999999999993, 370.8, 360.0, 345.7, 386.5, 345.8, 320.4, 379.7, 353.8000000000001, 322.80000000000035, 334.7, 338.79999999999995, 353.0, 338.0, 283.0, 313.4, 335.30000000000007, 363.8000000000001], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [182.89999999999992, 154.1, 180.2, 152.89999999999998, 188.29999999999995, 195.5, 182.60000000000002, 174.49999999999997, 191.6, 187.39999999999998, 164.9, -71.50000000000003, 172.3999999999999, 120.20000000000002, 165.8, 169.4, 180.2, 193.69999999999996, 192.8, 195.5, 167.59999999999985, 200.0, 153.5, 122.0, 128.60000000000002, 125.0, 186.8, 193.69999999999996, 156.19999999999993, 175.39999999999998, 44.0, 181.0, 14.0, 144.0, 83.60000000000002, 164.29999999999998, 169.4, 182.89999999999992, 181.69999999999996, 49.10000000000001, 188.29999999999998, 186.5, 160.7, 116.6, 148.99999999999991, 190.1, -13.900000000000006, 115.09999999999987, 64.69999999999997, 189.2, 198.2, 186.2, 98.30000000000001, 154.1, 192.49999999999997, 131.3, 190.4, 172.09999999999997, 163.4, 116.9, 49.100000000000016, 199.1, 92.6, 150.49999999999994, 198.2, 65.0, 181.0, 128.0, 200.0, 172.0, 134.5999999999998, 81.2, 101.9, 74.0, 5.600000000000001, 196.4, 181.99999999999994, 196.4, 64.10000000000002, 179.0, 191.9, 119.89999999999992, 191.0, 121.4, 172.09999999999997, 121.4, 196.39999999999998, 181.0999999999999, 95.3, 192.79999999999995, 186.49999999999994, 108.5, 38.0, 181.09999999999997, 187.1, 77.3, 173.89999999999992, 36.800000000000026, 188.29999999999998, 165.5, 194.0, 124.1, 110.89999999999995, 189.20000000000002, 198.2, 161.29999999999995, 156.79999999999995, 133.99999999999997, 187.39999999999992, 41.6, 178.0, 71.0, 184.0, 171.0, 145.09999999999997, 189.2, 184.1, 159.19999999999993, 164.0, 164.59999999999997, 152.0, 184.39999999999998, 163.1, 185.6, 191.89999999999998, 190.1, 182.89999999999998, 166.69999999999996, 83.0, 94.39999999999999, 141.2, 96.79999999999995, 179.9, 180.2, 128.90000000000003, 164.89999999999992, 115.1, 179.0, 176.59999999999997, 122.0, 192.79999999999995, 179.3, 199.1, 163.39999999999995, 178.39999999999998, 161.6, 180.0, 116.0, 196.0, 190.0, 197.29999999999998, 168.79999999999995, 186.5, 170.3, 199.1, 183.79999999999995, 189.19999999999993, 185.6, 185.6, 191.89999999999995, 192.8, 199.1, 148.1, 195.49999999999997, 190.99999999999997, 189.2, 200.0, 159.8, 167.9, 187.1, 173.0, 148.7, 186.5, 200.0, 142.1, 193.7, 160.39999999999998, 125.0, 193.4, 179.3, 150.79999999999995, 191.0, 112.6999999999999, 184.09999999999997, 130.69999999999993, 181.99999999999997, 118.1, 193.7, 181.0, 157.0, 162.0, 160.0, 86.0, 165.0, 141.49999999999997, 134.9, 188.3, 142.99999999999997, 182.59999999999997, 180.2], "policy_predator_policy_reward": [0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 7.0, 1.0, 0.0, 78.0, 36.0, 0.0, 25.0, 7.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 6.0, 36.0, 2.0, 0.0, 2.0, 11.0, 1.0, 34.0, 29.0, 61.0, 13.0, 38.0, 6.0, 0.0, 9.0, 0.0, 45.0, 0.0, 0.0, 30.0, 16.0, 8.0, 0.0, 62.0, 23.0, 40.0, 3.0, 4.0, 0.0, 33.0, 9.0, 20.0, 0.0, 0.0, 2.0, 28.0, 4.0, 0.0, 47.0, 6.0, 34.0, 10.0, 35.0, 17.0, 7.0, 9.0, 0.0, 2.0, 50.0, 0.0, 42.0, 33.0, 30.0, 0.0, 0.0, 43.0, 0.0, 18.0, 0.0, 0.0, 22.0, 22.0, 20.0, 0.0, 0.0, 31.0, 0.0, 29.0, 0.0, 5.0, 54.0, 31.0, 37.0, 0.0, 46.0, 0.0, 10.0, 16.0, 24.0, 24.0, 0.0, 0.0, 9.0, 7.0, 17.0, 51.0, 0.0, 26.0, 35.0, 0.0, 0.0, 9.0, 10.0, 5.0, 6.0, 5.0, 8.0, 0.0, 17.0, 12.0, 8.0, 0.0, 0.0, 9.0, 0.0, 0.0, 52.0, 5.0, 34.0, 1.0, 6.0, 13.0, 9.0, 16.0, 19.0, 7.0, 24.0, 0.0, 0.0, 5.0, 8.0, 11.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 2.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 5.0, 6.0, 18.0, 0.0, 0.0, 10.0, 0.0, 14.0, 21.0, 1.0, 6.0, 6.0, 6.0, 24.0, 2.0, 4.0, 18.0, 0.0, 27.0, 15.0, 0.0, 16.0, 0.0, 32.0, 0.0, 23.0, 14.0, 0.0, 4.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6592877365049603, "mean_inference_ms": 4.911253455997132, "mean_action_processing_ms": 0.822146674880925, "mean_env_wait_ms": 0.5697161030988324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007236361503601074, "StateBufferConnector_ms": 0.009770035743713379, "ViewRequirementAgentConnector_ms": 0.32046008110046387}, "num_episodes": 23, "episode_return_max": 391.90000000000003, "episode_return_min": 186.19999999999987, "episode_return_mean": 334.172, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 191.63899110252305, "num_env_steps_trained_throughput_per_sec": 191.63899110252305, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 26854.466, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26854.389, "sample_time_ms": 4141.826, "learn_time_ms": 22669.166, "learn_throughput": 176.451, "synch_weights_time_ms": 37.088}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 60, "trial_id": "e4caa_00000", "date": "2024-08-13_20-07-44", "timestamp": 1723594064, "time_this_iter_s": 21.248970985412598, "time_total_s": 1398.8393886089325, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2863550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1398.8393886089325, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 82.92999999999999, "ram_util_percent": 83.54}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7833758920273453, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4539681468691144, "policy_loss": -0.007584337354391301, "vf_loss": 3.459351438946194, "vf_explained_var": 0.05196150553920282, "kl": 0.014673663792206292, "entropy": 1.5027397340567654, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.79015788095338, "cur_kl_coeff": 2.9802322387695314e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7750528775510335, "policy_loss": -0.003021813443955527, "vf_loss": 1.7780746955089468, "vf_explained_var": 0.21470087378744096, "kl": 0.0015652081028451543, "entropy": 0.10783437485732729, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 114345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "env_runners": {"episode_reward_max": 395.1, "episode_reward_min": 186.19999999999987, "episode_reward_mean": 333.29699999999997, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -13.900000000000006, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 62.0}, "policy_reward_mean": {"prey_policy": 154.65849999999998, "predator_policy": 11.99}, "custom_metrics": {}, "hist_stats": {"episode_reward": [361.29999999999995, 275.79999999999984, 374.79999999999995, 323.2999999999999, 347.10000000000025, 186.19999999999987, 296.9000000000001, 388.4, 294.4, 343.80000000000007, 364.50000000000006, 312.3, 295.2000000000003, 283.0999999999999, 308.2, 333.0, 381.0, 267.7999999999998, 217.89999999999995, 265.0, 378.4000000000002, 286.0999999999999, 329.8000000000002, 334.40000000000003, 335.5000000000001, 377.50000000000045, 319.1, 324.0000000000002, 278.09999999999997, 332.4, 256.6999999999998, 363.79999999999995, 358.1, 324.1, 368.5, 314.79999999999995, 280.0000000000002, 310.0, 355.0, 353.3000000000002, 354.2999999999999, 341.6, 353.4, 368.70000000000005, 382.00000000000006, 358.5999999999999, 229.39999999999998, 277.0000000000001, 367.1, 315.8, 329.1, 329.59999999999997, 372.0999999999999, 375.50000000000017, 351.0000000000001, 317.0, 386.0, 368.1000000000002, 366.8, 382.9, 374.79999999999995, 377.49999999999994, 391.90000000000003, 360.6, 380.19999999999993, 370.8, 360.0, 345.7, 386.5, 345.8, 320.4, 379.7, 353.8000000000001, 322.80000000000035, 334.7, 338.79999999999995, 353.0, 338.0, 283.0, 313.4, 335.30000000000007, 363.8000000000001, 351.4000000000001, 322.1000000000001, 277.3, 355.5, 348.39999999999986, 291.4, 369.3, 338.1, 291.5, 357.69999999999993, 365.89999999999986, 320.79999999999995, 367.60000000000025, 240.1, 308.0, 261.0, 312.4, 395.1], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [169.4, 182.89999999999992, 181.69999999999996, 49.10000000000001, 188.29999999999998, 186.5, 160.7, 116.6, 148.99999999999991, 190.1, -13.900000000000006, 115.09999999999987, 64.69999999999997, 189.2, 198.2, 186.2, 98.30000000000001, 154.1, 192.49999999999997, 131.3, 190.4, 172.09999999999997, 163.4, 116.9, 49.100000000000016, 199.1, 92.6, 150.49999999999994, 198.2, 65.0, 181.0, 128.0, 200.0, 172.0, 134.5999999999998, 81.2, 101.9, 74.0, 5.600000000000001, 196.4, 181.99999999999994, 196.4, 64.10000000000002, 179.0, 191.9, 119.89999999999992, 191.0, 121.4, 172.09999999999997, 121.4, 196.39999999999998, 181.0999999999999, 95.3, 192.79999999999995, 186.49999999999994, 108.5, 38.0, 181.09999999999997, 187.1, 77.3, 173.89999999999992, 36.800000000000026, 188.29999999999998, 165.5, 194.0, 124.1, 110.89999999999995, 189.20000000000002, 198.2, 161.29999999999995, 156.79999999999995, 133.99999999999997, 187.39999999999992, 41.6, 178.0, 71.0, 184.0, 171.0, 145.09999999999997, 189.2, 184.1, 159.19999999999993, 164.0, 164.59999999999997, 152.0, 184.39999999999998, 163.1, 185.6, 191.89999999999998, 190.1, 182.89999999999998, 166.69999999999996, 83.0, 94.39999999999999, 141.2, 96.79999999999995, 179.9, 180.2, 128.90000000000003, 164.89999999999992, 115.1, 179.0, 176.59999999999997, 122.0, 192.79999999999995, 179.3, 199.1, 163.39999999999995, 178.39999999999998, 161.6, 180.0, 116.0, 196.0, 190.0, 197.29999999999998, 168.79999999999995, 186.5, 170.3, 199.1, 183.79999999999995, 189.19999999999993, 185.6, 185.6, 191.89999999999995, 192.8, 199.1, 148.1, 195.49999999999997, 190.99999999999997, 189.2, 200.0, 159.8, 167.9, 187.1, 173.0, 148.7, 186.5, 200.0, 142.1, 193.7, 160.39999999999998, 125.0, 193.4, 179.3, 150.79999999999995, 191.0, 112.6999999999999, 184.09999999999997, 130.69999999999993, 181.99999999999997, 118.1, 193.7, 181.0, 157.0, 162.0, 160.0, 86.0, 165.0, 141.49999999999997, 134.9, 188.3, 142.99999999999997, 182.59999999999997, 180.2, 162.19999999999996, 180.2, 110.3, 177.79999999999998, 131.3, 86.0, 197.29999999999998, 138.2, 170.0, 166.3999999999999, 101.29999999999998, 142.1, 199.1, 156.2, 180.2, 137.9, 93.79999999999998, 157.7, 178.39999999999992, 149.3, 175.1, 174.7999999999999, 118.1, 175.7, 196.4, 162.19999999999993, 142.1, 47.0, 170.0, 103.0, 189.0, 11.0, 199.1, 71.3, 199.1, 194.0], "policy_predator_policy_reward": [0.0, 9.0, 0.0, 45.0, 0.0, 0.0, 30.0, 16.0, 8.0, 0.0, 62.0, 23.0, 40.0, 3.0, 4.0, 0.0, 33.0, 9.0, 20.0, 0.0, 0.0, 2.0, 28.0, 4.0, 0.0, 47.0, 6.0, 34.0, 10.0, 35.0, 17.0, 7.0, 9.0, 0.0, 2.0, 50.0, 0.0, 42.0, 33.0, 30.0, 0.0, 0.0, 43.0, 0.0, 18.0, 0.0, 0.0, 22.0, 22.0, 20.0, 0.0, 0.0, 31.0, 0.0, 29.0, 0.0, 5.0, 54.0, 31.0, 37.0, 0.0, 46.0, 0.0, 10.0, 16.0, 24.0, 24.0, 0.0, 0.0, 9.0, 7.0, 17.0, 51.0, 0.0, 26.0, 35.0, 0.0, 0.0, 9.0, 10.0, 5.0, 6.0, 5.0, 8.0, 0.0, 17.0, 12.0, 8.0, 0.0, 0.0, 9.0, 0.0, 0.0, 52.0, 5.0, 34.0, 1.0, 6.0, 13.0, 9.0, 16.0, 19.0, 7.0, 24.0, 0.0, 0.0, 5.0, 8.0, 11.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 2.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 5.0, 6.0, 18.0, 0.0, 0.0, 10.0, 0.0, 14.0, 21.0, 1.0, 6.0, 6.0, 6.0, 24.0, 2.0, 4.0, 18.0, 0.0, 27.0, 15.0, 0.0, 16.0, 0.0, 32.0, 0.0, 23.0, 14.0, 0.0, 4.0, 1.0, 0.0, 0.0, 9.0, 29.0, 5.0, 38.0, 22.0, 20.0, 0.0, 2.0, 10.0, 35.0, 13.0, 0.0, 14.0, 0.0, 20.0, 1.0, 39.0, 16.0, 14.0, 8.0, 8.0, 23.0, 4.0, 9.0, 0.0, 51.0, 0.0, 8.0, 27.0, 6.0, 55.0, 42.0, 0.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6567201370465165, "mean_inference_ms": 4.904069239365637, "mean_action_processing_ms": 0.818391500215081, "mean_env_wait_ms": 0.5687363108092376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005951404571533203, "StateBufferConnector_ms": 0.008778929710388184, "ViewRequirementAgentConnector_ms": 0.31542396545410156}, "num_episodes": 18, "episode_return_max": 395.1, "episode_return_min": 186.19999999999987, "episode_return_mean": 333.29699999999997, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 149.6077157315575, "num_env_steps_trained_throughput_per_sec": 149.6077157315575, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 976000, "timers": {"training_iteration_time_ms": 25525.961, "restore_workers_time_ms": 0.028, "training_step_time_ms": 25525.883, "sample_time_ms": 4273.692, "learn_time_ms": 21209.278, "learn_throughput": 188.597, "synch_weights_time_ms": 36.415}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 976000, "num_agent_steps_trained": 976000}, "done": false, "training_iteration": 61, "trial_id": "e4caa_00000", "date": "2024-08-13_20-08-11", "timestamp": 1723594091, "time_this_iter_s": 26.866356134414673, "time_total_s": 1425.7057447433472, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2886940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1425.7057447433472, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 89.85000000000001, "ram_util_percent": 83.64999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8710225437368666, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.353167032501685, "policy_loss": -0.008118250833641955, "vf_loss": 2.360018574560761, "vf_explained_var": 0.21173401705171696, "kl": 0.008444661295655187, "entropy": 1.4902965368417205, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4906900366856939, "cur_kl_coeff": 1.4901161193847657e-09, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7684184286802535, "policy_loss": -0.003465078599386351, "vf_loss": 0.7718835066205689, "vf_explained_var": 0.14977690432437513, "kl": 0.0031679803954407487, "entropy": 0.10069196146158944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 116235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "env_runners": {"episode_reward_max": 395.1, "episode_reward_min": 217.89999999999995, "episode_reward_mean": 338.40399999999994, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 5.600000000000001, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 55.0}, "policy_reward_mean": {"prey_policy": 158.23699999999997, "predator_policy": 10.965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [217.89999999999995, 265.0, 378.4000000000002, 286.0999999999999, 329.8000000000002, 334.40000000000003, 335.5000000000001, 377.50000000000045, 319.1, 324.0000000000002, 278.09999999999997, 332.4, 256.6999999999998, 363.79999999999995, 358.1, 324.1, 368.5, 314.79999999999995, 280.0000000000002, 310.0, 355.0, 353.3000000000002, 354.2999999999999, 341.6, 353.4, 368.70000000000005, 382.00000000000006, 358.5999999999999, 229.39999999999998, 277.0000000000001, 367.1, 315.8, 329.1, 329.59999999999997, 372.0999999999999, 375.50000000000017, 351.0000000000001, 317.0, 386.0, 368.1000000000002, 366.8, 382.9, 374.79999999999995, 377.49999999999994, 391.90000000000003, 360.6, 380.19999999999993, 370.8, 360.0, 345.7, 386.5, 345.8, 320.4, 379.7, 353.8000000000001, 322.80000000000035, 334.7, 338.79999999999995, 353.0, 338.0, 283.0, 313.4, 335.30000000000007, 363.8000000000001, 351.4000000000001, 322.1000000000001, 277.3, 355.5, 348.39999999999986, 291.4, 369.3, 338.1, 291.5, 357.69999999999993, 365.89999999999986, 320.79999999999995, 367.60000000000025, 240.1, 308.0, 261.0, 312.4, 395.1, 332.40000000000003, 331.1, 361.4000000000002, 335.6, 393.7, 325.10000000000014, 365.1, 333.5, 354.9, 381.79999999999995, 382.9, 324.9, 293.30000000000007, 302.9, 378.0, 354.0, 319.7, 377.5], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [101.9, 74.0, 5.600000000000001, 196.4, 181.99999999999994, 196.4, 64.10000000000002, 179.0, 191.9, 119.89999999999992, 191.0, 121.4, 172.09999999999997, 121.4, 196.39999999999998, 181.0999999999999, 95.3, 192.79999999999995, 186.49999999999994, 108.5, 38.0, 181.09999999999997, 187.1, 77.3, 173.89999999999992, 36.800000000000026, 188.29999999999998, 165.5, 194.0, 124.1, 110.89999999999995, 189.20000000000002, 198.2, 161.29999999999995, 156.79999999999995, 133.99999999999997, 187.39999999999992, 41.6, 178.0, 71.0, 184.0, 171.0, 145.09999999999997, 189.2, 184.1, 159.19999999999993, 164.0, 164.59999999999997, 152.0, 184.39999999999998, 163.1, 185.6, 191.89999999999998, 190.1, 182.89999999999998, 166.69999999999996, 83.0, 94.39999999999999, 141.2, 96.79999999999995, 179.9, 180.2, 128.90000000000003, 164.89999999999992, 115.1, 179.0, 176.59999999999997, 122.0, 192.79999999999995, 179.3, 199.1, 163.39999999999995, 178.39999999999998, 161.6, 180.0, 116.0, 196.0, 190.0, 197.29999999999998, 168.79999999999995, 186.5, 170.3, 199.1, 183.79999999999995, 189.19999999999993, 185.6, 185.6, 191.89999999999995, 192.8, 199.1, 148.1, 195.49999999999997, 190.99999999999997, 189.2, 200.0, 159.8, 167.9, 187.1, 173.0, 148.7, 186.5, 200.0, 142.1, 193.7, 160.39999999999998, 125.0, 193.4, 179.3, 150.79999999999995, 191.0, 112.6999999999999, 184.09999999999997, 130.69999999999993, 181.99999999999997, 118.1, 193.7, 181.0, 157.0, 162.0, 160.0, 86.0, 165.0, 141.49999999999997, 134.9, 188.3, 142.99999999999997, 182.59999999999997, 180.2, 162.19999999999996, 180.2, 110.3, 177.79999999999998, 131.3, 86.0, 197.29999999999998, 138.2, 170.0, 166.3999999999999, 101.29999999999998, 142.1, 199.1, 156.2, 180.2, 137.9, 93.79999999999998, 157.7, 178.39999999999992, 149.3, 175.1, 174.7999999999999, 118.1, 175.7, 196.4, 162.19999999999993, 142.1, 47.0, 170.0, 103.0, 189.0, 11.0, 199.1, 71.3, 199.1, 194.0, 102.19999999999999, 198.2, 127.1, 161.0, 174.49999999999994, 182.9, 172.4, 138.2, 200.0, 193.7, 124.99999999999997, 178.1, 185.6, 171.5, 162.5, 158.0, 198.2, 151.7, 197.29999999999998, 168.5, 193.69999999999996, 189.2, 128.3, 176.59999999999997, 80.0, 170.29999999999998, 72.80000000000001, 190.1, 170.0, 200.0, 149.0, 188.0, 107.0, 175.69999999999996, 165.2, 197.3], "policy_predator_policy_reward": [0.0, 42.0, 33.0, 30.0, 0.0, 0.0, 43.0, 0.0, 18.0, 0.0, 0.0, 22.0, 22.0, 20.0, 0.0, 0.0, 31.0, 0.0, 29.0, 0.0, 5.0, 54.0, 31.0, 37.0, 0.0, 46.0, 0.0, 10.0, 16.0, 24.0, 24.0, 0.0, 0.0, 9.0, 7.0, 17.0, 51.0, 0.0, 26.0, 35.0, 0.0, 0.0, 9.0, 10.0, 5.0, 6.0, 5.0, 8.0, 0.0, 17.0, 12.0, 8.0, 0.0, 0.0, 9.0, 0.0, 0.0, 52.0, 5.0, 34.0, 1.0, 6.0, 13.0, 9.0, 16.0, 19.0, 7.0, 24.0, 0.0, 0.0, 5.0, 8.0, 11.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 2.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 5.0, 6.0, 18.0, 0.0, 0.0, 10.0, 0.0, 14.0, 21.0, 1.0, 6.0, 6.0, 6.0, 24.0, 2.0, 4.0, 18.0, 0.0, 27.0, 15.0, 0.0, 16.0, 0.0, 32.0, 0.0, 23.0, 14.0, 0.0, 4.0, 1.0, 0.0, 0.0, 9.0, 29.0, 5.0, 38.0, 22.0, 20.0, 0.0, 2.0, 10.0, 35.0, 13.0, 0.0, 14.0, 0.0, 20.0, 1.0, 39.0, 16.0, 14.0, 8.0, 8.0, 23.0, 4.0, 9.0, 0.0, 51.0, 0.0, 8.0, 27.0, 6.0, 55.0, 42.0, 0.0, 2.0, 0.0, 32.0, 0.0, 19.0, 24.0, 4.0, 0.0, 5.0, 20.0, 0.0, 0.0, 1.0, 21.0, 1.0, 7.0, 13.0, 0.0, 5.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 20.0, 6.0, 37.0, 0.0, 40.0, 0.0, 8.0, 0.0, 17.0, 6.0, 31.0, 8.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6571063477687726, "mean_inference_ms": 4.9048643234535305, "mean_action_processing_ms": 0.8158498578303528, "mean_env_wait_ms": 0.5688451489176376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00659942626953125, "StateBufferConnector_ms": 0.008885383605957031, "ViewRequirementAgentConnector_ms": 0.30488312244415283}, "num_episodes": 18, "episode_return_max": 395.1, "episode_return_min": 217.89999999999995, "episode_return_mean": 338.40399999999994, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 132.4493971581369, "num_env_steps_trained_throughput_per_sec": 132.4493971581369, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 992000, "timers": {"training_iteration_time_ms": 25110.286, "restore_workers_time_ms": 0.017, "training_step_time_ms": 25110.221, "sample_time_ms": 4423.164, "learn_time_ms": 20646.185, "learn_throughput": 193.74, "synch_weights_time_ms": 36.125}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 992000, "num_agent_steps_trained": 992000}, "done": false, "training_iteration": 62, "trial_id": "e4caa_00000", "date": "2024-08-13_20-08-41", "timestamp": 1723594121, "time_this_iter_s": 30.32215189933777, "time_total_s": 1456.027896642685, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28790d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1456.027896642685, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 92.35238095238094, "ram_util_percent": 84.16904761904762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9970459136382614, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5378417766283428, "policy_loss": -0.00658508705544389, "vf_loss": 2.5432543147177924, "vf_explained_var": 0.06971364866488824, "kl": 0.007816975033466242, "entropy": 1.4792403656338888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7415957559511144, "cur_kl_coeff": 7.450580596923829e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.127281185117348, "policy_loss": -0.003797134641365754, "vf_loss": 1.1310783210254851, "vf_explained_var": 0.2118962634808172, "kl": 0.0031953502858867084, "entropy": 0.12115890567028333, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 118125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "env_runners": {"episode_reward_max": 395.1, "episode_reward_min": 229.39999999999998, "episode_reward_mean": 344.164, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 11.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 55.0}, "policy_reward_mean": {"prey_policy": 162.617, "predator_policy": 9.465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.2999999999999, 341.6, 353.4, 368.70000000000005, 382.00000000000006, 358.5999999999999, 229.39999999999998, 277.0000000000001, 367.1, 315.8, 329.1, 329.59999999999997, 372.0999999999999, 375.50000000000017, 351.0000000000001, 317.0, 386.0, 368.1000000000002, 366.8, 382.9, 374.79999999999995, 377.49999999999994, 391.90000000000003, 360.6, 380.19999999999993, 370.8, 360.0, 345.7, 386.5, 345.8, 320.4, 379.7, 353.8000000000001, 322.80000000000035, 334.7, 338.79999999999995, 353.0, 338.0, 283.0, 313.4, 335.30000000000007, 363.8000000000001, 351.4000000000001, 322.1000000000001, 277.3, 355.5, 348.39999999999986, 291.4, 369.3, 338.1, 291.5, 357.69999999999993, 365.89999999999986, 320.79999999999995, 367.60000000000025, 240.1, 308.0, 261.0, 312.4, 395.1, 332.40000000000003, 331.1, 361.4000000000002, 335.6, 393.7, 325.10000000000014, 365.1, 333.5, 354.9, 381.79999999999995, 382.9, 324.9, 293.30000000000007, 302.9, 378.0, 354.0, 319.7, 377.5, 384.70000000000005, 329.1, 312.2, 314.99999999999994, 342.7, 339.4000000000001, 359.3, 355.4, 375.70000000000005, 369.3999999999999, 356.9, 356.40000000000003, 326.9, 382.20000000000005, 340.7, 371.40000000000003, 299.70000000000005, 347.29999999999995, 376.0, 270.0, 365.6, 362.5000000000001], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [184.1, 159.19999999999993, 164.0, 164.59999999999997, 152.0, 184.39999999999998, 163.1, 185.6, 191.89999999999998, 190.1, 182.89999999999998, 166.69999999999996, 83.0, 94.39999999999999, 141.2, 96.79999999999995, 179.9, 180.2, 128.90000000000003, 164.89999999999992, 115.1, 179.0, 176.59999999999997, 122.0, 192.79999999999995, 179.3, 199.1, 163.39999999999995, 178.39999999999998, 161.6, 180.0, 116.0, 196.0, 190.0, 197.29999999999998, 168.79999999999995, 186.5, 170.3, 199.1, 183.79999999999995, 189.19999999999993, 185.6, 185.6, 191.89999999999995, 192.8, 199.1, 148.1, 195.49999999999997, 190.99999999999997, 189.2, 200.0, 159.8, 167.9, 187.1, 173.0, 148.7, 186.5, 200.0, 142.1, 193.7, 160.39999999999998, 125.0, 193.4, 179.3, 150.79999999999995, 191.0, 112.6999999999999, 184.09999999999997, 130.69999999999993, 181.99999999999997, 118.1, 193.7, 181.0, 157.0, 162.0, 160.0, 86.0, 165.0, 141.49999999999997, 134.9, 188.3, 142.99999999999997, 182.59999999999997, 180.2, 162.19999999999996, 180.2, 110.3, 177.79999999999998, 131.3, 86.0, 197.29999999999998, 138.2, 170.0, 166.3999999999999, 101.29999999999998, 142.1, 199.1, 156.2, 180.2, 137.9, 93.79999999999998, 157.7, 178.39999999999992, 149.3, 175.1, 174.7999999999999, 118.1, 175.7, 196.4, 162.19999999999993, 142.1, 47.0, 170.0, 103.0, 189.0, 11.0, 199.1, 71.3, 199.1, 194.0, 102.19999999999999, 198.2, 127.1, 161.0, 174.49999999999994, 182.9, 172.4, 138.2, 200.0, 193.7, 124.99999999999997, 178.1, 185.6, 171.5, 162.5, 158.0, 198.2, 151.7, 197.29999999999998, 168.5, 193.69999999999996, 189.2, 128.3, 176.59999999999997, 80.0, 170.29999999999998, 72.80000000000001, 190.1, 170.0, 200.0, 149.0, 188.0, 107.0, 175.69999999999996, 165.2, 197.3, 196.39999999999998, 188.29999999999993, 107.0, 157.1, 170.0, 114.2, 152.9, 148.10000000000002, 155.6, 169.1, 166.1, 149.29999999999998, 182.89999999999998, 166.4, 172.39999999999998, 167.0, 184.7, 191.0, 182.0, 187.4, 170.9, 170.0, 191.0, 145.39999999999998, 115.10000000000002, 192.79999999999995, 200.0, 174.2, 169.4, 158.3, 173.29999999999998, 190.1, 129.2, 126.5, 164.0, 158.3, 194.0, 177.0, 57.0, 158.0, 178.99999999999997, 185.5999999999999, 192.79999999999998, 157.7], "policy_predator_policy_reward": [5.0, 6.0, 5.0, 8.0, 0.0, 17.0, 12.0, 8.0, 0.0, 0.0, 9.0, 0.0, 0.0, 52.0, 5.0, 34.0, 1.0, 6.0, 13.0, 9.0, 16.0, 19.0, 7.0, 24.0, 0.0, 0.0, 5.0, 8.0, 11.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 2.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 5.0, 6.0, 18.0, 0.0, 0.0, 10.0, 0.0, 14.0, 21.0, 1.0, 6.0, 6.0, 6.0, 24.0, 2.0, 4.0, 18.0, 0.0, 27.0, 15.0, 0.0, 16.0, 0.0, 32.0, 0.0, 23.0, 14.0, 0.0, 4.0, 1.0, 0.0, 0.0, 9.0, 29.0, 5.0, 38.0, 22.0, 20.0, 0.0, 2.0, 10.0, 35.0, 13.0, 0.0, 14.0, 0.0, 20.0, 1.0, 39.0, 16.0, 14.0, 8.0, 8.0, 23.0, 4.0, 9.0, 0.0, 51.0, 0.0, 8.0, 27.0, 6.0, 55.0, 42.0, 0.0, 2.0, 0.0, 32.0, 0.0, 19.0, 24.0, 4.0, 0.0, 5.0, 20.0, 0.0, 0.0, 1.0, 21.0, 1.0, 7.0, 13.0, 0.0, 5.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 20.0, 6.0, 37.0, 0.0, 40.0, 0.0, 8.0, 0.0, 17.0, 6.0, 31.0, 8.0, 7.0, 0.0, 0.0, 40.0, 25.0, 0.0, 28.0, 14.0, 0.0, 0.0, 18.0, 0.0, 24.0, 5.0, 5.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 6.0, 14.0, 19.0, 0.0, 8.0, 0.0, 0.0, 13.0, 8.0, 0.0, 26.0, 18.0, 15.0, 10.0, 0.0, 5.0, 55.0, 0.0, 0.0, 1.0, 0.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.65713437703738, "mean_inference_ms": 4.9048220997027885, "mean_action_processing_ms": 0.8127742568123341, "mean_env_wait_ms": 0.5689464451200892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00801992416381836, "StateBufferConnector_ms": 0.009383797645568848, "ViewRequirementAgentConnector_ms": 0.3175623416900635}, "num_episodes": 22, "episode_return_max": 395.1, "episode_return_min": 229.39999999999998, "episode_return_mean": 344.164, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 180.36470419666293, "num_env_steps_trained_throughput_per_sec": 180.36470419666293, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 1008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1008000, "timers": {"training_iteration_time_ms": 24269.753, "restore_workers_time_ms": 0.019, "training_step_time_ms": 24269.681, "sample_time_ms": 3667.578, "learn_time_ms": 20560.101, "learn_throughput": 194.552, "synch_weights_time_ms": 37.379}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 1008000, "num_agent_steps_trained": 1008000}, "done": false, "training_iteration": 63, "trial_id": "e4caa_00000", "date": "2024-08-13_20-09-03", "timestamp": 1723594143, "time_this_iter_s": 22.22216296195984, "time_total_s": 1478.2500596046448, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2879d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1478.2500596046448, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 88.34838709677419, "ram_util_percent": 83.83870967741936}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.488331732011977, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4819256814068587, "policy_loss": -0.008126352101111066, "vf_loss": 1.488941212684389, "vf_explained_var": 0.28545531794507667, "kl": 0.007405488554221365, "entropy": 1.4840890343227084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7115186991514983, "cur_kl_coeff": 3.7252902984619143e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8120842409354669, "policy_loss": -0.003942038295002132, "vf_loss": 0.8160262784629903, "vf_explained_var": 0.15354784115281686, "kl": 0.001667320104891445, "entropy": 0.10088280821958232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 120015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "env_runners": {"episode_reward_max": 395.1, "episode_reward_min": 240.1, "episode_reward_mean": 344.35400000000004, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 11.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 55.0}, "policy_reward_mean": {"prey_policy": 162.08700000000002, "predator_policy": 10.09}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.6, 380.19999999999993, 370.8, 360.0, 345.7, 386.5, 345.8, 320.4, 379.7, 353.8000000000001, 322.80000000000035, 334.7, 338.79999999999995, 353.0, 338.0, 283.0, 313.4, 335.30000000000007, 363.8000000000001, 351.4000000000001, 322.1000000000001, 277.3, 355.5, 348.39999999999986, 291.4, 369.3, 338.1, 291.5, 357.69999999999993, 365.89999999999986, 320.79999999999995, 367.60000000000025, 240.1, 308.0, 261.0, 312.4, 395.1, 332.40000000000003, 331.1, 361.4000000000002, 335.6, 393.7, 325.10000000000014, 365.1, 333.5, 354.9, 381.79999999999995, 382.9, 324.9, 293.30000000000007, 302.9, 378.0, 354.0, 319.7, 377.5, 384.70000000000005, 329.1, 312.2, 314.99999999999994, 342.7, 339.4000000000001, 359.3, 355.4, 375.70000000000005, 369.3999999999999, 356.9, 356.40000000000003, 326.9, 382.20000000000005, 340.7, 371.40000000000003, 299.70000000000005, 347.29999999999995, 376.0, 270.0, 365.6, 362.5000000000001, 367.7, 341.6, 384.1, 347.09999999999997, 343.5, 338.1, 375.9, 381.2, 350.5000000000001, 311.7, 330.5, 273.3, 369.4, 371.79999999999995, 380.2, 336.30000000000007, 342.3, 353.0, 330.0, 373.0, 387.4, 322.7, 377.9], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [148.1, 195.49999999999997, 190.99999999999997, 189.2, 200.0, 159.8, 167.9, 187.1, 173.0, 148.7, 186.5, 200.0, 142.1, 193.7, 160.39999999999998, 125.0, 193.4, 179.3, 150.79999999999995, 191.0, 112.6999999999999, 184.09999999999997, 130.69999999999993, 181.99999999999997, 118.1, 193.7, 181.0, 157.0, 162.0, 160.0, 86.0, 165.0, 141.49999999999997, 134.9, 188.3, 142.99999999999997, 182.59999999999997, 180.2, 162.19999999999996, 180.2, 110.3, 177.79999999999998, 131.3, 86.0, 197.29999999999998, 138.2, 170.0, 166.3999999999999, 101.29999999999998, 142.1, 199.1, 156.2, 180.2, 137.9, 93.79999999999998, 157.7, 178.39999999999992, 149.3, 175.1, 174.7999999999999, 118.1, 175.7, 196.4, 162.19999999999993, 142.1, 47.0, 170.0, 103.0, 189.0, 11.0, 199.1, 71.3, 199.1, 194.0, 102.19999999999999, 198.2, 127.1, 161.0, 174.49999999999994, 182.9, 172.4, 138.2, 200.0, 193.7, 124.99999999999997, 178.1, 185.6, 171.5, 162.5, 158.0, 198.2, 151.7, 197.29999999999998, 168.5, 193.69999999999996, 189.2, 128.3, 176.59999999999997, 80.0, 170.29999999999998, 72.80000000000001, 190.1, 170.0, 200.0, 149.0, 188.0, 107.0, 175.69999999999996, 165.2, 197.3, 196.39999999999998, 188.29999999999993, 107.0, 157.1, 170.0, 114.2, 152.9, 148.10000000000002, 155.6, 169.1, 166.1, 149.29999999999998, 182.89999999999998, 166.4, 172.39999999999998, 167.0, 184.7, 191.0, 182.0, 187.4, 170.9, 170.0, 191.0, 145.39999999999998, 115.10000000000002, 192.79999999999995, 200.0, 174.2, 169.4, 158.3, 173.29999999999998, 190.1, 129.2, 126.5, 164.0, 158.3, 194.0, 177.0, 57.0, 158.0, 178.99999999999997, 185.5999999999999, 192.79999999999998, 157.7, 186.5, 171.2, 123.8, 192.8, 188.6, 192.5, 144.5, 185.60000000000002, 113.0, 195.5, 182.0, 139.10000000000002, 192.2, 175.70000000000002, 159.2, 200.0, 194.59999999999997, 128.9, 200.0, 70.7, 116.0, 186.5, 41.0, 179.3, 200.0, 160.4, 176.0, 186.8, 191.0, 177.2, 193.7, 116.59999999999998, 168.8, 159.5, 148.0, 190.0, 178.0, 132.0, 188.0, 185.0, 198.2, 189.2, 144.2, 138.5, 191.9, 179.0], "policy_predator_policy_reward": [17.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 5.0, 6.0, 18.0, 0.0, 0.0, 10.0, 0.0, 14.0, 21.0, 1.0, 6.0, 6.0, 6.0, 24.0, 2.0, 4.0, 18.0, 0.0, 27.0, 15.0, 0.0, 16.0, 0.0, 32.0, 0.0, 23.0, 14.0, 0.0, 4.0, 1.0, 0.0, 0.0, 9.0, 29.0, 5.0, 38.0, 22.0, 20.0, 0.0, 2.0, 10.0, 35.0, 13.0, 0.0, 14.0, 0.0, 20.0, 1.0, 39.0, 16.0, 14.0, 8.0, 8.0, 23.0, 4.0, 9.0, 0.0, 51.0, 0.0, 8.0, 27.0, 6.0, 55.0, 42.0, 0.0, 2.0, 0.0, 32.0, 0.0, 19.0, 24.0, 4.0, 0.0, 5.0, 20.0, 0.0, 0.0, 1.0, 21.0, 1.0, 7.0, 13.0, 0.0, 5.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 20.0, 6.0, 37.0, 0.0, 40.0, 0.0, 8.0, 0.0, 17.0, 6.0, 31.0, 8.0, 7.0, 0.0, 0.0, 40.0, 25.0, 0.0, 28.0, 14.0, 0.0, 0.0, 18.0, 0.0, 24.0, 5.0, 5.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 6.0, 14.0, 19.0, 0.0, 8.0, 0.0, 0.0, 13.0, 8.0, 0.0, 26.0, 18.0, 15.0, 10.0, 0.0, 5.0, 55.0, 0.0, 0.0, 1.0, 0.0, 12.0, 4.0, 6.0, 2.0, 23.0, 3.0, 0.0, 16.0, 1.0, 16.0, 19.0, 6.0, 11.0, 6.0, 2.0, 10.0, 12.0, 9.0, 18.0, 0.0, 41.0, 28.0, 0.0, 53.0, 0.0, 0.0, 9.0, 0.0, 9.0, 6.0, 6.0, 26.0, 0.0, 6.0, 8.0, 15.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 27.0, 0.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6554667375199554, "mean_inference_ms": 4.901046140707668, "mean_action_processing_ms": 0.8122220251629088, "mean_env_wait_ms": 0.5701890883890954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010843753814697266, "StateBufferConnector_ms": 0.011944413185119629, "ViewRequirementAgentConnector_ms": 0.340265154838562}, "num_episodes": 23, "episode_return_max": 395.1, "episode_return_min": 240.1, "episode_return_mean": 344.35400000000004, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 186.57912081184506, "num_env_steps_trained_throughput_per_sec": 186.57912081184506, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 1024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1024000, "timers": {"training_iteration_time_ms": 24186.764, "restore_workers_time_ms": 0.021, "training_step_time_ms": 24186.688, "sample_time_ms": 3665.043, "learn_time_ms": 20481.379, "learn_throughput": 195.299, "synch_weights_time_ms": 35.733}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 1024000, "num_agent_steps_trained": 1024000}, "done": false, "training_iteration": 64, "trial_id": "e4caa_00000", "date": "2024-08-13_20-09-25", "timestamp": 1723594165, "time_this_iter_s": 21.506428241729736, "time_total_s": 1499.7564878463745, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2879f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1499.7564878463745, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 85.35483870967742, "ram_util_percent": 83.66451612903225}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.346154864786794, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.185004256862812, "policy_loss": -0.006190623830826509, "vf_loss": 2.1903861981220345, "vf_explained_var": 0.2383557929248406, "kl": 0.005391210191544918, "entropy": 1.4654211949419091, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.233969504855297, "cur_kl_coeff": 1.8626451492309571e-10, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3770244086860979, "policy_loss": -0.0023858330035138697, "vf_loss": 1.379410238398446, "vf_explained_var": 0.04791892659727228, "kl": 0.0020233449463105298, "entropy": 0.08528318029271548, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 121905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 395.1, "episode_reward_min": 240.1, "episode_reward_mean": 344.92, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 11.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 55.0}, "policy_reward_mean": {"prey_policy": 162.195, "predator_policy": 10.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [363.8000000000001, 351.4000000000001, 322.1000000000001, 277.3, 355.5, 348.39999999999986, 291.4, 369.3, 338.1, 291.5, 357.69999999999993, 365.89999999999986, 320.79999999999995, 367.60000000000025, 240.1, 308.0, 261.0, 312.4, 395.1, 332.40000000000003, 331.1, 361.4000000000002, 335.6, 393.7, 325.10000000000014, 365.1, 333.5, 354.9, 381.79999999999995, 382.9, 324.9, 293.30000000000007, 302.9, 378.0, 354.0, 319.7, 377.5, 384.70000000000005, 329.1, 312.2, 314.99999999999994, 342.7, 339.4000000000001, 359.3, 355.4, 375.70000000000005, 369.3999999999999, 356.9, 356.40000000000003, 326.9, 382.20000000000005, 340.7, 371.40000000000003, 299.70000000000005, 347.29999999999995, 376.0, 270.0, 365.6, 362.5000000000001, 367.7, 341.6, 384.1, 347.09999999999997, 343.5, 338.1, 375.9, 381.2, 350.5000000000001, 311.7, 330.5, 273.3, 369.4, 371.79999999999995, 380.2, 336.30000000000007, 342.3, 353.0, 330.0, 373.0, 387.4, 322.7, 377.9, 351.5, 363.9, 316.4, 363.1, 358.79999999999995, 294.9, 383.9, 355.0, 321.59999999999997, 394.6, 339.3, 354.0, 373.40000000000003, 379.3000000000001, 348.0, 336.0, 317.6, 327.8000000000001], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [182.59999999999997, 180.2, 162.19999999999996, 180.2, 110.3, 177.79999999999998, 131.3, 86.0, 197.29999999999998, 138.2, 170.0, 166.3999999999999, 101.29999999999998, 142.1, 199.1, 156.2, 180.2, 137.9, 93.79999999999998, 157.7, 178.39999999999992, 149.3, 175.1, 174.7999999999999, 118.1, 175.7, 196.4, 162.19999999999993, 142.1, 47.0, 170.0, 103.0, 189.0, 11.0, 199.1, 71.3, 199.1, 194.0, 102.19999999999999, 198.2, 127.1, 161.0, 174.49999999999994, 182.9, 172.4, 138.2, 200.0, 193.7, 124.99999999999997, 178.1, 185.6, 171.5, 162.5, 158.0, 198.2, 151.7, 197.29999999999998, 168.5, 193.69999999999996, 189.2, 128.3, 176.59999999999997, 80.0, 170.29999999999998, 72.80000000000001, 190.1, 170.0, 200.0, 149.0, 188.0, 107.0, 175.69999999999996, 165.2, 197.3, 196.39999999999998, 188.29999999999993, 107.0, 157.1, 170.0, 114.2, 152.9, 148.10000000000002, 155.6, 169.1, 166.1, 149.29999999999998, 182.89999999999998, 166.4, 172.39999999999998, 167.0, 184.7, 191.0, 182.0, 187.4, 170.9, 170.0, 191.0, 145.39999999999998, 115.10000000000002, 192.79999999999995, 200.0, 174.2, 169.4, 158.3, 173.29999999999998, 190.1, 129.2, 126.5, 164.0, 158.3, 194.0, 177.0, 57.0, 158.0, 178.99999999999997, 185.5999999999999, 192.79999999999998, 157.7, 186.5, 171.2, 123.8, 192.8, 188.6, 192.5, 144.5, 185.60000000000002, 113.0, 195.5, 182.0, 139.10000000000002, 192.2, 175.70000000000002, 159.2, 200.0, 194.59999999999997, 128.9, 200.0, 70.7, 116.0, 186.5, 41.0, 179.3, 200.0, 160.4, 176.0, 186.8, 191.0, 177.2, 193.7, 116.59999999999998, 168.8, 159.5, 148.0, 190.0, 178.0, 132.0, 188.0, 185.0, 198.2, 189.2, 144.2, 138.5, 191.9, 179.0, 161.29999999999998, 177.2, 183.5, 166.4, 115.1, 179.3, 181.1, 173.0, 167.0, 183.8, 123.2, 145.7, 179.89999999999998, 200.0, 192.8, 144.2, 170.6, 116.0, 199.1, 195.5, 113.0, 197.3, 134.0, 179.0, 199.1, 167.29999999999998, 188.89999999999995, 187.4, 177.0, 150.0, 194.0, 110.0, 141.8, 150.8, 174.49999999999997, 125.3], "policy_predator_policy_reward": [1.0, 0.0, 0.0, 9.0, 29.0, 5.0, 38.0, 22.0, 20.0, 0.0, 2.0, 10.0, 35.0, 13.0, 0.0, 14.0, 0.0, 20.0, 1.0, 39.0, 16.0, 14.0, 8.0, 8.0, 23.0, 4.0, 9.0, 0.0, 51.0, 0.0, 8.0, 27.0, 6.0, 55.0, 42.0, 0.0, 2.0, 0.0, 32.0, 0.0, 19.0, 24.0, 4.0, 0.0, 5.0, 20.0, 0.0, 0.0, 1.0, 21.0, 1.0, 7.0, 13.0, 0.0, 5.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 20.0, 6.0, 37.0, 0.0, 40.0, 0.0, 8.0, 0.0, 17.0, 6.0, 31.0, 8.0, 7.0, 0.0, 0.0, 40.0, 25.0, 0.0, 28.0, 14.0, 0.0, 0.0, 18.0, 0.0, 24.0, 5.0, 5.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 6.0, 14.0, 19.0, 0.0, 8.0, 0.0, 0.0, 13.0, 8.0, 0.0, 26.0, 18.0, 15.0, 10.0, 0.0, 5.0, 55.0, 0.0, 0.0, 1.0, 0.0, 12.0, 4.0, 6.0, 2.0, 23.0, 3.0, 0.0, 16.0, 1.0, 16.0, 19.0, 6.0, 11.0, 6.0, 2.0, 10.0, 12.0, 9.0, 18.0, 0.0, 41.0, 28.0, 0.0, 53.0, 0.0, 0.0, 9.0, 0.0, 9.0, 6.0, 6.0, 26.0, 0.0, 6.0, 8.0, 15.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 27.0, 0.0, 7.0, 3.0, 10.0, 14.0, 0.0, 9.0, 13.0, 9.0, 0.0, 8.0, 0.0, 26.0, 0.0, 0.0, 4.0, 0.0, 18.0, 30.0, 5.0, 0.0, 0.0, 29.0, 0.0, 23.0, 18.0, 7.0, 0.0, 0.0, 3.0, 3.0, 18.0, 2.0, 30.0, 2.0, 23.0, 21.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6580145221294667, "mean_inference_ms": 4.902636147431749, "mean_action_processing_ms": 0.8072616600495849, "mean_env_wait_ms": 0.5694403130915474, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009960412979125977, "StateBufferConnector_ms": 0.010331869125366211, "ViewRequirementAgentConnector_ms": 0.2913461923599243}, "num_episodes": 18, "episode_return_max": 395.1, "episode_return_min": 240.1, "episode_return_mean": 344.92, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 227.71550432430612, "num_env_steps_trained_throughput_per_sec": 227.71550432430612, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 23618.611, "restore_workers_time_ms": 0.021, "training_step_time_ms": 23618.536, "sample_time_ms": 3666.499, "learn_time_ms": 19917.146, "learn_throughput": 200.832, "synch_weights_time_ms": 30.259}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 65, "trial_id": "e4caa_00000", "date": "2024-08-13_20-09-43", "timestamp": 1723594183, "time_this_iter_s": 17.627491235733032, "time_total_s": 1517.3839790821075, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2886ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1517.3839790821075, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 77.572, "ram_util_percent": 82.604}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7776082078300455, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.650568846514616, "policy_loss": -0.011365166368460647, "vf_loss": 1.6606685354280724, "vf_explained_var": 0.5725135968475745, "kl": 0.008436515196698259, "entropy": 1.478491685314784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.429773630146627, "cur_kl_coeff": 9.313225746154786e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5441375567878365, "policy_loss": -0.0021631469720945, "vf_loss": 0.5463007048915618, "vf_explained_var": 0.1484985028940534, "kl": 0.001476957351305039, "entropy": 0.0919653124831341, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 123795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "env_runners": {"episode_reward_max": 395.1, "episode_reward_min": 178.99999999999943, "episode_reward_mean": 348.524, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 20.000000000000014, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 55.0}, "policy_reward_mean": {"prey_policy": 164.82699999999997, "predator_policy": 9.435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [395.1, 332.40000000000003, 331.1, 361.4000000000002, 335.6, 393.7, 325.10000000000014, 365.1, 333.5, 354.9, 381.79999999999995, 382.9, 324.9, 293.30000000000007, 302.9, 378.0, 354.0, 319.7, 377.5, 384.70000000000005, 329.1, 312.2, 314.99999999999994, 342.7, 339.4000000000001, 359.3, 355.4, 375.70000000000005, 369.3999999999999, 356.9, 356.40000000000003, 326.9, 382.20000000000005, 340.7, 371.40000000000003, 299.70000000000005, 347.29999999999995, 376.0, 270.0, 365.6, 362.5000000000001, 367.7, 341.6, 384.1, 347.09999999999997, 343.5, 338.1, 375.9, 381.2, 350.5000000000001, 311.7, 330.5, 273.3, 369.4, 371.79999999999995, 380.2, 336.30000000000007, 342.3, 353.0, 330.0, 373.0, 387.4, 322.7, 377.9, 351.5, 363.9, 316.4, 363.1, 358.79999999999995, 294.9, 383.9, 355.0, 321.59999999999997, 394.6, 339.3, 354.0, 373.40000000000003, 379.3000000000001, 348.0, 336.0, 317.6, 327.8000000000001, 291.2, 387.1, 382.9, 320.2, 373.5, 364.10000000000014, 277.8, 178.99999999999943, 375.7, 371.10000000000014, 356.4, 363.9, 360.9, 389.2, 381.0, 348.0, 319.9, 360.8], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [199.1, 194.0, 102.19999999999999, 198.2, 127.1, 161.0, 174.49999999999994, 182.9, 172.4, 138.2, 200.0, 193.7, 124.99999999999997, 178.1, 185.6, 171.5, 162.5, 158.0, 198.2, 151.7, 197.29999999999998, 168.5, 193.69999999999996, 189.2, 128.3, 176.59999999999997, 80.0, 170.29999999999998, 72.80000000000001, 190.1, 170.0, 200.0, 149.0, 188.0, 107.0, 175.69999999999996, 165.2, 197.3, 196.39999999999998, 188.29999999999993, 107.0, 157.1, 170.0, 114.2, 152.9, 148.10000000000002, 155.6, 169.1, 166.1, 149.29999999999998, 182.89999999999998, 166.4, 172.39999999999998, 167.0, 184.7, 191.0, 182.0, 187.4, 170.9, 170.0, 191.0, 145.39999999999998, 115.10000000000002, 192.79999999999995, 200.0, 174.2, 169.4, 158.3, 173.29999999999998, 190.1, 129.2, 126.5, 164.0, 158.3, 194.0, 177.0, 57.0, 158.0, 178.99999999999997, 185.5999999999999, 192.79999999999998, 157.7, 186.5, 171.2, 123.8, 192.8, 188.6, 192.5, 144.5, 185.60000000000002, 113.0, 195.5, 182.0, 139.10000000000002, 192.2, 175.70000000000002, 159.2, 200.0, 194.59999999999997, 128.9, 200.0, 70.7, 116.0, 186.5, 41.0, 179.3, 200.0, 160.4, 176.0, 186.8, 191.0, 177.2, 193.7, 116.59999999999998, 168.8, 159.5, 148.0, 190.0, 178.0, 132.0, 188.0, 185.0, 198.2, 189.2, 144.2, 138.5, 191.9, 179.0, 161.29999999999998, 177.2, 183.5, 166.4, 115.1, 179.3, 181.1, 173.0, 167.0, 183.8, 123.2, 145.7, 179.89999999999998, 200.0, 192.8, 144.2, 170.6, 116.0, 199.1, 195.5, 113.0, 197.3, 134.0, 179.0, 199.1, 167.29999999999998, 188.89999999999995, 187.4, 177.0, 150.0, 194.0, 110.0, 141.8, 150.8, 174.49999999999997, 125.3, 51.2, 173.0, 181.1, 200.0, 191.0, 191.9, 168.2, 113.0, 164.3, 198.2, 196.4, 154.69999999999996, 129.2, 107.6, 146.0, 20.000000000000014, 191.9, 183.79999999999998, 172.39999999999998, 193.7, 121.4, 200.0, 155.3, 194.6, 188.3, 161.6, 192.8, 196.4, 182.0, 199.0, 156.0, 175.0, 64.7, 180.2, 166.4, 178.4], "policy_predator_policy_reward": [2.0, 0.0, 32.0, 0.0, 19.0, 24.0, 4.0, 0.0, 5.0, 20.0, 0.0, 0.0, 1.0, 21.0, 1.0, 7.0, 13.0, 0.0, 5.0, 0.0, 8.0, 8.0, 0.0, 0.0, 0.0, 20.0, 6.0, 37.0, 0.0, 40.0, 0.0, 8.0, 0.0, 17.0, 6.0, 31.0, 8.0, 7.0, 0.0, 0.0, 40.0, 25.0, 0.0, 28.0, 14.0, 0.0, 0.0, 18.0, 0.0, 24.0, 5.0, 5.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 6.0, 14.0, 19.0, 0.0, 8.0, 0.0, 0.0, 13.0, 8.0, 0.0, 26.0, 18.0, 15.0, 10.0, 0.0, 5.0, 55.0, 0.0, 0.0, 1.0, 0.0, 12.0, 4.0, 6.0, 2.0, 23.0, 3.0, 0.0, 16.0, 1.0, 16.0, 19.0, 6.0, 11.0, 6.0, 2.0, 10.0, 12.0, 9.0, 18.0, 0.0, 41.0, 28.0, 0.0, 53.0, 0.0, 0.0, 9.0, 0.0, 9.0, 6.0, 6.0, 26.0, 0.0, 6.0, 8.0, 15.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 27.0, 0.0, 7.0, 3.0, 10.0, 14.0, 0.0, 9.0, 13.0, 9.0, 0.0, 8.0, 0.0, 26.0, 0.0, 0.0, 4.0, 0.0, 18.0, 30.0, 5.0, 0.0, 0.0, 29.0, 0.0, 23.0, 18.0, 7.0, 0.0, 0.0, 3.0, 3.0, 18.0, 2.0, 30.0, 2.0, 23.0, 21.0, 7.0, 29.0, 38.0, 0.0, 6.0, 0.0, 0.0, 33.0, 6.0, 0.0, 11.0, 0.0, 13.0, 28.0, 13.0, 12.0, 1.0, 0.0, 0.0, 5.0, 0.0, 18.0, 17.0, 0.0, 14.0, 3.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 12.0, 32.0, 43.0, 10.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6541661674549182, "mean_inference_ms": 4.890076766677584, "mean_action_processing_ms": 0.8033170868604168, "mean_env_wait_ms": 0.5682960593439008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009769916534423828, "StateBufferConnector_ms": 0.007339000701904297, "ViewRequirementAgentConnector_ms": 0.2880667448043823}, "num_episodes": 18, "episode_return_max": 395.1, "episode_return_min": 178.99999999999943, "episode_return_mean": 348.524, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.51957517322484, "num_env_steps_trained_throughput_per_sec": 271.51957517322484, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 1056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1056000, "timers": {"training_iteration_time_ms": 22358.793, "restore_workers_time_ms": 0.021, "training_step_time_ms": 22358.724, "sample_time_ms": 3314.135, "learn_time_ms": 19012.853, "learn_throughput": 210.384, "synch_weights_time_ms": 27.133}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 1056000, "num_agent_steps_trained": 1056000}, "done": false, "training_iteration": 66, "trial_id": "e4caa_00000", "date": "2024-08-13_20-09-58", "timestamp": 1723594198, "time_this_iter_s": 14.849942684173584, "time_total_s": 1532.2339217662811, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2879d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1532.2339217662811, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 64.5142857142857, "ram_util_percent": 80.27142857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3207900335549048, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.546463017205082, "policy_loss": -0.00884975501528335, "vf_loss": 1.5539626988784345, "vf_explained_var": 0.34110283593021373, "kl": 0.009000492364703133, "entropy": 1.474104790838938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8587354593333745, "cur_kl_coeff": 4.656612873077393e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0089202697787967, "policy_loss": -0.002057589525751099, "vf_loss": 1.0109778572248402, "vf_explained_var": 0.08026611946877979, "kl": 0.0014782214685257014, "entropy": 0.09990256469913576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 125685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "env_runners": {"episode_reward_max": 399.1, "episode_reward_min": 178.99999999999943, "episode_reward_mean": 348.35799999999995, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 16.09999999999996, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 55.0}, "policy_reward_mean": {"prey_policy": 165.234, "predator_policy": 8.945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [314.99999999999994, 342.7, 339.4000000000001, 359.3, 355.4, 375.70000000000005, 369.3999999999999, 356.9, 356.40000000000003, 326.9, 382.20000000000005, 340.7, 371.40000000000003, 299.70000000000005, 347.29999999999995, 376.0, 270.0, 365.6, 362.5000000000001, 367.7, 341.6, 384.1, 347.09999999999997, 343.5, 338.1, 375.9, 381.2, 350.5000000000001, 311.7, 330.5, 273.3, 369.4, 371.79999999999995, 380.2, 336.30000000000007, 342.3, 353.0, 330.0, 373.0, 387.4, 322.7, 377.9, 351.5, 363.9, 316.4, 363.1, 358.79999999999995, 294.9, 383.9, 355.0, 321.59999999999997, 394.6, 339.3, 354.0, 373.40000000000003, 379.3000000000001, 348.0, 336.0, 317.6, 327.8000000000001, 291.2, 387.1, 382.9, 320.2, 373.5, 364.10000000000014, 277.8, 178.99999999999943, 375.7, 371.10000000000014, 356.4, 363.9, 360.9, 389.2, 381.0, 348.0, 319.9, 360.8, 388.3, 357.4, 370.6, 373.0, 351.5, 362.1, 366.2, 399.1, 324.9, 374.8, 347.7, 390.2, 376.4, 344.29999999999995, 179.69999999999948, 201.29999999999964, 348.0, 370.0, 352.0, 352.0, 340.2, 382.6000000000001], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [152.9, 148.10000000000002, 155.6, 169.1, 166.1, 149.29999999999998, 182.89999999999998, 166.4, 172.39999999999998, 167.0, 184.7, 191.0, 182.0, 187.4, 170.9, 170.0, 191.0, 145.39999999999998, 115.10000000000002, 192.79999999999995, 200.0, 174.2, 169.4, 158.3, 173.29999999999998, 190.1, 129.2, 126.5, 164.0, 158.3, 194.0, 177.0, 57.0, 158.0, 178.99999999999997, 185.5999999999999, 192.79999999999998, 157.7, 186.5, 171.2, 123.8, 192.8, 188.6, 192.5, 144.5, 185.60000000000002, 113.0, 195.5, 182.0, 139.10000000000002, 192.2, 175.70000000000002, 159.2, 200.0, 194.59999999999997, 128.9, 200.0, 70.7, 116.0, 186.5, 41.0, 179.3, 200.0, 160.4, 176.0, 186.8, 191.0, 177.2, 193.7, 116.59999999999998, 168.8, 159.5, 148.0, 190.0, 178.0, 132.0, 188.0, 185.0, 198.2, 189.2, 144.2, 138.5, 191.9, 179.0, 161.29999999999998, 177.2, 183.5, 166.4, 115.1, 179.3, 181.1, 173.0, 167.0, 183.8, 123.2, 145.7, 179.89999999999998, 200.0, 192.8, 144.2, 170.6, 116.0, 199.1, 195.5, 113.0, 197.3, 134.0, 179.0, 199.1, 167.29999999999998, 188.89999999999995, 187.4, 177.0, 150.0, 194.0, 110.0, 141.8, 150.8, 174.49999999999997, 125.3, 51.2, 173.0, 181.1, 200.0, 191.0, 191.9, 168.2, 113.0, 164.3, 198.2, 196.4, 154.69999999999996, 129.2, 107.6, 146.0, 20.000000000000014, 191.9, 183.79999999999998, 172.39999999999998, 193.7, 121.4, 200.0, 155.3, 194.6, 188.3, 161.6, 192.8, 196.4, 182.0, 199.0, 156.0, 175.0, 64.7, 180.2, 166.4, 178.4, 193.7, 194.6, 131.0, 196.4, 198.2, 160.39999999999998, 190.1, 182.9, 197.0, 132.5, 154.4, 193.7, 179.0, 180.2, 200.0, 199.1, 155.0, 140.9, 192.79999999999998, 170.0, 116.6, 199.1, 191.0, 195.2, 187.1, 188.3, 132.2, 190.1, 20.000000000000014, 127.7, 16.09999999999996, 147.2, 170.0, 167.0, 164.0, 191.0, 191.0, 151.0, 141.0, 186.0, 150.2, 167.0, 182.0, 194.59999999999997], "policy_predator_policy_reward": [14.0, 0.0, 0.0, 18.0, 0.0, 24.0, 5.0, 5.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 6.0, 14.0, 19.0, 0.0, 8.0, 0.0, 0.0, 13.0, 8.0, 0.0, 26.0, 18.0, 15.0, 10.0, 0.0, 5.0, 55.0, 0.0, 0.0, 1.0, 0.0, 12.0, 4.0, 6.0, 2.0, 23.0, 3.0, 0.0, 16.0, 1.0, 16.0, 19.0, 6.0, 11.0, 6.0, 2.0, 10.0, 12.0, 9.0, 18.0, 0.0, 41.0, 28.0, 0.0, 53.0, 0.0, 0.0, 9.0, 0.0, 9.0, 6.0, 6.0, 26.0, 0.0, 6.0, 8.0, 15.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 27.0, 0.0, 7.0, 3.0, 10.0, 14.0, 0.0, 9.0, 13.0, 9.0, 0.0, 8.0, 0.0, 26.0, 0.0, 0.0, 4.0, 0.0, 18.0, 30.0, 5.0, 0.0, 0.0, 29.0, 0.0, 23.0, 18.0, 7.0, 0.0, 0.0, 3.0, 3.0, 18.0, 2.0, 30.0, 2.0, 23.0, 21.0, 7.0, 29.0, 38.0, 0.0, 6.0, 0.0, 0.0, 33.0, 6.0, 0.0, 11.0, 0.0, 13.0, 28.0, 13.0, 12.0, 1.0, 0.0, 0.0, 5.0, 0.0, 18.0, 17.0, 0.0, 14.0, 3.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 12.0, 32.0, 43.0, 10.0, 6.0, 0.0, 0.0, 17.0, 13.0, 12.0, 0.0, 0.0, 0.0, 1.0, 21.0, 14.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 29.0, 10.0, 2.0, 26.0, 6.0, 3.0, 1.0, 1.0, 0.0, 22.0, 0.0, 16.0, 16.0, 11.0, 27.0, 0.0, 11.0, 2.0, 13.0, 5.0, 5.0, 13.0, 12.0, 0.0, 23.0, 2.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6485682508414397, "mean_inference_ms": 4.870487570713849, "mean_action_processing_ms": 0.7979587642770332, "mean_env_wait_ms": 0.5665365948191612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009841322898864746, "StateBufferConnector_ms": 0.013462305068969727, "ViewRequirementAgentConnector_ms": 0.32047319412231445}, "num_episodes": 22, "episode_return_max": 399.1, "episode_return_min": 178.99999999999943, "episode_return_mean": 348.35799999999995, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 188.03232527360078, "num_env_steps_trained_throughput_per_sec": 188.03232527360078, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 1072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1072000, "timers": {"training_iteration_time_ms": 22222.347, "restore_workers_time_ms": 0.021, "training_step_time_ms": 22222.278, "sample_time_ms": 3382.639, "learn_time_ms": 18805.892, "learn_throughput": 212.699, "synch_weights_time_ms": 29.385}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 1072000, "num_agent_steps_trained": 1072000}, "done": false, "training_iteration": 67, "trial_id": "e4caa_00000", "date": "2024-08-13_20-10-19", "timestamp": 1723594219, "time_this_iter_s": 21.3839271068573, "time_total_s": 1553.6178488731384, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28788b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1553.6178488731384, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 78.45666666666665, "ram_util_percent": 82.67333333333336}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.334480466492592, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3670326231806367, "policy_loss": -0.009514507818868551, "vf_loss": 1.3757421114772717, "vf_explained_var": 0.3425295217642708, "kl": 0.005366785444830616, "entropy": 1.4625781520333871, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.171770235911879, "cur_kl_coeff": 2.3283064365386964e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6952165519276624, "policy_loss": -0.0019685942932184805, "vf_loss": 0.6971851489255353, "vf_explained_var": 0.12703996051556218, "kl": 0.0022804573191235428, "entropy": 0.09627840930310191, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 127575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "env_runners": {"episode_reward_max": 399.1, "episode_reward_min": 178.99999999999943, "episode_reward_mean": 351.26599999999996, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 16.09999999999996, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 53.0}, "policy_reward_mean": {"prey_policy": 167.048, "predator_policy": 8.585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.5000000000001, 367.7, 341.6, 384.1, 347.09999999999997, 343.5, 338.1, 375.9, 381.2, 350.5000000000001, 311.7, 330.5, 273.3, 369.4, 371.79999999999995, 380.2, 336.30000000000007, 342.3, 353.0, 330.0, 373.0, 387.4, 322.7, 377.9, 351.5, 363.9, 316.4, 363.1, 358.79999999999995, 294.9, 383.9, 355.0, 321.59999999999997, 394.6, 339.3, 354.0, 373.40000000000003, 379.3000000000001, 348.0, 336.0, 317.6, 327.8000000000001, 291.2, 387.1, 382.9, 320.2, 373.5, 364.10000000000014, 277.8, 178.99999999999943, 375.7, 371.10000000000014, 356.4, 363.9, 360.9, 389.2, 381.0, 348.0, 319.9, 360.8, 388.3, 357.4, 370.6, 373.0, 351.5, 362.1, 366.2, 399.1, 324.9, 374.8, 347.7, 390.2, 376.4, 344.29999999999995, 179.69999999999948, 201.29999999999964, 348.0, 370.0, 352.0, 352.0, 340.2, 382.6000000000001, 369.0000000000002, 351.1, 392.8, 340.4, 384.3, 388.29999999999995, 365.4, 382.20000000000005, 331.9, 369.1, 329.80000000000007, 347.59999999999997, 362.0, 304.1, 387.0, 391.0, 358.6, 386.20000000000005], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [192.79999999999998, 157.7, 186.5, 171.2, 123.8, 192.8, 188.6, 192.5, 144.5, 185.60000000000002, 113.0, 195.5, 182.0, 139.10000000000002, 192.2, 175.70000000000002, 159.2, 200.0, 194.59999999999997, 128.9, 200.0, 70.7, 116.0, 186.5, 41.0, 179.3, 200.0, 160.4, 176.0, 186.8, 191.0, 177.2, 193.7, 116.59999999999998, 168.8, 159.5, 148.0, 190.0, 178.0, 132.0, 188.0, 185.0, 198.2, 189.2, 144.2, 138.5, 191.9, 179.0, 161.29999999999998, 177.2, 183.5, 166.4, 115.1, 179.3, 181.1, 173.0, 167.0, 183.8, 123.2, 145.7, 179.89999999999998, 200.0, 192.8, 144.2, 170.6, 116.0, 199.1, 195.5, 113.0, 197.3, 134.0, 179.0, 199.1, 167.29999999999998, 188.89999999999995, 187.4, 177.0, 150.0, 194.0, 110.0, 141.8, 150.8, 174.49999999999997, 125.3, 51.2, 173.0, 181.1, 200.0, 191.0, 191.9, 168.2, 113.0, 164.3, 198.2, 196.4, 154.69999999999996, 129.2, 107.6, 146.0, 20.000000000000014, 191.9, 183.79999999999998, 172.39999999999998, 193.7, 121.4, 200.0, 155.3, 194.6, 188.3, 161.6, 192.8, 196.4, 182.0, 199.0, 156.0, 175.0, 64.7, 180.2, 166.4, 178.4, 193.7, 194.6, 131.0, 196.4, 198.2, 160.39999999999998, 190.1, 182.9, 197.0, 132.5, 154.4, 193.7, 179.0, 180.2, 200.0, 199.1, 155.0, 140.9, 192.79999999999998, 170.0, 116.6, 199.1, 191.0, 195.2, 187.1, 188.3, 132.2, 190.1, 20.000000000000014, 127.7, 16.09999999999996, 147.2, 170.0, 167.0, 164.0, 191.0, 191.0, 151.0, 141.0, 186.0, 150.2, 167.0, 182.0, 194.59999999999997, 191.89999999999995, 163.1, 170.0, 166.1, 200.0, 192.8, 85.40000000000002, 200.0, 192.2, 190.1, 200.0, 188.3, 184.4, 170.0, 175.1, 199.1, 193.7, 117.2, 200.0, 157.1, 142.39999999999998, 187.4, 180.2, 151.4, 200.0, 143.0, 102.8, 167.3, 191.0, 194.0, 194.0, 197.0, 159.5, 190.1, 197.0, 183.2], "policy_predator_policy_reward": [0.0, 12.0, 4.0, 6.0, 2.0, 23.0, 3.0, 0.0, 16.0, 1.0, 16.0, 19.0, 6.0, 11.0, 6.0, 2.0, 10.0, 12.0, 9.0, 18.0, 0.0, 41.0, 28.0, 0.0, 53.0, 0.0, 0.0, 9.0, 0.0, 9.0, 6.0, 6.0, 26.0, 0.0, 6.0, 8.0, 15.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 27.0, 0.0, 7.0, 3.0, 10.0, 14.0, 0.0, 9.0, 13.0, 9.0, 0.0, 8.0, 0.0, 26.0, 0.0, 0.0, 4.0, 0.0, 18.0, 30.0, 5.0, 0.0, 0.0, 29.0, 0.0, 23.0, 18.0, 7.0, 0.0, 0.0, 3.0, 3.0, 18.0, 2.0, 30.0, 2.0, 23.0, 21.0, 7.0, 29.0, 38.0, 0.0, 6.0, 0.0, 0.0, 33.0, 6.0, 0.0, 11.0, 0.0, 13.0, 28.0, 13.0, 12.0, 1.0, 0.0, 0.0, 5.0, 0.0, 18.0, 17.0, 0.0, 14.0, 3.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 12.0, 32.0, 43.0, 10.0, 6.0, 0.0, 0.0, 17.0, 13.0, 12.0, 0.0, 0.0, 0.0, 1.0, 21.0, 14.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 29.0, 10.0, 2.0, 26.0, 6.0, 3.0, 1.0, 1.0, 0.0, 22.0, 0.0, 16.0, 16.0, 11.0, 27.0, 0.0, 11.0, 2.0, 13.0, 5.0, 5.0, 13.0, 12.0, 0.0, 23.0, 2.0, 4.0, 11.0, 3.0, 0.0, 15.0, 0.0, 0.0, 27.0, 28.0, 0.0, 2.0, 0.0, 0.0, 0.0, 11.0, 0.0, 8.0, 21.0, 0.0, 10.0, 2.0, 0.0, 0.0, 6.0, 10.0, 19.0, 0.0, 9.0, 25.0, 0.0, 2.0, 0.0, 0.0, 0.0, 9.0, 5.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6508271317811205, "mean_inference_ms": 4.880097106366355, "mean_action_processing_ms": 0.7976606636358667, "mean_env_wait_ms": 0.5680066120994717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008706450462341309, "StateBufferConnector_ms": 0.02819979190826416, "ViewRequirementAgentConnector_ms": 0.6624057292938232}, "num_episodes": 18, "episode_return_max": 399.1, "episode_return_min": 178.99999999999943, "episode_return_mean": 351.26599999999996, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 143.51346603380583, "num_env_steps_trained_throughput_per_sec": 143.51346603380583, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 1088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1088000, "timers": {"training_iteration_time_ms": 22519.497, "restore_workers_time_ms": 0.048, "training_step_time_ms": 22519.399, "sample_time_ms": 4228.558, "learn_time_ms": 18254.634, "learn_throughput": 219.122, "synch_weights_time_ms": 31.023}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 1088000, "num_agent_steps_trained": 1088000}, "done": false, "training_iteration": 68, "trial_id": "e4caa_00000", "date": "2024-08-13_20-10-47", "timestamp": 1723594247, "time_this_iter_s": 27.997659921646118, "time_total_s": 1581.6155087947845, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2878af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1581.6155087947845, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 86.66749999999999, "ram_util_percent": 83.31000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3448105026489845, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.339124867588124, "policy_loss": -0.00454415339119141, "vf_loss": 2.342698745248179, "vf_explained_var": 0.4160006090131386, "kl": 0.006468521920208641, "entropy": 1.449215482467066, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5949505895455047, "cur_kl_coeff": 1.1641532182693482e-11, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.00135460764012, "policy_loss": -0.001307986456674164, "vf_loss": 1.0026625956965503, "vf_explained_var": 0.10564253434302315, "kl": 0.0016406987113083125, "entropy": 0.08416768504829003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 129465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "env_runners": {"episode_reward_max": 399.1, "episode_reward_min": 145.39999999999966, "episode_reward_mean": 347.358, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 16.09999999999996, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 43.0}, "policy_reward_mean": {"prey_policy": 165.484, "predator_policy": 8.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [377.9, 351.5, 363.9, 316.4, 363.1, 358.79999999999995, 294.9, 383.9, 355.0, 321.59999999999997, 394.6, 339.3, 354.0, 373.40000000000003, 379.3000000000001, 348.0, 336.0, 317.6, 327.8000000000001, 291.2, 387.1, 382.9, 320.2, 373.5, 364.10000000000014, 277.8, 178.99999999999943, 375.7, 371.10000000000014, 356.4, 363.9, 360.9, 389.2, 381.0, 348.0, 319.9, 360.8, 388.3, 357.4, 370.6, 373.0, 351.5, 362.1, 366.2, 399.1, 324.9, 374.8, 347.7, 390.2, 376.4, 344.29999999999995, 179.69999999999948, 201.29999999999964, 348.0, 370.0, 352.0, 352.0, 340.2, 382.6000000000001, 369.0000000000002, 351.1, 392.8, 340.4, 384.3, 388.29999999999995, 365.4, 382.20000000000005, 331.9, 369.1, 329.80000000000007, 347.59999999999997, 362.0, 304.1, 387.0, 391.0, 358.6, 386.20000000000005, 145.39999999999966, 240.79999999999959, 347.40000000000003, 303.70000000000005, 332.69999999999993, 374.3, 347.9, 370.29999999999995, 378.4, 385.6, 350.4, 382.9, 237.50000000000006, 348.6, 374.3, 394.6, 359.1, 384.0, 382.0, 324.0, 336.8, 211.8999999999993, 370.40000000000015], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [191.9, 179.0, 161.29999999999998, 177.2, 183.5, 166.4, 115.1, 179.3, 181.1, 173.0, 167.0, 183.8, 123.2, 145.7, 179.89999999999998, 200.0, 192.8, 144.2, 170.6, 116.0, 199.1, 195.5, 113.0, 197.3, 134.0, 179.0, 199.1, 167.29999999999998, 188.89999999999995, 187.4, 177.0, 150.0, 194.0, 110.0, 141.8, 150.8, 174.49999999999997, 125.3, 51.2, 173.0, 181.1, 200.0, 191.0, 191.9, 168.2, 113.0, 164.3, 198.2, 196.4, 154.69999999999996, 129.2, 107.6, 146.0, 20.000000000000014, 191.9, 183.79999999999998, 172.39999999999998, 193.7, 121.4, 200.0, 155.3, 194.6, 188.3, 161.6, 192.8, 196.4, 182.0, 199.0, 156.0, 175.0, 64.7, 180.2, 166.4, 178.4, 193.7, 194.6, 131.0, 196.4, 198.2, 160.39999999999998, 190.1, 182.9, 197.0, 132.5, 154.4, 193.7, 179.0, 180.2, 200.0, 199.1, 155.0, 140.9, 192.79999999999998, 170.0, 116.6, 199.1, 191.0, 195.2, 187.1, 188.3, 132.2, 190.1, 20.000000000000014, 127.7, 16.09999999999996, 147.2, 170.0, 167.0, 164.0, 191.0, 191.0, 151.0, 141.0, 186.0, 150.2, 167.0, 182.0, 194.59999999999997, 191.89999999999995, 163.1, 170.0, 166.1, 200.0, 192.8, 85.40000000000002, 200.0, 192.2, 190.1, 200.0, 188.3, 184.4, 170.0, 175.1, 199.1, 193.7, 117.2, 200.0, 157.1, 142.39999999999998, 187.4, 180.2, 151.4, 200.0, 143.0, 102.8, 167.3, 191.0, 194.0, 194.0, 197.0, 159.5, 190.1, 197.0, 183.2, 103.39999999999999, 20.000000000000014, 196.4, 28.399999999999963, 185.9, 105.5, 122.0, 136.7, 152.29999999999995, 148.4, 178.1, 189.2, 163.1, 168.8, 185.59999999999997, 184.7, 184.7, 193.7, 186.5, 199.1, 195.5, 140.9, 190.09999999999994, 192.8, 17.300000000000082, 177.2, 194.6, 131.0, 179.0, 188.3, 194.6, 200.0, 172.1, 167.0, 190.0, 190.0, 190.0, 192.0, 162.0, 134.0, 195.5, 113.3, 20.000000000000014, 191.9, 180.8, 185.59999999999994], "policy_predator_policy_reward": [0.0, 7.0, 3.0, 10.0, 14.0, 0.0, 9.0, 13.0, 9.0, 0.0, 8.0, 0.0, 26.0, 0.0, 0.0, 4.0, 0.0, 18.0, 30.0, 5.0, 0.0, 0.0, 29.0, 0.0, 23.0, 18.0, 7.0, 0.0, 0.0, 3.0, 3.0, 18.0, 2.0, 30.0, 2.0, 23.0, 21.0, 7.0, 29.0, 38.0, 0.0, 6.0, 0.0, 0.0, 33.0, 6.0, 0.0, 11.0, 0.0, 13.0, 28.0, 13.0, 12.0, 1.0, 0.0, 0.0, 5.0, 0.0, 18.0, 17.0, 0.0, 14.0, 3.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 12.0, 32.0, 43.0, 10.0, 6.0, 0.0, 0.0, 17.0, 13.0, 12.0, 0.0, 0.0, 0.0, 1.0, 21.0, 14.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 29.0, 10.0, 2.0, 26.0, 6.0, 3.0, 1.0, 1.0, 0.0, 22.0, 0.0, 16.0, 16.0, 11.0, 27.0, 0.0, 11.0, 2.0, 13.0, 5.0, 5.0, 13.0, 12.0, 0.0, 23.0, 2.0, 4.0, 11.0, 3.0, 0.0, 15.0, 0.0, 0.0, 27.0, 28.0, 0.0, 2.0, 0.0, 0.0, 0.0, 11.0, 0.0, 8.0, 21.0, 0.0, 10.0, 2.0, 0.0, 0.0, 6.0, 10.0, 19.0, 0.0, 9.0, 25.0, 0.0, 2.0, 0.0, 0.0, 0.0, 9.0, 5.0, 1.0, 18.0, 4.0, 13.0, 3.0, 27.0, 29.0, 27.0, 18.0, 13.0, 19.0, 7.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 28.0, 15.0, 23.0, 0.0, 0.0, 7.0, 0.0, 0.0, 9.0, 11.0, 4.0, 0.0, 0.0, 0.0, 0.0, 28.0, 28.0, 0.0, 0.0, 0.0, 4.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6566367201507395, "mean_inference_ms": 4.898953886504078, "mean_action_processing_ms": 0.7979046589181266, "mean_env_wait_ms": 0.5703671121633738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010999441146850586, "StateBufferConnector_ms": 0.027216434478759766, "ViewRequirementAgentConnector_ms": 0.6523474454879761}, "num_episodes": 23, "episode_return_max": 399.1, "episode_return_min": 145.39999999999966, "episode_return_mean": 347.358, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 198.89711387607642, "num_env_steps_trained_throughput_per_sec": 198.89711387607642, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 1104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1104000, "timers": {"training_iteration_time_ms": 22298.198, "restore_workers_time_ms": 0.048, "training_step_time_ms": 22296.477, "sample_time_ms": 4359.754, "learn_time_ms": 17886.604, "learn_throughput": 223.631, "synch_weights_time_ms": 40.644}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 1104000, "num_agent_steps_trained": 1104000}, "done": false, "training_iteration": 69, "trial_id": "e4caa_00000", "date": "2024-08-13_20-11-08", "timestamp": 1723594268, "time_this_iter_s": 20.54802894592285, "time_total_s": 1602.1635377407074, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b296ee50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1602.1635377407074, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 75.05714285714285, "ram_util_percent": 82.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4746425556127356, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5633859123817828, "policy_loss": -0.005453779575139008, "vf_loss": 1.5677624383931437, "vf_explained_var": 0.37423815288871687, "kl": 0.007181683615148438, "entropy": 1.4435822693128435, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.43744492183129, "cur_kl_coeff": 5.820766091346741e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8399741484374597, "policy_loss": -0.0027369948397218077, "vf_loss": 0.8427111442836505, "vf_explained_var": 0.05946495728517966, "kl": 0.000949106376537989, "entropy": 0.07750162957876763, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 131355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 399.1, "episode_reward_min": 145.39999999999966, "episode_reward_mean": 344.546, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 16.09999999999996, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 55.0}, "policy_reward_mean": {"prey_policy": 163.74800000000002, "predator_policy": 8.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [327.8000000000001, 291.2, 387.1, 382.9, 320.2, 373.5, 364.10000000000014, 277.8, 178.99999999999943, 375.7, 371.10000000000014, 356.4, 363.9, 360.9, 389.2, 381.0, 348.0, 319.9, 360.8, 388.3, 357.4, 370.6, 373.0, 351.5, 362.1, 366.2, 399.1, 324.9, 374.8, 347.7, 390.2, 376.4, 344.29999999999995, 179.69999999999948, 201.29999999999964, 348.0, 370.0, 352.0, 352.0, 340.2, 382.6000000000001, 369.0000000000002, 351.1, 392.8, 340.4, 384.3, 388.29999999999995, 365.4, 382.20000000000005, 331.9, 369.1, 329.80000000000007, 347.59999999999997, 362.0, 304.1, 387.0, 391.0, 358.6, 386.20000000000005, 145.39999999999966, 240.79999999999959, 347.40000000000003, 303.70000000000005, 332.69999999999993, 374.3, 347.9, 370.29999999999995, 378.4, 385.6, 350.4, 382.9, 237.50000000000006, 348.6, 374.3, 394.6, 359.1, 384.0, 382.0, 324.0, 336.8, 211.8999999999993, 370.40000000000015, 326.4, 360.7, 386.70000000000016, 331.4, 268.8, 319.5, 322.4, 245.89999999999998, 358.1, 381.1, 341.5000000000001, 347.3, 361.6, 335.6000000000001, 371.0, 339.0, 269.89999999999975, 381.1], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [174.49999999999997, 125.3, 51.2, 173.0, 181.1, 200.0, 191.0, 191.9, 168.2, 113.0, 164.3, 198.2, 196.4, 154.69999999999996, 129.2, 107.6, 146.0, 20.000000000000014, 191.9, 183.79999999999998, 172.39999999999998, 193.7, 121.4, 200.0, 155.3, 194.6, 188.3, 161.6, 192.8, 196.4, 182.0, 199.0, 156.0, 175.0, 64.7, 180.2, 166.4, 178.4, 193.7, 194.6, 131.0, 196.4, 198.2, 160.39999999999998, 190.1, 182.9, 197.0, 132.5, 154.4, 193.7, 179.0, 180.2, 200.0, 199.1, 155.0, 140.9, 192.79999999999998, 170.0, 116.6, 199.1, 191.0, 195.2, 187.1, 188.3, 132.2, 190.1, 20.000000000000014, 127.7, 16.09999999999996, 147.2, 170.0, 167.0, 164.0, 191.0, 191.0, 151.0, 141.0, 186.0, 150.2, 167.0, 182.0, 194.59999999999997, 191.89999999999995, 163.1, 170.0, 166.1, 200.0, 192.8, 85.40000000000002, 200.0, 192.2, 190.1, 200.0, 188.3, 184.4, 170.0, 175.1, 199.1, 193.7, 117.2, 200.0, 157.1, 142.39999999999998, 187.4, 180.2, 151.4, 200.0, 143.0, 102.8, 167.3, 191.0, 194.0, 194.0, 197.0, 159.5, 190.1, 197.0, 183.2, 103.39999999999999, 20.000000000000014, 196.4, 28.399999999999963, 185.9, 105.5, 122.0, 136.7, 152.29999999999995, 148.4, 178.1, 189.2, 163.1, 168.8, 185.59999999999997, 184.7, 184.7, 193.7, 186.5, 199.1, 195.5, 140.9, 190.09999999999994, 192.8, 17.300000000000082, 177.2, 194.6, 131.0, 179.0, 188.3, 194.6, 200.0, 172.1, 167.0, 190.0, 190.0, 190.0, 192.0, 162.0, 134.0, 195.5, 113.3, 20.000000000000014, 191.9, 180.8, 185.59999999999994, 139.4, 161.0, 156.8, 191.89999999999998, 200.0, 175.69999999999996, 127.1, 179.3, 110.9, 122.9, 168.2, 113.3, 142.4, 155.0, 85.69999999999999, 105.2, 152.0, 190.1, 149.0, 199.1, 155.89999999999998, 185.6, 185.0, 140.3, 176.9, 166.7, 174.49999999999997, 136.1, 185.0, 183.0, 141.0, 169.0, 85.69999999999997, 177.2, 196.4, 184.7], "policy_predator_policy_reward": [21.0, 7.0, 29.0, 38.0, 0.0, 6.0, 0.0, 0.0, 33.0, 6.0, 0.0, 11.0, 0.0, 13.0, 28.0, 13.0, 12.0, 1.0, 0.0, 0.0, 5.0, 0.0, 18.0, 17.0, 0.0, 14.0, 3.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 12.0, 32.0, 43.0, 10.0, 6.0, 0.0, 0.0, 17.0, 13.0, 12.0, 0.0, 0.0, 0.0, 1.0, 21.0, 14.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 29.0, 10.0, 2.0, 26.0, 6.0, 3.0, 1.0, 1.0, 0.0, 22.0, 0.0, 16.0, 16.0, 11.0, 27.0, 0.0, 11.0, 2.0, 13.0, 5.0, 5.0, 13.0, 12.0, 0.0, 23.0, 2.0, 4.0, 11.0, 3.0, 0.0, 15.0, 0.0, 0.0, 27.0, 28.0, 0.0, 2.0, 0.0, 0.0, 0.0, 11.0, 0.0, 8.0, 21.0, 0.0, 10.0, 2.0, 0.0, 0.0, 6.0, 10.0, 19.0, 0.0, 9.0, 25.0, 0.0, 2.0, 0.0, 0.0, 0.0, 9.0, 5.0, 1.0, 18.0, 4.0, 13.0, 3.0, 27.0, 29.0, 27.0, 18.0, 13.0, 19.0, 7.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 28.0, 15.0, 23.0, 0.0, 0.0, 7.0, 0.0, 0.0, 9.0, 11.0, 4.0, 0.0, 0.0, 0.0, 0.0, 28.0, 28.0, 0.0, 0.0, 0.0, 4.0, 0.0, 25.0, 1.0, 12.0, 0.0, 5.0, 6.0, 25.0, 0.0, 35.0, 0.0, 7.0, 31.0, 24.0, 1.0, 55.0, 0.0, 4.0, 12.0, 16.0, 17.0, 0.0, 0.0, 0.0, 22.0, 11.0, 7.0, 20.0, 5.0, 3.0, 0.0, 19.0, 10.0, 0.0, 7.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6693174330136316, "mean_inference_ms": 4.943532682887661, "mean_action_processing_ms": 0.8009603069732424, "mean_env_wait_ms": 0.5761300104869431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02198970317840576, "StateBufferConnector_ms": 0.02784574031829834, "ViewRequirementAgentConnector_ms": 0.8236250877380371}, "num_episodes": 18, "episode_return_max": 399.1, "episode_return_min": 145.39999999999966, "episode_return_mean": 344.546, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 155.19808847111454, "num_env_steps_trained_throughput_per_sec": 155.19808847111454, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 22788.301, "restore_workers_time_ms": 0.058, "training_step_time_ms": 22786.555, "sample_time_ms": 5246.235, "learn_time_ms": 17495.441, "learn_throughput": 228.631, "synch_weights_time_ms": 34.955}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 70, "trial_id": "e4caa_00000", "date": "2024-08-13_20-11-34", "timestamp": 1723594294, "time_this_iter_s": 25.86174201965332, "time_total_s": 1628.0252797603607, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2958670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1628.0252797603607, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 80.29722222222223, "ram_util_percent": 84.05}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4567076347807726, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.5565100530152598, "policy_loss": -0.005661185184572503, "vf_loss": 1.5615463609733278, "vf_explained_var": 0.22075344084431886, "kl": 0.004165826582643435, "entropy": 1.4340139715759843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6918866988527712, "cur_kl_coeff": 2.9103830456733705e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0118807473037608, "policy_loss": -0.0036903374931878514, "vf_loss": 1.0155710839641787, "vf_explained_var": 0.088366218786391, "kl": 0.002339933391282635, "entropy": 0.07505339184608409, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 133245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "env_runners": {"episode_reward_max": 399.1, "episode_reward_min": 145.39999999999966, "episode_reward_mean": 345.398, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -21.399999999999892, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 55.0}, "policy_reward_mean": {"prey_policy": 164.74399999999997, "predator_policy": 7.955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.8, 388.3, 357.4, 370.6, 373.0, 351.5, 362.1, 366.2, 399.1, 324.9, 374.8, 347.7, 390.2, 376.4, 344.29999999999995, 179.69999999999948, 201.29999999999964, 348.0, 370.0, 352.0, 352.0, 340.2, 382.6000000000001, 369.0000000000002, 351.1, 392.8, 340.4, 384.3, 388.29999999999995, 365.4, 382.20000000000005, 331.9, 369.1, 329.80000000000007, 347.59999999999997, 362.0, 304.1, 387.0, 391.0, 358.6, 386.20000000000005, 145.39999999999966, 240.79999999999959, 347.40000000000003, 303.70000000000005, 332.69999999999993, 374.3, 347.9, 370.29999999999995, 378.4, 385.6, 350.4, 382.9, 237.50000000000006, 348.6, 374.3, 394.6, 359.1, 384.0, 382.0, 324.0, 336.8, 211.8999999999993, 370.40000000000015, 326.4, 360.7, 386.70000000000016, 331.4, 268.8, 319.5, 322.4, 245.89999999999998, 358.1, 381.1, 341.5000000000001, 347.3, 361.6, 335.6000000000001, 371.0, 339.0, 269.89999999999975, 381.1, 393.7, 357.3, 311.6, 382.9, 382.1, 357.0, 261.0999999999997, 348.2000000000001, 302.6, 390.1, 324.6, 378.1, 354.90000000000003, 335.5, 393.0, 367.0, 387.4, 227.79999999999995], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [166.4, 178.4, 193.7, 194.6, 131.0, 196.4, 198.2, 160.39999999999998, 190.1, 182.9, 197.0, 132.5, 154.4, 193.7, 179.0, 180.2, 200.0, 199.1, 155.0, 140.9, 192.79999999999998, 170.0, 116.6, 199.1, 191.0, 195.2, 187.1, 188.3, 132.2, 190.1, 20.000000000000014, 127.7, 16.09999999999996, 147.2, 170.0, 167.0, 164.0, 191.0, 191.0, 151.0, 141.0, 186.0, 150.2, 167.0, 182.0, 194.59999999999997, 191.89999999999995, 163.1, 170.0, 166.1, 200.0, 192.8, 85.40000000000002, 200.0, 192.2, 190.1, 200.0, 188.3, 184.4, 170.0, 175.1, 199.1, 193.7, 117.2, 200.0, 157.1, 142.39999999999998, 187.4, 180.2, 151.4, 200.0, 143.0, 102.8, 167.3, 191.0, 194.0, 194.0, 197.0, 159.5, 190.1, 197.0, 183.2, 103.39999999999999, 20.000000000000014, 196.4, 28.399999999999963, 185.9, 105.5, 122.0, 136.7, 152.29999999999995, 148.4, 178.1, 189.2, 163.1, 168.8, 185.59999999999997, 184.7, 184.7, 193.7, 186.5, 199.1, 195.5, 140.9, 190.09999999999994, 192.8, 17.300000000000082, 177.2, 194.6, 131.0, 179.0, 188.3, 194.6, 200.0, 172.1, 167.0, 190.0, 190.0, 190.0, 192.0, 162.0, 134.0, 195.5, 113.3, 20.000000000000014, 191.9, 180.8, 185.59999999999994, 139.4, 161.0, 156.8, 191.89999999999998, 200.0, 175.69999999999996, 127.1, 179.3, 110.9, 122.9, 168.2, 113.3, 142.4, 155.0, 85.69999999999999, 105.2, 152.0, 190.1, 149.0, 199.1, 155.89999999999998, 185.6, 185.0, 140.3, 176.9, 166.7, 174.49999999999997, 136.1, 185.0, 183.0, 141.0, 169.0, 85.69999999999997, 177.2, 196.4, 184.7, 195.5, 198.2, 168.2, 172.1, 132.5, 169.1, 195.5, 187.4, 195.5, 182.6, 155.0, 179.0, 52.09999999999997, 194.0, 142.69999999999996, 189.49999999999997, 92.6, 167.0, 200.0, 190.1, 193.7, 110.89999999999999, 182.0, 190.1, 197.3, 143.6, 181.1, 133.4, 195.0, 197.0, 157.0, 199.0, 196.4, 191.0, 189.20000000000002, -21.399999999999892], "policy_predator_policy_reward": [10.0, 6.0, 0.0, 0.0, 17.0, 13.0, 12.0, 0.0, 0.0, 0.0, 1.0, 21.0, 14.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 29.0, 10.0, 2.0, 26.0, 6.0, 3.0, 1.0, 1.0, 0.0, 22.0, 0.0, 16.0, 16.0, 11.0, 27.0, 0.0, 11.0, 2.0, 13.0, 5.0, 5.0, 13.0, 12.0, 0.0, 23.0, 2.0, 4.0, 11.0, 3.0, 0.0, 15.0, 0.0, 0.0, 27.0, 28.0, 0.0, 2.0, 0.0, 0.0, 0.0, 11.0, 0.0, 8.0, 21.0, 0.0, 10.0, 2.0, 0.0, 0.0, 6.0, 10.0, 19.0, 0.0, 9.0, 25.0, 0.0, 2.0, 0.0, 0.0, 0.0, 9.0, 5.0, 1.0, 18.0, 4.0, 13.0, 3.0, 27.0, 29.0, 27.0, 18.0, 13.0, 19.0, 7.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 28.0, 15.0, 23.0, 0.0, 0.0, 7.0, 0.0, 0.0, 9.0, 11.0, 4.0, 0.0, 0.0, 0.0, 0.0, 28.0, 28.0, 0.0, 0.0, 0.0, 4.0, 0.0, 25.0, 1.0, 12.0, 0.0, 5.0, 6.0, 25.0, 0.0, 35.0, 0.0, 7.0, 31.0, 24.0, 1.0, 55.0, 0.0, 4.0, 12.0, 16.0, 17.0, 0.0, 0.0, 0.0, 22.0, 11.0, 7.0, 20.0, 5.0, 3.0, 0.0, 19.0, 10.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 13.0, 10.0, 2.0, 13.0, 16.0, 0.0, 15.0, 28.0, 0.0, 0.0, 8.0, 12.0, 0.0, 6.0, 0.0, 14.0, 11.0, 10.0, 0.0, 1.0, 0.0, 11.0, 0.0, 0.0, 47.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6870689010165976, "mean_inference_ms": 5.003372598654586, "mean_action_processing_ms": 0.8065555695276087, "mean_env_wait_ms": 0.5835635132844753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02557229995727539, "StateBufferConnector_ms": 0.030255436897277832, "ViewRequirementAgentConnector_ms": 0.8483645915985107}, "num_episodes": 18, "episode_return_max": 399.1, "episode_return_min": 145.39999999999966, "episode_return_mean": 345.398, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 162.7257260561202, "num_env_steps_trained_throughput_per_sec": 162.7257260561202, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 1136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1136000, "timers": {"training_iteration_time_ms": 22572.766, "restore_workers_time_ms": 0.058, "training_step_time_ms": 22571.021, "sample_time_ms": 5396.578, "learn_time_ms": 17130.354, "learn_throughput": 233.504, "synch_weights_time_ms": 34.626}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 1136000, "num_agent_steps_trained": 1136000}, "done": false, "training_iteration": 71, "trial_id": "e4caa_00000", "date": "2024-08-13_20-11-59", "timestamp": 1723594319, "time_this_iter_s": 24.64807391166687, "time_total_s": 1652.6733536720276, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2958e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1652.6733536720276, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 81.36000000000001, "ram_util_percent": 83.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7456694722806336, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.610364162196558, "policy_loss": -0.006122678726857341, "vf_loss": 1.6157966832635264, "vf_explained_var": 0.17092656616180663, "kl": 0.009202047414835416, "entropy": 1.4354140355473473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.685762013219021, "cur_kl_coeff": 1.4551915228366853e-12, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6590291637276846, "policy_loss": -0.0033986368440781477, "vf_loss": 0.6624278006572571, "vf_explained_var": 0.10037759252326198, "kl": 0.0014940789278045264, "entropy": 0.08273719599243826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 135135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 145.39999999999966, "episode_reward_mean": 348.7389999999999, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -21.399999999999892, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 55.0}, "policy_reward_mean": {"prey_policy": 166.71949999999998, "predator_policy": 7.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [382.6000000000001, 369.0000000000002, 351.1, 392.8, 340.4, 384.3, 388.29999999999995, 365.4, 382.20000000000005, 331.9, 369.1, 329.80000000000007, 347.59999999999997, 362.0, 304.1, 387.0, 391.0, 358.6, 386.20000000000005, 145.39999999999966, 240.79999999999959, 347.40000000000003, 303.70000000000005, 332.69999999999993, 374.3, 347.9, 370.29999999999995, 378.4, 385.6, 350.4, 382.9, 237.50000000000006, 348.6, 374.3, 394.6, 359.1, 384.0, 382.0, 324.0, 336.8, 211.8999999999993, 370.40000000000015, 326.4, 360.7, 386.70000000000016, 331.4, 268.8, 319.5, 322.4, 245.89999999999998, 358.1, 381.1, 341.5000000000001, 347.3, 361.6, 335.6000000000001, 371.0, 339.0, 269.89999999999975, 381.1, 393.7, 357.3, 311.6, 382.9, 382.1, 357.0, 261.0999999999997, 348.2000000000001, 302.6, 390.1, 324.6, 378.1, 354.90000000000003, 335.5, 393.0, 367.0, 387.4, 227.79999999999995, 400.0, 384.70000000000005, 329.6, 292.9, 312.40000000000003, 388.1, 322.1, 391.9, 369.0, 367.0000000000001, 318.30000000000007, 373.9, 382.00000000000006, 316.50000000000006, 379.3, 365.7, 360.6, 375.4, 382.0, 391.0, 371.20000000000005, 391.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [182.0, 194.59999999999997, 191.89999999999995, 163.1, 170.0, 166.1, 200.0, 192.8, 85.40000000000002, 200.0, 192.2, 190.1, 200.0, 188.3, 184.4, 170.0, 175.1, 199.1, 193.7, 117.2, 200.0, 157.1, 142.39999999999998, 187.4, 180.2, 151.4, 200.0, 143.0, 102.8, 167.3, 191.0, 194.0, 194.0, 197.0, 159.5, 190.1, 197.0, 183.2, 103.39999999999999, 20.000000000000014, 196.4, 28.399999999999963, 185.9, 105.5, 122.0, 136.7, 152.29999999999995, 148.4, 178.1, 189.2, 163.1, 168.8, 185.59999999999997, 184.7, 184.7, 193.7, 186.5, 199.1, 195.5, 140.9, 190.09999999999994, 192.8, 17.300000000000082, 177.2, 194.6, 131.0, 179.0, 188.3, 194.6, 200.0, 172.1, 167.0, 190.0, 190.0, 190.0, 192.0, 162.0, 134.0, 195.5, 113.3, 20.000000000000014, 191.9, 180.8, 185.59999999999994, 139.4, 161.0, 156.8, 191.89999999999998, 200.0, 175.69999999999996, 127.1, 179.3, 110.9, 122.9, 168.2, 113.3, 142.4, 155.0, 85.69999999999999, 105.2, 152.0, 190.1, 149.0, 199.1, 155.89999999999998, 185.6, 185.0, 140.3, 176.9, 166.7, 174.49999999999997, 136.1, 185.0, 183.0, 141.0, 169.0, 85.69999999999997, 177.2, 196.4, 184.7, 195.5, 198.2, 168.2, 172.1, 132.5, 169.1, 195.5, 187.4, 195.5, 182.6, 155.0, 179.0, 52.09999999999997, 194.0, 142.69999999999996, 189.49999999999997, 92.6, 167.0, 200.0, 190.1, 193.7, 110.89999999999999, 182.0, 190.1, 197.3, 143.6, 181.1, 133.4, 195.0, 197.0, 157.0, 199.0, 196.4, 191.0, 189.20000000000002, -21.399999999999892, 200.0, 200.0, 187.39999999999998, 197.3, 116.0, 185.6, 73.7, 168.2, 94.4, 194.0, 198.2, 188.9, 92.3, 192.8, 191.9, 200.0, 179.0, 182.0, 172.39999999999998, 182.6, 128.29999999999998, 152.0, 185.59999999999997, 188.3, 190.99999999999997, 191.0, 134.0, 147.5, 196.4, 182.9, 175.7, 176.0, 194.6, 149.0, 188.29999999999998, 181.1, 192.0, 190.0, 190.0, 199.0, 152.0, 198.2, 194.6, 196.4], "policy_predator_policy_reward": [2.0, 4.0, 11.0, 3.0, 0.0, 15.0, 0.0, 0.0, 27.0, 28.0, 0.0, 2.0, 0.0, 0.0, 0.0, 11.0, 0.0, 8.0, 21.0, 0.0, 10.0, 2.0, 0.0, 0.0, 6.0, 10.0, 19.0, 0.0, 9.0, 25.0, 0.0, 2.0, 0.0, 0.0, 0.0, 9.0, 5.0, 1.0, 18.0, 4.0, 13.0, 3.0, 27.0, 29.0, 27.0, 18.0, 13.0, 19.0, 7.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 28.0, 15.0, 23.0, 0.0, 0.0, 7.0, 0.0, 0.0, 9.0, 11.0, 4.0, 0.0, 0.0, 0.0, 0.0, 28.0, 28.0, 0.0, 0.0, 0.0, 4.0, 0.0, 25.0, 1.0, 12.0, 0.0, 5.0, 6.0, 25.0, 0.0, 35.0, 0.0, 7.0, 31.0, 24.0, 1.0, 55.0, 0.0, 4.0, 12.0, 16.0, 17.0, 0.0, 0.0, 0.0, 22.0, 11.0, 7.0, 20.0, 5.0, 3.0, 0.0, 19.0, 10.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 13.0, 10.0, 2.0, 13.0, 16.0, 0.0, 15.0, 28.0, 0.0, 0.0, 8.0, 12.0, 0.0, 6.0, 0.0, 14.0, 11.0, 10.0, 0.0, 1.0, 0.0, 11.0, 0.0, 0.0, 47.0, 13.0, 0.0, 0.0, 0.0, 0.0, 28.0, 0.0, 39.0, 12.0, 0.0, 24.0, 1.0, 0.0, 5.0, 32.0, 0.0, 0.0, 7.0, 1.0, 12.0, 0.0, 20.0, 18.0, 0.0, 0.0, 0.0, 0.0, 13.0, 22.0, 0.0, 0.0, 8.0, 6.0, 0.0, 17.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 6.0, 15.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.710385621889338, "mean_inference_ms": 5.08344798857623, "mean_action_processing_ms": 0.8140422978492837, "mean_env_wait_ms": 0.5930752420088483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.036420345306396484, "StateBufferConnector_ms": 0.02433955669403076, "ViewRequirementAgentConnector_ms": 0.8158692121505737}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 145.39999999999966, "episode_return_mean": 348.7389999999999, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.2761189505146, "num_env_steps_trained_throughput_per_sec": 241.2761189505146, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 1152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1152000, "timers": {"training_iteration_time_ms": 21210.594, "restore_workers_time_ms": 0.057, "training_step_time_ms": 21208.852, "sample_time_ms": 5319.051, "learn_time_ms": 15846.453, "learn_throughput": 252.422, "synch_weights_time_ms": 34.461}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 1152000, "num_agent_steps_trained": 1152000}, "done": false, "training_iteration": 72, "trial_id": "e4caa_00000", "date": "2024-08-13_20-12-15", "timestamp": 1723594335, "time_this_iter_s": 16.58514976501465, "time_total_s": 1669.2585034370422, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29adee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1669.2585034370422, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 63.59583333333333, "ram_util_percent": 80.94583333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.425498464072823, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9273633628068542, "policy_loss": -0.007969257684927138, "vf_loss": 0.9348254111196314, "vf_explained_var": 0.24052852480499834, "kl": 0.006762815826701414, "entropy": 1.4245251810109174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2555053509495877, "cur_kl_coeff": 7.275957614183426e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.47430262725662303, "policy_loss": -0.003744964808639553, "vf_loss": 0.4780475922313238, "vf_explained_var": 0.09340317145226494, "kl": 0.001800526020240517, "entropy": 0.08472629762673504, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 137025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 211.8999999999993, "episode_reward_mean": 352.7, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -21.399999999999892, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 55.0}, "policy_reward_mean": {"prey_policy": 169.005, "predator_policy": 7.345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [332.69999999999993, 374.3, 347.9, 370.29999999999995, 378.4, 385.6, 350.4, 382.9, 237.50000000000006, 348.6, 374.3, 394.6, 359.1, 384.0, 382.0, 324.0, 336.8, 211.8999999999993, 370.40000000000015, 326.4, 360.7, 386.70000000000016, 331.4, 268.8, 319.5, 322.4, 245.89999999999998, 358.1, 381.1, 341.5000000000001, 347.3, 361.6, 335.6000000000001, 371.0, 339.0, 269.89999999999975, 381.1, 393.7, 357.3, 311.6, 382.9, 382.1, 357.0, 261.0999999999997, 348.2000000000001, 302.6, 390.1, 324.6, 378.1, 354.90000000000003, 335.5, 393.0, 367.0, 387.4, 227.79999999999995, 400.0, 384.70000000000005, 329.6, 292.9, 312.40000000000003, 388.1, 322.1, 391.9, 369.0, 367.0000000000001, 318.30000000000007, 373.9, 382.00000000000006, 316.50000000000006, 379.3, 365.7, 360.6, 375.4, 382.0, 391.0, 371.20000000000005, 391.0, 343.80000000000007, 378.29999999999995, 352.5, 368.0, 372.0, 373.90000000000003, 380.2, 315.0, 317.29999999999995, 379.5, 392.8, 381.1000000000001, 342.8, 351.6, 345.80000000000007, 376.6, 395.5, 347.0, 382.0, 335.0, 398.2, 344.29999999999995, 383.59999999999997], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [152.29999999999995, 148.4, 178.1, 189.2, 163.1, 168.8, 185.59999999999997, 184.7, 184.7, 193.7, 186.5, 199.1, 195.5, 140.9, 190.09999999999994, 192.8, 17.300000000000082, 177.2, 194.6, 131.0, 179.0, 188.3, 194.6, 200.0, 172.1, 167.0, 190.0, 190.0, 190.0, 192.0, 162.0, 134.0, 195.5, 113.3, 20.000000000000014, 191.9, 180.8, 185.59999999999994, 139.4, 161.0, 156.8, 191.89999999999998, 200.0, 175.69999999999996, 127.1, 179.3, 110.9, 122.9, 168.2, 113.3, 142.4, 155.0, 85.69999999999999, 105.2, 152.0, 190.1, 149.0, 199.1, 155.89999999999998, 185.6, 185.0, 140.3, 176.9, 166.7, 174.49999999999997, 136.1, 185.0, 183.0, 141.0, 169.0, 85.69999999999997, 177.2, 196.4, 184.7, 195.5, 198.2, 168.2, 172.1, 132.5, 169.1, 195.5, 187.4, 195.5, 182.6, 155.0, 179.0, 52.09999999999997, 194.0, 142.69999999999996, 189.49999999999997, 92.6, 167.0, 200.0, 190.1, 193.7, 110.89999999999999, 182.0, 190.1, 197.3, 143.6, 181.1, 133.4, 195.0, 197.0, 157.0, 199.0, 196.4, 191.0, 189.20000000000002, -21.399999999999892, 200.0, 200.0, 187.39999999999998, 197.3, 116.0, 185.6, 73.7, 168.2, 94.4, 194.0, 198.2, 188.9, 92.3, 192.8, 191.9, 200.0, 179.0, 182.0, 172.39999999999998, 182.6, 128.29999999999998, 152.0, 185.59999999999997, 188.3, 190.99999999999997, 191.0, 134.0, 147.5, 196.4, 182.9, 175.7, 176.0, 194.6, 149.0, 188.29999999999998, 181.1, 192.0, 190.0, 190.0, 199.0, 152.0, 198.2, 194.6, 196.4, 190.1, 142.7, 200.0, 173.3, 168.8, 166.7, 182.0, 170.0, 193.7, 173.3, 173.0, 191.9, 186.5, 193.7, 106.10000000000001, 188.9, 110.0, 167.29999999999998, 196.4, 175.1, 200.0, 192.8, 185.59999999999997, 195.5, 120.5, 197.3, 181.7, 140.9, 165.79999999999998, 158.0, 182.9, 193.7, 197.3, 198.2, 179.0, 152.0, 187.0, 193.0, 131.0, 174.0, 198.2, 200.0, 182.0, 110.3, 193.39999999999998, 189.2], "policy_predator_policy_reward": [13.0, 19.0, 7.0, 0.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 28.0, 15.0, 23.0, 0.0, 0.0, 7.0, 0.0, 0.0, 9.0, 11.0, 4.0, 0.0, 0.0, 0.0, 0.0, 28.0, 28.0, 0.0, 0.0, 0.0, 4.0, 0.0, 25.0, 1.0, 12.0, 0.0, 5.0, 6.0, 25.0, 0.0, 35.0, 0.0, 7.0, 31.0, 24.0, 1.0, 55.0, 0.0, 4.0, 12.0, 16.0, 17.0, 0.0, 0.0, 0.0, 22.0, 11.0, 7.0, 20.0, 5.0, 3.0, 0.0, 19.0, 10.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 13.0, 10.0, 2.0, 13.0, 16.0, 0.0, 15.0, 28.0, 0.0, 0.0, 8.0, 12.0, 0.0, 6.0, 0.0, 14.0, 11.0, 10.0, 0.0, 1.0, 0.0, 11.0, 0.0, 0.0, 47.0, 13.0, 0.0, 0.0, 0.0, 0.0, 28.0, 0.0, 39.0, 12.0, 0.0, 24.0, 1.0, 0.0, 5.0, 32.0, 0.0, 0.0, 7.0, 1.0, 12.0, 0.0, 20.0, 18.0, 0.0, 0.0, 0.0, 0.0, 13.0, 22.0, 0.0, 0.0, 8.0, 6.0, 0.0, 17.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 6.0, 15.0, 0.0, 0.0, 0.0, 11.0, 0.0, 5.0, 6.0, 11.0, 10.0, 6.0, 5.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 20.0, 33.0, 7.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.0, 13.0, 16.0, 13.0, 9.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 2.0, 8.0, 22.0, 0.0, 0.0, 27.0, 25.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7178405925852394, "mean_inference_ms": 5.115903181712102, "mean_action_processing_ms": 0.8182932908055407, "mean_env_wait_ms": 0.598379898975165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0363389253616333, "StateBufferConnector_ms": 0.008002281188964844, "ViewRequirementAgentConnector_ms": 0.4281378984451294}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 211.8999999999993, "episode_return_mean": 352.7, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.04539320466665, "num_env_steps_trained_throughput_per_sec": 274.04539320466665, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 1168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1168000, "timers": {"training_iteration_time_ms": 20452.475, "restore_workers_time_ms": 0.055, "training_step_time_ms": 20450.741, "sample_time_ms": 5254.823, "learn_time_ms": 15155.185, "learn_throughput": 263.936, "synch_weights_time_ms": 32.106}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 1168000, "num_agent_steps_trained": 1168000}, "done": false, "training_iteration": 73, "trial_id": "e4caa_00000", "date": "2024-08-13_20-12-30", "timestamp": 1723594350, "time_this_iter_s": 14.645279884338379, "time_total_s": 1683.9037833213806, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2871c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1683.9037833213806, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 61.5904761904762, "ram_util_percent": 79.4095238095238}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1874673051808875, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.3348077258735738, "policy_loss": -0.009706867053838712, "vf_loss": 1.3436460546873235, "vf_explained_var": 0.38167237374517654, "kl": 0.01158050091873818, "entropy": 1.433340359364868, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.83416724536154, "cur_kl_coeff": 3.637978807091713e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0834425282383722, "policy_loss": -0.0027816171844110443, "vf_loss": 1.0862241461557687, "vf_explained_var": 0.0272696576421223, "kl": 0.0011715260739067486, "entropy": 0.08623234226747796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 138915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 189.0999999999994, "episode_reward_mean": 352.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -21.399999999999892, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 55.0}, "policy_reward_mean": {"prey_policy": 168.775, "predator_policy": 7.565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.40000000000015, 326.4, 360.7, 386.70000000000016, 331.4, 268.8, 319.5, 322.4, 245.89999999999998, 358.1, 381.1, 341.5000000000001, 347.3, 361.6, 335.6000000000001, 371.0, 339.0, 269.89999999999975, 381.1, 393.7, 357.3, 311.6, 382.9, 382.1, 357.0, 261.0999999999997, 348.2000000000001, 302.6, 390.1, 324.6, 378.1, 354.90000000000003, 335.5, 393.0, 367.0, 387.4, 227.79999999999995, 400.0, 384.70000000000005, 329.6, 292.9, 312.40000000000003, 388.1, 322.1, 391.9, 369.0, 367.0000000000001, 318.30000000000007, 373.9, 382.00000000000006, 316.50000000000006, 379.3, 365.7, 360.6, 375.4, 382.0, 391.0, 371.20000000000005, 391.0, 343.80000000000007, 378.29999999999995, 352.5, 368.0, 372.0, 373.90000000000003, 380.2, 315.0, 317.29999999999995, 379.5, 392.8, 381.1000000000001, 342.8, 351.6, 345.80000000000007, 376.6, 395.5, 347.0, 382.0, 335.0, 398.2, 344.29999999999995, 383.59999999999997, 366.0, 360.7, 396.4, 259.29999999999995, 354.0, 360.0, 400.0, 242.3999999999997, 350.0, 380.5, 391.0, 189.0999999999994, 394.6, 377.2, 352.0, 328.0, 390.1, 382.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [180.8, 185.59999999999994, 139.4, 161.0, 156.8, 191.89999999999998, 200.0, 175.69999999999996, 127.1, 179.3, 110.9, 122.9, 168.2, 113.3, 142.4, 155.0, 85.69999999999999, 105.2, 152.0, 190.1, 149.0, 199.1, 155.89999999999998, 185.6, 185.0, 140.3, 176.9, 166.7, 174.49999999999997, 136.1, 185.0, 183.0, 141.0, 169.0, 85.69999999999997, 177.2, 196.4, 184.7, 195.5, 198.2, 168.2, 172.1, 132.5, 169.1, 195.5, 187.4, 195.5, 182.6, 155.0, 179.0, 52.09999999999997, 194.0, 142.69999999999996, 189.49999999999997, 92.6, 167.0, 200.0, 190.1, 193.7, 110.89999999999999, 182.0, 190.1, 197.3, 143.6, 181.1, 133.4, 195.0, 197.0, 157.0, 199.0, 196.4, 191.0, 189.20000000000002, -21.399999999999892, 200.0, 200.0, 187.39999999999998, 197.3, 116.0, 185.6, 73.7, 168.2, 94.4, 194.0, 198.2, 188.9, 92.3, 192.8, 191.9, 200.0, 179.0, 182.0, 172.39999999999998, 182.6, 128.29999999999998, 152.0, 185.59999999999997, 188.3, 190.99999999999997, 191.0, 134.0, 147.5, 196.4, 182.9, 175.7, 176.0, 194.6, 149.0, 188.29999999999998, 181.1, 192.0, 190.0, 190.0, 199.0, 152.0, 198.2, 194.6, 196.4, 190.1, 142.7, 200.0, 173.3, 168.8, 166.7, 182.0, 170.0, 193.7, 173.3, 173.0, 191.9, 186.5, 193.7, 106.10000000000001, 188.9, 110.0, 167.29999999999998, 196.4, 175.1, 200.0, 192.8, 185.59999999999997, 195.5, 120.5, 197.3, 181.7, 140.9, 165.79999999999998, 158.0, 182.9, 193.7, 197.3, 198.2, 179.0, 152.0, 187.0, 193.0, 131.0, 174.0, 198.2, 200.0, 182.0, 110.3, 193.39999999999998, 189.2, 173.3, 184.7, 192.8, 128.9, 196.4, 200.0, 47.59999999999998, 184.7, 173.0, 155.0, 185.0, 146.0, 200.0, 200.0, 183.2, 30.199999999999967, 167.0, 164.0, 186.5, 191.0, 200.0, 191.0, 154.1, 20.000000000000014, 198.2, 196.4, 165.2, 200.0, 194.0, 125.0, 152.0, 159.0, 190.1, 200.0, 173.0, 200.0], "policy_predator_policy_reward": [4.0, 0.0, 25.0, 1.0, 12.0, 0.0, 5.0, 6.0, 25.0, 0.0, 35.0, 0.0, 7.0, 31.0, 24.0, 1.0, 55.0, 0.0, 4.0, 12.0, 16.0, 17.0, 0.0, 0.0, 0.0, 22.0, 11.0, 7.0, 20.0, 5.0, 3.0, 0.0, 19.0, 10.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 13.0, 10.0, 2.0, 13.0, 16.0, 0.0, 15.0, 28.0, 0.0, 0.0, 8.0, 12.0, 0.0, 6.0, 0.0, 14.0, 11.0, 10.0, 0.0, 1.0, 0.0, 11.0, 0.0, 0.0, 47.0, 13.0, 0.0, 0.0, 0.0, 0.0, 28.0, 0.0, 39.0, 12.0, 0.0, 24.0, 1.0, 0.0, 5.0, 32.0, 0.0, 0.0, 7.0, 1.0, 12.0, 0.0, 20.0, 18.0, 0.0, 0.0, 0.0, 0.0, 13.0, 22.0, 0.0, 0.0, 8.0, 6.0, 0.0, 17.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 6.0, 15.0, 0.0, 0.0, 0.0, 11.0, 0.0, 5.0, 6.0, 11.0, 10.0, 6.0, 5.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 20.0, 33.0, 7.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.0, 13.0, 16.0, 13.0, 9.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 2.0, 8.0, 22.0, 0.0, 0.0, 27.0, 25.0, 1.0, 0.0, 8.0, 0.0, 20.0, 19.0, 0.0, 0.0, 19.0, 8.0, 11.0, 15.0, 16.0, 13.0, 0.0, 0.0, 17.0, 12.0, 19.0, 0.0, 3.0, 0.0, 0.0, 0.0, 14.0, 1.0, 0.0, 0.0, 11.0, 1.0, 8.0, 25.0, 0.0, 17.0, 0.0, 0.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7278578584084228, "mean_inference_ms": 5.14700286109246, "mean_action_processing_ms": 0.8171615495641514, "mean_env_wait_ms": 0.6005763347955256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03261125087738037, "StateBufferConnector_ms": 0.007836103439331055, "ViewRequirementAgentConnector_ms": 0.40041589736938477}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 189.0999999999994, "episode_return_mean": 352.68, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.7118727584292, "num_env_steps_trained_throughput_per_sec": 289.7118727584292, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 1184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1184000, "timers": {"training_iteration_time_ms": 19689.293, "restore_workers_time_ms": 0.053, "training_step_time_ms": 19687.564, "sample_time_ms": 5160.477, "learn_time_ms": 14485.872, "learn_throughput": 276.131, "synch_weights_time_ms": 32.38}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 1184000, "num_agent_steps_trained": 1184000}, "done": false, "training_iteration": 74, "trial_id": "e4caa_00000", "date": "2024-08-13_20-12-44", "timestamp": 1723594364, "time_this_iter_s": 13.883023738861084, "time_total_s": 1697.7868070602417, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28791f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1697.7868070602417, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 55.02, "ram_util_percent": 79.86}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.314359235101276, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.4276609061571657, "policy_loss": -0.003032128570266265, "vf_loss": 1.4302279542993617, "vf_explained_var": 0.4569715290473252, "kl": 0.006201050754997178, "entropy": 1.442553413797308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4300986930491433, "cur_kl_coeff": 1.8189894035458566e-13, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.861106135857799, "policy_loss": -0.0016658648409974323, "vf_loss": 0.8627720014206947, "vf_explained_var": 0.0531568325701214, "kl": 0.0012823837064403951, "entropy": 0.07032735861601337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 140805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 189.0999999999994, "episode_reward_mean": 354.84799999999996, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -21.399999999999892, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 47.0}, "policy_reward_mean": {"prey_policy": 170.419, "predator_policy": 7.005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [381.1, 393.7, 357.3, 311.6, 382.9, 382.1, 357.0, 261.0999999999997, 348.2000000000001, 302.6, 390.1, 324.6, 378.1, 354.90000000000003, 335.5, 393.0, 367.0, 387.4, 227.79999999999995, 400.0, 384.70000000000005, 329.6, 292.9, 312.40000000000003, 388.1, 322.1, 391.9, 369.0, 367.0000000000001, 318.30000000000007, 373.9, 382.00000000000006, 316.50000000000006, 379.3, 365.7, 360.6, 375.4, 382.0, 391.0, 371.20000000000005, 391.0, 343.80000000000007, 378.29999999999995, 352.5, 368.0, 372.0, 373.90000000000003, 380.2, 315.0, 317.29999999999995, 379.5, 392.8, 381.1000000000001, 342.8, 351.6, 345.80000000000007, 376.6, 395.5, 347.0, 382.0, 335.0, 398.2, 344.29999999999995, 383.59999999999997, 366.0, 360.7, 396.4, 259.29999999999995, 354.0, 360.0, 400.0, 242.3999999999997, 350.0, 380.5, 391.0, 189.0999999999994, 394.6, 377.2, 352.0, 328.0, 390.1, 382.0, 391.9, 352.9, 370.6, 392.0, 344.4, 388.0, 345.1, 362.0, 351.0, 345.0, 317.69999999999993, 209.99999999999932, 241.1999999999996, 400.0, 387.0, 332.0, 373.70000000000005, 349.6], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [196.4, 184.7, 195.5, 198.2, 168.2, 172.1, 132.5, 169.1, 195.5, 187.4, 195.5, 182.6, 155.0, 179.0, 52.09999999999997, 194.0, 142.69999999999996, 189.49999999999997, 92.6, 167.0, 200.0, 190.1, 193.7, 110.89999999999999, 182.0, 190.1, 197.3, 143.6, 181.1, 133.4, 195.0, 197.0, 157.0, 199.0, 196.4, 191.0, 189.20000000000002, -21.399999999999892, 200.0, 200.0, 187.39999999999998, 197.3, 116.0, 185.6, 73.7, 168.2, 94.4, 194.0, 198.2, 188.9, 92.3, 192.8, 191.9, 200.0, 179.0, 182.0, 172.39999999999998, 182.6, 128.29999999999998, 152.0, 185.59999999999997, 188.3, 190.99999999999997, 191.0, 134.0, 147.5, 196.4, 182.9, 175.7, 176.0, 194.6, 149.0, 188.29999999999998, 181.1, 192.0, 190.0, 190.0, 199.0, 152.0, 198.2, 194.6, 196.4, 190.1, 142.7, 200.0, 173.3, 168.8, 166.7, 182.0, 170.0, 193.7, 173.3, 173.0, 191.9, 186.5, 193.7, 106.10000000000001, 188.9, 110.0, 167.29999999999998, 196.4, 175.1, 200.0, 192.8, 185.59999999999997, 195.5, 120.5, 197.3, 181.7, 140.9, 165.79999999999998, 158.0, 182.9, 193.7, 197.3, 198.2, 179.0, 152.0, 187.0, 193.0, 131.0, 174.0, 198.2, 200.0, 182.0, 110.3, 193.39999999999998, 189.2, 173.3, 184.7, 192.8, 128.9, 196.4, 200.0, 47.59999999999998, 184.7, 173.0, 155.0, 185.0, 146.0, 200.0, 200.0, 183.2, 30.199999999999967, 167.0, 164.0, 186.5, 191.0, 200.0, 191.0, 154.1, 20.000000000000014, 198.2, 196.4, 165.2, 200.0, 194.0, 125.0, 152.0, 159.0, 190.1, 200.0, 173.0, 200.0, 200.0, 191.9, 179.9, 158.0, 173.29999999999998, 179.3, 200.0, 179.0, 148.4, 182.0, 182.0, 200.0, 137.0, 181.1, 140.0, 200.0, 137.3, 193.7, 146.0, 176.0, 176.59999999999997, 103.1, 20.000000000000014, 185.0, 194.6, 23.599999999999966, 200.0, 200.0, 188.0, 199.0, 159.0, 144.0, 183.79999999999998, 188.9, 134.3, 197.3], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 10.0, 0.0, 0.0, 0.0, 4.0, 0.0, 13.0, 10.0, 2.0, 13.0, 16.0, 0.0, 15.0, 28.0, 0.0, 0.0, 8.0, 12.0, 0.0, 6.0, 0.0, 14.0, 11.0, 10.0, 0.0, 1.0, 0.0, 11.0, 0.0, 0.0, 47.0, 13.0, 0.0, 0.0, 0.0, 0.0, 28.0, 0.0, 39.0, 12.0, 0.0, 24.0, 1.0, 0.0, 5.0, 32.0, 0.0, 0.0, 7.0, 1.0, 12.0, 0.0, 20.0, 18.0, 0.0, 0.0, 0.0, 0.0, 13.0, 22.0, 0.0, 0.0, 8.0, 6.0, 0.0, 17.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 6.0, 15.0, 0.0, 0.0, 0.0, 11.0, 0.0, 5.0, 6.0, 11.0, 10.0, 6.0, 5.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 20.0, 33.0, 7.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.0, 13.0, 16.0, 13.0, 9.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 2.0, 8.0, 22.0, 0.0, 0.0, 27.0, 25.0, 1.0, 0.0, 8.0, 0.0, 20.0, 19.0, 0.0, 0.0, 19.0, 8.0, 11.0, 15.0, 16.0, 13.0, 0.0, 0.0, 17.0, 12.0, 19.0, 0.0, 3.0, 0.0, 0.0, 0.0, 14.0, 1.0, 0.0, 0.0, 11.0, 1.0, 8.0, 25.0, 0.0, 17.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 11.0, 4.0, 14.0, 4.0, 7.0, 6.0, 2.0, 12.0, 6.0, 0.0, 6.0, 21.0, 7.0, 15.0, 0.0, 20.0, 19.0, 4.0, 17.0, 21.0, 5.0, 0.0, 15.0, 8.0, 0.0, 0.0, 0.0, 0.0, 18.0, 11.0, 1.0, 0.0, 9.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7252571578283362, "mean_inference_ms": 5.14110198314964, "mean_action_processing_ms": 0.8149914757405906, "mean_env_wait_ms": 0.5995708803193968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022582650184631348, "StateBufferConnector_ms": 0.007252216339111328, "ViewRequirementAgentConnector_ms": 0.22157442569732666}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 189.0999999999994, "episode_return_mean": 354.84799999999996, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.2987387341951, "num_env_steps_trained_throughput_per_sec": 281.2987387341951, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 19354.691, "restore_workers_time_ms": 0.052, "training_step_time_ms": 19352.963, "sample_time_ms": 5065.663, "learn_time_ms": 14246.548, "learn_throughput": 280.77, "synch_weights_time_ms": 32.02}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 75, "trial_id": "e4caa_00000", "date": "2024-08-13_20-12-58", "timestamp": 1723594378, "time_this_iter_s": 14.251232147216797, "time_total_s": 1712.0380392074585, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29adca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1712.0380392074585, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 57.61999999999999, "ram_util_percent": 80.345}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.163892012235349, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9231726214999245, "policy_loss": -0.0075587186533662065, "vf_loss": 1.9295764380031162, "vf_explained_var": 0.4553357996637859, "kl": 0.015398741730906065, "entropy": 1.4314302074846137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.904943967322824, "cur_kl_coeff": 9.094947017729283e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9735195605212419, "policy_loss": -0.0029196558432732387, "vf_loss": 0.9764392173164105, "vf_explained_var": 0.10169068338379027, "kl": 0.001402022294704544, "entropy": 0.07831577038757069, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 142695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 176.79999999999947, "episode_reward_mean": 350.477, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 20.000000000000014, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 39.0}, "policy_reward_mean": {"prey_policy": 167.5835, "predator_policy": 7.655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.9, 312.40000000000003, 388.1, 322.1, 391.9, 369.0, 367.0000000000001, 318.30000000000007, 373.9, 382.00000000000006, 316.50000000000006, 379.3, 365.7, 360.6, 375.4, 382.0, 391.0, 371.20000000000005, 391.0, 343.80000000000007, 378.29999999999995, 352.5, 368.0, 372.0, 373.90000000000003, 380.2, 315.0, 317.29999999999995, 379.5, 392.8, 381.1000000000001, 342.8, 351.6, 345.80000000000007, 376.6, 395.5, 347.0, 382.0, 335.0, 398.2, 344.29999999999995, 383.59999999999997, 366.0, 360.7, 396.4, 259.29999999999995, 354.0, 360.0, 400.0, 242.3999999999997, 350.0, 380.5, 391.0, 189.0999999999994, 394.6, 377.2, 352.0, 328.0, 390.1, 382.0, 391.9, 352.9, 370.6, 392.0, 344.4, 388.0, 345.1, 362.0, 351.0, 345.0, 317.69999999999993, 209.99999999999932, 241.1999999999996, 400.0, 387.0, 332.0, 373.70000000000005, 349.6, 386.0, 335.0, 385.1, 371.6, 349.4, 332.79999999999995, 188.79999999999941, 363.0, 385.3, 278.70000000000005, 353.4, 176.79999999999947, 388.3, 207.99999999999932, 383.8, 282.30000000000007, 326.8, 346.8, 381.0, 329.0, 388.3, 373.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [73.7, 168.2, 94.4, 194.0, 198.2, 188.9, 92.3, 192.8, 191.9, 200.0, 179.0, 182.0, 172.39999999999998, 182.6, 128.29999999999998, 152.0, 185.59999999999997, 188.3, 190.99999999999997, 191.0, 134.0, 147.5, 196.4, 182.9, 175.7, 176.0, 194.6, 149.0, 188.29999999999998, 181.1, 192.0, 190.0, 190.0, 199.0, 152.0, 198.2, 194.6, 196.4, 190.1, 142.7, 200.0, 173.3, 168.8, 166.7, 182.0, 170.0, 193.7, 173.3, 173.0, 191.9, 186.5, 193.7, 106.10000000000001, 188.9, 110.0, 167.29999999999998, 196.4, 175.1, 200.0, 192.8, 185.59999999999997, 195.5, 120.5, 197.3, 181.7, 140.9, 165.79999999999998, 158.0, 182.9, 193.7, 197.3, 198.2, 179.0, 152.0, 187.0, 193.0, 131.0, 174.0, 198.2, 200.0, 182.0, 110.3, 193.39999999999998, 189.2, 173.3, 184.7, 192.8, 128.9, 196.4, 200.0, 47.59999999999998, 184.7, 173.0, 155.0, 185.0, 146.0, 200.0, 200.0, 183.2, 30.199999999999967, 167.0, 164.0, 186.5, 191.0, 200.0, 191.0, 154.1, 20.000000000000014, 198.2, 196.4, 165.2, 200.0, 194.0, 125.0, 152.0, 159.0, 190.1, 200.0, 173.0, 200.0, 200.0, 191.9, 179.9, 158.0, 173.29999999999998, 179.3, 200.0, 179.0, 148.4, 182.0, 182.0, 200.0, 137.0, 181.1, 140.0, 200.0, 137.3, 193.7, 146.0, 176.0, 176.59999999999997, 103.1, 20.000000000000014, 185.0, 194.6, 23.599999999999966, 200.0, 200.0, 188.0, 199.0, 159.0, 144.0, 183.79999999999998, 188.9, 134.3, 197.3, 200.0, 179.0, 182.0, 125.0, 179.0, 199.1, 135.2, 196.4, 154.4, 185.0, 152.0, 150.79999999999998, 20.000000000000014, 156.8, 119.0, 200.0, 184.1, 195.2, 83.6, 136.1, 195.5, 140.9, 20.000000000000014, 114.8, 190.1, 198.2, 20.000000000000014, 182.0, 194.6, 189.2, 163.4, 92.89999999999999, 151.4, 157.4, 145.1, 175.7, 200.0, 175.0, 200.0, 103.0, 196.4, 191.9, 188.0, 176.0], "policy_predator_policy_reward": [39.0, 12.0, 0.0, 24.0, 1.0, 0.0, 5.0, 32.0, 0.0, 0.0, 7.0, 1.0, 12.0, 0.0, 20.0, 18.0, 0.0, 0.0, 0.0, 0.0, 13.0, 22.0, 0.0, 0.0, 8.0, 6.0, 0.0, 17.0, 6.0, 0.0, 0.0, 0.0, 2.0, 0.0, 6.0, 15.0, 0.0, 0.0, 0.0, 11.0, 0.0, 5.0, 6.0, 11.0, 10.0, 6.0, 5.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 20.0, 33.0, 7.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.0, 13.0, 16.0, 13.0, 9.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 2.0, 8.0, 22.0, 0.0, 0.0, 27.0, 25.0, 1.0, 0.0, 8.0, 0.0, 20.0, 19.0, 0.0, 0.0, 19.0, 8.0, 11.0, 15.0, 16.0, 13.0, 0.0, 0.0, 17.0, 12.0, 19.0, 0.0, 3.0, 0.0, 0.0, 0.0, 14.0, 1.0, 0.0, 0.0, 11.0, 1.0, 8.0, 25.0, 0.0, 17.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 11.0, 4.0, 14.0, 4.0, 7.0, 6.0, 2.0, 12.0, 6.0, 0.0, 6.0, 21.0, 7.0, 15.0, 0.0, 20.0, 19.0, 4.0, 17.0, 21.0, 5.0, 0.0, 15.0, 8.0, 0.0, 0.0, 0.0, 0.0, 18.0, 11.0, 1.0, 0.0, 9.0, 9.0, 7.0, 0.0, 6.0, 22.0, 7.0, 0.0, 21.0, 19.0, 10.0, 0.0, 14.0, 16.0, 11.0, 1.0, 24.0, 20.0, 0.0, 6.0, 30.0, 29.0, 17.0, 0.0, 23.0, 19.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 15.0, 11.0, 8.0, 10.0, 18.0, 8.0, 0.0, 6.0, 0.0, 26.0, 0.0, 0.0, 9.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.715604778110045, "mean_inference_ms": 5.116493116686455, "mean_action_processing_ms": 0.8092349966419825, "mean_env_wait_ms": 0.5963910530895206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01872706413269043, "StateBufferConnector_ms": 0.004830718040466309, "ViewRequirementAgentConnector_ms": 0.17128849029541016}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 176.79999999999947, "episode_return_mean": 350.477, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.45432980980445, "num_env_steps_trained_throughput_per_sec": 293.45432980980445, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 1216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1216000, "timers": {"training_iteration_time_ms": 19244.575, "restore_workers_time_ms": 0.052, "training_step_time_ms": 19242.846, "sample_time_ms": 5040.432, "learn_time_ms": 14162.928, "learn_throughput": 282.427, "synch_weights_time_ms": 30.593}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 1216000, "num_agent_steps_trained": 1216000}, "done": false, "training_iteration": 76, "trial_id": "e4caa_00000", "date": "2024-08-13_20-13-12", "timestamp": 1723594392, "time_this_iter_s": 13.677833318710327, "time_total_s": 1725.7158725261688, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2878d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1725.7158725261688, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 55.04210526315789, "ram_util_percent": 79.35263157894735}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8243975139641888, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1785955821671499, "policy_loss": -0.009931655755641047, "vf_loss": 1.187649979919353, "vf_explained_var": 0.23867905767506392, "kl": 0.011696799441672168, "entropy": 1.3975444917956357, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.347040496348704, "cur_kl_coeff": 4.5474735088646414e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7610584872267233, "policy_loss": -0.002714523809552981, "vf_loss": 0.7637730128836459, "vf_explained_var": 0.09260204055952648, "kl": 0.0022281758037263834, "entropy": 0.05867943052182752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 144585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 176.79999999999947, "episode_reward_mean": 349.265, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 3.7999999999999616, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 33.0}, "policy_reward_mean": {"prey_policy": 166.9175, "predator_policy": 7.715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [391.0, 343.80000000000007, 378.29999999999995, 352.5, 368.0, 372.0, 373.90000000000003, 380.2, 315.0, 317.29999999999995, 379.5, 392.8, 381.1000000000001, 342.8, 351.6, 345.80000000000007, 376.6, 395.5, 347.0, 382.0, 335.0, 398.2, 344.29999999999995, 383.59999999999997, 366.0, 360.7, 396.4, 259.29999999999995, 354.0, 360.0, 400.0, 242.3999999999997, 350.0, 380.5, 391.0, 189.0999999999994, 394.6, 377.2, 352.0, 328.0, 390.1, 382.0, 391.9, 352.9, 370.6, 392.0, 344.4, 388.0, 345.1, 362.0, 351.0, 345.0, 317.69999999999993, 209.99999999999932, 241.1999999999996, 400.0, 387.0, 332.0, 373.70000000000005, 349.6, 386.0, 335.0, 385.1, 371.6, 349.4, 332.79999999999995, 188.79999999999941, 363.0, 385.3, 278.70000000000005, 353.4, 176.79999999999947, 388.3, 207.99999999999932, 383.8, 282.30000000000007, 326.8, 346.8, 381.0, 329.0, 388.3, 373.0, 348.4, 335.1, 355.19999999999993, 340.5, 360.0, 379.5, 340.4, 355.6, 217.2999999999995, 357.3, 354.0, 385.2, 352.6, 359.2, 349.0, 382.0, 394.0, 372.8], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [194.6, 196.4, 190.1, 142.7, 200.0, 173.3, 168.8, 166.7, 182.0, 170.0, 193.7, 173.3, 173.0, 191.9, 186.5, 193.7, 106.10000000000001, 188.9, 110.0, 167.29999999999998, 196.4, 175.1, 200.0, 192.8, 185.59999999999997, 195.5, 120.5, 197.3, 181.7, 140.9, 165.79999999999998, 158.0, 182.9, 193.7, 197.3, 198.2, 179.0, 152.0, 187.0, 193.0, 131.0, 174.0, 198.2, 200.0, 182.0, 110.3, 193.39999999999998, 189.2, 173.3, 184.7, 192.8, 128.9, 196.4, 200.0, 47.59999999999998, 184.7, 173.0, 155.0, 185.0, 146.0, 200.0, 200.0, 183.2, 30.199999999999967, 167.0, 164.0, 186.5, 191.0, 200.0, 191.0, 154.1, 20.000000000000014, 198.2, 196.4, 165.2, 200.0, 194.0, 125.0, 152.0, 159.0, 190.1, 200.0, 173.0, 200.0, 200.0, 191.9, 179.9, 158.0, 173.29999999999998, 179.3, 200.0, 179.0, 148.4, 182.0, 182.0, 200.0, 137.0, 181.1, 140.0, 200.0, 137.3, 193.7, 146.0, 176.0, 176.59999999999997, 103.1, 20.000000000000014, 185.0, 194.6, 23.599999999999966, 200.0, 200.0, 188.0, 199.0, 159.0, 144.0, 183.79999999999998, 188.9, 134.3, 197.3, 200.0, 179.0, 182.0, 125.0, 179.0, 199.1, 135.2, 196.4, 154.4, 185.0, 152.0, 150.79999999999998, 20.000000000000014, 156.8, 119.0, 200.0, 184.1, 195.2, 83.6, 136.1, 195.5, 140.9, 20.000000000000014, 114.8, 190.1, 198.2, 20.000000000000014, 182.0, 194.6, 189.2, 163.4, 92.89999999999999, 151.4, 157.4, 145.1, 175.7, 200.0, 175.0, 200.0, 103.0, 196.4, 191.9, 188.0, 176.0, 168.2, 165.2, 183.8, 128.3, 184.1, 154.09999999999994, 147.5, 164.0, 140.0, 200.0, 184.4, 187.1, 200.0, 121.4, 176.0, 164.6, 195.5, 3.7999999999999616, 146.3, 200.0, 200.0, 113.0, 188.6, 194.60000000000002, 166.4, 171.2, 172.7, 171.5, 165.0, 167.0, 185.0, 197.0, 200.0, 191.0, 167.3, 195.5], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 11.0, 0.0, 5.0, 6.0, 11.0, 10.0, 6.0, 5.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 20.0, 33.0, 7.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.0, 13.0, 16.0, 13.0, 9.0, 0.0, 0.0, 0.0, 0.0, 16.0, 0.0, 0.0, 2.0, 8.0, 22.0, 0.0, 0.0, 27.0, 25.0, 1.0, 0.0, 8.0, 0.0, 20.0, 19.0, 0.0, 0.0, 19.0, 8.0, 11.0, 15.0, 16.0, 13.0, 0.0, 0.0, 17.0, 12.0, 19.0, 0.0, 3.0, 0.0, 0.0, 0.0, 14.0, 1.0, 0.0, 0.0, 11.0, 1.0, 8.0, 25.0, 0.0, 17.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 11.0, 4.0, 14.0, 4.0, 7.0, 6.0, 2.0, 12.0, 6.0, 0.0, 6.0, 21.0, 7.0, 15.0, 0.0, 20.0, 19.0, 4.0, 17.0, 21.0, 5.0, 0.0, 15.0, 8.0, 0.0, 0.0, 0.0, 0.0, 18.0, 11.0, 1.0, 0.0, 9.0, 9.0, 7.0, 0.0, 6.0, 22.0, 7.0, 0.0, 21.0, 19.0, 10.0, 0.0, 14.0, 16.0, 11.0, 1.0, 24.0, 20.0, 0.0, 6.0, 30.0, 29.0, 17.0, 0.0, 23.0, 19.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 15.0, 11.0, 8.0, 10.0, 18.0, 8.0, 0.0, 6.0, 0.0, 26.0, 0.0, 0.0, 9.0, 0.0, 8.0, 7.0, 0.0, 23.0, 1.0, 16.0, 16.0, 13.0, 7.0, 13.0, 8.0, 0.0, 19.0, 0.0, 0.0, 15.0, 0.0, 18.0, 0.0, 11.0, 16.0, 25.0, 0.0, 2.0, 11.0, 4.0, 8.0, 7.0, 4.0, 13.0, 0.0, 0.0, 0.0, 3.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7033490471538641, "mean_inference_ms": 5.080572544722643, "mean_action_processing_ms": 0.8031696381679159, "mean_env_wait_ms": 0.5918907054819208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007380366325378418, "StateBufferConnector_ms": 0.00397038459777832, "ViewRequirementAgentConnector_ms": 0.13606035709381104}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 176.79999999999947, "episode_return_mean": 349.265, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.16151852859286, "num_env_steps_trained_throughput_per_sec": 261.16151852859286, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 1232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1232000, "timers": {"training_iteration_time_ms": 18648.9, "restore_workers_time_ms": 0.051, "training_step_time_ms": 18647.17, "sample_time_ms": 4807.749, "learn_time_ms": 13802.735, "learn_throughput": 289.798, "synch_weights_time_ms": 27.592}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 1232000, "num_agent_steps_trained": 1232000}, "done": false, "training_iteration": 77, "trial_id": "e4caa_00000", "date": "2024-08-13_20-13-27", "timestamp": 1723594407, "time_this_iter_s": 15.368514060974121, "time_total_s": 1741.084386587143, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b28791f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1741.084386587143, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 59.96363636363637, "ram_util_percent": 80.19090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.190562471321651, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1228119305753834, "policy_loss": -0.007906250912627135, "vf_loss": 1.1301236659919143, "vf_explained_var": 0.40149395380701336, "kl": 0.007926906973764558, "entropy": 1.40157030896535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6728287913969584, "cur_kl_coeff": 2.2737367544323207e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7978436732418323, "policy_loss": -0.0021855089897240597, "vf_loss": 0.8000291810858817, "vf_explained_var": 0.06815532742353975, "kl": 0.0024786862423371164, "entropy": 0.06499857176785116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 146475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 176.79999999999947, "episode_reward_mean": 346.037, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 3.7999999999999616, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 32.0}, "policy_reward_mean": {"prey_policy": 164.74349999999998, "predator_policy": 8.275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [383.59999999999997, 366.0, 360.7, 396.4, 259.29999999999995, 354.0, 360.0, 400.0, 242.3999999999997, 350.0, 380.5, 391.0, 189.0999999999994, 394.6, 377.2, 352.0, 328.0, 390.1, 382.0, 391.9, 352.9, 370.6, 392.0, 344.4, 388.0, 345.1, 362.0, 351.0, 345.0, 317.69999999999993, 209.99999999999932, 241.1999999999996, 400.0, 387.0, 332.0, 373.70000000000005, 349.6, 386.0, 335.0, 385.1, 371.6, 349.4, 332.79999999999995, 188.79999999999941, 363.0, 385.3, 278.70000000000005, 353.4, 176.79999999999947, 388.3, 207.99999999999932, 383.8, 282.30000000000007, 326.8, 346.8, 381.0, 329.0, 388.3, 373.0, 348.4, 335.1, 355.19999999999993, 340.5, 360.0, 379.5, 340.4, 355.6, 217.2999999999995, 357.3, 354.0, 385.2, 352.6, 359.2, 349.0, 382.0, 394.0, 372.8, 376.4, 381.5, 285.50000000000006, 356.0, 356.5, 387.90000000000003, 305.3, 232.49999999999986, 372.3, 369.1, 374.79999999999995, 379.4, 358.2, 344.0, 349.2, 372.0, 367.2, 334.0, 383.0, 269.0, 325.8, 386.2, 375.6000000000001], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [193.39999999999998, 189.2, 173.3, 184.7, 192.8, 128.9, 196.4, 200.0, 47.59999999999998, 184.7, 173.0, 155.0, 185.0, 146.0, 200.0, 200.0, 183.2, 30.199999999999967, 167.0, 164.0, 186.5, 191.0, 200.0, 191.0, 154.1, 20.000000000000014, 198.2, 196.4, 165.2, 200.0, 194.0, 125.0, 152.0, 159.0, 190.1, 200.0, 173.0, 200.0, 200.0, 191.9, 179.9, 158.0, 173.29999999999998, 179.3, 200.0, 179.0, 148.4, 182.0, 182.0, 200.0, 137.0, 181.1, 140.0, 200.0, 137.3, 193.7, 146.0, 176.0, 176.59999999999997, 103.1, 20.000000000000014, 185.0, 194.6, 23.599999999999966, 200.0, 200.0, 188.0, 199.0, 159.0, 144.0, 183.79999999999998, 188.9, 134.3, 197.3, 200.0, 179.0, 182.0, 125.0, 179.0, 199.1, 135.2, 196.4, 154.4, 185.0, 152.0, 150.79999999999998, 20.000000000000014, 156.8, 119.0, 200.0, 184.1, 195.2, 83.6, 136.1, 195.5, 140.9, 20.000000000000014, 114.8, 190.1, 198.2, 20.000000000000014, 182.0, 194.6, 189.2, 163.4, 92.89999999999999, 151.4, 157.4, 145.1, 175.7, 200.0, 175.0, 200.0, 103.0, 196.4, 191.9, 188.0, 176.0, 168.2, 165.2, 183.8, 128.3, 184.1, 154.09999999999994, 147.5, 164.0, 140.0, 200.0, 184.4, 187.1, 200.0, 121.4, 176.0, 164.6, 195.5, 3.7999999999999616, 146.3, 200.0, 200.0, 113.0, 188.6, 194.60000000000002, 166.4, 171.2, 172.7, 171.5, 165.0, 167.0, 185.0, 197.0, 200.0, 191.0, 167.3, 195.5, 194.0, 172.4, 192.5, 182.0, 148.1, 106.39999999999995, 176.0, 170.0, 151.4, 190.1, 186.8, 199.1, 170.0, 101.3, 157.4, 46.09999999999997, 198.2, 148.1, 116.0, 199.1, 186.5, 188.3, 193.7, 181.7, 199.1, 139.1, 197.3, 127.7, 193.7, 144.5, 146.0, 200.0, 192.8, 163.4, 170.0, 144.0, 190.0, 190.0, 64.0, 155.0, 168.5, 131.3, 199.1, 181.1, 182.3, 188.29999999999998], "policy_predator_policy_reward": [1.0, 0.0, 8.0, 0.0, 20.0, 19.0, 0.0, 0.0, 19.0, 8.0, 11.0, 15.0, 16.0, 13.0, 0.0, 0.0, 17.0, 12.0, 19.0, 0.0, 3.0, 0.0, 0.0, 0.0, 14.0, 1.0, 0.0, 0.0, 11.0, 1.0, 8.0, 25.0, 0.0, 17.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 11.0, 4.0, 14.0, 4.0, 7.0, 6.0, 2.0, 12.0, 6.0, 0.0, 6.0, 21.0, 7.0, 15.0, 0.0, 20.0, 19.0, 4.0, 17.0, 21.0, 5.0, 0.0, 15.0, 8.0, 0.0, 0.0, 0.0, 0.0, 18.0, 11.0, 1.0, 0.0, 9.0, 9.0, 7.0, 0.0, 6.0, 22.0, 7.0, 0.0, 21.0, 19.0, 10.0, 0.0, 14.0, 16.0, 11.0, 1.0, 24.0, 20.0, 0.0, 6.0, 30.0, 29.0, 17.0, 0.0, 23.0, 19.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 15.0, 11.0, 8.0, 10.0, 18.0, 8.0, 0.0, 6.0, 0.0, 26.0, 0.0, 0.0, 9.0, 0.0, 8.0, 7.0, 0.0, 23.0, 1.0, 16.0, 16.0, 13.0, 7.0, 13.0, 8.0, 0.0, 19.0, 0.0, 0.0, 15.0, 0.0, 18.0, 0.0, 11.0, 16.0, 25.0, 0.0, 2.0, 11.0, 4.0, 8.0, 7.0, 4.0, 13.0, 0.0, 0.0, 0.0, 3.0, 0.0, 10.0, 8.0, 2.0, 0.0, 7.0, 2.0, 29.0, 0.0, 10.0, 0.0, 15.0, 2.0, 0.0, 4.0, 30.0, 14.0, 15.0, 13.0, 13.0, 26.0, 28.0, 0.0, 0.0, 0.0, 4.0, 0.0, 20.0, 0.0, 19.0, 0.0, 11.0, 14.0, 12.0, 11.0, 0.0, 8.0, 12.0, 0.0, 3.0, 18.0, 32.0, 11.0, 15.0, 4.0, 2.0, 0.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6883219801973859, "mean_inference_ms": 5.03765547272724, "mean_action_processing_ms": 0.7953115217304842, "mean_env_wait_ms": 0.5866715614818095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0068318843841552734, "StateBufferConnector_ms": 0.0037221908569335938, "ViewRequirementAgentConnector_ms": 0.12154960632324219}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 176.79999999999947, "episode_return_mean": 346.037, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.35351578105397, "num_env_steps_trained_throughput_per_sec": 253.35351578105397, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 1248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1248000, "timers": {"training_iteration_time_ms": 17440.526, "restore_workers_time_ms": 0.025, "training_step_time_ms": 17438.776, "sample_time_ms": 3796.117, "learn_time_ms": 13607.423, "learn_throughput": 293.957, "synch_weights_time_ms": 26.782}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 1248000, "num_agent_steps_trained": 1248000}, "done": false, "training_iteration": 78, "trial_id": "e4caa_00000", "date": "2024-08-13_20-13-43", "timestamp": 1723594423, "time_this_iter_s": 15.84426999092102, "time_total_s": 1756.928656578064, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29258b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1756.928656578064, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 61.23913043478261, "ram_util_percent": 82.61304347826088}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9916783463860315, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1333221309714847, "policy_loss": -0.008557235777979254, "vf_loss": 1.1410610560071532, "vf_explained_var": 0.603535509960992, "kl": 0.010910786800767753, "entropy": 1.4181235208082452, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4026687612766942, "cur_kl_coeff": 1.1368683772161604e-14, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8741851940514549, "policy_loss": -0.001983995640788365, "vf_loss": 0.8761691876504787, "vf_explained_var": 0.048336754778705575, "kl": 0.0014061006680782706, "entropy": 0.058955426855140894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 148365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 176.79999999999947, "episode_reward_mean": 348.077, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 3.7999999999999616, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 32.0}, "policy_reward_mean": {"prey_policy": 165.77849999999998, "predator_policy": 8.26}, "custom_metrics": {}, "hist_stats": {"episode_reward": [382.0, 391.9, 352.9, 370.6, 392.0, 344.4, 388.0, 345.1, 362.0, 351.0, 345.0, 317.69999999999993, 209.99999999999932, 241.1999999999996, 400.0, 387.0, 332.0, 373.70000000000005, 349.6, 386.0, 335.0, 385.1, 371.6, 349.4, 332.79999999999995, 188.79999999999941, 363.0, 385.3, 278.70000000000005, 353.4, 176.79999999999947, 388.3, 207.99999999999932, 383.8, 282.30000000000007, 326.8, 346.8, 381.0, 329.0, 388.3, 373.0, 348.4, 335.1, 355.19999999999993, 340.5, 360.0, 379.5, 340.4, 355.6, 217.2999999999995, 357.3, 354.0, 385.2, 352.6, 359.2, 349.0, 382.0, 394.0, 372.8, 376.4, 381.5, 285.50000000000006, 356.0, 356.5, 387.90000000000003, 305.3, 232.49999999999986, 372.3, 369.1, 374.79999999999995, 379.4, 358.2, 344.0, 349.2, 372.0, 367.2, 334.0, 383.0, 269.0, 325.8, 386.2, 375.6000000000001, 400.0, 362.6, 385.7, 376.7, 376.2, 399.1, 364.2, 243.5, 367.6, 338.0, 359.29999999999995, 346.0, 368.0, 358.0, 382.0, 382.0, 309.5999999999999, 360.4], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [173.0, 200.0, 200.0, 191.9, 179.9, 158.0, 173.29999999999998, 179.3, 200.0, 179.0, 148.4, 182.0, 182.0, 200.0, 137.0, 181.1, 140.0, 200.0, 137.3, 193.7, 146.0, 176.0, 176.59999999999997, 103.1, 20.000000000000014, 185.0, 194.6, 23.599999999999966, 200.0, 200.0, 188.0, 199.0, 159.0, 144.0, 183.79999999999998, 188.9, 134.3, 197.3, 200.0, 179.0, 182.0, 125.0, 179.0, 199.1, 135.2, 196.4, 154.4, 185.0, 152.0, 150.79999999999998, 20.000000000000014, 156.8, 119.0, 200.0, 184.1, 195.2, 83.6, 136.1, 195.5, 140.9, 20.000000000000014, 114.8, 190.1, 198.2, 20.000000000000014, 182.0, 194.6, 189.2, 163.4, 92.89999999999999, 151.4, 157.4, 145.1, 175.7, 200.0, 175.0, 200.0, 103.0, 196.4, 191.9, 188.0, 176.0, 168.2, 165.2, 183.8, 128.3, 184.1, 154.09999999999994, 147.5, 164.0, 140.0, 200.0, 184.4, 187.1, 200.0, 121.4, 176.0, 164.6, 195.5, 3.7999999999999616, 146.3, 200.0, 200.0, 113.0, 188.6, 194.60000000000002, 166.4, 171.2, 172.7, 171.5, 165.0, 167.0, 185.0, 197.0, 200.0, 191.0, 167.3, 195.5, 194.0, 172.4, 192.5, 182.0, 148.1, 106.39999999999995, 176.0, 170.0, 151.4, 190.1, 186.8, 199.1, 170.0, 101.3, 157.4, 46.09999999999997, 198.2, 148.1, 116.0, 199.1, 186.5, 188.3, 193.7, 181.7, 199.1, 139.1, 197.3, 127.7, 193.7, 144.5, 146.0, 200.0, 192.8, 163.4, 170.0, 144.0, 190.0, 190.0, 64.0, 155.0, 168.5, 131.3, 199.1, 181.1, 182.3, 188.29999999999998, 200.0, 200.0, 147.5, 199.1, 200.0, 181.7, 190.10000000000002, 182.6, 180.2, 194.0, 200.0, 199.1, 191.0, 135.2, 172.7, 39.799999999999976, 197.0, 149.6, 155.0, 164.0, 197.29999999999998, 152.0, 172.1, 152.9, 200.0, 152.0, 155.0, 188.0, 179.0, 197.0, 185.0, 192.0, 88.1, 195.5, 177.2, 162.2], "policy_predator_policy_reward": [0.0, 9.0, 0.0, 0.0, 11.0, 4.0, 14.0, 4.0, 7.0, 6.0, 2.0, 12.0, 6.0, 0.0, 6.0, 21.0, 7.0, 15.0, 0.0, 20.0, 19.0, 4.0, 17.0, 21.0, 5.0, 0.0, 15.0, 8.0, 0.0, 0.0, 0.0, 0.0, 18.0, 11.0, 1.0, 0.0, 9.0, 9.0, 7.0, 0.0, 6.0, 22.0, 7.0, 0.0, 21.0, 19.0, 10.0, 0.0, 14.0, 16.0, 11.0, 1.0, 24.0, 20.0, 0.0, 6.0, 30.0, 29.0, 17.0, 0.0, 23.0, 19.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 15.0, 11.0, 8.0, 10.0, 18.0, 8.0, 0.0, 6.0, 0.0, 26.0, 0.0, 0.0, 9.0, 0.0, 8.0, 7.0, 0.0, 23.0, 1.0, 16.0, 16.0, 13.0, 7.0, 13.0, 8.0, 0.0, 19.0, 0.0, 0.0, 15.0, 0.0, 18.0, 0.0, 11.0, 16.0, 25.0, 0.0, 2.0, 11.0, 4.0, 8.0, 7.0, 4.0, 13.0, 0.0, 0.0, 0.0, 3.0, 0.0, 10.0, 8.0, 2.0, 0.0, 7.0, 2.0, 29.0, 0.0, 10.0, 0.0, 15.0, 2.0, 0.0, 4.0, 30.0, 14.0, 15.0, 13.0, 13.0, 26.0, 28.0, 0.0, 0.0, 0.0, 4.0, 0.0, 20.0, 0.0, 19.0, 0.0, 11.0, 14.0, 12.0, 11.0, 0.0, 8.0, 12.0, 0.0, 3.0, 18.0, 32.0, 11.0, 15.0, 4.0, 2.0, 0.0, 5.0, 0.0, 0.0, 0.0, 16.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 21.0, 17.0, 31.0, 0.0, 11.0, 10.0, 11.0, 8.0, 0.0, 10.0, 13.0, 8.0, 9.0, 7.0, 15.0, 0.0, 6.0, 0.0, 0.0, 5.0, 13.0, 13.0, 19.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6765485519727827, "mean_inference_ms": 5.00436779779559, "mean_action_processing_ms": 0.7893013746515147, "mean_env_wait_ms": 0.5826052022967296, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055849552154541016, "StateBufferConnector_ms": 0.004381656646728516, "ViewRequirementAgentConnector_ms": 0.1229701042175293}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 176.79999999999947, "episode_return_mean": 348.077, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.474424070379, "num_env_steps_trained_throughput_per_sec": 285.474424070379, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 1264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1264000, "timers": {"training_iteration_time_ms": 16830.307, "restore_workers_time_ms": 0.024, "training_step_time_ms": 16830.181, "sample_time_ms": 3554.419, "learn_time_ms": 13255.0, "learn_throughput": 301.773, "synch_weights_time_ms": 16.736}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 1264000, "num_agent_steps_trained": 1264000}, "done": false, "training_iteration": 79, "trial_id": "e4caa_00000", "date": "2024-08-13_20-13-57", "timestamp": 1723594437, "time_this_iter_s": 14.060019969940186, "time_total_s": 1770.9886765480042, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2871f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1770.9886765480042, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 56.915, "ram_util_percent": 82.86}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1705192287920645, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9898346147780853, "policy_loss": -0.00689364438174322, "vf_loss": 0.9961879922678231, "vf_explained_var": 0.4543681809511134, "kl": 0.007203572849546686, "entropy": 1.4182761746739585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.378445173476739, "cur_kl_coeff": 5.684341886080802e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.46851992410799814, "policy_loss": -0.0026320196587158733, "vf_loss": 0.4711519430046556, "vf_explained_var": 0.1624785615022851, "kl": 0.0012100862057338358, "entropy": 0.06480461773536508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 150255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 176.79999999999947, "episode_reward_mean": 349.17799999999994, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 3.7999999999999616, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 32.0}, "policy_reward_mean": {"prey_policy": 166.24399999999997, "predator_policy": 8.345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [371.6, 349.4, 332.79999999999995, 188.79999999999941, 363.0, 385.3, 278.70000000000005, 353.4, 176.79999999999947, 388.3, 207.99999999999932, 383.8, 282.30000000000007, 326.8, 346.8, 381.0, 329.0, 388.3, 373.0, 348.4, 335.1, 355.19999999999993, 340.5, 360.0, 379.5, 340.4, 355.6, 217.2999999999995, 357.3, 354.0, 385.2, 352.6, 359.2, 349.0, 382.0, 394.0, 372.8, 376.4, 381.5, 285.50000000000006, 356.0, 356.5, 387.90000000000003, 305.3, 232.49999999999986, 372.3, 369.1, 374.79999999999995, 379.4, 358.2, 344.0, 349.2, 372.0, 367.2, 334.0, 383.0, 269.0, 325.8, 386.2, 375.6000000000001, 400.0, 362.6, 385.7, 376.7, 376.2, 399.1, 364.2, 243.5, 367.6, 338.0, 359.29999999999995, 346.0, 368.0, 358.0, 382.0, 382.0, 309.5999999999999, 360.4, 364.6, 360.0, 373.2, 273.99999999999994, 362.4, 394.6, 372.6, 365.8, 350.4, 348.2, 394.6, 365.0, 347.0, 366.7, 395.1, 344.8, 387.4000000000001, 341.5, 363.0, 382.0, 242.29999999999998, 357.1], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [135.2, 196.4, 154.4, 185.0, 152.0, 150.79999999999998, 20.000000000000014, 156.8, 119.0, 200.0, 184.1, 195.2, 83.6, 136.1, 195.5, 140.9, 20.000000000000014, 114.8, 190.1, 198.2, 20.000000000000014, 182.0, 194.6, 189.2, 163.4, 92.89999999999999, 151.4, 157.4, 145.1, 175.7, 200.0, 175.0, 200.0, 103.0, 196.4, 191.9, 188.0, 176.0, 168.2, 165.2, 183.8, 128.3, 184.1, 154.09999999999994, 147.5, 164.0, 140.0, 200.0, 184.4, 187.1, 200.0, 121.4, 176.0, 164.6, 195.5, 3.7999999999999616, 146.3, 200.0, 200.0, 113.0, 188.6, 194.60000000000002, 166.4, 171.2, 172.7, 171.5, 165.0, 167.0, 185.0, 197.0, 200.0, 191.0, 167.3, 195.5, 194.0, 172.4, 192.5, 182.0, 148.1, 106.39999999999995, 176.0, 170.0, 151.4, 190.1, 186.8, 199.1, 170.0, 101.3, 157.4, 46.09999999999997, 198.2, 148.1, 116.0, 199.1, 186.5, 188.3, 193.7, 181.7, 199.1, 139.1, 197.3, 127.7, 193.7, 144.5, 146.0, 200.0, 192.8, 163.4, 170.0, 144.0, 190.0, 190.0, 64.0, 155.0, 168.5, 131.3, 199.1, 181.1, 182.3, 188.29999999999998, 200.0, 200.0, 147.5, 199.1, 200.0, 181.7, 190.10000000000002, 182.6, 180.2, 194.0, 200.0, 199.1, 191.0, 135.2, 172.7, 39.799999999999976, 197.0, 149.6, 155.0, 164.0, 197.29999999999998, 152.0, 172.1, 152.9, 200.0, 152.0, 155.0, 188.0, 179.0, 197.0, 185.0, 192.0, 88.1, 195.5, 177.2, 162.2, 167.0, 179.6, 172.39999999999998, 176.6, 185.0, 180.2, 142.1, 74.89999999999998, 169.4, 185.0, 200.0, 194.6, 161.0, 194.6, 161.0, 189.8, 171.2, 156.2, 184.7, 150.5, 199.1, 195.49999999999997, 199.1, 152.9, 164.0, 152.0, 188.3, 178.39999999999998, 193.1, 200.0, 170.3, 162.5, 195.49999999999997, 191.9, 170.0, 141.5, 185.0, 160.0, 189.0, 193.0, 143.0, 47.29999999999998, 200.0, 145.1], "policy_predator_policy_reward": [21.0, 19.0, 10.0, 0.0, 14.0, 16.0, 11.0, 1.0, 24.0, 20.0, 0.0, 6.0, 30.0, 29.0, 17.0, 0.0, 23.0, 19.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 15.0, 11.0, 8.0, 10.0, 18.0, 8.0, 0.0, 6.0, 0.0, 26.0, 0.0, 0.0, 9.0, 0.0, 8.0, 7.0, 0.0, 23.0, 1.0, 16.0, 16.0, 13.0, 7.0, 13.0, 8.0, 0.0, 19.0, 0.0, 0.0, 15.0, 0.0, 18.0, 0.0, 11.0, 16.0, 25.0, 0.0, 2.0, 11.0, 4.0, 8.0, 7.0, 4.0, 13.0, 0.0, 0.0, 0.0, 3.0, 0.0, 10.0, 8.0, 2.0, 0.0, 7.0, 2.0, 29.0, 0.0, 10.0, 0.0, 15.0, 2.0, 0.0, 4.0, 30.0, 14.0, 15.0, 13.0, 13.0, 26.0, 28.0, 0.0, 0.0, 0.0, 4.0, 0.0, 20.0, 0.0, 19.0, 0.0, 11.0, 14.0, 12.0, 11.0, 0.0, 8.0, 12.0, 0.0, 3.0, 18.0, 32.0, 11.0, 15.0, 4.0, 2.0, 0.0, 5.0, 0.0, 0.0, 0.0, 16.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 21.0, 17.0, 31.0, 0.0, 11.0, 10.0, 11.0, 8.0, 0.0, 10.0, 13.0, 8.0, 9.0, 7.0, 15.0, 0.0, 6.0, 0.0, 0.0, 5.0, 13.0, 13.0, 19.0, 2.0, 7.0, 11.0, 8.0, 3.0, 8.0, 0.0, 29.0, 28.0, 0.0, 8.0, 0.0, 0.0, 11.0, 6.0, 4.0, 11.0, 14.0, 9.0, 1.0, 12.0, 0.0, 0.0, 13.0, 0.0, 16.0, 15.0, 0.0, 0.0, 2.0, 0.0, 12.0, 0.0, 0.0, 0.0, 9.0, 21.0, 5.0, 13.0, 0.0, 0.0, 28.0, 24.0, 0.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.663423288457399, "mean_inference_ms": 4.969487329297415, "mean_action_processing_ms": 0.7823796285707988, "mean_env_wait_ms": 0.5783454479785284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061910152435302734, "StateBufferConnector_ms": 0.004262566566467285, "ViewRequirementAgentConnector_ms": 0.11699438095092773}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 176.79999999999947, "episode_return_mean": 349.17799999999994, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.6672201721722, "num_env_steps_trained_throughput_per_sec": 287.6672201721722, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 15643.442, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15643.334, "sample_time_ms": 2579.915, "learn_time_ms": 13042.857, "learn_throughput": 306.681, "synch_weights_time_ms": 17.074}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 80, "trial_id": "e4caa_00000", "date": "2024-08-13_20-14-11", "timestamp": 1723594451, "time_this_iter_s": 13.958330154418945, "time_total_s": 1784.947006702423, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2871940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1784.947006702423, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 56.08, "ram_util_percent": 82.59}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0510471555921765, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0840663597697304, "policy_loss": -0.008375235720138464, "vf_loss": 1.0917714185342586, "vf_explained_var": 0.327627319917477, "kl": 0.008935690163937174, "entropy": 1.3894499781901244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7714262526817424, "cur_kl_coeff": 2.842170943040401e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6066182823092849, "policy_loss": -0.002297623771878462, "vf_loss": 0.6089159069513833, "vf_explained_var": 0.04805487703394007, "kl": 0.001114083757119304, "entropy": 0.05261092129602003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 152145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 217.2999999999995, "episode_reward_mean": 355.68, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 3.7999999999999616, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 35.0}, "policy_reward_mean": {"prey_policy": 170.285, "predator_policy": 7.555}, "custom_metrics": {}, "hist_stats": {"episode_reward": [373.0, 348.4, 335.1, 355.19999999999993, 340.5, 360.0, 379.5, 340.4, 355.6, 217.2999999999995, 357.3, 354.0, 385.2, 352.6, 359.2, 349.0, 382.0, 394.0, 372.8, 376.4, 381.5, 285.50000000000006, 356.0, 356.5, 387.90000000000003, 305.3, 232.49999999999986, 372.3, 369.1, 374.79999999999995, 379.4, 358.2, 344.0, 349.2, 372.0, 367.2, 334.0, 383.0, 269.0, 325.8, 386.2, 375.6000000000001, 400.0, 362.6, 385.7, 376.7, 376.2, 399.1, 364.2, 243.5, 367.6, 338.0, 359.29999999999995, 346.0, 368.0, 358.0, 382.0, 382.0, 309.5999999999999, 360.4, 364.6, 360.0, 373.2, 273.99999999999994, 362.4, 394.6, 372.6, 365.8, 350.4, 348.2, 394.6, 365.0, 347.0, 366.7, 395.1, 344.8, 387.4000000000001, 341.5, 363.0, 382.0, 242.29999999999998, 357.1, 365.0, 391.0, 381.7, 381.1, 382.69999999999993, 374.7, 367.6, 356.9, 386.5, 317.8, 350.5, 373.0, 346.2, 296.1, 376.0, 392.0, 369.9, 275.6], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [188.0, 176.0, 168.2, 165.2, 183.8, 128.3, 184.1, 154.09999999999994, 147.5, 164.0, 140.0, 200.0, 184.4, 187.1, 200.0, 121.4, 176.0, 164.6, 195.5, 3.7999999999999616, 146.3, 200.0, 200.0, 113.0, 188.6, 194.60000000000002, 166.4, 171.2, 172.7, 171.5, 165.0, 167.0, 185.0, 197.0, 200.0, 191.0, 167.3, 195.5, 194.0, 172.4, 192.5, 182.0, 148.1, 106.39999999999995, 176.0, 170.0, 151.4, 190.1, 186.8, 199.1, 170.0, 101.3, 157.4, 46.09999999999997, 198.2, 148.1, 116.0, 199.1, 186.5, 188.3, 193.7, 181.7, 199.1, 139.1, 197.3, 127.7, 193.7, 144.5, 146.0, 200.0, 192.8, 163.4, 170.0, 144.0, 190.0, 190.0, 64.0, 155.0, 168.5, 131.3, 199.1, 181.1, 182.3, 188.29999999999998, 200.0, 200.0, 147.5, 199.1, 200.0, 181.7, 190.10000000000002, 182.6, 180.2, 194.0, 200.0, 199.1, 191.0, 135.2, 172.7, 39.799999999999976, 197.0, 149.6, 155.0, 164.0, 197.29999999999998, 152.0, 172.1, 152.9, 200.0, 152.0, 155.0, 188.0, 179.0, 197.0, 185.0, 192.0, 88.1, 195.5, 177.2, 162.2, 167.0, 179.6, 172.39999999999998, 176.6, 185.0, 180.2, 142.1, 74.89999999999998, 169.4, 185.0, 200.0, 194.6, 161.0, 194.6, 161.0, 189.8, 171.2, 156.2, 184.7, 150.5, 199.1, 195.49999999999997, 199.1, 152.9, 164.0, 152.0, 188.3, 178.39999999999998, 193.1, 200.0, 170.3, 162.5, 195.49999999999997, 191.9, 170.0, 141.5, 185.0, 160.0, 189.0, 193.0, 143.0, 47.29999999999998, 200.0, 145.1, 177.2, 183.8, 191.0, 200.0, 188.0, 187.7, 181.1, 200.0, 192.5, 189.2, 190.1, 179.6, 176.6, 191.0, 182.3, 161.6, 200.0, 186.5, 161.3, 111.5, 167.3, 165.2, 172.1, 191.9, 165.2, 161.0, 75.19999999999999, 182.9, 189.0, 182.0, 182.0, 200.0, 173.9, 182.0, 128.6, 125.0], "policy_predator_policy_reward": [9.0, 0.0, 8.0, 7.0, 0.0, 23.0, 1.0, 16.0, 16.0, 13.0, 7.0, 13.0, 8.0, 0.0, 19.0, 0.0, 0.0, 15.0, 0.0, 18.0, 0.0, 11.0, 16.0, 25.0, 0.0, 2.0, 11.0, 4.0, 8.0, 7.0, 4.0, 13.0, 0.0, 0.0, 0.0, 3.0, 0.0, 10.0, 8.0, 2.0, 0.0, 7.0, 2.0, 29.0, 0.0, 10.0, 0.0, 15.0, 2.0, 0.0, 4.0, 30.0, 14.0, 15.0, 13.0, 13.0, 26.0, 28.0, 0.0, 0.0, 0.0, 4.0, 0.0, 20.0, 0.0, 19.0, 0.0, 11.0, 14.0, 12.0, 11.0, 0.0, 8.0, 12.0, 0.0, 3.0, 18.0, 32.0, 11.0, 15.0, 4.0, 2.0, 0.0, 5.0, 0.0, 0.0, 0.0, 16.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 21.0, 17.0, 31.0, 0.0, 11.0, 10.0, 11.0, 8.0, 0.0, 10.0, 13.0, 8.0, 9.0, 7.0, 15.0, 0.0, 6.0, 0.0, 0.0, 5.0, 13.0, 13.0, 19.0, 2.0, 7.0, 11.0, 8.0, 3.0, 8.0, 0.0, 29.0, 28.0, 0.0, 8.0, 0.0, 0.0, 11.0, 6.0, 4.0, 11.0, 14.0, 9.0, 1.0, 12.0, 0.0, 0.0, 13.0, 0.0, 16.0, 15.0, 0.0, 0.0, 2.0, 0.0, 12.0, 0.0, 0.0, 0.0, 9.0, 21.0, 5.0, 13.0, 0.0, 0.0, 28.0, 24.0, 0.0, 12.0, 0.0, 4.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 23.0, 22.0, 12.0, 6.0, 0.0, 9.0, 0.0, 20.0, 3.0, 35.0, 2.0, 3.0, 6.0, 4.0, 5.0, 9.0, 22.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6518725454967782, "mean_inference_ms": 4.935263061507269, "mean_action_processing_ms": 0.7767550470064678, "mean_env_wait_ms": 0.5740896669737284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0061566829681396484, "StateBufferConnector_ms": 0.005555152893066406, "ViewRequirementAgentConnector_ms": 0.11804962158203125}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 217.2999999999995, "episode_return_mean": 355.68, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.15391782760406, "num_env_steps_trained_throughput_per_sec": 275.15391782760406, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 1296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1296000, "timers": {"training_iteration_time_ms": 14639.05, "restore_workers_time_ms": 0.019, "training_step_time_ms": 14638.942, "sample_time_ms": 2035.817, "learn_time_ms": 12582.762, "learn_throughput": 317.895, "synch_weights_time_ms": 16.966}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 1296000, "num_agent_steps_trained": 1296000}, "done": false, "training_iteration": 81, "trial_id": "e4caa_00000", "date": "2024-08-13_20-14-26", "timestamp": 1723594466, "time_this_iter_s": 14.592158079147339, "time_total_s": 1799.5391647815704, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2871c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1799.5391647815704, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 58.42499999999999, "ram_util_percent": 82.685}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9333107292179077, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7760572210949643, "policy_loss": -0.006409689207024202, "vf_loss": 0.7820327882334669, "vf_explained_var": 0.3977309770685024, "kl": 0.005788287704557392, "entropy": 1.4025222432676447, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2250897533679135, "cur_kl_coeff": 1.4210854715202005e-15, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5024448727646833, "policy_loss": -0.003774328554719292, "vf_loss": 0.50621920058691, "vf_explained_var": 0.06055074797736274, "kl": 0.0020158665198491232, "entropy": 0.03729498600045209, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 154035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 232.49999999999986, "episode_reward_mean": 357.957, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 39.799999999999976, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 35.0}, "policy_reward_mean": {"prey_policy": 171.69349999999997, "predator_policy": 7.285}, "custom_metrics": {}, "hist_stats": {"episode_reward": [356.5, 387.90000000000003, 305.3, 232.49999999999986, 372.3, 369.1, 374.79999999999995, 379.4, 358.2, 344.0, 349.2, 372.0, 367.2, 334.0, 383.0, 269.0, 325.8, 386.2, 375.6000000000001, 400.0, 362.6, 385.7, 376.7, 376.2, 399.1, 364.2, 243.5, 367.6, 338.0, 359.29999999999995, 346.0, 368.0, 358.0, 382.0, 382.0, 309.5999999999999, 360.4, 364.6, 360.0, 373.2, 273.99999999999994, 362.4, 394.6, 372.6, 365.8, 350.4, 348.2, 394.6, 365.0, 347.0, 366.7, 395.1, 344.8, 387.4000000000001, 341.5, 363.0, 382.0, 242.29999999999998, 357.1, 365.0, 391.0, 381.7, 381.1, 382.69999999999993, 374.7, 367.6, 356.9, 386.5, 317.8, 350.5, 373.0, 346.2, 296.1, 376.0, 392.0, 369.9, 275.6, 382.0, 398.2, 348.1, 390.0, 357.1, 368.0, 393.0, 281.4, 365.3, 379.4, 381.2, 373.9, 335.70000000000005, 352.1, 364.9, 388.3, 314.90000000000003, 362.0, 346.0, 344.0, 372.6, 375.9, 364.2], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [151.4, 190.1, 186.8, 199.1, 170.0, 101.3, 157.4, 46.09999999999997, 198.2, 148.1, 116.0, 199.1, 186.5, 188.3, 193.7, 181.7, 199.1, 139.1, 197.3, 127.7, 193.7, 144.5, 146.0, 200.0, 192.8, 163.4, 170.0, 144.0, 190.0, 190.0, 64.0, 155.0, 168.5, 131.3, 199.1, 181.1, 182.3, 188.29999999999998, 200.0, 200.0, 147.5, 199.1, 200.0, 181.7, 190.10000000000002, 182.6, 180.2, 194.0, 200.0, 199.1, 191.0, 135.2, 172.7, 39.799999999999976, 197.0, 149.6, 155.0, 164.0, 197.29999999999998, 152.0, 172.1, 152.9, 200.0, 152.0, 155.0, 188.0, 179.0, 197.0, 185.0, 192.0, 88.1, 195.5, 177.2, 162.2, 167.0, 179.6, 172.39999999999998, 176.6, 185.0, 180.2, 142.1, 74.89999999999998, 169.4, 185.0, 200.0, 194.6, 161.0, 194.6, 161.0, 189.8, 171.2, 156.2, 184.7, 150.5, 199.1, 195.49999999999997, 199.1, 152.9, 164.0, 152.0, 188.3, 178.39999999999998, 193.1, 200.0, 170.3, 162.5, 195.49999999999997, 191.9, 170.0, 141.5, 185.0, 160.0, 189.0, 193.0, 143.0, 47.29999999999998, 200.0, 145.1, 177.2, 183.8, 191.0, 200.0, 188.0, 187.7, 181.1, 200.0, 192.5, 189.2, 190.1, 179.6, 176.6, 191.0, 182.3, 161.6, 200.0, 186.5, 161.3, 111.5, 167.3, 165.2, 172.1, 191.9, 165.2, 161.0, 75.19999999999999, 182.9, 189.0, 182.0, 182.0, 200.0, 173.9, 182.0, 128.6, 125.0, 199.1, 182.9, 200.0, 198.2, 164.0, 172.1, 185.0, 200.0, 190.1, 125.0, 200.0, 152.0, 194.0, 197.0, 99.2, 129.2, 151.1, 198.2, 188.6, 186.8, 197.3, 179.9, 190.1, 183.8, 200.0, 115.7, 140.3, 192.8, 157.7, 189.2, 189.2, 199.1, 133.7, 165.2, 190.0, 160.0, 141.0, 186.0, 159.0, 170.0, 184.1, 186.5, 185.0, 182.9, 185.0, 171.2], "policy_predator_policy_reward": [0.0, 15.0, 2.0, 0.0, 4.0, 30.0, 14.0, 15.0, 13.0, 13.0, 26.0, 28.0, 0.0, 0.0, 0.0, 4.0, 0.0, 20.0, 0.0, 19.0, 0.0, 11.0, 14.0, 12.0, 11.0, 0.0, 8.0, 12.0, 0.0, 3.0, 18.0, 32.0, 11.0, 15.0, 4.0, 2.0, 0.0, 5.0, 0.0, 0.0, 0.0, 16.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 21.0, 17.0, 31.0, 0.0, 11.0, 10.0, 11.0, 8.0, 0.0, 10.0, 13.0, 8.0, 9.0, 7.0, 15.0, 0.0, 6.0, 0.0, 0.0, 5.0, 13.0, 13.0, 19.0, 2.0, 7.0, 11.0, 8.0, 3.0, 8.0, 0.0, 29.0, 28.0, 0.0, 8.0, 0.0, 0.0, 11.0, 6.0, 4.0, 11.0, 14.0, 9.0, 1.0, 12.0, 0.0, 0.0, 13.0, 0.0, 16.0, 15.0, 0.0, 0.0, 2.0, 0.0, 12.0, 0.0, 0.0, 0.0, 9.0, 21.0, 5.0, 13.0, 0.0, 0.0, 28.0, 24.0, 0.0, 12.0, 0.0, 4.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 23.0, 22.0, 12.0, 6.0, 0.0, 9.0, 0.0, 20.0, 3.0, 35.0, 2.0, 3.0, 6.0, 4.0, 5.0, 9.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 5.0, 0.0, 22.0, 20.0, 0.0, 16.0, 2.0, 0.0, 30.0, 23.0, 0.0, 16.0, 4.0, 0.0, 3.0, 1.0, 0.0, 0.0, 20.0, 0.0, 0.0, 19.0, 9.0, 9.0, 0.0, 0.0, 9.0, 7.0, 12.0, 0.0, 8.0, 11.0, 1.0, 14.0, 2.0, 0.0, 5.0, 3.0, 5.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.634588024590424, "mean_inference_ms": 4.888147523478053, "mean_action_processing_ms": 0.771197068744383, "mean_env_wait_ms": 0.5698111926115617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006136655807495117, "StateBufferConnector_ms": 0.005643010139465332, "ViewRequirementAgentConnector_ms": 0.11648046970367432}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 232.49999999999986, "episode_return_mean": 357.957, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.1874091882096, "num_env_steps_trained_throughput_per_sec": 272.1874091882096, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 1312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1312000, "timers": {"training_iteration_time_ms": 14450.774, "restore_workers_time_ms": 0.019, "training_step_time_ms": 14450.667, "sample_time_ms": 1707.436, "learn_time_ms": 12722.623, "learn_throughput": 314.401, "synch_weights_time_ms": 16.783}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 1312000, "num_agent_steps_trained": 1312000}, "done": false, "training_iteration": 82, "trial_id": "e4caa_00000", "date": "2024-08-13_20-14-40", "timestamp": 1723594480, "time_this_iter_s": 14.739879846572876, "time_total_s": 1814.2790446281433, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29adca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1814.2790446281433, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 56.98571428571429, "ram_util_percent": 83.60476190476192}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0764775620093423, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8630974004361113, "policy_loss": -0.006197886976102988, "vf_loss": 0.8686375759817936, "vf_explained_var": 0.30774979080472675, "kl": 0.008769475976028108, "entropy": 1.4095670057982994, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.369506658321966, "cur_kl_coeff": 7.105427357601002e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.41904791722064294, "policy_loss": -0.005170638087851108, "vf_loss": 0.42421855505496736, "vf_explained_var": 0.10168634198960803, "kl": 0.0009812790497451332, "entropy": 0.04492046762671736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 155925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 242.29999999999998, "episode_reward_mean": 362.098, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 39.799999999999976, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 35.0}, "policy_reward_mean": {"prey_policy": 174.609, "predator_policy": 6.44}, "custom_metrics": {}, "hist_stats": {"episode_reward": [375.6000000000001, 400.0, 362.6, 385.7, 376.7, 376.2, 399.1, 364.2, 243.5, 367.6, 338.0, 359.29999999999995, 346.0, 368.0, 358.0, 382.0, 382.0, 309.5999999999999, 360.4, 364.6, 360.0, 373.2, 273.99999999999994, 362.4, 394.6, 372.6, 365.8, 350.4, 348.2, 394.6, 365.0, 347.0, 366.7, 395.1, 344.8, 387.4000000000001, 341.5, 363.0, 382.0, 242.29999999999998, 357.1, 365.0, 391.0, 381.7, 381.1, 382.69999999999993, 374.7, 367.6, 356.9, 386.5, 317.8, 350.5, 373.0, 346.2, 296.1, 376.0, 392.0, 369.9, 275.6, 382.0, 398.2, 348.1, 390.0, 357.1, 368.0, 393.0, 281.4, 365.3, 379.4, 381.2, 373.9, 335.70000000000005, 352.1, 364.9, 388.3, 314.90000000000003, 362.0, 346.0, 344.0, 372.6, 375.9, 364.2, 396.4, 360.7, 385.0, 351.9, 365.1, 337.2, 350.2, 371.9, 389.7, 343.0, 375.30000000000007, 392.20000000000005, 388.0, 380.2, 375.0, 364.0, 387.4, 367.3], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [182.3, 188.29999999999998, 200.0, 200.0, 147.5, 199.1, 200.0, 181.7, 190.10000000000002, 182.6, 180.2, 194.0, 200.0, 199.1, 191.0, 135.2, 172.7, 39.799999999999976, 197.0, 149.6, 155.0, 164.0, 197.29999999999998, 152.0, 172.1, 152.9, 200.0, 152.0, 155.0, 188.0, 179.0, 197.0, 185.0, 192.0, 88.1, 195.5, 177.2, 162.2, 167.0, 179.6, 172.39999999999998, 176.6, 185.0, 180.2, 142.1, 74.89999999999998, 169.4, 185.0, 200.0, 194.6, 161.0, 194.6, 161.0, 189.8, 171.2, 156.2, 184.7, 150.5, 199.1, 195.49999999999997, 199.1, 152.9, 164.0, 152.0, 188.3, 178.39999999999998, 193.1, 200.0, 170.3, 162.5, 195.49999999999997, 191.9, 170.0, 141.5, 185.0, 160.0, 189.0, 193.0, 143.0, 47.29999999999998, 200.0, 145.1, 177.2, 183.8, 191.0, 200.0, 188.0, 187.7, 181.1, 200.0, 192.5, 189.2, 190.1, 179.6, 176.6, 191.0, 182.3, 161.6, 200.0, 186.5, 161.3, 111.5, 167.3, 165.2, 172.1, 191.9, 165.2, 161.0, 75.19999999999999, 182.9, 189.0, 182.0, 182.0, 200.0, 173.9, 182.0, 128.6, 125.0, 199.1, 182.9, 200.0, 198.2, 164.0, 172.1, 185.0, 200.0, 190.1, 125.0, 200.0, 152.0, 194.0, 197.0, 99.2, 129.2, 151.1, 198.2, 188.6, 186.8, 197.3, 179.9, 190.1, 183.8, 200.0, 115.7, 140.3, 192.8, 157.7, 189.2, 189.2, 199.1, 133.7, 165.2, 190.0, 160.0, 141.0, 186.0, 159.0, 170.0, 184.1, 186.5, 185.0, 182.9, 185.0, 171.2, 196.4, 200.0, 184.7, 164.0, 191.0, 191.0, 107.0, 182.9, 178.1, 179.0, 170.0, 141.2, 159.2, 173.0, 170.0, 191.89999999999998, 191.0, 193.7, 167.0, 164.0, 181.39999999999998, 191.9, 191.0, 198.2, 182.0, 200.0, 192.8, 187.4, 185.0, 185.0, 189.0, 175.0, 199.1, 188.3, 155.0, 197.3], "policy_predator_policy_reward": [0.0, 5.0, 0.0, 0.0, 0.0, 16.0, 4.0, 0.0, 4.0, 0.0, 0.0, 2.0, 0.0, 0.0, 21.0, 17.0, 31.0, 0.0, 11.0, 10.0, 11.0, 8.0, 0.0, 10.0, 13.0, 8.0, 9.0, 7.0, 15.0, 0.0, 6.0, 0.0, 0.0, 5.0, 13.0, 13.0, 19.0, 2.0, 7.0, 11.0, 8.0, 3.0, 8.0, 0.0, 29.0, 28.0, 0.0, 8.0, 0.0, 0.0, 11.0, 6.0, 4.0, 11.0, 14.0, 9.0, 1.0, 12.0, 0.0, 0.0, 13.0, 0.0, 16.0, 15.0, 0.0, 0.0, 2.0, 0.0, 12.0, 0.0, 0.0, 0.0, 9.0, 21.0, 5.0, 13.0, 0.0, 0.0, 28.0, 24.0, 0.0, 12.0, 0.0, 4.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 23.0, 22.0, 12.0, 6.0, 0.0, 9.0, 0.0, 20.0, 3.0, 35.0, 2.0, 3.0, 6.0, 4.0, 5.0, 9.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 5.0, 0.0, 22.0, 20.0, 0.0, 16.0, 2.0, 0.0, 30.0, 23.0, 0.0, 16.0, 4.0, 0.0, 3.0, 1.0, 0.0, 0.0, 20.0, 0.0, 0.0, 19.0, 9.0, 9.0, 0.0, 0.0, 9.0, 7.0, 12.0, 0.0, 8.0, 11.0, 1.0, 14.0, 2.0, 0.0, 5.0, 3.0, 5.0, 3.0, 0.0, 0.0, 12.0, 0.0, 0.0, 3.0, 31.0, 31.0, 7.0, 1.0, 16.0, 10.0, 6.0, 12.0, 0.0, 10.0, 2.0, 3.0, 0.0, 12.0, 0.0, 2.0, 0.0, 3.0, 0.0, 6.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.628542573715585, "mean_inference_ms": 4.868368628488727, "mean_action_processing_ms": 0.7645253198801398, "mean_env_wait_ms": 0.5657395519605969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007413625717163086, "StateBufferConnector_ms": 0.005584836006164551, "ViewRequirementAgentConnector_ms": 0.11821210384368896}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 242.29999999999998, "episode_return_mean": 362.098, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.23910098871596, "num_env_steps_trained_throughput_per_sec": 288.23910098871596, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 1328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1328000, "timers": {"training_iteration_time_ms": 14378.898, "restore_workers_time_ms": 0.019, "training_step_time_ms": 14378.791, "sample_time_ms": 1663.25, "learn_time_ms": 12694.795, "learn_throughput": 315.09, "synch_weights_time_ms": 17.009}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 1328000, "num_agent_steps_trained": 1328000}, "done": false, "training_iteration": 83, "trial_id": "e4caa_00000", "date": "2024-08-13_20-14-54", "timestamp": 1723594494, "time_this_iter_s": 13.981888055801392, "time_total_s": 1828.2609326839447, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29add30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1828.2609326839447, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 57.04, "ram_util_percent": 83.52000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9858065197076746, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6671778919553463, "policy_loss": -0.006466161994702089, "vf_loss": 0.6730909706305259, "vf_explained_var": 0.4348402658152202, "kl": 0.00737445928120571, "entropy": 1.4007610343751453, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9352437074064578, "cur_kl_coeff": 3.552713678800501e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.38030861937810506, "policy_loss": -0.0022884008974802714, "vf_loss": 0.3825970207004704, "vf_explained_var": 0.11261913082587025, "kl": 0.0012750938463295758, "entropy": 0.03987077225748666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 157815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 242.29999999999998, "episode_reward_mean": 362.12899999999996, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 47.29999999999998, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 35.0}, "policy_reward_mean": {"prey_policy": 174.74949999999998, "predator_policy": 6.315}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.4, 364.6, 360.0, 373.2, 273.99999999999994, 362.4, 394.6, 372.6, 365.8, 350.4, 348.2, 394.6, 365.0, 347.0, 366.7, 395.1, 344.8, 387.4000000000001, 341.5, 363.0, 382.0, 242.29999999999998, 357.1, 365.0, 391.0, 381.7, 381.1, 382.69999999999993, 374.7, 367.6, 356.9, 386.5, 317.8, 350.5, 373.0, 346.2, 296.1, 376.0, 392.0, 369.9, 275.6, 382.0, 398.2, 348.1, 390.0, 357.1, 368.0, 393.0, 281.4, 365.3, 379.4, 381.2, 373.9, 335.70000000000005, 352.1, 364.9, 388.3, 314.90000000000003, 362.0, 346.0, 344.0, 372.6, 375.9, 364.2, 396.4, 360.7, 385.0, 351.9, 365.1, 337.2, 350.2, 371.9, 389.7, 343.0, 375.30000000000007, 392.20000000000005, 388.0, 380.2, 375.0, 364.0, 387.4, 367.3, 358.0, 373.0, 369.2, 358.8, 346.8, 373.6, 318.9000000000001, 368.9, 374.8000000000001, 329.2, 352.9, 364.0, 364.4, 380.2, 343.0, 368.0, 368.5, 385.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [177.2, 162.2, 167.0, 179.6, 172.39999999999998, 176.6, 185.0, 180.2, 142.1, 74.89999999999998, 169.4, 185.0, 200.0, 194.6, 161.0, 194.6, 161.0, 189.8, 171.2, 156.2, 184.7, 150.5, 199.1, 195.49999999999997, 199.1, 152.9, 164.0, 152.0, 188.3, 178.39999999999998, 193.1, 200.0, 170.3, 162.5, 195.49999999999997, 191.9, 170.0, 141.5, 185.0, 160.0, 189.0, 193.0, 143.0, 47.29999999999998, 200.0, 145.1, 177.2, 183.8, 191.0, 200.0, 188.0, 187.7, 181.1, 200.0, 192.5, 189.2, 190.1, 179.6, 176.6, 191.0, 182.3, 161.6, 200.0, 186.5, 161.3, 111.5, 167.3, 165.2, 172.1, 191.9, 165.2, 161.0, 75.19999999999999, 182.9, 189.0, 182.0, 182.0, 200.0, 173.9, 182.0, 128.6, 125.0, 199.1, 182.9, 200.0, 198.2, 164.0, 172.1, 185.0, 200.0, 190.1, 125.0, 200.0, 152.0, 194.0, 197.0, 99.2, 129.2, 151.1, 198.2, 188.6, 186.8, 197.3, 179.9, 190.1, 183.8, 200.0, 115.7, 140.3, 192.8, 157.7, 189.2, 189.2, 199.1, 133.7, 165.2, 190.0, 160.0, 141.0, 186.0, 159.0, 170.0, 184.1, 186.5, 185.0, 182.9, 185.0, 171.2, 196.4, 200.0, 184.7, 164.0, 191.0, 191.0, 107.0, 182.9, 178.1, 179.0, 170.0, 141.2, 159.2, 173.0, 170.0, 191.89999999999998, 191.0, 193.7, 167.0, 164.0, 181.39999999999998, 191.9, 191.0, 198.2, 182.0, 200.0, 192.8, 187.4, 185.0, 185.0, 189.0, 175.0, 199.1, 188.3, 155.0, 197.3, 164.0, 173.0, 179.0, 185.0, 194.6, 173.6, 177.5, 173.3, 165.8, 167.0, 189.2, 178.4, 155.89999999999998, 140.0, 197.3, 158.6, 192.8, 181.99999999999997, 140.6, 158.6, 146.9, 170.0, 168.2, 183.8, 199.1, 149.3, 193.7, 186.5, 128.0, 199.0, 174.0, 188.0, 182.9, 185.6, 193.7, 188.29999999999998], "policy_predator_policy_reward": [19.0, 2.0, 7.0, 11.0, 8.0, 3.0, 8.0, 0.0, 29.0, 28.0, 0.0, 8.0, 0.0, 0.0, 11.0, 6.0, 4.0, 11.0, 14.0, 9.0, 1.0, 12.0, 0.0, 0.0, 13.0, 0.0, 16.0, 15.0, 0.0, 0.0, 2.0, 0.0, 12.0, 0.0, 0.0, 0.0, 9.0, 21.0, 5.0, 13.0, 0.0, 0.0, 28.0, 24.0, 0.0, 12.0, 0.0, 4.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 23.0, 22.0, 12.0, 6.0, 0.0, 9.0, 0.0, 20.0, 3.0, 35.0, 2.0, 3.0, 6.0, 4.0, 5.0, 9.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 5.0, 0.0, 22.0, 20.0, 0.0, 16.0, 2.0, 0.0, 30.0, 23.0, 0.0, 16.0, 4.0, 0.0, 3.0, 1.0, 0.0, 0.0, 20.0, 0.0, 0.0, 19.0, 9.0, 9.0, 0.0, 0.0, 9.0, 7.0, 12.0, 0.0, 8.0, 11.0, 1.0, 14.0, 2.0, 0.0, 5.0, 3.0, 5.0, 3.0, 0.0, 0.0, 12.0, 0.0, 0.0, 3.0, 31.0, 31.0, 7.0, 1.0, 16.0, 10.0, 6.0, 12.0, 0.0, 10.0, 2.0, 3.0, 0.0, 12.0, 0.0, 2.0, 0.0, 3.0, 0.0, 6.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 12.0, 9.0, 12.0, 9.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 14.0, 6.0, 0.0, 23.0, 0.0, 12.0, 1.0, 0.0, 0.0, 12.0, 18.0, 20.0, 16.0, 7.0, 5.0, 16.0, 0.0, 0.0, 0.0, 6.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.618583776730315, "mean_inference_ms": 4.840276643103874, "mean_action_processing_ms": 0.7593404131446545, "mean_env_wait_ms": 0.5622874204692425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007590532302856445, "StateBufferConnector_ms": 0.004971623420715332, "ViewRequirementAgentConnector_ms": 0.12187337875366211}, "num_episodes": 18, "episode_return_max": 398.2, "episode_return_min": 242.29999999999998, "episode_return_mean": 362.12899999999996, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.7591650702619, "num_env_steps_trained_throughput_per_sec": 273.7591650702619, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 1344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1344000, "timers": {"training_iteration_time_ms": 14459.354, "restore_workers_time_ms": 0.02, "training_step_time_ms": 14459.246, "sample_time_ms": 1683.838, "learn_time_ms": 12754.846, "learn_throughput": 313.606, "synch_weights_time_ms": 16.775}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 1344000, "num_agent_steps_trained": 1344000}, "done": false, "training_iteration": 84, "trial_id": "e4caa_00000", "date": "2024-08-13_20-15-09", "timestamp": 1723594509, "time_this_iter_s": 14.646385908126831, "time_total_s": 1842.9073185920715, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2871c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1842.9073185920715, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 58.67619047619047, "ram_util_percent": 83.34761904761905}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1331863731303544, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2193232306018078, "policy_loss": -0.011117688441777197, "vf_loss": 1.2299184415075515, "vf_explained_var": 0.3580470174708694, "kl": 0.0069663786830268465, "entropy": 1.3679968694530467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.620901702131544, "cur_kl_coeff": 1.7763568394002506e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7070158447853472, "policy_loss": -0.0022658016239465385, "vf_loss": 0.7092816454511156, "vf_explained_var": 0.06585471740475407, "kl": 0.012445480598233295, "entropy": 0.07209033226525342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 159705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 255.00000000000003, "episode_reward_mean": 361.105, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 72.5, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 44.0}, "policy_reward_mean": {"prey_policy": 174.3625, "predator_policy": 6.19}, "custom_metrics": {}, "hist_stats": {"episode_reward": [357.1, 365.0, 391.0, 381.7, 381.1, 382.69999999999993, 374.7, 367.6, 356.9, 386.5, 317.8, 350.5, 373.0, 346.2, 296.1, 376.0, 392.0, 369.9, 275.6, 382.0, 398.2, 348.1, 390.0, 357.1, 368.0, 393.0, 281.4, 365.3, 379.4, 381.2, 373.9, 335.70000000000005, 352.1, 364.9, 388.3, 314.90000000000003, 362.0, 346.0, 344.0, 372.6, 375.9, 364.2, 396.4, 360.7, 385.0, 351.9, 365.1, 337.2, 350.2, 371.9, 389.7, 343.0, 375.30000000000007, 392.20000000000005, 388.0, 380.2, 375.0, 364.0, 387.4, 367.3, 358.0, 373.0, 369.2, 358.8, 346.8, 373.6, 318.9000000000001, 368.9, 374.8000000000001, 329.2, 352.9, 364.0, 364.4, 380.2, 343.0, 368.0, 368.5, 385.0, 364.6, 371.2, 373.1, 370.3, 354.7, 380.0, 390.1, 370.0, 277.30000000000007, 374.0, 345.1, 391.9, 331.9, 296.3, 370.3, 255.00000000000003, 354.4, 360.5, 371.0, 289.0, 362.5, 400.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 145.1, 177.2, 183.8, 191.0, 200.0, 188.0, 187.7, 181.1, 200.0, 192.5, 189.2, 190.1, 179.6, 176.6, 191.0, 182.3, 161.6, 200.0, 186.5, 161.3, 111.5, 167.3, 165.2, 172.1, 191.9, 165.2, 161.0, 75.19999999999999, 182.9, 189.0, 182.0, 182.0, 200.0, 173.9, 182.0, 128.6, 125.0, 199.1, 182.9, 200.0, 198.2, 164.0, 172.1, 185.0, 200.0, 190.1, 125.0, 200.0, 152.0, 194.0, 197.0, 99.2, 129.2, 151.1, 198.2, 188.6, 186.8, 197.3, 179.9, 190.1, 183.8, 200.0, 115.7, 140.3, 192.8, 157.7, 189.2, 189.2, 199.1, 133.7, 165.2, 190.0, 160.0, 141.0, 186.0, 159.0, 170.0, 184.1, 186.5, 185.0, 182.9, 185.0, 171.2, 196.4, 200.0, 184.7, 164.0, 191.0, 191.0, 107.0, 182.9, 178.1, 179.0, 170.0, 141.2, 159.2, 173.0, 170.0, 191.89999999999998, 191.0, 193.7, 167.0, 164.0, 181.39999999999998, 191.9, 191.0, 198.2, 182.0, 200.0, 192.8, 187.4, 185.0, 185.0, 189.0, 175.0, 199.1, 188.3, 155.0, 197.3, 164.0, 173.0, 179.0, 185.0, 194.6, 173.6, 177.5, 173.3, 165.8, 167.0, 189.2, 178.4, 155.89999999999998, 140.0, 197.3, 158.6, 192.8, 181.99999999999997, 140.6, 158.6, 146.9, 170.0, 168.2, 183.8, 199.1, 149.3, 193.7, 186.5, 128.0, 199.0, 174.0, 188.0, 182.9, 185.6, 193.7, 188.29999999999998, 128.0, 194.6, 184.7, 186.5, 200.0, 160.1, 164.89999999999998, 196.4, 173.0, 166.7, 192.5, 186.5, 196.4, 193.7, 179.0, 176.0, 117.49999999999999, 153.79999999999998, 200.0, 161.0, 173.9, 171.2, 194.6, 197.3, 156.8, 160.1, 72.5, 135.8, 175.7, 194.60000000000002, 98.29999999999998, 142.7, 135.2, 198.2, 153.5, 194.0, 179.0, 188.0, 137.0, 109.0, 167.0, 183.5, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 12.0, 0.0, 4.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 1.0, 5.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 23.0, 22.0, 12.0, 6.0, 0.0, 9.0, 0.0, 20.0, 3.0, 35.0, 2.0, 3.0, 6.0, 4.0, 5.0, 9.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 5.0, 0.0, 22.0, 20.0, 0.0, 16.0, 2.0, 0.0, 30.0, 23.0, 0.0, 16.0, 4.0, 0.0, 3.0, 1.0, 0.0, 0.0, 20.0, 0.0, 0.0, 19.0, 9.0, 9.0, 0.0, 0.0, 9.0, 7.0, 12.0, 0.0, 8.0, 11.0, 1.0, 14.0, 2.0, 0.0, 5.0, 3.0, 5.0, 3.0, 0.0, 0.0, 12.0, 0.0, 0.0, 3.0, 31.0, 31.0, 7.0, 1.0, 16.0, 10.0, 6.0, 12.0, 0.0, 10.0, 2.0, 3.0, 0.0, 12.0, 0.0, 2.0, 0.0, 3.0, 0.0, 6.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 12.0, 9.0, 12.0, 9.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 14.0, 6.0, 0.0, 23.0, 0.0, 12.0, 1.0, 0.0, 0.0, 12.0, 18.0, 20.0, 16.0, 7.0, 5.0, 16.0, 0.0, 0.0, 0.0, 6.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 3.0, 23.0, 19.0, 0.0, 0.0, 0.0, 13.0, 9.0, 0.0, 12.0, 3.0, 1.0, 0.0, 0.0, 0.0, 10.0, 5.0, 6.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 44.0, 44.0, 0.0, 0.0, 0.0, 14.0, 10.0, 11.0, 3.0, 10.0, 4.0, 0.0, 0.0, 43.0, 11.0, 1.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6063898252798134, "mean_inference_ms": 4.806541067967407, "mean_action_processing_ms": 0.7532151982315562, "mean_env_wait_ms": 0.558162272524513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005859375, "StateBufferConnector_ms": 0.00498509407043457, "ViewRequirementAgentConnector_ms": 0.12028932571411133}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 255.00000000000003, "episode_return_mean": 361.105, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.073584084038, "num_env_steps_trained_throughput_per_sec": 284.073584084038, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 14445.465, "restore_workers_time_ms": 0.02, "training_step_time_ms": 14445.356, "sample_time_ms": 1681.055, "learn_time_ms": 12744.032, "learn_throughput": 313.872, "synch_weights_time_ms": 16.609}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 85, "trial_id": "e4caa_00000", "date": "2024-08-13_20-15-23", "timestamp": 1723594523, "time_this_iter_s": 14.1595458984375, "time_total_s": 1857.066864490509, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2931040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1857.066864490509, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 57.80999999999999, "ram_util_percent": 83.295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7615362926292673, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7555949257046142, "policy_loss": -0.008677459047939727, "vf_loss": 0.7638651772860496, "vf_explained_var": 0.34158993448529923, "kl": 0.005429493340648512, "entropy": 1.3769913798286801, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0821286039653595, "cur_kl_coeff": 1.7763568394002506e-16, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8039470088071924, "policy_loss": -0.0023515180923616287, "vf_loss": 0.8062985259704489, "vf_explained_var": 0.07141562656120018, "kl": 0.001177544179882348, "entropy": 0.04891306609605198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 161595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 255.00000000000003, "episode_reward_mean": 358.77700000000004, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 72.5, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 44.0}, "policy_reward_mean": {"prey_policy": 172.46849999999998, "predator_policy": 6.92}, "custom_metrics": {}, "hist_stats": {"episode_reward": [275.6, 382.0, 398.2, 348.1, 390.0, 357.1, 368.0, 393.0, 281.4, 365.3, 379.4, 381.2, 373.9, 335.70000000000005, 352.1, 364.9, 388.3, 314.90000000000003, 362.0, 346.0, 344.0, 372.6, 375.9, 364.2, 396.4, 360.7, 385.0, 351.9, 365.1, 337.2, 350.2, 371.9, 389.7, 343.0, 375.30000000000007, 392.20000000000005, 388.0, 380.2, 375.0, 364.0, 387.4, 367.3, 358.0, 373.0, 369.2, 358.8, 346.8, 373.6, 318.9000000000001, 368.9, 374.8000000000001, 329.2, 352.9, 364.0, 364.4, 380.2, 343.0, 368.0, 368.5, 385.0, 364.6, 371.2, 373.1, 370.3, 354.7, 380.0, 390.1, 370.0, 277.30000000000007, 374.0, 345.1, 391.9, 331.9, 296.3, 370.3, 255.00000000000003, 354.4, 360.5, 371.0, 289.0, 362.5, 400.0, 271.9, 388.4, 374.1, 388.4, 354.0, 380.0, 384.4, 339.0, 339.1, 300.1000000000001, 365.8, 266.3, 377.5, 387.4, 382.0, 377.0, 341.1, 316.5], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [128.6, 125.0, 199.1, 182.9, 200.0, 198.2, 164.0, 172.1, 185.0, 200.0, 190.1, 125.0, 200.0, 152.0, 194.0, 197.0, 99.2, 129.2, 151.1, 198.2, 188.6, 186.8, 197.3, 179.9, 190.1, 183.8, 200.0, 115.7, 140.3, 192.8, 157.7, 189.2, 189.2, 199.1, 133.7, 165.2, 190.0, 160.0, 141.0, 186.0, 159.0, 170.0, 184.1, 186.5, 185.0, 182.9, 185.0, 171.2, 196.4, 200.0, 184.7, 164.0, 191.0, 191.0, 107.0, 182.9, 178.1, 179.0, 170.0, 141.2, 159.2, 173.0, 170.0, 191.89999999999998, 191.0, 193.7, 167.0, 164.0, 181.39999999999998, 191.9, 191.0, 198.2, 182.0, 200.0, 192.8, 187.4, 185.0, 185.0, 189.0, 175.0, 199.1, 188.3, 155.0, 197.3, 164.0, 173.0, 179.0, 185.0, 194.6, 173.6, 177.5, 173.3, 165.8, 167.0, 189.2, 178.4, 155.89999999999998, 140.0, 197.3, 158.6, 192.8, 181.99999999999997, 140.6, 158.6, 146.9, 170.0, 168.2, 183.8, 199.1, 149.3, 193.7, 186.5, 128.0, 199.0, 174.0, 188.0, 182.9, 185.6, 193.7, 188.29999999999998, 128.0, 194.6, 184.7, 186.5, 200.0, 160.1, 164.89999999999998, 196.4, 173.0, 166.7, 192.5, 186.5, 196.4, 193.7, 179.0, 176.0, 117.49999999999999, 153.79999999999998, 200.0, 161.0, 173.9, 171.2, 194.6, 197.3, 156.8, 160.1, 72.5, 135.8, 175.7, 194.60000000000002, 98.29999999999998, 142.7, 135.2, 198.2, 153.5, 194.0, 179.0, 188.0, 137.0, 109.0, 167.0, 183.5, 200.0, 200.0, 124.1, 75.80000000000001, 184.4, 200.0, 161.0, 190.1, 185.3, 199.1, 162.2, 177.8, 200.0, 170.0, 199.1, 179.3, 158.0, 161.0, 173.3, 153.8, 177.2, 77.89999999999998, 176.6, 189.2, 141.8, 78.5, 185.6, 191.9, 187.4, 200.0, 190.0, 188.0, 155.0, 200.0, 191.9, 102.2, 189.2, 110.3], "policy_predator_policy_reward": [22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 5.0, 0.0, 22.0, 20.0, 0.0, 16.0, 2.0, 0.0, 30.0, 23.0, 0.0, 16.0, 4.0, 0.0, 3.0, 1.0, 0.0, 0.0, 20.0, 0.0, 0.0, 19.0, 9.0, 9.0, 0.0, 0.0, 9.0, 7.0, 12.0, 0.0, 8.0, 11.0, 1.0, 14.0, 2.0, 0.0, 5.0, 3.0, 5.0, 3.0, 0.0, 0.0, 12.0, 0.0, 0.0, 3.0, 31.0, 31.0, 7.0, 1.0, 16.0, 10.0, 6.0, 12.0, 0.0, 10.0, 2.0, 3.0, 0.0, 12.0, 0.0, 2.0, 0.0, 3.0, 0.0, 6.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 12.0, 9.0, 12.0, 9.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 14.0, 6.0, 0.0, 23.0, 0.0, 12.0, 1.0, 0.0, 0.0, 12.0, 18.0, 20.0, 16.0, 7.0, 5.0, 16.0, 0.0, 0.0, 0.0, 6.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 3.0, 23.0, 19.0, 0.0, 0.0, 0.0, 13.0, 9.0, 0.0, 12.0, 3.0, 1.0, 0.0, 0.0, 0.0, 10.0, 5.0, 6.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 44.0, 44.0, 0.0, 0.0, 0.0, 14.0, 10.0, 11.0, 3.0, 10.0, 4.0, 0.0, 0.0, 43.0, 11.0, 1.0, 0.0, 0.0, 33.0, 39.0, 0.0, 4.0, 13.0, 10.0, 4.0, 0.0, 12.0, 2.0, 10.0, 0.0, 6.0, 0.0, 12.0, 8.0, 6.0, 6.0, 12.0, 33.0, 0.0, 0.0, 12.0, 34.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 13.0, 9.0, 26.0, 21.0, 17.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5967925505304164, "mean_inference_ms": 4.779447376260014, "mean_action_processing_ms": 0.7482914691255163, "mean_env_wait_ms": 0.5548784106170292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005895137786865234, "StateBufferConnector_ms": 0.0036889314651489258, "ViewRequirementAgentConnector_ms": 0.11897242069244385}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 255.00000000000003, "episode_return_mean": 358.77700000000004, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.6057198458916, "num_env_steps_trained_throughput_per_sec": 267.6057198458916, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 1376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1376000, "timers": {"training_iteration_time_ms": 14577.127, "restore_workers_time_ms": 0.02, "training_step_time_ms": 14577.018, "sample_time_ms": 1684.751, "learn_time_ms": 12870.726, "learn_throughput": 310.783, "synch_weights_time_ms": 17.027}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 1376000, "num_agent_steps_trained": 1376000}, "done": false, "training_iteration": 86, "trial_id": "e4caa_00000", "date": "2024-08-13_20-15-39", "timestamp": 1723594539, "time_this_iter_s": 15.079879760742188, "time_total_s": 1872.1467442512512, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b19940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1872.1467442512512, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 59.85909090909092, "ram_util_percent": 83.71363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9026754779317392, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6604575167952115, "policy_loss": -0.003768139652336243, "vf_loss": 0.6637847220298474, "vf_explained_var": 0.2952384995089637, "kl": 0.0058791453759762845, "entropy": 1.387922065409403, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4137533475088064, "cur_kl_coeff": 8.881784197001253e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5160056864616102, "policy_loss": -0.0022027301804098502, "vf_loss": 0.5182084169613306, "vf_explained_var": 0.14153123993091482, "kl": 0.0016250454282186687, "entropy": 0.05430064114530093, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 163485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 255.00000000000003, "episode_reward_mean": 360.353, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 72.5, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 44.0}, "policy_reward_mean": {"prey_policy": 173.25150000000002, "predator_policy": 6.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [364.2, 396.4, 360.7, 385.0, 351.9, 365.1, 337.2, 350.2, 371.9, 389.7, 343.0, 375.30000000000007, 392.20000000000005, 388.0, 380.2, 375.0, 364.0, 387.4, 367.3, 358.0, 373.0, 369.2, 358.8, 346.8, 373.6, 318.9000000000001, 368.9, 374.8000000000001, 329.2, 352.9, 364.0, 364.4, 380.2, 343.0, 368.0, 368.5, 385.0, 364.6, 371.2, 373.1, 370.3, 354.7, 380.0, 390.1, 370.0, 277.30000000000007, 374.0, 345.1, 391.9, 331.9, 296.3, 370.3, 255.00000000000003, 354.4, 360.5, 371.0, 289.0, 362.5, 400.0, 271.9, 388.4, 374.1, 388.4, 354.0, 380.0, 384.4, 339.0, 339.1, 300.1000000000001, 365.8, 266.3, 377.5, 387.4, 382.0, 377.0, 341.1, 316.5, 370.0, 371.6, 332.6, 398.2, 319.6, 363.2, 382.5, 391.9, 388.4, 341.79999999999995, 325.7, 368.2, 395.5, 385.2, 388.8, 396.0, 344.8, 348.0, 345.0, 376.0, 353.5, 335.6, 385.1], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [185.0, 171.2, 196.4, 200.0, 184.7, 164.0, 191.0, 191.0, 107.0, 182.9, 178.1, 179.0, 170.0, 141.2, 159.2, 173.0, 170.0, 191.89999999999998, 191.0, 193.7, 167.0, 164.0, 181.39999999999998, 191.9, 191.0, 198.2, 182.0, 200.0, 192.8, 187.4, 185.0, 185.0, 189.0, 175.0, 199.1, 188.3, 155.0, 197.3, 164.0, 173.0, 179.0, 185.0, 194.6, 173.6, 177.5, 173.3, 165.8, 167.0, 189.2, 178.4, 155.89999999999998, 140.0, 197.3, 158.6, 192.8, 181.99999999999997, 140.6, 158.6, 146.9, 170.0, 168.2, 183.8, 199.1, 149.3, 193.7, 186.5, 128.0, 199.0, 174.0, 188.0, 182.9, 185.6, 193.7, 188.29999999999998, 128.0, 194.6, 184.7, 186.5, 200.0, 160.1, 164.89999999999998, 196.4, 173.0, 166.7, 192.5, 186.5, 196.4, 193.7, 179.0, 176.0, 117.49999999999999, 153.79999999999998, 200.0, 161.0, 173.9, 171.2, 194.6, 197.3, 156.8, 160.1, 72.5, 135.8, 175.7, 194.60000000000002, 98.29999999999998, 142.7, 135.2, 198.2, 153.5, 194.0, 179.0, 188.0, 137.0, 109.0, 167.0, 183.5, 200.0, 200.0, 124.1, 75.80000000000001, 184.4, 200.0, 161.0, 190.1, 185.3, 199.1, 162.2, 177.8, 200.0, 170.0, 199.1, 179.3, 158.0, 161.0, 173.3, 153.8, 177.2, 77.89999999999998, 176.6, 189.2, 141.8, 78.5, 185.6, 191.9, 187.4, 200.0, 190.0, 188.0, 155.0, 200.0, 191.9, 102.2, 189.2, 110.3, 140.0, 191.0, 179.0, 185.6, 186.5, 103.1, 198.2, 200.0, 151.1, 126.5, 185.6, 158.6, 189.2, 191.3, 192.8, 199.1, 196.4, 188.0, 164.3, 165.5, 174.8, 128.9, 180.2, 182.0, 199.1, 196.4, 176.0, 198.2, 200.0, 186.8, 200.0, 194.0, 179.3, 150.5, 198.0, 131.0, 173.0, 153.0, 189.0, 186.0, 156.8, 184.7, 125.0, 185.6, 188.0, 193.1], "policy_predator_policy_reward": [5.0, 3.0, 0.0, 0.0, 12.0, 0.0, 0.0, 3.0, 31.0, 31.0, 7.0, 1.0, 16.0, 10.0, 6.0, 12.0, 0.0, 10.0, 2.0, 3.0, 0.0, 12.0, 0.0, 2.0, 0.0, 3.0, 0.0, 6.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 12.0, 9.0, 12.0, 9.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 14.0, 6.0, 0.0, 23.0, 0.0, 12.0, 1.0, 0.0, 0.0, 12.0, 18.0, 20.0, 16.0, 7.0, 5.0, 16.0, 0.0, 0.0, 0.0, 6.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 3.0, 23.0, 19.0, 0.0, 0.0, 0.0, 13.0, 9.0, 0.0, 12.0, 3.0, 1.0, 0.0, 0.0, 0.0, 10.0, 5.0, 6.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 44.0, 44.0, 0.0, 0.0, 0.0, 14.0, 10.0, 11.0, 3.0, 10.0, 4.0, 0.0, 0.0, 43.0, 11.0, 1.0, 0.0, 0.0, 33.0, 39.0, 0.0, 4.0, 13.0, 10.0, 4.0, 0.0, 12.0, 2.0, 10.0, 0.0, 6.0, 0.0, 12.0, 8.0, 6.0, 6.0, 12.0, 33.0, 0.0, 0.0, 12.0, 34.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 13.0, 9.0, 26.0, 21.0, 17.0, 0.0, 19.0, 20.0, 7.0, 0.0, 22.0, 21.0, 0.0, 0.0, 27.0, 15.0, 7.0, 12.0, 2.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 12.0, 15.0, 7.0, 6.0, 0.0, 0.0, 0.0, 6.0, 5.0, 2.0, 0.0, 2.0, 0.0, 0.0, 15.0, 18.0, 1.0, 9.0, 10.0, 1.0, 0.0, 12.0, 0.0, 0.0, 25.0, 0.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5856090799471272, "mean_inference_ms": 4.747391180567765, "mean_action_processing_ms": 0.7422672342747823, "mean_env_wait_ms": 0.551051964451153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006136655807495117, "StateBufferConnector_ms": 0.00527799129486084, "ViewRequirementAgentConnector_ms": 0.13394618034362793}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 255.00000000000003, "episode_return_mean": 360.353, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.44588637717726, "num_env_steps_trained_throughput_per_sec": 261.44588637717726, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 1392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1392000, "timers": {"training_iteration_time_ms": 14575.461, "restore_workers_time_ms": 0.021, "training_step_time_ms": 14575.354, "sample_time_ms": 1735.591, "learn_time_ms": 12818.198, "learn_throughput": 312.056, "synch_weights_time_ms": 17.079}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 1392000, "num_agent_steps_trained": 1392000}, "done": false, "training_iteration": 87, "trial_id": "e4caa_00000", "date": "2024-08-13_20-15-54", "timestamp": 1723594554, "time_this_iter_s": 15.346698999404907, "time_total_s": 1887.4934432506561, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29095e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1887.4934432506561, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 62.18636363636363, "ram_util_percent": 83.46363636363635}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.01293198466301, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.695657237708475, "policy_loss": -0.003712662290436802, "vf_loss": 0.6988166428905316, "vf_explained_var": 0.23306264136203383, "kl": 0.007376745621333932, "entropy": 1.3818213637543735, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.196485825915816, "cur_kl_coeff": 4.4408920985006264e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4134393954324344, "policy_loss": -0.0018361876065788602, "vf_loss": 0.41527558435456796, "vf_explained_var": 0.09304684570857456, "kl": 0.0008931364899146735, "entropy": 0.03336562420285884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 165375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 255.00000000000003, "episode_reward_mean": 358.87300000000005, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 72.5, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 44.0}, "policy_reward_mean": {"prey_policy": 172.2615, "predator_policy": 7.175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [367.3, 358.0, 373.0, 369.2, 358.8, 346.8, 373.6, 318.9000000000001, 368.9, 374.8000000000001, 329.2, 352.9, 364.0, 364.4, 380.2, 343.0, 368.0, 368.5, 385.0, 364.6, 371.2, 373.1, 370.3, 354.7, 380.0, 390.1, 370.0, 277.30000000000007, 374.0, 345.1, 391.9, 331.9, 296.3, 370.3, 255.00000000000003, 354.4, 360.5, 371.0, 289.0, 362.5, 400.0, 271.9, 388.4, 374.1, 388.4, 354.0, 380.0, 384.4, 339.0, 339.1, 300.1000000000001, 365.8, 266.3, 377.5, 387.4, 382.0, 377.0, 341.1, 316.5, 370.0, 371.6, 332.6, 398.2, 319.6, 363.2, 382.5, 391.9, 388.4, 341.79999999999995, 325.7, 368.2, 395.5, 385.2, 388.8, 396.0, 344.8, 348.0, 345.0, 376.0, 353.5, 335.6, 385.1, 354.7, 329.2, 382.0, 350.3, 354.7, 359.5, 395.5, 370.3, 381.7, 388.3, 366.29999999999995, 299.8, 364.9, 340.0, 375.0, 382.0, 392.8, 342.4000000000001], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [155.0, 197.3, 164.0, 173.0, 179.0, 185.0, 194.6, 173.6, 177.5, 173.3, 165.8, 167.0, 189.2, 178.4, 155.89999999999998, 140.0, 197.3, 158.6, 192.8, 181.99999999999997, 140.6, 158.6, 146.9, 170.0, 168.2, 183.8, 199.1, 149.3, 193.7, 186.5, 128.0, 199.0, 174.0, 188.0, 182.9, 185.6, 193.7, 188.29999999999998, 128.0, 194.6, 184.7, 186.5, 200.0, 160.1, 164.89999999999998, 196.4, 173.0, 166.7, 192.5, 186.5, 196.4, 193.7, 179.0, 176.0, 117.49999999999999, 153.79999999999998, 200.0, 161.0, 173.9, 171.2, 194.6, 197.3, 156.8, 160.1, 72.5, 135.8, 175.7, 194.60000000000002, 98.29999999999998, 142.7, 135.2, 198.2, 153.5, 194.0, 179.0, 188.0, 137.0, 109.0, 167.0, 183.5, 200.0, 200.0, 124.1, 75.80000000000001, 184.4, 200.0, 161.0, 190.1, 185.3, 199.1, 162.2, 177.8, 200.0, 170.0, 199.1, 179.3, 158.0, 161.0, 173.3, 153.8, 177.2, 77.89999999999998, 176.6, 189.2, 141.8, 78.5, 185.6, 191.9, 187.4, 200.0, 190.0, 188.0, 155.0, 200.0, 191.9, 102.2, 189.2, 110.3, 140.0, 191.0, 179.0, 185.6, 186.5, 103.1, 198.2, 200.0, 151.1, 126.5, 185.6, 158.6, 189.2, 191.3, 192.8, 199.1, 196.4, 188.0, 164.3, 165.5, 174.8, 128.9, 180.2, 182.0, 199.1, 196.4, 176.0, 198.2, 200.0, 186.8, 200.0, 194.0, 179.3, 150.5, 198.0, 131.0, 173.0, 153.0, 189.0, 186.0, 156.8, 184.7, 125.0, 185.6, 188.0, 193.1, 197.3, 124.4, 169.1, 136.1, 187.4, 194.59999999999997, 176.0, 155.3, 139.7, 200.0, 195.5, 149.0, 195.5, 200.0, 187.4, 182.9, 193.7, 182.0, 188.3, 200.0, 157.1, 189.2, 114.5, 155.3, 170.3, 194.6, 110.0, 200.0, 200.0, 164.0, 187.0, 195.0, 192.8, 200.0, 196.39999999999998, 119.0], "policy_predator_policy_reward": [3.0, 12.0, 9.0, 12.0, 9.0, 0.0, 1.0, 0.0, 0.0, 8.0, 0.0, 14.0, 6.0, 0.0, 23.0, 0.0, 12.0, 1.0, 0.0, 0.0, 12.0, 18.0, 20.0, 16.0, 7.0, 5.0, 16.0, 0.0, 0.0, 0.0, 6.0, 10.0, 6.0, 0.0, 0.0, 0.0, 0.0, 3.0, 23.0, 19.0, 0.0, 0.0, 0.0, 13.0, 9.0, 0.0, 12.0, 3.0, 1.0, 0.0, 0.0, 0.0, 10.0, 5.0, 6.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 44.0, 44.0, 0.0, 0.0, 0.0, 14.0, 10.0, 11.0, 3.0, 10.0, 4.0, 0.0, 0.0, 43.0, 11.0, 1.0, 0.0, 0.0, 33.0, 39.0, 0.0, 4.0, 13.0, 10.0, 4.0, 0.0, 12.0, 2.0, 10.0, 0.0, 6.0, 0.0, 12.0, 8.0, 6.0, 6.0, 12.0, 33.0, 0.0, 0.0, 12.0, 34.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 13.0, 9.0, 26.0, 21.0, 17.0, 0.0, 19.0, 20.0, 7.0, 0.0, 22.0, 21.0, 0.0, 0.0, 27.0, 15.0, 7.0, 12.0, 2.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 12.0, 15.0, 7.0, 6.0, 0.0, 0.0, 0.0, 6.0, 5.0, 2.0, 0.0, 2.0, 0.0, 0.0, 15.0, 18.0, 1.0, 9.0, 10.0, 1.0, 0.0, 12.0, 0.0, 0.0, 25.0, 0.0, 4.0, 22.0, 11.0, 3.0, 21.0, 0.0, 0.0, 19.0, 0.0, 9.0, 6.0, 1.0, 14.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 11.0, 9.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5768673293157605, "mean_inference_ms": 4.722324128668628, "mean_action_processing_ms": 0.7376408694161151, "mean_env_wait_ms": 0.5481079524331897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00749659538269043, "StateBufferConnector_ms": 0.00526583194732666, "ViewRequirementAgentConnector_ms": 0.13544535636901855}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 255.00000000000003, "episode_return_mean": 358.87300000000005, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.0118945341965, "num_env_steps_trained_throughput_per_sec": 271.0118945341965, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 1408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1408000, "timers": {"training_iteration_time_ms": 14472.589, "restore_workers_time_ms": 0.021, "training_step_time_ms": 14472.532, "sample_time_ms": 1721.324, "learn_time_ms": 12730.603, "learn_throughput": 314.204, "synch_weights_time_ms": 16.208}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 1408000, "num_agent_steps_trained": 1408000}, "done": false, "training_iteration": 88, "trial_id": "e4caa_00000", "date": "2024-08-13_20-16-09", "timestamp": 1723594569, "time_this_iter_s": 14.813466787338257, "time_total_s": 1902.3069100379944, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29addc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1902.3069100379944, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 59.25714285714286, "ram_util_percent": 83.16190476190475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1246387171997596, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7152673963920544, "policy_loss": -0.005538856359839282, "vf_loss": 0.720324130994933, "vf_explained_var": 0.3886419622671036, "kl": 0.0064283441404734696, "entropy": 1.3767870026290732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6183752568941268, "cur_kl_coeff": 2.2204460492503132e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.41923445854237473, "policy_loss": -0.0038624304957766697, "vf_loss": 0.42309688885336516, "vf_explained_var": 0.11298407401357378, "kl": 0.0068577054721566475, "entropy": 0.05690879034834406, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 167265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 255.00000000000003, "episode_reward_mean": 361.19700000000006, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 72.5, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 44.0}, "policy_reward_mean": {"prey_policy": 173.55849999999998, "predator_policy": 7.04}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.3, 354.7, 380.0, 390.1, 370.0, 277.30000000000007, 374.0, 345.1, 391.9, 331.9, 296.3, 370.3, 255.00000000000003, 354.4, 360.5, 371.0, 289.0, 362.5, 400.0, 271.9, 388.4, 374.1, 388.4, 354.0, 380.0, 384.4, 339.0, 339.1, 300.1000000000001, 365.8, 266.3, 377.5, 387.4, 382.0, 377.0, 341.1, 316.5, 370.0, 371.6, 332.6, 398.2, 319.6, 363.2, 382.5, 391.9, 388.4, 341.79999999999995, 325.7, 368.2, 395.5, 385.2, 388.8, 396.0, 344.8, 348.0, 345.0, 376.0, 353.5, 335.6, 385.1, 354.7, 329.2, 382.0, 350.3, 354.7, 359.5, 395.5, 370.3, 381.7, 388.3, 366.29999999999995, 299.8, 364.9, 340.0, 375.0, 382.0, 392.8, 342.4000000000001, 352.3, 375.0, 375.5, 370.0, 389.2, 392.8, 400.0, 364.9, 387.2, 387.4, 359.0, 372.1, 353.0, 377.2, 373.1, 380.9, 363.4, 379.2, 345.0, 376.0, 377.7, 354.9], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [164.89999999999998, 196.4, 173.0, 166.7, 192.5, 186.5, 196.4, 193.7, 179.0, 176.0, 117.49999999999999, 153.79999999999998, 200.0, 161.0, 173.9, 171.2, 194.6, 197.3, 156.8, 160.1, 72.5, 135.8, 175.7, 194.60000000000002, 98.29999999999998, 142.7, 135.2, 198.2, 153.5, 194.0, 179.0, 188.0, 137.0, 109.0, 167.0, 183.5, 200.0, 200.0, 124.1, 75.80000000000001, 184.4, 200.0, 161.0, 190.1, 185.3, 199.1, 162.2, 177.8, 200.0, 170.0, 199.1, 179.3, 158.0, 161.0, 173.3, 153.8, 177.2, 77.89999999999998, 176.6, 189.2, 141.8, 78.5, 185.6, 191.9, 187.4, 200.0, 190.0, 188.0, 155.0, 200.0, 191.9, 102.2, 189.2, 110.3, 140.0, 191.0, 179.0, 185.6, 186.5, 103.1, 198.2, 200.0, 151.1, 126.5, 185.6, 158.6, 189.2, 191.3, 192.8, 199.1, 196.4, 188.0, 164.3, 165.5, 174.8, 128.9, 180.2, 182.0, 199.1, 196.4, 176.0, 198.2, 200.0, 186.8, 200.0, 194.0, 179.3, 150.5, 198.0, 131.0, 173.0, 153.0, 189.0, 186.0, 156.8, 184.7, 125.0, 185.6, 188.0, 193.1, 197.3, 124.4, 169.1, 136.1, 187.4, 194.59999999999997, 176.0, 155.3, 139.7, 200.0, 195.5, 149.0, 195.5, 200.0, 187.4, 182.9, 193.7, 182.0, 188.3, 200.0, 157.1, 189.2, 114.5, 155.3, 170.3, 194.6, 110.0, 200.0, 200.0, 164.0, 187.0, 195.0, 192.8, 200.0, 196.39999999999998, 119.0, 185.0, 149.3, 143.0, 200.0, 195.5, 170.0, 182.0, 182.0, 190.1, 199.1, 194.6, 198.2, 200.0, 200.0, 191.0, 173.9, 197.3, 188.9, 200.0, 187.4, 119.0, 194.0, 172.1, 200.0, 144.2, 192.8, 200.0, 159.2, 166.1, 194.0, 197.0, 182.9, 151.4, 200.0, 200.0, 168.2, 172.0, 146.0, 189.0, 181.0, 153.5, 198.2, 194.6, 146.3], "policy_predator_policy_reward": [9.0, 0.0, 12.0, 3.0, 1.0, 0.0, 0.0, 0.0, 10.0, 5.0, 6.0, 0.0, 3.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 44.0, 44.0, 0.0, 0.0, 0.0, 14.0, 10.0, 11.0, 3.0, 10.0, 4.0, 0.0, 0.0, 43.0, 11.0, 1.0, 0.0, 0.0, 33.0, 39.0, 0.0, 4.0, 13.0, 10.0, 4.0, 0.0, 12.0, 2.0, 10.0, 0.0, 6.0, 0.0, 12.0, 8.0, 6.0, 6.0, 12.0, 33.0, 0.0, 0.0, 12.0, 34.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 13.0, 9.0, 26.0, 21.0, 17.0, 0.0, 19.0, 20.0, 7.0, 0.0, 22.0, 21.0, 0.0, 0.0, 27.0, 15.0, 7.0, 12.0, 2.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 12.0, 15.0, 7.0, 6.0, 0.0, 0.0, 0.0, 6.0, 5.0, 2.0, 0.0, 2.0, 0.0, 0.0, 15.0, 18.0, 1.0, 9.0, 10.0, 1.0, 0.0, 12.0, 0.0, 0.0, 25.0, 0.0, 4.0, 22.0, 11.0, 3.0, 21.0, 0.0, 0.0, 19.0, 0.0, 9.0, 6.0, 1.0, 14.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 11.0, 9.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 18.0, 0.0, 16.0, 16.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 25.0, 21.0, 0.0, 0.0, 6.0, 10.0, 11.0, 7.0, 13.0, 0.0, 1.0, 0.0, 12.0, 0.0, 5.0, 6.0, 18.0, 9.0, 6.0, 0.0, 14.0, 12.0, 0.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5668355016035955, "mean_inference_ms": 4.695579122084203, "mean_action_processing_ms": 0.7322071490548367, "mean_env_wait_ms": 0.5450096338554197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059653520584106445, "StateBufferConnector_ms": 0.0051534175872802734, "ViewRequirementAgentConnector_ms": 0.1325591802597046}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 255.00000000000003, "episode_return_mean": 361.19700000000006, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.58872696162837, "num_env_steps_trained_throughput_per_sec": 283.58872696162837, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 1424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1424000, "timers": {"training_iteration_time_ms": 14481.906, "restore_workers_time_ms": 0.021, "training_step_time_ms": 14481.849, "sample_time_ms": 1724.772, "learn_time_ms": 12736.426, "learn_throughput": 314.06, "synch_weights_time_ms": 16.51}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 1424000, "num_agent_steps_trained": 1424000}, "done": false, "training_iteration": 89, "trial_id": "e4caa_00000", "date": "2024-08-13_20-16-23", "timestamp": 1723594583, "time_this_iter_s": 14.173746824264526, "time_total_s": 1916.480656862259, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2925b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1916.480656862259, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 55.370000000000005, "ram_util_percent": 83.155}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5783959234675402, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6511856813637587, "policy_loss": -0.005528152923755072, "vf_loss": 0.6562389183217886, "vf_explained_var": 0.37031731078864405, "kl": 0.006332222041270003, "entropy": 1.382170120622746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9683767122053911, "cur_kl_coeff": 2.2204460492503132e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5501779997317249, "policy_loss": -0.000765662104945886, "vf_loss": 0.5509436625632502, "vf_explained_var": 0.0530365456033636, "kl": 0.0006191917829753618, "entropy": 0.03101943460633121, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 169155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 266.3, "episode_reward_mean": 363.00700000000006, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 75.80000000000001, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 39.0}, "policy_reward_mean": {"prey_policy": 174.6135, "predator_policy": 6.89}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, 271.9, 388.4, 374.1, 388.4, 354.0, 380.0, 384.4, 339.0, 339.1, 300.1000000000001, 365.8, 266.3, 377.5, 387.4, 382.0, 377.0, 341.1, 316.5, 370.0, 371.6, 332.6, 398.2, 319.6, 363.2, 382.5, 391.9, 388.4, 341.79999999999995, 325.7, 368.2, 395.5, 385.2, 388.8, 396.0, 344.8, 348.0, 345.0, 376.0, 353.5, 335.6, 385.1, 354.7, 329.2, 382.0, 350.3, 354.7, 359.5, 395.5, 370.3, 381.7, 388.3, 366.29999999999995, 299.8, 364.9, 340.0, 375.0, 382.0, 392.8, 342.4000000000001, 352.3, 375.0, 375.5, 370.0, 389.2, 392.8, 400.0, 364.9, 387.2, 387.4, 359.0, 372.1, 353.0, 377.2, 373.1, 380.9, 363.4, 379.2, 345.0, 376.0, 377.7, 354.9, 321.2, 370.6, 379.0, 366.7, 320.50000000000006, 377.7, 360.4, 382.0, 363.6, 394.6, 386.6, 347.9, 292.79999999999984, 388.3, 368.0, 289.0, 371.0, 345.4], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 124.1, 75.80000000000001, 184.4, 200.0, 161.0, 190.1, 185.3, 199.1, 162.2, 177.8, 200.0, 170.0, 199.1, 179.3, 158.0, 161.0, 173.3, 153.8, 177.2, 77.89999999999998, 176.6, 189.2, 141.8, 78.5, 185.6, 191.9, 187.4, 200.0, 190.0, 188.0, 155.0, 200.0, 191.9, 102.2, 189.2, 110.3, 140.0, 191.0, 179.0, 185.6, 186.5, 103.1, 198.2, 200.0, 151.1, 126.5, 185.6, 158.6, 189.2, 191.3, 192.8, 199.1, 196.4, 188.0, 164.3, 165.5, 174.8, 128.9, 180.2, 182.0, 199.1, 196.4, 176.0, 198.2, 200.0, 186.8, 200.0, 194.0, 179.3, 150.5, 198.0, 131.0, 173.0, 153.0, 189.0, 186.0, 156.8, 184.7, 125.0, 185.6, 188.0, 193.1, 197.3, 124.4, 169.1, 136.1, 187.4, 194.59999999999997, 176.0, 155.3, 139.7, 200.0, 195.5, 149.0, 195.5, 200.0, 187.4, 182.9, 193.7, 182.0, 188.3, 200.0, 157.1, 189.2, 114.5, 155.3, 170.3, 194.6, 110.0, 200.0, 200.0, 164.0, 187.0, 195.0, 192.8, 200.0, 196.39999999999998, 119.0, 185.0, 149.3, 143.0, 200.0, 195.5, 170.0, 182.0, 182.0, 190.1, 199.1, 194.6, 198.2, 200.0, 200.0, 191.0, 173.9, 197.3, 188.9, 200.0, 187.4, 119.0, 194.0, 172.1, 200.0, 144.2, 192.8, 200.0, 159.2, 166.1, 194.0, 197.0, 182.9, 151.4, 200.0, 200.0, 168.2, 172.0, 146.0, 189.0, 181.0, 153.5, 198.2, 194.6, 146.3, 105.19999999999999, 188.0, 176.6, 182.0, 180.2, 192.8, 181.1, 185.6, 117.5, 188.0, 169.7, 200.0, 158.6, 192.8, 190.1, 191.9, 157.10000000000002, 195.5, 195.5, 199.1, 188.0, 194.6, 188.0, 146.9, 102.79999999999998, 176.0, 194.6, 193.7, 156.0, 192.0, 106.0, 133.0, 149.0, 200.0, 162.2, 156.2], "policy_predator_policy_reward": [0.0, 0.0, 33.0, 39.0, 0.0, 4.0, 13.0, 10.0, 4.0, 0.0, 12.0, 2.0, 10.0, 0.0, 6.0, 0.0, 12.0, 8.0, 6.0, 6.0, 12.0, 33.0, 0.0, 0.0, 12.0, 34.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 13.0, 9.0, 26.0, 21.0, 17.0, 0.0, 19.0, 20.0, 7.0, 0.0, 22.0, 21.0, 0.0, 0.0, 27.0, 15.0, 7.0, 12.0, 2.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 12.0, 15.0, 7.0, 6.0, 0.0, 0.0, 0.0, 6.0, 5.0, 2.0, 0.0, 2.0, 0.0, 0.0, 15.0, 18.0, 1.0, 9.0, 10.0, 1.0, 0.0, 12.0, 0.0, 0.0, 25.0, 0.0, 4.0, 22.0, 11.0, 3.0, 21.0, 0.0, 0.0, 19.0, 0.0, 9.0, 6.0, 1.0, 14.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 11.0, 9.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 18.0, 0.0, 16.0, 16.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 25.0, 21.0, 0.0, 0.0, 6.0, 10.0, 11.0, 7.0, 13.0, 0.0, 1.0, 0.0, 12.0, 0.0, 5.0, 6.0, 18.0, 9.0, 6.0, 0.0, 14.0, 12.0, 0.0, 14.0, 28.0, 0.0, 12.0, 0.0, 0.0, 6.0, 0.0, 0.0, 11.0, 4.0, 8.0, 0.0, 0.0, 9.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 4.0, 4.0, 9.0, 8.0, 6.0, 0.0, 0.0, 13.0, 7.0, 25.0, 25.0, 12.0, 10.0, 6.0, 21.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.55795894033833, "mean_inference_ms": 4.66783941383362, "mean_action_processing_ms": 0.7278398699367139, "mean_env_wait_ms": 0.5416560746637727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005856156349182129, "StateBufferConnector_ms": 0.005139470100402832, "ViewRequirementAgentConnector_ms": 0.13188695907592773}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 266.3, "episode_return_mean": 363.00700000000006, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.31891117895213, "num_env_steps_trained_throughput_per_sec": 294.31891117895213, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 14450.48, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14450.431, "sample_time_ms": 1710.805, "learn_time_ms": 12718.793, "learn_throughput": 314.495, "synch_weights_time_ms": 16.516}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 90, "trial_id": "e4caa_00000", "date": "2024-08-13_20-16-37", "timestamp": 1723594597, "time_this_iter_s": 13.640548944473267, "time_total_s": 1930.1212058067322, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2924160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1930.1212058067322, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 55.800000000000004, "ram_util_percent": 83.53684210526318}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7360624261003323, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7073566950682708, "policy_loss": -0.007900577901108635, "vf_loss": 0.7147372802098592, "vf_explained_var": 0.33190641122520287, "kl": 0.006933260244080334, "entropy": 1.366318232294113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4670534721521473, "cur_kl_coeff": 1.1102230246251566e-17, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.48892176759936823, "policy_loss": -0.002428452498599808, "vf_loss": 0.4913502204887293, "vf_explained_var": 0.10773045275577162, "kl": 0.0021410579691306334, "entropy": 0.039652445411713665, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 171045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 289.0, "episode_reward_mean": 366.0799999999999, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 101.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 39.0}, "policy_reward_mean": {"prey_policy": 176.975, "predator_policy": 6.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [319.6, 363.2, 382.5, 391.9, 388.4, 341.79999999999995, 325.7, 368.2, 395.5, 385.2, 388.8, 396.0, 344.8, 348.0, 345.0, 376.0, 353.5, 335.6, 385.1, 354.7, 329.2, 382.0, 350.3, 354.7, 359.5, 395.5, 370.3, 381.7, 388.3, 366.29999999999995, 299.8, 364.9, 340.0, 375.0, 382.0, 392.8, 342.4000000000001, 352.3, 375.0, 375.5, 370.0, 389.2, 392.8, 400.0, 364.9, 387.2, 387.4, 359.0, 372.1, 353.0, 377.2, 373.1, 380.9, 363.4, 379.2, 345.0, 376.0, 377.7, 354.9, 321.2, 370.6, 379.0, 366.7, 320.50000000000006, 377.7, 360.4, 382.0, 363.6, 394.6, 386.6, 347.9, 292.79999999999984, 388.3, 368.0, 289.0, 371.0, 345.4, 353.5, 351.8, 399.1, 355.9, 359.0, 354.0, 372.1, 384.0, 398.2, 380.5, 367.6, 395.5, 371.3, 370.2, 393.1, 393.7, 366.6, 388.0, 364.0, 318.0, 389.1, 298.3, 389.2], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [151.1, 126.5, 185.6, 158.6, 189.2, 191.3, 192.8, 199.1, 196.4, 188.0, 164.3, 165.5, 174.8, 128.9, 180.2, 182.0, 199.1, 196.4, 176.0, 198.2, 200.0, 186.8, 200.0, 194.0, 179.3, 150.5, 198.0, 131.0, 173.0, 153.0, 189.0, 186.0, 156.8, 184.7, 125.0, 185.6, 188.0, 193.1, 197.3, 124.4, 169.1, 136.1, 187.4, 194.59999999999997, 176.0, 155.3, 139.7, 200.0, 195.5, 149.0, 195.5, 200.0, 187.4, 182.9, 193.7, 182.0, 188.3, 200.0, 157.1, 189.2, 114.5, 155.3, 170.3, 194.6, 110.0, 200.0, 200.0, 164.0, 187.0, 195.0, 192.8, 200.0, 196.39999999999998, 119.0, 185.0, 149.3, 143.0, 200.0, 195.5, 170.0, 182.0, 182.0, 190.1, 199.1, 194.6, 198.2, 200.0, 200.0, 191.0, 173.9, 197.3, 188.9, 200.0, 187.4, 119.0, 194.0, 172.1, 200.0, 144.2, 192.8, 200.0, 159.2, 166.1, 194.0, 197.0, 182.9, 151.4, 200.0, 200.0, 168.2, 172.0, 146.0, 189.0, 181.0, 153.5, 198.2, 194.6, 146.3, 105.19999999999999, 188.0, 176.6, 182.0, 180.2, 192.8, 181.1, 185.6, 117.5, 188.0, 169.7, 200.0, 158.6, 192.8, 190.1, 191.9, 157.10000000000002, 195.5, 195.5, 199.1, 188.0, 194.6, 188.0, 146.9, 102.79999999999998, 176.0, 194.6, 193.7, 156.0, 192.0, 106.0, 133.0, 149.0, 200.0, 162.2, 156.2, 129.5, 170.0, 162.8, 167.0, 200.0, 199.1, 179.0, 161.9, 155.0, 188.0, 179.0, 161.0, 176.6, 186.5, 197.0, 179.0, 200.0, 198.2, 177.5, 200.0, 172.1, 195.5, 199.1, 196.4, 197.3, 161.0, 198.2, 158.0, 190.1, 200.0, 193.7, 200.0, 170.9, 190.7, 191.0, 194.0, 156.0, 194.0, 101.0, 184.0, 185.0, 199.1, 140.0, 119.3, 189.2, 200.0], "policy_predator_policy_reward": [27.0, 15.0, 7.0, 12.0, 2.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 12.0, 15.0, 7.0, 6.0, 0.0, 0.0, 0.0, 6.0, 5.0, 2.0, 0.0, 2.0, 0.0, 0.0, 15.0, 18.0, 1.0, 9.0, 10.0, 1.0, 0.0, 12.0, 0.0, 0.0, 25.0, 0.0, 4.0, 22.0, 11.0, 3.0, 21.0, 0.0, 0.0, 19.0, 0.0, 9.0, 6.0, 1.0, 14.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 11.0, 9.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 18.0, 0.0, 16.0, 16.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 25.0, 21.0, 0.0, 0.0, 6.0, 10.0, 11.0, 7.0, 13.0, 0.0, 1.0, 0.0, 12.0, 0.0, 5.0, 6.0, 18.0, 9.0, 6.0, 0.0, 14.0, 12.0, 0.0, 14.0, 28.0, 0.0, 12.0, 0.0, 0.0, 6.0, 0.0, 0.0, 11.0, 4.0, 8.0, 0.0, 0.0, 9.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 4.0, 4.0, 9.0, 8.0, 6.0, 0.0, 0.0, 13.0, 7.0, 25.0, 25.0, 12.0, 10.0, 6.0, 21.0, 28.0, 26.0, 8.0, 14.0, 0.0, 0.0, 0.0, 15.0, 1.0, 15.0, 14.0, 0.0, 9.0, 0.0, 7.0, 1.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 14.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 3.0, 0.0, 14.0, 32.0, 1.0, 0.0, 5.0, 0.0, 39.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5439556946159283, "mean_inference_ms": 4.628789348082048, "mean_action_processing_ms": 0.723438110666218, "mean_env_wait_ms": 0.5383834091991906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006335735321044922, "StateBufferConnector_ms": 0.003552675247192383, "ViewRequirementAgentConnector_ms": 0.1274862289428711}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 289.0, "episode_return_mean": 366.0799999999999, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.035786982951, "num_env_steps_trained_throughput_per_sec": 301.035786982951, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 1456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1456000, "timers": {"training_iteration_time_ms": 14325.494, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14325.445, "sample_time_ms": 1711.286, "learn_time_ms": 12593.513, "learn_throughput": 317.624, "synch_weights_time_ms": 16.493}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 1456000, "num_agent_steps_trained": 1456000}, "done": false, "training_iteration": 91, "trial_id": "e4caa_00000", "date": "2024-08-13_20-16-50", "timestamp": 1723594610, "time_this_iter_s": 13.331353902816772, "time_total_s": 1943.452559709549, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29addc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1943.452559709549, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 51.60526315789473, "ram_util_percent": 83.70526315789472}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.937519572336207, "cur_kl_coeff": 0.07499999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7119272962505757, "policy_loss": -0.005874364490487746, "vf_loss": 0.717459410358043, "vf_explained_var": 0.4124183751603283, "kl": 0.004563349708649896, "entropy": 1.3709878682459473, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8779688660193372, "cur_kl_coeff": 5.551115123125783e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4364255186663103, "policy_loss": -0.0029155057278417405, "vf_loss": 0.43934102448087836, "vf_explained_var": 0.13580577373504638, "kl": 0.0013689250482361096, "entropy": 0.05390111436702745, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 172935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 283.00000000000006, "episode_reward_mean": 366.18700000000007, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 101.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 39.0}, "policy_reward_mean": {"prey_policy": 177.0435, "predator_policy": 6.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [385.1, 354.7, 329.2, 382.0, 350.3, 354.7, 359.5, 395.5, 370.3, 381.7, 388.3, 366.29999999999995, 299.8, 364.9, 340.0, 375.0, 382.0, 392.8, 342.4000000000001, 352.3, 375.0, 375.5, 370.0, 389.2, 392.8, 400.0, 364.9, 387.2, 387.4, 359.0, 372.1, 353.0, 377.2, 373.1, 380.9, 363.4, 379.2, 345.0, 376.0, 377.7, 354.9, 321.2, 370.6, 379.0, 366.7, 320.50000000000006, 377.7, 360.4, 382.0, 363.6, 394.6, 386.6, 347.9, 292.79999999999984, 388.3, 368.0, 289.0, 371.0, 345.4, 353.5, 351.8, 399.1, 355.9, 359.0, 354.0, 372.1, 384.0, 398.2, 380.5, 367.6, 395.5, 371.3, 370.2, 393.1, 393.7, 366.6, 388.0, 364.0, 318.0, 389.1, 298.3, 389.2, 376.3, 384.70000000000005, 283.4, 350.5, 363.4, 392.8, 344.1, 400.0, 375.4, 371.0, 364.7, 366.2, 398.0, 283.00000000000006, 371.0, 374.0, 375.1, 386.8], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [188.0, 193.1, 197.3, 124.4, 169.1, 136.1, 187.4, 194.59999999999997, 176.0, 155.3, 139.7, 200.0, 195.5, 149.0, 195.5, 200.0, 187.4, 182.9, 193.7, 182.0, 188.3, 200.0, 157.1, 189.2, 114.5, 155.3, 170.3, 194.6, 110.0, 200.0, 200.0, 164.0, 187.0, 195.0, 192.8, 200.0, 196.39999999999998, 119.0, 185.0, 149.3, 143.0, 200.0, 195.5, 170.0, 182.0, 182.0, 190.1, 199.1, 194.6, 198.2, 200.0, 200.0, 191.0, 173.9, 197.3, 188.9, 200.0, 187.4, 119.0, 194.0, 172.1, 200.0, 144.2, 192.8, 200.0, 159.2, 166.1, 194.0, 197.0, 182.9, 151.4, 200.0, 200.0, 168.2, 172.0, 146.0, 189.0, 181.0, 153.5, 198.2, 194.6, 146.3, 105.19999999999999, 188.0, 176.6, 182.0, 180.2, 192.8, 181.1, 185.6, 117.5, 188.0, 169.7, 200.0, 158.6, 192.8, 190.1, 191.9, 157.10000000000002, 195.5, 195.5, 199.1, 188.0, 194.6, 188.0, 146.9, 102.79999999999998, 176.0, 194.6, 193.7, 156.0, 192.0, 106.0, 133.0, 149.0, 200.0, 162.2, 156.2, 129.5, 170.0, 162.8, 167.0, 200.0, 199.1, 179.0, 161.9, 155.0, 188.0, 179.0, 161.0, 176.6, 186.5, 197.0, 179.0, 200.0, 198.2, 177.5, 200.0, 172.1, 195.5, 199.1, 196.4, 197.3, 161.0, 198.2, 158.0, 190.1, 200.0, 193.7, 200.0, 170.9, 190.7, 191.0, 194.0, 156.0, 194.0, 101.0, 184.0, 185.0, 199.1, 140.0, 119.3, 189.2, 200.0, 185.3, 185.0, 186.5, 198.2, 117.2, 123.19999999999999, 138.8, 193.7, 200.0, 151.4, 192.8, 200.0, 124.40000000000003, 184.7, 200.0, 200.0, 180.2, 189.2, 191.0, 170.0, 188.3, 166.4, 179.0, 180.2, 200.0, 197.0, 157.7, 101.29999999999998, 185.0, 172.0, 173.0, 192.0, 197.0, 166.1, 193.7, 190.1], "policy_predator_policy_reward": [0.0, 4.0, 22.0, 11.0, 3.0, 21.0, 0.0, 0.0, 19.0, 0.0, 9.0, 6.0, 1.0, 14.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 11.0, 9.0, 0.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 27.0, 18.0, 0.0, 16.0, 16.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 25.0, 21.0, 0.0, 0.0, 6.0, 10.0, 11.0, 7.0, 13.0, 0.0, 1.0, 0.0, 12.0, 0.0, 5.0, 6.0, 18.0, 9.0, 6.0, 0.0, 14.0, 12.0, 0.0, 14.0, 28.0, 0.0, 12.0, 0.0, 0.0, 6.0, 0.0, 0.0, 11.0, 4.0, 8.0, 0.0, 0.0, 9.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 4.0, 4.0, 9.0, 8.0, 6.0, 0.0, 0.0, 13.0, 7.0, 25.0, 25.0, 12.0, 10.0, 6.0, 21.0, 28.0, 26.0, 8.0, 14.0, 0.0, 0.0, 0.0, 15.0, 1.0, 15.0, 14.0, 0.0, 9.0, 0.0, 7.0, 1.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 14.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 3.0, 0.0, 14.0, 32.0, 1.0, 0.0, 5.0, 0.0, 39.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 4.0, 39.0, 0.0, 18.0, 1.0, 11.0, 0.0, 0.0, 21.0, 14.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 10.0, 0.0, 0.0, 7.0, 0.0, 1.0, 12.0, 12.0, 5.0, 9.0, 9.0, 0.0, 0.0, 12.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5391482048782594, "mean_inference_ms": 4.61282916536541, "mean_action_processing_ms": 0.7179207182315511, "mean_env_wait_ms": 0.5350256699414689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006669878959655762, "StateBufferConnector_ms": 0.0034432411193847656, "ViewRequirementAgentConnector_ms": 0.1141047477722168}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 283.00000000000006, "episode_return_mean": 366.18700000000007, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.51200285343543, "num_env_steps_trained_throughput_per_sec": 283.51200285343543, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 1472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1472000, "timers": {"training_iteration_time_ms": 14266.794, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14266.743, "sample_time_ms": 1692.009, "learn_time_ms": 12554.095, "learn_throughput": 318.621, "synch_weights_time_ms": 16.721}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 1472000, "num_agent_steps_trained": 1472000}, "done": false, "training_iteration": 92, "trial_id": "e4caa_00000", "date": "2024-08-13_20-17-04", "timestamp": 1723594624, "time_this_iter_s": 14.177018880844116, "time_total_s": 1957.629578590393, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2925dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1957.629578590393, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 55.205000000000005, "ram_util_percent": 83.69000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.496093119326092, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.623283640686398, "policy_loss": -0.008226649964809733, "vf_loss": 0.6311105847989441, "vf_explained_var": 0.2874457110803594, "kl": 0.01065881014130917, "entropy": 1.3889040148447431, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3825007905878086, "cur_kl_coeff": 2.7755575615628915e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4836815879537315, "policy_loss": -0.0019539431279535016, "vf_loss": 0.48563552987096564, "vf_explained_var": 0.13635701533978578, "kl": 0.0022023801047684065, "entropy": 0.0569034922296408, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 174825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 283.00000000000006, "episode_reward_mean": 367.1890000000001, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 101.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 39.0}, "policy_reward_mean": {"prey_policy": 177.63449999999997, "predator_policy": 5.96}, "custom_metrics": {}, "hist_stats": {"episode_reward": [342.4000000000001, 352.3, 375.0, 375.5, 370.0, 389.2, 392.8, 400.0, 364.9, 387.2, 387.4, 359.0, 372.1, 353.0, 377.2, 373.1, 380.9, 363.4, 379.2, 345.0, 376.0, 377.7, 354.9, 321.2, 370.6, 379.0, 366.7, 320.50000000000006, 377.7, 360.4, 382.0, 363.6, 394.6, 386.6, 347.9, 292.79999999999984, 388.3, 368.0, 289.0, 371.0, 345.4, 353.5, 351.8, 399.1, 355.9, 359.0, 354.0, 372.1, 384.0, 398.2, 380.5, 367.6, 395.5, 371.3, 370.2, 393.1, 393.7, 366.6, 388.0, 364.0, 318.0, 389.1, 298.3, 389.2, 376.3, 384.70000000000005, 283.4, 350.5, 363.4, 392.8, 344.1, 400.0, 375.4, 371.0, 364.7, 366.2, 398.0, 283.00000000000006, 371.0, 374.0, 375.1, 386.8, 387.2, 356.7, 392.0, 368.0, 371.1, 388.6, 357.9, 347.7, 400.0, 394.0, 355.3, 386.2, 383.29999999999995, 376.6, 335.0, 372.0, 385.3, 315.4], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [196.39999999999998, 119.0, 185.0, 149.3, 143.0, 200.0, 195.5, 170.0, 182.0, 182.0, 190.1, 199.1, 194.6, 198.2, 200.0, 200.0, 191.0, 173.9, 197.3, 188.9, 200.0, 187.4, 119.0, 194.0, 172.1, 200.0, 144.2, 192.8, 200.0, 159.2, 166.1, 194.0, 197.0, 182.9, 151.4, 200.0, 200.0, 168.2, 172.0, 146.0, 189.0, 181.0, 153.5, 198.2, 194.6, 146.3, 105.19999999999999, 188.0, 176.6, 182.0, 180.2, 192.8, 181.1, 185.6, 117.5, 188.0, 169.7, 200.0, 158.6, 192.8, 190.1, 191.9, 157.10000000000002, 195.5, 195.5, 199.1, 188.0, 194.6, 188.0, 146.9, 102.79999999999998, 176.0, 194.6, 193.7, 156.0, 192.0, 106.0, 133.0, 149.0, 200.0, 162.2, 156.2, 129.5, 170.0, 162.8, 167.0, 200.0, 199.1, 179.0, 161.9, 155.0, 188.0, 179.0, 161.0, 176.6, 186.5, 197.0, 179.0, 200.0, 198.2, 177.5, 200.0, 172.1, 195.5, 199.1, 196.4, 197.3, 161.0, 198.2, 158.0, 190.1, 200.0, 193.7, 200.0, 170.9, 190.7, 191.0, 194.0, 156.0, 194.0, 101.0, 184.0, 185.0, 199.1, 140.0, 119.3, 189.2, 200.0, 185.3, 185.0, 186.5, 198.2, 117.2, 123.19999999999999, 138.8, 193.7, 200.0, 151.4, 192.8, 200.0, 124.40000000000003, 184.7, 200.0, 200.0, 180.2, 189.2, 191.0, 170.0, 188.3, 166.4, 179.0, 180.2, 200.0, 197.0, 157.7, 101.29999999999998, 185.0, 172.0, 173.0, 192.0, 197.0, 166.1, 193.7, 190.1, 188.9, 197.3, 178.7, 167.0, 200.0, 188.0, 188.0, 170.0, 176.9, 189.2, 200.0, 185.6, 190.1, 147.8, 161.6, 163.1, 200.0, 200.0, 200.0, 191.0, 137.0, 197.3, 198.2, 182.0, 176.3, 200.0, 181.1, 195.5, 194.0, 114.0, 191.0, 166.0, 197.3, 182.0, 146.0, 142.4], "policy_predator_policy_reward": [0.0, 27.0, 18.0, 0.0, 16.0, 16.0, 10.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 25.0, 21.0, 0.0, 0.0, 6.0, 10.0, 11.0, 7.0, 13.0, 0.0, 1.0, 0.0, 12.0, 0.0, 5.0, 6.0, 18.0, 9.0, 6.0, 0.0, 14.0, 12.0, 0.0, 14.0, 28.0, 0.0, 12.0, 0.0, 0.0, 6.0, 0.0, 0.0, 11.0, 4.0, 8.0, 0.0, 0.0, 9.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 4.0, 4.0, 9.0, 8.0, 6.0, 0.0, 0.0, 13.0, 7.0, 25.0, 25.0, 12.0, 10.0, 6.0, 21.0, 28.0, 26.0, 8.0, 14.0, 0.0, 0.0, 0.0, 15.0, 1.0, 15.0, 14.0, 0.0, 9.0, 0.0, 7.0, 1.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 14.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 3.0, 0.0, 14.0, 32.0, 1.0, 0.0, 5.0, 0.0, 39.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 4.0, 39.0, 0.0, 18.0, 1.0, 11.0, 0.0, 0.0, 21.0, 14.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 10.0, 0.0, 0.0, 7.0, 0.0, 1.0, 12.0, 12.0, 5.0, 9.0, 9.0, 0.0, 0.0, 12.0, 0.0, 3.0, 0.0, 1.0, 0.0, 11.0, 4.0, 0.0, 0.0, 10.0, 2.0, 3.0, 0.0, 3.0, 5.0, 15.0, 12.0, 11.0, 0.0, 0.0, 0.0, 3.0, 21.0, 0.0, 6.0, 0.0, 7.0, 0.0, 0.0, 0.0, 13.0, 14.0, 8.0, 7.0, 6.0, 0.0, 12.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.531463299594988, "mean_inference_ms": 4.5905225266814265, "mean_action_processing_ms": 0.7138393603915978, "mean_env_wait_ms": 0.5322760044623807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006523013114929199, "StateBufferConnector_ms": 0.003580808639526367, "ViewRequirementAgentConnector_ms": 0.11903095245361328}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 283.00000000000006, "episode_return_mean": 367.1890000000001, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.8821530364763, "num_env_steps_trained_throughput_per_sec": 264.8821530364763, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 1488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1488000, "timers": {"training_iteration_time_ms": 14389.163, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14389.092, "sample_time_ms": 1778.384, "learn_time_ms": 12589.214, "learn_throughput": 317.732, "synch_weights_time_ms": 16.632}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 1488000, "num_agent_steps_trained": 1488000}, "done": false, "training_iteration": 93, "trial_id": "e4caa_00000", "date": "2024-08-13_20-17-20", "timestamp": 1723594640, "time_this_iter_s": 15.16628623008728, "time_total_s": 1972.7958648204803, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2924af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1972.7958648204803, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 59.05454545454545, "ram_util_percent": 83.25454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7302898257182389, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6397401399085072, "policy_loss": -0.008539894684685995, "vf_loss": 0.6477352391435671, "vf_explained_var": 0.23850160159131206, "kl": 0.014527891829387074, "entropy": 1.35289599498113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.506953898458569, "cur_kl_coeff": 1.3877787807814458e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.43317941152071826, "policy_loss": -0.000996214332349756, "vf_loss": 0.43417562529070197, "vf_explained_var": 0.11687418282347381, "kl": 0.01851977610032969, "entropy": 0.12711769425009609, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 176715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 283.00000000000006, "episode_reward_mean": 362.435, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 94.7, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 39.0}, "policy_reward_mean": {"prey_policy": 174.7775, "predator_policy": 6.44}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.9, 321.2, 370.6, 379.0, 366.7, 320.50000000000006, 377.7, 360.4, 382.0, 363.6, 394.6, 386.6, 347.9, 292.79999999999984, 388.3, 368.0, 289.0, 371.0, 345.4, 353.5, 351.8, 399.1, 355.9, 359.0, 354.0, 372.1, 384.0, 398.2, 380.5, 367.6, 395.5, 371.3, 370.2, 393.1, 393.7, 366.6, 388.0, 364.0, 318.0, 389.1, 298.3, 389.2, 376.3, 384.70000000000005, 283.4, 350.5, 363.4, 392.8, 344.1, 400.0, 375.4, 371.0, 364.7, 366.2, 398.0, 283.00000000000006, 371.0, 374.0, 375.1, 386.8, 387.2, 356.7, 392.0, 368.0, 371.1, 388.6, 357.9, 347.7, 400.0, 394.0, 355.3, 386.2, 383.29999999999995, 376.6, 335.0, 372.0, 385.3, 315.4, 339.4, 375.7, 386.5, 299.90000000000003, 345.3, 337.6, 369.1, 359.8, 311.2, 316.6, 354.5, 374.2, 317.6, 377.5, 369.6, 365.9, 347.6, 363.9, 334.0, 324.0, 365.9, 382.1], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [194.6, 146.3, 105.19999999999999, 188.0, 176.6, 182.0, 180.2, 192.8, 181.1, 185.6, 117.5, 188.0, 169.7, 200.0, 158.6, 192.8, 190.1, 191.9, 157.10000000000002, 195.5, 195.5, 199.1, 188.0, 194.6, 188.0, 146.9, 102.79999999999998, 176.0, 194.6, 193.7, 156.0, 192.0, 106.0, 133.0, 149.0, 200.0, 162.2, 156.2, 129.5, 170.0, 162.8, 167.0, 200.0, 199.1, 179.0, 161.9, 155.0, 188.0, 179.0, 161.0, 176.6, 186.5, 197.0, 179.0, 200.0, 198.2, 177.5, 200.0, 172.1, 195.5, 199.1, 196.4, 197.3, 161.0, 198.2, 158.0, 190.1, 200.0, 193.7, 200.0, 170.9, 190.7, 191.0, 194.0, 156.0, 194.0, 101.0, 184.0, 185.0, 199.1, 140.0, 119.3, 189.2, 200.0, 185.3, 185.0, 186.5, 198.2, 117.2, 123.19999999999999, 138.8, 193.7, 200.0, 151.4, 192.8, 200.0, 124.40000000000003, 184.7, 200.0, 200.0, 180.2, 189.2, 191.0, 170.0, 188.3, 166.4, 179.0, 180.2, 200.0, 197.0, 157.7, 101.29999999999998, 185.0, 172.0, 173.0, 192.0, 197.0, 166.1, 193.7, 190.1, 188.9, 197.3, 178.7, 167.0, 200.0, 188.0, 188.0, 170.0, 176.9, 189.2, 200.0, 185.6, 190.1, 147.8, 161.6, 163.1, 200.0, 200.0, 200.0, 191.0, 137.0, 197.3, 198.2, 182.0, 176.3, 200.0, 181.1, 195.5, 194.0, 114.0, 191.0, 166.0, 197.3, 182.0, 146.0, 142.4, 164.3, 157.1, 182.9, 192.8, 186.5, 200.0, 94.7, 180.2, 192.8, 120.5, 185.6, 128.0, 181.1, 182.0, 159.8, 185.0, 117.2, 164.0, 100.1, 177.5, 168.5, 179.0, 198.2, 164.0, 171.2, 121.4, 174.5, 194.0, 176.0, 185.6, 149.9, 191.0, 197.3, 131.3, 185.6, 173.3, 187.0, 128.0, 123.0, 170.0, 161.0, 191.9, 188.0, 190.1], "policy_predator_policy_reward": [0.0, 14.0, 28.0, 0.0, 12.0, 0.0, 0.0, 6.0, 0.0, 0.0, 11.0, 4.0, 8.0, 0.0, 0.0, 9.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 4.0, 4.0, 9.0, 8.0, 6.0, 0.0, 0.0, 13.0, 7.0, 25.0, 25.0, 12.0, 10.0, 6.0, 21.0, 28.0, 26.0, 8.0, 14.0, 0.0, 0.0, 0.0, 15.0, 1.0, 15.0, 14.0, 0.0, 9.0, 0.0, 7.0, 1.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 14.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 3.0, 0.0, 14.0, 32.0, 1.0, 0.0, 5.0, 0.0, 39.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 4.0, 39.0, 0.0, 18.0, 1.0, 11.0, 0.0, 0.0, 21.0, 14.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 10.0, 0.0, 0.0, 7.0, 0.0, 1.0, 12.0, 12.0, 5.0, 9.0, 9.0, 0.0, 0.0, 12.0, 0.0, 3.0, 0.0, 1.0, 0.0, 11.0, 4.0, 0.0, 0.0, 10.0, 2.0, 3.0, 0.0, 3.0, 5.0, 15.0, 12.0, 11.0, 0.0, 0.0, 0.0, 3.0, 21.0, 0.0, 6.0, 0.0, 7.0, 0.0, 0.0, 0.0, 13.0, 14.0, 8.0, 7.0, 6.0, 0.0, 12.0, 15.0, 14.0, 4.0, 0.0, 0.0, 0.0, 0.0, 21.0, 4.0, 7.0, 25.0, 16.0, 8.0, 6.0, 0.0, 0.0, 15.0, 30.0, 0.0, 7.0, 32.0, 7.0, 0.0, 12.0, 0.0, 6.0, 19.0, 2.0, 7.0, 0.0, 8.0, 17.0, 8.0, 19.0, 0.0, 2.0, 3.0, 19.0, 0.0, 27.0, 4.0, 9.0, 4.0, 4.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5220299747579151, "mean_inference_ms": 4.563764189159687, "mean_action_processing_ms": 0.7089993867966505, "mean_env_wait_ms": 0.5289392737072025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007108449935913086, "StateBufferConnector_ms": 0.003543257713317871, "ViewRequirementAgentConnector_ms": 0.11027348041534424}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 283.00000000000006, "episode_return_mean": 362.435, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.6513220859742, "num_env_steps_trained_throughput_per_sec": 307.6513220859742, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 1504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1504000, "timers": {"training_iteration_time_ms": 14228.198, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14228.129, "sample_time_ms": 1740.829, "learn_time_ms": 12466.242, "learn_throughput": 320.867, "synch_weights_time_ms": 16.444}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 1504000, "num_agent_steps_trained": 1504000}, "done": false, "training_iteration": 94, "trial_id": "e4caa_00000", "date": "2024-08-13_20-17-33", "timestamp": 1723594653, "time_this_iter_s": 13.046357870101929, "time_total_s": 1985.8422226905823, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29e0b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1985.8422226905823, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 50.48333333333333, "ram_util_percent": 82.9111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.749347940449992, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6234645054235539, "policy_loss": -0.007492571154353086, "vf_loss": 0.6306209141457523, "vf_explained_var": 0.3904436794853715, "kl": 0.008964332739328501, "entropy": 1.3584430425886125, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4109416221657758, "cur_kl_coeff": 1.3877787807814458e-18, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.47981929196409445, "policy_loss": -0.002724733095487984, "vf_loss": 0.48254402567233357, "vf_explained_var": 0.10318590629668463, "kl": 0.0032939233555632505, "entropy": 0.13023987027308928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 178605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 283.00000000000006, "episode_reward_mean": 365.181, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 94.7, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 39.0}, "policy_reward_mean": {"prey_policy": 176.47050000000002, "predator_policy": 6.12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [345.4, 353.5, 351.8, 399.1, 355.9, 359.0, 354.0, 372.1, 384.0, 398.2, 380.5, 367.6, 395.5, 371.3, 370.2, 393.1, 393.7, 366.6, 388.0, 364.0, 318.0, 389.1, 298.3, 389.2, 376.3, 384.70000000000005, 283.4, 350.5, 363.4, 392.8, 344.1, 400.0, 375.4, 371.0, 364.7, 366.2, 398.0, 283.00000000000006, 371.0, 374.0, 375.1, 386.8, 387.2, 356.7, 392.0, 368.0, 371.1, 388.6, 357.9, 347.7, 400.0, 394.0, 355.3, 386.2, 383.29999999999995, 376.6, 335.0, 372.0, 385.3, 315.4, 339.4, 375.7, 386.5, 299.90000000000003, 345.3, 337.6, 369.1, 359.8, 311.2, 316.6, 354.5, 374.2, 317.6, 377.5, 369.6, 365.9, 347.6, 363.9, 334.0, 324.0, 365.9, 382.1, 369.5, 358.70000000000005, 390.1, 359.3, 392.4, 372.8, 330.1, 372.6, 382.0, 365.4, 398.1, 381.1, 388.3, 368.4, 395.0, 361.0, 393.7, 330.9], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [162.2, 156.2, 129.5, 170.0, 162.8, 167.0, 200.0, 199.1, 179.0, 161.9, 155.0, 188.0, 179.0, 161.0, 176.6, 186.5, 197.0, 179.0, 200.0, 198.2, 177.5, 200.0, 172.1, 195.5, 199.1, 196.4, 197.3, 161.0, 198.2, 158.0, 190.1, 200.0, 193.7, 200.0, 170.9, 190.7, 191.0, 194.0, 156.0, 194.0, 101.0, 184.0, 185.0, 199.1, 140.0, 119.3, 189.2, 200.0, 185.3, 185.0, 186.5, 198.2, 117.2, 123.19999999999999, 138.8, 193.7, 200.0, 151.4, 192.8, 200.0, 124.40000000000003, 184.7, 200.0, 200.0, 180.2, 189.2, 191.0, 170.0, 188.3, 166.4, 179.0, 180.2, 200.0, 197.0, 157.7, 101.29999999999998, 185.0, 172.0, 173.0, 192.0, 197.0, 166.1, 193.7, 190.1, 188.9, 197.3, 178.7, 167.0, 200.0, 188.0, 188.0, 170.0, 176.9, 189.2, 200.0, 185.6, 190.1, 147.8, 161.6, 163.1, 200.0, 200.0, 200.0, 191.0, 137.0, 197.3, 198.2, 182.0, 176.3, 200.0, 181.1, 195.5, 194.0, 114.0, 191.0, 166.0, 197.3, 182.0, 146.0, 142.4, 164.3, 157.1, 182.9, 192.8, 186.5, 200.0, 94.7, 180.2, 192.8, 120.5, 185.6, 128.0, 181.1, 182.0, 159.8, 185.0, 117.2, 164.0, 100.1, 177.5, 168.5, 179.0, 198.2, 164.0, 171.2, 121.4, 174.5, 194.0, 176.0, 185.6, 149.9, 191.0, 197.3, 131.3, 185.6, 173.3, 187.0, 128.0, 123.0, 170.0, 161.0, 191.9, 188.0, 190.1, 181.1, 175.4, 140.60000000000002, 199.1, 190.1, 200.0, 186.5, 156.8, 196.4, 194.0, 170.0, 192.8, 159.2, 140.9, 167.0, 194.6, 192.8, 189.2, 157.4, 197.0, 196.1, 200.0, 192.8, 188.3, 191.9, 196.4, 155.3, 199.1, 200.0, 195.0, 150.0, 197.0, 198.2, 195.5, 146.0, 164.9], "policy_predator_policy_reward": [6.0, 21.0, 28.0, 26.0, 8.0, 14.0, 0.0, 0.0, 0.0, 15.0, 1.0, 15.0, 14.0, 0.0, 9.0, 0.0, 7.0, 1.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 14.0, 0.0, 0.0, 3.0, 0.0, 0.0, 4.0, 1.0, 0.0, 3.0, 0.0, 14.0, 32.0, 1.0, 0.0, 5.0, 0.0, 39.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 4.0, 39.0, 0.0, 18.0, 1.0, 11.0, 0.0, 0.0, 21.0, 14.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 10.0, 0.0, 0.0, 7.0, 0.0, 1.0, 12.0, 12.0, 5.0, 9.0, 9.0, 0.0, 0.0, 12.0, 0.0, 3.0, 0.0, 1.0, 0.0, 11.0, 4.0, 0.0, 0.0, 10.0, 2.0, 3.0, 0.0, 3.0, 5.0, 15.0, 12.0, 11.0, 0.0, 0.0, 0.0, 3.0, 21.0, 0.0, 6.0, 0.0, 7.0, 0.0, 0.0, 0.0, 13.0, 14.0, 8.0, 7.0, 6.0, 0.0, 12.0, 15.0, 14.0, 4.0, 0.0, 0.0, 0.0, 0.0, 21.0, 4.0, 7.0, 25.0, 16.0, 8.0, 6.0, 0.0, 0.0, 15.0, 30.0, 0.0, 7.0, 32.0, 7.0, 0.0, 12.0, 0.0, 6.0, 19.0, 2.0, 7.0, 0.0, 8.0, 17.0, 8.0, 19.0, 0.0, 2.0, 3.0, 19.0, 0.0, 27.0, 4.0, 9.0, 4.0, 4.0, 0.0, 6.0, 7.0, 7.0, 12.0, 0.0, 0.0, 7.0, 9.0, 2.0, 0.0, 6.0, 4.0, 21.0, 9.0, 0.0, 11.0, 0.0, 0.0, 11.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 5.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5148020671979188, "mean_inference_ms": 4.542803185471699, "mean_action_processing_ms": 0.7051113921402447, "mean_env_wait_ms": 0.5263143256664247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007571697235107422, "StateBufferConnector_ms": 0.003839254379272461, "ViewRequirementAgentConnector_ms": 0.11486923694610596}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 283.00000000000006, "episode_return_mean": 365.181, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.53568770318475, "num_env_steps_trained_throughput_per_sec": 266.53568770318475, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 14320.849, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14320.779, "sample_time_ms": 1753.071, "learn_time_ms": 12546.325, "learn_throughput": 318.818, "synch_weights_time_ms": 16.663}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 95, "trial_id": "e4caa_00000", "date": "2024-08-13_20-17-48", "timestamp": 1723594668, "time_this_iter_s": 15.05286717414856, "time_total_s": 2000.8950898647308, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2925dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2000.8950898647308, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 61.318181818181806, "ram_util_percent": 83.07727272727271}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7846292289791914, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6204481671855011, "policy_loss": -0.006024599653328695, "vf_loss": 0.6261935580029059, "vf_explained_var": 0.38660934605295694, "kl": 0.0074455789449443125, "entropy": 1.356080580451501, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4156103976662198, "cur_kl_coeff": 6.938893903907229e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4077762650513144, "policy_loss": -0.0034068457222982216, "vf_loss": 0.41118311063933466, "vf_explained_var": 0.12623004692572135, "kl": 0.0028030820541843256, "entropy": 0.08992654930149752, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 180495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 283.00000000000006, "episode_reward_mean": 364.4000000000001, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 94.7, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 39.0}, "policy_reward_mean": {"prey_policy": 176.205, "predator_policy": 5.995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [389.2, 376.3, 384.70000000000005, 283.4, 350.5, 363.4, 392.8, 344.1, 400.0, 375.4, 371.0, 364.7, 366.2, 398.0, 283.00000000000006, 371.0, 374.0, 375.1, 386.8, 387.2, 356.7, 392.0, 368.0, 371.1, 388.6, 357.9, 347.7, 400.0, 394.0, 355.3, 386.2, 383.29999999999995, 376.6, 335.0, 372.0, 385.3, 315.4, 339.4, 375.7, 386.5, 299.90000000000003, 345.3, 337.6, 369.1, 359.8, 311.2, 316.6, 354.5, 374.2, 317.6, 377.5, 369.6, 365.9, 347.6, 363.9, 334.0, 324.0, 365.9, 382.1, 369.5, 358.70000000000005, 390.1, 359.3, 392.4, 372.8, 330.1, 372.6, 382.0, 365.4, 398.1, 381.1, 388.3, 368.4, 395.0, 361.0, 393.7, 330.9, 386.5, 393.1, 330.8, 389.7, 365.8, 338.4, 331.2, 370.0, 385.6, 337.6, 353.6, 370.9, 393.5, 359.1, 364.2, 384.7, 335.4, 361.0, 385.0, 380.0, 362.8, 368.1, 343.8], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [189.2, 200.0, 185.3, 185.0, 186.5, 198.2, 117.2, 123.19999999999999, 138.8, 193.7, 200.0, 151.4, 192.8, 200.0, 124.40000000000003, 184.7, 200.0, 200.0, 180.2, 189.2, 191.0, 170.0, 188.3, 166.4, 179.0, 180.2, 200.0, 197.0, 157.7, 101.29999999999998, 185.0, 172.0, 173.0, 192.0, 197.0, 166.1, 193.7, 190.1, 188.9, 197.3, 178.7, 167.0, 200.0, 188.0, 188.0, 170.0, 176.9, 189.2, 200.0, 185.6, 190.1, 147.8, 161.6, 163.1, 200.0, 200.0, 200.0, 191.0, 137.0, 197.3, 198.2, 182.0, 176.3, 200.0, 181.1, 195.5, 194.0, 114.0, 191.0, 166.0, 197.3, 182.0, 146.0, 142.4, 164.3, 157.1, 182.9, 192.8, 186.5, 200.0, 94.7, 180.2, 192.8, 120.5, 185.6, 128.0, 181.1, 182.0, 159.8, 185.0, 117.2, 164.0, 100.1, 177.5, 168.5, 179.0, 198.2, 164.0, 171.2, 121.4, 174.5, 194.0, 176.0, 185.6, 149.9, 191.0, 197.3, 131.3, 185.6, 173.3, 187.0, 128.0, 123.0, 170.0, 161.0, 191.9, 188.0, 190.1, 181.1, 175.4, 140.60000000000002, 199.1, 190.1, 200.0, 186.5, 156.8, 196.4, 194.0, 170.0, 192.8, 159.2, 140.9, 167.0, 194.6, 192.8, 189.2, 157.4, 197.0, 196.1, 200.0, 192.8, 188.3, 191.9, 196.4, 155.3, 199.1, 200.0, 195.0, 150.0, 197.0, 198.2, 195.5, 146.0, 164.9, 192.8, 193.7, 196.1, 194.0, 160.1, 142.7, 200.0, 187.7, 164.60000000000002, 189.2, 178.1, 128.3, 126.2, 176.0, 188.0, 173.0, 198.2, 187.4, 131.6, 182.0, 170.3, 176.3, 160.1, 192.8, 200.0, 192.5, 191.9, 156.20000000000002, 191.0, 165.2, 186.5, 198.2, 144.2, 174.2, 194.0, 152.0, 186.0, 199.0, 200.0, 167.0, 173.0, 174.8, 185.0, 181.1, 128.6, 189.2], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 4.0, 39.0, 0.0, 18.0, 1.0, 11.0, 0.0, 0.0, 21.0, 14.0, 0.0, 0.0, 0.0, 6.0, 0.0, 10.0, 10.0, 0.0, 0.0, 7.0, 0.0, 1.0, 12.0, 12.0, 5.0, 9.0, 9.0, 0.0, 0.0, 12.0, 0.0, 3.0, 0.0, 1.0, 0.0, 11.0, 4.0, 0.0, 0.0, 10.0, 2.0, 3.0, 0.0, 3.0, 5.0, 15.0, 12.0, 11.0, 0.0, 0.0, 0.0, 3.0, 21.0, 0.0, 6.0, 0.0, 7.0, 0.0, 0.0, 0.0, 13.0, 14.0, 8.0, 7.0, 6.0, 0.0, 12.0, 15.0, 14.0, 4.0, 0.0, 0.0, 0.0, 0.0, 21.0, 4.0, 7.0, 25.0, 16.0, 8.0, 6.0, 0.0, 0.0, 15.0, 30.0, 0.0, 7.0, 32.0, 7.0, 0.0, 12.0, 0.0, 6.0, 19.0, 2.0, 7.0, 0.0, 8.0, 17.0, 8.0, 19.0, 0.0, 2.0, 3.0, 19.0, 0.0, 27.0, 4.0, 9.0, 4.0, 4.0, 0.0, 6.0, 7.0, 7.0, 12.0, 0.0, 0.0, 7.0, 9.0, 2.0, 0.0, 6.0, 4.0, 21.0, 9.0, 0.0, 11.0, 0.0, 0.0, 11.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 5.0, 15.0, 0.0, 0.0, 3.0, 0.0, 17.0, 11.0, 2.0, 0.0, 2.0, 10.0, 6.0, 26.0, 13.0, 16.0, 0.0, 9.0, 0.0, 0.0, 24.0, 0.0, 7.0, 0.0, 13.0, 5.0, 1.0, 0.0, 11.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 15.0, 0.0, 0.0, 2.0, 11.0, 5.0, 10.0, 2.0, 0.0, 22.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.506357007438953, "mean_inference_ms": 4.518168559843448, "mean_action_processing_ms": 0.7005626404759094, "mean_env_wait_ms": 0.5232370739520524, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073053836822509766, "StateBufferConnector_ms": 0.003944039344787598, "ViewRequirementAgentConnector_ms": 0.12794959545135498}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 283.00000000000006, "episode_return_mean": 364.4000000000001, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 254.57814053039246, "num_env_steps_trained_throughput_per_sec": 254.57814053039246, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 1536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1536000, "timers": {"training_iteration_time_ms": 14397.339, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14397.267, "sample_time_ms": 1806.445, "learn_time_ms": 12570.757, "learn_throughput": 318.199, "synch_weights_time_ms": 16.223}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 1536000, "num_agent_steps_trained": 1536000}, "done": false, "training_iteration": 96, "trial_id": "e4caa_00000", "date": "2024-08-13_20-18-03", "timestamp": 1723594683, "time_this_iter_s": 15.762811183929443, "time_total_s": 2016.6579010486603, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b293a280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2016.6579010486603, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 61.82727272727272, "ram_util_percent": 82.02727272727272}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7406748755741372, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5360919711061768, "policy_loss": -0.004027212932508774, "vf_loss": 0.5397949350810556, "vf_explained_var": 0.23891029269606978, "kl": 0.008646605056802691, "entropy": 1.377065962647635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4307369108237917, "cur_kl_coeff": 3.4694469519536144e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3160990740492861, "policy_loss": -0.0015642113203833265, "vf_loss": 0.31766328439929536, "vf_explained_var": 0.04430222028777713, "kl": 0.0020183626265221923, "entropy": 0.09595661037773998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 182385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 299.90000000000003, "episode_reward_mean": 365.975, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 94.7, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 32.0}, "policy_reward_mean": {"prey_policy": 177.2875, "predator_policy": 5.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [386.8, 387.2, 356.7, 392.0, 368.0, 371.1, 388.6, 357.9, 347.7, 400.0, 394.0, 355.3, 386.2, 383.29999999999995, 376.6, 335.0, 372.0, 385.3, 315.4, 339.4, 375.7, 386.5, 299.90000000000003, 345.3, 337.6, 369.1, 359.8, 311.2, 316.6, 354.5, 374.2, 317.6, 377.5, 369.6, 365.9, 347.6, 363.9, 334.0, 324.0, 365.9, 382.1, 369.5, 358.70000000000005, 390.1, 359.3, 392.4, 372.8, 330.1, 372.6, 382.0, 365.4, 398.1, 381.1, 388.3, 368.4, 395.0, 361.0, 393.7, 330.9, 386.5, 393.1, 330.8, 389.7, 365.8, 338.4, 331.2, 370.0, 385.6, 337.6, 353.6, 370.9, 393.5, 359.1, 364.2, 384.7, 335.4, 361.0, 385.0, 380.0, 362.8, 368.1, 343.8, 380.2, 376.0, 357.70000000000005, 398.2, 361.5, 391.9, 373.00000000000006, 355.9, 391.5, 384.6, 372.4, 383.8, 389.2, 351.1, 354.0, 364.0, 364.0, 371.3], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [193.7, 190.1, 188.9, 197.3, 178.7, 167.0, 200.0, 188.0, 188.0, 170.0, 176.9, 189.2, 200.0, 185.6, 190.1, 147.8, 161.6, 163.1, 200.0, 200.0, 200.0, 191.0, 137.0, 197.3, 198.2, 182.0, 176.3, 200.0, 181.1, 195.5, 194.0, 114.0, 191.0, 166.0, 197.3, 182.0, 146.0, 142.4, 164.3, 157.1, 182.9, 192.8, 186.5, 200.0, 94.7, 180.2, 192.8, 120.5, 185.6, 128.0, 181.1, 182.0, 159.8, 185.0, 117.2, 164.0, 100.1, 177.5, 168.5, 179.0, 198.2, 164.0, 171.2, 121.4, 174.5, 194.0, 176.0, 185.6, 149.9, 191.0, 197.3, 131.3, 185.6, 173.3, 187.0, 128.0, 123.0, 170.0, 161.0, 191.9, 188.0, 190.1, 181.1, 175.4, 140.60000000000002, 199.1, 190.1, 200.0, 186.5, 156.8, 196.4, 194.0, 170.0, 192.8, 159.2, 140.9, 167.0, 194.6, 192.8, 189.2, 157.4, 197.0, 196.1, 200.0, 192.8, 188.3, 191.9, 196.4, 155.3, 199.1, 200.0, 195.0, 150.0, 197.0, 198.2, 195.5, 146.0, 164.9, 192.8, 193.7, 196.1, 194.0, 160.1, 142.7, 200.0, 187.7, 164.60000000000002, 189.2, 178.1, 128.3, 126.2, 176.0, 188.0, 173.0, 198.2, 187.4, 131.6, 182.0, 170.3, 176.3, 160.1, 192.8, 200.0, 192.5, 191.9, 156.20000000000002, 191.0, 165.2, 186.5, 198.2, 144.2, 174.2, 194.0, 152.0, 186.0, 199.0, 200.0, 167.0, 173.0, 174.8, 185.0, 181.1, 128.6, 189.2, 171.2, 200.0, 173.0, 194.0, 193.7, 164.0, 198.2, 200.0, 153.8, 193.7, 191.9, 200.0, 177.49999999999997, 195.5, 198.2, 139.7, 189.5, 200.0, 200.0, 179.6, 134.0, 196.4, 187.4, 196.4, 200.0, 189.2, 127.1, 200.0, 173.0, 172.0, 183.0, 178.0, 171.2, 192.8, 200.0, 158.3], "policy_predator_policy_reward": [0.0, 3.0, 0.0, 1.0, 0.0, 11.0, 4.0, 0.0, 0.0, 10.0, 2.0, 3.0, 0.0, 3.0, 5.0, 15.0, 12.0, 11.0, 0.0, 0.0, 0.0, 3.0, 21.0, 0.0, 6.0, 0.0, 7.0, 0.0, 0.0, 0.0, 13.0, 14.0, 8.0, 7.0, 6.0, 0.0, 12.0, 15.0, 14.0, 4.0, 0.0, 0.0, 0.0, 0.0, 21.0, 4.0, 7.0, 25.0, 16.0, 8.0, 6.0, 0.0, 0.0, 15.0, 30.0, 0.0, 7.0, 32.0, 7.0, 0.0, 12.0, 0.0, 6.0, 19.0, 2.0, 7.0, 0.0, 8.0, 17.0, 8.0, 19.0, 0.0, 2.0, 3.0, 19.0, 0.0, 27.0, 4.0, 9.0, 4.0, 4.0, 0.0, 6.0, 7.0, 7.0, 12.0, 0.0, 0.0, 7.0, 9.0, 2.0, 0.0, 6.0, 4.0, 21.0, 9.0, 0.0, 11.0, 0.0, 0.0, 11.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 5.0, 15.0, 0.0, 0.0, 3.0, 0.0, 17.0, 11.0, 2.0, 0.0, 2.0, 10.0, 6.0, 26.0, 13.0, 16.0, 0.0, 9.0, 0.0, 0.0, 24.0, 0.0, 7.0, 0.0, 13.0, 5.0, 1.0, 0.0, 11.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 15.0, 0.0, 0.0, 2.0, 11.0, 5.0, 10.0, 2.0, 0.0, 22.0, 4.0, 9.0, 0.0, 3.0, 6.0, 0.0, 0.0, 0.0, 0.0, 10.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 2.0, 0.0, 5.0, 20.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 9.0, 0.0, 3.0, 0.0, 0.0, 0.0, 13.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.49978940241597, "mean_inference_ms": 4.499462929436691, "mean_action_processing_ms": 0.6970964097785454, "mean_env_wait_ms": 0.5208611932065383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006678104400634766, "StateBufferConnector_ms": 0.0038799047470092773, "ViewRequirementAgentConnector_ms": 0.12550616264343262}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 299.90000000000003, "episode_return_mean": 365.975, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.5831941653572, "num_env_steps_trained_throughput_per_sec": 296.5831941653572, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 1552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1552000, "timers": {"training_iteration_time_ms": 14216.08, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14216.009, "sample_time_ms": 1744.772, "learn_time_ms": 12450.882, "learn_throughput": 321.262, "synch_weights_time_ms": 16.188}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 1552000, "num_agent_steps_trained": 1552000}, "done": false, "training_iteration": 97, "trial_id": "e4caa_00000", "date": "2024-08-13_20-18-17", "timestamp": 1723594697, "time_this_iter_s": 13.536862850189209, "time_total_s": 2030.1947638988495, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b19d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2030.1947638988495, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 52.242105263157896, "ram_util_percent": 81.98947368421054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6705773216391366, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5485851850867254, "policy_loss": -0.005029557929152534, "vf_loss": 0.5532917475042046, "vf_explained_var": 0.48204959776035694, "kl": 0.00861320331606063, "entropy": 1.3206186387274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.533069985206165, "cur_kl_coeff": 1.7347234759768072e-19, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4555708161895237, "policy_loss": -0.0033369317815870676, "vf_loss": 0.45890774697646813, "vf_explained_var": 0.09408684899567296, "kl": 0.00292755892965631, "entropy": 0.1106056267149234, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 184275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 299.90000000000003, "episode_reward_mean": 365.90600000000006, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 94.7, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 32.0}, "policy_reward_mean": {"prey_policy": 177.123, "predator_policy": 5.83}, "custom_metrics": {}, "hist_stats": {"episode_reward": [299.90000000000003, 345.3, 337.6, 369.1, 359.8, 311.2, 316.6, 354.5, 374.2, 317.6, 377.5, 369.6, 365.9, 347.6, 363.9, 334.0, 324.0, 365.9, 382.1, 369.5, 358.70000000000005, 390.1, 359.3, 392.4, 372.8, 330.1, 372.6, 382.0, 365.4, 398.1, 381.1, 388.3, 368.4, 395.0, 361.0, 393.7, 330.9, 386.5, 393.1, 330.8, 389.7, 365.8, 338.4, 331.2, 370.0, 385.6, 337.6, 353.6, 370.9, 393.5, 359.1, 364.2, 384.7, 335.4, 361.0, 385.0, 380.0, 362.8, 368.1, 343.8, 380.2, 376.0, 357.70000000000005, 398.2, 361.5, 391.9, 373.00000000000006, 355.9, 391.5, 384.6, 372.4, 383.8, 389.2, 351.1, 354.0, 364.0, 364.0, 371.3, 354.4, 379.2, 360.4, 373.3, 351.3, 396.4, 378.4, 379.9, 374.3, 390.1, 349.0, 379.70000000000005, 338.4, 382.9, 392.8, 392.2, 375.1, 384.2, 357.0, 328.0, 391.9, 344.9], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [94.7, 180.2, 192.8, 120.5, 185.6, 128.0, 181.1, 182.0, 159.8, 185.0, 117.2, 164.0, 100.1, 177.5, 168.5, 179.0, 198.2, 164.0, 171.2, 121.4, 174.5, 194.0, 176.0, 185.6, 149.9, 191.0, 197.3, 131.3, 185.6, 173.3, 187.0, 128.0, 123.0, 170.0, 161.0, 191.9, 188.0, 190.1, 181.1, 175.4, 140.60000000000002, 199.1, 190.1, 200.0, 186.5, 156.8, 196.4, 194.0, 170.0, 192.8, 159.2, 140.9, 167.0, 194.6, 192.8, 189.2, 157.4, 197.0, 196.1, 200.0, 192.8, 188.3, 191.9, 196.4, 155.3, 199.1, 200.0, 195.0, 150.0, 197.0, 198.2, 195.5, 146.0, 164.9, 192.8, 193.7, 196.1, 194.0, 160.1, 142.7, 200.0, 187.7, 164.60000000000002, 189.2, 178.1, 128.3, 126.2, 176.0, 188.0, 173.0, 198.2, 187.4, 131.6, 182.0, 170.3, 176.3, 160.1, 192.8, 200.0, 192.5, 191.9, 156.20000000000002, 191.0, 165.2, 186.5, 198.2, 144.2, 174.2, 194.0, 152.0, 186.0, 199.0, 200.0, 167.0, 173.0, 174.8, 185.0, 181.1, 128.6, 189.2, 171.2, 200.0, 173.0, 194.0, 193.7, 164.0, 198.2, 200.0, 153.8, 193.7, 191.9, 200.0, 177.49999999999997, 195.5, 198.2, 139.7, 189.5, 200.0, 200.0, 179.6, 134.0, 196.4, 187.4, 196.4, 200.0, 189.2, 127.1, 200.0, 173.0, 172.0, 183.0, 178.0, 171.2, 192.8, 200.0, 158.3, 169.4, 164.0, 192.2, 179.0, 171.2, 189.2, 199.1, 150.2, 182.0, 140.3, 200.0, 196.4, 200.0, 178.4, 173.9, 200.0, 161.3, 200.0, 191.0, 199.1, 181.1, 155.9, 194.6, 178.1, 191.3, 118.1, 199.1, 183.8, 200.0, 192.8, 191.0, 198.2, 184.7, 187.4, 189.2, 185.0, 197.0, 139.0, 163.0, 149.0, 196.4, 195.5, 122.6, 188.3], "policy_predator_policy_reward": [21.0, 4.0, 7.0, 25.0, 16.0, 8.0, 6.0, 0.0, 0.0, 15.0, 30.0, 0.0, 7.0, 32.0, 7.0, 0.0, 12.0, 0.0, 6.0, 19.0, 2.0, 7.0, 0.0, 8.0, 17.0, 8.0, 19.0, 0.0, 2.0, 3.0, 19.0, 0.0, 27.0, 4.0, 9.0, 4.0, 4.0, 0.0, 6.0, 7.0, 7.0, 12.0, 0.0, 0.0, 7.0, 9.0, 2.0, 0.0, 6.0, 4.0, 21.0, 9.0, 0.0, 11.0, 0.0, 0.0, 11.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 5.0, 15.0, 0.0, 0.0, 3.0, 0.0, 17.0, 11.0, 2.0, 0.0, 2.0, 10.0, 6.0, 26.0, 13.0, 16.0, 0.0, 9.0, 0.0, 0.0, 24.0, 0.0, 7.0, 0.0, 13.0, 5.0, 1.0, 0.0, 11.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 15.0, 0.0, 0.0, 2.0, 11.0, 5.0, 10.0, 2.0, 0.0, 22.0, 4.0, 9.0, 0.0, 3.0, 6.0, 0.0, 0.0, 0.0, 0.0, 10.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 2.0, 0.0, 5.0, 20.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 9.0, 0.0, 3.0, 0.0, 0.0, 0.0, 13.0, 0.0, 21.0, 0.0, 8.0, 0.0, 0.0, 0.0, 13.0, 11.0, 11.0, 18.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 5.0, 0.0, 0.0, 12.0, 0.0, 7.0, 0.0, 11.0, 18.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 3.0, 0.0, 4.0, 6.0, 20.0, 1.0, 16.0, 0.0, 0.0, 0.0, 21.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4933225706553532, "mean_inference_ms": 4.484673394385502, "mean_action_processing_ms": 0.6936323418631224, "mean_env_wait_ms": 0.5188036104840812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0073364973068237305, "StateBufferConnector_ms": 0.0049974918365478516, "ViewRequirementAgentConnector_ms": 0.1584327220916748}, "num_episodes": 22, "episode_return_max": 398.2, "episode_return_min": 299.90000000000003, "episode_return_mean": 365.90600000000006, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 214.02329906449026, "num_env_steps_trained_throughput_per_sec": 214.02329906449026, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 1568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1568000, "timers": {"training_iteration_time_ms": 14609.085, "restore_workers_time_ms": 0.015, "training_step_time_ms": 14609.011, "sample_time_ms": 1959.108, "learn_time_ms": 12627.815, "learn_throughput": 316.761, "synch_weights_time_ms": 17.521}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 1568000, "num_agent_steps_trained": 1568000}, "done": false, "training_iteration": 98, "trial_id": "e4caa_00000", "date": "2024-08-13_20-18-36", "timestamp": 1723594716, "time_this_iter_s": 18.763570308685303, "time_total_s": 2048.958334207535, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2863670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2048.958334207535, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 80.64074074074075, "ram_util_percent": 83.64444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7625047587213063, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.555449455278487, "policy_loss": -0.005510302532646588, "vf_loss": 0.560681271905858, "vf_explained_var": 0.32967058637785535, "kl": 0.007426283312268166, "entropy": 1.312030134188435, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1770204165704037, "cur_kl_coeff": 8.673617379884036e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.34237672668443153, "policy_loss": -0.0021397782797634443, "vf_loss": 0.3445165049117157, "vf_explained_var": 0.0597271807294674, "kl": 0.008037687737120732, "entropy": 0.15729078249168144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 186165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 306.0, "episode_reward_mean": 368.7750000000001, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 118.1, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 26.0}, "policy_reward_mean": {"prey_policy": 179.1475, "predator_policy": 5.24}, "custom_metrics": {}, "hist_stats": {"episode_reward": [382.1, 369.5, 358.70000000000005, 390.1, 359.3, 392.4, 372.8, 330.1, 372.6, 382.0, 365.4, 398.1, 381.1, 388.3, 368.4, 395.0, 361.0, 393.7, 330.9, 386.5, 393.1, 330.8, 389.7, 365.8, 338.4, 331.2, 370.0, 385.6, 337.6, 353.6, 370.9, 393.5, 359.1, 364.2, 384.7, 335.4, 361.0, 385.0, 380.0, 362.8, 368.1, 343.8, 380.2, 376.0, 357.70000000000005, 398.2, 361.5, 391.9, 373.00000000000006, 355.9, 391.5, 384.6, 372.4, 383.8, 389.2, 351.1, 354.0, 364.0, 364.0, 371.3, 354.4, 379.2, 360.4, 373.3, 351.3, 396.4, 378.4, 379.9, 374.3, 390.1, 349.0, 379.70000000000005, 338.4, 382.9, 392.8, 392.2, 375.1, 384.2, 357.0, 328.0, 391.9, 344.9, 364.5, 306.0, 378.5, 350.6, 335.5, 386.0, 371.20000000000005, 391.0, 331.0, 368.3, 384.3, 362.4, 329.9, 355.5, 388.0, 357.0, 377.6, 383.8], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [188.0, 190.1, 181.1, 175.4, 140.60000000000002, 199.1, 190.1, 200.0, 186.5, 156.8, 196.4, 194.0, 170.0, 192.8, 159.2, 140.9, 167.0, 194.6, 192.8, 189.2, 157.4, 197.0, 196.1, 200.0, 192.8, 188.3, 191.9, 196.4, 155.3, 199.1, 200.0, 195.0, 150.0, 197.0, 198.2, 195.5, 146.0, 164.9, 192.8, 193.7, 196.1, 194.0, 160.1, 142.7, 200.0, 187.7, 164.60000000000002, 189.2, 178.1, 128.3, 126.2, 176.0, 188.0, 173.0, 198.2, 187.4, 131.6, 182.0, 170.3, 176.3, 160.1, 192.8, 200.0, 192.5, 191.9, 156.20000000000002, 191.0, 165.2, 186.5, 198.2, 144.2, 174.2, 194.0, 152.0, 186.0, 199.0, 200.0, 167.0, 173.0, 174.8, 185.0, 181.1, 128.6, 189.2, 171.2, 200.0, 173.0, 194.0, 193.7, 164.0, 198.2, 200.0, 153.8, 193.7, 191.9, 200.0, 177.49999999999997, 195.5, 198.2, 139.7, 189.5, 200.0, 200.0, 179.6, 134.0, 196.4, 187.4, 196.4, 200.0, 189.2, 127.1, 200.0, 173.0, 172.0, 183.0, 178.0, 171.2, 192.8, 200.0, 158.3, 169.4, 164.0, 192.2, 179.0, 171.2, 189.2, 199.1, 150.2, 182.0, 140.3, 200.0, 196.4, 200.0, 178.4, 173.9, 200.0, 161.3, 200.0, 191.0, 199.1, 181.1, 155.9, 194.6, 178.1, 191.3, 118.1, 199.1, 183.8, 200.0, 192.8, 191.0, 198.2, 184.7, 187.4, 189.2, 185.0, 197.0, 139.0, 163.0, 149.0, 196.4, 195.5, 122.6, 188.3, 139.4, 190.1, 146.0, 140.0, 192.5, 179.0, 167.0, 161.6, 159.5, 164.0, 200.0, 179.0, 172.1, 199.1, 200.0, 191.0, 128.0, 170.0, 176.0, 179.3, 199.1, 183.2, 172.4, 182.0, 128.0, 173.9, 167.0, 177.5, 182.0, 200.0, 198.0, 141.0, 179.0, 194.6, 195.5, 188.3], "policy_predator_policy_reward": [4.0, 0.0, 6.0, 7.0, 7.0, 12.0, 0.0, 0.0, 7.0, 9.0, 2.0, 0.0, 6.0, 4.0, 21.0, 9.0, 0.0, 11.0, 0.0, 0.0, 11.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 12.0, 2.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 5.0, 15.0, 0.0, 0.0, 3.0, 0.0, 17.0, 11.0, 2.0, 0.0, 2.0, 10.0, 6.0, 26.0, 13.0, 16.0, 0.0, 9.0, 0.0, 0.0, 24.0, 0.0, 7.0, 0.0, 13.0, 5.0, 1.0, 0.0, 11.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 15.0, 0.0, 0.0, 2.0, 11.0, 5.0, 10.0, 2.0, 0.0, 22.0, 4.0, 9.0, 0.0, 3.0, 6.0, 0.0, 0.0, 0.0, 0.0, 10.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 2.0, 0.0, 5.0, 20.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 9.0, 0.0, 3.0, 0.0, 0.0, 0.0, 13.0, 0.0, 21.0, 0.0, 8.0, 0.0, 0.0, 0.0, 13.0, 11.0, 11.0, 18.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 5.0, 0.0, 0.0, 12.0, 0.0, 7.0, 0.0, 11.0, 18.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 3.0, 0.0, 4.0, 6.0, 20.0, 1.0, 16.0, 0.0, 0.0, 0.0, 21.0, 13.0, 18.0, 17.0, 20.0, 0.0, 7.0, 0.0, 11.0, 11.0, 12.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 9.0, 24.0, 8.0, 5.0, 0.0, 2.0, 0.0, 8.0, 19.0, 9.0, 11.0, 0.0, 6.0, 0.0, 2.0, 16.0, 0.0, 4.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4876766845702907, "mean_inference_ms": 4.467704843186189, "mean_action_processing_ms": 0.6909571103773284, "mean_env_wait_ms": 0.5165703969350143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006992220878601074, "StateBufferConnector_ms": 0.005123496055603027, "ViewRequirementAgentConnector_ms": 0.1673518419265747}, "num_episodes": 18, "episode_return_max": 398.2, "episode_return_min": 306.0, "episode_return_mean": 368.7750000000001, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.4824623336805, "num_env_steps_trained_throughput_per_sec": 288.4824623336805, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 1584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1584000, "timers": {"training_iteration_time_ms": 14585.159, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14585.083, "sample_time_ms": 1997.809, "learn_time_ms": 12565.272, "learn_throughput": 318.338, "synch_weights_time_ms": 16.964}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 1584000, "num_agent_steps_trained": 1584000}, "done": false, "training_iteration": 99, "trial_id": "e4caa_00000", "date": "2024-08-13_20-18-50", "timestamp": 1723594730, "time_this_iter_s": 13.906759977340698, "time_total_s": 2062.8650941848755, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29e0550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2062.8650941848755, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 55.089999999999996, "ram_util_percent": 83.78999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8994297989461788, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6005165040453591, "policy_loss": -0.01033987900434387, "vf_loss": 0.6106407765239951, "vf_explained_var": 0.2318171850587956, "kl": 0.0057495242972799, "entropy": 1.3194787171151903, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4404086638537665, "cur_kl_coeff": 8.673617379884036e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.46735855009820726, "policy_loss": -0.003883132330146889, "vf_loss": 0.4712416826959246, "vf_explained_var": 0.04047029141395811, "kl": 0.003790135607018499, "entropy": 0.11547117121320553, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 188055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 398.2, "episode_reward_min": 274.3, "episode_reward_mean": 366.547, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 83.3, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 51.0}, "policy_reward_mean": {"prey_policy": 177.0785, "predator_policy": 6.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [365.8, 338.4, 331.2, 370.0, 385.6, 337.6, 353.6, 370.9, 393.5, 359.1, 364.2, 384.7, 335.4, 361.0, 385.0, 380.0, 362.8, 368.1, 343.8, 380.2, 376.0, 357.70000000000005, 398.2, 361.5, 391.9, 373.00000000000006, 355.9, 391.5, 384.6, 372.4, 383.8, 389.2, 351.1, 354.0, 364.0, 364.0, 371.3, 354.4, 379.2, 360.4, 373.3, 351.3, 396.4, 378.4, 379.9, 374.3, 390.1, 349.0, 379.70000000000005, 338.4, 382.9, 392.8, 392.2, 375.1, 384.2, 357.0, 328.0, 391.9, 344.9, 364.5, 306.0, 378.5, 350.6, 335.5, 386.0, 371.20000000000005, 391.0, 331.0, 368.3, 384.3, 362.4, 329.9, 355.5, 388.0, 357.0, 377.6, 383.8, 395.5, 357.0, 366.7, 340.9, 375.0, 383.1, 383.8, 376.8, 360.4, 368.8, 362.0, 357.6, 274.3, 373.0, 378.1, 344.0, 336.0, 355.0, 382.0, 335.0, 388.3, 377.5, 398.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [164.60000000000002, 189.2, 178.1, 128.3, 126.2, 176.0, 188.0, 173.0, 198.2, 187.4, 131.6, 182.0, 170.3, 176.3, 160.1, 192.8, 200.0, 192.5, 191.9, 156.20000000000002, 191.0, 165.2, 186.5, 198.2, 144.2, 174.2, 194.0, 152.0, 186.0, 199.0, 200.0, 167.0, 173.0, 174.8, 185.0, 181.1, 128.6, 189.2, 171.2, 200.0, 173.0, 194.0, 193.7, 164.0, 198.2, 200.0, 153.8, 193.7, 191.9, 200.0, 177.49999999999997, 195.5, 198.2, 139.7, 189.5, 200.0, 200.0, 179.6, 134.0, 196.4, 187.4, 196.4, 200.0, 189.2, 127.1, 200.0, 173.0, 172.0, 183.0, 178.0, 171.2, 192.8, 200.0, 158.3, 169.4, 164.0, 192.2, 179.0, 171.2, 189.2, 199.1, 150.2, 182.0, 140.3, 200.0, 196.4, 200.0, 178.4, 173.9, 200.0, 161.3, 200.0, 191.0, 199.1, 181.1, 155.9, 194.6, 178.1, 191.3, 118.1, 199.1, 183.8, 200.0, 192.8, 191.0, 198.2, 184.7, 187.4, 189.2, 185.0, 197.0, 139.0, 163.0, 149.0, 196.4, 195.5, 122.6, 188.3, 139.4, 190.1, 146.0, 140.0, 192.5, 179.0, 167.0, 161.6, 159.5, 164.0, 200.0, 179.0, 172.1, 199.1, 200.0, 191.0, 128.0, 170.0, 176.0, 179.3, 199.1, 183.2, 172.4, 182.0, 128.0, 173.9, 167.0, 177.5, 182.0, 200.0, 198.0, 141.0, 179.0, 194.6, 195.5, 188.3, 195.5, 200.0, 173.0, 173.0, 189.2, 177.5, 184.7, 132.2, 173.0, 194.0, 199.1, 176.0, 183.8, 200.0, 168.8, 200.0, 152.3, 190.1, 194.6, 162.2, 200.0, 143.0, 145.4, 198.2, 95.0, 83.3, 131.0, 200.0, 163.1, 200.0, 140.0, 176.0, 104.0, 200.0, 182.0, 152.0, 197.0, 179.0, 117.0, 191.0, 191.9, 196.4, 178.4, 199.1, 197.0, 200.0], "policy_predator_policy_reward": [2.0, 10.0, 6.0, 26.0, 13.0, 16.0, 0.0, 9.0, 0.0, 0.0, 24.0, 0.0, 7.0, 0.0, 13.0, 5.0, 1.0, 0.0, 11.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 17.0, 0.0, 15.0, 0.0, 0.0, 2.0, 11.0, 5.0, 10.0, 2.0, 0.0, 22.0, 4.0, 9.0, 0.0, 3.0, 6.0, 0.0, 0.0, 0.0, 0.0, 10.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 2.0, 0.0, 5.0, 20.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 9.0, 0.0, 3.0, 0.0, 0.0, 0.0, 13.0, 0.0, 21.0, 0.0, 8.0, 0.0, 0.0, 0.0, 13.0, 11.0, 11.0, 18.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 5.0, 0.0, 0.0, 12.0, 0.0, 7.0, 0.0, 11.0, 18.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 3.0, 0.0, 4.0, 6.0, 20.0, 1.0, 16.0, 0.0, 0.0, 0.0, 21.0, 13.0, 18.0, 17.0, 20.0, 0.0, 7.0, 0.0, 11.0, 11.0, 12.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 9.0, 24.0, 8.0, 5.0, 0.0, 2.0, 0.0, 8.0, 19.0, 9.0, 11.0, 0.0, 6.0, 0.0, 2.0, 16.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 24.0, 8.0, 0.0, 0.0, 8.0, 0.0, 0.0, 8.0, 0.0, 6.0, 12.0, 11.0, 1.0, 19.0, 0.0, 14.0, 0.0, 45.0, 51.0, 19.0, 23.0, 3.0, 12.0, 8.0, 20.0, 0.0, 32.0, 0.0, 21.0, 6.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4780496266329846, "mean_inference_ms": 4.442407295991642, "mean_action_processing_ms": 0.6886984212509892, "mean_env_wait_ms": 0.5146480369408405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008086085319519043, "StateBufferConnector_ms": 0.010016798973083496, "ViewRequirementAgentConnector_ms": 0.1662076711654663}, "num_episodes": 23, "episode_return_max": 398.2, "episode_return_min": 274.3, "episode_return_mean": 366.547, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 247.2772912859953, "num_env_steps_trained_throughput_per_sec": 247.2772912859953, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 14843.706, "restore_workers_time_ms": 0.016, "training_step_time_ms": 14843.629, "sample_time_ms": 2030.292, "learn_time_ms": 12789.74, "learn_throughput": 312.751, "synch_weights_time_ms": 16.916}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": false, "training_iteration": 100, "trial_id": "e4caa_00000", "date": "2024-08-13_20-19-06", "timestamp": 1723594746, "time_this_iter_s": 16.240734100341797, "time_total_s": 2079.1058282852173, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b685e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2079.1058282852173, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 61.591304347826075, "ram_util_percent": 83.94347826086955}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.95884090737691, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7861126931896679, "policy_loss": -0.007468814580706219, "vf_loss": 0.7931880469793681, "vf_explained_var": 0.2383828430579453, "kl": 0.010492275918371763, "entropy": 1.3256496712013528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1025054329207966, "cur_kl_coeff": 4.336808689942018e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.48254457705866094, "policy_loss": -0.0014530376666693618, "vf_loss": 0.4839976143431924, "vf_explained_var": 0.03852264720296103, "kl": 0.005835336775594831, "entropy": 0.13268871768205254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 189945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 274.1, "episode_reward_mean": 368.2130000000001, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 72.50000000000003, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 51.0}, "policy_reward_mean": {"prey_policy": 178.3565, "predator_policy": 5.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [343.8, 380.2, 376.0, 357.70000000000005, 398.2, 361.5, 391.9, 373.00000000000006, 355.9, 391.5, 384.6, 372.4, 383.8, 389.2, 351.1, 354.0, 364.0, 364.0, 371.3, 354.4, 379.2, 360.4, 373.3, 351.3, 396.4, 378.4, 379.9, 374.3, 390.1, 349.0, 379.70000000000005, 338.4, 382.9, 392.8, 392.2, 375.1, 384.2, 357.0, 328.0, 391.9, 344.9, 364.5, 306.0, 378.5, 350.6, 335.5, 386.0, 371.20000000000005, 391.0, 331.0, 368.3, 384.3, 362.4, 329.9, 355.5, 388.0, 357.0, 377.6, 383.8, 395.5, 357.0, 366.7, 340.9, 375.0, 383.1, 383.8, 376.8, 360.4, 368.8, 362.0, 357.6, 274.3, 373.0, 378.1, 344.0, 336.0, 355.0, 382.0, 335.0, 388.3, 377.5, 398.0, 397.3, 325.1, 356.2, 391.9, 374.0, 381.0, 391.0, 390.1, 393.7, 393.7, 274.1, 319.4, 391.3, 391.0, 394.0, 400.0, 368.8, 380.9], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [128.6, 189.2, 171.2, 200.0, 173.0, 194.0, 193.7, 164.0, 198.2, 200.0, 153.8, 193.7, 191.9, 200.0, 177.49999999999997, 195.5, 198.2, 139.7, 189.5, 200.0, 200.0, 179.6, 134.0, 196.4, 187.4, 196.4, 200.0, 189.2, 127.1, 200.0, 173.0, 172.0, 183.0, 178.0, 171.2, 192.8, 200.0, 158.3, 169.4, 164.0, 192.2, 179.0, 171.2, 189.2, 199.1, 150.2, 182.0, 140.3, 200.0, 196.4, 200.0, 178.4, 173.9, 200.0, 161.3, 200.0, 191.0, 199.1, 181.1, 155.9, 194.6, 178.1, 191.3, 118.1, 199.1, 183.8, 200.0, 192.8, 191.0, 198.2, 184.7, 187.4, 189.2, 185.0, 197.0, 139.0, 163.0, 149.0, 196.4, 195.5, 122.6, 188.3, 139.4, 190.1, 146.0, 140.0, 192.5, 179.0, 167.0, 161.6, 159.5, 164.0, 200.0, 179.0, 172.1, 199.1, 200.0, 191.0, 128.0, 170.0, 176.0, 179.3, 199.1, 183.2, 172.4, 182.0, 128.0, 173.9, 167.0, 177.5, 182.0, 200.0, 198.0, 141.0, 179.0, 194.6, 195.5, 188.3, 195.5, 200.0, 173.0, 173.0, 189.2, 177.5, 184.7, 132.2, 173.0, 194.0, 199.1, 176.0, 183.8, 200.0, 168.8, 200.0, 152.3, 190.1, 194.6, 162.2, 200.0, 143.0, 145.4, 198.2, 95.0, 83.3, 131.0, 200.0, 163.1, 200.0, 140.0, 176.0, 104.0, 200.0, 182.0, 152.0, 197.0, 179.0, 117.0, 191.0, 191.9, 196.4, 178.4, 199.1, 197.0, 200.0, 197.3, 200.0, 139.4, 184.7, 154.1, 190.1, 199.1, 192.8, 161.0, 200.0, 191.0, 185.0, 192.8, 198.2, 190.1, 200.0, 200.0, 193.7, 193.7, 200.0, 152.6, 72.50000000000003, 107.3, 178.1, 200.0, 188.3, 195.5, 195.5, 191.0, 200.0, 200.0, 200.0, 184.7, 181.1, 188.0, 191.9], "policy_predator_policy_reward": [22.0, 4.0, 9.0, 0.0, 3.0, 6.0, 0.0, 0.0, 0.0, 0.0, 10.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 0.0, 2.0, 0.0, 5.0, 20.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 9.0, 0.0, 3.0, 0.0, 0.0, 0.0, 13.0, 0.0, 21.0, 0.0, 8.0, 0.0, 0.0, 0.0, 13.0, 11.0, 11.0, 18.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 5.0, 0.0, 0.0, 12.0, 0.0, 7.0, 0.0, 11.0, 18.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 3.0, 0.0, 4.0, 6.0, 20.0, 1.0, 16.0, 0.0, 0.0, 0.0, 21.0, 13.0, 18.0, 17.0, 20.0, 0.0, 7.0, 0.0, 11.0, 11.0, 12.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 9.0, 24.0, 8.0, 5.0, 0.0, 2.0, 0.0, 8.0, 19.0, 9.0, 11.0, 0.0, 6.0, 0.0, 2.0, 16.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 24.0, 8.0, 0.0, 0.0, 8.0, 0.0, 0.0, 8.0, 0.0, 6.0, 12.0, 11.0, 1.0, 19.0, 0.0, 14.0, 0.0, 45.0, 51.0, 19.0, 23.0, 3.0, 12.0, 8.0, 20.0, 0.0, 32.0, 0.0, 21.0, 6.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 12.0, 0.0, 0.0, 1.0, 12.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.0, 24.0, 30.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4766764169597517, "mean_inference_ms": 4.438254035902681, "mean_action_processing_ms": 0.6852670310816745, "mean_env_wait_ms": 0.5126330802176721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008364319801330566, "StateBufferConnector_ms": 0.009960651397705078, "ViewRequirementAgentConnector_ms": 0.1615980863571167}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 274.1, "episode_return_mean": 368.2130000000001, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 218.68746845173754, "num_env_steps_trained_throughput_per_sec": 218.68746845173754, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 1616000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1616000, "timers": {"training_iteration_time_ms": 15344.055, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15343.975, "sample_time_ms": 2083.831, "learn_time_ms": 13233.572, "learn_throughput": 302.262, "synch_weights_time_ms": 19.405}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 1616000, "num_agent_steps_trained": 1616000}, "done": false, "training_iteration": 101, "trial_id": "e4caa_00000", "date": "2024-08-13_20-19-25", "timestamp": 1723594765, "time_this_iter_s": 18.34163808822632, "time_total_s": 2097.4474663734436, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b293a310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2097.4474663734436, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 68.9846153846154, "ram_util_percent": 83.7423076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.626386016402295, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6739473644959391, "policy_loss": -0.009300608713199538, "vf_loss": 0.6828392224573584, "vf_explained_var": 0.3052557177013821, "kl": 0.010900031010994708, "entropy": 1.312966454912115, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 191835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.105667070295445, "cur_kl_coeff": 4.336808689942018e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5563038249022115, "policy_loss": -0.002263375374158381, "vf_loss": 0.5585671998521008, "vf_explained_var": 0.028449326280563597, "kl": 0.00283442031049735, "entropy": 0.07721980316022402, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 191835.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 228.4, "episode_reward_mean": 365.30600000000004, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 34.400000000000006, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 51.0}, "policy_reward_mean": {"prey_policy": 176.148, "predator_policy": 6.505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [371.3, 354.4, 379.2, 360.4, 373.3, 351.3, 396.4, 378.4, 379.9, 374.3, 390.1, 349.0, 379.70000000000005, 338.4, 382.9, 392.8, 392.2, 375.1, 384.2, 357.0, 328.0, 391.9, 344.9, 364.5, 306.0, 378.5, 350.6, 335.5, 386.0, 371.20000000000005, 391.0, 331.0, 368.3, 384.3, 362.4, 329.9, 355.5, 388.0, 357.0, 377.6, 383.8, 395.5, 357.0, 366.7, 340.9, 375.0, 383.1, 383.8, 376.8, 360.4, 368.8, 362.0, 357.6, 274.3, 373.0, 378.1, 344.0, 336.0, 355.0, 382.0, 335.0, 388.3, 377.5, 398.0, 397.3, 325.1, 356.2, 391.9, 374.0, 381.0, 391.0, 390.1, 393.7, 393.7, 274.1, 319.4, 391.3, 391.0, 394.0, 400.0, 368.8, 380.9, 372.1, 382.9, 228.4, 338.2, 360.8, 392.8, 359.0, 385.6, 380.0, 312.3, 367.1, 350.2, 391.0, 326.20000000000005, 380.0, 333.0, 381.9, 360.6], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 158.3, 169.4, 164.0, 192.2, 179.0, 171.2, 189.2, 199.1, 150.2, 182.0, 140.3, 200.0, 196.4, 200.0, 178.4, 173.9, 200.0, 161.3, 200.0, 191.0, 199.1, 181.1, 155.9, 194.6, 178.1, 191.3, 118.1, 199.1, 183.8, 200.0, 192.8, 191.0, 198.2, 184.7, 187.4, 189.2, 185.0, 197.0, 139.0, 163.0, 149.0, 196.4, 195.5, 122.6, 188.3, 139.4, 190.1, 146.0, 140.0, 192.5, 179.0, 167.0, 161.6, 159.5, 164.0, 200.0, 179.0, 172.1, 199.1, 200.0, 191.0, 128.0, 170.0, 176.0, 179.3, 199.1, 183.2, 172.4, 182.0, 128.0, 173.9, 167.0, 177.5, 182.0, 200.0, 198.0, 141.0, 179.0, 194.6, 195.5, 188.3, 195.5, 200.0, 173.0, 173.0, 189.2, 177.5, 184.7, 132.2, 173.0, 194.0, 199.1, 176.0, 183.8, 200.0, 168.8, 200.0, 152.3, 190.1, 194.6, 162.2, 200.0, 143.0, 145.4, 198.2, 95.0, 83.3, 131.0, 200.0, 163.1, 200.0, 140.0, 176.0, 104.0, 200.0, 182.0, 152.0, 197.0, 179.0, 117.0, 191.0, 191.9, 196.4, 178.4, 199.1, 197.0, 200.0, 197.3, 200.0, 139.4, 184.7, 154.1, 190.1, 199.1, 192.8, 161.0, 200.0, 191.0, 185.0, 192.8, 198.2, 190.1, 200.0, 200.0, 193.7, 193.7, 200.0, 152.6, 72.50000000000003, 107.3, 178.1, 200.0, 188.3, 195.5, 195.5, 191.0, 200.0, 200.0, 200.0, 184.7, 181.1, 188.0, 191.9, 182.0, 190.1, 191.0, 191.9, 34.400000000000006, 110.0, 110.0, 198.2, 172.7, 175.1, 192.8, 200.0, 180.5, 162.5, 191.0, 194.6, 200.0, 170.0, 128.6, 154.7, 163.1, 185.0, 167.0, 165.2, 196.4, 194.6, 92.0, 198.2, 170.0, 200.0, 108.0, 200.0, 185.0, 191.9, 200.0, 143.6], "policy_predator_policy_reward": [13.0, 0.0, 21.0, 0.0, 8.0, 0.0, 0.0, 0.0, 13.0, 11.0, 11.0, 18.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 5.0, 0.0, 0.0, 12.0, 0.0, 7.0, 0.0, 11.0, 18.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 3.0, 0.0, 4.0, 6.0, 20.0, 1.0, 16.0, 0.0, 0.0, 0.0, 21.0, 13.0, 18.0, 17.0, 20.0, 0.0, 7.0, 0.0, 11.0, 11.0, 12.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 9.0, 24.0, 8.0, 5.0, 0.0, 2.0, 0.0, 8.0, 19.0, 9.0, 11.0, 0.0, 6.0, 0.0, 2.0, 16.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 24.0, 8.0, 0.0, 0.0, 8.0, 0.0, 0.0, 8.0, 0.0, 6.0, 12.0, 11.0, 1.0, 19.0, 0.0, 14.0, 0.0, 45.0, 51.0, 19.0, 23.0, 3.0, 12.0, 8.0, 20.0, 0.0, 32.0, 0.0, 21.0, 6.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 12.0, 0.0, 0.0, 1.0, 12.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.0, 24.0, 30.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 42.0, 42.0, 30.0, 0.0, 0.0, 13.0, 0.0, 0.0, 13.0, 3.0, 0.0, 0.0, 10.0, 0.0, 13.0, 16.0, 9.0, 10.0, 9.0, 9.0, 0.0, 0.0, 17.0, 19.0, 0.0, 10.0, 25.0, 0.0, 0.0, 5.0, 0.0, 17.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4721065067928425, "mean_inference_ms": 4.42610501193575, "mean_action_processing_ms": 0.6828860131511363, "mean_env_wait_ms": 0.5110509790211194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008456707000732422, "StateBufferConnector_ms": 0.010092377662658691, "ViewRequirementAgentConnector_ms": 0.16272425651550293}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 228.4, "episode_return_mean": 365.30600000000004, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.09756377749017, "num_env_steps_trained_throughput_per_sec": 284.09756377749017, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 1632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1632000, "timers": {"training_iteration_time_ms": 15341.146, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15341.068, "sample_time_ms": 2129.347, "learn_time_ms": 13184.955, "learn_throughput": 303.376, "synch_weights_time_ms": 19.225}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 1632000, "num_agent_steps_trained": 1632000}, "done": false, "training_iteration": 102, "trial_id": "e4caa_00000", "date": "2024-08-13_20-19-39", "timestamp": 1723594779, "time_this_iter_s": 14.155364751815796, "time_total_s": 2111.6028311252594, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b68b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2111.6028311252594, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 53.17, "ram_util_percent": 83.41}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7322965271416164, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8873804636457294, "policy_loss": -0.005420991309016706, "vf_loss": 0.8924389272060974, "vf_explained_var": 0.42211278232317123, "kl": 0.00966743521480069, "entropy": 1.267689162965805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 193725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4693715205820148, "cur_kl_coeff": 2.168404344971009e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6585807355623396, "policy_loss": -0.0027621551414350512, "vf_loss": 0.6613428918063325, "vf_explained_var": 0.08769863834456793, "kl": 0.002549484425006744, "entropy": 0.06905350415282464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 193725.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 228.4, "episode_reward_mean": 360.597, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 34.400000000000006, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 51.0}, "policy_reward_mean": {"prey_policy": 173.1435, "predator_policy": 7.155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [344.9, 364.5, 306.0, 378.5, 350.6, 335.5, 386.0, 371.20000000000005, 391.0, 331.0, 368.3, 384.3, 362.4, 329.9, 355.5, 388.0, 357.0, 377.6, 383.8, 395.5, 357.0, 366.7, 340.9, 375.0, 383.1, 383.8, 376.8, 360.4, 368.8, 362.0, 357.6, 274.3, 373.0, 378.1, 344.0, 336.0, 355.0, 382.0, 335.0, 388.3, 377.5, 398.0, 397.3, 325.1, 356.2, 391.9, 374.0, 381.0, 391.0, 390.1, 393.7, 393.7, 274.1, 319.4, 391.3, 391.0, 394.0, 400.0, 368.8, 380.9, 372.1, 382.9, 228.4, 338.2, 360.8, 392.8, 359.0, 385.6, 380.0, 312.3, 367.1, 350.2, 391.0, 326.20000000000005, 380.0, 333.0, 381.9, 360.6, 257.9, 371.1, 371.0, 336.8, 372.6, 320.1, 390.8, 303.9, 360.7, 374.8, 363.1, 369.6, 289.7, 352.1, 383.8, 296.40000000000003, 371.5, 374.1, 394.0, 371.0, 370.1, 314.20000000000005], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [122.6, 188.3, 139.4, 190.1, 146.0, 140.0, 192.5, 179.0, 167.0, 161.6, 159.5, 164.0, 200.0, 179.0, 172.1, 199.1, 200.0, 191.0, 128.0, 170.0, 176.0, 179.3, 199.1, 183.2, 172.4, 182.0, 128.0, 173.9, 167.0, 177.5, 182.0, 200.0, 198.0, 141.0, 179.0, 194.6, 195.5, 188.3, 195.5, 200.0, 173.0, 173.0, 189.2, 177.5, 184.7, 132.2, 173.0, 194.0, 199.1, 176.0, 183.8, 200.0, 168.8, 200.0, 152.3, 190.1, 194.6, 162.2, 200.0, 143.0, 145.4, 198.2, 95.0, 83.3, 131.0, 200.0, 163.1, 200.0, 140.0, 176.0, 104.0, 200.0, 182.0, 152.0, 197.0, 179.0, 117.0, 191.0, 191.9, 196.4, 178.4, 199.1, 197.0, 200.0, 197.3, 200.0, 139.4, 184.7, 154.1, 190.1, 199.1, 192.8, 161.0, 200.0, 191.0, 185.0, 192.8, 198.2, 190.1, 200.0, 200.0, 193.7, 193.7, 200.0, 152.6, 72.50000000000003, 107.3, 178.1, 200.0, 188.3, 195.5, 195.5, 191.0, 200.0, 200.0, 200.0, 184.7, 181.1, 188.0, 191.9, 182.0, 190.1, 191.0, 191.9, 34.400000000000006, 110.0, 110.0, 198.2, 172.7, 175.1, 192.8, 200.0, 180.5, 162.5, 191.0, 194.6, 200.0, 170.0, 128.6, 154.7, 163.1, 185.0, 167.0, 165.2, 196.4, 194.6, 92.0, 198.2, 170.0, 200.0, 108.0, 200.0, 185.0, 191.9, 200.0, 143.6, 70.1, 126.8, 200.0, 157.1, 188.6, 175.4, 162.8, 146.0, 200.0, 161.6, 173.3, 123.8, 197.3, 192.5, 129.5, 139.4, 172.7, 173.0, 176.6, 198.2, 178.4, 184.7, 185.6, 176.0, 128.3, 136.4, 126.5, 194.6, 189.2, 194.6, 125.6, 156.8, 199.1, 160.4, 200.0, 160.1, 194.0, 200.0, 165.0, 194.0, 172.1, 197.0, 190.1, 91.1], "policy_predator_policy_reward": [21.0, 13.0, 18.0, 17.0, 20.0, 0.0, 7.0, 0.0, 11.0, 11.0, 12.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 9.0, 24.0, 8.0, 5.0, 0.0, 2.0, 0.0, 8.0, 19.0, 9.0, 11.0, 0.0, 6.0, 0.0, 2.0, 16.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 24.0, 8.0, 0.0, 0.0, 8.0, 0.0, 0.0, 8.0, 0.0, 6.0, 12.0, 11.0, 1.0, 19.0, 0.0, 14.0, 0.0, 45.0, 51.0, 19.0, 23.0, 3.0, 12.0, 8.0, 20.0, 0.0, 32.0, 0.0, 21.0, 6.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 12.0, 0.0, 0.0, 1.0, 12.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.0, 24.0, 30.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 42.0, 42.0, 30.0, 0.0, 0.0, 13.0, 0.0, 0.0, 13.0, 3.0, 0.0, 0.0, 10.0, 0.0, 13.0, 16.0, 9.0, 10.0, 9.0, 9.0, 0.0, 0.0, 17.0, 19.0, 0.0, 10.0, 25.0, 0.0, 0.0, 5.0, 0.0, 17.0, 25.0, 36.0, 14.0, 0.0, 0.0, 7.0, 15.0, 13.0, 0.0, 11.0, 0.0, 23.0, 0.0, 1.0, 20.0, 15.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 0.0, 25.0, 9.0, 22.0, 0.0, 0.0, 14.0, 0.0, 0.0, 12.0, 8.0, 6.0, 0.0, 0.0, 12.0, 0.0, 1.0, 0.0, 17.0, 16.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4650745629696473, "mean_inference_ms": 4.406155341083702, "mean_action_processing_ms": 0.6793102708896344, "mean_env_wait_ms": 0.5086162368322767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0074920654296875, "StateBufferConnector_ms": 0.009094476699829102, "ViewRequirementAgentConnector_ms": 0.12992870807647705}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 228.4, "episode_return_mean": 360.597, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.1059407614968, "num_env_steps_trained_throughput_per_sec": 292.1059407614968, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 1648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1648000, "timers": {"training_iteration_time_ms": 15200.407, "restore_workers_time_ms": 0.016, "training_step_time_ms": 15200.348, "sample_time_ms": 2054.245, "learn_time_ms": 13115.137, "learn_throughput": 304.991, "synch_weights_time_ms": 24.446}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 1648000, "num_agent_steps_trained": 1648000}, "done": false, "training_iteration": 103, "trial_id": "e4caa_00000", "date": "2024-08-13_20-19-53", "timestamp": 1723594793, "time_this_iter_s": 13.779546737670898, "time_total_s": 2125.3823778629303, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29e08b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2125.3823778629303, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 50.863157894736844, "ram_util_percent": 83.06842105263156}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5490241532445586, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.46981347000630447, "policy_loss": -0.00537739542273499, "vf_loss": 0.47497687426853985, "vf_explained_var": 0.2693847724054226, "kl": 0.0057063911556058155, "entropy": 1.2968699373265422, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3090413657761124, "cur_kl_coeff": 1.0842021724855045e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3250792913493656, "policy_loss": -0.01793501542440108, "vf_loss": 0.3430143075729055, "vf_explained_var": 0.23346961238396863, "kl": 0.0634187245445161, "entropy": 0.15616995508748072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 195615.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 228.4, "episode_reward_mean": 361.7419999999999, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 34.400000000000006, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 51.0}, "policy_reward_mean": {"prey_policy": 173.946, "predator_policy": 6.925}, "custom_metrics": {}, "hist_stats": {"episode_reward": [383.8, 395.5, 357.0, 366.7, 340.9, 375.0, 383.1, 383.8, 376.8, 360.4, 368.8, 362.0, 357.6, 274.3, 373.0, 378.1, 344.0, 336.0, 355.0, 382.0, 335.0, 388.3, 377.5, 398.0, 397.3, 325.1, 356.2, 391.9, 374.0, 381.0, 391.0, 390.1, 393.7, 393.7, 274.1, 319.4, 391.3, 391.0, 394.0, 400.0, 368.8, 380.9, 372.1, 382.9, 228.4, 338.2, 360.8, 392.8, 359.0, 385.6, 380.0, 312.3, 367.1, 350.2, 391.0, 326.20000000000005, 380.0, 333.0, 381.9, 360.6, 257.9, 371.1, 371.0, 336.8, 372.6, 320.1, 390.8, 303.9, 360.7, 374.8, 363.1, 369.6, 289.7, 352.1, 383.8, 296.40000000000003, 371.5, 374.1, 394.0, 371.0, 370.1, 314.20000000000005, 382.0, 363.0, 344.8, 363.6, 344.3, 338.1, 396.4, 390.1, 377.8, 372.7, 349.6, 366.4, 322.59999999999997, 351.0, 378.0, 383.0, 378.7, 394.6], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [195.5, 188.3, 195.5, 200.0, 173.0, 173.0, 189.2, 177.5, 184.7, 132.2, 173.0, 194.0, 199.1, 176.0, 183.8, 200.0, 168.8, 200.0, 152.3, 190.1, 194.6, 162.2, 200.0, 143.0, 145.4, 198.2, 95.0, 83.3, 131.0, 200.0, 163.1, 200.0, 140.0, 176.0, 104.0, 200.0, 182.0, 152.0, 197.0, 179.0, 117.0, 191.0, 191.9, 196.4, 178.4, 199.1, 197.0, 200.0, 197.3, 200.0, 139.4, 184.7, 154.1, 190.1, 199.1, 192.8, 161.0, 200.0, 191.0, 185.0, 192.8, 198.2, 190.1, 200.0, 200.0, 193.7, 193.7, 200.0, 152.6, 72.50000000000003, 107.3, 178.1, 200.0, 188.3, 195.5, 195.5, 191.0, 200.0, 200.0, 200.0, 184.7, 181.1, 188.0, 191.9, 182.0, 190.1, 191.0, 191.9, 34.400000000000006, 110.0, 110.0, 198.2, 172.7, 175.1, 192.8, 200.0, 180.5, 162.5, 191.0, 194.6, 200.0, 170.0, 128.6, 154.7, 163.1, 185.0, 167.0, 165.2, 196.4, 194.6, 92.0, 198.2, 170.0, 200.0, 108.0, 200.0, 185.0, 191.9, 200.0, 143.6, 70.1, 126.8, 200.0, 157.1, 188.6, 175.4, 162.8, 146.0, 200.0, 161.6, 173.3, 123.8, 197.3, 192.5, 129.5, 139.4, 172.7, 173.0, 176.6, 198.2, 178.4, 184.7, 185.6, 176.0, 128.3, 136.4, 126.5, 194.6, 189.2, 194.6, 125.6, 156.8, 199.1, 160.4, 200.0, 160.1, 194.0, 200.0, 165.0, 194.0, 172.1, 197.0, 190.1, 91.1, 186.5, 195.5, 179.0, 173.0, 142.4, 166.4, 153.2, 187.4, 122.3, 182.0, 122.0, 190.09999999999997, 196.4, 200.0, 194.6, 195.5, 174.8, 200.0, 177.5, 189.2, 171.2, 169.4, 172.4, 179.0, 128.89999999999998, 193.7, 200.0, 131.0, 200.0, 178.0, 161.0, 200.0, 188.3, 187.4, 194.6, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 24.0, 8.0, 0.0, 0.0, 8.0, 0.0, 0.0, 8.0, 0.0, 6.0, 12.0, 11.0, 1.0, 19.0, 0.0, 14.0, 0.0, 45.0, 51.0, 19.0, 23.0, 3.0, 12.0, 8.0, 20.0, 0.0, 32.0, 0.0, 21.0, 6.0, 0.0, 27.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 12.0, 0.0, 0.0, 1.0, 12.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.0, 24.0, 30.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 42.0, 42.0, 30.0, 0.0, 0.0, 13.0, 0.0, 0.0, 13.0, 3.0, 0.0, 0.0, 10.0, 0.0, 13.0, 16.0, 9.0, 10.0, 9.0, 9.0, 0.0, 0.0, 17.0, 19.0, 0.0, 10.0, 25.0, 0.0, 0.0, 5.0, 0.0, 17.0, 25.0, 36.0, 14.0, 0.0, 0.0, 7.0, 15.0, 13.0, 0.0, 11.0, 0.0, 23.0, 0.0, 1.0, 20.0, 15.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 0.0, 25.0, 9.0, 22.0, 0.0, 0.0, 14.0, 0.0, 0.0, 12.0, 8.0, 6.0, 0.0, 0.0, 12.0, 0.0, 1.0, 0.0, 17.0, 16.0, 0.0, 0.0, 2.0, 9.0, 18.0, 18.0, 8.0, 15.0, 19.0, 21.0, 26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 6.0, 0.0, 9.0, 5.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 12.0, 3.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4594525886128757, "mean_inference_ms": 4.389941615259984, "mean_action_processing_ms": 0.6763276254283319, "mean_env_wait_ms": 0.5066079116308875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007801175117492676, "StateBufferConnector_ms": 0.009472250938415527, "ViewRequirementAgentConnector_ms": 0.1279745101928711}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 228.4, "episode_return_mean": 361.7419999999999, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.26291691628705, "num_env_steps_trained_throughput_per_sec": 299.26291691628705, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 1664000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1664000, "timers": {"training_iteration_time_ms": 15236.852, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15236.788, "sample_time_ms": 2091.654, "learn_time_ms": 13112.717, "learn_throughput": 305.047, "synch_weights_time_ms": 25.914}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 1664000, "num_agent_steps_trained": 1664000}, "done": false, "training_iteration": 104, "trial_id": "e4caa_00000", "date": "2024-08-13_20-20-06", "timestamp": 1723594806, "time_this_iter_s": 13.499905109405518, "time_total_s": 2138.882282972336, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29e0b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2138.882282972336, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 51.515, "ram_util_percent": 82.06500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8127334138388356, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5190548297500721, "policy_loss": -0.005929551597822595, "vf_loss": 0.5247943268665088, "vf_explained_var": 0.190525880093297, "kl": 0.005068123153383213, "entropy": 1.2837807540540342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 197505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3582503935962758, "cur_kl_coeff": 1.6263032587282563e-20, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.36323997116199247, "policy_loss": -0.004143088500670813, "vf_loss": 0.3673830574314312, "vf_explained_var": 0.10248626662940576, "kl": 0.003247612526002238, "entropy": 0.05952118770588958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 197505.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 228.4, "episode_reward_mean": 362.355, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 34.400000000000006, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 42.0}, "policy_reward_mean": {"prey_policy": 174.6375, "predator_policy": 6.54}, "custom_metrics": {}, "hist_stats": {"episode_reward": [398.0, 397.3, 325.1, 356.2, 391.9, 374.0, 381.0, 391.0, 390.1, 393.7, 393.7, 274.1, 319.4, 391.3, 391.0, 394.0, 400.0, 368.8, 380.9, 372.1, 382.9, 228.4, 338.2, 360.8, 392.8, 359.0, 385.6, 380.0, 312.3, 367.1, 350.2, 391.0, 326.20000000000005, 380.0, 333.0, 381.9, 360.6, 257.9, 371.1, 371.0, 336.8, 372.6, 320.1, 390.8, 303.9, 360.7, 374.8, 363.1, 369.6, 289.7, 352.1, 383.8, 296.40000000000003, 371.5, 374.1, 394.0, 371.0, 370.1, 314.20000000000005, 382.0, 363.0, 344.8, 363.6, 344.3, 338.1, 396.4, 390.1, 377.8, 372.7, 349.6, 366.4, 322.59999999999997, 351.0, 378.0, 383.0, 378.7, 394.6, 371.3, 354.0, 370.0, 360.7, 381.8, 353.5, 338.3, 386.0, 371.5, 388.1, 385.6, 388.3, 370.2, 382.0, 350.7, 342.4, 400.0, 365.0, 336.0, 346.0, 315.8, 382.0, 376.7], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [197.0, 200.0, 197.3, 200.0, 139.4, 184.7, 154.1, 190.1, 199.1, 192.8, 161.0, 200.0, 191.0, 185.0, 192.8, 198.2, 190.1, 200.0, 200.0, 193.7, 193.7, 200.0, 152.6, 72.50000000000003, 107.3, 178.1, 200.0, 188.3, 195.5, 195.5, 191.0, 200.0, 200.0, 200.0, 184.7, 181.1, 188.0, 191.9, 182.0, 190.1, 191.0, 191.9, 34.400000000000006, 110.0, 110.0, 198.2, 172.7, 175.1, 192.8, 200.0, 180.5, 162.5, 191.0, 194.6, 200.0, 170.0, 128.6, 154.7, 163.1, 185.0, 167.0, 165.2, 196.4, 194.6, 92.0, 198.2, 170.0, 200.0, 108.0, 200.0, 185.0, 191.9, 200.0, 143.6, 70.1, 126.8, 200.0, 157.1, 188.6, 175.4, 162.8, 146.0, 200.0, 161.6, 173.3, 123.8, 197.3, 192.5, 129.5, 139.4, 172.7, 173.0, 176.6, 198.2, 178.4, 184.7, 185.6, 176.0, 128.3, 136.4, 126.5, 194.6, 189.2, 194.6, 125.6, 156.8, 199.1, 160.4, 200.0, 160.1, 194.0, 200.0, 165.0, 194.0, 172.1, 197.0, 190.1, 91.1, 186.5, 195.5, 179.0, 173.0, 142.4, 166.4, 153.2, 187.4, 122.3, 182.0, 122.0, 190.09999999999997, 196.4, 200.0, 194.6, 195.5, 174.8, 200.0, 177.5, 189.2, 171.2, 169.4, 172.4, 179.0, 128.89999999999998, 193.7, 200.0, 131.0, 200.0, 178.0, 161.0, 200.0, 188.3, 187.4, 194.6, 200.0, 178.1, 183.2, 200.0, 113.0, 182.0, 173.0, 163.1, 185.6, 188.0, 192.8, 159.2, 173.3, 178.4, 140.9, 200.0, 179.0, 194.0, 165.5, 189.8, 197.3, 191.9, 193.7, 198.2, 190.1, 195.2, 161.0, 182.9, 199.1, 167.0, 154.7, 175.7, 142.7, 200.0, 200.0, 179.0, 180.0, 164.0, 151.0, 130.0, 193.0, 159.8, 113.0, 200.0, 173.0, 186.5, 186.2], "policy_predator_policy_reward": [1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 12.0, 0.0, 0.0, 1.0, 12.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.0, 24.0, 30.0, 4.0, 3.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 42.0, 42.0, 30.0, 0.0, 0.0, 13.0, 0.0, 0.0, 13.0, 3.0, 0.0, 0.0, 10.0, 0.0, 13.0, 16.0, 9.0, 10.0, 9.0, 9.0, 0.0, 0.0, 17.0, 19.0, 0.0, 10.0, 25.0, 0.0, 0.0, 5.0, 0.0, 17.0, 25.0, 36.0, 14.0, 0.0, 0.0, 7.0, 15.0, 13.0, 0.0, 11.0, 0.0, 23.0, 0.0, 1.0, 20.0, 15.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 0.0, 25.0, 9.0, 22.0, 0.0, 0.0, 14.0, 0.0, 0.0, 12.0, 8.0, 6.0, 0.0, 0.0, 12.0, 0.0, 1.0, 0.0, 17.0, 16.0, 0.0, 0.0, 2.0, 9.0, 18.0, 18.0, 8.0, 15.0, 19.0, 21.0, 26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 6.0, 0.0, 9.0, 5.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 12.0, 3.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 21.0, 9.0, 6.0, 12.0, 0.0, 0.0, 1.0, 13.0, 8.0, 2.0, 17.0, 0.0, 7.0, 10.0, 2.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 13.0, 0.0, 0.0, 13.0, 16.0, 17.0, 7.0, 0.0, 0.0, 0.0, 6.0, 21.0, 0.0, 11.0, 12.0, 14.0, 29.0, 0.0, 9.0, 4.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4528063531078659, "mean_inference_ms": 4.3705062837251925, "mean_action_processing_ms": 0.6727438069145926, "mean_env_wait_ms": 0.5041953799240343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01476597785949707, "StateBufferConnector_ms": 0.0043523311614990234, "ViewRequirementAgentConnector_ms": 0.16715681552886963}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 228.4, "episode_return_mean": 362.355, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.0042129154541, "num_env_steps_trained_throughput_per_sec": 300.0042129154541, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 15069.429, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15069.366, "sample_time_ms": 2147.633, "learn_time_ms": 12888.983, "learn_throughput": 310.343, "synch_weights_time_ms": 26.012}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 105, "trial_id": "e4caa_00000", "date": "2024-08-13_20-20-20", "timestamp": 1723594820, "time_this_iter_s": 13.385070085525513, "time_total_s": 2152.2673530578613, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b68b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2152.2673530578613, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 49.27894736842105, "ram_util_percent": 82.68947368421053}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3786019326990875, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5068683994048221, "policy_loss": -0.008064052644653846, "vf_loss": 0.5146933498619883, "vf_explained_var": 0.4161186158657074, "kl": 0.006376088948217277, "entropy": 1.3348512831188384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 199395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6752515914894286, "cur_kl_coeff": 8.131516293641281e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5520562500865371, "policy_loss": -0.001004826875462655, "vf_loss": 0.5530610767592277, "vf_explained_var": 0.15564041973421813, "kl": 0.0035117426370846966, "entropy": 0.12221904259234194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 199395.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 228.4, "episode_reward_mean": 361.595, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 34.400000000000006, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 42.0}, "policy_reward_mean": {"prey_policy": 173.6525, "predator_policy": 7.145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.9, 372.1, 382.9, 228.4, 338.2, 360.8, 392.8, 359.0, 385.6, 380.0, 312.3, 367.1, 350.2, 391.0, 326.20000000000005, 380.0, 333.0, 381.9, 360.6, 257.9, 371.1, 371.0, 336.8, 372.6, 320.1, 390.8, 303.9, 360.7, 374.8, 363.1, 369.6, 289.7, 352.1, 383.8, 296.40000000000003, 371.5, 374.1, 394.0, 371.0, 370.1, 314.20000000000005, 382.0, 363.0, 344.8, 363.6, 344.3, 338.1, 396.4, 390.1, 377.8, 372.7, 349.6, 366.4, 322.59999999999997, 351.0, 378.0, 383.0, 378.7, 394.6, 371.3, 354.0, 370.0, 360.7, 381.8, 353.5, 338.3, 386.0, 371.5, 388.1, 385.6, 388.3, 370.2, 382.0, 350.7, 342.4, 400.0, 365.0, 336.0, 346.0, 315.8, 382.0, 376.7, 385.7, 365.9, 400.0, 357.2, 330.4, 380.6, 383.7, 314.0, 382.3, 360.1, 392.8, 357.8, 344.1, 376.8, 364.0, 371.0, 394.2, 394.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [188.0, 191.9, 182.0, 190.1, 191.0, 191.9, 34.400000000000006, 110.0, 110.0, 198.2, 172.7, 175.1, 192.8, 200.0, 180.5, 162.5, 191.0, 194.6, 200.0, 170.0, 128.6, 154.7, 163.1, 185.0, 167.0, 165.2, 196.4, 194.6, 92.0, 198.2, 170.0, 200.0, 108.0, 200.0, 185.0, 191.9, 200.0, 143.6, 70.1, 126.8, 200.0, 157.1, 188.6, 175.4, 162.8, 146.0, 200.0, 161.6, 173.3, 123.8, 197.3, 192.5, 129.5, 139.4, 172.7, 173.0, 176.6, 198.2, 178.4, 184.7, 185.6, 176.0, 128.3, 136.4, 126.5, 194.6, 189.2, 194.6, 125.6, 156.8, 199.1, 160.4, 200.0, 160.1, 194.0, 200.0, 165.0, 194.0, 172.1, 197.0, 190.1, 91.1, 186.5, 195.5, 179.0, 173.0, 142.4, 166.4, 153.2, 187.4, 122.3, 182.0, 122.0, 190.09999999999997, 196.4, 200.0, 194.6, 195.5, 174.8, 200.0, 177.5, 189.2, 171.2, 169.4, 172.4, 179.0, 128.89999999999998, 193.7, 200.0, 131.0, 200.0, 178.0, 161.0, 200.0, 188.3, 187.4, 194.6, 200.0, 178.1, 183.2, 200.0, 113.0, 182.0, 173.0, 163.1, 185.6, 188.0, 192.8, 159.2, 173.3, 178.4, 140.9, 200.0, 179.0, 194.0, 165.5, 189.8, 197.3, 191.9, 193.7, 198.2, 190.1, 195.2, 161.0, 182.9, 199.1, 167.0, 154.7, 175.7, 142.7, 200.0, 200.0, 179.0, 180.0, 164.0, 151.0, 130.0, 193.0, 159.8, 113.0, 200.0, 173.0, 186.5, 186.2, 191.0, 190.7, 191.0, 152.9, 200.0, 200.0, 141.8, 187.4, 101.0, 196.4, 177.2, 196.4, 185.0, 193.7, 94.69999999999999, 197.3, 194.3, 182.0, 164.0, 172.1, 195.5, 197.3, 200.0, 141.8, 185.6, 144.5, 192.8, 152.0, 185.0, 152.0, 171.0, 200.0, 197.0, 195.2, 191.0, 200.0], "policy_predator_policy_reward": [0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 42.0, 42.0, 30.0, 0.0, 0.0, 13.0, 0.0, 0.0, 13.0, 3.0, 0.0, 0.0, 10.0, 0.0, 13.0, 16.0, 9.0, 10.0, 9.0, 9.0, 0.0, 0.0, 17.0, 19.0, 0.0, 10.0, 25.0, 0.0, 0.0, 5.0, 0.0, 17.0, 25.0, 36.0, 14.0, 0.0, 0.0, 7.0, 15.0, 13.0, 0.0, 11.0, 0.0, 23.0, 0.0, 1.0, 20.0, 15.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 0.0, 25.0, 9.0, 22.0, 0.0, 0.0, 14.0, 0.0, 0.0, 12.0, 8.0, 6.0, 0.0, 0.0, 12.0, 0.0, 1.0, 0.0, 17.0, 16.0, 0.0, 0.0, 2.0, 9.0, 18.0, 18.0, 8.0, 15.0, 19.0, 21.0, 26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 6.0, 0.0, 9.0, 5.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 12.0, 3.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 21.0, 9.0, 6.0, 12.0, 0.0, 0.0, 1.0, 13.0, 8.0, 2.0, 17.0, 0.0, 7.0, 10.0, 2.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 13.0, 0.0, 0.0, 13.0, 16.0, 17.0, 7.0, 0.0, 0.0, 0.0, 6.0, 21.0, 0.0, 11.0, 12.0, 14.0, 29.0, 0.0, 9.0, 4.0, 0.0, 4.0, 0.0, 8.0, 14.0, 0.0, 0.0, 13.0, 15.0, 0.0, 33.0, 0.0, 7.0, 0.0, 5.0, 13.0, 9.0, 0.0, 6.0, 12.0, 12.0, 0.0, 0.0, 5.0, 11.0, 13.0, 1.0, 16.0, 16.0, 16.0, 11.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4475338022883801, "mean_inference_ms": 4.355441019537219, "mean_action_processing_ms": 0.6795928568895886, "mean_env_wait_ms": 0.5022770045020508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014462947845458984, "StateBufferConnector_ms": 0.0043103694915771484, "ViewRequirementAgentConnector_ms": 0.18177759647369385}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 228.4, "episode_return_mean": 361.595, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 253.5489060178832, "num_env_steps_trained_throughput_per_sec": 253.5489060178832, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 1696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1696000, "timers": {"training_iteration_time_ms": 15075.807, "restore_workers_time_ms": 0.017, "training_step_time_ms": 15075.747, "sample_time_ms": 2391.394, "learn_time_ms": 12649.295, "learn_throughput": 316.223, "synch_weights_time_ms": 28.506}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 1696000, "num_agent_steps_trained": 1696000}, "done": false, "training_iteration": 106, "trial_id": "e4caa_00000", "date": "2024-08-13_20-20-36", "timestamp": 1723594836, "time_this_iter_s": 15.896569728851318, "time_total_s": 2168.1639227867126, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b7d790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2168.1639227867126, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 55.36818181818182, "ram_util_percent": 83.96818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7800225146548458, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.48191093074982594, "policy_loss": -0.0061024186418209446, "vf_loss": 0.4876503930303943, "vf_explained_var": 0.39720485305029246, "kl": 0.009678806652219474, "entropy": 1.3004900087755193, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 201285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1939641700614065, "cur_kl_coeff": 4.065758146820641e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3935916416307606, "policy_loss": -0.0022596239092607033, "vf_loss": 0.3958512652062974, "vf_explained_var": -0.0046926494313295555, "kl": 0.003928364252530007, "entropy": 0.07967100570362712, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 201285.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 289.7, "episode_reward_mean": 365.97100000000006, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 91.1, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 33.0}, "policy_reward_mean": {"prey_policy": 176.95550000000003, "predator_policy": 6.03}, "custom_metrics": {}, "hist_stats": {"episode_reward": [336.8, 372.6, 320.1, 390.8, 303.9, 360.7, 374.8, 363.1, 369.6, 289.7, 352.1, 383.8, 296.40000000000003, 371.5, 374.1, 394.0, 371.0, 370.1, 314.20000000000005, 382.0, 363.0, 344.8, 363.6, 344.3, 338.1, 396.4, 390.1, 377.8, 372.7, 349.6, 366.4, 322.59999999999997, 351.0, 378.0, 383.0, 378.7, 394.6, 371.3, 354.0, 370.0, 360.7, 381.8, 353.5, 338.3, 386.0, 371.5, 388.1, 385.6, 388.3, 370.2, 382.0, 350.7, 342.4, 400.0, 365.0, 336.0, 346.0, 315.8, 382.0, 376.7, 385.7, 365.9, 400.0, 357.2, 330.4, 380.6, 383.7, 314.0, 382.3, 360.1, 392.8, 357.8, 344.1, 376.8, 364.0, 371.0, 394.2, 394.0, 371.2, 372.6, 393.7, 393.7, 380.2, 356.9, 391.5, 352.90000000000003, 334.1, 385.6, 379.7, 371.8, 347.7, 393.3, 393.7, 361.3, 346.0, 396.4, 366.0, 380.0, 377.5, 374.8], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [162.8, 146.0, 200.0, 161.6, 173.3, 123.8, 197.3, 192.5, 129.5, 139.4, 172.7, 173.0, 176.6, 198.2, 178.4, 184.7, 185.6, 176.0, 128.3, 136.4, 126.5, 194.6, 189.2, 194.6, 125.6, 156.8, 199.1, 160.4, 200.0, 160.1, 194.0, 200.0, 165.0, 194.0, 172.1, 197.0, 190.1, 91.1, 186.5, 195.5, 179.0, 173.0, 142.4, 166.4, 153.2, 187.4, 122.3, 182.0, 122.0, 190.09999999999997, 196.4, 200.0, 194.6, 195.5, 174.8, 200.0, 177.5, 189.2, 171.2, 169.4, 172.4, 179.0, 128.89999999999998, 193.7, 200.0, 131.0, 200.0, 178.0, 161.0, 200.0, 188.3, 187.4, 194.6, 200.0, 178.1, 183.2, 200.0, 113.0, 182.0, 173.0, 163.1, 185.6, 188.0, 192.8, 159.2, 173.3, 178.4, 140.9, 200.0, 179.0, 194.0, 165.5, 189.8, 197.3, 191.9, 193.7, 198.2, 190.1, 195.2, 161.0, 182.9, 199.1, 167.0, 154.7, 175.7, 142.7, 200.0, 200.0, 179.0, 180.0, 164.0, 151.0, 130.0, 193.0, 159.8, 113.0, 200.0, 173.0, 186.5, 186.2, 191.0, 190.7, 191.0, 152.9, 200.0, 200.0, 141.8, 187.4, 101.0, 196.4, 177.2, 196.4, 185.0, 193.7, 94.69999999999999, 197.3, 194.3, 182.0, 164.0, 172.1, 195.5, 197.3, 200.0, 141.8, 185.6, 144.5, 192.8, 152.0, 185.0, 152.0, 171.0, 200.0, 197.0, 195.2, 191.0, 200.0, 182.0, 180.2, 179.6, 182.0, 200.0, 193.7, 193.7, 200.0, 184.7, 195.5, 173.9, 164.0, 195.5, 194.0, 200.0, 131.9, 175.4, 133.7, 200.0, 185.6, 179.0, 193.7, 180.2, 185.59999999999997, 154.7, 170.0, 191.3, 200.0, 200.0, 193.7, 197.3, 146.0, 164.0, 164.0, 198.2, 198.2, 170.0, 191.0, 183.0, 191.0, 188.3, 189.2, 180.2, 194.6], "policy_predator_policy_reward": [15.0, 13.0, 0.0, 11.0, 0.0, 23.0, 0.0, 1.0, 20.0, 15.0, 10.0, 5.0, 0.0, 0.0, 0.0, 0.0, 6.0, 2.0, 0.0, 25.0, 9.0, 22.0, 0.0, 0.0, 14.0, 0.0, 0.0, 12.0, 8.0, 6.0, 0.0, 0.0, 12.0, 0.0, 1.0, 0.0, 17.0, 16.0, 0.0, 0.0, 2.0, 9.0, 18.0, 18.0, 8.0, 15.0, 19.0, 21.0, 26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 6.0, 0.0, 9.0, 5.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 12.0, 3.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 21.0, 9.0, 6.0, 12.0, 0.0, 0.0, 1.0, 13.0, 8.0, 2.0, 17.0, 0.0, 7.0, 10.0, 2.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 13.0, 0.0, 0.0, 13.0, 16.0, 17.0, 7.0, 0.0, 0.0, 0.0, 6.0, 21.0, 0.0, 11.0, 12.0, 14.0, 29.0, 0.0, 9.0, 4.0, 0.0, 4.0, 0.0, 8.0, 14.0, 0.0, 0.0, 13.0, 15.0, 0.0, 33.0, 0.0, 7.0, 0.0, 5.0, 13.0, 9.0, 0.0, 6.0, 12.0, 12.0, 0.0, 0.0, 5.0, 11.0, 13.0, 1.0, 16.0, 16.0, 16.0, 11.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 9.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 7.0, 2.0, 0.0, 14.0, 7.0, 8.0, 17.0, 0.0, 0.0, 7.0, 0.0, 6.0, 0.0, 13.0, 10.0, 0.0, 2.0, 0.0, 0.0, 18.0, 0.0, 5.0, 13.0, 0.0, 0.0, 5.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4420001744828084, "mean_inference_ms": 4.34264481778115, "mean_action_processing_ms": 0.6882744625429988, "mean_env_wait_ms": 0.5005777476354109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0153350830078125, "StateBufferConnector_ms": 0.0042389631271362305, "ViewRequirementAgentConnector_ms": 0.19304430484771729}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 289.7, "episode_return_mean": 365.97100000000006, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.228289613631, "num_env_steps_trained_throughput_per_sec": 267.228289613631, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 1712000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1712000, "timers": {"training_iteration_time_ms": 15223.962, "restore_workers_time_ms": 0.019, "training_step_time_ms": 15223.897, "sample_time_ms": 2478.537, "learn_time_ms": 12710.477, "learn_throughput": 314.701, "synch_weights_time_ms": 28.537}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 1712000, "num_agent_steps_trained": 1712000}, "done": false, "training_iteration": 107, "trial_id": "e4caa_00000", "date": "2024-08-13_20-20-51", "timestamp": 1723594851, "time_this_iter_s": 15.021496057510376, "time_total_s": 2183.185418844223, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29e0b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2183.185418844223, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 57.24285714285715, "ram_util_percent": 83.85714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3136044461418082, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4467543441191237, "policy_loss": -0.013933554725110452, "vf_loss": 0.4599523019400381, "vf_explained_var": 0.23381269971529642, "kl": 0.019615926519107152, "entropy": 1.2630345534395289, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 203175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1627323479209313, "cur_kl_coeff": 2.0328790734103204e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3163987219964386, "policy_loss": -0.0015198636016557142, "vf_loss": 0.31791858528765343, "vf_explained_var": 0.2312304494242189, "kl": 0.002513052705019378, "entropy": 0.09970720958299738, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 203175.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 306.20000000000005, "episode_reward_mean": 369.218, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 91.1, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 33.0}, "policy_reward_mean": {"prey_policy": 178.924, "predator_policy": 5.685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [314.20000000000005, 382.0, 363.0, 344.8, 363.6, 344.3, 338.1, 396.4, 390.1, 377.8, 372.7, 349.6, 366.4, 322.59999999999997, 351.0, 378.0, 383.0, 378.7, 394.6, 371.3, 354.0, 370.0, 360.7, 381.8, 353.5, 338.3, 386.0, 371.5, 388.1, 385.6, 388.3, 370.2, 382.0, 350.7, 342.4, 400.0, 365.0, 336.0, 346.0, 315.8, 382.0, 376.7, 385.7, 365.9, 400.0, 357.2, 330.4, 380.6, 383.7, 314.0, 382.3, 360.1, 392.8, 357.8, 344.1, 376.8, 364.0, 371.0, 394.2, 394.0, 371.2, 372.6, 393.7, 393.7, 380.2, 356.9, 391.5, 352.90000000000003, 334.1, 385.6, 379.7, 371.8, 347.7, 393.3, 393.7, 361.3, 346.0, 396.4, 366.0, 380.0, 377.5, 374.8, 386.5, 385.6, 373.0, 355.6, 395.5, 384.7, 359.2, 396.4, 348.8, 382.0, 378.9, 354.6, 396.4, 387.4, 386.0, 365.0, 378.0, 306.20000000000005], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [190.1, 91.1, 186.5, 195.5, 179.0, 173.0, 142.4, 166.4, 153.2, 187.4, 122.3, 182.0, 122.0, 190.09999999999997, 196.4, 200.0, 194.6, 195.5, 174.8, 200.0, 177.5, 189.2, 171.2, 169.4, 172.4, 179.0, 128.89999999999998, 193.7, 200.0, 131.0, 200.0, 178.0, 161.0, 200.0, 188.3, 187.4, 194.6, 200.0, 178.1, 183.2, 200.0, 113.0, 182.0, 173.0, 163.1, 185.6, 188.0, 192.8, 159.2, 173.3, 178.4, 140.9, 200.0, 179.0, 194.0, 165.5, 189.8, 197.3, 191.9, 193.7, 198.2, 190.1, 195.2, 161.0, 182.9, 199.1, 167.0, 154.7, 175.7, 142.7, 200.0, 200.0, 179.0, 180.0, 164.0, 151.0, 130.0, 193.0, 159.8, 113.0, 200.0, 173.0, 186.5, 186.2, 191.0, 190.7, 191.0, 152.9, 200.0, 200.0, 141.8, 187.4, 101.0, 196.4, 177.2, 196.4, 185.0, 193.7, 94.69999999999999, 197.3, 194.3, 182.0, 164.0, 172.1, 195.5, 197.3, 200.0, 141.8, 185.6, 144.5, 192.8, 152.0, 185.0, 152.0, 171.0, 200.0, 197.0, 195.2, 191.0, 200.0, 182.0, 180.2, 179.6, 182.0, 200.0, 193.7, 193.7, 200.0, 184.7, 195.5, 173.9, 164.0, 195.5, 194.0, 200.0, 131.9, 175.4, 133.7, 200.0, 185.6, 179.0, 193.7, 180.2, 185.59999999999997, 154.7, 170.0, 191.3, 200.0, 200.0, 193.7, 197.3, 146.0, 164.0, 164.0, 198.2, 198.2, 170.0, 191.0, 183.0, 191.0, 188.3, 189.2, 180.2, 194.6, 200.0, 186.5, 198.2, 187.4, 173.0, 191.0, 158.6, 176.0, 198.2, 197.3, 194.6, 190.1, 189.2, 140.0, 198.2, 198.2, 150.2, 194.6, 173.0, 200.0, 200.0, 158.9, 175.4, 168.2, 200.0, 196.4, 191.0, 196.4, 191.0, 195.0, 179.0, 168.0, 167.0, 200.0, 178.4, 99.80000000000003], "policy_predator_policy_reward": [17.0, 16.0, 0.0, 0.0, 2.0, 9.0, 18.0, 18.0, 8.0, 15.0, 19.0, 21.0, 26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 6.0, 0.0, 9.0, 5.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 12.0, 3.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 21.0, 9.0, 6.0, 12.0, 0.0, 0.0, 1.0, 13.0, 8.0, 2.0, 17.0, 0.0, 7.0, 10.0, 2.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 13.0, 0.0, 0.0, 13.0, 16.0, 17.0, 7.0, 0.0, 0.0, 0.0, 6.0, 21.0, 0.0, 11.0, 12.0, 14.0, 29.0, 0.0, 9.0, 4.0, 0.0, 4.0, 0.0, 8.0, 14.0, 0.0, 0.0, 13.0, 15.0, 0.0, 33.0, 0.0, 7.0, 0.0, 5.0, 13.0, 9.0, 0.0, 6.0, 12.0, 12.0, 0.0, 0.0, 5.0, 11.0, 13.0, 1.0, 16.0, 16.0, 16.0, 11.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 9.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 7.0, 2.0, 0.0, 14.0, 7.0, 8.0, 17.0, 0.0, 0.0, 7.0, 0.0, 6.0, 0.0, 13.0, 10.0, 0.0, 2.0, 0.0, 0.0, 18.0, 0.0, 5.0, 13.0, 0.0, 0.0, 5.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 19.0, 11.0, 0.0, 0.0, 4.0, 0.0, 0.0, 9.0, 10.0, 10.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 1.0, 11.0, 0.0, 6.0, 22.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4388111469849119, "mean_inference_ms": 4.3314244672194055, "mean_action_processing_ms": 0.6959918594124364, "mean_env_wait_ms": 0.49909837209180824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015741705894470215, "StateBufferConnector_ms": 0.005922675132751465, "ViewRequirementAgentConnector_ms": 0.23268377780914307}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 306.20000000000005, "episode_return_mean": 369.218, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.39799870211027, "num_env_steps_trained_throughput_per_sec": 261.39799870211027, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 1728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1728000, "timers": {"training_iteration_time_ms": 14885.241, "restore_workers_time_ms": 0.019, "training_step_time_ms": 14885.179, "sample_time_ms": 2523.98, "learn_time_ms": 12328.388, "learn_throughput": 324.454, "synch_weights_time_ms": 27.213}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 1728000, "num_agent_steps_trained": 1728000}, "done": false, "training_iteration": 108, "trial_id": "e4caa_00000", "date": "2024-08-13_20-21-06", "timestamp": 1723594866, "time_this_iter_s": 15.347552061080933, "time_total_s": 2198.532970905304, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29c1b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2198.532970905304, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 58.100000000000016, "ram_util_percent": 83.01363636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6897035765900184, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5442894837545864, "policy_loss": -0.006927163004579525, "vf_loss": 0.5510072456426406, "vf_explained_var": 0.30754801687740146, "kl": 0.0055840622168783095, "entropy": 1.2957815498902054, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 205065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2332010479358138, "cur_kl_coeff": 1.0164395367051602e-21, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3806314596108028, "policy_loss": -0.002102258517875006, "vf_loss": 0.3827337189243673, "vf_explained_var": 0.10731820442058422, "kl": 0.004485707533024189, "entropy": 0.10427421222800616, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 205065.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 306.20000000000005, "episode_reward_mean": 369.939, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 94.69999999999999, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 33.0}, "policy_reward_mean": {"prey_policy": 179.28949999999998, "predator_policy": 5.68}, "custom_metrics": {}, "hist_stats": {"episode_reward": [394.6, 371.3, 354.0, 370.0, 360.7, 381.8, 353.5, 338.3, 386.0, 371.5, 388.1, 385.6, 388.3, 370.2, 382.0, 350.7, 342.4, 400.0, 365.0, 336.0, 346.0, 315.8, 382.0, 376.7, 385.7, 365.9, 400.0, 357.2, 330.4, 380.6, 383.7, 314.0, 382.3, 360.1, 392.8, 357.8, 344.1, 376.8, 364.0, 371.0, 394.2, 394.0, 371.2, 372.6, 393.7, 393.7, 380.2, 356.9, 391.5, 352.90000000000003, 334.1, 385.6, 379.7, 371.8, 347.7, 393.3, 393.7, 361.3, 346.0, 396.4, 366.0, 380.0, 377.5, 374.8, 386.5, 385.6, 373.0, 355.6, 395.5, 384.7, 359.2, 396.4, 348.8, 382.0, 378.9, 354.6, 396.4, 387.4, 386.0, 365.0, 378.0, 306.20000000000005, 365.0, 356.2, 355.5, 400.0, 366.4, 379.5, 342.2, 378.0, 377.7, 356.4, 333.7, 395.5, 371.0, 364.9, 397.0, 332.0, 366.1, 351.3], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [194.6, 200.0, 178.1, 183.2, 200.0, 113.0, 182.0, 173.0, 163.1, 185.6, 188.0, 192.8, 159.2, 173.3, 178.4, 140.9, 200.0, 179.0, 194.0, 165.5, 189.8, 197.3, 191.9, 193.7, 198.2, 190.1, 195.2, 161.0, 182.9, 199.1, 167.0, 154.7, 175.7, 142.7, 200.0, 200.0, 179.0, 180.0, 164.0, 151.0, 130.0, 193.0, 159.8, 113.0, 200.0, 173.0, 186.5, 186.2, 191.0, 190.7, 191.0, 152.9, 200.0, 200.0, 141.8, 187.4, 101.0, 196.4, 177.2, 196.4, 185.0, 193.7, 94.69999999999999, 197.3, 194.3, 182.0, 164.0, 172.1, 195.5, 197.3, 200.0, 141.8, 185.6, 144.5, 192.8, 152.0, 185.0, 152.0, 171.0, 200.0, 197.0, 195.2, 191.0, 200.0, 182.0, 180.2, 179.6, 182.0, 200.0, 193.7, 193.7, 200.0, 184.7, 195.5, 173.9, 164.0, 195.5, 194.0, 200.0, 131.9, 175.4, 133.7, 200.0, 185.6, 179.0, 193.7, 180.2, 185.59999999999997, 154.7, 170.0, 191.3, 200.0, 200.0, 193.7, 197.3, 146.0, 164.0, 164.0, 198.2, 198.2, 170.0, 191.0, 183.0, 191.0, 188.3, 189.2, 180.2, 194.6, 200.0, 186.5, 198.2, 187.4, 173.0, 191.0, 158.6, 176.0, 198.2, 197.3, 194.6, 190.1, 189.2, 140.0, 198.2, 198.2, 150.2, 194.6, 173.0, 200.0, 200.0, 158.9, 175.4, 168.2, 200.0, 196.4, 191.0, 196.4, 191.0, 195.0, 179.0, 168.0, 167.0, 200.0, 178.4, 99.80000000000003, 200.0, 146.0, 154.1, 181.1, 173.0, 168.5, 200.0, 200.0, 197.3, 154.1, 182.0, 189.5, 164.0, 165.2, 200.0, 161.0, 193.7, 173.0, 167.0, 178.4, 157.7, 155.0, 200.0, 195.5, 182.0, 182.0, 188.0, 167.9, 200.0, 197.0, 130.0, 154.0, 176.0, 181.1, 149.3, 179.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 10.0, 20.0, 21.0, 9.0, 6.0, 12.0, 0.0, 0.0, 1.0, 13.0, 8.0, 2.0, 17.0, 0.0, 7.0, 10.0, 2.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 1.0, 13.0, 0.0, 0.0, 13.0, 16.0, 17.0, 7.0, 0.0, 0.0, 0.0, 6.0, 21.0, 0.0, 11.0, 12.0, 14.0, 29.0, 0.0, 9.0, 4.0, 0.0, 4.0, 0.0, 8.0, 14.0, 0.0, 0.0, 13.0, 15.0, 0.0, 33.0, 0.0, 7.0, 0.0, 5.0, 13.0, 9.0, 0.0, 6.0, 12.0, 12.0, 0.0, 0.0, 5.0, 11.0, 13.0, 1.0, 16.0, 16.0, 16.0, 11.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 9.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 7.0, 2.0, 0.0, 14.0, 7.0, 8.0, 17.0, 0.0, 0.0, 7.0, 0.0, 6.0, 0.0, 13.0, 10.0, 0.0, 2.0, 0.0, 0.0, 18.0, 0.0, 5.0, 13.0, 0.0, 0.0, 5.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 19.0, 11.0, 0.0, 0.0, 4.0, 0.0, 0.0, 9.0, 10.0, 10.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 1.0, 11.0, 0.0, 6.0, 22.0, 15.0, 4.0, 15.0, 6.0, 14.0, 0.0, 0.0, 0.0, 5.0, 10.0, 0.0, 8.0, 13.0, 0.0, 4.0, 13.0, 6.0, 5.0, 5.0, 6.0, 9.0, 12.0, 0.0, 0.0, 7.0, 0.0, 9.0, 0.0, 0.0, 0.0, 25.0, 23.0, 0.0, 9.0, 7.0, 16.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4364094577397664, "mean_inference_ms": 4.3246214831907, "mean_action_processing_ms": 0.7037485715537437, "mean_env_wait_ms": 0.4981042131547463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014741778373718262, "StateBufferConnector_ms": 0.00563967227935791, "ViewRequirementAgentConnector_ms": 0.2357792854309082}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 306.20000000000005, "episode_return_mean": 369.939, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.23683199064754, "num_env_steps_trained_throughput_per_sec": 268.23683199064754, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 1744000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1744000, "timers": {"training_iteration_time_ms": 14989.894, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14989.834, "sample_time_ms": 2589.999, "learn_time_ms": 12367.035, "learn_throughput": 323.441, "synch_weights_time_ms": 27.824}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 1744000, "num_agent_steps_trained": 1744000}, "done": false, "training_iteration": 109, "trial_id": "e4caa_00000", "date": "2024-08-13_20-21-21", "timestamp": 1723594881, "time_this_iter_s": 14.971342086791992, "time_total_s": 2213.504312992096, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b7d8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2213.504312992096, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 59.98571428571429, "ram_util_percent": 83.20476190476191}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7197658182136597, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6644084379729869, "policy_loss": -0.0064458830219264775, "vf_loss": 0.6705770768067508, "vf_explained_var": 0.25076201170209855, "kl": 0.007393143515126482, "entropy": 1.2525873738621909, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 206955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4240953317710332, "cur_kl_coeff": 5.082197683525801e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5501613931523429, "policy_loss": -0.0015024869319632964, "vf_loss": 0.5516638790863374, "vf_explained_var": 0.08779954399381365, "kl": 0.003372964183382463, "entropy": 0.12227881686988647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 206955.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 277.3, "episode_reward_mean": 369.765, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 91.4, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 33.0}, "policy_reward_mean": {"prey_policy": 179.0125, "predator_policy": 5.87}, "custom_metrics": {}, "hist_stats": {"episode_reward": [376.7, 385.7, 365.9, 400.0, 357.2, 330.4, 380.6, 383.7, 314.0, 382.3, 360.1, 392.8, 357.8, 344.1, 376.8, 364.0, 371.0, 394.2, 394.0, 371.2, 372.6, 393.7, 393.7, 380.2, 356.9, 391.5, 352.90000000000003, 334.1, 385.6, 379.7, 371.8, 347.7, 393.3, 393.7, 361.3, 346.0, 396.4, 366.0, 380.0, 377.5, 374.8, 386.5, 385.6, 373.0, 355.6, 395.5, 384.7, 359.2, 396.4, 348.8, 382.0, 378.9, 354.6, 396.4, 387.4, 386.0, 365.0, 378.0, 306.20000000000005, 365.0, 356.2, 355.5, 400.0, 366.4, 379.5, 342.2, 378.0, 377.7, 356.4, 333.7, 395.5, 371.0, 364.9, 397.0, 332.0, 366.1, 351.3, 389.2, 362.4, 358.6, 277.3, 373.0, 338.0, 395.5, 363.6, 370.8, 367.3, 360.1, 357.7, 356.7, 350.7, 378.9, 392.6, 395.5, 380.0, 396.0, 375.0, 378.40000000000015, 341.1, 358.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [186.5, 186.2, 191.0, 190.7, 191.0, 152.9, 200.0, 200.0, 141.8, 187.4, 101.0, 196.4, 177.2, 196.4, 185.0, 193.7, 94.69999999999999, 197.3, 194.3, 182.0, 164.0, 172.1, 195.5, 197.3, 200.0, 141.8, 185.6, 144.5, 192.8, 152.0, 185.0, 152.0, 171.0, 200.0, 197.0, 195.2, 191.0, 200.0, 182.0, 180.2, 179.6, 182.0, 200.0, 193.7, 193.7, 200.0, 184.7, 195.5, 173.9, 164.0, 195.5, 194.0, 200.0, 131.9, 175.4, 133.7, 200.0, 185.6, 179.0, 193.7, 180.2, 185.59999999999997, 154.7, 170.0, 191.3, 200.0, 200.0, 193.7, 197.3, 146.0, 164.0, 164.0, 198.2, 198.2, 170.0, 191.0, 183.0, 191.0, 188.3, 189.2, 180.2, 194.6, 200.0, 186.5, 198.2, 187.4, 173.0, 191.0, 158.6, 176.0, 198.2, 197.3, 194.6, 190.1, 189.2, 140.0, 198.2, 198.2, 150.2, 194.6, 173.0, 200.0, 200.0, 158.9, 175.4, 168.2, 200.0, 196.4, 191.0, 196.4, 191.0, 195.0, 179.0, 168.0, 167.0, 200.0, 178.4, 99.80000000000003, 200.0, 146.0, 154.1, 181.1, 173.0, 168.5, 200.0, 200.0, 197.3, 154.1, 182.0, 189.5, 164.0, 165.2, 200.0, 161.0, 193.7, 173.0, 167.0, 178.4, 157.7, 155.0, 200.0, 195.5, 182.0, 182.0, 188.0, 167.9, 200.0, 197.0, 130.0, 154.0, 176.0, 181.1, 149.3, 179.0, 191.0, 198.2, 160.7, 193.7, 144.2, 196.39999999999998, 91.4, 140.9, 194.3, 151.7, 161.0, 164.0, 195.5, 200.0, 153.5, 199.1, 200.0, 126.8, 188.3, 167.0, 190.1, 155.0, 191.0, 148.7, 128.3, 196.4, 136.4, 194.3, 173.6, 194.3, 195.5, 196.1, 199.1, 196.4, 200.0, 175.0, 196.0, 200.0, 165.0, 200.0, 185.0, 187.39999999999998, 155.0, 157.1, 170.0, 167.0], "policy_predator_policy_reward": [4.0, 0.0, 4.0, 0.0, 8.0, 14.0, 0.0, 0.0, 13.0, 15.0, 0.0, 33.0, 0.0, 7.0, 0.0, 5.0, 13.0, 9.0, 0.0, 6.0, 12.0, 12.0, 0.0, 0.0, 5.0, 11.0, 13.0, 1.0, 16.0, 16.0, 16.0, 11.0, 0.0, 0.0, 0.0, 2.0, 3.0, 0.0, 9.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 7.0, 2.0, 0.0, 14.0, 7.0, 8.0, 17.0, 0.0, 0.0, 7.0, 0.0, 6.0, 0.0, 13.0, 10.0, 0.0, 2.0, 0.0, 0.0, 18.0, 0.0, 5.0, 13.0, 0.0, 0.0, 5.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 19.0, 11.0, 0.0, 0.0, 4.0, 0.0, 0.0, 9.0, 10.0, 10.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 1.0, 11.0, 0.0, 6.0, 22.0, 15.0, 4.0, 15.0, 6.0, 14.0, 0.0, 0.0, 0.0, 5.0, 10.0, 0.0, 8.0, 13.0, 0.0, 4.0, 13.0, 6.0, 5.0, 5.0, 6.0, 9.0, 12.0, 0.0, 0.0, 7.0, 0.0, 9.0, 0.0, 0.0, 0.0, 25.0, 23.0, 0.0, 9.0, 7.0, 16.0, 0.0, 0.0, 0.0, 8.0, 0.0, 18.0, 16.0, 29.0, 13.0, 14.0, 0.0, 13.0, 0.0, 0.0, 0.0, 11.0, 22.0, 22.0, 11.0, 1.0, 0.0, 15.0, 15.0, 3.0, 17.0, 15.0, 0.0, 20.0, 6.0, 5.0, 0.0, 1.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 8.0, 2.0, 1.0, 5.0, 15.0, 14.0, 11.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4329658048168483, "mean_inference_ms": 4.31461680861665, "mean_action_processing_ms": 0.7131323546852384, "mean_env_wait_ms": 0.4966618188121932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0070950984954833984, "StateBufferConnector_ms": 0.005645155906677246, "ViewRequirementAgentConnector_ms": 0.20865941047668457}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 277.3, "episode_return_mean": 369.765, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.6104591144633, "num_env_steps_trained_throughput_per_sec": 287.6104591144633, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 1760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1760000, "timers": {"training_iteration_time_ms": 14763.047, "restore_workers_time_ms": 0.019, "training_step_time_ms": 14762.986, "sample_time_ms": 2574.169, "learn_time_ms": 12157.874, "learn_throughput": 329.005, "synch_weights_time_ms": 27.589}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "done": false, "training_iteration": 110, "trial_id": "e4caa_00000", "date": "2024-08-13_20-21-35", "timestamp": 1723594895, "time_this_iter_s": 13.959931135177612, "time_total_s": 2227.4642441272736, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b689d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2227.4642441272736, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 54.629999999999995, "ram_util_percent": 83.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6334450462823191, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.46038399633242216, "policy_loss": -0.0064357552602246565, "vf_loss": 0.4664922311364934, "vf_explained_var": 0.3301918298163742, "kl": 0.008733878461298349, "entropy": 1.265339542192126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 208845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4273490936115936, "cur_kl_coeff": 2.5410988417629005e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3648717617625913, "policy_loss": -0.002402058905778975, "vf_loss": 0.36727382029608757, "vf_explained_var": 0.16365972602808918, "kl": 0.002359418596570382, "entropy": 0.13085331502099518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 208845.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 277.3, "episode_reward_mean": 369.441, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 91.4, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 29.0}, "policy_reward_mean": {"prey_policy": 179.00549999999998, "predator_policy": 5.715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [394.0, 371.2, 372.6, 393.7, 393.7, 380.2, 356.9, 391.5, 352.90000000000003, 334.1, 385.6, 379.7, 371.8, 347.7, 393.3, 393.7, 361.3, 346.0, 396.4, 366.0, 380.0, 377.5, 374.8, 386.5, 385.6, 373.0, 355.6, 395.5, 384.7, 359.2, 396.4, 348.8, 382.0, 378.9, 354.6, 396.4, 387.4, 386.0, 365.0, 378.0, 306.20000000000005, 365.0, 356.2, 355.5, 400.0, 366.4, 379.5, 342.2, 378.0, 377.7, 356.4, 333.7, 395.5, 371.0, 364.9, 397.0, 332.0, 366.1, 351.3, 389.2, 362.4, 358.6, 277.3, 373.0, 338.0, 395.5, 363.6, 370.8, 367.3, 360.1, 357.7, 356.7, 350.7, 378.9, 392.6, 395.5, 380.0, 396.0, 375.0, 378.40000000000015, 341.1, 358.0, 373.2, 377.4, 333.0, 363.4, 362.6, 327.2, 381.1, 386.1, 384.7, 378.4, 370.6, 357.7, 395.5, 357.9, 328.0, 367.0, 365.6, 395.5], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [191.0, 200.0, 182.0, 180.2, 179.6, 182.0, 200.0, 193.7, 193.7, 200.0, 184.7, 195.5, 173.9, 164.0, 195.5, 194.0, 200.0, 131.9, 175.4, 133.7, 200.0, 185.6, 179.0, 193.7, 180.2, 185.59999999999997, 154.7, 170.0, 191.3, 200.0, 200.0, 193.7, 197.3, 146.0, 164.0, 164.0, 198.2, 198.2, 170.0, 191.0, 183.0, 191.0, 188.3, 189.2, 180.2, 194.6, 200.0, 186.5, 198.2, 187.4, 173.0, 191.0, 158.6, 176.0, 198.2, 197.3, 194.6, 190.1, 189.2, 140.0, 198.2, 198.2, 150.2, 194.6, 173.0, 200.0, 200.0, 158.9, 175.4, 168.2, 200.0, 196.4, 191.0, 196.4, 191.0, 195.0, 179.0, 168.0, 167.0, 200.0, 178.4, 99.80000000000003, 200.0, 146.0, 154.1, 181.1, 173.0, 168.5, 200.0, 200.0, 197.3, 154.1, 182.0, 189.5, 164.0, 165.2, 200.0, 161.0, 193.7, 173.0, 167.0, 178.4, 157.7, 155.0, 200.0, 195.5, 182.0, 182.0, 188.0, 167.9, 200.0, 197.0, 130.0, 154.0, 176.0, 181.1, 149.3, 179.0, 191.0, 198.2, 160.7, 193.7, 144.2, 196.39999999999998, 91.4, 140.9, 194.3, 151.7, 161.0, 164.0, 195.5, 200.0, 153.5, 199.1, 200.0, 126.8, 188.3, 167.0, 190.1, 155.0, 191.0, 148.7, 128.3, 196.4, 136.4, 194.3, 173.6, 194.3, 195.5, 196.1, 199.1, 196.4, 200.0, 175.0, 196.0, 200.0, 165.0, 200.0, 185.0, 187.39999999999998, 155.0, 157.1, 170.0, 167.0, 189.2, 173.0, 191.9, 180.5, 121.4, 176.6, 196.4, 155.0, 172.7, 182.9, 112.1, 175.1, 193.7, 187.4, 197.3, 186.8, 187.4, 197.3, 178.4, 200.0, 199.1, 159.5, 193.7, 146.0, 196.4, 199.1, 137.9, 200.0, 134.0, 167.0, 155.0, 196.0, 182.6, 173.0, 197.3, 198.2], "policy_predator_policy_reward": [3.0, 0.0, 9.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 7.0, 2.0, 0.0, 14.0, 7.0, 8.0, 17.0, 0.0, 0.0, 7.0, 0.0, 6.0, 0.0, 13.0, 10.0, 0.0, 2.0, 0.0, 0.0, 18.0, 0.0, 5.0, 13.0, 0.0, 0.0, 5.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 19.0, 11.0, 0.0, 0.0, 4.0, 0.0, 0.0, 9.0, 10.0, 10.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 1.0, 11.0, 0.0, 6.0, 22.0, 15.0, 4.0, 15.0, 6.0, 14.0, 0.0, 0.0, 0.0, 5.0, 10.0, 0.0, 8.0, 13.0, 0.0, 4.0, 13.0, 6.0, 5.0, 5.0, 6.0, 9.0, 12.0, 0.0, 0.0, 7.0, 0.0, 9.0, 0.0, 0.0, 0.0, 25.0, 23.0, 0.0, 9.0, 7.0, 16.0, 0.0, 0.0, 0.0, 8.0, 0.0, 18.0, 16.0, 29.0, 13.0, 14.0, 0.0, 13.0, 0.0, 0.0, 0.0, 11.0, 22.0, 22.0, 11.0, 1.0, 0.0, 15.0, 15.0, 3.0, 17.0, 15.0, 0.0, 20.0, 6.0, 5.0, 0.0, 1.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 8.0, 2.0, 1.0, 5.0, 15.0, 14.0, 11.0, 10.0, 11.0, 0.0, 5.0, 0.0, 14.0, 21.0, 0.0, 12.0, 7.0, 0.0, 26.0, 14.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 18.0, 0.0, 0.0, 0.0, 8.0, 12.0, 20.0, 7.0, 15.0, 1.0, 0.0, 10.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4299631507517307, "mean_inference_ms": 4.305815693617372, "mean_action_processing_ms": 0.7112333504102952, "mean_env_wait_ms": 0.4955026746524259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008503913879394531, "StateBufferConnector_ms": 0.005711197853088379, "ViewRequirementAgentConnector_ms": 0.1923387050628662}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 277.3, "episode_return_mean": 369.441, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 148.40019712373214, "num_env_steps_trained_throughput_per_sec": 148.40019712373214, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 1776000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1776000, "timers": {"training_iteration_time_ms": 15629.367, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15629.308, "sample_time_ms": 2511.176, "learn_time_ms": 13088.993, "learn_throughput": 305.6, "synch_weights_time_ms": 26.195}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 1776000, "num_agent_steps_trained": 1776000}, "done": false, "training_iteration": 111, "trial_id": "e4caa_00000", "date": "2024-08-13_20-22-02", "timestamp": 1723594922, "time_this_iter_s": 27.03023886680603, "time_total_s": 2254.4944829940796, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b68af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2254.4944829940796, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 79.825, "ram_util_percent": 84.171875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5435879493989642, "cur_kl_coeff": 0.03749999999999999, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.44544827881615323, "policy_loss": -0.0032924665586539993, "vf_loss": 0.4485699103489794, "vf_explained_var": 0.33366830263819014, "kl": 0.004555631221602299, "entropy": 1.2732885765020179, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 210735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2791594300241698, "cur_kl_coeff": 1.2705494208814502e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.28148987122156, "policy_loss": -0.0030392249655619105, "vf_loss": 0.28452909622740535, "vf_explained_var": 0.13292653891775344, "kl": 0.006327252838868721, "entropy": 0.163274103052244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 210735.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 277.3, "episode_reward_mean": 369.2209999999999, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 91.4, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 29.0}, "policy_reward_mean": {"prey_policy": 178.74050000000003, "predator_policy": 5.87}, "custom_metrics": {}, "hist_stats": {"episode_reward": [374.8, 386.5, 385.6, 373.0, 355.6, 395.5, 384.7, 359.2, 396.4, 348.8, 382.0, 378.9, 354.6, 396.4, 387.4, 386.0, 365.0, 378.0, 306.20000000000005, 365.0, 356.2, 355.5, 400.0, 366.4, 379.5, 342.2, 378.0, 377.7, 356.4, 333.7, 395.5, 371.0, 364.9, 397.0, 332.0, 366.1, 351.3, 389.2, 362.4, 358.6, 277.3, 373.0, 338.0, 395.5, 363.6, 370.8, 367.3, 360.1, 357.7, 356.7, 350.7, 378.9, 392.6, 395.5, 380.0, 396.0, 375.0, 378.40000000000015, 341.1, 358.0, 373.2, 377.4, 333.0, 363.4, 362.6, 327.2, 381.1, 386.1, 384.7, 378.4, 370.6, 357.7, 395.5, 357.9, 328.0, 367.0, 365.6, 395.5, 370.9, 366.5, 385.7, 351.1, 392.6, 391.9, 381.0, 351.0, 369.0, 378.7, 375.4, 368.3, 383.3, 393.7, 385.9, 376.0, 355.0, 362.7, 365.0, 368.0, 381.4, 364.7], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [180.2, 194.6, 200.0, 186.5, 198.2, 187.4, 173.0, 191.0, 158.6, 176.0, 198.2, 197.3, 194.6, 190.1, 189.2, 140.0, 198.2, 198.2, 150.2, 194.6, 173.0, 200.0, 200.0, 158.9, 175.4, 168.2, 200.0, 196.4, 191.0, 196.4, 191.0, 195.0, 179.0, 168.0, 167.0, 200.0, 178.4, 99.80000000000003, 200.0, 146.0, 154.1, 181.1, 173.0, 168.5, 200.0, 200.0, 197.3, 154.1, 182.0, 189.5, 164.0, 165.2, 200.0, 161.0, 193.7, 173.0, 167.0, 178.4, 157.7, 155.0, 200.0, 195.5, 182.0, 182.0, 188.0, 167.9, 200.0, 197.0, 130.0, 154.0, 176.0, 181.1, 149.3, 179.0, 191.0, 198.2, 160.7, 193.7, 144.2, 196.39999999999998, 91.4, 140.9, 194.3, 151.7, 161.0, 164.0, 195.5, 200.0, 153.5, 199.1, 200.0, 126.8, 188.3, 167.0, 190.1, 155.0, 191.0, 148.7, 128.3, 196.4, 136.4, 194.3, 173.6, 194.3, 195.5, 196.1, 199.1, 196.4, 200.0, 175.0, 196.0, 200.0, 165.0, 200.0, 185.0, 187.39999999999998, 155.0, 157.1, 170.0, 167.0, 189.2, 173.0, 191.9, 180.5, 121.4, 176.6, 196.4, 155.0, 172.7, 182.9, 112.1, 175.1, 193.7, 187.4, 197.3, 186.8, 187.4, 197.3, 178.4, 200.0, 199.1, 159.5, 193.7, 146.0, 196.4, 199.1, 137.9, 200.0, 134.0, 167.0, 155.0, 196.0, 182.6, 173.0, 197.3, 198.2, 187.4, 174.5, 183.2, 173.3, 193.7, 179.0, 122.0, 196.1, 200.0, 191.6, 196.4, 195.5, 177.8, 198.2, 167.0, 170.0, 158.6, 196.4, 175.7, 200.0, 177.5, 191.9, 178.1, 180.2, 197.0, 179.3, 196.4, 197.3, 187.4, 195.5, 196.4, 176.6, 173.9, 172.1, 184.7, 167.0, 150.0, 200.0, 200.0, 165.0, 189.2, 186.2, 149.0, 184.7], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 19.0, 11.0, 0.0, 0.0, 4.0, 0.0, 0.0, 9.0, 10.0, 10.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 17.0, 1.0, 11.0, 0.0, 6.0, 22.0, 15.0, 4.0, 15.0, 6.0, 14.0, 0.0, 0.0, 0.0, 5.0, 10.0, 0.0, 8.0, 13.0, 0.0, 4.0, 13.0, 6.0, 5.0, 5.0, 6.0, 9.0, 12.0, 0.0, 0.0, 7.0, 0.0, 9.0, 0.0, 0.0, 0.0, 25.0, 23.0, 0.0, 9.0, 7.0, 16.0, 0.0, 0.0, 0.0, 8.0, 0.0, 18.0, 16.0, 29.0, 13.0, 14.0, 0.0, 13.0, 0.0, 0.0, 0.0, 11.0, 22.0, 22.0, 11.0, 1.0, 0.0, 15.0, 15.0, 3.0, 17.0, 15.0, 0.0, 20.0, 6.0, 5.0, 0.0, 1.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 8.0, 2.0, 1.0, 5.0, 15.0, 14.0, 11.0, 10.0, 11.0, 0.0, 5.0, 0.0, 14.0, 21.0, 0.0, 12.0, 7.0, 0.0, 26.0, 14.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 18.0, 0.0, 0.0, 0.0, 8.0, 12.0, 20.0, 7.0, 15.0, 1.0, 0.0, 10.0, 0.0, 0.0, 2.0, 7.0, 0.0, 10.0, 6.0, 7.0, 17.0, 16.0, 1.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 4.0, 9.0, 5.0, 3.0, 0.0, 6.0, 0.0, 7.0, 3.0, 1.0, 6.0, 0.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 9.0, 0.0, 11.0, 0.0, 15.0, 0.0, 3.0, 2.0, 4.0, 14.0, 17.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.426036449776656, "mean_inference_ms": 4.29404043968219, "mean_action_processing_ms": 0.7081408896143627, "mean_env_wait_ms": 0.4940762182256171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007831692695617676, "StateBufferConnector_ms": 0.007177948951721191, "ViewRequirementAgentConnector_ms": 0.1843174695968628}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 277.3, "episode_return_mean": 369.2209999999999, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.8943618737482, "num_env_steps_trained_throughput_per_sec": 268.8943618737482, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 1792000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1792000, "timers": {"training_iteration_time_ms": 15708.973, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15708.913, "sample_time_ms": 2506.197, "learn_time_ms": 13173.186, "learn_throughput": 303.647, "synch_weights_time_ms": 26.366}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 1792000, "num_agent_steps_trained": 1792000}, "done": false, "training_iteration": 112, "trial_id": "e4caa_00000", "date": "2024-08-13_20-22-17", "timestamp": 1723594937, "time_this_iter_s": 14.9447660446167, "time_total_s": 2269.4392490386963, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b88e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2269.4392490386963, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 61.4818181818182, "ram_util_percent": 83.88636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8886486344867282, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6872029906636469, "policy_loss": -0.009533746760442025, "vf_loss": 0.6964805232035736, "vf_explained_var": 0.30763814849828286, "kl": 0.013664720846222065, "entropy": 1.21417779916178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 212625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.375952467826939, "cur_kl_coeff": 1.2705494208814502e-22, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.425782242732704, "policy_loss": -0.0017477921481249194, "vf_loss": 0.42753003468076706, "vf_explained_var": 0.09355869958640406, "kl": 0.0036726841648428697, "entropy": 0.16713168739326417, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 212625.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 277.3, "episode_reward_mean": 366.902, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 91.4, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 29.0}, "policy_reward_mean": {"prey_policy": 177.18599999999998, "predator_policy": 6.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [306.20000000000005, 365.0, 356.2, 355.5, 400.0, 366.4, 379.5, 342.2, 378.0, 377.7, 356.4, 333.7, 395.5, 371.0, 364.9, 397.0, 332.0, 366.1, 351.3, 389.2, 362.4, 358.6, 277.3, 373.0, 338.0, 395.5, 363.6, 370.8, 367.3, 360.1, 357.7, 356.7, 350.7, 378.9, 392.6, 395.5, 380.0, 396.0, 375.0, 378.40000000000015, 341.1, 358.0, 373.2, 377.4, 333.0, 363.4, 362.6, 327.2, 381.1, 386.1, 384.7, 378.4, 370.6, 357.7, 395.5, 357.9, 328.0, 367.0, 365.6, 395.5, 370.9, 366.5, 385.7, 351.1, 392.6, 391.9, 381.0, 351.0, 369.0, 378.7, 375.4, 368.3, 383.3, 393.7, 385.9, 376.0, 355.0, 362.7, 365.0, 368.0, 381.4, 364.7, 359.1, 367.0, 358.8, 334.7, 359.5, 353.4, 388.3, 339.2, 379.8, 374.6, 381.1, 349.6, 347.4, 384.7, 368.0, 381.0, 394.6, 335.7], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [178.4, 99.80000000000003, 200.0, 146.0, 154.1, 181.1, 173.0, 168.5, 200.0, 200.0, 197.3, 154.1, 182.0, 189.5, 164.0, 165.2, 200.0, 161.0, 193.7, 173.0, 167.0, 178.4, 157.7, 155.0, 200.0, 195.5, 182.0, 182.0, 188.0, 167.9, 200.0, 197.0, 130.0, 154.0, 176.0, 181.1, 149.3, 179.0, 191.0, 198.2, 160.7, 193.7, 144.2, 196.39999999999998, 91.4, 140.9, 194.3, 151.7, 161.0, 164.0, 195.5, 200.0, 153.5, 199.1, 200.0, 126.8, 188.3, 167.0, 190.1, 155.0, 191.0, 148.7, 128.3, 196.4, 136.4, 194.3, 173.6, 194.3, 195.5, 196.1, 199.1, 196.4, 200.0, 175.0, 196.0, 200.0, 165.0, 200.0, 185.0, 187.39999999999998, 155.0, 157.1, 170.0, 167.0, 189.2, 173.0, 191.9, 180.5, 121.4, 176.6, 196.4, 155.0, 172.7, 182.9, 112.1, 175.1, 193.7, 187.4, 197.3, 186.8, 187.4, 197.3, 178.4, 200.0, 199.1, 159.5, 193.7, 146.0, 196.4, 199.1, 137.9, 200.0, 134.0, 167.0, 155.0, 196.0, 182.6, 173.0, 197.3, 198.2, 187.4, 174.5, 183.2, 173.3, 193.7, 179.0, 122.0, 196.1, 200.0, 191.6, 196.4, 195.5, 177.8, 198.2, 167.0, 170.0, 158.6, 196.4, 175.7, 200.0, 177.5, 191.9, 178.1, 180.2, 197.0, 179.3, 196.4, 197.3, 187.4, 195.5, 196.4, 176.6, 173.9, 172.1, 184.7, 167.0, 150.0, 200.0, 200.0, 165.0, 189.2, 186.2, 149.0, 184.7, 184.1, 155.0, 155.0, 185.0, 159.8, 182.0, 158.0, 157.7, 151.4, 193.1, 200.0, 136.4, 195.5, 192.8, 159.2, 158.0, 191.0, 186.8, 194.6, 170.0, 193.7, 187.4, 166.7, 170.9, 129.2, 198.2, 189.2, 195.5, 190.0, 167.0, 183.0, 198.0, 194.6, 200.0, 137.0, 178.7], "policy_predator_policy_reward": [6.0, 22.0, 15.0, 4.0, 15.0, 6.0, 14.0, 0.0, 0.0, 0.0, 5.0, 10.0, 0.0, 8.0, 13.0, 0.0, 4.0, 13.0, 6.0, 5.0, 5.0, 6.0, 9.0, 12.0, 0.0, 0.0, 7.0, 0.0, 9.0, 0.0, 0.0, 0.0, 25.0, 23.0, 0.0, 9.0, 7.0, 16.0, 0.0, 0.0, 0.0, 8.0, 0.0, 18.0, 16.0, 29.0, 13.0, 14.0, 0.0, 13.0, 0.0, 0.0, 0.0, 11.0, 22.0, 22.0, 11.0, 1.0, 0.0, 15.0, 15.0, 3.0, 17.0, 15.0, 0.0, 20.0, 6.0, 5.0, 0.0, 1.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 8.0, 2.0, 1.0, 5.0, 15.0, 14.0, 11.0, 10.0, 11.0, 0.0, 5.0, 0.0, 14.0, 21.0, 0.0, 12.0, 7.0, 0.0, 26.0, 14.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 18.0, 0.0, 0.0, 0.0, 8.0, 12.0, 20.0, 7.0, 15.0, 1.0, 0.0, 10.0, 0.0, 0.0, 2.0, 7.0, 0.0, 10.0, 6.0, 7.0, 17.0, 16.0, 1.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 4.0, 9.0, 5.0, 3.0, 0.0, 6.0, 0.0, 7.0, 3.0, 1.0, 6.0, 0.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 9.0, 0.0, 11.0, 0.0, 15.0, 0.0, 3.0, 2.0, 4.0, 14.0, 17.0, 15.0, 5.0, 15.0, 12.0, 0.0, 17.0, 0.0, 19.0, 14.0, 1.0, 0.0, 17.0, 0.0, 0.0, 9.0, 13.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 20.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 2.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.421970098105013, "mean_inference_ms": 4.28145291441119, "mean_action_processing_ms": 0.7051791637663658, "mean_env_wait_ms": 0.49256884461366357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007472634315490723, "StateBufferConnector_ms": 0.005464315414428711, "ViewRequirementAgentConnector_ms": 0.14879274368286133}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 277.3, "episode_return_mean": 366.902, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.3949176316409, "num_env_steps_trained_throughput_per_sec": 268.3949176316409, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 1808000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1808000, "timers": {"training_iteration_time_ms": 15829.948, "restore_workers_time_ms": 0.02, "training_step_time_ms": 15829.886, "sample_time_ms": 2624.014, "learn_time_ms": 13181.601, "learn_throughput": 303.453, "synch_weights_time_ms": 21.055}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 1808000, "num_agent_steps_trained": 1808000}, "done": false, "training_iteration": 113, "trial_id": "e4caa_00000", "date": "2024-08-13_20-22-32", "timestamp": 1723594952, "time_this_iter_s": 14.963886022567749, "time_total_s": 2284.403135061264, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b685e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2284.403135061264, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 61.02857142857143, "ram_util_percent": 83.21428571428571}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5882377758385644, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5468714412291924, "policy_loss": -0.0063938823685040155, "vf_loss": 0.552986378967762, "vf_explained_var": 0.3202138628909197, "kl": 0.014877195965937768, "entropy": 1.2378385721691072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 214515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2846320241137787, "cur_kl_coeff": 6.352747104407251e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4468075769840094, "policy_loss": -0.003337098501632532, "vf_loss": 0.4501446748960507, "vf_explained_var": 0.13267452436149435, "kl": 0.0033926901210970376, "entropy": 0.1141260168539784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 214515.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "env_runners": {"episode_reward_max": 399.1, "episode_reward_min": 307.9, "episode_reward_mean": 368.41200000000003, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 112.1, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 26.0}, "policy_reward_mean": {"prey_policy": 178.076, "predator_policy": 6.13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [373.0, 338.0, 395.5, 363.6, 370.8, 367.3, 360.1, 357.7, 356.7, 350.7, 378.9, 392.6, 395.5, 380.0, 396.0, 375.0, 378.40000000000015, 341.1, 358.0, 373.2, 377.4, 333.0, 363.4, 362.6, 327.2, 381.1, 386.1, 384.7, 378.4, 370.6, 357.7, 395.5, 357.9, 328.0, 367.0, 365.6, 395.5, 370.9, 366.5, 385.7, 351.1, 392.6, 391.9, 381.0, 351.0, 369.0, 378.7, 375.4, 368.3, 383.3, 393.7, 385.9, 376.0, 355.0, 362.7, 365.0, 368.0, 381.4, 364.7, 359.1, 367.0, 358.8, 334.7, 359.5, 353.4, 388.3, 339.2, 379.8, 374.6, 381.1, 349.6, 347.4, 384.7, 368.0, 381.0, 394.6, 335.7, 349.0, 382.9, 330.7, 399.1, 381.1, 395.5, 379.8, 362.6, 344.9, 307.9, 370.1, 383.8, 348.8, 378.0, 376.3, 353.9, 333.3, 380.0, 347.0, 378.0, 374.9, 397.3, 378.2], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [194.3, 151.7, 161.0, 164.0, 195.5, 200.0, 153.5, 199.1, 200.0, 126.8, 188.3, 167.0, 190.1, 155.0, 191.0, 148.7, 128.3, 196.4, 136.4, 194.3, 173.6, 194.3, 195.5, 196.1, 199.1, 196.4, 200.0, 175.0, 196.0, 200.0, 165.0, 200.0, 185.0, 187.39999999999998, 155.0, 157.1, 170.0, 167.0, 189.2, 173.0, 191.9, 180.5, 121.4, 176.6, 196.4, 155.0, 172.7, 182.9, 112.1, 175.1, 193.7, 187.4, 197.3, 186.8, 187.4, 197.3, 178.4, 200.0, 199.1, 159.5, 193.7, 146.0, 196.4, 199.1, 137.9, 200.0, 134.0, 167.0, 155.0, 196.0, 182.6, 173.0, 197.3, 198.2, 187.4, 174.5, 183.2, 173.3, 193.7, 179.0, 122.0, 196.1, 200.0, 191.6, 196.4, 195.5, 177.8, 198.2, 167.0, 170.0, 158.6, 196.4, 175.7, 200.0, 177.5, 191.9, 178.1, 180.2, 197.0, 179.3, 196.4, 197.3, 187.4, 195.5, 196.4, 176.6, 173.9, 172.1, 184.7, 167.0, 150.0, 200.0, 200.0, 165.0, 189.2, 186.2, 149.0, 184.7, 184.1, 155.0, 155.0, 185.0, 159.8, 182.0, 158.0, 157.7, 151.4, 193.1, 200.0, 136.4, 195.5, 192.8, 159.2, 158.0, 191.0, 186.8, 194.6, 170.0, 193.7, 187.4, 166.7, 170.9, 129.2, 198.2, 189.2, 195.5, 190.0, 167.0, 183.0, 198.0, 194.6, 200.0, 137.0, 178.7, 155.0, 179.0, 182.0, 191.9, 135.2, 165.5, 199.1, 200.0, 189.2, 191.9, 200.0, 195.5, 188.6, 189.2, 152.0, 194.6, 189.2, 136.70000000000002, 150.5, 133.4, 136.1, 200.0, 188.3, 195.5, 171.8, 161.0, 185.0, 185.0, 166.1, 198.2, 155.9, 179.0, 177.5, 126.80000000000001, 190.0, 190.0, 137.0, 163.0, 200.0, 169.0, 194.0, 164.9, 197.3, 200.0, 167.0, 198.2], "policy_predator_policy_reward": [13.0, 14.0, 0.0, 13.0, 0.0, 0.0, 0.0, 11.0, 22.0, 22.0, 11.0, 1.0, 0.0, 15.0, 15.0, 3.0, 17.0, 15.0, 0.0, 20.0, 6.0, 5.0, 0.0, 1.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 8.0, 2.0, 1.0, 5.0, 15.0, 14.0, 11.0, 10.0, 11.0, 0.0, 5.0, 0.0, 14.0, 21.0, 0.0, 12.0, 7.0, 0.0, 26.0, 14.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 18.0, 0.0, 0.0, 0.0, 8.0, 12.0, 20.0, 7.0, 15.0, 1.0, 0.0, 10.0, 0.0, 0.0, 2.0, 7.0, 0.0, 10.0, 6.0, 7.0, 17.0, 16.0, 1.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 4.0, 9.0, 5.0, 3.0, 0.0, 6.0, 0.0, 7.0, 3.0, 1.0, 6.0, 0.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 9.0, 0.0, 11.0, 0.0, 15.0, 0.0, 3.0, 2.0, 4.0, 14.0, 17.0, 15.0, 5.0, 15.0, 12.0, 0.0, 17.0, 0.0, 19.0, 14.0, 1.0, 0.0, 17.0, 0.0, 0.0, 9.0, 13.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 20.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 2.0, 18.0, 15.0, 0.0, 3.0, 6.0, 19.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 16.0, 0.0, 19.0, 0.0, 14.0, 10.0, 13.0, 21.0, 0.0, 0.0, 3.0, 13.0, 0.0, 8.0, 1.0, 11.0, 7.0, 12.0, 13.0, 16.0, 0.0, 0.0, 26.0, 21.0, 9.0, 0.0, 7.0, 9.0, 0.0, 0.0, 2.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4128257408002967, "mean_inference_ms": 4.254556693262587, "mean_action_processing_ms": 0.7018864704811686, "mean_env_wait_ms": 0.49066684470481753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008993148803710938, "StateBufferConnector_ms": 0.005335688591003418, "ViewRequirementAgentConnector_ms": 0.14470338821411133}, "num_episodes": 23, "episode_return_max": 399.1, "episode_return_min": 307.9, "episode_return_mean": 368.41200000000003, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.40883213938366, "num_env_steps_trained_throughput_per_sec": 291.40883213938366, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 1824000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1824000, "timers": {"training_iteration_time_ms": 15865.971, "restore_workers_time_ms": 0.018, "training_step_time_ms": 15865.913, "sample_time_ms": 2596.084, "learn_time_ms": 13246.783, "learn_throughput": 301.96, "synch_weights_time_ms": 19.747}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 1824000, "num_agent_steps_trained": 1824000}, "done": false, "training_iteration": 114, "trial_id": "e4caa_00000", "date": "2024-08-13_20-22-46", "timestamp": 1723594966, "time_this_iter_s": 13.771343231201172, "time_total_s": 2298.174478292465, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b3ba60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2298.174478292465, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 57.43157894736842, "ram_util_percent": 83.14736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7888141470296042, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5715674952157925, "policy_loss": -0.007202110439046192, "vf_loss": 0.5786055323091291, "vf_explained_var": 0.3997950324305782, "kl": 0.008750517717009947, "entropy": 1.2518535520033862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 216405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1106927470713066, "cur_kl_coeff": 3.1763735522036256e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.46675478169527, "policy_loss": -0.0009104394319432753, "vf_loss": 0.4676652215657726, "vf_explained_var": 0.14694646004015807, "kl": 0.0019555470551533586, "entropy": 0.057575864158570765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 216405.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 307.9, "episode_reward_mean": 367.73999999999995, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 112.1, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 26.0}, "policy_reward_mean": {"prey_policy": 177.935, "predator_policy": 5.935}, "custom_metrics": {}, "hist_stats": {"episode_reward": [358.0, 373.2, 377.4, 333.0, 363.4, 362.6, 327.2, 381.1, 386.1, 384.7, 378.4, 370.6, 357.7, 395.5, 357.9, 328.0, 367.0, 365.6, 395.5, 370.9, 366.5, 385.7, 351.1, 392.6, 391.9, 381.0, 351.0, 369.0, 378.7, 375.4, 368.3, 383.3, 393.7, 385.9, 376.0, 355.0, 362.7, 365.0, 368.0, 381.4, 364.7, 359.1, 367.0, 358.8, 334.7, 359.5, 353.4, 388.3, 339.2, 379.8, 374.6, 381.1, 349.6, 347.4, 384.7, 368.0, 381.0, 394.6, 335.7, 349.0, 382.9, 330.7, 399.1, 381.1, 395.5, 379.8, 362.6, 344.9, 307.9, 370.1, 383.8, 348.8, 378.0, 376.3, 353.9, 333.3, 380.0, 347.0, 378.0, 374.9, 397.3, 378.2, 351.6, 398.0, 383.7, 358.5, 328.8, 354.1, 400.0, 390.1, 353.2, 388.3, 330.8, 360.2, 399.1, 356.5, 385.0, 369.0, 357.6, 339.2], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [170.0, 167.0, 189.2, 173.0, 191.9, 180.5, 121.4, 176.6, 196.4, 155.0, 172.7, 182.9, 112.1, 175.1, 193.7, 187.4, 197.3, 186.8, 187.4, 197.3, 178.4, 200.0, 199.1, 159.5, 193.7, 146.0, 196.4, 199.1, 137.9, 200.0, 134.0, 167.0, 155.0, 196.0, 182.6, 173.0, 197.3, 198.2, 187.4, 174.5, 183.2, 173.3, 193.7, 179.0, 122.0, 196.1, 200.0, 191.6, 196.4, 195.5, 177.8, 198.2, 167.0, 170.0, 158.6, 196.4, 175.7, 200.0, 177.5, 191.9, 178.1, 180.2, 197.0, 179.3, 196.4, 197.3, 187.4, 195.5, 196.4, 176.6, 173.9, 172.1, 184.7, 167.0, 150.0, 200.0, 200.0, 165.0, 189.2, 186.2, 149.0, 184.7, 184.1, 155.0, 155.0, 185.0, 159.8, 182.0, 158.0, 157.7, 151.4, 193.1, 200.0, 136.4, 195.5, 192.8, 159.2, 158.0, 191.0, 186.8, 194.6, 170.0, 193.7, 187.4, 166.7, 170.9, 129.2, 198.2, 189.2, 195.5, 190.0, 167.0, 183.0, 198.0, 194.6, 200.0, 137.0, 178.7, 155.0, 179.0, 182.0, 191.9, 135.2, 165.5, 199.1, 200.0, 189.2, 191.9, 200.0, 195.5, 188.6, 189.2, 152.0, 194.6, 189.2, 136.70000000000002, 150.5, 133.4, 136.1, 200.0, 188.3, 195.5, 171.8, 161.0, 185.0, 185.0, 166.1, 198.2, 155.9, 179.0, 177.5, 126.80000000000001, 190.0, 190.0, 137.0, 163.0, 200.0, 169.0, 194.0, 164.9, 197.3, 200.0, 167.0, 198.2, 171.2, 163.4, 200.0, 197.0, 193.7, 185.0, 155.3, 189.2, 141.5, 155.3, 170.0, 157.1, 200.0, 200.0, 190.1, 200.0, 200.0, 135.2, 189.2, 199.1, 181.1, 124.7, 150.8, 190.4, 200.0, 199.1, 153.2, 197.3, 197.0, 179.0, 181.0, 182.0, 173.6, 164.0, 132.2, 191.0], "policy_predator_policy_reward": [11.0, 10.0, 11.0, 0.0, 5.0, 0.0, 14.0, 21.0, 0.0, 12.0, 7.0, 0.0, 26.0, 14.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 18.0, 0.0, 0.0, 0.0, 8.0, 12.0, 20.0, 7.0, 15.0, 1.0, 0.0, 10.0, 0.0, 0.0, 2.0, 7.0, 0.0, 10.0, 6.0, 7.0, 17.0, 16.0, 1.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 4.0, 9.0, 5.0, 3.0, 0.0, 6.0, 0.0, 7.0, 3.0, 1.0, 6.0, 0.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 9.0, 0.0, 11.0, 0.0, 15.0, 0.0, 3.0, 2.0, 4.0, 14.0, 17.0, 15.0, 5.0, 15.0, 12.0, 0.0, 17.0, 0.0, 19.0, 14.0, 1.0, 0.0, 17.0, 0.0, 0.0, 9.0, 13.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 20.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 2.0, 18.0, 15.0, 0.0, 3.0, 6.0, 19.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 16.0, 0.0, 19.0, 0.0, 14.0, 10.0, 13.0, 21.0, 0.0, 0.0, 3.0, 13.0, 0.0, 8.0, 1.0, 11.0, 7.0, 12.0, 13.0, 16.0, 0.0, 0.0, 26.0, 21.0, 9.0, 0.0, 7.0, 9.0, 0.0, 0.0, 2.0, 11.0, 8.0, 9.0, 1.0, 0.0, 0.0, 5.0, 11.0, 3.0, 18.0, 14.0, 21.0, 6.0, 0.0, 0.0, 0.0, 0.0, 14.0, 4.0, 0.0, 0.0, 10.0, 15.0, 10.0, 9.0, 0.0, 0.0, 0.0, 6.0, 2.0, 7.0, 1.0, 5.0, 13.0, 7.0, 0.0, 16.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4114404878766147, "mean_inference_ms": 4.249010838729819, "mean_action_processing_ms": 0.6982322858419469, "mean_env_wait_ms": 0.48887164189523075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008686423301696777, "StateBufferConnector_ms": 0.005296111106872559, "ViewRequirementAgentConnector_ms": 0.12840068340301514}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 307.9, "episode_return_mean": 367.73999999999995, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 210.36045176121542, "num_env_steps_trained_throughput_per_sec": 210.36045176121542, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 1840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1840000, "timers": {"training_iteration_time_ms": 16434.155, "restore_workers_time_ms": 0.018, "training_step_time_ms": 16434.097, "sample_time_ms": 2521.225, "learn_time_ms": 13889.882, "learn_throughput": 287.979, "synch_weights_time_ms": 19.826}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "done": false, "training_iteration": 115, "trial_id": "e4caa_00000", "date": "2024-08-13_20-23-05", "timestamp": 1723594985, "time_this_iter_s": 19.06903100013733, "time_total_s": 2317.2435092926025, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29c13a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2317.2435092926025, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 73.08888888888889, "ram_util_percent": 83.97777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.574068709277602, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6551260506325258, "policy_loss": -0.008876320561665116, "vf_loss": 0.6637464073393001, "vf_explained_var": 0.40959644806448114, "kl": 0.013651453286885783, "entropy": 1.2327669549240636, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 218295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8801552110405826, "cur_kl_coeff": 1.5881867761018128e-23, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.53797771946463, "policy_loss": -0.0012813200407893097, "vf_loss": 0.5392590388813346, "vf_explained_var": 0.15668390708625632, "kl": 0.0018893855566786244, "entropy": 0.057830169041044814, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 218295.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 307.9, "episode_reward_mean": 367.31699999999995, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 106.10000000000002, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 26.0}, "policy_reward_mean": {"prey_policy": 177.6985, "predator_policy": 5.96}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.1, 392.6, 391.9, 381.0, 351.0, 369.0, 378.7, 375.4, 368.3, 383.3, 393.7, 385.9, 376.0, 355.0, 362.7, 365.0, 368.0, 381.4, 364.7, 359.1, 367.0, 358.8, 334.7, 359.5, 353.4, 388.3, 339.2, 379.8, 374.6, 381.1, 349.6, 347.4, 384.7, 368.0, 381.0, 394.6, 335.7, 349.0, 382.9, 330.7, 399.1, 381.1, 395.5, 379.8, 362.6, 344.9, 307.9, 370.1, 383.8, 348.8, 378.0, 376.3, 353.9, 333.3, 380.0, 347.0, 378.0, 374.9, 397.3, 378.2, 351.6, 398.0, 383.7, 358.5, 328.8, 354.1, 400.0, 390.1, 353.2, 388.3, 330.8, 360.2, 399.1, 356.5, 385.0, 369.0, 357.6, 339.2, 357.0, 345.4, 398.2, 354.2, 355.2, 355.2, 371.0, 390.1, 342.5, 349.4, 380.8, 391.0, 336.4, 344.1, 374.8, 333.1, 394.6, 395.5, 380.0, 363.0, 334.0, 398.2], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [122.0, 196.1, 200.0, 191.6, 196.4, 195.5, 177.8, 198.2, 167.0, 170.0, 158.6, 196.4, 175.7, 200.0, 177.5, 191.9, 178.1, 180.2, 197.0, 179.3, 196.4, 197.3, 187.4, 195.5, 196.4, 176.6, 173.9, 172.1, 184.7, 167.0, 150.0, 200.0, 200.0, 165.0, 189.2, 186.2, 149.0, 184.7, 184.1, 155.0, 155.0, 185.0, 159.8, 182.0, 158.0, 157.7, 151.4, 193.1, 200.0, 136.4, 195.5, 192.8, 159.2, 158.0, 191.0, 186.8, 194.6, 170.0, 193.7, 187.4, 166.7, 170.9, 129.2, 198.2, 189.2, 195.5, 190.0, 167.0, 183.0, 198.0, 194.6, 200.0, 137.0, 178.7, 155.0, 179.0, 182.0, 191.9, 135.2, 165.5, 199.1, 200.0, 189.2, 191.9, 200.0, 195.5, 188.6, 189.2, 152.0, 194.6, 189.2, 136.70000000000002, 150.5, 133.4, 136.1, 200.0, 188.3, 195.5, 171.8, 161.0, 185.0, 185.0, 166.1, 198.2, 155.9, 179.0, 177.5, 126.80000000000001, 190.0, 190.0, 137.0, 163.0, 200.0, 169.0, 194.0, 164.9, 197.3, 200.0, 167.0, 198.2, 171.2, 163.4, 200.0, 197.0, 193.7, 185.0, 155.3, 189.2, 141.5, 155.3, 170.0, 157.1, 200.0, 200.0, 190.1, 200.0, 200.0, 135.2, 189.2, 199.1, 181.1, 124.7, 150.8, 190.4, 200.0, 199.1, 153.2, 197.3, 197.0, 179.0, 181.0, 182.0, 173.6, 164.0, 132.2, 191.0, 141.2, 192.8, 167.0, 151.4, 198.2, 200.0, 180.2, 161.0, 176.0, 162.2, 156.2, 182.0, 170.0, 191.0, 199.1, 191.0, 198.2, 122.3, 161.6, 165.8, 179.3, 195.5, 196.4, 194.6, 176.0, 115.4, 186.5, 137.6, 191.9, 182.9, 188.0, 106.10000000000002, 199.1, 195.5, 200.0, 195.5, 184.0, 196.0, 163.0, 200.0, 158.6, 163.4, 198.2, 200.0], "policy_predator_policy_reward": [17.0, 16.0, 1.0, 0.0, 0.0, 0.0, 5.0, 0.0, 10.0, 4.0, 9.0, 5.0, 3.0, 0.0, 6.0, 0.0, 7.0, 3.0, 1.0, 6.0, 0.0, 0.0, 0.0, 3.0, 2.0, 1.0, 0.0, 9.0, 0.0, 11.0, 0.0, 15.0, 0.0, 3.0, 2.0, 4.0, 14.0, 17.0, 15.0, 5.0, 15.0, 12.0, 0.0, 17.0, 0.0, 19.0, 14.0, 1.0, 0.0, 17.0, 0.0, 0.0, 9.0, 13.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 20.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 2.0, 18.0, 15.0, 0.0, 3.0, 6.0, 19.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 16.0, 0.0, 19.0, 0.0, 14.0, 10.0, 13.0, 21.0, 0.0, 0.0, 3.0, 13.0, 0.0, 8.0, 1.0, 11.0, 7.0, 12.0, 13.0, 16.0, 0.0, 0.0, 26.0, 21.0, 9.0, 0.0, 7.0, 9.0, 0.0, 0.0, 2.0, 11.0, 8.0, 9.0, 1.0, 0.0, 0.0, 5.0, 11.0, 3.0, 18.0, 14.0, 21.0, 6.0, 0.0, 0.0, 0.0, 0.0, 14.0, 4.0, 0.0, 0.0, 10.0, 15.0, 10.0, 9.0, 0.0, 0.0, 0.0, 6.0, 2.0, 7.0, 1.0, 5.0, 13.0, 7.0, 0.0, 16.0, 19.0, 4.0, 11.0, 16.0, 0.0, 0.0, 13.0, 0.0, 14.0, 3.0, 6.0, 11.0, 0.0, 10.0, 0.0, 0.0, 22.0, 0.0, 11.0, 11.0, 6.0, 0.0, 0.0, 0.0, 22.0, 23.0, 16.0, 4.0, 0.0, 0.0, 25.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 7.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4066422793169095, "mean_inference_ms": 4.2365574076675765, "mean_action_processing_ms": 0.6948843525762932, "mean_env_wait_ms": 0.48755422297775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013381481170654297, "StateBufferConnector_ms": 0.005155324935913086, "ViewRequirementAgentConnector_ms": 0.128210186958313}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 307.9, "episode_return_mean": 367.31699999999995, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.468154705306496, "num_env_steps_trained_throughput_per_sec": 36.468154705306496, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 1856000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1856000, "timers": {"training_iteration_time_ms": 25825.024, "restore_workers_time_ms": 0.018, "training_step_time_ms": 25824.965, "sample_time_ms": 2286.283, "learn_time_ms": 23517.251, "learn_throughput": 170.088, "synch_weights_time_ms": 17.443}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 1856000, "num_agent_steps_trained": 1856000}, "done": false, "training_iteration": 116, "trial_id": "e4caa_00000", "date": "2024-08-13_20-24-55", "timestamp": 1723595095, "time_this_iter_s": 109.76486778259277, "time_total_s": 2427.0083770751953, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb15e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2427.0083770751953, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 70.708, "ram_util_percent": 83.936}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7125692204665885, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9307826782597682, "policy_loss": -0.006172205282316085, "vf_loss": 0.936744646735923, "vf_explained_var": 0.47908690174420676, "kl": 0.011212551927025536, "entropy": 1.2300076278429182, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 220185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1196760420288356, "cur_kl_coeff": 7.940933880509064e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5627479997419176, "policy_loss": -0.0028488394013413834, "vf_loss": 0.5655968394071337, "vf_explained_var": 0.09098444618876018, "kl": 0.0036788199446313626, "entropy": 0.06041781801493868, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 220185.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 185.79999999999941, "episode_reward_mean": 362.41200000000003, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 20.000000000000014, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 40.0}, "policy_reward_mean": {"prey_policy": 174.421, "predator_policy": 6.785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [364.7, 359.1, 367.0, 358.8, 334.7, 359.5, 353.4, 388.3, 339.2, 379.8, 374.6, 381.1, 349.6, 347.4, 384.7, 368.0, 381.0, 394.6, 335.7, 349.0, 382.9, 330.7, 399.1, 381.1, 395.5, 379.8, 362.6, 344.9, 307.9, 370.1, 383.8, 348.8, 378.0, 376.3, 353.9, 333.3, 380.0, 347.0, 378.0, 374.9, 397.3, 378.2, 351.6, 398.0, 383.7, 358.5, 328.8, 354.1, 400.0, 390.1, 353.2, 388.3, 330.8, 360.2, 399.1, 356.5, 385.0, 369.0, 357.6, 339.2, 357.0, 345.4, 398.2, 354.2, 355.2, 355.2, 371.0, 390.1, 342.5, 349.4, 380.8, 391.0, 336.4, 344.1, 374.8, 333.1, 394.6, 395.5, 380.0, 363.0, 334.0, 398.2, 362.9, 380.2, 348.3, 373.0, 339.5, 357.1, 358.4, 363.2, 348.4, 383.2, 361.7, 356.8, 372.0, 288.9, 321.0, 378.0, 361.1, 185.79999999999941], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [149.0, 184.7, 184.1, 155.0, 155.0, 185.0, 159.8, 182.0, 158.0, 157.7, 151.4, 193.1, 200.0, 136.4, 195.5, 192.8, 159.2, 158.0, 191.0, 186.8, 194.6, 170.0, 193.7, 187.4, 166.7, 170.9, 129.2, 198.2, 189.2, 195.5, 190.0, 167.0, 183.0, 198.0, 194.6, 200.0, 137.0, 178.7, 155.0, 179.0, 182.0, 191.9, 135.2, 165.5, 199.1, 200.0, 189.2, 191.9, 200.0, 195.5, 188.6, 189.2, 152.0, 194.6, 189.2, 136.70000000000002, 150.5, 133.4, 136.1, 200.0, 188.3, 195.5, 171.8, 161.0, 185.0, 185.0, 166.1, 198.2, 155.9, 179.0, 177.5, 126.80000000000001, 190.0, 190.0, 137.0, 163.0, 200.0, 169.0, 194.0, 164.9, 197.3, 200.0, 167.0, 198.2, 171.2, 163.4, 200.0, 197.0, 193.7, 185.0, 155.3, 189.2, 141.5, 155.3, 170.0, 157.1, 200.0, 200.0, 190.1, 200.0, 200.0, 135.2, 189.2, 199.1, 181.1, 124.7, 150.8, 190.4, 200.0, 199.1, 153.2, 197.3, 197.0, 179.0, 181.0, 182.0, 173.6, 164.0, 132.2, 191.0, 141.2, 192.8, 167.0, 151.4, 198.2, 200.0, 180.2, 161.0, 176.0, 162.2, 156.2, 182.0, 170.0, 191.0, 199.1, 191.0, 198.2, 122.3, 161.6, 165.8, 179.3, 195.5, 196.4, 194.6, 176.0, 115.4, 186.5, 137.6, 191.9, 182.9, 188.0, 106.10000000000002, 199.1, 195.5, 200.0, 195.5, 184.0, 196.0, 163.0, 200.0, 158.6, 163.4, 198.2, 200.0, 188.0, 164.9, 191.0, 189.2, 166.4, 170.9, 183.8, 189.2, 138.2, 182.3, 173.0, 175.1, 169.4, 170.0, 189.2, 161.0, 146.0, 178.4, 189.2, 191.0, 163.7, 182.0, 194.0, 144.8, 179.0, 179.0, 80.89999999999999, 146.0, 147.0, 156.0, 197.0, 146.0, 124.1, 200.0, 165.8, 20.000000000000014], "policy_predator_policy_reward": [14.0, 17.0, 15.0, 5.0, 15.0, 12.0, 0.0, 17.0, 0.0, 19.0, 14.0, 1.0, 0.0, 17.0, 0.0, 0.0, 9.0, 13.0, 0.0, 2.0, 10.0, 0.0, 0.0, 0.0, 0.0, 12.0, 0.0, 20.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 2.0, 18.0, 15.0, 0.0, 3.0, 6.0, 19.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 16.0, 0.0, 19.0, 0.0, 14.0, 10.0, 13.0, 21.0, 0.0, 0.0, 3.0, 13.0, 0.0, 8.0, 1.0, 11.0, 7.0, 12.0, 13.0, 16.0, 0.0, 0.0, 26.0, 21.0, 9.0, 0.0, 7.0, 9.0, 0.0, 0.0, 2.0, 11.0, 8.0, 9.0, 1.0, 0.0, 0.0, 5.0, 11.0, 3.0, 18.0, 14.0, 21.0, 6.0, 0.0, 0.0, 0.0, 0.0, 14.0, 4.0, 0.0, 0.0, 10.0, 15.0, 10.0, 9.0, 0.0, 0.0, 0.0, 6.0, 2.0, 7.0, 1.0, 5.0, 13.0, 7.0, 0.0, 16.0, 19.0, 4.0, 11.0, 16.0, 0.0, 0.0, 13.0, 0.0, 14.0, 3.0, 6.0, 11.0, 0.0, 10.0, 0.0, 0.0, 22.0, 0.0, 11.0, 11.0, 6.0, 0.0, 0.0, 0.0, 22.0, 23.0, 16.0, 4.0, 0.0, 0.0, 25.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 7.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 19.0, 0.0, 9.0, 0.0, 10.0, 9.0, 0.0, 13.0, 21.0, 3.0, 3.0, 0.0, 0.0, 16.0, 8.0, 10.0, 8.0, 6.0, 40.0, 22.0, 11.0, 7.0, 18.0, 17.0, 24.0, 13.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4022520729952073, "mean_inference_ms": 4.220670222443473, "mean_action_processing_ms": 0.6921213374716118, "mean_env_wait_ms": 0.48560114367939744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013697504997253418, "StateBufferConnector_ms": 0.0037926435470581055, "ViewRequirementAgentConnector_ms": 0.1268627643585205}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 185.79999999999941, "episode_return_mean": 362.41200000000003, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.7906299346123, "num_env_steps_trained_throughput_per_sec": 299.7906299346123, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 1872000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1872000, "timers": {"training_iteration_time_ms": 25662.44, "restore_workers_time_ms": 0.016, "training_step_time_ms": 25662.383, "sample_time_ms": 2221.153, "learn_time_ms": 23419.974, "learn_throughput": 170.794, "synch_weights_time_ms": 17.419}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 1872000, "num_agent_steps_trained": 1872000}, "done": false, "training_iteration": 117, "trial_id": "e4caa_00000", "date": "2024-08-13_20-25-08", "timestamp": 1723595108, "time_this_iter_s": 13.385570764541626, "time_total_s": 2440.393947839737, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb1820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2440.393947839737, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 52.18947368421053, "ram_util_percent": 83.7421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8752671758806894, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1035816120525832, "policy_loss": -0.013743142621769082, "vf_loss": 1.1170754728493868, "vf_explained_var": 0.684907311327243, "kl": 0.013295097251394541, "entropy": 1.2435358179309381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 222075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7262662192816456, "cur_kl_coeff": 3.970466940254532e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8181434268673892, "policy_loss": -0.0011629697654849639, "vf_loss": 0.8193063956641016, "vf_explained_var": 0.09095910109540142, "kl": 0.0007096347891297821, "entropy": 0.04847276527336035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 222075.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 185.79999999999941, "episode_reward_mean": 359.37299999999993, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 8.599999999999966, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 40.0}, "policy_reward_mean": {"prey_policy": 173.09150000000002, "predator_policy": 6.595}, "custom_metrics": {}, "hist_stats": {"episode_reward": [335.7, 349.0, 382.9, 330.7, 399.1, 381.1, 395.5, 379.8, 362.6, 344.9, 307.9, 370.1, 383.8, 348.8, 378.0, 376.3, 353.9, 333.3, 380.0, 347.0, 378.0, 374.9, 397.3, 378.2, 351.6, 398.0, 383.7, 358.5, 328.8, 354.1, 400.0, 390.1, 353.2, 388.3, 330.8, 360.2, 399.1, 356.5, 385.0, 369.0, 357.6, 339.2, 357.0, 345.4, 398.2, 354.2, 355.2, 355.2, 371.0, 390.1, 342.5, 349.4, 380.8, 391.0, 336.4, 344.1, 374.8, 333.1, 394.6, 395.5, 380.0, 363.0, 334.0, 398.2, 362.9, 380.2, 348.3, 373.0, 339.5, 357.1, 358.4, 363.2, 348.4, 383.2, 361.7, 356.8, 372.0, 288.9, 321.0, 378.0, 361.1, 185.79999999999941, 388.3, 373.4, 338.4, 214.79999999999956, 371.1, 392.8, 343.5, 293.90000000000003, 348.8, 203.29999999999933, 360.3, 386.0, 399.1, 368.0, 374.0, 388.0, 362.4, 375.5], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [137.0, 178.7, 155.0, 179.0, 182.0, 191.9, 135.2, 165.5, 199.1, 200.0, 189.2, 191.9, 200.0, 195.5, 188.6, 189.2, 152.0, 194.6, 189.2, 136.70000000000002, 150.5, 133.4, 136.1, 200.0, 188.3, 195.5, 171.8, 161.0, 185.0, 185.0, 166.1, 198.2, 155.9, 179.0, 177.5, 126.80000000000001, 190.0, 190.0, 137.0, 163.0, 200.0, 169.0, 194.0, 164.9, 197.3, 200.0, 167.0, 198.2, 171.2, 163.4, 200.0, 197.0, 193.7, 185.0, 155.3, 189.2, 141.5, 155.3, 170.0, 157.1, 200.0, 200.0, 190.1, 200.0, 200.0, 135.2, 189.2, 199.1, 181.1, 124.7, 150.8, 190.4, 200.0, 199.1, 153.2, 197.3, 197.0, 179.0, 181.0, 182.0, 173.6, 164.0, 132.2, 191.0, 141.2, 192.8, 167.0, 151.4, 198.2, 200.0, 180.2, 161.0, 176.0, 162.2, 156.2, 182.0, 170.0, 191.0, 199.1, 191.0, 198.2, 122.3, 161.6, 165.8, 179.3, 195.5, 196.4, 194.6, 176.0, 115.4, 186.5, 137.6, 191.9, 182.9, 188.0, 106.10000000000002, 199.1, 195.5, 200.0, 195.5, 184.0, 196.0, 163.0, 200.0, 158.6, 163.4, 198.2, 200.0, 188.0, 164.9, 191.0, 189.2, 166.4, 170.9, 183.8, 189.2, 138.2, 182.3, 173.0, 175.1, 169.4, 170.0, 189.2, 161.0, 146.0, 178.4, 189.2, 191.0, 163.7, 182.0, 194.0, 144.8, 179.0, 179.0, 80.89999999999999, 146.0, 147.0, 156.0, 197.0, 146.0, 124.1, 200.0, 165.8, 20.000000000000014, 192.8, 195.5, 175.4, 191.0, 152.0, 157.4, 8.599999999999966, 168.2, 172.1, 188.0, 192.8, 200.0, 168.5, 161.0, 187.4, 93.49999999999999, 153.8, 179.0, 176.3, 20.000000000000014, 167.60000000000002, 178.7, 200.0, 179.0, 200.0, 199.1, 185.0, 173.0, 188.0, 176.0, 196.0, 192.0, 176.0, 178.4, 198.2, 176.3], "policy_predator_policy_reward": [2.0, 18.0, 15.0, 0.0, 3.0, 6.0, 19.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 16.0, 0.0, 19.0, 0.0, 14.0, 10.0, 13.0, 21.0, 0.0, 0.0, 3.0, 13.0, 0.0, 8.0, 1.0, 11.0, 7.0, 12.0, 13.0, 16.0, 0.0, 0.0, 26.0, 21.0, 9.0, 0.0, 7.0, 9.0, 0.0, 0.0, 2.0, 11.0, 8.0, 9.0, 1.0, 0.0, 0.0, 5.0, 11.0, 3.0, 18.0, 14.0, 21.0, 6.0, 0.0, 0.0, 0.0, 0.0, 14.0, 4.0, 0.0, 0.0, 10.0, 15.0, 10.0, 9.0, 0.0, 0.0, 0.0, 6.0, 2.0, 7.0, 1.0, 5.0, 13.0, 7.0, 0.0, 16.0, 19.0, 4.0, 11.0, 16.0, 0.0, 0.0, 13.0, 0.0, 14.0, 3.0, 6.0, 11.0, 0.0, 10.0, 0.0, 0.0, 22.0, 0.0, 11.0, 11.0, 6.0, 0.0, 0.0, 0.0, 22.0, 23.0, 16.0, 4.0, 0.0, 0.0, 25.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 7.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 19.0, 0.0, 9.0, 0.0, 10.0, 9.0, 0.0, 13.0, 21.0, 3.0, 3.0, 0.0, 0.0, 16.0, 8.0, 10.0, 8.0, 6.0, 40.0, 22.0, 11.0, 7.0, 18.0, 17.0, 24.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 18.0, 11.0, 14.0, 24.0, 1.0, 10.0, 0.0, 0.0, 14.0, 0.0, 0.0, 13.0, 0.0, 16.0, 0.0, 7.0, 9.0, 5.0, 7.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3971908837584492, "mean_inference_ms": 4.206499267286891, "mean_action_processing_ms": 0.6891452421315688, "mean_env_wait_ms": 0.48386130058835375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013837456703186035, "StateBufferConnector_ms": 0.003651857376098633, "ViewRequirementAgentConnector_ms": 0.12324881553649902}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 185.79999999999941, "episode_return_mean": 359.37299999999993, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.8492785221315, "num_env_steps_trained_throughput_per_sec": 308.8492785221315, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 1888000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1888000, "timers": {"training_iteration_time_ms": 25427.337, "restore_workers_time_ms": 0.016, "training_step_time_ms": 25427.28, "sample_time_ms": 1981.863, "learn_time_ms": 23423.846, "learn_throughput": 170.766, "synch_weights_time_ms": 17.756}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 1888000, "num_agent_steps_trained": 1888000}, "done": false, "training_iteration": 118, "trial_id": "e4caa_00000", "date": "2024-08-13_20-25-21", "timestamp": 1723595121, "time_this_iter_s": 12.982915163040161, "time_total_s": 2453.376863002777, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29ce3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2453.376863002777, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 49.647368421052626, "ram_util_percent": 82.49473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9483992976013316, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.975339586851458, "policy_loss": -0.006886906121369629, "vf_loss": 0.9820607057954899, "vf_explained_var": 0.4704269814743567, "kl": 0.008841919106035726, "entropy": 1.2253653457555822, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5615101495432475, "cur_kl_coeff": 1.985233470127266e-24, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8535549268520698, "policy_loss": -0.0005290766883513363, "vf_loss": 0.8540840055103656, "vf_explained_var": 0.09733889768363307, "kl": 0.001369007844791034, "entropy": 0.07288930899705048, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 223965.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 185.79999999999941, "episode_reward_mean": 357.3529999999999, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 8.599999999999966, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 40.0}, "policy_reward_mean": {"prey_policy": 172.02650000000003, "predator_policy": 6.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [378.2, 351.6, 398.0, 383.7, 358.5, 328.8, 354.1, 400.0, 390.1, 353.2, 388.3, 330.8, 360.2, 399.1, 356.5, 385.0, 369.0, 357.6, 339.2, 357.0, 345.4, 398.2, 354.2, 355.2, 355.2, 371.0, 390.1, 342.5, 349.4, 380.8, 391.0, 336.4, 344.1, 374.8, 333.1, 394.6, 395.5, 380.0, 363.0, 334.0, 398.2, 362.9, 380.2, 348.3, 373.0, 339.5, 357.1, 358.4, 363.2, 348.4, 383.2, 361.7, 356.8, 372.0, 288.9, 321.0, 378.0, 361.1, 185.79999999999941, 388.3, 373.4, 338.4, 214.79999999999956, 371.1, 392.8, 343.5, 293.90000000000003, 348.8, 203.29999999999933, 360.3, 386.0, 399.1, 368.0, 374.0, 388.0, 362.4, 375.5, 377.1, 398.2, 373.4, 353.5, 245.6, 342.4, 246.19999999999973, 398.2, 372.8, 370.0, 338.1, 391.0, 363.2, 380.9, 354.1, 366.0, 400.0, 371.0, 358.0, 301.0, 387.1, 319.2, 381.6], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [167.0, 198.2, 171.2, 163.4, 200.0, 197.0, 193.7, 185.0, 155.3, 189.2, 141.5, 155.3, 170.0, 157.1, 200.0, 200.0, 190.1, 200.0, 200.0, 135.2, 189.2, 199.1, 181.1, 124.7, 150.8, 190.4, 200.0, 199.1, 153.2, 197.3, 197.0, 179.0, 181.0, 182.0, 173.6, 164.0, 132.2, 191.0, 141.2, 192.8, 167.0, 151.4, 198.2, 200.0, 180.2, 161.0, 176.0, 162.2, 156.2, 182.0, 170.0, 191.0, 199.1, 191.0, 198.2, 122.3, 161.6, 165.8, 179.3, 195.5, 196.4, 194.6, 176.0, 115.4, 186.5, 137.6, 191.9, 182.9, 188.0, 106.10000000000002, 199.1, 195.5, 200.0, 195.5, 184.0, 196.0, 163.0, 200.0, 158.6, 163.4, 198.2, 200.0, 188.0, 164.9, 191.0, 189.2, 166.4, 170.9, 183.8, 189.2, 138.2, 182.3, 173.0, 175.1, 169.4, 170.0, 189.2, 161.0, 146.0, 178.4, 189.2, 191.0, 163.7, 182.0, 194.0, 144.8, 179.0, 179.0, 80.89999999999999, 146.0, 147.0, 156.0, 197.0, 146.0, 124.1, 200.0, 165.8, 20.000000000000014, 192.8, 195.5, 175.4, 191.0, 152.0, 157.4, 8.599999999999966, 168.2, 172.1, 188.0, 192.8, 200.0, 168.5, 161.0, 187.4, 93.49999999999999, 153.8, 179.0, 176.3, 20.000000000000014, 167.60000000000002, 178.7, 200.0, 179.0, 200.0, 199.1, 185.0, 173.0, 188.0, 176.0, 196.0, 192.0, 176.0, 178.4, 198.2, 176.3, 199.1, 167.0, 199.1, 199.1, 166.4, 200.0, 190.4, 142.1, 74.00000000000006, 131.6, 173.0, 136.4, 30.199999999999967, 170.0, 198.2, 200.0, 179.9, 191.9, 200.0, 155.0, 170.3, 150.8, 200.0, 191.0, 161.0, 186.2, 182.0, 191.9, 146.0, 190.1, 176.0, 182.0, 200.0, 200.0, 178.0, 190.0, 200.0, 137.0, 98.0, 165.0, 181.1, 200.0, 149.9, 143.3, 191.9, 187.7], "policy_predator_policy_reward": [2.0, 11.0, 8.0, 9.0, 1.0, 0.0, 0.0, 5.0, 11.0, 3.0, 18.0, 14.0, 21.0, 6.0, 0.0, 0.0, 0.0, 0.0, 14.0, 4.0, 0.0, 0.0, 10.0, 15.0, 10.0, 9.0, 0.0, 0.0, 0.0, 6.0, 2.0, 7.0, 1.0, 5.0, 13.0, 7.0, 0.0, 16.0, 19.0, 4.0, 11.0, 16.0, 0.0, 0.0, 13.0, 0.0, 14.0, 3.0, 6.0, 11.0, 0.0, 10.0, 0.0, 0.0, 22.0, 0.0, 11.0, 11.0, 6.0, 0.0, 0.0, 0.0, 22.0, 23.0, 16.0, 4.0, 0.0, 0.0, 25.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 7.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 19.0, 0.0, 9.0, 0.0, 10.0, 9.0, 0.0, 13.0, 21.0, 3.0, 3.0, 0.0, 0.0, 16.0, 8.0, 10.0, 8.0, 6.0, 40.0, 22.0, 11.0, 7.0, 18.0, 17.0, 24.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 18.0, 11.0, 14.0, 24.0, 1.0, 10.0, 0.0, 0.0, 14.0, 0.0, 0.0, 13.0, 0.0, 16.0, 0.0, 7.0, 9.0, 5.0, 7.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 6.0, 5.0, 0.0, 0.0, 0.0, 7.0, 2.0, 19.0, 34.0, 6.0, 11.0, 22.0, 20.0, 26.0, 0.0, 0.0, 0.0, 1.0, 15.0, 0.0, 8.0, 9.0, 0.0, 0.0, 9.0, 7.0, 6.0, 1.0, 18.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 3.0, 0.0, 21.0, 19.0, 19.0, 0.0, 6.0, 0.0, 26.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3908341787808909, "mean_inference_ms": 4.1885386077994635, "mean_action_processing_ms": 0.6853156352578251, "mean_env_wait_ms": 0.48162871375986716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013669013977050781, "StateBufferConnector_ms": 0.004469513893127441, "ViewRequirementAgentConnector_ms": 0.15476036071777344}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 185.79999999999941, "episode_return_mean": 357.3529999999999, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 2.10296091588192, "num_env_steps_trained_throughput_per_sec": 2.10296091588192, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 1904000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1904000, "timers": {"training_iteration_time_ms": 214144.122, "restore_workers_time_ms": 0.016, "training_step_time_ms": 214144.065, "sample_time_ms": 1873.699, "learn_time_ms": 212248.446, "learn_throughput": 18.846, "synch_weights_time_ms": 17.734}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 1904000, "num_agent_steps_trained": 1904000}, "done": false, "training_iteration": 119, "trial_id": "e4caa_00000", "date": "2024-08-13_20-57-03", "timestamp": 1723597023, "time_this_iter_s": 1902.1428442001343, "time_total_s": 4355.519707202911, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29099d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4355.519707202911, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 79.49666666666666, "ram_util_percent": 83.30333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3955560135226401, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3076440628709471, "policy_loss": -0.006498046820766475, "vf_loss": 0.31401234366838626, "vf_explained_var": 0.44712499569332786, "kl": 0.006920870434861033, "entropy": 1.2646408918042662, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 225855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.135638915704041, "cur_kl_coeff": 9.92616735063633e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2334735839159558, "policy_loss": -0.00044955710323635865, "vf_loss": 0.23392314072901618, "vf_explained_var": 0.22636523426525176, "kl": 0.0027463515185663645, "entropy": 0.0840811501143786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 225855.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 185.79999999999941, "episode_reward_mean": 357.59799999999996, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 8.599999999999966, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 40.0}, "policy_reward_mean": {"prey_policy": 172.18899999999996, "predator_policy": 6.61}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.2, 355.2, 355.2, 371.0, 390.1, 342.5, 349.4, 380.8, 391.0, 336.4, 344.1, 374.8, 333.1, 394.6, 395.5, 380.0, 363.0, 334.0, 398.2, 362.9, 380.2, 348.3, 373.0, 339.5, 357.1, 358.4, 363.2, 348.4, 383.2, 361.7, 356.8, 372.0, 288.9, 321.0, 378.0, 361.1, 185.79999999999941, 388.3, 373.4, 338.4, 214.79999999999956, 371.1, 392.8, 343.5, 293.90000000000003, 348.8, 203.29999999999933, 360.3, 386.0, 399.1, 368.0, 374.0, 388.0, 362.4, 375.5, 377.1, 398.2, 373.4, 353.5, 245.6, 342.4, 246.19999999999973, 398.2, 372.8, 370.0, 338.1, 391.0, 363.2, 380.9, 354.1, 366.0, 400.0, 371.0, 358.0, 301.0, 387.1, 319.2, 381.6, 387.9, 372.0, 373.0, 296.9, 360.2, 388.1, 319.0, 383.7, 384.6, 395.5, 391.1, 355.5, 361.7, 395.5, 372.0, 374.0, 342.5, 372.4, 371.0, 394.0, 359.0, 357.4], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [180.2, 161.0, 176.0, 162.2, 156.2, 182.0, 170.0, 191.0, 199.1, 191.0, 198.2, 122.3, 161.6, 165.8, 179.3, 195.5, 196.4, 194.6, 176.0, 115.4, 186.5, 137.6, 191.9, 182.9, 188.0, 106.10000000000002, 199.1, 195.5, 200.0, 195.5, 184.0, 196.0, 163.0, 200.0, 158.6, 163.4, 198.2, 200.0, 188.0, 164.9, 191.0, 189.2, 166.4, 170.9, 183.8, 189.2, 138.2, 182.3, 173.0, 175.1, 169.4, 170.0, 189.2, 161.0, 146.0, 178.4, 189.2, 191.0, 163.7, 182.0, 194.0, 144.8, 179.0, 179.0, 80.89999999999999, 146.0, 147.0, 156.0, 197.0, 146.0, 124.1, 200.0, 165.8, 20.000000000000014, 192.8, 195.5, 175.4, 191.0, 152.0, 157.4, 8.599999999999966, 168.2, 172.1, 188.0, 192.8, 200.0, 168.5, 161.0, 187.4, 93.49999999999999, 153.8, 179.0, 176.3, 20.000000000000014, 167.60000000000002, 178.7, 200.0, 179.0, 200.0, 199.1, 185.0, 173.0, 188.0, 176.0, 196.0, 192.0, 176.0, 178.4, 198.2, 176.3, 199.1, 167.0, 199.1, 199.1, 166.4, 200.0, 190.4, 142.1, 74.00000000000006, 131.6, 173.0, 136.4, 30.199999999999967, 170.0, 198.2, 200.0, 179.9, 191.9, 200.0, 155.0, 170.3, 150.8, 200.0, 191.0, 161.0, 186.2, 182.0, 191.9, 146.0, 190.1, 176.0, 182.0, 200.0, 200.0, 178.0, 190.0, 200.0, 137.0, 98.0, 165.0, 181.1, 200.0, 149.9, 143.3, 191.9, 187.7, 186.8, 199.1, 193.7, 161.3, 200.0, 173.0, 159.5, 103.39999999999999, 168.2, 179.0, 200.0, 169.1, 137.9, 148.1, 199.1, 179.6, 200.0, 179.6, 195.5, 200.0, 199.1, 188.0, 145.1, 181.4, 197.0, 145.7, 200.0, 195.5, 170.0, 188.0, 188.0, 179.0, 168.5, 152.0, 163.1, 197.3, 182.0, 185.0, 200.0, 194.0, 178.4, 164.6, 178.4, 164.0], "policy_predator_policy_reward": [13.0, 0.0, 14.0, 3.0, 6.0, 11.0, 0.0, 10.0, 0.0, 0.0, 22.0, 0.0, 11.0, 11.0, 6.0, 0.0, 0.0, 0.0, 22.0, 23.0, 16.0, 4.0, 0.0, 0.0, 25.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 7.0, 0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 19.0, 0.0, 9.0, 0.0, 10.0, 9.0, 0.0, 13.0, 21.0, 3.0, 3.0, 0.0, 0.0, 16.0, 8.0, 10.0, 8.0, 6.0, 40.0, 22.0, 11.0, 7.0, 18.0, 17.0, 24.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 18.0, 11.0, 14.0, 24.0, 1.0, 10.0, 0.0, 0.0, 14.0, 0.0, 0.0, 13.0, 0.0, 16.0, 0.0, 7.0, 9.0, 5.0, 7.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 6.0, 5.0, 0.0, 0.0, 0.0, 7.0, 2.0, 19.0, 34.0, 6.0, 11.0, 22.0, 20.0, 26.0, 0.0, 0.0, 0.0, 1.0, 15.0, 0.0, 8.0, 9.0, 0.0, 0.0, 9.0, 7.0, 6.0, 1.0, 18.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 3.0, 0.0, 21.0, 19.0, 19.0, 0.0, 6.0, 0.0, 26.0, 2.0, 0.0, 0.0, 2.0, 11.0, 6.0, 0.0, 0.0, 22.0, 12.0, 0.0, 13.0, 9.0, 10.0, 21.0, 12.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 4.0, 0.0, 12.0, 17.0, 9.0, 10.0, 0.0, 0.0, 7.0, 7.0, 0.0, 7.0, 9.0, 13.0, 12.0, 0.0, 4.0, 0.0, 0.0, 0.0, 7.0, 9.0, 15.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3859287992220106, "mean_inference_ms": 4.179169851870862, "mean_action_processing_ms": 0.6823096753500758, "mean_env_wait_ms": 0.48040481212524244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012874007225036621, "StateBufferConnector_ms": 0.004791617393493652, "ViewRequirementAgentConnector_ms": 0.17975008487701416}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 185.79999999999941, "episode_return_mean": 357.59799999999996, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 206.8461100042693, "num_env_steps_trained_throughput_per_sec": 206.8461100042693, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 214687.158, "restore_workers_time_ms": 0.016, "training_step_time_ms": 214687.1, "sample_time_ms": 2019.129, "learn_time_ms": 212645.874, "learn_throughput": 18.811, "synch_weights_time_ms": 18.031}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 120, "trial_id": "e4caa_00000", "date": "2024-08-13_20-57-23", "timestamp": 1723597043, "time_this_iter_s": 19.386878967285156, "time_total_s": 4374.9065861701965, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b3b310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4374.9065861701965, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 80.99259259259259, "ram_util_percent": 83.93703703703704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5335455740570392, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5108923262625775, "policy_loss": -0.004854735970329592, "vf_loss": 0.5156376921094427, "vf_explained_var": 0.4303894958483479, "kl": 0.005833137124665038, "entropy": 1.2680789902096703, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 227745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3254721515787342, "cur_kl_coeff": 4.963083675318165e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4227637097791389, "policy_loss": -0.0014132859104032081, "vf_loss": 0.42417699424722405, "vf_explained_var": 0.09814770609613449, "kl": 0.002737872749351324, "entropy": 0.05414051821149846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 227745.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 185.79999999999941, "episode_reward_mean": 358.7439999999999, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 8.599999999999966, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 40.0}, "policy_reward_mean": {"prey_policy": 172.84699999999998, "predator_policy": 6.525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [398.2, 362.9, 380.2, 348.3, 373.0, 339.5, 357.1, 358.4, 363.2, 348.4, 383.2, 361.7, 356.8, 372.0, 288.9, 321.0, 378.0, 361.1, 185.79999999999941, 388.3, 373.4, 338.4, 214.79999999999956, 371.1, 392.8, 343.5, 293.90000000000003, 348.8, 203.29999999999933, 360.3, 386.0, 399.1, 368.0, 374.0, 388.0, 362.4, 375.5, 377.1, 398.2, 373.4, 353.5, 245.6, 342.4, 246.19999999999973, 398.2, 372.8, 370.0, 338.1, 391.0, 363.2, 380.9, 354.1, 366.0, 400.0, 371.0, 358.0, 301.0, 387.1, 319.2, 381.6, 387.9, 372.0, 373.0, 296.9, 360.2, 388.1, 319.0, 383.7, 384.6, 395.5, 391.1, 355.5, 361.7, 395.5, 372.0, 374.0, 342.5, 372.4, 371.0, 394.0, 359.0, 357.4, 308.0, 371.6, 398.2, 363.9, 395.5, 388.3, 394.6, 352.9, 368.6, 364.2, 386.6, 374.4, 379.3, 361.1, 395.0, 332.0, 378.6, 346.7], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [198.2, 200.0, 188.0, 164.9, 191.0, 189.2, 166.4, 170.9, 183.8, 189.2, 138.2, 182.3, 173.0, 175.1, 169.4, 170.0, 189.2, 161.0, 146.0, 178.4, 189.2, 191.0, 163.7, 182.0, 194.0, 144.8, 179.0, 179.0, 80.89999999999999, 146.0, 147.0, 156.0, 197.0, 146.0, 124.1, 200.0, 165.8, 20.000000000000014, 192.8, 195.5, 175.4, 191.0, 152.0, 157.4, 8.599999999999966, 168.2, 172.1, 188.0, 192.8, 200.0, 168.5, 161.0, 187.4, 93.49999999999999, 153.8, 179.0, 176.3, 20.000000000000014, 167.60000000000002, 178.7, 200.0, 179.0, 200.0, 199.1, 185.0, 173.0, 188.0, 176.0, 196.0, 192.0, 176.0, 178.4, 198.2, 176.3, 199.1, 167.0, 199.1, 199.1, 166.4, 200.0, 190.4, 142.1, 74.00000000000006, 131.6, 173.0, 136.4, 30.199999999999967, 170.0, 198.2, 200.0, 179.9, 191.9, 200.0, 155.0, 170.3, 150.8, 200.0, 191.0, 161.0, 186.2, 182.0, 191.9, 146.0, 190.1, 176.0, 182.0, 200.0, 200.0, 178.0, 190.0, 200.0, 137.0, 98.0, 165.0, 181.1, 200.0, 149.9, 143.3, 191.9, 187.7, 186.8, 199.1, 193.7, 161.3, 200.0, 173.0, 159.5, 103.39999999999999, 168.2, 179.0, 200.0, 169.1, 137.9, 148.1, 199.1, 179.6, 200.0, 179.6, 195.5, 200.0, 199.1, 188.0, 145.1, 181.4, 197.0, 145.7, 200.0, 195.5, 170.0, 188.0, 188.0, 179.0, 168.5, 152.0, 163.1, 197.3, 182.0, 185.0, 200.0, 194.0, 178.4, 164.6, 178.4, 164.0, 134.0, 152.0, 191.9, 172.7, 198.2, 200.0, 176.0, 173.9, 195.5, 200.0, 199.1, 189.2, 197.3, 197.3, 197.3, 125.6, 161.0, 188.6, 173.0, 180.2, 176.3, 197.3, 173.3, 190.1, 189.2, 190.1, 200.0, 160.1, 200.0, 195.0, 200.0, 96.0, 191.0, 179.6, 158.0, 154.7], "policy_predator_policy_reward": [0.0, 0.0, 4.0, 6.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 19.0, 0.0, 9.0, 0.0, 10.0, 9.0, 0.0, 13.0, 21.0, 3.0, 3.0, 0.0, 0.0, 16.0, 8.0, 10.0, 8.0, 6.0, 40.0, 22.0, 11.0, 7.0, 18.0, 17.0, 24.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 18.0, 11.0, 14.0, 24.0, 1.0, 10.0, 0.0, 0.0, 14.0, 0.0, 0.0, 13.0, 0.0, 16.0, 0.0, 7.0, 9.0, 5.0, 7.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 6.0, 5.0, 0.0, 0.0, 0.0, 7.0, 2.0, 19.0, 34.0, 6.0, 11.0, 22.0, 20.0, 26.0, 0.0, 0.0, 0.0, 1.0, 15.0, 0.0, 8.0, 9.0, 0.0, 0.0, 9.0, 7.0, 6.0, 1.0, 18.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 3.0, 0.0, 21.0, 19.0, 19.0, 0.0, 6.0, 0.0, 26.0, 2.0, 0.0, 0.0, 2.0, 11.0, 6.0, 0.0, 0.0, 22.0, 12.0, 0.0, 13.0, 9.0, 10.0, 21.0, 12.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 4.0, 0.0, 12.0, 17.0, 9.0, 10.0, 0.0, 0.0, 7.0, 7.0, 0.0, 7.0, 9.0, 13.0, 12.0, 0.0, 4.0, 0.0, 0.0, 0.0, 7.0, 9.0, 15.0, 0.0, 0.0, 22.0, 7.0, 0.0, 0.0, 0.0, 8.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 14.0, 12.0, 7.0, 11.0, 0.0, 6.0, 7.0, 8.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 15.0, 21.0, 3.0, 5.0, 14.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.381790560346815, "mean_inference_ms": 4.165790763748557, "mean_action_processing_ms": 0.6800918823226723, "mean_env_wait_ms": 0.4785896596861231, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00791943073272705, "StateBufferConnector_ms": 0.005207061767578125, "ViewRequirementAgentConnector_ms": 0.18026185035705566}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 185.79999999999941, "episode_return_mean": 358.7439999999999, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.3601969422803, "num_env_steps_trained_throughput_per_sec": 272.3601969422803, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 1936000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1936000, "timers": {"training_iteration_time_ms": 213460.387, "restore_workers_time_ms": 0.017, "training_step_time_ms": 213460.329, "sample_time_ms": 2091.89, "learn_time_ms": 211347.564, "learn_throughput": 18.926, "synch_weights_time_ms": 16.57}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 1936000, "num_agent_steps_trained": 1936000}, "done": false, "training_iteration": 121, "trial_id": "e4caa_00000", "date": "2024-08-13_20-57-38", "timestamp": 1723597058, "time_this_iter_s": 14.736037731170654, "time_total_s": 4389.642623901367, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bd51f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4389.642623901367, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 60.02380952380953, "ram_util_percent": 83.8809523809524}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9601553709418684, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9451715045396076, "policy_loss": -0.012730483025824897, "vf_loss": 0.9576070548049987, "vf_explained_var": 0.6137525042528829, "kl": 0.015729801407042665, "entropy": 1.2240823402606622, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 229635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1962489711465658, "cur_kl_coeff": 2.4815418376590825e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3651512646801257, "policy_loss": -0.0007553503205556245, "vf_loss": 0.36590661377862843, "vf_explained_var": 0.10733202749459202, "kl": 0.0020706007027650416, "entropy": 0.06226656561293615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 229635.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 185.79999999999941, "episode_reward_mean": 359.74299999999994, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 8.599999999999966, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 34.0}, "policy_reward_mean": {"prey_policy": 174.1715, "predator_policy": 5.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [185.79999999999941, 388.3, 373.4, 338.4, 214.79999999999956, 371.1, 392.8, 343.5, 293.90000000000003, 348.8, 203.29999999999933, 360.3, 386.0, 399.1, 368.0, 374.0, 388.0, 362.4, 375.5, 377.1, 398.2, 373.4, 353.5, 245.6, 342.4, 246.19999999999973, 398.2, 372.8, 370.0, 338.1, 391.0, 363.2, 380.9, 354.1, 366.0, 400.0, 371.0, 358.0, 301.0, 387.1, 319.2, 381.6, 387.9, 372.0, 373.0, 296.9, 360.2, 388.1, 319.0, 383.7, 384.6, 395.5, 391.1, 355.5, 361.7, 395.5, 372.0, 374.0, 342.5, 372.4, 371.0, 394.0, 359.0, 357.4, 308.0, 371.6, 398.2, 363.9, 395.5, 388.3, 394.6, 352.9, 368.6, 364.2, 386.6, 374.4, 379.3, 361.1, 395.0, 332.0, 378.6, 346.7, 328.6, 396.4, 383.2, 356.6, 367.0, 391.1, 361.0, 382.0, 385.0, 297.0999999999999, 370.2, 379.3, 396.4, 355.0, 365.0, 302.0, 374.0, 361.9], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [165.8, 20.000000000000014, 192.8, 195.5, 175.4, 191.0, 152.0, 157.4, 8.599999999999966, 168.2, 172.1, 188.0, 192.8, 200.0, 168.5, 161.0, 187.4, 93.49999999999999, 153.8, 179.0, 176.3, 20.000000000000014, 167.60000000000002, 178.7, 200.0, 179.0, 200.0, 199.1, 185.0, 173.0, 188.0, 176.0, 196.0, 192.0, 176.0, 178.4, 198.2, 176.3, 199.1, 167.0, 199.1, 199.1, 166.4, 200.0, 190.4, 142.1, 74.00000000000006, 131.6, 173.0, 136.4, 30.199999999999967, 170.0, 198.2, 200.0, 179.9, 191.9, 200.0, 155.0, 170.3, 150.8, 200.0, 191.0, 161.0, 186.2, 182.0, 191.9, 146.0, 190.1, 176.0, 182.0, 200.0, 200.0, 178.0, 190.0, 200.0, 137.0, 98.0, 165.0, 181.1, 200.0, 149.9, 143.3, 191.9, 187.7, 186.8, 199.1, 193.7, 161.3, 200.0, 173.0, 159.5, 103.39999999999999, 168.2, 179.0, 200.0, 169.1, 137.9, 148.1, 199.1, 179.6, 200.0, 179.6, 195.5, 200.0, 199.1, 188.0, 145.1, 181.4, 197.0, 145.7, 200.0, 195.5, 170.0, 188.0, 188.0, 179.0, 168.5, 152.0, 163.1, 197.3, 182.0, 185.0, 200.0, 194.0, 178.4, 164.6, 178.4, 164.0, 134.0, 152.0, 191.9, 172.7, 198.2, 200.0, 176.0, 173.9, 195.5, 200.0, 199.1, 189.2, 197.3, 197.3, 197.3, 125.6, 161.0, 188.6, 173.0, 180.2, 176.3, 197.3, 173.3, 190.1, 189.2, 190.1, 200.0, 160.1, 200.0, 195.0, 200.0, 96.0, 191.0, 179.6, 158.0, 154.7, 152.0, 152.6, 200.0, 196.4, 191.0, 189.2, 176.6, 164.0, 173.0, 185.0, 188.0, 199.1, 191.0, 146.0, 182.0, 200.0, 194.3, 187.7, 109.09999999999998, 182.0, 174.2, 188.0, 179.3, 200.0, 196.4, 200.0, 193.7, 161.3, 195.0, 155.0, 173.0, 126.0, 161.0, 200.0, 191.9, 155.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 18.0, 11.0, 14.0, 24.0, 1.0, 10.0, 0.0, 0.0, 14.0, 0.0, 0.0, 13.0, 0.0, 16.0, 0.0, 7.0, 9.0, 5.0, 7.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 6.0, 5.0, 0.0, 0.0, 0.0, 7.0, 2.0, 19.0, 34.0, 6.0, 11.0, 22.0, 20.0, 26.0, 0.0, 0.0, 0.0, 1.0, 15.0, 0.0, 8.0, 9.0, 0.0, 0.0, 9.0, 7.0, 6.0, 1.0, 18.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 3.0, 0.0, 21.0, 19.0, 19.0, 0.0, 6.0, 0.0, 26.0, 2.0, 0.0, 0.0, 2.0, 11.0, 6.0, 0.0, 0.0, 22.0, 12.0, 0.0, 13.0, 9.0, 10.0, 21.0, 12.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 4.0, 0.0, 12.0, 17.0, 9.0, 10.0, 0.0, 0.0, 7.0, 7.0, 0.0, 7.0, 9.0, 13.0, 12.0, 0.0, 4.0, 0.0, 0.0, 0.0, 7.0, 9.0, 15.0, 0.0, 0.0, 22.0, 7.0, 0.0, 0.0, 0.0, 8.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 14.0, 12.0, 7.0, 11.0, 0.0, 6.0, 7.0, 8.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 15.0, 21.0, 3.0, 5.0, 14.0, 20.0, 4.0, 20.0, 0.0, 0.0, 0.0, 3.0, 0.0, 16.0, 4.0, 5.0, 1.0, 3.0, 9.0, 15.0, 0.0, 0.0, 2.0, 1.0, 6.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 3.0, 0.0, 0.0, 13.0, 15.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3776781018844115, "mean_inference_ms": 4.155161200104063, "mean_action_processing_ms": 0.6777681869314768, "mean_env_wait_ms": 0.4771834641484564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007361173629760742, "StateBufferConnector_ms": 0.00523829460144043, "ViewRequirementAgentConnector_ms": 0.17501938343048096}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 185.79999999999941, "episode_return_mean": 359.74299999999994, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 11.497723535217773, "num_env_steps_trained_throughput_per_sec": 11.497723535217773, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 1952000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1952000, "timers": {"training_iteration_time_ms": 246762.309, "restore_workers_time_ms": 0.016, "training_step_time_ms": 246762.253, "sample_time_ms": 2053.101, "learn_time_ms": 244689.229, "learn_throughput": 16.347, "synch_weights_time_ms": 16.275}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 1952000, "num_agent_steps_trained": 1952000}, "done": false, "training_iteration": 122, "trial_id": "e4caa_00000", "date": "2024-08-13_21-03-26", "timestamp": 1723597406, "time_this_iter_s": 347.9383342266083, "time_total_s": 4737.5809581279755, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bd5f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4737.5809581279755, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 53.24444444444445, "ram_util_percent": 83.82777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8235192929468458, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5094029761484957, "policy_loss": -0.008444086493919332, "vf_loss": 0.5176438001945378, "vf_explained_var": 0.1537162786122983, "kl": 0.010840723320404236, "entropy": 1.2023874062709707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 231525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0873759267191407, "cur_kl_coeff": 1.2407709188295412e-25, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.28977685547852644, "policy_loss": -0.0017356304446895603, "vf_loss": 0.29151248573719785, "vf_explained_var": 0.1975089430178284, "kl": 0.0016948683473870197, "entropy": 0.05240238147970072, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 231525.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 202.70000000000002, "episode_reward_mean": 362.86799999999994, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 29.900000000000077, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 34.0}, "policy_reward_mean": {"prey_policy": 175.304, "predator_policy": 6.13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [245.6, 342.4, 246.19999999999973, 398.2, 372.8, 370.0, 338.1, 391.0, 363.2, 380.9, 354.1, 366.0, 400.0, 371.0, 358.0, 301.0, 387.1, 319.2, 381.6, 387.9, 372.0, 373.0, 296.9, 360.2, 388.1, 319.0, 383.7, 384.6, 395.5, 391.1, 355.5, 361.7, 395.5, 372.0, 374.0, 342.5, 372.4, 371.0, 394.0, 359.0, 357.4, 308.0, 371.6, 398.2, 363.9, 395.5, 388.3, 394.6, 352.9, 368.6, 364.2, 386.6, 374.4, 379.3, 361.1, 395.0, 332.0, 378.6, 346.7, 328.6, 396.4, 383.2, 356.6, 367.0, 391.1, 361.0, 382.0, 385.0, 297.0999999999999, 370.2, 379.3, 396.4, 355.0, 365.0, 302.0, 374.0, 361.9, 360.40000000000003, 398.0, 396.4, 378.4, 342.40000000000003, 400.0, 297.0999999999999, 365.8, 366.5, 367.1, 358.4, 385.1, 372.8, 370.0, 371.4, 360.7, 356.4, 349.0, 348.0, 371.0, 202.70000000000002, 378.0, 386.5], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [74.00000000000006, 131.6, 173.0, 136.4, 30.199999999999967, 170.0, 198.2, 200.0, 179.9, 191.9, 200.0, 155.0, 170.3, 150.8, 200.0, 191.0, 161.0, 186.2, 182.0, 191.9, 146.0, 190.1, 176.0, 182.0, 200.0, 200.0, 178.0, 190.0, 200.0, 137.0, 98.0, 165.0, 181.1, 200.0, 149.9, 143.3, 191.9, 187.7, 186.8, 199.1, 193.7, 161.3, 200.0, 173.0, 159.5, 103.39999999999999, 168.2, 179.0, 200.0, 169.1, 137.9, 148.1, 199.1, 179.6, 200.0, 179.6, 195.5, 200.0, 199.1, 188.0, 145.1, 181.4, 197.0, 145.7, 200.0, 195.5, 170.0, 188.0, 188.0, 179.0, 168.5, 152.0, 163.1, 197.3, 182.0, 185.0, 200.0, 194.0, 178.4, 164.6, 178.4, 164.0, 134.0, 152.0, 191.9, 172.7, 198.2, 200.0, 176.0, 173.9, 195.5, 200.0, 199.1, 189.2, 197.3, 197.3, 197.3, 125.6, 161.0, 188.6, 173.0, 180.2, 176.3, 197.3, 173.3, 190.1, 189.2, 190.1, 200.0, 160.1, 200.0, 195.0, 200.0, 96.0, 191.0, 179.6, 158.0, 154.7, 152.0, 152.6, 200.0, 196.4, 191.0, 189.2, 176.6, 164.0, 173.0, 185.0, 188.0, 199.1, 191.0, 146.0, 182.0, 200.0, 194.3, 187.7, 109.09999999999998, 182.0, 174.2, 188.0, 179.3, 200.0, 196.4, 200.0, 193.7, 161.3, 195.0, 155.0, 173.0, 126.0, 161.0, 200.0, 191.9, 155.0, 164.9, 195.5, 197.0, 200.0, 200.0, 196.4, 187.4, 182.0, 142.39999999999998, 200.0, 200.0, 200.0, 113.59999999999998, 159.5, 167.0, 189.79999999999998, 170.0, 183.5, 170.0, 187.1, 172.4, 167.0, 200.0, 178.1, 181.7, 190.1, 167.0, 182.0, 164.3, 199.1, 162.2, 186.5, 200.0, 136.4, 170.0, 141.0, 116.0, 190.0, 185.0, 179.0, 29.900000000000077, 114.8, 200.0, 167.0, 190.1, 196.4], "policy_predator_policy_reward": [34.0, 6.0, 11.0, 22.0, 20.0, 26.0, 0.0, 0.0, 0.0, 1.0, 15.0, 0.0, 8.0, 9.0, 0.0, 0.0, 9.0, 7.0, 6.0, 1.0, 18.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 3.0, 0.0, 21.0, 19.0, 19.0, 0.0, 6.0, 0.0, 26.0, 2.0, 0.0, 0.0, 2.0, 11.0, 6.0, 0.0, 0.0, 22.0, 12.0, 0.0, 13.0, 9.0, 10.0, 21.0, 12.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 4.0, 0.0, 12.0, 17.0, 9.0, 10.0, 0.0, 0.0, 7.0, 7.0, 0.0, 7.0, 9.0, 13.0, 12.0, 0.0, 4.0, 0.0, 0.0, 0.0, 7.0, 9.0, 15.0, 0.0, 0.0, 22.0, 7.0, 0.0, 0.0, 0.0, 8.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 14.0, 12.0, 7.0, 11.0, 0.0, 6.0, 7.0, 8.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 15.0, 21.0, 3.0, 5.0, 14.0, 20.0, 4.0, 20.0, 0.0, 0.0, 0.0, 3.0, 0.0, 16.0, 4.0, 5.0, 1.0, 3.0, 9.0, 15.0, 0.0, 0.0, 2.0, 1.0, 6.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 3.0, 0.0, 0.0, 13.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 0.0, 0.0, 12.0, 12.0, 0.0, 9.0, 6.0, 7.0, 10.0, 0.0, 13.0, 6.0, 7.0, 0.0, 1.0, 0.0, 9.0, 12.0, 8.0, 0.0, 12.0, 0.0, 20.0, 0.0, 17.0, 21.0, 28.0, 14.0, 0.0, 7.0, 30.0, 28.0, 0.0, 11.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.369329968400115, "mean_inference_ms": 4.133164860087518, "mean_action_processing_ms": 0.6753456238369556, "mean_env_wait_ms": 0.47554565540604904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007054805755615234, "StateBufferConnector_ms": 0.005294442176818848, "ViewRequirementAgentConnector_ms": 0.17370235919952393}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 202.70000000000002, "episode_return_mean": 362.86799999999994, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.5863528012422, "num_env_steps_trained_throughput_per_sec": 312.5863528012422, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 1968000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1968000, "timers": {"training_iteration_time_ms": 246551.614, "restore_workers_time_ms": 0.015, "training_step_time_ms": 246551.56, "sample_time_ms": 1909.503, "learn_time_ms": 244622.291, "learn_throughput": 16.352, "synch_weights_time_ms": 16.1}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 1968000, "num_agent_steps_trained": 1968000}, "done": false, "training_iteration": 123, "trial_id": "e4caa_00000", "date": "2024-08-13_21-03-38", "timestamp": 1723597418, "time_this_iter_s": 12.838235139846802, "time_total_s": 4750.419193267822, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29e0c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4750.419193267822, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 50.105555555555554, "ram_util_percent": 83.44444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5124337205495784, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.442498925461116, "policy_loss": -0.007103312326467069, "vf_loss": 0.44949263472592943, "vf_explained_var": 0.3532544353651622, "kl": 0.005845502243401015, "entropy": 1.221070836334632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 233415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3288878192425404, "cur_kl_coeff": 6.203854594147706e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3712713219422512, "policy_loss": -0.003545573847023425, "vf_loss": 0.37481689533309903, "vf_explained_var": 0.10740219559619035, "kl": 0.001706997596469165, "entropy": 0.0624137987328506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 233415.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 202.70000000000002, "episode_reward_mean": 365.62699999999995, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 29.900000000000077, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 30.0}, "policy_reward_mean": {"prey_policy": 177.00349999999997, "predator_policy": 5.81}, "custom_metrics": {}, "hist_stats": {"episode_reward": [381.6, 387.9, 372.0, 373.0, 296.9, 360.2, 388.1, 319.0, 383.7, 384.6, 395.5, 391.1, 355.5, 361.7, 395.5, 372.0, 374.0, 342.5, 372.4, 371.0, 394.0, 359.0, 357.4, 308.0, 371.6, 398.2, 363.9, 395.5, 388.3, 394.6, 352.9, 368.6, 364.2, 386.6, 374.4, 379.3, 361.1, 395.0, 332.0, 378.6, 346.7, 328.6, 396.4, 383.2, 356.6, 367.0, 391.1, 361.0, 382.0, 385.0, 297.0999999999999, 370.2, 379.3, 396.4, 355.0, 365.0, 302.0, 374.0, 361.9, 360.40000000000003, 398.0, 396.4, 378.4, 342.40000000000003, 400.0, 297.0999999999999, 365.8, 366.5, 367.1, 358.4, 385.1, 372.8, 370.0, 371.4, 360.7, 356.4, 349.0, 348.0, 371.0, 202.70000000000002, 378.0, 386.5, 314.79999999999995, 389.9, 361.0, 382.4, 393.7, 368.1, 373.4, 324.5, 365.8, 393.7, 320.4000000000001, 355.5, 328.5, 359.2, 400.0, 391.0, 386.2, 372.6], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [191.9, 187.7, 186.8, 199.1, 193.7, 161.3, 200.0, 173.0, 159.5, 103.39999999999999, 168.2, 179.0, 200.0, 169.1, 137.9, 148.1, 199.1, 179.6, 200.0, 179.6, 195.5, 200.0, 199.1, 188.0, 145.1, 181.4, 197.0, 145.7, 200.0, 195.5, 170.0, 188.0, 188.0, 179.0, 168.5, 152.0, 163.1, 197.3, 182.0, 185.0, 200.0, 194.0, 178.4, 164.6, 178.4, 164.0, 134.0, 152.0, 191.9, 172.7, 198.2, 200.0, 176.0, 173.9, 195.5, 200.0, 199.1, 189.2, 197.3, 197.3, 197.3, 125.6, 161.0, 188.6, 173.0, 180.2, 176.3, 197.3, 173.3, 190.1, 189.2, 190.1, 200.0, 160.1, 200.0, 195.0, 200.0, 96.0, 191.0, 179.6, 158.0, 154.7, 152.0, 152.6, 200.0, 196.4, 191.0, 189.2, 176.6, 164.0, 173.0, 185.0, 188.0, 199.1, 191.0, 146.0, 182.0, 200.0, 194.3, 187.7, 109.09999999999998, 182.0, 174.2, 188.0, 179.3, 200.0, 196.4, 200.0, 193.7, 161.3, 195.0, 155.0, 173.0, 126.0, 161.0, 200.0, 191.9, 155.0, 164.9, 195.5, 197.0, 200.0, 200.0, 196.4, 187.4, 182.0, 142.39999999999998, 200.0, 200.0, 200.0, 113.59999999999998, 159.5, 167.0, 189.79999999999998, 170.0, 183.5, 170.0, 187.1, 172.4, 167.0, 200.0, 178.1, 181.7, 190.1, 167.0, 182.0, 164.3, 199.1, 162.2, 186.5, 200.0, 136.4, 170.0, 141.0, 116.0, 190.0, 185.0, 179.0, 29.900000000000077, 114.8, 200.0, 167.0, 190.1, 196.4, 146.3, 141.5, 196.1, 192.8, 173.0, 170.0, 190.1, 188.3, 200.0, 193.7, 190.1, 167.0, 179.0, 187.4, 158.0, 144.5, 172.1, 184.7, 193.7, 200.0, 157.1, 146.3, 191.9, 134.6, 158.6, 146.9, 152.0, 165.2, 200.0, 200.0, 199.0, 188.0, 182.0, 198.2, 197.3, 164.3], "policy_predator_policy_reward": [2.0, 0.0, 0.0, 2.0, 11.0, 6.0, 0.0, 0.0, 22.0, 12.0, 0.0, 13.0, 9.0, 10.0, 21.0, 12.0, 5.0, 0.0, 0.0, 5.0, 0.0, 0.0, 4.0, 0.0, 12.0, 17.0, 9.0, 10.0, 0.0, 0.0, 7.0, 7.0, 0.0, 7.0, 9.0, 13.0, 12.0, 0.0, 4.0, 0.0, 0.0, 0.0, 7.0, 9.0, 15.0, 0.0, 0.0, 22.0, 7.0, 0.0, 0.0, 0.0, 8.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 14.0, 12.0, 7.0, 11.0, 0.0, 6.0, 7.0, 8.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 15.0, 21.0, 3.0, 5.0, 14.0, 20.0, 4.0, 20.0, 0.0, 0.0, 0.0, 3.0, 0.0, 16.0, 4.0, 5.0, 1.0, 3.0, 9.0, 15.0, 0.0, 0.0, 2.0, 1.0, 6.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 3.0, 0.0, 0.0, 13.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 0.0, 0.0, 12.0, 12.0, 0.0, 9.0, 6.0, 7.0, 10.0, 0.0, 13.0, 6.0, 7.0, 0.0, 1.0, 0.0, 9.0, 12.0, 8.0, 0.0, 12.0, 0.0, 20.0, 0.0, 17.0, 21.0, 28.0, 14.0, 0.0, 7.0, 30.0, 28.0, 0.0, 11.0, 0.0, 0.0, 3.0, 24.0, 0.0, 1.0, 10.0, 8.0, 1.0, 3.0, 0.0, 0.0, 11.0, 0.0, 0.0, 7.0, 0.0, 22.0, 5.0, 4.0, 0.0, 0.0, 17.0, 0.0, 12.0, 17.0, 18.0, 5.0, 21.0, 21.0, 0.0, 0.0, 0.0, 4.0, 0.0, 6.0, 11.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3688170967665423, "mean_inference_ms": 4.131262365947984, "mean_action_processing_ms": 0.6727269653725182, "mean_env_wait_ms": 0.47406603394293534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005457043647766113, "StateBufferConnector_ms": 0.004420757293701172, "ViewRequirementAgentConnector_ms": 0.140916109085083}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 202.70000000000002, "episode_return_mean": 365.62699999999995, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.80602803625504, "num_env_steps_trained_throughput_per_sec": 291.80602803625504, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 1984000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1984000, "timers": {"training_iteration_time_ms": 246549.746, "restore_workers_time_ms": 0.015, "training_step_time_ms": 246549.693, "sample_time_ms": 1900.601, "learn_time_ms": 244629.03, "learn_throughput": 16.351, "synch_weights_time_ms": 16.046}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 1984000, "num_agent_steps_trained": 1984000}, "done": false, "training_iteration": 124, "trial_id": "e4caa_00000", "date": "2024-08-13_21-03-52", "timestamp": 1723597432, "time_this_iter_s": 13.758993148803711, "time_total_s": 4764.178186416626, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bd5700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4764.178186416626, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 52.81, "ram_util_percent": 83.815}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5926879635878972, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6754254072360083, "policy_loss": -0.010558173658139018, "vf_loss": 0.6858380546408986, "vf_explained_var": 0.5370732118843724, "kl": 0.007761300404672397, "entropy": 1.1760631558125612, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 235305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.346132728828009, "cur_kl_coeff": 3.101927297073853e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4884951589441804, "policy_loss": -0.0014818039343312934, "vf_loss": 0.48997696154115217, "vf_explained_var": 0.20727609178376577, "kl": 0.0021120042024955162, "entropy": 0.05018905238174493, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 235305.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 202.70000000000002, "episode_reward_mean": 364.91, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 29.900000000000077, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 30.0}, "policy_reward_mean": {"prey_policy": 176.625, "predator_policy": 5.83}, "custom_metrics": {}, "hist_stats": {"episode_reward": [357.4, 308.0, 371.6, 398.2, 363.9, 395.5, 388.3, 394.6, 352.9, 368.6, 364.2, 386.6, 374.4, 379.3, 361.1, 395.0, 332.0, 378.6, 346.7, 328.6, 396.4, 383.2, 356.6, 367.0, 391.1, 361.0, 382.0, 385.0, 297.0999999999999, 370.2, 379.3, 396.4, 355.0, 365.0, 302.0, 374.0, 361.9, 360.40000000000003, 398.0, 396.4, 378.4, 342.40000000000003, 400.0, 297.0999999999999, 365.8, 366.5, 367.1, 358.4, 385.1, 372.8, 370.0, 371.4, 360.7, 356.4, 349.0, 348.0, 371.0, 202.70000000000002, 378.0, 386.5, 314.79999999999995, 389.9, 361.0, 382.4, 393.7, 368.1, 373.4, 324.5, 365.8, 393.7, 320.4000000000001, 355.5, 328.5, 359.2, 400.0, 391.0, 386.2, 372.6, 375.5, 325.8, 350.3, 388.0, 374.3, 358.2, 392.8, 369.0, 354.70000000000005, 385.2, 371.2, 360.3, 365.0, 361.5, 381.8, 398.2, 372.1, 373.6, 383.0, 296.0, 359.9, 363.1], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [178.4, 164.0, 134.0, 152.0, 191.9, 172.7, 198.2, 200.0, 176.0, 173.9, 195.5, 200.0, 199.1, 189.2, 197.3, 197.3, 197.3, 125.6, 161.0, 188.6, 173.0, 180.2, 176.3, 197.3, 173.3, 190.1, 189.2, 190.1, 200.0, 160.1, 200.0, 195.0, 200.0, 96.0, 191.0, 179.6, 158.0, 154.7, 152.0, 152.6, 200.0, 196.4, 191.0, 189.2, 176.6, 164.0, 173.0, 185.0, 188.0, 199.1, 191.0, 146.0, 182.0, 200.0, 194.3, 187.7, 109.09999999999998, 182.0, 174.2, 188.0, 179.3, 200.0, 196.4, 200.0, 193.7, 161.3, 195.0, 155.0, 173.0, 126.0, 161.0, 200.0, 191.9, 155.0, 164.9, 195.5, 197.0, 200.0, 200.0, 196.4, 187.4, 182.0, 142.39999999999998, 200.0, 200.0, 200.0, 113.59999999999998, 159.5, 167.0, 189.79999999999998, 170.0, 183.5, 170.0, 187.1, 172.4, 167.0, 200.0, 178.1, 181.7, 190.1, 167.0, 182.0, 164.3, 199.1, 162.2, 186.5, 200.0, 136.4, 170.0, 141.0, 116.0, 190.0, 185.0, 179.0, 29.900000000000077, 114.8, 200.0, 167.0, 190.1, 196.4, 146.3, 141.5, 196.1, 192.8, 173.0, 170.0, 190.1, 188.3, 200.0, 193.7, 190.1, 167.0, 179.0, 187.4, 158.0, 144.5, 172.1, 184.7, 193.7, 200.0, 157.1, 146.3, 191.9, 134.6, 158.6, 146.9, 152.0, 165.2, 200.0, 200.0, 199.0, 188.0, 182.0, 198.2, 197.3, 164.3, 185.0, 180.5, 163.1, 133.7, 142.1, 198.2, 200.0, 182.0, 182.9, 187.4, 147.20000000000002, 200.0, 193.7, 199.1, 200.0, 152.0, 135.5, 198.2, 194.0, 189.2, 182.0, 189.2, 140.30000000000004, 200.0, 152.0, 200.0, 132.5, 188.0, 191.9, 188.9, 200.0, 198.2, 187.4, 178.7, 179.0, 185.6, 194.0, 170.0, 164.0, 106.0, 143.9, 200.0, 191.0, 172.1], "policy_predator_policy_reward": [15.0, 0.0, 0.0, 22.0, 7.0, 0.0, 0.0, 0.0, 8.0, 6.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 14.0, 12.0, 7.0, 11.0, 0.0, 6.0, 7.0, 8.0, 3.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 15.0, 21.0, 3.0, 5.0, 14.0, 20.0, 4.0, 20.0, 0.0, 0.0, 0.0, 3.0, 0.0, 16.0, 4.0, 5.0, 1.0, 3.0, 9.0, 15.0, 0.0, 0.0, 2.0, 1.0, 6.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 3.0, 0.0, 0.0, 13.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 0.0, 0.0, 12.0, 12.0, 0.0, 9.0, 6.0, 7.0, 10.0, 0.0, 13.0, 6.0, 7.0, 0.0, 1.0, 0.0, 9.0, 12.0, 8.0, 0.0, 12.0, 0.0, 20.0, 0.0, 17.0, 21.0, 28.0, 14.0, 0.0, 7.0, 30.0, 28.0, 0.0, 11.0, 0.0, 0.0, 3.0, 24.0, 0.0, 1.0, 10.0, 8.0, 1.0, 3.0, 0.0, 0.0, 11.0, 0.0, 0.0, 7.0, 0.0, 22.0, 5.0, 4.0, 0.0, 0.0, 17.0, 0.0, 12.0, 17.0, 18.0, 5.0, 21.0, 21.0, 0.0, 0.0, 0.0, 4.0, 0.0, 6.0, 11.0, 0.0, 5.0, 5.0, 23.0, 6.0, 2.0, 8.0, 1.0, 5.0, 3.0, 1.0, 0.0, 11.0, 0.0, 0.0, 1.0, 16.0, 4.0, 17.0, 2.0, 0.0, 0.0, 0.0, 7.0, 13.0, 0.0, 13.0, 20.0, 21.0, 0.0, 1.0, 0.0, 0.0, 3.0, 3.0, 0.0, 9.0, 10.0, 9.0, 0.0, 26.0, 5.0, 11.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.363025024376115, "mean_inference_ms": 4.114405000567883, "mean_action_processing_ms": 0.6694185955808558, "mean_env_wait_ms": 0.47197341071285137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004675865173339844, "StateBufferConnector_ms": 0.004008054733276367, "ViewRequirementAgentConnector_ms": 0.11554813385009766}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 202.70000000000002, "episode_return_mean": 364.91, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.2510684286266, "num_env_steps_trained_throughput_per_sec": 306.2510684286266, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 2000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2000000, "timers": {"training_iteration_time_ms": 245954.366, "restore_workers_time_ms": 0.015, "training_step_time_ms": 245954.313, "sample_time_ms": 1891.718, "learn_time_ms": 244041.967, "learn_throughput": 16.391, "synch_weights_time_ms": 16.365}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "done": false, "training_iteration": 125, "trial_id": "e4caa_00000", "date": "2024-08-13_21-04-05", "timestamp": 1723597445, "time_this_iter_s": 13.096028089523315, "time_total_s": 4777.274214506149, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b7d820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4777.274214506149, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 48.88333333333333, "ram_util_percent": 83.81666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5406665274390468, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5036743154182597, "policy_loss": -0.008987669204484927, "vf_loss": 0.5124569551610245, "vf_explained_var": 0.2904363639770992, "kl": 0.010934847508019773, "entropy": 1.1474743153052356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 237195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2011114025636325, "cur_kl_coeff": 1.5509636485369265e-26, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.45091784437182086, "policy_loss": -0.0009618051197360117, "vf_loss": 0.4518796508959322, "vf_explained_var": 0.0881444619761573, "kl": 0.0018801185408729654, "entropy": 0.04055494278984726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 237195.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 202.70000000000002, "episode_reward_mean": 363.60400000000004, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 29.900000000000077, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 30.0}, "policy_reward_mean": {"prey_policy": 175.68200000000002, "predator_policy": 6.12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [346.7, 328.6, 396.4, 383.2, 356.6, 367.0, 391.1, 361.0, 382.0, 385.0, 297.0999999999999, 370.2, 379.3, 396.4, 355.0, 365.0, 302.0, 374.0, 361.9, 360.40000000000003, 398.0, 396.4, 378.4, 342.40000000000003, 400.0, 297.0999999999999, 365.8, 366.5, 367.1, 358.4, 385.1, 372.8, 370.0, 371.4, 360.7, 356.4, 349.0, 348.0, 371.0, 202.70000000000002, 378.0, 386.5, 314.79999999999995, 389.9, 361.0, 382.4, 393.7, 368.1, 373.4, 324.5, 365.8, 393.7, 320.4000000000001, 355.5, 328.5, 359.2, 400.0, 391.0, 386.2, 372.6, 375.5, 325.8, 350.3, 388.0, 374.3, 358.2, 392.8, 369.0, 354.70000000000005, 385.2, 371.2, 360.3, 365.0, 361.5, 381.8, 398.2, 372.1, 373.6, 383.0, 296.0, 359.9, 363.1, 336.8, 394.0, 360.4, 356.7, 342.1, 357.8, 392.8, 350.5, 347.0, 361.3, 356.6, 374.9, 397.3, 311.9, 359.0, 363.0, 377.5, 400.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [158.0, 154.7, 152.0, 152.6, 200.0, 196.4, 191.0, 189.2, 176.6, 164.0, 173.0, 185.0, 188.0, 199.1, 191.0, 146.0, 182.0, 200.0, 194.3, 187.7, 109.09999999999998, 182.0, 174.2, 188.0, 179.3, 200.0, 196.4, 200.0, 193.7, 161.3, 195.0, 155.0, 173.0, 126.0, 161.0, 200.0, 191.9, 155.0, 164.9, 195.5, 197.0, 200.0, 200.0, 196.4, 187.4, 182.0, 142.39999999999998, 200.0, 200.0, 200.0, 113.59999999999998, 159.5, 167.0, 189.79999999999998, 170.0, 183.5, 170.0, 187.1, 172.4, 167.0, 200.0, 178.1, 181.7, 190.1, 167.0, 182.0, 164.3, 199.1, 162.2, 186.5, 200.0, 136.4, 170.0, 141.0, 116.0, 190.0, 185.0, 179.0, 29.900000000000077, 114.8, 200.0, 167.0, 190.1, 196.4, 146.3, 141.5, 196.1, 192.8, 173.0, 170.0, 190.1, 188.3, 200.0, 193.7, 190.1, 167.0, 179.0, 187.4, 158.0, 144.5, 172.1, 184.7, 193.7, 200.0, 157.1, 146.3, 191.9, 134.6, 158.6, 146.9, 152.0, 165.2, 200.0, 200.0, 199.0, 188.0, 182.0, 198.2, 197.3, 164.3, 185.0, 180.5, 163.1, 133.7, 142.1, 198.2, 200.0, 182.0, 182.9, 187.4, 147.20000000000002, 200.0, 193.7, 199.1, 200.0, 152.0, 135.5, 198.2, 194.0, 189.2, 182.0, 189.2, 140.30000000000004, 200.0, 152.0, 200.0, 132.5, 188.0, 191.9, 188.9, 200.0, 198.2, 187.4, 178.7, 179.0, 185.6, 194.0, 170.0, 164.0, 106.0, 143.9, 200.0, 191.0, 172.1, 173.0, 135.8, 197.0, 194.0, 161.0, 181.4, 128.0, 193.7, 116.6, 195.5, 150.2, 194.6, 199.1, 193.7, 168.5, 170.0, 158.3, 175.7, 179.3, 173.0, 143.0, 194.6, 185.0, 182.9, 197.3, 200.0, 80.0, 191.9, 175.0, 176.0, 170.0, 183.0, 197.3, 180.2, 200.0, 200.0], "policy_predator_policy_reward": [14.0, 20.0, 4.0, 20.0, 0.0, 0.0, 0.0, 3.0, 0.0, 16.0, 4.0, 5.0, 1.0, 3.0, 9.0, 15.0, 0.0, 0.0, 2.0, 1.0, 6.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 3.0, 0.0, 0.0, 13.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 0.0, 0.0, 12.0, 12.0, 0.0, 9.0, 6.0, 7.0, 10.0, 0.0, 13.0, 6.0, 7.0, 0.0, 1.0, 0.0, 9.0, 12.0, 8.0, 0.0, 12.0, 0.0, 20.0, 0.0, 17.0, 21.0, 28.0, 14.0, 0.0, 7.0, 30.0, 28.0, 0.0, 11.0, 0.0, 0.0, 3.0, 24.0, 0.0, 1.0, 10.0, 8.0, 1.0, 3.0, 0.0, 0.0, 11.0, 0.0, 0.0, 7.0, 0.0, 22.0, 5.0, 4.0, 0.0, 0.0, 17.0, 0.0, 12.0, 17.0, 18.0, 5.0, 21.0, 21.0, 0.0, 0.0, 0.0, 4.0, 0.0, 6.0, 11.0, 0.0, 5.0, 5.0, 23.0, 6.0, 2.0, 8.0, 1.0, 5.0, 3.0, 1.0, 0.0, 11.0, 0.0, 0.0, 1.0, 16.0, 4.0, 17.0, 2.0, 0.0, 0.0, 0.0, 7.0, 13.0, 0.0, 13.0, 20.0, 21.0, 0.0, 1.0, 0.0, 0.0, 3.0, 3.0, 0.0, 9.0, 10.0, 9.0, 0.0, 26.0, 5.0, 11.0, 0.0, 0.0, 9.0, 19.0, 3.0, 0.0, 13.0, 5.0, 17.0, 18.0, 17.0, 13.0, 0.0, 13.0, 0.0, 0.0, 12.0, 0.0, 13.0, 0.0, 9.0, 0.0, 7.0, 12.0, 7.0, 0.0, 0.0, 0.0, 28.0, 12.0, 8.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3964392392738745, "mean_inference_ms": 4.19542676641984, "mean_action_processing_ms": 0.7048848495054751, "mean_env_wait_ms": 0.470191940470926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041730403900146484, "StateBufferConnector_ms": 0.003998756408691406, "ViewRequirementAgentConnector_ms": 0.11110365390777588}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 202.70000000000002, "episode_return_mean": 363.60400000000004, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 60.45251299684371, "num_env_steps_trained_throughput_per_sec": 60.45251299684371, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 2016000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2016000, "timers": {"training_iteration_time_ms": 241602.656, "restore_workers_time_ms": 0.015, "training_step_time_ms": 241602.604, "sample_time_ms": 7203.288, "learn_time_ms": 234379.142, "learn_throughput": 17.066, "synch_weights_time_ms": 16.645}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 2016000, "num_agent_steps_trained": 2016000}, "done": false, "training_iteration": 126, "trial_id": "e4caa_00000", "date": "2024-08-13_21-05-12", "timestamp": 1723597512, "time_this_iter_s": 66.21622896194458, "time_total_s": 4843.490443468094, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29cedc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4843.490443468094, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 50.45555555555555, "ram_util_percent": 83.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.547137751244994, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6855286559821772, "policy_loss": -0.00844299458497002, "vf_loss": 0.6937359766872038, "vf_explained_var": 0.397456526882434, "kl": 0.012569277812663588, "entropy": 1.1346758872743636, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 239085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4781045133474642, "cur_kl_coeff": 7.754818242684633e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7224656656778679, "policy_loss": -0.0019042948600910012, "vf_loss": 0.7243699599412226, "vf_explained_var": 0.07696194380679458, "kl": 0.0017501615085291193, "entropy": 0.050002976013199675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 239085.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 202.70000000000002, "episode_reward_mean": 363.43799999999993, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 29.900000000000077, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 30.0}, "policy_reward_mean": {"prey_policy": 175.139, "predator_policy": 6.58}, "custom_metrics": {}, "hist_stats": {"episode_reward": [361.9, 360.40000000000003, 398.0, 396.4, 378.4, 342.40000000000003, 400.0, 297.0999999999999, 365.8, 366.5, 367.1, 358.4, 385.1, 372.8, 370.0, 371.4, 360.7, 356.4, 349.0, 348.0, 371.0, 202.70000000000002, 378.0, 386.5, 314.79999999999995, 389.9, 361.0, 382.4, 393.7, 368.1, 373.4, 324.5, 365.8, 393.7, 320.4000000000001, 355.5, 328.5, 359.2, 400.0, 391.0, 386.2, 372.6, 375.5, 325.8, 350.3, 388.0, 374.3, 358.2, 392.8, 369.0, 354.70000000000005, 385.2, 371.2, 360.3, 365.0, 361.5, 381.8, 398.2, 372.1, 373.6, 383.0, 296.0, 359.9, 363.1, 336.8, 394.0, 360.4, 356.7, 342.1, 357.8, 392.8, 350.5, 347.0, 361.3, 356.6, 374.9, 397.3, 311.9, 359.0, 363.0, 377.5, 400.0, 365.9, 321.1, 379.3, 380.2, 394.6, 360.7, 325.0, 359.1, 347.2, 365.7, 369.0, 360.2, 391.0, 381.1, 354.0, 351.0, 390.0, 324.9], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [191.9, 155.0, 164.9, 195.5, 197.0, 200.0, 200.0, 196.4, 187.4, 182.0, 142.39999999999998, 200.0, 200.0, 200.0, 113.59999999999998, 159.5, 167.0, 189.79999999999998, 170.0, 183.5, 170.0, 187.1, 172.4, 167.0, 200.0, 178.1, 181.7, 190.1, 167.0, 182.0, 164.3, 199.1, 162.2, 186.5, 200.0, 136.4, 170.0, 141.0, 116.0, 190.0, 185.0, 179.0, 29.900000000000077, 114.8, 200.0, 167.0, 190.1, 196.4, 146.3, 141.5, 196.1, 192.8, 173.0, 170.0, 190.1, 188.3, 200.0, 193.7, 190.1, 167.0, 179.0, 187.4, 158.0, 144.5, 172.1, 184.7, 193.7, 200.0, 157.1, 146.3, 191.9, 134.6, 158.6, 146.9, 152.0, 165.2, 200.0, 200.0, 199.0, 188.0, 182.0, 198.2, 197.3, 164.3, 185.0, 180.5, 163.1, 133.7, 142.1, 198.2, 200.0, 182.0, 182.9, 187.4, 147.20000000000002, 200.0, 193.7, 199.1, 200.0, 152.0, 135.5, 198.2, 194.0, 189.2, 182.0, 189.2, 140.30000000000004, 200.0, 152.0, 200.0, 132.5, 188.0, 191.9, 188.9, 200.0, 198.2, 187.4, 178.7, 179.0, 185.6, 194.0, 170.0, 164.0, 106.0, 143.9, 200.0, 191.0, 172.1, 173.0, 135.8, 197.0, 194.0, 161.0, 181.4, 128.0, 193.7, 116.6, 195.5, 150.2, 194.6, 199.1, 193.7, 168.5, 170.0, 158.3, 175.7, 179.3, 173.0, 143.0, 194.6, 185.0, 182.9, 197.3, 200.0, 80.0, 191.9, 175.0, 176.0, 170.0, 183.0, 197.3, 180.2, 200.0, 200.0, 179.9, 173.0, 166.7, 136.4, 200.0, 179.3, 186.5, 193.7, 197.3, 197.3, 179.0, 166.7, 141.2, 147.8, 192.8, 143.3, 165.2, 170.0, 188.0, 163.7, 195.5, 162.5, 143.3, 191.9, 192.8, 198.2, 189.2, 191.9, 173.0, 170.0, 124.0, 191.0, 200.0, 185.0, 115.4, 174.5], "policy_predator_policy_reward": [15.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 3.0, 0.0, 0.0, 0.0, 0.0, 12.0, 12.0, 0.0, 9.0, 6.0, 7.0, 10.0, 0.0, 13.0, 6.0, 7.0, 0.0, 1.0, 0.0, 9.0, 12.0, 8.0, 0.0, 12.0, 0.0, 20.0, 0.0, 17.0, 21.0, 28.0, 14.0, 0.0, 7.0, 30.0, 28.0, 0.0, 11.0, 0.0, 0.0, 3.0, 24.0, 0.0, 1.0, 10.0, 8.0, 1.0, 3.0, 0.0, 0.0, 11.0, 0.0, 0.0, 7.0, 0.0, 22.0, 5.0, 4.0, 0.0, 0.0, 17.0, 0.0, 12.0, 17.0, 18.0, 5.0, 21.0, 21.0, 0.0, 0.0, 0.0, 4.0, 0.0, 6.0, 11.0, 0.0, 5.0, 5.0, 23.0, 6.0, 2.0, 8.0, 1.0, 5.0, 3.0, 1.0, 0.0, 11.0, 0.0, 0.0, 1.0, 16.0, 4.0, 17.0, 2.0, 0.0, 0.0, 0.0, 7.0, 13.0, 0.0, 13.0, 20.0, 21.0, 0.0, 1.0, 0.0, 0.0, 3.0, 3.0, 0.0, 9.0, 10.0, 9.0, 0.0, 26.0, 5.0, 11.0, 0.0, 0.0, 9.0, 19.0, 3.0, 0.0, 13.0, 5.0, 17.0, 18.0, 17.0, 13.0, 0.0, 13.0, 0.0, 0.0, 12.0, 0.0, 13.0, 0.0, 9.0, 0.0, 7.0, 12.0, 7.0, 0.0, 0.0, 0.0, 28.0, 12.0, 8.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 9.0, 1.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 19.0, 17.0, 10.0, 13.0, 10.0, 2.0, 14.0, 0.0, 11.0, 0.0, 10.0, 15.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 18.0, 18.0, 0.0, 5.0, 17.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4296266480247846, "mean_inference_ms": 4.27581929098253, "mean_action_processing_ms": 0.7400576214454979, "mean_env_wait_ms": 0.4684423977147029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004300832748413086, "StateBufferConnector_ms": 0.004372119903564453, "ViewRequirementAgentConnector_ms": 0.1136484146118164}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 202.70000000000002, "episode_return_mean": 363.43799999999993, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.69068706500815, "num_env_steps_trained_throughput_per_sec": 314.69068706500815, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 2032000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2032000, "timers": {"training_iteration_time_ms": 241539.48, "restore_workers_time_ms": 0.014, "training_step_time_ms": 241539.432, "sample_time_ms": 7180.957, "learn_time_ms": 234338.067, "learn_throughput": 17.069, "synch_weights_time_ms": 16.757}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 2032000, "num_agent_steps_trained": 2032000}, "done": false, "training_iteration": 127, "trial_id": "e4caa_00000", "date": "2024-08-13_21-05-24", "timestamp": 1723597524, "time_this_iter_s": 12.752949237823486, "time_total_s": 4856.243392705917, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b5aca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4856.243392705917, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 48.400000000000006, "ram_util_percent": 83.68888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5941212316038746, "cur_kl_coeff": 0.018749999999999996, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5665381034777042, "policy_loss": -0.009382395327298178, "vf_loss": 0.5758346325572501, "vf_explained_var": 0.4172735316097421, "kl": 0.004579562010563746, "entropy": 1.1295748084941237, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 240975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4494444708581324, "cur_kl_coeff": 3.8774091213423164e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5089183218895443, "policy_loss": -0.0017782892130078778, "vf_loss": 0.5106966109847817, "vf_explained_var": 0.1653974368774071, "kl": 0.004216698694793818, "entropy": 0.04016169900340694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 240975.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 291.9, "episode_reward_mean": 364.471, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 80.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 28.0}, "policy_reward_mean": {"prey_policy": 175.6755, "predator_policy": 6.56}, "custom_metrics": {}, "hist_stats": {"episode_reward": [386.5, 314.79999999999995, 389.9, 361.0, 382.4, 393.7, 368.1, 373.4, 324.5, 365.8, 393.7, 320.4000000000001, 355.5, 328.5, 359.2, 400.0, 391.0, 386.2, 372.6, 375.5, 325.8, 350.3, 388.0, 374.3, 358.2, 392.8, 369.0, 354.70000000000005, 385.2, 371.2, 360.3, 365.0, 361.5, 381.8, 398.2, 372.1, 373.6, 383.0, 296.0, 359.9, 363.1, 336.8, 394.0, 360.4, 356.7, 342.1, 357.8, 392.8, 350.5, 347.0, 361.3, 356.6, 374.9, 397.3, 311.9, 359.0, 363.0, 377.5, 400.0, 365.9, 321.1, 379.3, 380.2, 394.6, 360.7, 325.0, 359.1, 347.2, 365.7, 369.0, 360.2, 391.0, 381.1, 354.0, 351.0, 390.0, 324.9, 373.9, 385.5, 384.7, 370.9, 351.4, 368.00000000000006, 291.9, 391.9, 371.1, 324.00000000000006, 351.6, 362.7, 380.3, 348.0, 370.8, 345.5, 375.70000000000005, 369.0, 383.0, 343.0, 360.4, 377.1, 380.4], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [190.1, 196.4, 146.3, 141.5, 196.1, 192.8, 173.0, 170.0, 190.1, 188.3, 200.0, 193.7, 190.1, 167.0, 179.0, 187.4, 158.0, 144.5, 172.1, 184.7, 193.7, 200.0, 157.1, 146.3, 191.9, 134.6, 158.6, 146.9, 152.0, 165.2, 200.0, 200.0, 199.0, 188.0, 182.0, 198.2, 197.3, 164.3, 185.0, 180.5, 163.1, 133.7, 142.1, 198.2, 200.0, 182.0, 182.9, 187.4, 147.20000000000002, 200.0, 193.7, 199.1, 200.0, 152.0, 135.5, 198.2, 194.0, 189.2, 182.0, 189.2, 140.30000000000004, 200.0, 152.0, 200.0, 132.5, 188.0, 191.9, 188.9, 200.0, 198.2, 187.4, 178.7, 179.0, 185.6, 194.0, 170.0, 164.0, 106.0, 143.9, 200.0, 191.0, 172.1, 173.0, 135.8, 197.0, 194.0, 161.0, 181.4, 128.0, 193.7, 116.6, 195.5, 150.2, 194.6, 199.1, 193.7, 168.5, 170.0, 158.3, 175.7, 179.3, 173.0, 143.0, 194.6, 185.0, 182.9, 197.3, 200.0, 80.0, 191.9, 175.0, 176.0, 170.0, 183.0, 197.3, 180.2, 200.0, 200.0, 179.9, 173.0, 166.7, 136.4, 200.0, 179.3, 186.5, 193.7, 197.3, 197.3, 179.0, 166.7, 141.2, 147.8, 192.8, 143.3, 165.2, 170.0, 188.0, 163.7, 195.5, 162.5, 143.3, 191.9, 192.8, 198.2, 189.2, 191.9, 173.0, 170.0, 124.0, 191.0, 200.0, 185.0, 115.4, 174.5, 197.3, 167.6, 200.0, 180.5, 194.6, 190.1, 191.9, 167.0, 116.0, 187.4, 171.8, 177.2, 120.79999999999998, 148.1, 191.9, 200.0, 157.1, 200.0, 194.0, 95.0, 176.6, 158.0, 151.7, 185.0, 194.3, 179.0, 163.7, 173.3, 200.0, 159.8, 163.4, 160.1, 175.7, 200.0, 189.0, 180.0, 199.0, 184.0, 176.0, 133.0, 178.4, 173.0, 172.1, 194.0, 200.0, 172.4], "policy_predator_policy_reward": [0.0, 0.0, 3.0, 24.0, 0.0, 1.0, 10.0, 8.0, 1.0, 3.0, 0.0, 0.0, 11.0, 0.0, 0.0, 7.0, 0.0, 22.0, 5.0, 4.0, 0.0, 0.0, 17.0, 0.0, 12.0, 17.0, 18.0, 5.0, 21.0, 21.0, 0.0, 0.0, 0.0, 4.0, 0.0, 6.0, 11.0, 0.0, 5.0, 5.0, 23.0, 6.0, 2.0, 8.0, 1.0, 5.0, 3.0, 1.0, 0.0, 11.0, 0.0, 0.0, 1.0, 16.0, 4.0, 17.0, 2.0, 0.0, 0.0, 0.0, 7.0, 13.0, 0.0, 13.0, 20.0, 21.0, 0.0, 1.0, 0.0, 0.0, 3.0, 3.0, 0.0, 9.0, 10.0, 9.0, 0.0, 26.0, 5.0, 11.0, 0.0, 0.0, 9.0, 19.0, 3.0, 0.0, 13.0, 5.0, 17.0, 18.0, 17.0, 13.0, 0.0, 13.0, 0.0, 0.0, 12.0, 0.0, 13.0, 0.0, 9.0, 0.0, 7.0, 12.0, 7.0, 0.0, 0.0, 0.0, 28.0, 12.0, 8.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 9.0, 1.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 19.0, 17.0, 10.0, 13.0, 10.0, 2.0, 14.0, 0.0, 11.0, 0.0, 10.0, 15.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 18.0, 18.0, 0.0, 5.0, 17.0, 18.0, 9.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 11.0, 23.0, 25.0, 11.0, 8.0, 4.0, 19.0, 0.0, 0.0, 4.0, 10.0, 16.0, 19.0, 1.0, 16.0, 16.0, 10.0, 0.0, 7.0, 0.0, 11.0, 2.0, 9.0, 8.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 14.0, 9.0, 0.0, 1.0, 10.0, 8.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4710892923859384, "mean_inference_ms": 4.371355694091715, "mean_action_processing_ms": 0.7931175699735165, "mean_env_wait_ms": 0.4663674314381205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004268288612365723, "StateBufferConnector_ms": 0.004316926002502441, "ViewRequirementAgentConnector_ms": 0.11346745491027832}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 291.9, "episode_return_mean": 364.471, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.8734899079635, "num_env_steps_trained_throughput_per_sec": 302.8734899079635, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 2048000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2048000, "timers": {"training_iteration_time_ms": 241565.033, "restore_workers_time_ms": 0.014, "training_step_time_ms": 241564.983, "sample_time_ms": 7187.447, "learn_time_ms": 234356.382, "learn_throughput": 17.068, "synch_weights_time_ms": 16.61}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 2048000, "num_agent_steps_trained": 2048000}, "done": false, "training_iteration": 128, "trial_id": "e4caa_00000", "date": "2024-08-13_21-05-38", "timestamp": 1723597538, "time_this_iter_s": 13.235841751098633, "time_total_s": 4869.479234457016, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b5aee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 4869.479234457016, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 50.026315789473685, "ram_util_percent": 83.70526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6685061290702492, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.36733993537247883, "policy_loss": -0.005530575729004802, "vf_loss": 0.3728076196063763, "vf_explained_var": 0.38018208537152204, "kl": 0.006708522217470894, "entropy": 1.143525529916955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 242865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.122650018902052, "cur_kl_coeff": 1.9387045606711582e-27, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2195296034335144, "policy_loss": -0.001437890506226313, "vf_loss": 0.2209674948546789, "vf_explained_var": 0.36046700881271765, "kl": 0.0017283565443700214, "entropy": 0.04342740243892111, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 242865.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 291.9, "episode_reward_mean": 367.12200000000007, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 80.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 28.0}, "policy_reward_mean": {"prey_policy": 177.511, "predator_policy": 6.05}, "custom_metrics": {}, "hist_stats": {"episode_reward": [388.0, 374.3, 358.2, 392.8, 369.0, 354.70000000000005, 385.2, 371.2, 360.3, 365.0, 361.5, 381.8, 398.2, 372.1, 373.6, 383.0, 296.0, 359.9, 363.1, 336.8, 394.0, 360.4, 356.7, 342.1, 357.8, 392.8, 350.5, 347.0, 361.3, 356.6, 374.9, 397.3, 311.9, 359.0, 363.0, 377.5, 400.0, 365.9, 321.1, 379.3, 380.2, 394.6, 360.7, 325.0, 359.1, 347.2, 365.7, 369.0, 360.2, 391.0, 381.1, 354.0, 351.0, 390.0, 324.9, 373.9, 385.5, 384.7, 370.9, 351.4, 368.00000000000006, 291.9, 391.9, 371.1, 324.00000000000006, 351.6, 362.7, 380.3, 348.0, 370.8, 345.5, 375.70000000000005, 369.0, 383.0, 343.0, 360.4, 377.1, 380.4, 392.8, 342.0, 375.7, 396.0, 368.3, 370.1, 373.9, 382.6, 359.1, 400.0, 389.9, 382.4, 391.0, 359.3, 383.3, 365.3, 400.0, 380.1, 369.0, 371.0, 350.1, 382.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 182.0, 182.9, 187.4, 147.20000000000002, 200.0, 193.7, 199.1, 200.0, 152.0, 135.5, 198.2, 194.0, 189.2, 182.0, 189.2, 140.30000000000004, 200.0, 152.0, 200.0, 132.5, 188.0, 191.9, 188.9, 200.0, 198.2, 187.4, 178.7, 179.0, 185.6, 194.0, 170.0, 164.0, 106.0, 143.9, 200.0, 191.0, 172.1, 173.0, 135.8, 197.0, 194.0, 161.0, 181.4, 128.0, 193.7, 116.6, 195.5, 150.2, 194.6, 199.1, 193.7, 168.5, 170.0, 158.3, 175.7, 179.3, 173.0, 143.0, 194.6, 185.0, 182.9, 197.3, 200.0, 80.0, 191.9, 175.0, 176.0, 170.0, 183.0, 197.3, 180.2, 200.0, 200.0, 179.9, 173.0, 166.7, 136.4, 200.0, 179.3, 186.5, 193.7, 197.3, 197.3, 179.0, 166.7, 141.2, 147.8, 192.8, 143.3, 165.2, 170.0, 188.0, 163.7, 195.5, 162.5, 143.3, 191.9, 192.8, 198.2, 189.2, 191.9, 173.0, 170.0, 124.0, 191.0, 200.0, 185.0, 115.4, 174.5, 197.3, 167.6, 200.0, 180.5, 194.6, 190.1, 191.9, 167.0, 116.0, 187.4, 171.8, 177.2, 120.79999999999998, 148.1, 191.9, 200.0, 157.1, 200.0, 194.0, 95.0, 176.6, 158.0, 151.7, 185.0, 194.3, 179.0, 163.7, 173.3, 200.0, 159.8, 163.4, 160.1, 175.7, 200.0, 189.0, 180.0, 199.0, 184.0, 176.0, 133.0, 178.4, 173.0, 172.1, 194.0, 200.0, 172.4, 200.0, 192.8, 158.0, 152.0, 180.2, 195.5, 194.0, 200.0, 188.3, 170.0, 182.0, 175.1, 161.3, 194.6, 196.4, 180.2, 140.0, 199.1, 200.0, 200.0, 197.0, 191.9, 198.2, 177.2, 200.0, 191.0, 166.4, 182.9, 200.0, 176.3, 179.3, 179.0, 200.0, 200.0, 191.9, 183.2, 170.0, 189.0, 191.0, 170.0, 131.0, 199.1, 182.0, 200.0], "policy_predator_policy_reward": [1.0, 5.0, 3.0, 1.0, 0.0, 11.0, 0.0, 0.0, 1.0, 16.0, 4.0, 17.0, 2.0, 0.0, 0.0, 0.0, 7.0, 13.0, 0.0, 13.0, 20.0, 21.0, 0.0, 1.0, 0.0, 0.0, 3.0, 3.0, 0.0, 9.0, 10.0, 9.0, 0.0, 26.0, 5.0, 11.0, 0.0, 0.0, 9.0, 19.0, 3.0, 0.0, 13.0, 5.0, 17.0, 18.0, 17.0, 13.0, 0.0, 13.0, 0.0, 0.0, 12.0, 0.0, 13.0, 0.0, 9.0, 0.0, 7.0, 12.0, 7.0, 0.0, 0.0, 0.0, 28.0, 12.0, 8.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 9.0, 1.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 19.0, 17.0, 10.0, 13.0, 10.0, 2.0, 14.0, 0.0, 11.0, 0.0, 10.0, 15.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 18.0, 18.0, 0.0, 5.0, 17.0, 18.0, 9.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 11.0, 23.0, 25.0, 11.0, 8.0, 4.0, 19.0, 0.0, 0.0, 4.0, 10.0, 16.0, 19.0, 1.0, 16.0, 16.0, 10.0, 0.0, 7.0, 0.0, 11.0, 2.0, 9.0, 8.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 14.0, 9.0, 0.0, 1.0, 10.0, 8.0, 0.0, 0.0, 0.0, 16.0, 16.0, 0.0, 0.0, 2.0, 0.0, 10.0, 0.0, 5.0, 8.0, 12.0, 6.0, 0.0, 6.0, 20.0, 0.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 7.0, 0.0, 7.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5124621221191985, "mean_inference_ms": 4.4794761436261785, "mean_action_processing_ms": 0.8272167600998589, "mean_env_wait_ms": 0.46480779504730413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004284501075744629, "StateBufferConnector_ms": 0.0044051408767700195, "ViewRequirementAgentConnector_ms": 0.11599159240722656}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 291.9, "episode_return_mean": 367.12200000000007, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.4800965295006827, "num_env_steps_trained_throughput_per_sec": 1.4800965295006827, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 2064000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2064000, "timers": {"training_iteration_time_ms": 321609.672, "restore_workers_time_ms": 0.014, "training_step_time_ms": 321609.622, "sample_time_ms": 7168.55, "learn_time_ms": 314418.453, "learn_throughput": 12.722, "synch_weights_time_ms": 18.358}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 2064000, "num_agent_steps_trained": 2064000}, "done": false, "training_iteration": 129, "trial_id": "e4caa_00000", "date": "2024-08-13_21-50-41", "timestamp": 1723600241, "time_this_iter_s": 2702.858572244644, "time_total_s": 7572.33780670166, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b298fb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7572.33780670166, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 79.9952380952381, "ram_util_percent": 84.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4967106464678648, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5141786283470946, "policy_loss": -0.0062976392429499395, "vf_loss": 0.5204013862129715, "vf_explained_var": 0.2907204264055484, "kl": 0.007987380888197256, "entropy": 1.1320189616036793, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 244755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2264218940739593, "cur_kl_coeff": 9.693522803355791e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.434677285980926, "policy_loss": -0.0027381247128778824, "vf_loss": 0.43741541163177877, "vf_explained_var": 0.1929283290628403, "kl": 0.0025039907800042424, "entropy": 0.04473553430190477, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 244755.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 291.9, "episode_reward_mean": 367.8859999999999, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 80.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 28.0}, "policy_reward_mean": {"prey_policy": 177.97799999999998, "predator_policy": 5.965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [363.1, 336.8, 394.0, 360.4, 356.7, 342.1, 357.8, 392.8, 350.5, 347.0, 361.3, 356.6, 374.9, 397.3, 311.9, 359.0, 363.0, 377.5, 400.0, 365.9, 321.1, 379.3, 380.2, 394.6, 360.7, 325.0, 359.1, 347.2, 365.7, 369.0, 360.2, 391.0, 381.1, 354.0, 351.0, 390.0, 324.9, 373.9, 385.5, 384.7, 370.9, 351.4, 368.00000000000006, 291.9, 391.9, 371.1, 324.00000000000006, 351.6, 362.7, 380.3, 348.0, 370.8, 345.5, 375.70000000000005, 369.0, 383.0, 343.0, 360.4, 377.1, 380.4, 392.8, 342.0, 375.7, 396.0, 368.3, 370.1, 373.9, 382.6, 359.1, 400.0, 389.9, 382.4, 391.0, 359.3, 383.3, 365.3, 400.0, 380.1, 369.0, 371.0, 350.1, 382.0, 350.2, 371.6, 369.1, 392.8, 388.4, 339.8, 372.8, 383.3, 398.2, 393.1, 354.5, 361.9, 369.0, 383.1, 377.0, 397.0, 382.7, 336.7], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [191.0, 172.1, 173.0, 135.8, 197.0, 194.0, 161.0, 181.4, 128.0, 193.7, 116.6, 195.5, 150.2, 194.6, 199.1, 193.7, 168.5, 170.0, 158.3, 175.7, 179.3, 173.0, 143.0, 194.6, 185.0, 182.9, 197.3, 200.0, 80.0, 191.9, 175.0, 176.0, 170.0, 183.0, 197.3, 180.2, 200.0, 200.0, 179.9, 173.0, 166.7, 136.4, 200.0, 179.3, 186.5, 193.7, 197.3, 197.3, 179.0, 166.7, 141.2, 147.8, 192.8, 143.3, 165.2, 170.0, 188.0, 163.7, 195.5, 162.5, 143.3, 191.9, 192.8, 198.2, 189.2, 191.9, 173.0, 170.0, 124.0, 191.0, 200.0, 185.0, 115.4, 174.5, 197.3, 167.6, 200.0, 180.5, 194.6, 190.1, 191.9, 167.0, 116.0, 187.4, 171.8, 177.2, 120.79999999999998, 148.1, 191.9, 200.0, 157.1, 200.0, 194.0, 95.0, 176.6, 158.0, 151.7, 185.0, 194.3, 179.0, 163.7, 173.3, 200.0, 159.8, 163.4, 160.1, 175.7, 200.0, 189.0, 180.0, 199.0, 184.0, 176.0, 133.0, 178.4, 173.0, 172.1, 194.0, 200.0, 172.4, 200.0, 192.8, 158.0, 152.0, 180.2, 195.5, 194.0, 200.0, 188.3, 170.0, 182.0, 175.1, 161.3, 194.6, 196.4, 180.2, 140.0, 199.1, 200.0, 200.0, 197.0, 191.9, 198.2, 177.2, 200.0, 191.0, 166.4, 182.9, 200.0, 176.3, 179.3, 179.0, 200.0, 200.0, 191.9, 183.2, 170.0, 189.0, 191.0, 170.0, 131.0, 199.1, 182.0, 200.0, 147.2, 179.0, 167.6, 194.0, 173.0, 190.1, 192.8, 200.0, 188.0, 196.4, 150.8, 167.0, 200.0, 162.79999999999998, 200.0, 176.3, 200.0, 198.2, 190.1, 200.0, 146.9, 185.6, 145.7, 189.2, 179.3, 178.7, 175.1, 200.0, 200.0, 161.0, 200.0, 197.0, 194.3, 187.4, 142.7, 170.0], "policy_predator_policy_reward": [0.0, 0.0, 9.0, 19.0, 3.0, 0.0, 13.0, 5.0, 17.0, 18.0, 17.0, 13.0, 0.0, 13.0, 0.0, 0.0, 12.0, 0.0, 13.0, 0.0, 9.0, 0.0, 7.0, 12.0, 7.0, 0.0, 0.0, 0.0, 28.0, 12.0, 8.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 9.0, 1.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 19.0, 17.0, 10.0, 13.0, 10.0, 2.0, 14.0, 0.0, 11.0, 0.0, 10.0, 15.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 18.0, 18.0, 0.0, 5.0, 17.0, 18.0, 9.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 11.0, 23.0, 25.0, 11.0, 8.0, 4.0, 19.0, 0.0, 0.0, 4.0, 10.0, 16.0, 19.0, 1.0, 16.0, 16.0, 10.0, 0.0, 7.0, 0.0, 11.0, 2.0, 9.0, 8.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 14.0, 9.0, 0.0, 1.0, 10.0, 8.0, 0.0, 0.0, 0.0, 16.0, 16.0, 0.0, 0.0, 2.0, 0.0, 10.0, 0.0, 5.0, 8.0, 12.0, 6.0, 0.0, 6.0, 20.0, 0.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 7.0, 0.0, 7.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 17.0, 7.0, 1.0, 9.0, 6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 22.0, 4.0, 6.0, 0.0, 7.0, 0.0, 0.0, 3.0, 0.0, 12.0, 10.0, 15.0, 12.0, 6.0, 5.0, 8.0, 0.0, 3.0, 13.0, 0.0, 0.0, 0.0, 1.0, 8.0, 16.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5459026210269122, "mean_inference_ms": 4.558101739780066, "mean_action_processing_ms": 0.8620452105650556, "mean_env_wait_ms": 0.4630897383420131, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004624724388122559, "StateBufferConnector_ms": 0.00476682186126709, "ViewRequirementAgentConnector_ms": 0.12641632556915283}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 291.9, "episode_return_mean": 367.8859999999999, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.9208391333794, "num_env_steps_trained_throughput_per_sec": 241.9208391333794, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 2080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2080000, "timers": {"training_iteration_time_ms": 321329.299, "restore_workers_time_ms": 0.017, "training_step_time_ms": 321329.248, "sample_time_ms": 7128.24, "learn_time_ms": 314176.242, "learn_throughput": 12.732, "synch_weights_time_ms": 19.859}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "done": false, "training_iteration": 130, "trial_id": "e4caa_00000", "date": "2024-08-13_21-50-57", "timestamp": 1723600257, "time_this_iter_s": 16.628875017166138, "time_total_s": 7588.966681718826, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b298fd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 7588.966681718826, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 79.71249999999999, "ram_util_percent": 83.8875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5908791349678444, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5200147900211738, "policy_loss": -0.006414385251553049, "vf_loss": 0.52635891812548, "vf_explained_var": 0.41016765123321897, "kl": 0.0074941008008359775, "entropy": 1.1302293051487555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 246645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.142725366298799, "cur_kl_coeff": 4.8467614016778955e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.38899599782846594, "policy_loss": -0.002540131012549397, "vf_loss": 0.391536129277234, "vf_explained_var": 0.12586142379770834, "kl": 0.001887706224248964, "entropy": 0.020569707448323253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 246645.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 291.9, "episode_reward_mean": 368.84, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 95.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 26.0}, "policy_reward_mean": {"prey_policy": 178.41, "predator_policy": 6.01}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, 365.9, 321.1, 379.3, 380.2, 394.6, 360.7, 325.0, 359.1, 347.2, 365.7, 369.0, 360.2, 391.0, 381.1, 354.0, 351.0, 390.0, 324.9, 373.9, 385.5, 384.7, 370.9, 351.4, 368.00000000000006, 291.9, 391.9, 371.1, 324.00000000000006, 351.6, 362.7, 380.3, 348.0, 370.8, 345.5, 375.70000000000005, 369.0, 383.0, 343.0, 360.4, 377.1, 380.4, 392.8, 342.0, 375.7, 396.0, 368.3, 370.1, 373.9, 382.6, 359.1, 400.0, 389.9, 382.4, 391.0, 359.3, 383.3, 365.3, 400.0, 380.1, 369.0, 371.0, 350.1, 382.0, 350.2, 371.6, 369.1, 392.8, 388.4, 339.8, 372.8, 383.3, 398.2, 393.1, 354.5, 361.9, 369.0, 383.1, 377.0, 397.0, 382.7, 336.7, 323.20000000000005, 333.70000000000005, 368.1, 374.8, 389.1, 382.6, 380.6, 354.5, 382.0, 387.4, 365.0, 378.7, 360.3000000000001, 385.6, 360.0, 371.0, 341.6, 359.9], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 179.9, 173.0, 166.7, 136.4, 200.0, 179.3, 186.5, 193.7, 197.3, 197.3, 179.0, 166.7, 141.2, 147.8, 192.8, 143.3, 165.2, 170.0, 188.0, 163.7, 195.5, 162.5, 143.3, 191.9, 192.8, 198.2, 189.2, 191.9, 173.0, 170.0, 124.0, 191.0, 200.0, 185.0, 115.4, 174.5, 197.3, 167.6, 200.0, 180.5, 194.6, 190.1, 191.9, 167.0, 116.0, 187.4, 171.8, 177.2, 120.79999999999998, 148.1, 191.9, 200.0, 157.1, 200.0, 194.0, 95.0, 176.6, 158.0, 151.7, 185.0, 194.3, 179.0, 163.7, 173.3, 200.0, 159.8, 163.4, 160.1, 175.7, 200.0, 189.0, 180.0, 199.0, 184.0, 176.0, 133.0, 178.4, 173.0, 172.1, 194.0, 200.0, 172.4, 200.0, 192.8, 158.0, 152.0, 180.2, 195.5, 194.0, 200.0, 188.3, 170.0, 182.0, 175.1, 161.3, 194.6, 196.4, 180.2, 140.0, 199.1, 200.0, 200.0, 197.0, 191.9, 198.2, 177.2, 200.0, 191.0, 166.4, 182.9, 200.0, 176.3, 179.3, 179.0, 200.0, 200.0, 191.9, 183.2, 170.0, 189.0, 191.0, 170.0, 131.0, 199.1, 182.0, 200.0, 147.2, 179.0, 167.6, 194.0, 173.0, 190.1, 192.8, 200.0, 188.0, 196.4, 150.8, 167.0, 200.0, 162.79999999999998, 200.0, 176.3, 200.0, 198.2, 190.1, 200.0, 146.9, 185.6, 145.7, 189.2, 179.3, 178.7, 175.1, 200.0, 200.0, 161.0, 200.0, 197.0, 194.3, 187.4, 142.7, 170.0, 137.3, 152.9, 199.1, 110.6, 175.1, 182.0, 192.8, 173.0, 199.1, 185.0, 176.6, 200.0, 179.0, 194.6, 171.5, 170.0, 192.8, 189.2, 196.4, 191.0, 122.0, 191.0, 193.7, 167.0, 182.29999999999995, 164.0, 189.2, 196.4, 183.0, 153.0, 182.0, 189.0, 161.0, 167.6, 153.8, 181.1], "policy_predator_policy_reward": [0.0, 0.0, 4.0, 9.0, 1.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 19.0, 17.0, 10.0, 13.0, 10.0, 2.0, 14.0, 0.0, 11.0, 0.0, 10.0, 15.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 18.0, 18.0, 0.0, 5.0, 17.0, 18.0, 9.0, 0.0, 0.0, 5.0, 0.0, 0.0, 1.0, 11.0, 23.0, 25.0, 11.0, 8.0, 4.0, 19.0, 0.0, 0.0, 4.0, 10.0, 16.0, 19.0, 1.0, 16.0, 16.0, 10.0, 0.0, 7.0, 0.0, 11.0, 2.0, 9.0, 8.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 14.0, 9.0, 0.0, 1.0, 10.0, 8.0, 0.0, 0.0, 0.0, 16.0, 16.0, 0.0, 0.0, 2.0, 0.0, 10.0, 0.0, 5.0, 8.0, 12.0, 6.0, 0.0, 6.0, 20.0, 0.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 7.0, 0.0, 7.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 17.0, 7.0, 1.0, 9.0, 6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 22.0, 4.0, 6.0, 0.0, 7.0, 0.0, 0.0, 3.0, 0.0, 12.0, 10.0, 15.0, 12.0, 6.0, 5.0, 8.0, 0.0, 3.0, 13.0, 0.0, 0.0, 0.0, 1.0, 8.0, 16.0, 17.0, 16.0, 18.0, 6.0, 0.0, 11.0, 0.0, 9.0, 5.0, 0.0, 2.0, 4.0, 7.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 26.0, 7.0, 11.0, 6.0, 8.0, 0.0, 0.0, 8.0, 16.0, 0.0, 0.0, 13.0, 0.0, 12.0, 13.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5423229178681725, "mean_inference_ms": 4.556676997242763, "mean_action_processing_ms": 0.8587349788341055, "mean_env_wait_ms": 0.46210577016547305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005548954010009766, "StateBufferConnector_ms": 0.014251947402954102, "ViewRequirementAgentConnector_ms": 0.24484682083129883}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 291.9, "episode_return_mean": 368.84, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 245.39460288308692, "num_env_steps_trained_throughput_per_sec": 245.39460288308692, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 2096000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2096000, "timers": {"training_iteration_time_ms": 321490.684, "restore_workers_time_ms": 0.017, "training_step_time_ms": 321490.63, "sample_time_ms": 7294.006, "learn_time_ms": 314164.653, "learn_throughput": 12.732, "synch_weights_time_ms": 24.163}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 2096000, "num_agent_steps_trained": 2096000}, "done": false, "training_iteration": 131, "trial_id": "e4caa_00000", "date": "2024-08-13_22-07-17", "timestamp": 1723601237, "time_this_iter_s": 979.4528429508209, "time_total_s": 8568.419524669647, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29ceb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 8568.419524669647, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 72.98, "ram_util_percent": 84.02}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5947529585825073, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4398959438537652, "policy_loss": -0.012750992071248158, "vf_loss": 0.45252365583169557, "vf_explained_var": 0.35240079035203925, "kl": 0.013149839254160483, "entropy": 1.085804390402698, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 248535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2000178436438242, "cur_kl_coeff": 2.4233807008389477e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3282956319195884, "policy_loss": -0.002950893180868613, "vf_loss": 0.3312465256984252, "vf_explained_var": 0.40525148842069836, "kl": 0.0024313014724223793, "entropy": 0.031041445966967673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 248535.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 291.9, "episode_reward_mean": 368.293, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 95.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 26.0}, "policy_reward_mean": {"prey_policy": 178.06150000000002, "predator_policy": 6.085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.4, 368.00000000000006, 291.9, 391.9, 371.1, 324.00000000000006, 351.6, 362.7, 380.3, 348.0, 370.8, 345.5, 375.70000000000005, 369.0, 383.0, 343.0, 360.4, 377.1, 380.4, 392.8, 342.0, 375.7, 396.0, 368.3, 370.1, 373.9, 382.6, 359.1, 400.0, 389.9, 382.4, 391.0, 359.3, 383.3, 365.3, 400.0, 380.1, 369.0, 371.0, 350.1, 382.0, 350.2, 371.6, 369.1, 392.8, 388.4, 339.8, 372.8, 383.3, 398.2, 393.1, 354.5, 361.9, 369.0, 383.1, 377.0, 397.0, 382.7, 336.7, 323.20000000000005, 333.70000000000005, 368.1, 374.8, 389.1, 382.6, 380.6, 354.5, 382.0, 387.4, 365.0, 378.7, 360.3000000000001, 385.6, 360.0, 371.0, 341.6, 359.9, 357.2, 340.8, 385.6, 353.6, 353.6, 370.8, 362.2, 370.29999999999995, 358.5, 367.2, 391.9, 367.6, 365.1, 383.7, 370.2, 400.0, 335.3, 318.0, 359.0, 335.0, 375.7, 369.3, 389.7], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [116.0, 187.4, 171.8, 177.2, 120.79999999999998, 148.1, 191.9, 200.0, 157.1, 200.0, 194.0, 95.0, 176.6, 158.0, 151.7, 185.0, 194.3, 179.0, 163.7, 173.3, 200.0, 159.8, 163.4, 160.1, 175.7, 200.0, 189.0, 180.0, 199.0, 184.0, 176.0, 133.0, 178.4, 173.0, 172.1, 194.0, 200.0, 172.4, 200.0, 192.8, 158.0, 152.0, 180.2, 195.5, 194.0, 200.0, 188.3, 170.0, 182.0, 175.1, 161.3, 194.6, 196.4, 180.2, 140.0, 199.1, 200.0, 200.0, 197.0, 191.9, 198.2, 177.2, 200.0, 191.0, 166.4, 182.9, 200.0, 176.3, 179.3, 179.0, 200.0, 200.0, 191.9, 183.2, 170.0, 189.0, 191.0, 170.0, 131.0, 199.1, 182.0, 200.0, 147.2, 179.0, 167.6, 194.0, 173.0, 190.1, 192.8, 200.0, 188.0, 196.4, 150.8, 167.0, 200.0, 162.79999999999998, 200.0, 176.3, 200.0, 198.2, 190.1, 200.0, 146.9, 185.6, 145.7, 189.2, 179.3, 178.7, 175.1, 200.0, 200.0, 161.0, 200.0, 197.0, 194.3, 187.4, 142.7, 170.0, 137.3, 152.9, 199.1, 110.6, 175.1, 182.0, 192.8, 173.0, 199.1, 185.0, 176.6, 200.0, 179.0, 194.6, 171.5, 170.0, 192.8, 189.2, 196.4, 191.0, 122.0, 191.0, 193.7, 167.0, 182.29999999999995, 164.0, 189.2, 196.4, 183.0, 153.0, 182.0, 189.0, 161.0, 167.6, 153.8, 181.1, 148.4, 192.8, 165.8, 155.0, 186.5, 199.1, 185.6, 149.0, 173.3, 170.3, 200.0, 156.8, 200.0, 126.2, 191.0, 179.3, 165.5, 179.0, 164.0, 177.2, 193.7, 198.2, 191.0, 176.6, 200.0, 148.1, 196.4, 182.3, 188.3, 176.9, 200.0, 200.0, 161.6, 151.7, 151.0, 137.0, 167.0, 176.0, 163.0, 140.0, 190.1, 185.6, 181.7, 176.6, 197.3, 190.4], "policy_predator_policy_reward": [23.0, 25.0, 11.0, 8.0, 4.0, 19.0, 0.0, 0.0, 4.0, 10.0, 16.0, 19.0, 1.0, 16.0, 16.0, 10.0, 0.0, 7.0, 0.0, 11.0, 2.0, 9.0, 8.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 14.0, 9.0, 0.0, 1.0, 10.0, 8.0, 0.0, 0.0, 0.0, 16.0, 16.0, 0.0, 0.0, 2.0, 0.0, 10.0, 0.0, 5.0, 8.0, 12.0, 6.0, 0.0, 6.0, 20.0, 0.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 7.0, 0.0, 7.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 17.0, 7.0, 1.0, 9.0, 6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 22.0, 4.0, 6.0, 0.0, 7.0, 0.0, 0.0, 3.0, 0.0, 12.0, 10.0, 15.0, 12.0, 6.0, 5.0, 8.0, 0.0, 3.0, 13.0, 0.0, 0.0, 0.0, 1.0, 8.0, 16.0, 17.0, 16.0, 18.0, 6.0, 0.0, 11.0, 0.0, 9.0, 5.0, 0.0, 2.0, 4.0, 7.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 26.0, 7.0, 11.0, 6.0, 8.0, 0.0, 0.0, 8.0, 16.0, 0.0, 0.0, 13.0, 0.0, 12.0, 13.0, 3.0, 13.0, 6.0, 14.0, 0.0, 0.0, 17.0, 2.0, 10.0, 0.0, 9.0, 5.0, 19.0, 17.0, 0.0, 0.0, 7.0, 7.0, 13.0, 13.0, 0.0, 0.0, 0.0, 0.0, 15.0, 2.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 11.0, 11.0, 13.0, 17.0, 8.0, 8.0, 20.0, 12.0, 0.0, 0.0, 5.0, 6.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5297244572756445, "mean_inference_ms": 7.090012673219504, "mean_action_processing_ms": 1.7259401999453265, "mean_env_wait_ms": 0.46263140560936783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006444334983825684, "StateBufferConnector_ms": 0.014550209045410156, "ViewRequirementAgentConnector_ms": 0.3067336082458496}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 291.9, "episode_return_mean": 368.293, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.931268500406686, "num_env_steps_trained_throughput_per_sec": 3.931268500406686, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 2112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2112000, "timers": {"training_iteration_time_ms": 388449.522, "restore_workers_time_ms": 0.021, "training_step_time_ms": 388449.455, "sample_time_ms": 107658.638, "learn_time_ms": 280757.299, "learn_throughput": 14.247, "synch_weights_time_ms": 24.931}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 2112000, "num_agent_steps_trained": 2112000}, "done": false, "training_iteration": 132, "trial_id": "e4caa_00000", "date": "2024-08-13_22-24-15", "timestamp": 1723602255, "time_this_iter_s": 1017.5431592464447, "time_total_s": 9585.962683916092, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b5a790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9585.962683916092, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 81.66551724137932, "ram_util_percent": 79.98275862068967}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7301048972934643, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5207070493204617, "policy_loss": -0.005471763613008002, "vf_loss": 0.5261198377694993, "vf_explained_var": 0.47975836825118495, "kl": 0.006290685727707034, "entropy": 1.068872483003707, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 250425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.205770551425124, "cur_kl_coeff": 1.2116903504194739e-28, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5586252958292053, "policy_loss": -0.0014576046794120754, "vf_loss": 0.5600829002363656, "vf_explained_var": 0.06730716401937778, "kl": 0.0015159504954781176, "entropy": 0.03153804039838847, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 250425.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 318.0, "episode_reward_mean": 370.374, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 110.6, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 26.0}, "policy_reward_mean": {"prey_policy": 179.65699999999998, "predator_policy": 5.53}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.4, 392.8, 342.0, 375.7, 396.0, 368.3, 370.1, 373.9, 382.6, 359.1, 400.0, 389.9, 382.4, 391.0, 359.3, 383.3, 365.3, 400.0, 380.1, 369.0, 371.0, 350.1, 382.0, 350.2, 371.6, 369.1, 392.8, 388.4, 339.8, 372.8, 383.3, 398.2, 393.1, 354.5, 361.9, 369.0, 383.1, 377.0, 397.0, 382.7, 336.7, 323.20000000000005, 333.70000000000005, 368.1, 374.8, 389.1, 382.6, 380.6, 354.5, 382.0, 387.4, 365.0, 378.7, 360.3000000000001, 385.6, 360.0, 371.0, 341.6, 359.9, 357.2, 340.8, 385.6, 353.6, 353.6, 370.8, 362.2, 370.29999999999995, 358.5, 367.2, 391.9, 367.6, 365.1, 383.7, 370.2, 400.0, 335.3, 318.0, 359.0, 335.0, 375.7, 369.3, 389.7, 395.5, 374.8, 389.2, 338.5, 370.1, 383.0, 391.0, 334.4, 371.1, 345.7, 395.5, 331.5, 385.6, 369.6, 363.0, 367.0, 396.4, 371.6], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 172.4, 200.0, 192.8, 158.0, 152.0, 180.2, 195.5, 194.0, 200.0, 188.3, 170.0, 182.0, 175.1, 161.3, 194.6, 196.4, 180.2, 140.0, 199.1, 200.0, 200.0, 197.0, 191.9, 198.2, 177.2, 200.0, 191.0, 166.4, 182.9, 200.0, 176.3, 179.3, 179.0, 200.0, 200.0, 191.9, 183.2, 170.0, 189.0, 191.0, 170.0, 131.0, 199.1, 182.0, 200.0, 147.2, 179.0, 167.6, 194.0, 173.0, 190.1, 192.8, 200.0, 188.0, 196.4, 150.8, 167.0, 200.0, 162.79999999999998, 200.0, 176.3, 200.0, 198.2, 190.1, 200.0, 146.9, 185.6, 145.7, 189.2, 179.3, 178.7, 175.1, 200.0, 200.0, 161.0, 200.0, 197.0, 194.3, 187.4, 142.7, 170.0, 137.3, 152.9, 199.1, 110.6, 175.1, 182.0, 192.8, 173.0, 199.1, 185.0, 176.6, 200.0, 179.0, 194.6, 171.5, 170.0, 192.8, 189.2, 196.4, 191.0, 122.0, 191.0, 193.7, 167.0, 182.29999999999995, 164.0, 189.2, 196.4, 183.0, 153.0, 182.0, 189.0, 161.0, 167.6, 153.8, 181.1, 148.4, 192.8, 165.8, 155.0, 186.5, 199.1, 185.6, 149.0, 173.3, 170.3, 200.0, 156.8, 200.0, 126.2, 191.0, 179.3, 165.5, 179.0, 164.0, 177.2, 193.7, 198.2, 191.0, 176.6, 200.0, 148.1, 196.4, 182.3, 188.3, 176.9, 200.0, 200.0, 161.6, 151.7, 151.0, 137.0, 167.0, 176.0, 163.0, 140.0, 190.1, 185.6, 181.7, 176.6, 197.3, 190.4, 199.1, 196.4, 200.0, 174.8, 189.2, 200.0, 126.5, 182.0, 155.0, 199.1, 200.0, 179.0, 197.0, 191.0, 167.0, 142.4, 194.0, 166.1, 127.7, 179.0, 198.2, 197.3, 153.5, 164.0, 195.5, 190.1, 179.0, 182.6, 176.0, 179.0, 200.0, 156.0, 199.1, 197.3, 164.6, 200.0], "policy_predator_policy_reward": [8.0, 0.0, 0.0, 0.0, 16.0, 16.0, 0.0, 0.0, 2.0, 0.0, 10.0, 0.0, 5.0, 8.0, 12.0, 6.0, 0.0, 6.0, 20.0, 0.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 7.0, 0.0, 7.0, 0.0, 0.0, 5.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 17.0, 7.0, 1.0, 9.0, 6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 22.0, 4.0, 6.0, 0.0, 7.0, 0.0, 0.0, 3.0, 0.0, 12.0, 10.0, 15.0, 12.0, 6.0, 5.0, 8.0, 0.0, 3.0, 13.0, 0.0, 0.0, 0.0, 1.0, 8.0, 16.0, 17.0, 16.0, 18.0, 6.0, 0.0, 11.0, 0.0, 9.0, 5.0, 0.0, 2.0, 4.0, 7.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 26.0, 7.0, 11.0, 6.0, 8.0, 0.0, 0.0, 8.0, 16.0, 0.0, 0.0, 13.0, 0.0, 12.0, 13.0, 3.0, 13.0, 6.0, 14.0, 0.0, 0.0, 17.0, 2.0, 10.0, 0.0, 9.0, 5.0, 19.0, 17.0, 0.0, 0.0, 7.0, 7.0, 13.0, 13.0, 0.0, 0.0, 0.0, 0.0, 15.0, 2.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 11.0, 11.0, 13.0, 17.0, 8.0, 8.0, 20.0, 12.0, 0.0, 0.0, 5.0, 6.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 14.0, 14.0, 2.0, 0.0, 4.0, 3.0, 0.0, 22.0, 3.0, 0.0, 11.0, 26.0, 13.0, 0.0, 0.0, 8.0, 6.0, 0.0, 0.0, 0.0, 8.0, 0.0, 8.0, 0.0, 11.0, 0.0, 0.0, 7.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.543683523256785, "mean_inference_ms": 9.137741273953578, "mean_action_processing_ms": 2.3808155658536134, "mean_env_wait_ms": 0.4634385596329612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006875514984130859, "StateBufferConnector_ms": 0.015814661979675293, "ViewRequirementAgentConnector_ms": 0.3492532968521118}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 318.0, "episode_return_mean": 370.374, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 242.72054969384286, "num_env_steps_trained_throughput_per_sec": 242.72054969384286, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 2128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2128000, "timers": {"training_iteration_time_ms": 388817.862, "restore_workers_time_ms": 0.023, "training_step_time_ms": 388817.791, "sample_time_ms": 107986.099, "learn_time_ms": 280797.149, "learn_throughput": 14.245, "synch_weights_time_ms": 25.917}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 2128000, "num_agent_steps_trained": 2128000}, "done": false, "training_iteration": 133, "trial_id": "e4caa_00000", "date": "2024-08-13_22-24-31", "timestamp": 1723602271, "time_this_iter_s": 16.542936086654663, "time_total_s": 9602.505620002747, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b298f160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9602.505620002747, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 73.59565217391307, "ram_util_percent": 83.8913043478261}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.995491806208772, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5419970930381506, "policy_loss": -0.0036300553781320414, "vf_loss": 0.5455575256130446, "vf_explained_var": 0.5644852358828146, "kl": 0.007426344808983026, "entropy": 1.1140575998674624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 252315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.216793578192986, "cur_kl_coeff": 6.058451752097369e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.30172583901141053, "policy_loss": -0.002553471938026921, "vf_loss": 0.30427931183616497, "vf_explained_var": 0.181875840539024, "kl": 0.0015312872354276276, "entropy": 0.01412877875365435, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 252315.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 318.0, "episode_reward_mean": 369.338, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 110.6, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 26.0}, "policy_reward_mean": {"prey_policy": 179.19400000000002, "predator_policy": 5.475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [382.0, 350.2, 371.6, 369.1, 392.8, 388.4, 339.8, 372.8, 383.3, 398.2, 393.1, 354.5, 361.9, 369.0, 383.1, 377.0, 397.0, 382.7, 336.7, 323.20000000000005, 333.70000000000005, 368.1, 374.8, 389.1, 382.6, 380.6, 354.5, 382.0, 387.4, 365.0, 378.7, 360.3000000000001, 385.6, 360.0, 371.0, 341.6, 359.9, 357.2, 340.8, 385.6, 353.6, 353.6, 370.8, 362.2, 370.29999999999995, 358.5, 367.2, 391.9, 367.6, 365.1, 383.7, 370.2, 400.0, 335.3, 318.0, 359.0, 335.0, 375.7, 369.3, 389.7, 395.5, 374.8, 389.2, 338.5, 370.1, 383.0, 391.0, 334.4, 371.1, 345.7, 395.5, 331.5, 385.6, 369.6, 363.0, 367.0, 396.4, 371.6, 386.5, 386.8, 370.3, 369.5, 351.7, 392.0, 349.4, 369.5, 382.0, 384.2, 360.6, 347.80000000000007, 360.4, 373.0, 398.0, 387.4, 367.3, 356.3, 366.0, 375.0, 361.40000000000003, 383.6], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [182.0, 200.0, 147.2, 179.0, 167.6, 194.0, 173.0, 190.1, 192.8, 200.0, 188.0, 196.4, 150.8, 167.0, 200.0, 162.79999999999998, 200.0, 176.3, 200.0, 198.2, 190.1, 200.0, 146.9, 185.6, 145.7, 189.2, 179.3, 178.7, 175.1, 200.0, 200.0, 161.0, 200.0, 197.0, 194.3, 187.4, 142.7, 170.0, 137.3, 152.9, 199.1, 110.6, 175.1, 182.0, 192.8, 173.0, 199.1, 185.0, 176.6, 200.0, 179.0, 194.6, 171.5, 170.0, 192.8, 189.2, 196.4, 191.0, 122.0, 191.0, 193.7, 167.0, 182.29999999999995, 164.0, 189.2, 196.4, 183.0, 153.0, 182.0, 189.0, 161.0, 167.6, 153.8, 181.1, 148.4, 192.8, 165.8, 155.0, 186.5, 199.1, 185.6, 149.0, 173.3, 170.3, 200.0, 156.8, 200.0, 126.2, 191.0, 179.3, 165.5, 179.0, 164.0, 177.2, 193.7, 198.2, 191.0, 176.6, 200.0, 148.1, 196.4, 182.3, 188.3, 176.9, 200.0, 200.0, 161.6, 151.7, 151.0, 137.0, 167.0, 176.0, 163.0, 140.0, 190.1, 185.6, 181.7, 176.6, 197.3, 190.4, 199.1, 196.4, 200.0, 174.8, 189.2, 200.0, 126.5, 182.0, 155.0, 199.1, 200.0, 179.0, 197.0, 191.0, 167.0, 142.4, 194.0, 166.1, 127.7, 179.0, 198.2, 197.3, 153.5, 164.0, 195.5, 190.1, 179.0, 182.6, 176.0, 179.0, 200.0, 156.0, 199.1, 197.3, 164.6, 200.0, 191.0, 195.5, 199.1, 184.7, 174.8, 195.5, 200.0, 156.5, 188.0, 151.7, 200.0, 185.0, 178.4, 152.0, 200.0, 156.5, 191.9, 190.1, 175.1, 196.1, 152.6, 200.0, 196.4, 151.4, 194.6, 144.8, 200.0, 173.0, 197.0, 200.0, 191.9, 195.5, 154.1, 198.2, 170.3, 179.0, 178.0, 182.0, 167.0, 200.0, 140.6, 192.8, 186.5, 196.1], "policy_predator_policy_reward": [0.0, 0.0, 17.0, 7.0, 1.0, 9.0, 6.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 22.0, 4.0, 6.0, 0.0, 7.0, 0.0, 0.0, 3.0, 0.0, 12.0, 10.0, 15.0, 12.0, 6.0, 5.0, 8.0, 0.0, 3.0, 13.0, 0.0, 0.0, 0.0, 1.0, 8.0, 16.0, 17.0, 16.0, 18.0, 6.0, 0.0, 11.0, 0.0, 9.0, 5.0, 0.0, 2.0, 4.0, 7.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 26.0, 7.0, 11.0, 6.0, 8.0, 0.0, 0.0, 8.0, 16.0, 0.0, 0.0, 13.0, 0.0, 12.0, 13.0, 3.0, 13.0, 6.0, 14.0, 0.0, 0.0, 17.0, 2.0, 10.0, 0.0, 9.0, 5.0, 19.0, 17.0, 0.0, 0.0, 7.0, 7.0, 13.0, 13.0, 0.0, 0.0, 0.0, 0.0, 15.0, 2.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 11.0, 11.0, 13.0, 17.0, 8.0, 8.0, 20.0, 12.0, 0.0, 0.0, 5.0, 6.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 14.0, 14.0, 2.0, 0.0, 4.0, 3.0, 0.0, 22.0, 3.0, 0.0, 11.0, 26.0, 13.0, 0.0, 0.0, 8.0, 6.0, 0.0, 0.0, 0.0, 8.0, 0.0, 8.0, 0.0, 11.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 13.0, 8.0, 4.0, 2.0, 5.0, 3.0, 16.0, 12.0, 1.0, 0.0, 0.0, 5.0, 8.0, 3.0, 5.0, 0.0, 0.0, 12.0, 9.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 15.0, 0.0, 7.0, 0.0, 0.0, 6.0, 0.0, 8.0, 16.0, 12.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5459023927736633, "mean_inference_ms": 11.657208011287107, "mean_action_processing_ms": 3.217580013358686, "mean_env_wait_ms": 0.464734253618134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069473981857299805, "StateBufferConnector_ms": 0.015816330909729004, "ViewRequirementAgentConnector_ms": 0.35643231868743896}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 318.0, "episode_return_mean": 369.338, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.41178306646117, "num_env_steps_trained_throughput_per_sec": 291.41178306646117, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 2144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2144000, "timers": {"training_iteration_time_ms": 388819.716, "restore_workers_time_ms": 0.024, "training_step_time_ms": 388819.645, "sample_time_ms": 108072.331, "learn_time_ms": 280712.74, "learn_throughput": 14.249, "synch_weights_time_ms": 25.95}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 2144000, "num_agent_steps_trained": 2144000}, "done": false, "training_iteration": 134, "trial_id": "e4caa_00000", "date": "2024-08-13_22-24-45", "timestamp": 1723602285, "time_this_iter_s": 13.769479036331177, "time_total_s": 9616.275099039078, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bd5ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 9616.275099039078, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 56.214999999999996, "ram_util_percent": 83.57}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4419320541084129, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6333391675192163, "policy_loss": -0.008756571820882892, "vf_loss": 0.6419530705878974, "vf_explained_var": 0.3629865173624937, "kl": 0.015217929431181075, "entropy": 1.0841730651401338, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 254205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1586222528977683, "cur_kl_coeff": 3.0292258760486847e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.48085071529660905, "policy_loss": -0.0014551904284094692, "vf_loss": 0.4823059064498733, "vf_explained_var": 0.20631897768015584, "kl": 0.0011075694331517687, "entropy": 0.014398397411658334, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 254205.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 318.0, "episode_reward_mean": 367.902, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 110.6, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 26.0}, "policy_reward_mean": {"prey_policy": 178.13099999999997, "predator_policy": 5.82}, "custom_metrics": {}, "hist_stats": {"episode_reward": [336.7, 323.20000000000005, 333.70000000000005, 368.1, 374.8, 389.1, 382.6, 380.6, 354.5, 382.0, 387.4, 365.0, 378.7, 360.3000000000001, 385.6, 360.0, 371.0, 341.6, 359.9, 357.2, 340.8, 385.6, 353.6, 353.6, 370.8, 362.2, 370.29999999999995, 358.5, 367.2, 391.9, 367.6, 365.1, 383.7, 370.2, 400.0, 335.3, 318.0, 359.0, 335.0, 375.7, 369.3, 389.7, 395.5, 374.8, 389.2, 338.5, 370.1, 383.0, 391.0, 334.4, 371.1, 345.7, 395.5, 331.5, 385.6, 369.6, 363.0, 367.0, 396.4, 371.6, 386.5, 386.8, 370.3, 369.5, 351.7, 392.0, 349.4, 369.5, 382.0, 384.2, 360.6, 347.80000000000007, 360.4, 373.0, 398.0, 387.4, 367.3, 356.3, 366.0, 375.0, 361.40000000000003, 383.6, 364.7, 353.6, 384.7, 366.3, 377.8, 353.6, 370.6, 399.1, 363.9, 345.1, 371.7, 357.4, 368.3, 350.4, 353.0, 398.0, 375.6, 369.1], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [142.7, 170.0, 137.3, 152.9, 199.1, 110.6, 175.1, 182.0, 192.8, 173.0, 199.1, 185.0, 176.6, 200.0, 179.0, 194.6, 171.5, 170.0, 192.8, 189.2, 196.4, 191.0, 122.0, 191.0, 193.7, 167.0, 182.29999999999995, 164.0, 189.2, 196.4, 183.0, 153.0, 182.0, 189.0, 161.0, 167.6, 153.8, 181.1, 148.4, 192.8, 165.8, 155.0, 186.5, 199.1, 185.6, 149.0, 173.3, 170.3, 200.0, 156.8, 200.0, 126.2, 191.0, 179.3, 165.5, 179.0, 164.0, 177.2, 193.7, 198.2, 191.0, 176.6, 200.0, 148.1, 196.4, 182.3, 188.3, 176.9, 200.0, 200.0, 161.6, 151.7, 151.0, 137.0, 167.0, 176.0, 163.0, 140.0, 190.1, 185.6, 181.7, 176.6, 197.3, 190.4, 199.1, 196.4, 200.0, 174.8, 189.2, 200.0, 126.5, 182.0, 155.0, 199.1, 200.0, 179.0, 197.0, 191.0, 167.0, 142.4, 194.0, 166.1, 127.7, 179.0, 198.2, 197.3, 153.5, 164.0, 195.5, 190.1, 179.0, 182.6, 176.0, 179.0, 200.0, 156.0, 199.1, 197.3, 164.6, 200.0, 191.0, 195.5, 199.1, 184.7, 174.8, 195.5, 200.0, 156.5, 188.0, 151.7, 200.0, 185.0, 178.4, 152.0, 200.0, 156.5, 191.9, 190.1, 175.1, 196.1, 152.6, 200.0, 196.4, 151.4, 194.6, 144.8, 200.0, 173.0, 197.0, 200.0, 191.9, 195.5, 154.1, 198.2, 170.3, 179.0, 178.0, 182.0, 167.0, 200.0, 140.6, 192.8, 186.5, 196.1, 170.0, 184.7, 152.6, 185.0, 184.7, 200.0, 176.6, 178.7, 197.3, 153.5, 155.6, 167.0, 161.3, 197.3, 200.0, 199.1, 164.0, 185.9, 163.1, 167.0, 188.0, 166.7, 195.5, 146.9, 186.2, 160.1, 139.70000000000002, 193.7, 164.0, 170.0, 198.0, 200.0, 179.6, 191.0, 179.0, 181.1], "policy_predator_policy_reward": [8.0, 16.0, 17.0, 16.0, 18.0, 6.0, 0.0, 11.0, 0.0, 9.0, 5.0, 0.0, 2.0, 4.0, 7.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 26.0, 7.0, 11.0, 6.0, 8.0, 0.0, 0.0, 8.0, 16.0, 0.0, 0.0, 13.0, 0.0, 12.0, 13.0, 3.0, 13.0, 6.0, 14.0, 0.0, 0.0, 17.0, 2.0, 10.0, 0.0, 9.0, 5.0, 19.0, 17.0, 0.0, 0.0, 7.0, 7.0, 13.0, 13.0, 0.0, 0.0, 0.0, 0.0, 15.0, 2.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 11.0, 11.0, 13.0, 17.0, 8.0, 8.0, 20.0, 12.0, 0.0, 0.0, 5.0, 6.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 14.0, 14.0, 2.0, 0.0, 4.0, 3.0, 0.0, 22.0, 3.0, 0.0, 11.0, 26.0, 13.0, 0.0, 0.0, 8.0, 6.0, 0.0, 0.0, 0.0, 8.0, 0.0, 8.0, 0.0, 11.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 13.0, 8.0, 4.0, 2.0, 5.0, 3.0, 16.0, 12.0, 1.0, 0.0, 0.0, 5.0, 8.0, 3.0, 5.0, 0.0, 0.0, 12.0, 9.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 15.0, 0.0, 7.0, 0.0, 0.0, 6.0, 0.0, 8.0, 16.0, 12.0, 1.0, 0.0, 0.0, 10.0, 16.0, 0.0, 0.0, 0.0, 2.0, 9.0, 14.0, 13.0, 11.0, 20.0, 0.0, 12.0, 0.0, 0.0, 2.0, 12.0, 3.0, 12.0, 9.0, 8.0, 15.0, 0.0, 11.0, 11.0, 15.0, 2.0, 15.0, 4.0, 0.0, 0.0, 5.0, 0.0, 0.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5471213415933693, "mean_inference_ms": 13.656976226055477, "mean_action_processing_ms": 3.8817184889528527, "mean_env_wait_ms": 0.4655856600042053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007196784019470215, "StateBufferConnector_ms": 0.015515446662902832, "ViewRequirementAgentConnector_ms": 0.37085211277008057}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 318.0, "episode_return_mean": 367.902, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.514819765491495, "num_env_steps_trained_throughput_per_sec": 1.514819765491495, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 651571.417, "restore_workers_time_ms": 0.027, "training_step_time_ms": 651571.338, "sample_time_ms": 108119.695, "learn_time_ms": 543416.202, "learn_throughput": 7.361, "synch_weights_time_ms": 27.142}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 135, "trial_id": "e4caa_00000", "date": "2024-08-13_23-08-49", "timestamp": 1723604929, "time_this_iter_s": 2643.3377339839935, "time_total_s": 12259.612833023071, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb8dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12259.612833023071, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 84.53797468354432, "ram_util_percent": 84.60632911392406}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7830885950219695, "cur_kl_coeff": 0.009374999999999998, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4595854423602639, "policy_loss": -0.01797939334656038, "vf_loss": 0.47732383534336886, "vf_explained_var": 0.33586982129112125, "kl": 0.0257068297668896, "entropy": 1.0965487534406955, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 256095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9912055302194502, "cur_kl_coeff": 1.5146129380243423e-29, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3246795078709958, "policy_loss": -0.0010198753709022804, "vf_loss": 0.3256993826621621, "vf_explained_var": 0.10036702909797587, "kl": 0.0005168055876901352, "entropy": 0.014093201500289733, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 256095.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 293.6, "episode_reward_mean": 366.5760000000001, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 104.30000000000001, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 26.0}, "policy_reward_mean": {"prey_policy": 177.53799999999998, "predator_policy": 5.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [359.9, 357.2, 340.8, 385.6, 353.6, 353.6, 370.8, 362.2, 370.29999999999995, 358.5, 367.2, 391.9, 367.6, 365.1, 383.7, 370.2, 400.0, 335.3, 318.0, 359.0, 335.0, 375.7, 369.3, 389.7, 395.5, 374.8, 389.2, 338.5, 370.1, 383.0, 391.0, 334.4, 371.1, 345.7, 395.5, 331.5, 385.6, 369.6, 363.0, 367.0, 396.4, 371.6, 386.5, 386.8, 370.3, 369.5, 351.7, 392.0, 349.4, 369.5, 382.0, 384.2, 360.6, 347.80000000000007, 360.4, 373.0, 398.0, 387.4, 367.3, 356.3, 366.0, 375.0, 361.40000000000003, 383.6, 364.7, 353.6, 384.7, 366.3, 377.8, 353.6, 370.6, 399.1, 363.9, 345.1, 371.7, 357.4, 368.3, 350.4, 353.0, 398.0, 375.6, 369.1, 345.7, 364.5, 340.8, 389.2, 309.9, 393.7, 325.5, 396.0, 374.1, 375.0, 363.70000000000005, 381.20000000000005, 346.4, 293.6, 352.0, 333.0, 382.9, 375.1], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [153.8, 181.1, 148.4, 192.8, 165.8, 155.0, 186.5, 199.1, 185.6, 149.0, 173.3, 170.3, 200.0, 156.8, 200.0, 126.2, 191.0, 179.3, 165.5, 179.0, 164.0, 177.2, 193.7, 198.2, 191.0, 176.6, 200.0, 148.1, 196.4, 182.3, 188.3, 176.9, 200.0, 200.0, 161.6, 151.7, 151.0, 137.0, 167.0, 176.0, 163.0, 140.0, 190.1, 185.6, 181.7, 176.6, 197.3, 190.4, 199.1, 196.4, 200.0, 174.8, 189.2, 200.0, 126.5, 182.0, 155.0, 199.1, 200.0, 179.0, 197.0, 191.0, 167.0, 142.4, 194.0, 166.1, 127.7, 179.0, 198.2, 197.3, 153.5, 164.0, 195.5, 190.1, 179.0, 182.6, 176.0, 179.0, 200.0, 156.0, 199.1, 197.3, 164.6, 200.0, 191.0, 195.5, 199.1, 184.7, 174.8, 195.5, 200.0, 156.5, 188.0, 151.7, 200.0, 185.0, 178.4, 152.0, 200.0, 156.5, 191.9, 190.1, 175.1, 196.1, 152.6, 200.0, 196.4, 151.4, 194.6, 144.8, 200.0, 173.0, 197.0, 200.0, 191.9, 195.5, 154.1, 198.2, 170.3, 179.0, 178.0, 182.0, 167.0, 200.0, 140.6, 192.8, 186.5, 196.1, 170.0, 184.7, 152.6, 185.0, 184.7, 200.0, 176.6, 178.7, 197.3, 153.5, 155.6, 167.0, 161.3, 197.3, 200.0, 199.1, 164.0, 185.9, 163.1, 167.0, 188.0, 166.7, 195.5, 146.9, 186.2, 160.1, 139.70000000000002, 193.7, 164.0, 170.0, 198.0, 200.0, 179.6, 191.0, 179.0, 181.1, 139.70000000000002, 191.0, 176.0, 177.5, 153.5, 164.3, 195.5, 193.7, 173.6, 104.30000000000001, 193.7, 200.0, 154.7, 138.8, 200.0, 194.0, 168.8, 197.3, 188.9, 178.1, 173.6, 181.1, 189.2, 188.0, 179.3, 151.1, 140.0, 110.6, 168.0, 176.0, 170.0, 153.0, 184.7, 198.2, 160.1, 197.0], "policy_predator_policy_reward": [12.0, 13.0, 3.0, 13.0, 6.0, 14.0, 0.0, 0.0, 17.0, 2.0, 10.0, 0.0, 9.0, 5.0, 19.0, 17.0, 0.0, 0.0, 7.0, 7.0, 13.0, 13.0, 0.0, 0.0, 0.0, 0.0, 15.0, 2.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 11.0, 11.0, 13.0, 17.0, 8.0, 8.0, 20.0, 12.0, 0.0, 0.0, 5.0, 6.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 14.0, 14.0, 2.0, 0.0, 4.0, 3.0, 0.0, 22.0, 3.0, 0.0, 11.0, 26.0, 13.0, 0.0, 0.0, 8.0, 6.0, 0.0, 0.0, 0.0, 8.0, 0.0, 8.0, 0.0, 11.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 13.0, 8.0, 4.0, 2.0, 5.0, 3.0, 16.0, 12.0, 1.0, 0.0, 0.0, 5.0, 8.0, 3.0, 5.0, 0.0, 0.0, 12.0, 9.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 15.0, 0.0, 7.0, 0.0, 0.0, 6.0, 0.0, 8.0, 16.0, 12.0, 1.0, 0.0, 0.0, 10.0, 16.0, 0.0, 0.0, 0.0, 2.0, 9.0, 14.0, 13.0, 11.0, 20.0, 0.0, 12.0, 0.0, 0.0, 2.0, 12.0, 3.0, 12.0, 9.0, 8.0, 15.0, 0.0, 11.0, 11.0, 15.0, 2.0, 15.0, 4.0, 0.0, 0.0, 5.0, 0.0, 0.0, 9.0, 11.0, 4.0, 0.0, 11.0, 9.0, 14.0, 0.0, 0.0, 25.0, 7.0, 0.0, 0.0, 20.0, 12.0, 0.0, 2.0, 8.0, 0.0, 8.0, 0.0, 9.0, 0.0, 4.0, 0.0, 16.0, 0.0, 20.0, 23.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 7.0, 11.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.548812889100875, "mean_inference_ms": 15.642518240744176, "mean_action_processing_ms": 4.540969589996985, "mean_env_wait_ms": 0.4666932366258979, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007361173629760742, "StateBufferConnector_ms": 0.006687164306640625, "ViewRequirementAgentConnector_ms": 0.26693761348724365}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 293.6, "episode_return_mean": 366.5760000000001, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 194.06823731710068, "num_env_steps_trained_throughput_per_sec": 194.06823731710068, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 2176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2176000, "timers": {"training_iteration_time_ms": 647015.788, "restore_workers_time_ms": 0.031, "training_step_time_ms": 647015.699, "sample_time_ms": 103009.609, "learn_time_ms": 543971.53, "learn_throughput": 7.353, "synch_weights_time_ms": 26.166}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 2176000, "num_agent_steps_trained": 2176000}, "done": false, "training_iteration": 136, "trial_id": "e4caa_00000", "date": "2024-08-13_23-09-11", "timestamp": 1723604951, "time_this_iter_s": 21.141137838363647, "time_total_s": 12280.753970861435, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb8550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12280.753970861435, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 69.91333333333334, "ram_util_percent": 84.11999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7746697340062056, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.6649794934287905, "policy_loss": -0.005420156518273331, "vf_loss": 2.6702354324557795, "vf_explained_var": 0.34264645106578, "kl": 0.01167814199699702, "entropy": 1.0842516161777356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 257985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5244268355940385, "cur_kl_coeff": 7.573064690121712e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9268409001133429, "policy_loss": -0.0008082571730175346, "vf_loss": 1.92764915398189, "vf_explained_var": 0.020727648873808523, "kl": 0.0017415940687469872, "entropy": 0.01635118089222088, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 257985.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 38.10000000000002, "episode_reward_mean": 350.088, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -311.7999999999996, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 158.0}, "policy_reward_mean": {"prey_policy": 168.17399999999998, "predator_policy": 6.87}, "custom_metrics": {}, "hist_stats": {"episode_reward": [389.7, 395.5, 374.8, 389.2, 338.5, 370.1, 383.0, 391.0, 334.4, 371.1, 345.7, 395.5, 331.5, 385.6, 369.6, 363.0, 367.0, 396.4, 371.6, 386.5, 386.8, 370.3, 369.5, 351.7, 392.0, 349.4, 369.5, 382.0, 384.2, 360.6, 347.80000000000007, 360.4, 373.0, 398.0, 387.4, 367.3, 356.3, 366.0, 375.0, 361.40000000000003, 383.6, 364.7, 353.6, 384.7, 366.3, 377.8, 353.6, 370.6, 399.1, 363.9, 345.1, 371.7, 357.4, 368.3, 350.4, 353.0, 398.0, 375.6, 369.1, 345.7, 364.5, 340.8, 389.2, 309.9, 393.7, 325.5, 396.0, 374.1, 375.0, 363.70000000000005, 381.20000000000005, 346.4, 293.6, 352.0, 333.0, 382.9, 375.1, 364.0, 351.8, 383.8, 57.10000000000001, 374.0, 400.0, 368.2, 330.9, 388.29999999999995, 99.79999999999993, 365.1, 385.6, 197.99999999999937, 38.10000000000002, 327.2, 196.49999999999937, 152.9999999999996, 361.0, 386.0, 398.0, 359.5, 244.39999999999958, 171.39999999999947], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [197.3, 190.4, 199.1, 196.4, 200.0, 174.8, 189.2, 200.0, 126.5, 182.0, 155.0, 199.1, 200.0, 179.0, 197.0, 191.0, 167.0, 142.4, 194.0, 166.1, 127.7, 179.0, 198.2, 197.3, 153.5, 164.0, 195.5, 190.1, 179.0, 182.6, 176.0, 179.0, 200.0, 156.0, 199.1, 197.3, 164.6, 200.0, 191.0, 195.5, 199.1, 184.7, 174.8, 195.5, 200.0, 156.5, 188.0, 151.7, 200.0, 185.0, 178.4, 152.0, 200.0, 156.5, 191.9, 190.1, 175.1, 196.1, 152.6, 200.0, 196.4, 151.4, 194.6, 144.8, 200.0, 173.0, 197.0, 200.0, 191.9, 195.5, 154.1, 198.2, 170.3, 179.0, 178.0, 182.0, 167.0, 200.0, 140.6, 192.8, 186.5, 196.1, 170.0, 184.7, 152.6, 185.0, 184.7, 200.0, 176.6, 178.7, 197.3, 153.5, 155.6, 167.0, 161.3, 197.3, 200.0, 199.1, 164.0, 185.9, 163.1, 167.0, 188.0, 166.7, 195.5, 146.9, 186.2, 160.1, 139.70000000000002, 193.7, 164.0, 170.0, 198.0, 200.0, 179.6, 191.0, 179.0, 181.1, 139.70000000000002, 191.0, 176.0, 177.5, 153.5, 164.3, 195.5, 193.7, 173.6, 104.30000000000001, 193.7, 200.0, 154.7, 138.8, 200.0, 194.0, 168.8, 197.3, 188.9, 178.1, 173.6, 181.1, 189.2, 188.0, 179.3, 151.1, 140.0, 110.6, 168.0, 176.0, 170.0, 153.0, 184.7, 198.2, 160.1, 197.0, 164.0, 176.0, 192.8, 128.0, 193.7, 190.1, 20.000000000000014, 4.1000000000000085, 155.0, 200.0, 200.0, 200.0, 196.4, 156.8, 100.1, 192.8, 195.5, 192.8, 20.000000000000014, 51.79999999999998, 181.1, 176.0, 191.9, 193.7, 167.0, 20.000000000000014, -311.7999999999996, 191.9, 149.6, 149.6, 173.0, 9.499999999999977, 191.9, -103.89999999999984, 159.0, 190.0, 181.0, 200.0, 197.0, 200.0, 186.5, 155.0, 194.6, 15.799999999999962, 151.4, 20.000000000000014], "policy_predator_policy_reward": [2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 16.0, 14.0, 14.0, 2.0, 0.0, 4.0, 3.0, 0.0, 22.0, 3.0, 0.0, 11.0, 26.0, 13.0, 0.0, 0.0, 8.0, 6.0, 0.0, 0.0, 0.0, 8.0, 0.0, 8.0, 0.0, 11.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 13.0, 8.0, 4.0, 2.0, 5.0, 3.0, 16.0, 12.0, 1.0, 0.0, 0.0, 5.0, 8.0, 3.0, 5.0, 0.0, 0.0, 12.0, 9.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 15.0, 0.0, 7.0, 0.0, 0.0, 6.0, 0.0, 8.0, 16.0, 12.0, 1.0, 0.0, 0.0, 10.0, 16.0, 0.0, 0.0, 0.0, 2.0, 9.0, 14.0, 13.0, 11.0, 20.0, 0.0, 12.0, 0.0, 0.0, 2.0, 12.0, 3.0, 12.0, 9.0, 8.0, 15.0, 0.0, 11.0, 11.0, 15.0, 2.0, 15.0, 4.0, 0.0, 0.0, 5.0, 0.0, 0.0, 9.0, 11.0, 4.0, 0.0, 11.0, 9.0, 14.0, 0.0, 0.0, 25.0, 7.0, 0.0, 0.0, 20.0, 12.0, 0.0, 2.0, 8.0, 0.0, 8.0, 0.0, 9.0, 0.0, 4.0, 0.0, 16.0, 0.0, 20.0, 23.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 7.0, 11.0, 11.0, 13.0, 13.0, 18.0, 0.0, 0.0, 23.0, 10.0, 7.0, 12.0, 0.0, 0.0, 9.0, 6.0, 6.0, 32.0, 0.0, 0.0, 17.0, 11.0, 8.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 158.0, 10.0, 18.0, 0.0, 14.0, 9.0, 56.0, 0.0, 12.0, 5.0, 0.0, 0.0, 1.0, 15.0, 3.0, 17.0, 17.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.547538369308929, "mean_inference_ms": 15.71571800403891, "mean_action_processing_ms": 4.506930235673933, "mean_env_wait_ms": 0.46680676658347076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008603334426879883, "StateBufferConnector_ms": 0.00613248348236084, "ViewRequirementAgentConnector_ms": 0.2082819938659668}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 38.10000000000002, "episode_return_mean": 350.088, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.0206449136572, "num_env_steps_trained_throughput_per_sec": 277.0206449136572, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 2192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2192000, "timers": {"training_iteration_time_ms": 647188.643, "restore_workers_time_ms": 0.037, "training_step_time_ms": 647188.533, "sample_time_ms": 103117.336, "learn_time_ms": 544036.593, "learn_throughput": 7.352, "synch_weights_time_ms": 26.194}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 2192000, "num_agent_steps_trained": 2192000}, "done": false, "training_iteration": 137, "trial_id": "e4caa_00000", "date": "2024-08-13_23-09-27", "timestamp": 1723604967, "time_this_iter_s": 14.483365058898926, "time_total_s": 12295.237335920334, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb8280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12295.237335920334, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 69.64090909090909, "ram_util_percent": 83.32727272727276}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6922788982353514, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.265318124193363, "policy_loss": -0.009475600355053468, "vf_loss": 2.274577694721323, "vf_explained_var": 0.4565766438920662, "kl": 0.015362152887587039, "entropy": 1.0906941915315296, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 259875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3751695386237568, "cur_kl_coeff": 3.786532345060856e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.80011415875778, "policy_loss": -0.0007650674042346143, "vf_loss": 1.8008792277997132, "vf_explained_var": 0.050535185595668816, "kl": 0.00047324713781399084, "entropy": 0.012198204142608183, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 259875.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 22.900000000000055, "episode_reward_mean": 335.496, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -311.7999999999996, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 158.0}, "policy_reward_mean": {"prey_policy": 159.31300000000002, "predator_policy": 8.435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [369.5, 351.7, 392.0, 349.4, 369.5, 382.0, 384.2, 360.6, 347.80000000000007, 360.4, 373.0, 398.0, 387.4, 367.3, 356.3, 366.0, 375.0, 361.40000000000003, 383.6, 364.7, 353.6, 384.7, 366.3, 377.8, 353.6, 370.6, 399.1, 363.9, 345.1, 371.7, 357.4, 368.3, 350.4, 353.0, 398.0, 375.6, 369.1, 345.7, 364.5, 340.8, 389.2, 309.9, 393.7, 325.5, 396.0, 374.1, 375.0, 363.70000000000005, 381.20000000000005, 346.4, 293.6, 352.0, 333.0, 382.9, 375.1, 364.0, 351.8, 383.8, 57.10000000000001, 374.0, 400.0, 368.2, 330.9, 388.29999999999995, 99.79999999999993, 365.1, 385.6, 197.99999999999937, 38.10000000000002, 327.2, 196.49999999999937, 152.9999999999996, 361.0, 386.0, 398.0, 359.5, 244.39999999999958, 171.39999999999947, 390.1, 141.19999999999962, 179.99999999999977, 373.0, 360.6, 365.1, 356.8, 22.900000000000055, 378.4, 355.6, 40.0000000000003, 387.4, 335.6, 205.60000000000002, 373.8, 255.89999999999978, 394.6, 398.0, 396.0, 381.0, 265.9, 390.1], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 156.5, 188.0, 151.7, 200.0, 185.0, 178.4, 152.0, 200.0, 156.5, 191.9, 190.1, 175.1, 196.1, 152.6, 200.0, 196.4, 151.4, 194.6, 144.8, 200.0, 173.0, 197.0, 200.0, 191.9, 195.5, 154.1, 198.2, 170.3, 179.0, 178.0, 182.0, 167.0, 200.0, 140.6, 192.8, 186.5, 196.1, 170.0, 184.7, 152.6, 185.0, 184.7, 200.0, 176.6, 178.7, 197.3, 153.5, 155.6, 167.0, 161.3, 197.3, 200.0, 199.1, 164.0, 185.9, 163.1, 167.0, 188.0, 166.7, 195.5, 146.9, 186.2, 160.1, 139.70000000000002, 193.7, 164.0, 170.0, 198.0, 200.0, 179.6, 191.0, 179.0, 181.1, 139.70000000000002, 191.0, 176.0, 177.5, 153.5, 164.3, 195.5, 193.7, 173.6, 104.30000000000001, 193.7, 200.0, 154.7, 138.8, 200.0, 194.0, 168.8, 197.3, 188.9, 178.1, 173.6, 181.1, 189.2, 188.0, 179.3, 151.1, 140.0, 110.6, 168.0, 176.0, 170.0, 153.0, 184.7, 198.2, 160.1, 197.0, 164.0, 176.0, 192.8, 128.0, 193.7, 190.1, 20.000000000000014, 4.1000000000000085, 155.0, 200.0, 200.0, 200.0, 196.4, 156.8, 100.1, 192.8, 195.5, 192.8, 20.000000000000014, 51.79999999999998, 181.1, 176.0, 191.9, 193.7, 167.0, 20.000000000000014, -311.7999999999996, 191.9, 149.6, 149.6, 173.0, 9.499999999999977, 191.9, -103.89999999999984, 159.0, 190.0, 181.0, 200.0, 197.0, 200.0, 186.5, 155.0, 194.6, 15.799999999999962, 151.4, 20.000000000000014, 192.8, 197.3, 20.000000000000014, 105.19999999999999, -3.100000000000037, 142.1, 181.1, 191.9, 154.39999999999998, 198.2, 175.1, 173.0, 179.3, 177.5, 48.5, -118.6, 171.2, 198.2, 128.6, 191.0, 20.000000000000014, 20.000000000000014, 200.0, 187.4, 143.6, 161.0, 199.1, -110.50000000000017, 197.0, 159.8, 36.199999999999974, 184.7, 194.6, 200.0, 197.0, 200.0, 196.0, 200.0, 200.0, 177.0, 194.0, 2.9000000000000057, 200.0, 190.1], "policy_predator_policy_reward": [0.0, 13.0, 8.0, 4.0, 2.0, 5.0, 3.0, 16.0, 12.0, 1.0, 0.0, 0.0, 5.0, 8.0, 3.0, 5.0, 0.0, 0.0, 12.0, 9.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 15.0, 0.0, 7.0, 0.0, 0.0, 6.0, 0.0, 8.0, 16.0, 12.0, 1.0, 0.0, 0.0, 10.0, 16.0, 0.0, 0.0, 0.0, 2.0, 9.0, 14.0, 13.0, 11.0, 20.0, 0.0, 12.0, 0.0, 0.0, 2.0, 12.0, 3.0, 12.0, 9.0, 8.0, 15.0, 0.0, 11.0, 11.0, 15.0, 2.0, 15.0, 4.0, 0.0, 0.0, 5.0, 0.0, 0.0, 9.0, 11.0, 4.0, 0.0, 11.0, 9.0, 14.0, 0.0, 0.0, 25.0, 7.0, 0.0, 0.0, 20.0, 12.0, 0.0, 2.0, 8.0, 0.0, 8.0, 0.0, 9.0, 0.0, 4.0, 0.0, 16.0, 0.0, 20.0, 23.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 7.0, 11.0, 11.0, 13.0, 13.0, 18.0, 0.0, 0.0, 23.0, 10.0, 7.0, 12.0, 0.0, 0.0, 9.0, 6.0, 6.0, 32.0, 0.0, 0.0, 17.0, 11.0, 8.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 158.0, 10.0, 18.0, 0.0, 14.0, 9.0, 56.0, 0.0, 12.0, 5.0, 0.0, 0.0, 1.0, 15.0, 3.0, 17.0, 17.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 12.0, 29.0, 0.0, 0.0, 8.0, 0.0, 9.0, 8.0, 0.0, 0.0, 7.0, 86.0, 0.0, 9.0, 22.0, 14.0, 0.0, 0.0, 0.0, 0.0, 22.0, 9.0, 87.0, 30.0, 12.0, 5.0, 17.0, 18.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 4.0, 60.0, 9.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5535969367762146, "mean_inference_ms": 15.442468582857064, "mean_action_processing_ms": 4.641917272552077, "mean_env_wait_ms": 0.4666305649087759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00919485092163086, "StateBufferConnector_ms": 0.005006551742553711, "ViewRequirementAgentConnector_ms": 0.18893373012542725}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 22.900000000000055, "episode_return_mean": 335.496, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.74534059032044, "num_env_steps_trained_throughput_per_sec": 297.74534059032044, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 2208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2208000, "timers": {"training_iteration_time_ms": 647211.389, "restore_workers_time_ms": 0.036, "training_step_time_ms": 647211.28, "sample_time_ms": 103130.46, "learn_time_ms": 544046.214, "learn_throughput": 7.352, "synch_weights_time_ms": 26.332}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 2208000, "num_agent_steps_trained": 2208000}, "done": false, "training_iteration": 138, "trial_id": "e4caa_00000", "date": "2024-08-13_23-09-40", "timestamp": 1723604980, "time_this_iter_s": 13.475903987884521, "time_total_s": 12308.713239908218, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb8d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12308.713239908218, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 58.03157894736843, "ram_util_percent": 83.60000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5909630808249984, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0412045820377196, "policy_loss": -0.007680711555220778, "vf_loss": 1.0487756582794996, "vf_explained_var": 0.5501174312419992, "kl": 0.007796370761673239, "entropy": 1.0448231444472358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 261765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7522445145580503, "cur_kl_coeff": 1.893266172530428e-30, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0552293643434212, "policy_loss": -0.0010359244490111316, "vf_loss": 1.0562652891275113, "vf_explained_var": 0.0374919611940939, "kl": 0.0006353278582517878, "entropy": 0.01338725836735672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 261765.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 22.900000000000055, "episode_reward_mean": 331.44199999999995, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -311.7999999999996, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 158.0}, "policy_reward_mean": {"prey_policy": 156.70600000000002, "predator_policy": 9.015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [383.6, 364.7, 353.6, 384.7, 366.3, 377.8, 353.6, 370.6, 399.1, 363.9, 345.1, 371.7, 357.4, 368.3, 350.4, 353.0, 398.0, 375.6, 369.1, 345.7, 364.5, 340.8, 389.2, 309.9, 393.7, 325.5, 396.0, 374.1, 375.0, 363.70000000000005, 381.20000000000005, 346.4, 293.6, 352.0, 333.0, 382.9, 375.1, 364.0, 351.8, 383.8, 57.10000000000001, 374.0, 400.0, 368.2, 330.9, 388.29999999999995, 99.79999999999993, 365.1, 385.6, 197.99999999999937, 38.10000000000002, 327.2, 196.49999999999937, 152.9999999999996, 361.0, 386.0, 398.0, 359.5, 244.39999999999958, 171.39999999999947, 390.1, 141.19999999999962, 179.99999999999977, 373.0, 360.6, 365.1, 356.8, 22.900000000000055, 378.4, 355.6, 40.0000000000003, 387.4, 335.6, 205.60000000000002, 373.8, 255.89999999999978, 394.6, 398.0, 396.0, 381.0, 265.9, 390.1, 302.3, 379.2, 388.3, 377.4, 384.7, 396.0, 344.5, 346.8, 127.69999999999969, 379.7, 289.1, 251.60000000000005, 391.9, 392.8, 390.0, 400.0, 375.0, 329.1], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [186.5, 196.1, 170.0, 184.7, 152.6, 185.0, 184.7, 200.0, 176.6, 178.7, 197.3, 153.5, 155.6, 167.0, 161.3, 197.3, 200.0, 199.1, 164.0, 185.9, 163.1, 167.0, 188.0, 166.7, 195.5, 146.9, 186.2, 160.1, 139.70000000000002, 193.7, 164.0, 170.0, 198.0, 200.0, 179.6, 191.0, 179.0, 181.1, 139.70000000000002, 191.0, 176.0, 177.5, 153.5, 164.3, 195.5, 193.7, 173.6, 104.30000000000001, 193.7, 200.0, 154.7, 138.8, 200.0, 194.0, 168.8, 197.3, 188.9, 178.1, 173.6, 181.1, 189.2, 188.0, 179.3, 151.1, 140.0, 110.6, 168.0, 176.0, 170.0, 153.0, 184.7, 198.2, 160.1, 197.0, 164.0, 176.0, 192.8, 128.0, 193.7, 190.1, 20.000000000000014, 4.1000000000000085, 155.0, 200.0, 200.0, 200.0, 196.4, 156.8, 100.1, 192.8, 195.5, 192.8, 20.000000000000014, 51.79999999999998, 181.1, 176.0, 191.9, 193.7, 167.0, 20.000000000000014, -311.7999999999996, 191.9, 149.6, 149.6, 173.0, 9.499999999999977, 191.9, -103.89999999999984, 159.0, 190.0, 181.0, 200.0, 197.0, 200.0, 186.5, 155.0, 194.6, 15.799999999999962, 151.4, 20.000000000000014, 192.8, 197.3, 20.000000000000014, 105.19999999999999, -3.100000000000037, 142.1, 181.1, 191.9, 154.39999999999998, 198.2, 175.1, 173.0, 179.3, 177.5, 48.5, -118.6, 171.2, 198.2, 128.6, 191.0, 20.000000000000014, 20.000000000000014, 200.0, 187.4, 143.6, 161.0, 199.1, -110.50000000000017, 197.0, 159.8, 36.199999999999974, 184.7, 194.6, 200.0, 197.0, 200.0, 196.0, 200.0, 200.0, 177.0, 194.0, 2.9000000000000057, 200.0, 190.1, 92.0, 173.3, 185.0, 189.2, 191.0, 197.3, 191.9, 180.5, 184.7, 200.0, 200.0, 194.0, 199.1, 115.4, 141.2, 173.6, 20.000000000000014, 76.69999999999999, 193.7, 179.0, 76.09999999999998, 179.0, 59.599999999999994, 119.0, 191.9, 200.0, 197.3, 195.5, 194.0, 196.0, 200.0, 200.0, 185.0, 182.0, 147.50000000000003, 158.6], "policy_predator_policy_reward": [1.0, 0.0, 0.0, 10.0, 16.0, 0.0, 0.0, 0.0, 2.0, 9.0, 14.0, 13.0, 11.0, 20.0, 0.0, 12.0, 0.0, 0.0, 2.0, 12.0, 3.0, 12.0, 9.0, 8.0, 15.0, 0.0, 11.0, 11.0, 15.0, 2.0, 15.0, 4.0, 0.0, 0.0, 5.0, 0.0, 0.0, 9.0, 11.0, 4.0, 0.0, 11.0, 9.0, 14.0, 0.0, 0.0, 25.0, 7.0, 0.0, 0.0, 20.0, 12.0, 0.0, 2.0, 8.0, 0.0, 8.0, 0.0, 9.0, 0.0, 4.0, 0.0, 16.0, 0.0, 20.0, 23.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 7.0, 11.0, 11.0, 13.0, 13.0, 18.0, 0.0, 0.0, 23.0, 10.0, 7.0, 12.0, 0.0, 0.0, 9.0, 6.0, 6.0, 32.0, 0.0, 0.0, 17.0, 11.0, 8.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 158.0, 10.0, 18.0, 0.0, 14.0, 9.0, 56.0, 0.0, 12.0, 5.0, 0.0, 0.0, 1.0, 15.0, 3.0, 17.0, 17.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 12.0, 29.0, 0.0, 0.0, 8.0, 0.0, 9.0, 8.0, 0.0, 0.0, 7.0, 86.0, 0.0, 9.0, 22.0, 14.0, 0.0, 0.0, 0.0, 0.0, 22.0, 9.0, 87.0, 30.0, 12.0, 5.0, 17.0, 18.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 4.0, 60.0, 9.0, 0.0, 0.0, 11.0, 26.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 2.0, 0.0, 15.0, 15.0, 19.0, 13.0, 16.0, 15.0, 0.0, 7.0, 22.0, 12.0, 29.0, 44.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 5.0, 9.0, 14.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5420789896643696, "mean_inference_ms": 15.535011270929054, "mean_action_processing_ms": 4.4476749817567, "mean_env_wait_ms": 0.4657966218242057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009494304656982422, "StateBufferConnector_ms": 0.004871487617492676, "ViewRequirementAgentConnector_ms": 0.17858731746673584}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 22.900000000000055, "episode_return_mean": 331.44199999999995, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.83788703717903, "num_env_steps_trained_throughput_per_sec": 282.83788703717903, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 2224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2224000, "timers": {"training_iteration_time_ms": 378372.983, "restore_workers_time_ms": 0.036, "training_step_time_ms": 378372.875, "sample_time_ms": 103172.407, "learn_time_ms": 275167.888, "learn_throughput": 14.537, "synch_weights_time_ms": 24.483}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 2224000, "num_agent_steps_trained": 2224000}, "done": false, "training_iteration": 139, "trial_id": "e4caa_00000", "date": "2024-08-13_23-09-54", "timestamp": 1723604994, "time_this_iter_s": 14.20331883430481, "time_total_s": 12322.916558742523, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29ceb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12322.916558742523, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 58.59999999999999, "ram_util_percent": 83.78999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5204941605291669, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6771196111697276, "policy_loss": -0.005944912051092144, "vf_loss": 0.6829854730930593, "vf_explained_var": 0.46640576445867143, "kl": 0.005621310448164184, "entropy": 1.0434084679399218, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 263655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1001839683405936, "cur_kl_coeff": 9.46633086265214e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5425836678614061, "policy_loss": -0.0008384342127967448, "vf_loss": 0.5434221008213522, "vf_explained_var": 0.07547158614668266, "kl": 0.00040534301692610127, "entropy": 0.010504518447705008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 263655.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 22.900000000000055, "episode_reward_mean": 326.65, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -311.7999999999996, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 158.0}, "policy_reward_mean": {"prey_policy": 153.69, "predator_policy": 9.635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [369.1, 345.7, 364.5, 340.8, 389.2, 309.9, 393.7, 325.5, 396.0, 374.1, 375.0, 363.70000000000005, 381.20000000000005, 346.4, 293.6, 352.0, 333.0, 382.9, 375.1, 364.0, 351.8, 383.8, 57.10000000000001, 374.0, 400.0, 368.2, 330.9, 388.29999999999995, 99.79999999999993, 365.1, 385.6, 197.99999999999937, 38.10000000000002, 327.2, 196.49999999999937, 152.9999999999996, 361.0, 386.0, 398.0, 359.5, 244.39999999999958, 171.39999999999947, 390.1, 141.19999999999962, 179.99999999999977, 373.0, 360.6, 365.1, 356.8, 22.900000000000055, 378.4, 355.6, 40.0000000000003, 387.4, 335.6, 205.60000000000002, 373.8, 255.89999999999978, 394.6, 398.0, 396.0, 381.0, 265.9, 390.1, 302.3, 379.2, 388.3, 377.4, 384.7, 396.0, 344.5, 346.8, 127.69999999999969, 379.7, 289.1, 251.60000000000005, 391.9, 392.8, 390.0, 400.0, 375.0, 329.1, 378.4, 330.1, 374.4, 363.6, 369.5, 336.2, 377.4, 349.0, 245.89999999999998, 333.3, 341.1, 383.0, 359.1, 366.1, 394.0, 384.0, 230.39999999999975, 242.70000000000005], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [179.0, 181.1, 139.70000000000002, 191.0, 176.0, 177.5, 153.5, 164.3, 195.5, 193.7, 173.6, 104.30000000000001, 193.7, 200.0, 154.7, 138.8, 200.0, 194.0, 168.8, 197.3, 188.9, 178.1, 173.6, 181.1, 189.2, 188.0, 179.3, 151.1, 140.0, 110.6, 168.0, 176.0, 170.0, 153.0, 184.7, 198.2, 160.1, 197.0, 164.0, 176.0, 192.8, 128.0, 193.7, 190.1, 20.000000000000014, 4.1000000000000085, 155.0, 200.0, 200.0, 200.0, 196.4, 156.8, 100.1, 192.8, 195.5, 192.8, 20.000000000000014, 51.79999999999998, 181.1, 176.0, 191.9, 193.7, 167.0, 20.000000000000014, -311.7999999999996, 191.9, 149.6, 149.6, 173.0, 9.499999999999977, 191.9, -103.89999999999984, 159.0, 190.0, 181.0, 200.0, 197.0, 200.0, 186.5, 155.0, 194.6, 15.799999999999962, 151.4, 20.000000000000014, 192.8, 197.3, 20.000000000000014, 105.19999999999999, -3.100000000000037, 142.1, 181.1, 191.9, 154.39999999999998, 198.2, 175.1, 173.0, 179.3, 177.5, 48.5, -118.6, 171.2, 198.2, 128.6, 191.0, 20.000000000000014, 20.000000000000014, 200.0, 187.4, 143.6, 161.0, 199.1, -110.50000000000017, 197.0, 159.8, 36.199999999999974, 184.7, 194.6, 200.0, 197.0, 200.0, 196.0, 200.0, 200.0, 177.0, 194.0, 2.9000000000000057, 200.0, 190.1, 92.0, 173.3, 185.0, 189.2, 191.0, 197.3, 191.9, 180.5, 184.7, 200.0, 200.0, 194.0, 199.1, 115.4, 141.2, 173.6, 20.000000000000014, 76.69999999999999, 193.7, 179.0, 76.09999999999998, 179.0, 59.599999999999994, 119.0, 191.9, 200.0, 197.3, 195.5, 194.0, 196.0, 200.0, 200.0, 185.0, 182.0, 147.50000000000003, 158.6, 194.6, 183.8, 148.7, 160.4, 200.0, 160.4, 189.2, 163.4, 190.1, 154.4, 173.0, 141.2, 197.0, 175.4, 176.0, 161.0, -10.899999999999977, 192.8, 166.7, 143.6, 127.4, 193.7, 188.0, 191.0, 184.7, 163.4, 194.0, 160.1, 194.0, 200.0, 191.0, 193.0, 167.89999999999998, 3.4999999999999716, 74.6, 115.10000000000004], "policy_predator_policy_reward": [0.0, 9.0, 11.0, 4.0, 0.0, 11.0, 9.0, 14.0, 0.0, 0.0, 25.0, 7.0, 0.0, 0.0, 20.0, 12.0, 0.0, 2.0, 8.0, 0.0, 8.0, 0.0, 9.0, 0.0, 4.0, 0.0, 16.0, 0.0, 20.0, 23.0, 0.0, 8.0, 10.0, 0.0, 0.0, 0.0, 7.0, 11.0, 11.0, 13.0, 13.0, 18.0, 0.0, 0.0, 23.0, 10.0, 7.0, 12.0, 0.0, 0.0, 9.0, 6.0, 6.0, 32.0, 0.0, 0.0, 17.0, 11.0, 8.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 158.0, 10.0, 18.0, 0.0, 14.0, 9.0, 56.0, 0.0, 12.0, 5.0, 0.0, 0.0, 1.0, 15.0, 3.0, 17.0, 17.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 12.0, 29.0, 0.0, 0.0, 8.0, 0.0, 9.0, 8.0, 0.0, 0.0, 7.0, 86.0, 0.0, 9.0, 22.0, 14.0, 0.0, 0.0, 0.0, 0.0, 22.0, 9.0, 87.0, 30.0, 12.0, 5.0, 17.0, 18.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 4.0, 60.0, 9.0, 0.0, 0.0, 11.0, 26.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 2.0, 0.0, 15.0, 15.0, 19.0, 13.0, 16.0, 15.0, 0.0, 7.0, 22.0, 12.0, 29.0, 44.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 5.0, 9.0, 14.0, 0.0, 0.0, 12.0, 9.0, 4.0, 10.0, 11.0, 0.0, 12.0, 13.0, 0.0, 22.0, 0.0, 5.0, 10.0, 2.0, 6.0, 58.0, 23.0, 0.0, 10.0, 10.0, 0.0, 4.0, 0.0, 11.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 30.0, 29.0, 16.0, 37.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.539297458485592, "mean_inference_ms": 15.453349751082214, "mean_action_processing_ms": 4.421023228405898, "mean_env_wait_ms": 0.4652086889649182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009449243545532227, "StateBufferConnector_ms": 0.004793405532836914, "ViewRequirementAgentConnector_ms": 0.1670210361480713}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 22.900000000000055, "episode_return_mean": 326.65, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.8438905878371, "num_env_steps_trained_throughput_per_sec": 300.8438905878371, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 2240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2240000, "timers": {"training_iteration_time_ms": 378049.142, "restore_workers_time_ms": 0.033, "training_step_time_ms": 378049.038, "sample_time_ms": 103050.361, "learn_time_ms": 274968.164, "learn_throughput": 14.547, "synch_weights_time_ms": 22.892}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "done": false, "training_iteration": 140, "trial_id": "e4caa_00000", "date": "2024-08-13_23-10-08", "timestamp": 1723605008, "time_this_iter_s": 13.357293128967285, "time_total_s": 12336.27385187149, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2c22ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12336.27385187149, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 54.426315789473676, "ram_util_percent": 83.82105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.670931430074273, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7468799783338216, "policy_loss": -0.008271428149085117, "vf_loss": 0.7550302473443841, "vf_explained_var": 0.44797292458948, "kl": 0.00861563116964258, "entropy": 1.0590400203825936, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 265545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1305213498848456, "cur_kl_coeff": 4.73316543132607e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6846275491137354, "policy_loss": -0.0013537000953441575, "vf_loss": 0.6859812502330416, "vf_explained_var": 0.025243645811837818, "kl": 0.0008335356448785145, "entropy": 0.008293243141711823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 265545.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 22.900000000000055, "episode_reward_mean": 329.707, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -311.7999999999996, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 158.0}, "policy_reward_mean": {"prey_policy": 155.4785, "predator_policy": 9.375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [374.0, 400.0, 368.2, 330.9, 388.29999999999995, 99.79999999999993, 365.1, 385.6, 197.99999999999937, 38.10000000000002, 327.2, 196.49999999999937, 152.9999999999996, 361.0, 386.0, 398.0, 359.5, 244.39999999999958, 171.39999999999947, 390.1, 141.19999999999962, 179.99999999999977, 373.0, 360.6, 365.1, 356.8, 22.900000000000055, 378.4, 355.6, 40.0000000000003, 387.4, 335.6, 205.60000000000002, 373.8, 255.89999999999978, 394.6, 398.0, 396.0, 381.0, 265.9, 390.1, 302.3, 379.2, 388.3, 377.4, 384.7, 396.0, 344.5, 346.8, 127.69999999999969, 379.7, 289.1, 251.60000000000005, 391.9, 392.8, 390.0, 400.0, 375.0, 329.1, 378.4, 330.1, 374.4, 363.6, 369.5, 336.2, 377.4, 349.0, 245.89999999999998, 333.3, 341.1, 383.0, 359.1, 366.1, 394.0, 384.0, 230.39999999999975, 242.70000000000005, 349.6, 371.6, 397.3, 382.6, 371.1, 378.5, 380.0, 365.6, 378.4, 363.0, 231.8, 356.1, 348.8, 386.5, 345.6, 315.6, 366.8, 367.0, 367.0, 319.0, 388.3, 374.0, 369.6], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [155.0, 200.0, 200.0, 200.0, 196.4, 156.8, 100.1, 192.8, 195.5, 192.8, 20.000000000000014, 51.79999999999998, 181.1, 176.0, 191.9, 193.7, 167.0, 20.000000000000014, -311.7999999999996, 191.9, 149.6, 149.6, 173.0, 9.499999999999977, 191.9, -103.89999999999984, 159.0, 190.0, 181.0, 200.0, 197.0, 200.0, 186.5, 155.0, 194.6, 15.799999999999962, 151.4, 20.000000000000014, 192.8, 197.3, 20.000000000000014, 105.19999999999999, -3.100000000000037, 142.1, 181.1, 191.9, 154.39999999999998, 198.2, 175.1, 173.0, 179.3, 177.5, 48.5, -118.6, 171.2, 198.2, 128.6, 191.0, 20.000000000000014, 20.000000000000014, 200.0, 187.4, 143.6, 161.0, 199.1, -110.50000000000017, 197.0, 159.8, 36.199999999999974, 184.7, 194.6, 200.0, 197.0, 200.0, 196.0, 200.0, 200.0, 177.0, 194.0, 2.9000000000000057, 200.0, 190.1, 92.0, 173.3, 185.0, 189.2, 191.0, 197.3, 191.9, 180.5, 184.7, 200.0, 200.0, 194.0, 199.1, 115.4, 141.2, 173.6, 20.000000000000014, 76.69999999999999, 193.7, 179.0, 76.09999999999998, 179.0, 59.599999999999994, 119.0, 191.9, 200.0, 197.3, 195.5, 194.0, 196.0, 200.0, 200.0, 185.0, 182.0, 147.50000000000003, 158.6, 194.6, 183.8, 148.7, 160.4, 200.0, 160.4, 189.2, 163.4, 190.1, 154.4, 173.0, 141.2, 197.0, 175.4, 176.0, 161.0, -10.899999999999977, 192.8, 166.7, 143.6, 127.4, 193.7, 188.0, 191.0, 184.7, 163.4, 194.0, 160.1, 194.0, 200.0, 191.0, 193.0, 167.89999999999998, 3.4999999999999716, 74.6, 115.10000000000004, 161.3, 188.3, 197.0, 146.6, 199.1, 198.2, 191.0, 185.6, 176.0, 181.1, 175.4, 196.1, 194.0, 179.0, 200.0, 164.6, 178.4, 200.0, 176.0, 173.0, 103.1, 73.7, 167.0, 175.1, 176.0, 150.8, 194.6, 191.9, 170.3, 155.3, 96.8, 192.8, 161.0, 192.8, 185.0, 177.0, 185.0, 173.0, 196.0, 95.0, 195.5, 192.8, 182.0, 188.0, 173.0, 185.6], "policy_predator_policy_reward": [7.0, 12.0, 0.0, 0.0, 9.0, 6.0, 6.0, 32.0, 0.0, 0.0, 17.0, 11.0, 8.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 158.0, 10.0, 18.0, 0.0, 14.0, 9.0, 56.0, 0.0, 12.0, 5.0, 0.0, 0.0, 1.0, 15.0, 3.0, 17.0, 17.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 12.0, 29.0, 0.0, 0.0, 8.0, 0.0, 9.0, 8.0, 0.0, 0.0, 7.0, 86.0, 0.0, 9.0, 22.0, 14.0, 0.0, 0.0, 0.0, 0.0, 22.0, 9.0, 87.0, 30.0, 12.0, 5.0, 17.0, 18.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 4.0, 60.0, 9.0, 0.0, 0.0, 11.0, 26.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 2.0, 0.0, 15.0, 15.0, 19.0, 13.0, 16.0, 15.0, 0.0, 7.0, 22.0, 12.0, 29.0, 44.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 5.0, 9.0, 14.0, 0.0, 0.0, 12.0, 9.0, 4.0, 10.0, 11.0, 0.0, 12.0, 13.0, 0.0, 22.0, 0.0, 5.0, 10.0, 2.0, 6.0, 58.0, 23.0, 0.0, 10.0, 10.0, 0.0, 4.0, 0.0, 11.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 30.0, 29.0, 16.0, 37.0, 0.0, 0.0, 14.0, 14.0, 0.0, 0.0, 3.0, 3.0, 6.0, 8.0, 7.0, 0.0, 7.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 14.0, 8.0, 47.0, 14.0, 0.0, 22.0, 0.0, 0.0, 0.0, 9.0, 11.0, 26.0, 0.0, 13.0, 0.0, 5.0, 0.0, 0.0, 9.0, 14.0, 14.0, 0.0, 0.0, 4.0, 0.0, 2.0, 9.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5214435933488293, "mean_inference_ms": 15.006038365566651, "mean_action_processing_ms": 4.570338468538262, "mean_env_wait_ms": 0.46355678484491825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008124113082885742, "StateBufferConnector_ms": 0.0038465261459350586, "ViewRequirementAgentConnector_ms": 0.15781927108764648}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 22.900000000000055, "episode_return_mean": 329.707, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.7631734263079, "num_env_steps_trained_throughput_per_sec": 298.7631734263079, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 2256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2256000, "timers": {"training_iteration_time_ms": 377757.967, "restore_workers_time_ms": 0.033, "training_step_time_ms": 377757.866, "sample_time_ms": 102817.71, "learn_time_ms": 274916.051, "learn_throughput": 14.55, "synch_weights_time_ms": 19.49}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 2256000, "num_agent_steps_trained": 2256000}, "done": false, "training_iteration": 141, "trial_id": "e4caa_00000", "date": "2024-08-13_23-10-21", "timestamp": 1723605021, "time_this_iter_s": 13.43700122833252, "time_total_s": 12349.710853099823, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb8d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12349.710853099823, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 55.15263157894737, "ram_util_percent": 83.73684210526315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9871826198681322, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9785841407027667, "policy_loss": -0.010519510210940131, "vf_loss": 0.9889719101092803, "vf_explained_var": 0.6022274080723051, "kl": 0.009368286934365816, "entropy": 1.0450705576826025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 267435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1617569483185888, "cur_kl_coeff": 2.366582715663035e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6480263940240971, "policy_loss": -0.0014093808733695557, "vf_loss": 0.6494357728966014, "vf_explained_var": 0.10818309112200661, "kl": 0.0009151518945466874, "entropy": 0.010136381797763524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 267435.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 22.900000000000055, "episode_reward_mean": 337.39399999999995, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -118.6, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 87.0}, "policy_reward_mean": {"prey_policy": 160.287, "predator_policy": 8.41}, "custom_metrics": {}, "hist_stats": {"episode_reward": [171.39999999999947, 390.1, 141.19999999999962, 179.99999999999977, 373.0, 360.6, 365.1, 356.8, 22.900000000000055, 378.4, 355.6, 40.0000000000003, 387.4, 335.6, 205.60000000000002, 373.8, 255.89999999999978, 394.6, 398.0, 396.0, 381.0, 265.9, 390.1, 302.3, 379.2, 388.3, 377.4, 384.7, 396.0, 344.5, 346.8, 127.69999999999969, 379.7, 289.1, 251.60000000000005, 391.9, 392.8, 390.0, 400.0, 375.0, 329.1, 378.4, 330.1, 374.4, 363.6, 369.5, 336.2, 377.4, 349.0, 245.89999999999998, 333.3, 341.1, 383.0, 359.1, 366.1, 394.0, 384.0, 230.39999999999975, 242.70000000000005, 349.6, 371.6, 397.3, 382.6, 371.1, 378.5, 380.0, 365.6, 378.4, 363.0, 231.8, 356.1, 348.8, 386.5, 345.6, 315.6, 366.8, 367.0, 367.0, 319.0, 388.3, 374.0, 369.6, 356.5, 375.7, 370.3, 384.2, 328.7, 388.3, 245.0, 375.2, 369.8, 359.5, 299.2, 347.7, 242.4999999999994, 379.5, 336.0, 241.0, 371.0, 372.2], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [151.4, 20.000000000000014, 192.8, 197.3, 20.000000000000014, 105.19999999999999, -3.100000000000037, 142.1, 181.1, 191.9, 154.39999999999998, 198.2, 175.1, 173.0, 179.3, 177.5, 48.5, -118.6, 171.2, 198.2, 128.6, 191.0, 20.000000000000014, 20.000000000000014, 200.0, 187.4, 143.6, 161.0, 199.1, -110.50000000000017, 197.0, 159.8, 36.199999999999974, 184.7, 194.6, 200.0, 197.0, 200.0, 196.0, 200.0, 200.0, 177.0, 194.0, 2.9000000000000057, 200.0, 190.1, 92.0, 173.3, 185.0, 189.2, 191.0, 197.3, 191.9, 180.5, 184.7, 200.0, 200.0, 194.0, 199.1, 115.4, 141.2, 173.6, 20.000000000000014, 76.69999999999999, 193.7, 179.0, 76.09999999999998, 179.0, 59.599999999999994, 119.0, 191.9, 200.0, 197.3, 195.5, 194.0, 196.0, 200.0, 200.0, 185.0, 182.0, 147.50000000000003, 158.6, 194.6, 183.8, 148.7, 160.4, 200.0, 160.4, 189.2, 163.4, 190.1, 154.4, 173.0, 141.2, 197.0, 175.4, 176.0, 161.0, -10.899999999999977, 192.8, 166.7, 143.6, 127.4, 193.7, 188.0, 191.0, 184.7, 163.4, 194.0, 160.1, 194.0, 200.0, 191.0, 193.0, 167.89999999999998, 3.4999999999999716, 74.6, 115.10000000000004, 161.3, 188.3, 197.0, 146.6, 199.1, 198.2, 191.0, 185.6, 176.0, 181.1, 175.4, 196.1, 194.0, 179.0, 200.0, 164.6, 178.4, 200.0, 176.0, 173.0, 103.1, 73.7, 167.0, 175.1, 176.0, 150.8, 194.6, 191.9, 170.3, 155.3, 96.8, 192.8, 161.0, 192.8, 185.0, 177.0, 185.0, 173.0, 196.0, 95.0, 195.5, 192.8, 182.0, 188.0, 173.0, 185.6, 154.1, 187.4, 191.9, 183.8, 166.7, 194.6, 200.0, 168.2, 195.2, 132.5, 195.5, 192.8, 176.0, -28.0, 180.2, 188.0, 179.3, 183.5, 174.8, 184.7, 134.9, 134.3, 200.0, 115.7, 200.0, 42.49999999999998, 173.3, 198.2, 173.0, 138.0, 191.0, 50.0, 193.7, 167.3, 177.2, 191.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 12.0, 29.0, 0.0, 0.0, 8.0, 0.0, 9.0, 8.0, 0.0, 0.0, 7.0, 86.0, 0.0, 9.0, 22.0, 14.0, 0.0, 0.0, 0.0, 0.0, 22.0, 9.0, 87.0, 30.0, 12.0, 5.0, 17.0, 18.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 4.0, 60.0, 9.0, 0.0, 0.0, 11.0, 26.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 2.0, 0.0, 15.0, 15.0, 19.0, 13.0, 16.0, 15.0, 0.0, 7.0, 22.0, 12.0, 29.0, 44.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 5.0, 9.0, 14.0, 0.0, 0.0, 12.0, 9.0, 4.0, 10.0, 11.0, 0.0, 12.0, 13.0, 0.0, 22.0, 0.0, 5.0, 10.0, 2.0, 6.0, 58.0, 23.0, 0.0, 10.0, 10.0, 0.0, 4.0, 0.0, 11.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 30.0, 29.0, 16.0, 37.0, 0.0, 0.0, 14.0, 14.0, 0.0, 0.0, 3.0, 3.0, 6.0, 8.0, 7.0, 0.0, 7.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 14.0, 8.0, 47.0, 14.0, 0.0, 22.0, 0.0, 0.0, 0.0, 9.0, 11.0, 26.0, 0.0, 13.0, 0.0, 5.0, 0.0, 0.0, 9.0, 14.0, 14.0, 0.0, 0.0, 4.0, 0.0, 2.0, 9.0, 15.0, 0.0, 0.0, 0.0, 9.0, 0.0, 6.0, 10.0, 0.0, 1.0, 0.0, 0.0, 74.0, 23.0, 4.0, 3.0, 1.0, 6.0, 0.0, 0.0, 14.0, 16.0, 16.0, 16.0, 0.0, 0.0, 8.0, 0.0, 13.0, 12.0, 0.0, 0.0, 0.0, 10.0, 0.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5286611467543336, "mean_inference_ms": 15.267549282148925, "mean_action_processing_ms": 4.362048116475486, "mean_env_wait_ms": 0.4623268393688036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006150484085083008, "StateBufferConnector_ms": 0.0034807920455932617, "ViewRequirementAgentConnector_ms": 0.15772318840026855}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 22.900000000000055, "episode_return_mean": 337.39399999999995, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.4347511718798, "num_env_steps_trained_throughput_per_sec": 294.4347511718798, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 2272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2272000, "timers": {"training_iteration_time_ms": 277368.169, "restore_workers_time_ms": 0.029, "training_step_time_ms": 277368.08, "sample_time_ms": 2491.304, "learn_time_ms": 274853.795, "learn_throughput": 14.553, "synch_weights_time_ms": 18.825}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 2272000, "num_agent_steps_trained": 2272000}, "done": false, "training_iteration": 142, "trial_id": "e4caa_00000", "date": "2024-08-13_23-10-35", "timestamp": 1723605035, "time_this_iter_s": 13.647552728652954, "time_total_s": 12363.358405828476, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29e0940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12363.358405828476, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 56.652631578947364, "ram_util_percent": 83.71052631578948}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9894218818851248, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.760362439064516, "policy_loss": -0.004749786053296356, "vf_loss": 0.7649912552464576, "vf_explained_var": 0.5306108985313032, "kl": 0.008602260773215898, "entropy": 1.015132656929985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 269325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2768045589800865, "cur_kl_coeff": 1.1832913578315174e-31, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5852880681396793, "policy_loss": -0.0008074117366165395, "vf_loss": 0.5860954807933282, "vf_explained_var": 0.054155757534440865, "kl": 0.0002845343715512803, "entropy": 0.008573512108651576, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 269325.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 127.69999999999969, "episode_reward_mean": 351.198, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -28.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 74.0}, "policy_reward_mean": {"prey_policy": 168.239, "predator_policy": 7.36}, "custom_metrics": {}, "hist_stats": {"episode_reward": [390.1, 302.3, 379.2, 388.3, 377.4, 384.7, 396.0, 344.5, 346.8, 127.69999999999969, 379.7, 289.1, 251.60000000000005, 391.9, 392.8, 390.0, 400.0, 375.0, 329.1, 378.4, 330.1, 374.4, 363.6, 369.5, 336.2, 377.4, 349.0, 245.89999999999998, 333.3, 341.1, 383.0, 359.1, 366.1, 394.0, 384.0, 230.39999999999975, 242.70000000000005, 349.6, 371.6, 397.3, 382.6, 371.1, 378.5, 380.0, 365.6, 378.4, 363.0, 231.8, 356.1, 348.8, 386.5, 345.6, 315.6, 366.8, 367.0, 367.0, 319.0, 388.3, 374.0, 369.6, 356.5, 375.7, 370.3, 384.2, 328.7, 388.3, 245.0, 375.2, 369.8, 359.5, 299.2, 347.7, 242.4999999999994, 379.5, 336.0, 241.0, 371.0, 372.2, 343.9, 381.1, 378.4, 382.8, 374.3, 399.1, 368.8, 365.8, 305.0, 333.7, 314.3, 392.8, 277.1999999999997, 345.1, 333.40000000000003, 396.40000000000003, 352.1, 384.0, 374.0, 384.0, 398.0, 325.1], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 190.1, 92.0, 173.3, 185.0, 189.2, 191.0, 197.3, 191.9, 180.5, 184.7, 200.0, 200.0, 194.0, 199.1, 115.4, 141.2, 173.6, 20.000000000000014, 76.69999999999999, 193.7, 179.0, 76.09999999999998, 179.0, 59.599999999999994, 119.0, 191.9, 200.0, 197.3, 195.5, 194.0, 196.0, 200.0, 200.0, 185.0, 182.0, 147.50000000000003, 158.6, 194.6, 183.8, 148.7, 160.4, 200.0, 160.4, 189.2, 163.4, 190.1, 154.4, 173.0, 141.2, 197.0, 175.4, 176.0, 161.0, -10.899999999999977, 192.8, 166.7, 143.6, 127.4, 193.7, 188.0, 191.0, 184.7, 163.4, 194.0, 160.1, 194.0, 200.0, 191.0, 193.0, 167.89999999999998, 3.4999999999999716, 74.6, 115.10000000000004, 161.3, 188.3, 197.0, 146.6, 199.1, 198.2, 191.0, 185.6, 176.0, 181.1, 175.4, 196.1, 194.0, 179.0, 200.0, 164.6, 178.4, 200.0, 176.0, 173.0, 103.1, 73.7, 167.0, 175.1, 176.0, 150.8, 194.6, 191.9, 170.3, 155.3, 96.8, 192.8, 161.0, 192.8, 185.0, 177.0, 185.0, 173.0, 196.0, 95.0, 195.5, 192.8, 182.0, 188.0, 173.0, 185.6, 154.1, 187.4, 191.9, 183.8, 166.7, 194.6, 200.0, 168.2, 195.2, 132.5, 195.5, 192.8, 176.0, -28.0, 180.2, 188.0, 179.3, 183.5, 174.8, 184.7, 134.9, 134.3, 200.0, 115.7, 200.0, 42.49999999999998, 173.3, 198.2, 173.0, 138.0, 191.0, 50.0, 193.7, 167.3, 177.2, 191.0, 167.0, 137.9, 181.1, 200.0, 192.8, 185.6, 194.6, 183.2, 179.0, 188.3, 200.0, 199.1, 193.7, 148.1, 189.2, 176.6, 115.1, 164.9, 118.7, 185.0, 71.3, 200.0, 192.8, 200.0, 81.19999999999996, 194.0, 200.0, 145.1, 193.7, 97.7, 197.3, 199.1, 130.1, 197.0, 200.0, 170.0, 191.0, 183.0, 176.0, 200.0, 197.0, 200.0, 159.5, 149.6], "policy_predator_policy_reward": [0.0, 0.0, 11.0, 26.0, 5.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 2.0, 0.0, 15.0, 15.0, 19.0, 13.0, 16.0, 15.0, 0.0, 7.0, 22.0, 12.0, 29.0, 44.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 5.0, 9.0, 14.0, 0.0, 0.0, 12.0, 9.0, 4.0, 10.0, 11.0, 0.0, 12.0, 13.0, 0.0, 22.0, 0.0, 5.0, 10.0, 2.0, 6.0, 58.0, 23.0, 0.0, 10.0, 10.0, 0.0, 4.0, 0.0, 11.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 30.0, 29.0, 16.0, 37.0, 0.0, 0.0, 14.0, 14.0, 0.0, 0.0, 3.0, 3.0, 6.0, 8.0, 7.0, 0.0, 7.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 14.0, 8.0, 47.0, 14.0, 0.0, 22.0, 0.0, 0.0, 0.0, 9.0, 11.0, 26.0, 0.0, 13.0, 0.0, 5.0, 0.0, 0.0, 9.0, 14.0, 14.0, 0.0, 0.0, 4.0, 0.0, 2.0, 9.0, 15.0, 0.0, 0.0, 0.0, 9.0, 0.0, 6.0, 10.0, 0.0, 1.0, 0.0, 0.0, 74.0, 23.0, 4.0, 3.0, 1.0, 6.0, 0.0, 0.0, 14.0, 16.0, 16.0, 16.0, 0.0, 0.0, 8.0, 0.0, 13.0, 12.0, 0.0, 0.0, 0.0, 10.0, 0.0, 4.0, 22.0, 17.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 7.0, 0.0, 0.0, 11.0, 16.0, 0.0, 0.0, 13.0, 12.0, 9.0, 21.0, 23.0, 20.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 22.0, 20.0, 0.0, 0.0, 8.0, 17.0, 7.0, 7.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 16.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5223930684310063, "mean_inference_ms": 15.16336401507239, "mean_action_processing_ms": 4.329680222947221, "mean_env_wait_ms": 0.46060031172447824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006000161170959473, "StateBufferConnector_ms": 0.003950238227844238, "ViewRequirementAgentConnector_ms": 0.15190386772155762}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 127.69999999999969, "episode_return_mean": 351.198, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.46123871139804, "num_env_steps_trained_throughput_per_sec": 305.46123871139804, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 2288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2288000, "timers": {"training_iteration_time_ms": 277029.678, "restore_workers_time_ms": 0.027, "training_step_time_ms": 277029.592, "sample_time_ms": 2177.102, "learn_time_ms": 274829.91, "learn_throughput": 14.554, "synch_weights_time_ms": 18.134}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 2288000, "num_agent_steps_trained": 2288000}, "done": false, "training_iteration": 143, "trial_id": "e4caa_00000", "date": "2024-08-13_23-10-48", "timestamp": 1723605048, "time_this_iter_s": 13.144973993301392, "time_total_s": 12376.503379821777, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb83a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12376.503379821777, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 55.168421052631594, "ram_util_percent": 83.72631578947369}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5629697150575421, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4264935581809373, "policy_loss": -0.005678912337435774, "vf_loss": 0.43207603131480044, "vf_explained_var": 0.37522543041163653, "kl": 0.006857806133225048, "entropy": 1.0258929395801806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 271215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1319016068227707, "cur_kl_coeff": 5.916456789157587e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.411032709778932, "policy_loss": -0.000655435519194398, "vf_loss": 0.4116881453818962, "vf_explained_var": 0.07779936494019928, "kl": 0.0008245075717228047, "entropy": 0.007429429432210912, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 271215.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 230.39999999999975, "episode_reward_mean": 354.34, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -28.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 74.0}, "policy_reward_mean": {"prey_policy": 170.18, "predator_policy": 6.99}, "custom_metrics": {}, "hist_stats": {"episode_reward": [329.1, 378.4, 330.1, 374.4, 363.6, 369.5, 336.2, 377.4, 349.0, 245.89999999999998, 333.3, 341.1, 383.0, 359.1, 366.1, 394.0, 384.0, 230.39999999999975, 242.70000000000005, 349.6, 371.6, 397.3, 382.6, 371.1, 378.5, 380.0, 365.6, 378.4, 363.0, 231.8, 356.1, 348.8, 386.5, 345.6, 315.6, 366.8, 367.0, 367.0, 319.0, 388.3, 374.0, 369.6, 356.5, 375.7, 370.3, 384.2, 328.7, 388.3, 245.0, 375.2, 369.8, 359.5, 299.2, 347.7, 242.4999999999994, 379.5, 336.0, 241.0, 371.0, 372.2, 343.9, 381.1, 378.4, 382.8, 374.3, 399.1, 368.8, 365.8, 305.0, 333.7, 314.3, 392.8, 277.1999999999997, 345.1, 333.40000000000003, 396.40000000000003, 352.1, 384.0, 374.0, 384.0, 398.0, 325.1, 371.4, 381.4, 320.1, 355.0, 367.9, 399.1, 400.0, 389.2, 375.7, 384.0, 275.4, 383.0, 375.0, 353.3, 360.0, 390.0, 348.0, 392.8], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [147.50000000000003, 158.6, 194.6, 183.8, 148.7, 160.4, 200.0, 160.4, 189.2, 163.4, 190.1, 154.4, 173.0, 141.2, 197.0, 175.4, 176.0, 161.0, -10.899999999999977, 192.8, 166.7, 143.6, 127.4, 193.7, 188.0, 191.0, 184.7, 163.4, 194.0, 160.1, 194.0, 200.0, 191.0, 193.0, 167.89999999999998, 3.4999999999999716, 74.6, 115.10000000000004, 161.3, 188.3, 197.0, 146.6, 199.1, 198.2, 191.0, 185.6, 176.0, 181.1, 175.4, 196.1, 194.0, 179.0, 200.0, 164.6, 178.4, 200.0, 176.0, 173.0, 103.1, 73.7, 167.0, 175.1, 176.0, 150.8, 194.6, 191.9, 170.3, 155.3, 96.8, 192.8, 161.0, 192.8, 185.0, 177.0, 185.0, 173.0, 196.0, 95.0, 195.5, 192.8, 182.0, 188.0, 173.0, 185.6, 154.1, 187.4, 191.9, 183.8, 166.7, 194.6, 200.0, 168.2, 195.2, 132.5, 195.5, 192.8, 176.0, -28.0, 180.2, 188.0, 179.3, 183.5, 174.8, 184.7, 134.9, 134.3, 200.0, 115.7, 200.0, 42.49999999999998, 173.3, 198.2, 173.0, 138.0, 191.0, 50.0, 193.7, 167.3, 177.2, 191.0, 167.0, 137.9, 181.1, 200.0, 192.8, 185.6, 194.6, 183.2, 179.0, 188.3, 200.0, 199.1, 193.7, 148.1, 189.2, 176.6, 115.1, 164.9, 118.7, 185.0, 71.3, 200.0, 192.8, 200.0, 81.19999999999996, 194.0, 200.0, 145.1, 193.7, 97.7, 197.3, 199.1, 130.1, 197.0, 200.0, 170.0, 191.0, 183.0, 176.0, 200.0, 197.0, 200.0, 159.5, 149.6, 179.0, 181.39999999999998, 178.39999999999998, 200.0, 176.0, 127.1, 139.70000000000002, 197.3, 156.5, 196.4, 200.0, 199.1, 200.0, 200.0, 191.9, 197.3, 173.0, 193.7, 200.0, 176.0, 93.8, 140.6, 200.0, 170.0, 161.0, 194.0, 153.8, 186.5, 176.0, 176.0, 200.0, 190.0, 161.0, 173.0, 200.0, 192.8], "policy_predator_policy_reward": [9.0, 14.0, 0.0, 0.0, 12.0, 9.0, 4.0, 10.0, 11.0, 0.0, 12.0, 13.0, 0.0, 22.0, 0.0, 5.0, 10.0, 2.0, 6.0, 58.0, 23.0, 0.0, 10.0, 10.0, 0.0, 4.0, 0.0, 11.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 30.0, 29.0, 16.0, 37.0, 0.0, 0.0, 14.0, 14.0, 0.0, 0.0, 3.0, 3.0, 6.0, 8.0, 7.0, 0.0, 7.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 14.0, 8.0, 47.0, 14.0, 0.0, 22.0, 0.0, 0.0, 0.0, 9.0, 11.0, 26.0, 0.0, 13.0, 0.0, 5.0, 0.0, 0.0, 9.0, 14.0, 14.0, 0.0, 0.0, 4.0, 0.0, 2.0, 9.0, 15.0, 0.0, 0.0, 0.0, 9.0, 0.0, 6.0, 10.0, 0.0, 1.0, 0.0, 0.0, 74.0, 23.0, 4.0, 3.0, 1.0, 6.0, 0.0, 0.0, 14.0, 16.0, 16.0, 16.0, 0.0, 0.0, 8.0, 0.0, 13.0, 12.0, 0.0, 0.0, 0.0, 10.0, 0.0, 4.0, 22.0, 17.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 7.0, 0.0, 0.0, 11.0, 16.0, 0.0, 0.0, 13.0, 12.0, 9.0, 21.0, 23.0, 20.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 22.0, 20.0, 0.0, 0.0, 8.0, 17.0, 7.0, 7.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 16.0, 0.0, 0.0, 11.0, 0.0, 3.0, 8.0, 9.0, 18.0, 0.0, 8.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 8.0, 0.0, 27.0, 14.0, 8.0, 5.0, 10.0, 10.0, 13.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.517377765746454, "mean_inference_ms": 15.080791769466176, "mean_action_processing_ms": 4.303864261870313, "mean_env_wait_ms": 0.4592247723893882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00561678409576416, "StateBufferConnector_ms": 0.004048347473144531, "ViewRequirementAgentConnector_ms": 0.1600552797317505}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 230.39999999999975, "episode_return_mean": 354.34, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.8797614601198, "num_env_steps_trained_throughput_per_sec": 302.8797614601198, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 2304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2304000, "timers": {"training_iteration_time_ms": 276977.706, "restore_workers_time_ms": 0.026, "training_step_time_ms": 276977.621, "sample_time_ms": 2114.519, "learn_time_ms": 274839.499, "learn_throughput": 14.554, "synch_weights_time_ms": 18.266}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 2304000, "num_agent_steps_trained": 2304000}, "done": false, "training_iteration": 144, "trial_id": "e4caa_00000", "date": "2024-08-13_23-11-01", "timestamp": 1723605061, "time_this_iter_s": 13.243252992630005, "time_total_s": 12389.746632814407, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29acaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12389.746632814407, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 51.10526315789474, "ram_util_percent": 83.83157894736841}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0253018183209908, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6852413429159218, "policy_loss": -0.006918923853448143, "vf_loss": 0.692070887490082, "vf_explained_var": 0.4213756551187505, "kl": 0.006355881017560968, "entropy": 1.0603034577041708, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 273105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4265063656700983, "cur_kl_coeff": 2.9582283945787936e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6406708556429419, "policy_loss": -0.0005687314405958488, "vf_loss": 0.6412395898508962, "vf_explained_var": 0.15789198648361932, "kl": 0.0002720898007108335, "entropy": 0.006722757141241341, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 273105.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 231.8, "episode_reward_mean": 357.153, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -28.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 74.0}, "policy_reward_mean": {"prey_policy": 171.87650000000002, "predator_policy": 6.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [242.70000000000005, 349.6, 371.6, 397.3, 382.6, 371.1, 378.5, 380.0, 365.6, 378.4, 363.0, 231.8, 356.1, 348.8, 386.5, 345.6, 315.6, 366.8, 367.0, 367.0, 319.0, 388.3, 374.0, 369.6, 356.5, 375.7, 370.3, 384.2, 328.7, 388.3, 245.0, 375.2, 369.8, 359.5, 299.2, 347.7, 242.4999999999994, 379.5, 336.0, 241.0, 371.0, 372.2, 343.9, 381.1, 378.4, 382.8, 374.3, 399.1, 368.8, 365.8, 305.0, 333.7, 314.3, 392.8, 277.1999999999997, 345.1, 333.40000000000003, 396.40000000000003, 352.1, 384.0, 374.0, 384.0, 398.0, 325.1, 371.4, 381.4, 320.1, 355.0, 367.9, 399.1, 400.0, 389.2, 375.7, 384.0, 275.4, 383.0, 375.0, 353.3, 360.0, 390.0, 348.0, 392.8, 389.2, 386.2, 352.20000000000005, 381.1, 359.5, 357.6, 377.1, 355.1, 392.4, 334.8, 368.7, 384.7, 307.6, 369.7, 374.0, 382.0, 335.1, 318.9], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [74.6, 115.10000000000004, 161.3, 188.3, 197.0, 146.6, 199.1, 198.2, 191.0, 185.6, 176.0, 181.1, 175.4, 196.1, 194.0, 179.0, 200.0, 164.6, 178.4, 200.0, 176.0, 173.0, 103.1, 73.7, 167.0, 175.1, 176.0, 150.8, 194.6, 191.9, 170.3, 155.3, 96.8, 192.8, 161.0, 192.8, 185.0, 177.0, 185.0, 173.0, 196.0, 95.0, 195.5, 192.8, 182.0, 188.0, 173.0, 185.6, 154.1, 187.4, 191.9, 183.8, 166.7, 194.6, 200.0, 168.2, 195.2, 132.5, 195.5, 192.8, 176.0, -28.0, 180.2, 188.0, 179.3, 183.5, 174.8, 184.7, 134.9, 134.3, 200.0, 115.7, 200.0, 42.49999999999998, 173.3, 198.2, 173.0, 138.0, 191.0, 50.0, 193.7, 167.3, 177.2, 191.0, 167.0, 137.9, 181.1, 200.0, 192.8, 185.6, 194.6, 183.2, 179.0, 188.3, 200.0, 199.1, 193.7, 148.1, 189.2, 176.6, 115.1, 164.9, 118.7, 185.0, 71.3, 200.0, 192.8, 200.0, 81.19999999999996, 194.0, 200.0, 145.1, 193.7, 97.7, 197.3, 199.1, 130.1, 197.0, 200.0, 170.0, 191.0, 183.0, 176.0, 200.0, 197.0, 200.0, 159.5, 149.6, 179.0, 181.39999999999998, 178.39999999999998, 200.0, 176.0, 127.1, 139.70000000000002, 197.3, 156.5, 196.4, 200.0, 199.1, 200.0, 200.0, 191.9, 197.3, 173.0, 193.7, 200.0, 176.0, 93.8, 140.6, 200.0, 170.0, 161.0, 194.0, 153.8, 186.5, 176.0, 176.0, 200.0, 190.0, 161.0, 173.0, 200.0, 192.8, 193.7, 195.5, 182.0, 198.2, 182.0, 156.2, 185.6, 195.5, 198.2, 143.3, 177.2, 154.4, 169.1, 197.0, 148.1, 188.0, 193.1, 197.3, 112.4, 196.4, 193.7, 149.0, 188.3, 196.4, 120.5, 145.1, 163.4, 194.3, 174.0, 197.0, 186.0, 194.0, 179.0, 124.1, 145.1, 144.8], "policy_predator_policy_reward": [16.0, 37.0, 0.0, 0.0, 14.0, 14.0, 0.0, 0.0, 3.0, 3.0, 6.0, 8.0, 7.0, 0.0, 7.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 14.0, 8.0, 47.0, 14.0, 0.0, 22.0, 0.0, 0.0, 0.0, 9.0, 11.0, 26.0, 0.0, 13.0, 0.0, 5.0, 0.0, 0.0, 9.0, 14.0, 14.0, 0.0, 0.0, 4.0, 0.0, 2.0, 9.0, 15.0, 0.0, 0.0, 0.0, 9.0, 0.0, 6.0, 10.0, 0.0, 1.0, 0.0, 0.0, 74.0, 23.0, 4.0, 3.0, 1.0, 6.0, 0.0, 0.0, 14.0, 16.0, 16.0, 16.0, 0.0, 0.0, 8.0, 0.0, 13.0, 12.0, 0.0, 0.0, 0.0, 10.0, 0.0, 4.0, 22.0, 17.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 7.0, 0.0, 0.0, 11.0, 16.0, 0.0, 0.0, 13.0, 12.0, 9.0, 21.0, 23.0, 20.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 22.0, 20.0, 0.0, 0.0, 8.0, 17.0, 7.0, 7.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 16.0, 0.0, 0.0, 11.0, 0.0, 3.0, 8.0, 9.0, 18.0, 0.0, 8.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 8.0, 0.0, 27.0, 14.0, 8.0, 5.0, 10.0, 10.0, 13.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 9.0, 5.0, 0.0, 0.0, 18.0, 0.0, 12.0, 14.0, 1.0, 10.0, 13.0, 6.0, 2.0, 0.0, 4.0, 22.0, 16.0, 10.0, 0.0, 0.0, 25.0, 17.0, 11.0, 1.0, 3.0, 0.0, 0.0, 2.0, 20.0, 12.0, 7.0, 22.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5123618034485977, "mean_inference_ms": 14.999367556180909, "mean_action_processing_ms": 4.278378579157934, "mean_env_wait_ms": 0.4578626594996715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005307435989379883, "StateBufferConnector_ms": 0.004067182540893555, "ViewRequirementAgentConnector_ms": 0.1585155725479126}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 231.8, "episode_return_mean": 357.153, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.54321745332624, "num_env_steps_trained_throughput_per_sec": 311.54321745332624, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 2320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2320000, "timers": {"training_iteration_time_ms": 14203.819, "restore_workers_time_ms": 0.023, "training_step_time_ms": 14203.742, "sample_time_ms": 2075.95, "learn_time_ms": 12105.858, "learn_throughput": 330.419, "synch_weights_time_ms": 16.525}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "done": false, "training_iteration": 145, "trial_id": "e4caa_00000", "date": "2024-08-13_23-11-14", "timestamp": 1723605074, "time_this_iter_s": 12.886579036712646, "time_total_s": 12402.63321185112, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12402.63321185112, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 50.77222222222222, "ram_util_percent": 83.69444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0970021842964113, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6325396693417575, "policy_loss": -0.005062657972137449, "vf_loss": 0.6374596802961259, "vf_explained_var": 0.4054068326950073, "kl": 0.010143831141496862, "entropy": 1.0602199334631521, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 274995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0041165538920611, "cur_kl_coeff": 1.4791141972893968e-32, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.22006457727895212, "policy_loss": -0.0021988662299773994, "vf_loss": 0.222263443821711, "vf_explained_var": 0.346900826093381, "kl": 0.0017531788653279015, "entropy": 0.011466664670000749, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 274995.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 241.0, "episode_reward_mean": 359.193, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -28.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 74.0}, "policy_reward_mean": {"prey_policy": 172.90149999999997, "predator_policy": 6.695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [369.6, 356.5, 375.7, 370.3, 384.2, 328.7, 388.3, 245.0, 375.2, 369.8, 359.5, 299.2, 347.7, 242.4999999999994, 379.5, 336.0, 241.0, 371.0, 372.2, 343.9, 381.1, 378.4, 382.8, 374.3, 399.1, 368.8, 365.8, 305.0, 333.7, 314.3, 392.8, 277.1999999999997, 345.1, 333.40000000000003, 396.40000000000003, 352.1, 384.0, 374.0, 384.0, 398.0, 325.1, 371.4, 381.4, 320.1, 355.0, 367.9, 399.1, 400.0, 389.2, 375.7, 384.0, 275.4, 383.0, 375.0, 353.3, 360.0, 390.0, 348.0, 392.8, 389.2, 386.2, 352.20000000000005, 381.1, 359.5, 357.6, 377.1, 355.1, 392.4, 334.8, 368.7, 384.7, 307.6, 369.7, 374.0, 382.0, 335.1, 318.9, 398.2, 383.79999999999995, 384.8, 384.7, 360.8, 377.0, 299.0, 318.70000000000005, 363.4, 394.4, 368.4, 339.4000000000001, 368.4, 348.1, 377.1, 348.5, 351.1, 375.0, 367.0, 343.0, 361.5, 374.6, 364.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [173.0, 185.6, 154.1, 187.4, 191.9, 183.8, 166.7, 194.6, 200.0, 168.2, 195.2, 132.5, 195.5, 192.8, 176.0, -28.0, 180.2, 188.0, 179.3, 183.5, 174.8, 184.7, 134.9, 134.3, 200.0, 115.7, 200.0, 42.49999999999998, 173.3, 198.2, 173.0, 138.0, 191.0, 50.0, 193.7, 167.3, 177.2, 191.0, 167.0, 137.9, 181.1, 200.0, 192.8, 185.6, 194.6, 183.2, 179.0, 188.3, 200.0, 199.1, 193.7, 148.1, 189.2, 176.6, 115.1, 164.9, 118.7, 185.0, 71.3, 200.0, 192.8, 200.0, 81.19999999999996, 194.0, 200.0, 145.1, 193.7, 97.7, 197.3, 199.1, 130.1, 197.0, 200.0, 170.0, 191.0, 183.0, 176.0, 200.0, 197.0, 200.0, 159.5, 149.6, 179.0, 181.39999999999998, 178.39999999999998, 200.0, 176.0, 127.1, 139.70000000000002, 197.3, 156.5, 196.4, 200.0, 199.1, 200.0, 200.0, 191.9, 197.3, 173.0, 193.7, 200.0, 176.0, 93.8, 140.6, 200.0, 170.0, 161.0, 194.0, 153.8, 186.5, 176.0, 176.0, 200.0, 190.0, 161.0, 173.0, 200.0, 192.8, 193.7, 195.5, 182.0, 198.2, 182.0, 156.2, 185.6, 195.5, 198.2, 143.3, 177.2, 154.4, 169.1, 197.0, 148.1, 188.0, 193.1, 197.3, 112.4, 196.4, 193.7, 149.0, 188.3, 196.4, 120.5, 145.1, 163.4, 194.3, 174.0, 197.0, 186.0, 194.0, 179.0, 124.1, 145.1, 144.8, 198.2, 200.0, 191.9, 191.89999999999998, 188.0, 192.8, 192.8, 191.9, 173.0, 171.8, 192.8, 177.2, 158.0, 77.0, 141.2, 162.5, 200.0, 133.39999999999998, 195.2, 198.2, 182.0, 178.39999999999998, 122.3, 199.1, 172.1, 182.3, 179.0, 139.1, 199.1, 167.0, 167.0, 162.5, 189.2, 146.89999999999998, 199.0, 156.0, 176.0, 182.0, 150.0, 179.0, 172.4, 181.1, 194.0, 170.6, 188.0, 164.0], "policy_predator_policy_reward": [2.0, 9.0, 15.0, 0.0, 0.0, 0.0, 9.0, 0.0, 6.0, 10.0, 0.0, 1.0, 0.0, 0.0, 74.0, 23.0, 4.0, 3.0, 1.0, 6.0, 0.0, 0.0, 14.0, 16.0, 16.0, 16.0, 0.0, 0.0, 8.0, 0.0, 13.0, 12.0, 0.0, 0.0, 0.0, 10.0, 0.0, 4.0, 22.0, 17.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 7.0, 0.0, 0.0, 11.0, 16.0, 0.0, 0.0, 13.0, 12.0, 9.0, 21.0, 23.0, 20.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 22.0, 20.0, 0.0, 0.0, 8.0, 17.0, 7.0, 7.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 16.0, 0.0, 0.0, 11.0, 0.0, 3.0, 8.0, 9.0, 18.0, 0.0, 8.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 8.0, 0.0, 27.0, 14.0, 8.0, 5.0, 10.0, 10.0, 13.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 9.0, 5.0, 0.0, 0.0, 18.0, 0.0, 12.0, 14.0, 1.0, 10.0, 13.0, 6.0, 2.0, 0.0, 4.0, 22.0, 16.0, 10.0, 0.0, 0.0, 25.0, 17.0, 11.0, 1.0, 3.0, 0.0, 0.0, 2.0, 20.0, 12.0, 7.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 7.0, 9.0, 0.0, 7.0, 35.0, 29.0, 0.0, 15.0, 18.0, 12.0, 1.0, 0.0, 8.0, 0.0, 8.0, 10.0, 14.0, 0.0, 14.0, 16.0, 11.0, 0.0, 19.0, 0.0, 15.0, 0.0, 10.0, 10.0, 1.0, 8.0, 7.0, 7.0, 0.0, 8.0, 10.0, 0.0, 12.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5061280589249053, "mean_inference_ms": 14.899067105639052, "mean_action_processing_ms": 4.246554271229266, "mean_env_wait_ms": 0.45616600094208565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005383014678955078, "StateBufferConnector_ms": 0.004309535026550293, "ViewRequirementAgentConnector_ms": 0.14826667308807373}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 241.0, "episode_return_mean": 359.193, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.8901858908903, "num_env_steps_trained_throughput_per_sec": 306.8901858908903, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 2336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2336000, "timers": {"training_iteration_time_ms": 13446.081, "restore_workers_time_ms": 0.019, "training_step_time_ms": 13446.015, "sample_time_ms": 1807.488, "learn_time_ms": 11615.911, "learn_throughput": 344.355, "synch_weights_time_ms": 17.199}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 2336000, "num_agent_steps_trained": 2336000}, "done": false, "training_iteration": 146, "trial_id": "e4caa_00000", "date": "2024-08-13_23-11-27", "timestamp": 1723605087, "time_this_iter_s": 13.064385175704956, "time_total_s": 12415.697597026825, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2987dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12415.697597026825, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 51.577777777777776, "ram_util_percent": 83.74444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0589069928757096, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5102141307796249, "policy_loss": -0.006030701514993789, "vf_loss": 0.5161318364617212, "vf_explained_var": 0.42646319364744517, "kl": 0.00803533425469333, "entropy": 1.020831704644299, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 276885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0730259587052007, "cur_kl_coeff": 7.395570986446984e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.27542012089065143, "policy_loss": -0.0006618888304623031, "vf_loss": 0.27608200996004234, "vf_explained_var": 0.23816864704959606, "kl": 0.0006024453997979524, "entropy": 0.00851752782011375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 276885.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 275.4, "episode_reward_mean": 365.05, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 71.3, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 35.0}, "policy_reward_mean": {"prey_policy": 176.795, "predator_policy": 5.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [382.8, 374.3, 399.1, 368.8, 365.8, 305.0, 333.7, 314.3, 392.8, 277.1999999999997, 345.1, 333.40000000000003, 396.40000000000003, 352.1, 384.0, 374.0, 384.0, 398.0, 325.1, 371.4, 381.4, 320.1, 355.0, 367.9, 399.1, 400.0, 389.2, 375.7, 384.0, 275.4, 383.0, 375.0, 353.3, 360.0, 390.0, 348.0, 392.8, 389.2, 386.2, 352.20000000000005, 381.1, 359.5, 357.6, 377.1, 355.1, 392.4, 334.8, 368.7, 384.7, 307.6, 369.7, 374.0, 382.0, 335.1, 318.9, 398.2, 383.79999999999995, 384.8, 384.7, 360.8, 377.0, 299.0, 318.70000000000005, 363.4, 394.4, 368.4, 339.4000000000001, 368.4, 348.1, 377.1, 348.5, 351.1, 375.0, 367.0, 343.0, 361.5, 374.6, 364.0, 367.6, 369.8, 351.9, 382.0, 378.1, 385.3, 391.9, 360.1, 347.70000000000005, 382.0, 371.2, 396.4, 372.1, 391.9, 370.3, 353.6, 381.6, 400.0, 371.0, 346.0, 361.4000000000001, 369.1], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [194.6, 183.2, 179.0, 188.3, 200.0, 199.1, 193.7, 148.1, 189.2, 176.6, 115.1, 164.9, 118.7, 185.0, 71.3, 200.0, 192.8, 200.0, 81.19999999999996, 194.0, 200.0, 145.1, 193.7, 97.7, 197.3, 199.1, 130.1, 197.0, 200.0, 170.0, 191.0, 183.0, 176.0, 200.0, 197.0, 200.0, 159.5, 149.6, 179.0, 181.39999999999998, 178.39999999999998, 200.0, 176.0, 127.1, 139.70000000000002, 197.3, 156.5, 196.4, 200.0, 199.1, 200.0, 200.0, 191.9, 197.3, 173.0, 193.7, 200.0, 176.0, 93.8, 140.6, 200.0, 170.0, 161.0, 194.0, 153.8, 186.5, 176.0, 176.0, 200.0, 190.0, 161.0, 173.0, 200.0, 192.8, 193.7, 195.5, 182.0, 198.2, 182.0, 156.2, 185.6, 195.5, 198.2, 143.3, 177.2, 154.4, 169.1, 197.0, 148.1, 188.0, 193.1, 197.3, 112.4, 196.4, 193.7, 149.0, 188.3, 196.4, 120.5, 145.1, 163.4, 194.3, 174.0, 197.0, 186.0, 194.0, 179.0, 124.1, 145.1, 144.8, 198.2, 200.0, 191.9, 191.89999999999998, 188.0, 192.8, 192.8, 191.9, 173.0, 171.8, 192.8, 177.2, 158.0, 77.0, 141.2, 162.5, 200.0, 133.39999999999998, 195.2, 198.2, 182.0, 178.39999999999998, 122.3, 199.1, 172.1, 182.3, 179.0, 139.1, 199.1, 167.0, 167.0, 162.5, 189.2, 146.89999999999998, 199.0, 156.0, 176.0, 182.0, 150.0, 179.0, 172.4, 181.1, 194.0, 170.6, 188.0, 164.0, 181.1, 186.5, 190.1, 172.7, 181.4, 168.5, 184.7, 197.3, 191.0, 169.1, 200.0, 179.3, 200.0, 191.9, 186.5, 149.6, 157.7, 185.0, 193.7, 188.3, 184.7, 186.5, 200.0, 196.4, 173.0, 199.1, 194.6, 197.3, 185.6, 184.7, 179.0, 155.6, 185.6, 194.0, 200.0, 200.0, 183.0, 182.0, 173.0, 154.0, 189.2, 168.2, 189.2, 173.9], "policy_predator_policy_reward": [5.0, 0.0, 0.0, 7.0, 0.0, 0.0, 11.0, 16.0, 0.0, 0.0, 13.0, 12.0, 9.0, 21.0, 23.0, 20.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 22.0, 20.0, 0.0, 0.0, 8.0, 17.0, 7.0, 7.0, 0.0, 0.0, 8.0, 0.0, 1.0, 0.0, 16.0, 0.0, 0.0, 11.0, 0.0, 3.0, 8.0, 9.0, 18.0, 0.0, 8.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 8.0, 0.0, 27.0, 14.0, 8.0, 5.0, 10.0, 10.0, 13.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 9.0, 5.0, 0.0, 0.0, 18.0, 0.0, 12.0, 14.0, 1.0, 10.0, 13.0, 6.0, 2.0, 0.0, 4.0, 22.0, 16.0, 10.0, 0.0, 0.0, 25.0, 17.0, 11.0, 1.0, 3.0, 0.0, 0.0, 2.0, 20.0, 12.0, 7.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 7.0, 9.0, 0.0, 7.0, 35.0, 29.0, 0.0, 15.0, 18.0, 12.0, 1.0, 0.0, 8.0, 0.0, 8.0, 10.0, 14.0, 0.0, 14.0, 16.0, 11.0, 0.0, 19.0, 0.0, 15.0, 0.0, 10.0, 10.0, 1.0, 8.0, 7.0, 7.0, 0.0, 8.0, 10.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 2.0, 0.0, 0.0, 6.0, 12.0, 0.0, 6.0, 0.0, 0.0, 12.0, 12.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 6.0, 2.0, 0.0, 0.0, 0.0, 6.0, 0.0, 4.0, 15.0, 0.0, 4.0, 0.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5085022243430881, "mean_inference_ms": 14.64041778455287, "mean_action_processing_ms": 4.373852511785544, "mean_env_wait_ms": 0.45481924596167345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005622148513793945, "StateBufferConnector_ms": 0.004291057586669922, "ViewRequirementAgentConnector_ms": 0.14043498039245605}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 275.4, "episode_return_mean": 365.05, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.3808110750413, "num_env_steps_trained_throughput_per_sec": 300.3808110750413, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 2352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2352000, "timers": {"training_iteration_time_ms": 13333.781, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13333.733, "sample_time_ms": 1715.501, "learn_time_ms": 11595.199, "learn_throughput": 344.97, "synch_weights_time_ms": 17.514}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 2352000, "num_agent_steps_trained": 2352000}, "done": false, "training_iteration": 147, "trial_id": "e4caa_00000", "date": "2024-08-13_23-11-41", "timestamp": 1723605101, "time_this_iter_s": 13.404352188110352, "time_total_s": 12429.101949214935, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bf9040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12429.101949214935, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 49.485, "ram_util_percent": 83.82000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8112554230544933, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6536256190028676, "policy_loss": -0.013849831163321459, "vf_loss": 0.6672589913917282, "vf_explained_var": 0.5587973078722677, "kl": 0.015392560933953555, "entropy": 1.0371362092633727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 278775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0907946231503967, "cur_kl_coeff": 3.697785493223492e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.24600438494925145, "policy_loss": -0.01683180779415779, "vf_loss": 0.2628361922464575, "vf_explained_var": 0.08023247384520435, "kl": 0.44593180818834544, "entropy": 0.3988335325520624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 278775.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 275.4, "episode_reward_mean": 366.401, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 77.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 35.0}, "policy_reward_mean": {"prey_policy": 177.7955, "predator_policy": 5.405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [325.1, 371.4, 381.4, 320.1, 355.0, 367.9, 399.1, 400.0, 389.2, 375.7, 384.0, 275.4, 383.0, 375.0, 353.3, 360.0, 390.0, 348.0, 392.8, 389.2, 386.2, 352.20000000000005, 381.1, 359.5, 357.6, 377.1, 355.1, 392.4, 334.8, 368.7, 384.7, 307.6, 369.7, 374.0, 382.0, 335.1, 318.9, 398.2, 383.79999999999995, 384.8, 384.7, 360.8, 377.0, 299.0, 318.70000000000005, 363.4, 394.4, 368.4, 339.4000000000001, 368.4, 348.1, 377.1, 348.5, 351.1, 375.0, 367.0, 343.0, 361.5, 374.6, 364.0, 367.6, 369.8, 351.9, 382.0, 378.1, 385.3, 391.9, 360.1, 347.70000000000005, 382.0, 371.2, 396.4, 372.1, 391.9, 370.3, 353.6, 381.6, 400.0, 371.0, 346.0, 361.4000000000001, 369.1, 361.7, 371.5, 370.9, 386.5, 397.3, 311.9, 356.8, 368.6, 365.9, 381.1, 379.3, 390.4, 338.8, 383.40000000000003, 362.0, 372.0, 375.7, 342.1], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [159.5, 149.6, 179.0, 181.39999999999998, 178.39999999999998, 200.0, 176.0, 127.1, 139.70000000000002, 197.3, 156.5, 196.4, 200.0, 199.1, 200.0, 200.0, 191.9, 197.3, 173.0, 193.7, 200.0, 176.0, 93.8, 140.6, 200.0, 170.0, 161.0, 194.0, 153.8, 186.5, 176.0, 176.0, 200.0, 190.0, 161.0, 173.0, 200.0, 192.8, 193.7, 195.5, 182.0, 198.2, 182.0, 156.2, 185.6, 195.5, 198.2, 143.3, 177.2, 154.4, 169.1, 197.0, 148.1, 188.0, 193.1, 197.3, 112.4, 196.4, 193.7, 149.0, 188.3, 196.4, 120.5, 145.1, 163.4, 194.3, 174.0, 197.0, 186.0, 194.0, 179.0, 124.1, 145.1, 144.8, 198.2, 200.0, 191.9, 191.89999999999998, 188.0, 192.8, 192.8, 191.9, 173.0, 171.8, 192.8, 177.2, 158.0, 77.0, 141.2, 162.5, 200.0, 133.39999999999998, 195.2, 198.2, 182.0, 178.39999999999998, 122.3, 199.1, 172.1, 182.3, 179.0, 139.1, 199.1, 167.0, 167.0, 162.5, 189.2, 146.89999999999998, 199.0, 156.0, 176.0, 182.0, 150.0, 179.0, 172.4, 181.1, 194.0, 170.6, 188.0, 164.0, 181.1, 186.5, 190.1, 172.7, 181.4, 168.5, 184.7, 197.3, 191.0, 169.1, 200.0, 179.3, 200.0, 191.9, 186.5, 149.6, 157.7, 185.0, 193.7, 188.3, 184.7, 186.5, 200.0, 196.4, 173.0, 199.1, 194.6, 197.3, 185.6, 184.7, 179.0, 155.6, 185.6, 194.0, 200.0, 200.0, 183.0, 182.0, 173.0, 154.0, 189.2, 168.2, 189.2, 173.9, 151.7, 194.0, 197.3, 162.2, 158.0, 191.9, 187.4, 199.1, 198.2, 199.1, 176.0, 122.9, 186.5, 170.29999999999998, 143.6, 200.0, 161.0, 191.9, 194.6, 186.5, 194.6, 184.7, 200.0, 187.4, 154.7, 163.1, 189.2, 192.2, 158.0, 194.0, 162.0, 197.0, 185.6, 190.1, 180.2, 146.9], "policy_predator_policy_reward": [16.0, 0.0, 0.0, 11.0, 0.0, 3.0, 8.0, 9.0, 18.0, 0.0, 8.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 8.0, 0.0, 27.0, 14.0, 8.0, 5.0, 10.0, 10.0, 13.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 9.0, 5.0, 0.0, 0.0, 18.0, 0.0, 12.0, 14.0, 1.0, 10.0, 13.0, 6.0, 2.0, 0.0, 4.0, 22.0, 16.0, 10.0, 0.0, 0.0, 25.0, 17.0, 11.0, 1.0, 3.0, 0.0, 0.0, 2.0, 20.0, 12.0, 7.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 7.0, 9.0, 0.0, 7.0, 35.0, 29.0, 0.0, 15.0, 18.0, 12.0, 1.0, 0.0, 8.0, 0.0, 8.0, 10.0, 14.0, 0.0, 14.0, 16.0, 11.0, 0.0, 19.0, 0.0, 15.0, 0.0, 10.0, 10.0, 1.0, 8.0, 7.0, 7.0, 0.0, 8.0, 10.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 2.0, 0.0, 0.0, 6.0, 12.0, 0.0, 6.0, 0.0, 0.0, 12.0, 12.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 6.0, 2.0, 0.0, 0.0, 0.0, 6.0, 0.0, 4.0, 15.0, 0.0, 4.0, 0.0, 6.0, 14.0, 2.0, 0.0, 12.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 8.0, 0.0, 0.0, 13.0, 12.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 19.0, 2.0, 0.0, 9.0, 1.0, 13.0, 0.0, 0.0, 0.0, 0.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4952918427082624, "mean_inference_ms": 14.72552785711125, "mean_action_processing_ms": 4.19260715663872, "mean_env_wait_ms": 0.453216260643258, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066422224044799805, "StateBufferConnector_ms": 0.007105827331542969, "ViewRequirementAgentConnector_ms": 0.12352168560028076}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 275.4, "episode_return_mean": 366.401, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.6083132349541, "num_env_steps_trained_throughput_per_sec": 300.6083132349541, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 2368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2368000, "timers": {"training_iteration_time_ms": 13320.986, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13320.938, "sample_time_ms": 1689.249, "learn_time_ms": 11609.321, "learn_throughput": 344.551, "synch_weights_time_ms": 17.306}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 2368000, "num_agent_steps_trained": 2368000}, "done": false, "training_iteration": 148, "trial_id": "e4caa_00000", "date": "2024-08-13_23-11-54", "timestamp": 1723605114, "time_this_iter_s": 13.354304075241089, "time_total_s": 12442.456253290176, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2987ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12442.456253290176, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 51.08421052631579, "ram_util_percent": 83.70526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8367703324903255, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7496226623023629, "policy_loss": -0.008351155828004555, "vf_loss": 0.7578710163790713, "vf_explained_var": 0.6428239553693741, "kl": 0.007310238843395725, "entropy": 1.0398926523627428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 280665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.627775454552716, "cur_kl_coeff": 5.546678239835241e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4197391474451968, "policy_loss": -0.0010118557443280541, "vf_loss": 0.42075100254499054, "vf_explained_var": 0.09393867493937255, "kl": 0.0015966219471347902, "entropy": 0.0315408446259363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 280665.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 273.0, "episode_reward_mean": 364.418, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 77.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 35.0}, "policy_reward_mean": {"prey_policy": 176.804, "predator_policy": 5.405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [392.8, 389.2, 386.2, 352.20000000000005, 381.1, 359.5, 357.6, 377.1, 355.1, 392.4, 334.8, 368.7, 384.7, 307.6, 369.7, 374.0, 382.0, 335.1, 318.9, 398.2, 383.79999999999995, 384.8, 384.7, 360.8, 377.0, 299.0, 318.70000000000005, 363.4, 394.4, 368.4, 339.4000000000001, 368.4, 348.1, 377.1, 348.5, 351.1, 375.0, 367.0, 343.0, 361.5, 374.6, 364.0, 367.6, 369.8, 351.9, 382.0, 378.1, 385.3, 391.9, 360.1, 347.70000000000005, 382.0, 371.2, 396.4, 372.1, 391.9, 370.3, 353.6, 381.6, 400.0, 371.0, 346.0, 361.4000000000001, 369.1, 361.7, 371.5, 370.9, 386.5, 397.3, 311.9, 356.8, 368.6, 365.9, 381.1, 379.3, 390.4, 338.8, 383.40000000000003, 362.0, 372.0, 375.7, 342.1, 365.8, 352.4, 340.40000000000003, 383.8, 366.7, 283.8999999999999, 323.79999999999995, 334.9, 361.9, 382.0, 350.30000000000007, 398.0, 386.6, 336.4, 273.0, 367.0, 365.8, 382.6], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 192.8, 193.7, 195.5, 182.0, 198.2, 182.0, 156.2, 185.6, 195.5, 198.2, 143.3, 177.2, 154.4, 169.1, 197.0, 148.1, 188.0, 193.1, 197.3, 112.4, 196.4, 193.7, 149.0, 188.3, 196.4, 120.5, 145.1, 163.4, 194.3, 174.0, 197.0, 186.0, 194.0, 179.0, 124.1, 145.1, 144.8, 198.2, 200.0, 191.9, 191.89999999999998, 188.0, 192.8, 192.8, 191.9, 173.0, 171.8, 192.8, 177.2, 158.0, 77.0, 141.2, 162.5, 200.0, 133.39999999999998, 195.2, 198.2, 182.0, 178.39999999999998, 122.3, 199.1, 172.1, 182.3, 179.0, 139.1, 199.1, 167.0, 167.0, 162.5, 189.2, 146.89999999999998, 199.0, 156.0, 176.0, 182.0, 150.0, 179.0, 172.4, 181.1, 194.0, 170.6, 188.0, 164.0, 181.1, 186.5, 190.1, 172.7, 181.4, 168.5, 184.7, 197.3, 191.0, 169.1, 200.0, 179.3, 200.0, 191.9, 186.5, 149.6, 157.7, 185.0, 193.7, 188.3, 184.7, 186.5, 200.0, 196.4, 173.0, 199.1, 194.6, 197.3, 185.6, 184.7, 179.0, 155.6, 185.6, 194.0, 200.0, 200.0, 183.0, 182.0, 173.0, 154.0, 189.2, 168.2, 189.2, 173.9, 151.7, 194.0, 197.3, 162.2, 158.0, 191.9, 187.4, 199.1, 198.2, 199.1, 176.0, 122.9, 186.5, 170.29999999999998, 143.6, 200.0, 161.0, 191.9, 194.6, 186.5, 194.6, 184.7, 200.0, 187.4, 154.7, 163.1, 189.2, 192.2, 158.0, 194.0, 162.0, 197.0, 185.6, 190.1, 180.2, 146.9, 173.0, 183.8, 185.0, 142.4, 150.2, 189.2, 196.4, 187.4, 180.2, 186.5, 187.4, 87.49999999999997, 153.5, 146.3, 170.0, 140.9, 188.0, 158.9, 186.5, 195.5, 196.1, 153.2, 200.0, 197.0, 178.4, 198.2, 142.4, 167.0, 140.0, 114.0, 195.0, 137.0, 174.8, 191.0, 194.6, 182.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 9.0, 5.0, 0.0, 0.0, 18.0, 0.0, 12.0, 14.0, 1.0, 10.0, 13.0, 6.0, 2.0, 0.0, 4.0, 22.0, 16.0, 10.0, 0.0, 0.0, 25.0, 17.0, 11.0, 1.0, 3.0, 0.0, 0.0, 2.0, 20.0, 12.0, 7.0, 22.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 0.0, 0.0, 7.0, 9.0, 0.0, 7.0, 35.0, 29.0, 0.0, 15.0, 18.0, 12.0, 1.0, 0.0, 8.0, 0.0, 8.0, 10.0, 14.0, 0.0, 14.0, 16.0, 11.0, 0.0, 19.0, 0.0, 15.0, 0.0, 10.0, 10.0, 1.0, 8.0, 7.0, 7.0, 0.0, 8.0, 10.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 2.0, 0.0, 0.0, 6.0, 12.0, 0.0, 6.0, 0.0, 0.0, 12.0, 12.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 6.0, 2.0, 0.0, 0.0, 0.0, 6.0, 0.0, 4.0, 15.0, 0.0, 4.0, 0.0, 6.0, 14.0, 2.0, 0.0, 12.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 8.0, 0.0, 0.0, 13.0, 12.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 19.0, 2.0, 0.0, 9.0, 1.0, 13.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 9.0, 20.0, 5.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 15.0, 9.0, 14.0, 10.0, 4.0, 11.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 5.0, 5.0, 1.0, 26.0, 19.0, 0.0, 15.0, 20.0, 0.0, 0.0, 0.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4903299768776639, "mean_inference_ms": 14.647552445111582, "mean_action_processing_ms": 4.168364859247694, "mean_env_wait_ms": 0.4518310529230621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006549477577209473, "StateBufferConnector_ms": 0.0070531368255615234, "ViewRequirementAgentConnector_ms": 0.11507761478424072}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 273.0, "episode_return_mean": 364.418, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.92320337716916, "num_env_steps_trained_throughput_per_sec": 306.92320337716916, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 2384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2384000, "timers": {"training_iteration_time_ms": 13210.006, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13209.957, "sample_time_ms": 1658.421, "learn_time_ms": 11528.894, "learn_throughput": 346.954, "synch_weights_time_ms": 17.414}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 2384000, "num_agent_steps_trained": 2384000}, "done": false, "training_iteration": 149, "trial_id": "e4caa_00000", "date": "2024-08-13_23-12-07", "timestamp": 1723605127, "time_this_iter_s": 13.081118106842041, "time_total_s": 12455.537371397018, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb8550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12455.537371397018, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 51.97222222222222, "ram_util_percent": 83.86111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7486853124918762, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.43690486404005063, "policy_loss": -0.00827574243537451, "vf_loss": 0.44507229240345103, "vf_explained_var": 0.43974252119266166, "kl": 0.00770239202997898, "entropy": 1.0265148875574586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 282555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.144342680452835, "cur_kl_coeff": 2.7733391199176204e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2042139284312725, "policy_loss": -0.0016238953328134602, "vf_loss": 0.2058378239928513, "vf_explained_var": 0.12709926240658634, "kl": 0.007574427799662323, "entropy": 0.043335767324383136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 282555.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 273.0, "episode_reward_mean": 362.2190000000001, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 77.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 35.0}, "policy_reward_mean": {"prey_policy": 175.93949999999998, "predator_policy": 5.17}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.8, 377.0, 299.0, 318.70000000000005, 363.4, 394.4, 368.4, 339.4000000000001, 368.4, 348.1, 377.1, 348.5, 351.1, 375.0, 367.0, 343.0, 361.5, 374.6, 364.0, 367.6, 369.8, 351.9, 382.0, 378.1, 385.3, 391.9, 360.1, 347.70000000000005, 382.0, 371.2, 396.4, 372.1, 391.9, 370.3, 353.6, 381.6, 400.0, 371.0, 346.0, 361.4000000000001, 369.1, 361.7, 371.5, 370.9, 386.5, 397.3, 311.9, 356.8, 368.6, 365.9, 381.1, 379.3, 390.4, 338.8, 383.40000000000003, 362.0, 372.0, 375.7, 342.1, 365.8, 352.4, 340.40000000000003, 383.8, 366.7, 283.8999999999999, 323.79999999999995, 334.9, 361.9, 382.0, 350.30000000000007, 398.0, 386.6, 336.4, 273.0, 367.0, 365.8, 382.6, 326.1, 371.5, 354.1, 351.9, 326.1, 377.4, 400.0, 365.0, 365.0, 305.5, 364.5, 341.70000000000005, 395.1, 343.2, 322.5999999999999, 381.0, 373.1, 395.0, 332.0, 377.0, 330.6, 375.5, 376.4], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [173.0, 171.8, 192.8, 177.2, 158.0, 77.0, 141.2, 162.5, 200.0, 133.39999999999998, 195.2, 198.2, 182.0, 178.39999999999998, 122.3, 199.1, 172.1, 182.3, 179.0, 139.1, 199.1, 167.0, 167.0, 162.5, 189.2, 146.89999999999998, 199.0, 156.0, 176.0, 182.0, 150.0, 179.0, 172.4, 181.1, 194.0, 170.6, 188.0, 164.0, 181.1, 186.5, 190.1, 172.7, 181.4, 168.5, 184.7, 197.3, 191.0, 169.1, 200.0, 179.3, 200.0, 191.9, 186.5, 149.6, 157.7, 185.0, 193.7, 188.3, 184.7, 186.5, 200.0, 196.4, 173.0, 199.1, 194.6, 197.3, 185.6, 184.7, 179.0, 155.6, 185.6, 194.0, 200.0, 200.0, 183.0, 182.0, 173.0, 154.0, 189.2, 168.2, 189.2, 173.9, 151.7, 194.0, 197.3, 162.2, 158.0, 191.9, 187.4, 199.1, 198.2, 199.1, 176.0, 122.9, 186.5, 170.29999999999998, 143.6, 200.0, 161.0, 191.9, 194.6, 186.5, 194.6, 184.7, 200.0, 187.4, 154.7, 163.1, 189.2, 192.2, 158.0, 194.0, 162.0, 197.0, 185.6, 190.1, 180.2, 146.9, 173.0, 183.8, 185.0, 142.4, 150.2, 189.2, 196.4, 187.4, 180.2, 186.5, 187.4, 87.49999999999997, 153.5, 146.3, 170.0, 140.9, 188.0, 158.9, 186.5, 195.5, 196.1, 153.2, 200.0, 197.0, 178.4, 198.2, 142.4, 167.0, 140.0, 114.0, 195.0, 137.0, 174.8, 191.0, 194.6, 182.0, 181.4, 139.7, 192.8, 175.7, 172.1, 173.0, 176.0, 137.9, 161.9, 120.2, 179.0, 187.4, 200.0, 200.0, 160.1, 191.9, 200.0, 161.0, 142.39999999999998, 163.1, 161.6, 191.9, 189.2, 144.5, 199.1, 194.0, 169.1, 166.1, 122.6, 200.0, 185.0, 191.0, 199.1, 152.0, 195.0, 200.0, 174.0, 141.0, 186.0, 191.0, 183.2, 133.4, 188.9, 185.6, 168.2, 198.2], "policy_predator_policy_reward": [7.0, 9.0, 0.0, 7.0, 35.0, 29.0, 0.0, 15.0, 18.0, 12.0, 1.0, 0.0, 8.0, 0.0, 8.0, 10.0, 14.0, 0.0, 14.0, 16.0, 11.0, 0.0, 19.0, 0.0, 15.0, 0.0, 10.0, 10.0, 1.0, 8.0, 7.0, 7.0, 0.0, 8.0, 10.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 2.0, 0.0, 0.0, 6.0, 12.0, 0.0, 6.0, 0.0, 0.0, 12.0, 12.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 6.0, 2.0, 0.0, 0.0, 0.0, 6.0, 0.0, 4.0, 15.0, 0.0, 4.0, 0.0, 6.0, 14.0, 2.0, 0.0, 12.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 8.0, 0.0, 0.0, 13.0, 12.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 19.0, 2.0, 0.0, 9.0, 1.0, 13.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 9.0, 20.0, 5.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 15.0, 9.0, 14.0, 10.0, 4.0, 11.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 5.0, 5.0, 1.0, 26.0, 19.0, 0.0, 15.0, 20.0, 0.0, 0.0, 0.0, 6.0, 5.0, 0.0, 0.0, 3.0, 0.0, 9.0, 19.0, 19.0, 16.0, 28.0, 4.0, 7.0, 0.0, 0.0, 13.0, 0.0, 0.0, 4.0, 0.0, 0.0, 11.0, 0.0, 8.0, 0.0, 2.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 12.0, 10.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 2.0, 12.0, 0.0, 1.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4729404541751805, "mean_inference_ms": 14.230355429454416, "mean_action_processing_ms": 4.309825947630753, "mean_env_wait_ms": 0.4499939619702053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006795167922973633, "StateBufferConnector_ms": 0.006918668746948242, "ViewRequirementAgentConnector_ms": 0.1174231767654419}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 273.0, "episode_return_mean": 362.2190000000001, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.8734317916175, "num_env_steps_trained_throughput_per_sec": 307.8734317916175, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 13179.648, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13179.599, "sample_time_ms": 1652.55, "learn_time_ms": 11504.811, "learn_throughput": 347.681, "synch_weights_time_ms": 17.075}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": false, "training_iteration": 150, "trial_id": "e4caa_00000", "date": "2024-08-13_23-12-20", "timestamp": 1723605140, "time_this_iter_s": 13.034596681594849, "time_total_s": 12468.571968078613, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29acaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12468.571968078613, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 47.91052631578947, "ram_util_percent": 83.60526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.895266054239538, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.39094722832032375, "policy_loss": -0.00648439526200669, "vf_loss": 0.3973501068403176, "vf_explained_var": 0.502951518000749, "kl": 0.00579668641229316, "entropy": 1.0192524719175207, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 284445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0887256232716103, "cur_kl_coeff": 2.7733391199176204e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.13609923303383525, "policy_loss": -0.0006117346931850074, "vf_loss": 0.13671096702440144, "vf_explained_var": 0.3129691486951535, "kl": 0.001266171500830747, "entropy": 0.029207267804642913, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 284445.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 273.0, "episode_reward_mean": 366.01300000000003, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 87.49999999999997, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 28.0}, "policy_reward_mean": {"prey_policy": 178.8615, "predator_policy": 4.145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [364.0, 367.6, 369.8, 351.9, 382.0, 378.1, 385.3, 391.9, 360.1, 347.70000000000005, 382.0, 371.2, 396.4, 372.1, 391.9, 370.3, 353.6, 381.6, 400.0, 371.0, 346.0, 361.4000000000001, 369.1, 361.7, 371.5, 370.9, 386.5, 397.3, 311.9, 356.8, 368.6, 365.9, 381.1, 379.3, 390.4, 338.8, 383.40000000000003, 362.0, 372.0, 375.7, 342.1, 365.8, 352.4, 340.40000000000003, 383.8, 366.7, 283.8999999999999, 323.79999999999995, 334.9, 361.9, 382.0, 350.30000000000007, 398.0, 386.6, 336.4, 273.0, 367.0, 365.8, 382.6, 326.1, 371.5, 354.1, 351.9, 326.1, 377.4, 400.0, 365.0, 365.0, 305.5, 364.5, 341.70000000000005, 395.1, 343.2, 322.5999999999999, 381.0, 373.1, 395.0, 332.0, 377.0, 330.6, 375.5, 376.4, 381.5, 359.6, 391.0, 399.1, 395.5, 380.9, 390.2, 363.2, 370.5, 343.3, 378.1, 388.3, 364.8, 390.3, 378.0, 372.0, 383.0, 385.5], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [188.0, 164.0, 181.1, 186.5, 190.1, 172.7, 181.4, 168.5, 184.7, 197.3, 191.0, 169.1, 200.0, 179.3, 200.0, 191.9, 186.5, 149.6, 157.7, 185.0, 193.7, 188.3, 184.7, 186.5, 200.0, 196.4, 173.0, 199.1, 194.6, 197.3, 185.6, 184.7, 179.0, 155.6, 185.6, 194.0, 200.0, 200.0, 183.0, 182.0, 173.0, 154.0, 189.2, 168.2, 189.2, 173.9, 151.7, 194.0, 197.3, 162.2, 158.0, 191.9, 187.4, 199.1, 198.2, 199.1, 176.0, 122.9, 186.5, 170.29999999999998, 143.6, 200.0, 161.0, 191.9, 194.6, 186.5, 194.6, 184.7, 200.0, 187.4, 154.7, 163.1, 189.2, 192.2, 158.0, 194.0, 162.0, 197.0, 185.6, 190.1, 180.2, 146.9, 173.0, 183.8, 185.0, 142.4, 150.2, 189.2, 196.4, 187.4, 180.2, 186.5, 187.4, 87.49999999999997, 153.5, 146.3, 170.0, 140.9, 188.0, 158.9, 186.5, 195.5, 196.1, 153.2, 200.0, 197.0, 178.4, 198.2, 142.4, 167.0, 140.0, 114.0, 195.0, 137.0, 174.8, 191.0, 194.6, 182.0, 181.4, 139.7, 192.8, 175.7, 172.1, 173.0, 176.0, 137.9, 161.9, 120.2, 179.0, 187.4, 200.0, 200.0, 160.1, 191.9, 200.0, 161.0, 142.39999999999998, 163.1, 161.6, 191.9, 189.2, 144.5, 199.1, 194.0, 169.1, 166.1, 122.6, 200.0, 185.0, 191.0, 199.1, 152.0, 195.0, 200.0, 174.0, 141.0, 186.0, 191.0, 183.2, 133.4, 188.9, 185.6, 168.2, 198.2, 196.4, 178.1, 194.6, 146.0, 197.3, 193.7, 200.0, 199.1, 199.1, 196.4, 182.9, 197.0, 190.1, 196.1, 176.3, 173.9, 186.5, 176.0, 183.79999999999998, 159.5, 182.0, 190.1, 188.3, 200.0, 150.8, 200.0, 182.3, 200.0, 194.0, 178.0, 184.0, 182.0, 179.0, 197.0, 181.4, 199.1], "policy_predator_policy_reward": [12.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 2.0, 0.0, 0.0, 6.0, 12.0, 0.0, 6.0, 0.0, 0.0, 12.0, 12.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 6.0, 2.0, 0.0, 0.0, 0.0, 6.0, 0.0, 4.0, 15.0, 0.0, 4.0, 0.0, 6.0, 14.0, 2.0, 0.0, 12.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 8.0, 0.0, 0.0, 13.0, 12.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 19.0, 2.0, 0.0, 9.0, 1.0, 13.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 9.0, 20.0, 5.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 15.0, 9.0, 14.0, 10.0, 4.0, 11.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 5.0, 5.0, 1.0, 26.0, 19.0, 0.0, 15.0, 20.0, 0.0, 0.0, 0.0, 6.0, 5.0, 0.0, 0.0, 3.0, 0.0, 9.0, 19.0, 19.0, 16.0, 28.0, 4.0, 7.0, 0.0, 0.0, 13.0, 0.0, 0.0, 4.0, 0.0, 0.0, 11.0, 0.0, 8.0, 0.0, 2.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 12.0, 10.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 2.0, 12.0, 0.0, 1.0, 0.0, 10.0, 6.0, 1.0, 11.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 1.0, 7.0, 6.0, 0.0, 8.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 14.0, 0.0, 5.0, 3.0, 2.0, 4.0, 6.0, 0.0, 7.0, 0.0, 5.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4796637285707859, "mean_inference_ms": 14.479279068342526, "mean_action_processing_ms": 4.115828823302264, "mean_env_wait_ms": 0.44880792690781024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00674748420715332, "StateBufferConnector_ms": 0.007283926010131836, "ViewRequirementAgentConnector_ms": 0.11336207389831543}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 273.0, "episode_return_mean": 366.01300000000003, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.74309993690247, "num_env_steps_trained_throughput_per_sec": 306.74309993690247, "timesteps_total": 604000, "num_env_steps_sampled_lifetime": 604000, "num_agent_steps_sampled_lifetime": 2416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2416000, "timers": {"training_iteration_time_ms": 13144.819, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13144.766, "sample_time_ms": 1649.373, "learn_time_ms": 11473.938, "learn_throughput": 348.616, "synch_weights_time_ms": 16.433}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 2416000, "num_agent_steps_trained": 2416000}, "done": false, "training_iteration": 151, "trial_id": "e4caa_00000", "date": "2024-08-13_23-12-33", "timestamp": 1723605153, "time_this_iter_s": 13.087219953536987, "time_total_s": 12481.65918803215, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2987ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12481.65918803215, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 52.083333333333336, "ram_util_percent": 83.72222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6686355665562644, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.43416398961882957, "policy_loss": -0.006565256162778174, "vf_loss": 0.44059683310567704, "vf_explained_var": 0.38173653278401287, "kl": 0.009415964833096686, "entropy": 1.011630919559923, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 286335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1862428082044794, "cur_kl_coeff": 1.3866695599588102e-33, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.34134784439411114, "policy_loss": -0.0035563111756115205, "vf_loss": 0.34490415567677546, "vf_explained_var": 0.11356200957424427, "kl": 0.003229381158981354, "entropy": 0.0452251114946588, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 286335.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 273.0, "episode_reward_mean": 366.37500000000006, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 87.49999999999997, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 28.0}, "policy_reward_mean": {"prey_policy": 178.8625, "predator_policy": 4.325}, "custom_metrics": {}, "hist_stats": {"episode_reward": [369.1, 361.7, 371.5, 370.9, 386.5, 397.3, 311.9, 356.8, 368.6, 365.9, 381.1, 379.3, 390.4, 338.8, 383.40000000000003, 362.0, 372.0, 375.7, 342.1, 365.8, 352.4, 340.40000000000003, 383.8, 366.7, 283.8999999999999, 323.79999999999995, 334.9, 361.9, 382.0, 350.30000000000007, 398.0, 386.6, 336.4, 273.0, 367.0, 365.8, 382.6, 326.1, 371.5, 354.1, 351.9, 326.1, 377.4, 400.0, 365.0, 365.0, 305.5, 364.5, 341.70000000000005, 395.1, 343.2, 322.5999999999999, 381.0, 373.1, 395.0, 332.0, 377.0, 330.6, 375.5, 376.4, 381.5, 359.6, 391.0, 399.1, 395.5, 380.9, 390.2, 363.2, 370.5, 343.3, 378.1, 388.3, 364.8, 390.3, 378.0, 372.0, 383.0, 385.5, 400.0, 342.5, 368.6, 362.5, 394.6, 393.7, 399.1, 384.2, 366.0, 392.0, 359.2, 378.2, 386.5, 374.8, 364.0, 362.6, 355.70000000000005, 363.0, 386.0, 371.0, 368.1, 359.8], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [189.2, 173.9, 151.7, 194.0, 197.3, 162.2, 158.0, 191.9, 187.4, 199.1, 198.2, 199.1, 176.0, 122.9, 186.5, 170.29999999999998, 143.6, 200.0, 161.0, 191.9, 194.6, 186.5, 194.6, 184.7, 200.0, 187.4, 154.7, 163.1, 189.2, 192.2, 158.0, 194.0, 162.0, 197.0, 185.6, 190.1, 180.2, 146.9, 173.0, 183.8, 185.0, 142.4, 150.2, 189.2, 196.4, 187.4, 180.2, 186.5, 187.4, 87.49999999999997, 153.5, 146.3, 170.0, 140.9, 188.0, 158.9, 186.5, 195.5, 196.1, 153.2, 200.0, 197.0, 178.4, 198.2, 142.4, 167.0, 140.0, 114.0, 195.0, 137.0, 174.8, 191.0, 194.6, 182.0, 181.4, 139.7, 192.8, 175.7, 172.1, 173.0, 176.0, 137.9, 161.9, 120.2, 179.0, 187.4, 200.0, 200.0, 160.1, 191.9, 200.0, 161.0, 142.39999999999998, 163.1, 161.6, 191.9, 189.2, 144.5, 199.1, 194.0, 169.1, 166.1, 122.6, 200.0, 185.0, 191.0, 199.1, 152.0, 195.0, 200.0, 174.0, 141.0, 186.0, 191.0, 183.2, 133.4, 188.9, 185.6, 168.2, 198.2, 196.4, 178.1, 194.6, 146.0, 197.3, 193.7, 200.0, 199.1, 199.1, 196.4, 182.9, 197.0, 190.1, 196.1, 176.3, 173.9, 186.5, 176.0, 183.79999999999998, 159.5, 182.0, 190.1, 188.3, 200.0, 150.8, 200.0, 182.3, 200.0, 194.0, 178.0, 184.0, 182.0, 179.0, 197.0, 181.4, 199.1, 200.0, 200.0, 200.0, 120.5, 200.0, 155.6, 191.0, 168.5, 199.1, 195.5, 193.7, 200.0, 200.0, 199.1, 200.0, 168.2, 173.0, 176.0, 200.0, 188.0, 141.2, 197.0, 177.2, 200.0, 186.5, 200.0, 200.0, 165.8, 175.7, 188.3, 188.3, 161.3, 166.7, 176.0, 173.0, 185.0, 197.0, 189.0, 185.0, 186.0, 167.0, 190.1, 172.1, 175.7], "policy_predator_policy_reward": [0.0, 6.0, 14.0, 2.0, 0.0, 12.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 8.0, 0.0, 0.0, 13.0, 12.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 2.0, 19.0, 2.0, 0.0, 9.0, 1.0, 13.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 9.0, 20.0, 5.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 15.0, 9.0, 14.0, 10.0, 4.0, 11.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 5.0, 5.0, 1.0, 26.0, 19.0, 0.0, 15.0, 20.0, 0.0, 0.0, 0.0, 6.0, 5.0, 0.0, 0.0, 3.0, 0.0, 9.0, 19.0, 19.0, 16.0, 28.0, 4.0, 7.0, 0.0, 0.0, 13.0, 0.0, 0.0, 4.0, 0.0, 0.0, 11.0, 0.0, 8.0, 0.0, 2.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 12.0, 10.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 2.0, 12.0, 0.0, 1.0, 0.0, 10.0, 6.0, 1.0, 11.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 1.0, 7.0, 6.0, 0.0, 8.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 14.0, 0.0, 5.0, 3.0, 2.0, 4.0, 6.0, 0.0, 7.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 13.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 9.0, 8.0, 0.0, 4.0, 18.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 8.0, 5.0, 8.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4736938402626583, "mean_inference_ms": 14.385726702521342, "mean_action_processing_ms": 4.087076797235736, "mean_env_wait_ms": 0.44714854492829476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006649136543273926, "StateBufferConnector_ms": 0.007890462875366211, "ViewRequirementAgentConnector_ms": 0.11737596988677979}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 273.0, "episode_return_mean": 366.37500000000006, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.5105328278393, "num_env_steps_trained_throughput_per_sec": 302.5105328278393, "timesteps_total": 608000, "num_env_steps_sampled_lifetime": 608000, "num_agent_steps_sampled_lifetime": 2432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2432000, "timers": {"training_iteration_time_ms": 13108.552, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13108.5, "sample_time_ms": 1619.776, "learn_time_ms": 11467.28, "learn_throughput": 348.819, "synch_weights_time_ms": 16.77}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 2432000, "num_agent_steps_trained": 2432000}, "done": false, "training_iteration": 152, "trial_id": "e4caa_00000", "date": "2024-08-13_23-12-47", "timestamp": 1723605167, "time_this_iter_s": 13.285991191864014, "time_total_s": 12494.945179224014, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b2f820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12494.945179224014, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 51.49473684210527, "ram_util_percent": 83.7578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.726495292278194, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5754597464788251, "policy_loss": -0.00659965823069412, "vf_loss": 0.5819270173895847, "vf_explained_var": 0.6025130149548646, "kl": 0.009414277042070407, "entropy": 0.974119849085177, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 288225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.151591414008191, "cur_kl_coeff": 6.933347799794051e-34, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.40705153505322794, "policy_loss": -0.001705942276086678, "vf_loss": 0.4087574763007945, "vf_explained_var": 0.1255109419583013, "kl": 0.0014230827287269217, "entropy": 0.030347582104704566, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 288225.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 273.0, "episode_reward_mean": 365.95799999999997, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 87.49999999999997, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 28.0}, "policy_reward_mean": {"prey_policy": 178.34400000000002, "predator_policy": 4.635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [342.1, 365.8, 352.4, 340.40000000000003, 383.8, 366.7, 283.8999999999999, 323.79999999999995, 334.9, 361.9, 382.0, 350.30000000000007, 398.0, 386.6, 336.4, 273.0, 367.0, 365.8, 382.6, 326.1, 371.5, 354.1, 351.9, 326.1, 377.4, 400.0, 365.0, 365.0, 305.5, 364.5, 341.70000000000005, 395.1, 343.2, 322.5999999999999, 381.0, 373.1, 395.0, 332.0, 377.0, 330.6, 375.5, 376.4, 381.5, 359.6, 391.0, 399.1, 395.5, 380.9, 390.2, 363.2, 370.5, 343.3, 378.1, 388.3, 364.8, 390.3, 378.0, 372.0, 383.0, 385.5, 400.0, 342.5, 368.6, 362.5, 394.6, 393.7, 399.1, 384.2, 366.0, 392.0, 359.2, 378.2, 386.5, 374.8, 364.0, 362.6, 355.70000000000005, 363.0, 386.0, 371.0, 368.1, 359.8, 369.0, 320.0, 382.9, 369.6, 389.2, 296.5, 387.4, 369.4, 370.6, 382.0, 370.1, 371.2, 369.9, 358.2, 366.0, 377.0, 390.2, 362.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [180.2, 146.9, 173.0, 183.8, 185.0, 142.4, 150.2, 189.2, 196.4, 187.4, 180.2, 186.5, 187.4, 87.49999999999997, 153.5, 146.3, 170.0, 140.9, 188.0, 158.9, 186.5, 195.5, 196.1, 153.2, 200.0, 197.0, 178.4, 198.2, 142.4, 167.0, 140.0, 114.0, 195.0, 137.0, 174.8, 191.0, 194.6, 182.0, 181.4, 139.7, 192.8, 175.7, 172.1, 173.0, 176.0, 137.9, 161.9, 120.2, 179.0, 187.4, 200.0, 200.0, 160.1, 191.9, 200.0, 161.0, 142.39999999999998, 163.1, 161.6, 191.9, 189.2, 144.5, 199.1, 194.0, 169.1, 166.1, 122.6, 200.0, 185.0, 191.0, 199.1, 152.0, 195.0, 200.0, 174.0, 141.0, 186.0, 191.0, 183.2, 133.4, 188.9, 185.6, 168.2, 198.2, 196.4, 178.1, 194.6, 146.0, 197.3, 193.7, 200.0, 199.1, 199.1, 196.4, 182.9, 197.0, 190.1, 196.1, 176.3, 173.9, 186.5, 176.0, 183.79999999999998, 159.5, 182.0, 190.1, 188.3, 200.0, 150.8, 200.0, 182.3, 200.0, 194.0, 178.0, 184.0, 182.0, 179.0, 197.0, 181.4, 199.1, 200.0, 200.0, 200.0, 120.5, 200.0, 155.6, 191.0, 168.5, 199.1, 195.5, 193.7, 200.0, 200.0, 199.1, 200.0, 168.2, 173.0, 176.0, 200.0, 188.0, 141.2, 197.0, 177.2, 200.0, 186.5, 200.0, 200.0, 165.8, 175.7, 188.3, 188.3, 161.3, 166.7, 176.0, 173.0, 185.0, 197.0, 189.0, 185.0, 186.0, 167.0, 190.1, 172.1, 175.7, 131.0, 200.0, 154.7, 152.3, 193.7, 189.2, 200.0, 161.6, 191.0, 198.2, 151.4, 145.1, 191.9, 195.5, 133.4, 200.0, 187.4, 171.2, 200.0, 173.0, 161.9, 198.2, 166.7, 195.5, 170.3, 185.6, 179.0, 159.20000000000002, 197.0, 154.0, 158.0, 200.0, 198.2, 188.0, 179.0, 173.0], "policy_predator_policy_reward": [0.0, 15.0, 0.0, 9.0, 20.0, 5.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 15.0, 9.0, 14.0, 10.0, 4.0, 11.0, 0.0, 0.0, 0.0, 1.0, 0.0, 1.0, 5.0, 5.0, 1.0, 26.0, 19.0, 0.0, 15.0, 20.0, 0.0, 0.0, 0.0, 6.0, 5.0, 0.0, 0.0, 3.0, 0.0, 9.0, 19.0, 19.0, 16.0, 28.0, 4.0, 7.0, 0.0, 0.0, 13.0, 0.0, 0.0, 4.0, 0.0, 0.0, 11.0, 0.0, 8.0, 0.0, 2.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 12.0, 10.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 2.0, 12.0, 0.0, 1.0, 0.0, 10.0, 6.0, 1.0, 11.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 1.0, 7.0, 6.0, 0.0, 8.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 14.0, 0.0, 5.0, 3.0, 2.0, 4.0, 6.0, 0.0, 7.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 13.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 9.0, 8.0, 0.0, 4.0, 18.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 8.0, 5.0, 8.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 12.0, 22.0, 16.0, 0.0, 13.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 18.0, 6.0, 6.0, 9.0, 0.0, 0.0, 10.0, 0.0, 9.0, 7.0, 7.0, 10.0, 10.0, 7.0, 8.0, 7.0, 12.0, 0.0, 4.0, 4.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4689380723146297, "mean_inference_ms": 14.311890688759922, "mean_action_processing_ms": 4.064168405419324, "mean_env_wait_ms": 0.44583550842675845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0046269893646240234, "StateBufferConnector_ms": 0.004563450813293457, "ViewRequirementAgentConnector_ms": 0.11770236492156982}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 273.0, "episode_return_mean": 365.95799999999997, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.19638854514983, "num_env_steps_trained_throughput_per_sec": 294.19638854514983, "timesteps_total": 612000, "num_env_steps_sampled_lifetime": 612000, "num_agent_steps_sampled_lifetime": 2448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2448000, "timers": {"training_iteration_time_ms": 13158.693, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13158.641, "sample_time_ms": 1643.541, "learn_time_ms": 11493.982, "learn_throughput": 348.008, "synch_weights_time_ms": 16.644}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 2448000, "num_agent_steps_trained": 2448000}, "done": false, "training_iteration": 153, "trial_id": "e4caa_00000", "date": "2024-08-13_23-13-00", "timestamp": 1723605180, "time_this_iter_s": 13.640224933624268, "time_total_s": 12508.585404157639, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b2fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12508.585404157639, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 53.749999999999986, "ram_util_percent": 83.72999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6027070166257325, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.31560518680468447, "policy_loss": -0.0025734639972960823, "vf_loss": 0.3180652457848684, "vf_explained_var": 0.4151709031175684, "kl": 0.008064291518632345, "entropy": 0.9885214013712746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 290115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7601388835441814, "cur_kl_coeff": 3.4666738998970255e-34, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.14516906366097154, "policy_loss": -0.0005397320754589542, "vf_loss": 0.14570879608278148, "vf_explained_var": 0.1076860699388716, "kl": 0.0011892775308552257, "entropy": 0.024649791447593578, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 290115.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 296.5, "episode_reward_mean": 368.37699999999995, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 120.2, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 28.0}, "policy_reward_mean": {"prey_policy": 179.6985, "predator_policy": 4.49}, "custom_metrics": {}, "hist_stats": {"episode_reward": [382.6, 326.1, 371.5, 354.1, 351.9, 326.1, 377.4, 400.0, 365.0, 365.0, 305.5, 364.5, 341.70000000000005, 395.1, 343.2, 322.5999999999999, 381.0, 373.1, 395.0, 332.0, 377.0, 330.6, 375.5, 376.4, 381.5, 359.6, 391.0, 399.1, 395.5, 380.9, 390.2, 363.2, 370.5, 343.3, 378.1, 388.3, 364.8, 390.3, 378.0, 372.0, 383.0, 385.5, 400.0, 342.5, 368.6, 362.5, 394.6, 393.7, 399.1, 384.2, 366.0, 392.0, 359.2, 378.2, 386.5, 374.8, 364.0, 362.6, 355.70000000000005, 363.0, 386.0, 371.0, 368.1, 359.8, 369.0, 320.0, 382.9, 369.6, 389.2, 296.5, 387.4, 369.4, 370.6, 382.0, 370.1, 371.2, 369.9, 358.2, 366.0, 377.0, 390.2, 362.0, 325.90000000000003, 386.1, 373.1, 352.4, 366.70000000000005, 357.70000000000005, 336.3, 371.9, 370.1, 370.1, 364.0, 386.5, 366.3, 383.3, 358.0, 341.0, 381.7, 365.6], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [194.6, 182.0, 181.4, 139.7, 192.8, 175.7, 172.1, 173.0, 176.0, 137.9, 161.9, 120.2, 179.0, 187.4, 200.0, 200.0, 160.1, 191.9, 200.0, 161.0, 142.39999999999998, 163.1, 161.6, 191.9, 189.2, 144.5, 199.1, 194.0, 169.1, 166.1, 122.6, 200.0, 185.0, 191.0, 199.1, 152.0, 195.0, 200.0, 174.0, 141.0, 186.0, 191.0, 183.2, 133.4, 188.9, 185.6, 168.2, 198.2, 196.4, 178.1, 194.6, 146.0, 197.3, 193.7, 200.0, 199.1, 199.1, 196.4, 182.9, 197.0, 190.1, 196.1, 176.3, 173.9, 186.5, 176.0, 183.79999999999998, 159.5, 182.0, 190.1, 188.3, 200.0, 150.8, 200.0, 182.3, 200.0, 194.0, 178.0, 184.0, 182.0, 179.0, 197.0, 181.4, 199.1, 200.0, 200.0, 200.0, 120.5, 200.0, 155.6, 191.0, 168.5, 199.1, 195.5, 193.7, 200.0, 200.0, 199.1, 200.0, 168.2, 173.0, 176.0, 200.0, 188.0, 141.2, 197.0, 177.2, 200.0, 186.5, 200.0, 200.0, 165.8, 175.7, 188.3, 188.3, 161.3, 166.7, 176.0, 173.0, 185.0, 197.0, 189.0, 185.0, 186.0, 167.0, 190.1, 172.1, 175.7, 131.0, 200.0, 154.7, 152.3, 193.7, 189.2, 200.0, 161.6, 191.0, 198.2, 151.4, 145.1, 191.9, 195.5, 133.4, 200.0, 187.4, 171.2, 200.0, 173.0, 161.9, 198.2, 166.7, 195.5, 170.3, 185.6, 179.0, 159.20000000000002, 197.0, 154.0, 158.0, 200.0, 198.2, 188.0, 179.0, 173.0, 179.0, 131.89999999999998, 192.2, 191.9, 200.0, 160.1, 170.0, 172.4, 166.7, 200.0, 192.8, 164.9, 190.1, 120.2, 176.0, 185.9, 165.5, 194.6, 179.0, 178.1, 134.0, 200.0, 186.5, 200.0, 163.4, 191.9, 188.0, 191.3, 167.0, 173.0, 148.0, 185.0, 175.7, 200.0, 163.7, 191.9], "policy_predator_policy_reward": [0.0, 6.0, 5.0, 0.0, 0.0, 3.0, 0.0, 9.0, 19.0, 19.0, 16.0, 28.0, 4.0, 7.0, 0.0, 0.0, 13.0, 0.0, 0.0, 4.0, 0.0, 0.0, 11.0, 0.0, 8.0, 0.0, 2.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 5.0, 12.0, 10.0, 0.0, 0.0, 0.0, 17.0, 0.0, 0.0, 2.0, 12.0, 0.0, 1.0, 0.0, 10.0, 6.0, 1.0, 11.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 1.0, 7.0, 6.0, 0.0, 8.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 14.0, 0.0, 5.0, 3.0, 2.0, 4.0, 6.0, 0.0, 7.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 13.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 9.0, 8.0, 0.0, 4.0, 18.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 8.0, 5.0, 8.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 12.0, 22.0, 16.0, 0.0, 13.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 18.0, 6.0, 6.0, 9.0, 0.0, 0.0, 10.0, 0.0, 9.0, 7.0, 7.0, 10.0, 10.0, 7.0, 8.0, 7.0, 12.0, 0.0, 4.0, 4.0, 6.0, 8.0, 7.0, 2.0, 0.0, 0.0, 13.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 0.0, 10.0, 10.0, 0.0, 13.0, 0.0, 21.0, 9.0, 0.0, 0.0, 11.0, 0.0, 4.0, 0.0, 18.0, 0.0, 0.0, 8.0, 6.0, 0.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4642761639297346, "mean_inference_ms": 14.239266012640691, "mean_action_processing_ms": 4.041583024495749, "mean_env_wait_ms": 0.4445537245954324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004634976387023926, "StateBufferConnector_ms": 0.004509687423706055, "ViewRequirementAgentConnector_ms": 0.12599408626556396}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 296.5, "episode_return_mean": 368.37699999999995, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.9511185144035, "num_env_steps_trained_throughput_per_sec": 305.9511185144035, "timesteps_total": 616000, "num_env_steps_sampled_lifetime": 616000, "num_agent_steps_sampled_lifetime": 2464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2464000, "timers": {"training_iteration_time_ms": 13145.435, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13145.383, "sample_time_ms": 1625.535, "learn_time_ms": 11499.215, "learn_throughput": 347.85, "synch_weights_time_ms": 17.225}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 2464000, "num_agent_steps_trained": 2464000}, "done": false, "training_iteration": 154, "trial_id": "e4caa_00000", "date": "2024-08-13_23-13-14", "timestamp": 1723605194, "time_this_iter_s": 13.119905233383179, "time_total_s": 12521.705309391022, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b2fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12521.705309391022, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 50.35, "ram_util_percent": 83.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0687472034699073, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5910971287121779, "policy_loss": -0.008296137898371964, "vf_loss": 0.599139799657598, "vf_explained_var": 0.4857433501690153, "kl": 0.018024335675883397, "entropy": 0.971700991398443, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 292005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0164278260220296, "cur_kl_coeff": 1.7333369499485127e-34, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.34566409250415825, "policy_loss": -0.0048876934004799715, "vf_loss": 0.3505517856602276, "vf_explained_var": 0.11369782657850357, "kl": 0.0023771567902625772, "entropy": 0.028762611022918785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 292005.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 296.5, "episode_reward_mean": 370.902, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 118.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 26.0}, "policy_reward_mean": {"prey_policy": 181.226, "predator_policy": 4.225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [376.4, 381.5, 359.6, 391.0, 399.1, 395.5, 380.9, 390.2, 363.2, 370.5, 343.3, 378.1, 388.3, 364.8, 390.3, 378.0, 372.0, 383.0, 385.5, 400.0, 342.5, 368.6, 362.5, 394.6, 393.7, 399.1, 384.2, 366.0, 392.0, 359.2, 378.2, 386.5, 374.8, 364.0, 362.6, 355.70000000000005, 363.0, 386.0, 371.0, 368.1, 359.8, 369.0, 320.0, 382.9, 369.6, 389.2, 296.5, 387.4, 369.4, 370.6, 382.0, 370.1, 371.2, 369.9, 358.2, 366.0, 377.0, 390.2, 362.0, 325.90000000000003, 386.1, 373.1, 352.4, 366.70000000000005, 357.70000000000005, 336.3, 371.9, 370.1, 370.1, 364.0, 386.5, 366.3, 383.3, 358.0, 341.0, 381.7, 365.6, 371.8, 360.4, 394.4, 370.7, 394.6, 367.1, 384.2, 381.6, 393.7, 391.9, 343.9, 379.7, 386.5, 361.0, 369.20000000000005, 362.20000000000005, 394.6, 348.0, 373.0, 319.0, 360.7, 346.5, 354.3], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [168.2, 198.2, 196.4, 178.1, 194.6, 146.0, 197.3, 193.7, 200.0, 199.1, 199.1, 196.4, 182.9, 197.0, 190.1, 196.1, 176.3, 173.9, 186.5, 176.0, 183.79999999999998, 159.5, 182.0, 190.1, 188.3, 200.0, 150.8, 200.0, 182.3, 200.0, 194.0, 178.0, 184.0, 182.0, 179.0, 197.0, 181.4, 199.1, 200.0, 200.0, 200.0, 120.5, 200.0, 155.6, 191.0, 168.5, 199.1, 195.5, 193.7, 200.0, 200.0, 199.1, 200.0, 168.2, 173.0, 176.0, 200.0, 188.0, 141.2, 197.0, 177.2, 200.0, 186.5, 200.0, 200.0, 165.8, 175.7, 188.3, 188.3, 161.3, 166.7, 176.0, 173.0, 185.0, 197.0, 189.0, 185.0, 186.0, 167.0, 190.1, 172.1, 175.7, 131.0, 200.0, 154.7, 152.3, 193.7, 189.2, 200.0, 161.6, 191.0, 198.2, 151.4, 145.1, 191.9, 195.5, 133.4, 200.0, 187.4, 171.2, 200.0, 173.0, 161.9, 198.2, 166.7, 195.5, 170.3, 185.6, 179.0, 159.20000000000002, 197.0, 154.0, 158.0, 200.0, 198.2, 188.0, 179.0, 173.0, 179.0, 131.89999999999998, 192.2, 191.9, 200.0, 160.1, 170.0, 172.4, 166.7, 200.0, 192.8, 164.9, 190.1, 120.2, 176.0, 185.9, 165.5, 194.6, 179.0, 178.1, 134.0, 200.0, 186.5, 200.0, 163.4, 191.9, 188.0, 191.3, 167.0, 173.0, 148.0, 185.0, 175.7, 200.0, 163.7, 191.9, 181.1, 184.7, 181.1, 179.3, 200.0, 193.4, 187.4, 176.3, 194.6, 200.0, 187.1, 170.0, 187.4, 192.8, 185.6, 194.0, 194.6, 199.1, 191.9, 200.0, 180.2, 148.7, 190.7, 182.0, 200.0, 186.5, 138.8, 189.2, 199.1, 169.1, 167.6, 194.6, 194.6, 200.0, 132.0, 192.0, 186.0, 180.0, 190.0, 118.0, 174.2, 174.5, 137.0, 186.5, 188.0, 161.3], "policy_predator_policy_reward": [0.0, 10.0, 6.0, 1.0, 11.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 3.0, 1.0, 7.0, 6.0, 0.0, 8.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 14.0, 0.0, 5.0, 3.0, 2.0, 4.0, 6.0, 0.0, 7.0, 0.0, 5.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 13.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 9.0, 8.0, 0.0, 4.0, 18.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 8.0, 5.0, 8.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 12.0, 22.0, 16.0, 0.0, 13.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 18.0, 6.0, 6.0, 9.0, 0.0, 0.0, 10.0, 0.0, 9.0, 7.0, 7.0, 10.0, 10.0, 7.0, 8.0, 7.0, 12.0, 0.0, 4.0, 4.0, 6.0, 8.0, 7.0, 2.0, 0.0, 0.0, 13.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 0.0, 10.0, 10.0, 0.0, 13.0, 0.0, 21.0, 9.0, 0.0, 0.0, 11.0, 0.0, 4.0, 0.0, 18.0, 0.0, 0.0, 8.0, 6.0, 0.0, 0.0, 10.0, 0.0, 6.0, 0.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 0.0, 10.0, 0.0, 3.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 3.0, 0.0, 7.0, 0.0, 0.0, 16.0, 17.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 13.0, 11.0, 7.0, 0.0, 11.0, 0.0, 12.0, 0.0, 17.0, 6.0, 4.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.458526321347, "mean_inference_ms": 14.150085767479787, "mean_action_processing_ms": 4.013452759303843, "mean_env_wait_ms": 0.442957747531265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013723134994506836, "StateBufferConnector_ms": 0.004369258880615234, "ViewRequirementAgentConnector_ms": 0.12573063373565674}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 296.5, "episode_return_mean": 370.902, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.8579078382235, "num_env_steps_trained_throughput_per_sec": 302.8579078382235, "timesteps_total": 620000, "num_env_steps_sampled_lifetime": 620000, "num_agent_steps_sampled_lifetime": 2480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2480000, "timers": {"training_iteration_time_ms": 13182.255, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13182.204, "sample_time_ms": 1631.775, "learn_time_ms": 11529.901, "learn_throughput": 346.924, "synch_weights_time_ms": 17.022}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "done": false, "training_iteration": 155, "trial_id": "e4caa_00000", "date": "2024-08-13_23-13-27", "timestamp": 1723605207, "time_this_iter_s": 13.250172853469849, "time_total_s": 12534.955482244492, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b29ac9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12534.955482244492, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 50.94736842105263, "ram_util_percent": 83.74736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7167584941264182, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4284974920113753, "policy_loss": -0.008534928465202924, "vf_loss": 0.43682551336765446, "vf_explained_var": 0.455349523617477, "kl": 0.014713203708783035, "entropy": 0.9542686704920713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 293895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0904326913060334, "cur_kl_coeff": 8.666684749742564e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.33771640389526963, "policy_loss": -0.0021095738492452752, "vf_loss": 0.3398259784058032, "vf_explained_var": 0.04984652160336732, "kl": 0.003311668610551078, "entropy": 0.03607469949712386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 293895.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 296.5, "episode_reward_mean": 369.846, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 118.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 26.0}, "policy_reward_mean": {"prey_policy": 180.60299999999998, "predator_policy": 4.32}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.5, 394.6, 393.7, 399.1, 384.2, 366.0, 392.0, 359.2, 378.2, 386.5, 374.8, 364.0, 362.6, 355.70000000000005, 363.0, 386.0, 371.0, 368.1, 359.8, 369.0, 320.0, 382.9, 369.6, 389.2, 296.5, 387.4, 369.4, 370.6, 382.0, 370.1, 371.2, 369.9, 358.2, 366.0, 377.0, 390.2, 362.0, 325.90000000000003, 386.1, 373.1, 352.4, 366.70000000000005, 357.70000000000005, 336.3, 371.9, 370.1, 370.1, 364.0, 386.5, 366.3, 383.3, 358.0, 341.0, 381.7, 365.6, 371.8, 360.4, 394.4, 370.7, 394.6, 367.1, 384.2, 381.6, 393.7, 391.9, 343.9, 379.7, 386.5, 361.0, 369.20000000000005, 362.20000000000005, 394.6, 348.0, 373.0, 319.0, 360.7, 346.5, 354.3, 382.0, 380.6, 350.70000000000005, 350.8, 400.0, 363.6, 376.2, 399.1, 393.7, 341.1, 328.6, 380.2, 371.9, 391.3, 376.9, 389.2, 356.3, 372.1, 400.0, 352.0, 359.5, 380.9], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [191.0, 168.5, 199.1, 195.5, 193.7, 200.0, 200.0, 199.1, 200.0, 168.2, 173.0, 176.0, 200.0, 188.0, 141.2, 197.0, 177.2, 200.0, 186.5, 200.0, 200.0, 165.8, 175.7, 188.3, 188.3, 161.3, 166.7, 176.0, 173.0, 185.0, 197.0, 189.0, 185.0, 186.0, 167.0, 190.1, 172.1, 175.7, 131.0, 200.0, 154.7, 152.3, 193.7, 189.2, 200.0, 161.6, 191.0, 198.2, 151.4, 145.1, 191.9, 195.5, 133.4, 200.0, 187.4, 171.2, 200.0, 173.0, 161.9, 198.2, 166.7, 195.5, 170.3, 185.6, 179.0, 159.20000000000002, 197.0, 154.0, 158.0, 200.0, 198.2, 188.0, 179.0, 173.0, 179.0, 131.89999999999998, 192.2, 191.9, 200.0, 160.1, 170.0, 172.4, 166.7, 200.0, 192.8, 164.9, 190.1, 120.2, 176.0, 185.9, 165.5, 194.6, 179.0, 178.1, 134.0, 200.0, 186.5, 200.0, 163.4, 191.9, 188.0, 191.3, 167.0, 173.0, 148.0, 185.0, 175.7, 200.0, 163.7, 191.9, 181.1, 184.7, 181.1, 179.3, 200.0, 193.4, 187.4, 176.3, 194.6, 200.0, 187.1, 170.0, 187.4, 192.8, 185.6, 194.0, 194.6, 199.1, 191.9, 200.0, 180.2, 148.7, 190.7, 182.0, 200.0, 186.5, 138.8, 189.2, 199.1, 169.1, 167.6, 194.6, 194.6, 200.0, 132.0, 192.0, 186.0, 180.0, 190.0, 118.0, 174.2, 174.5, 137.0, 186.5, 188.0, 161.3, 200.0, 182.0, 179.0, 194.6, 200.0, 142.7, 182.0, 156.8, 200.0, 200.0, 194.6, 134.0, 197.0, 177.2, 199.1, 200.0, 194.6, 199.1, 173.9, 147.2, 119.9, 184.7, 191.0, 189.2, 177.5, 187.4, 191.0, 197.3, 180.2, 193.7, 194.6, 194.6, 177.5, 168.8, 200.0, 172.1, 200.0, 200.0, 149.0, 185.0, 141.5, 200.0, 184.7, 195.2], "policy_predator_policy_reward": [3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 6.0, 9.0, 8.0, 0.0, 4.0, 18.0, 3.0, 0.0, 1.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 8.0, 5.0, 8.0, 5.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 12.0, 22.0, 16.0, 0.0, 13.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 18.0, 6.0, 6.0, 9.0, 0.0, 0.0, 10.0, 0.0, 9.0, 7.0, 7.0, 10.0, 10.0, 7.0, 8.0, 7.0, 12.0, 0.0, 4.0, 4.0, 6.0, 8.0, 7.0, 2.0, 0.0, 0.0, 13.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 0.0, 10.0, 10.0, 0.0, 13.0, 0.0, 21.0, 9.0, 0.0, 0.0, 11.0, 0.0, 4.0, 0.0, 18.0, 0.0, 0.0, 8.0, 6.0, 0.0, 0.0, 10.0, 0.0, 6.0, 0.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 0.0, 10.0, 0.0, 3.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 3.0, 0.0, 7.0, 0.0, 0.0, 16.0, 17.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 13.0, 11.0, 7.0, 0.0, 11.0, 0.0, 12.0, 0.0, 17.0, 6.0, 4.0, 1.0, 0.0, 0.0, 0.0, 7.0, 0.0, 8.0, 12.0, 0.0, 0.0, 0.0, 17.0, 18.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 9.0, 24.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 2.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 13.0, 7.0, 11.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4609655159538937, "mean_inference_ms": 13.912041507425936, "mean_action_processing_ms": 4.134847066430537, "mean_env_wait_ms": 0.4417212902360968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013710379600524902, "StateBufferConnector_ms": 0.004038095474243164, "ViewRequirementAgentConnector_ms": 0.12767136096954346}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 296.5, "episode_return_mean": 369.846, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.5485189606756, "num_env_steps_trained_throughput_per_sec": 312.5485189606756, "timesteps_total": 624000, "num_env_steps_sampled_lifetime": 624000, "num_agent_steps_sampled_lifetime": 2496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2496000, "timers": {"training_iteration_time_ms": 13158.659, "restore_workers_time_ms": 0.016, "training_step_time_ms": 13158.607, "sample_time_ms": 1628.129, "learn_time_ms": 11510.106, "learn_throughput": 347.521, "synch_weights_time_ms": 16.717}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 2496000, "num_agent_steps_trained": 2496000}, "done": false, "training_iteration": 156, "trial_id": "e4caa_00000", "date": "2024-08-13_23-13-40", "timestamp": 1723605220, "time_this_iter_s": 12.839327096939087, "time_total_s": 12547.79480934143, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bb85e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12547.79480934143, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 49.15, "ram_util_percent": 83.64444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6205604614561828, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4979763692397644, "policy_loss": -0.007345507604134067, "vf_loss": 0.5052210130826718, "vf_explained_var": 0.48519205025264195, "kl": 0.0071725165884638275, "entropy": 0.9403676376771675, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4691610783575073, "cur_kl_coeff": 4.333342374871282e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4086943586509694, "policy_loss": -0.0006028695744043463, "vf_loss": 0.40929722902217197, "vf_explained_var": 0.05010166398431889, "kl": 0.001051905327500971, "entropy": 0.018481302055131113, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 296.5, "episode_reward_mean": 368.01399999999995, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 100.4, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 26.0}, "policy_reward_mean": {"prey_policy": 179.357, "predator_policy": 4.65}, "custom_metrics": {}, "hist_stats": {"episode_reward": [359.8, 369.0, 320.0, 382.9, 369.6, 389.2, 296.5, 387.4, 369.4, 370.6, 382.0, 370.1, 371.2, 369.9, 358.2, 366.0, 377.0, 390.2, 362.0, 325.90000000000003, 386.1, 373.1, 352.4, 366.70000000000005, 357.70000000000005, 336.3, 371.9, 370.1, 370.1, 364.0, 386.5, 366.3, 383.3, 358.0, 341.0, 381.7, 365.6, 371.8, 360.4, 394.4, 370.7, 394.6, 367.1, 384.2, 381.6, 393.7, 391.9, 343.9, 379.7, 386.5, 361.0, 369.20000000000005, 362.20000000000005, 394.6, 348.0, 373.0, 319.0, 360.7, 346.5, 354.3, 382.0, 380.6, 350.70000000000005, 350.8, 400.0, 363.6, 376.2, 399.1, 393.7, 341.1, 328.6, 380.2, 371.9, 391.3, 376.9, 389.2, 356.3, 372.1, 400.0, 352.0, 359.5, 380.9, 360.8, 369.1, 369.6, 370.1, 366.8, 382.7, 297.5, 387.4, 349.0, 377.1, 360.8, 345.70000000000005, 391.0, 361.9, 377.0, 384.0, 343.5, 384.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [172.1, 175.7, 131.0, 200.0, 154.7, 152.3, 193.7, 189.2, 200.0, 161.6, 191.0, 198.2, 151.4, 145.1, 191.9, 195.5, 133.4, 200.0, 187.4, 171.2, 200.0, 173.0, 161.9, 198.2, 166.7, 195.5, 170.3, 185.6, 179.0, 159.20000000000002, 197.0, 154.0, 158.0, 200.0, 198.2, 188.0, 179.0, 173.0, 179.0, 131.89999999999998, 192.2, 191.9, 200.0, 160.1, 170.0, 172.4, 166.7, 200.0, 192.8, 164.9, 190.1, 120.2, 176.0, 185.9, 165.5, 194.6, 179.0, 178.1, 134.0, 200.0, 186.5, 200.0, 163.4, 191.9, 188.0, 191.3, 167.0, 173.0, 148.0, 185.0, 175.7, 200.0, 163.7, 191.9, 181.1, 184.7, 181.1, 179.3, 200.0, 193.4, 187.4, 176.3, 194.6, 200.0, 187.1, 170.0, 187.4, 192.8, 185.6, 194.0, 194.6, 199.1, 191.9, 200.0, 180.2, 148.7, 190.7, 182.0, 200.0, 186.5, 138.8, 189.2, 199.1, 169.1, 167.6, 194.6, 194.6, 200.0, 132.0, 192.0, 186.0, 180.0, 190.0, 118.0, 174.2, 174.5, 137.0, 186.5, 188.0, 161.3, 200.0, 182.0, 179.0, 194.6, 200.0, 142.7, 182.0, 156.8, 200.0, 200.0, 194.6, 134.0, 197.0, 177.2, 199.1, 200.0, 194.6, 199.1, 173.9, 147.2, 119.9, 184.7, 191.0, 189.2, 177.5, 187.4, 191.0, 197.3, 180.2, 193.7, 194.6, 194.6, 177.5, 168.8, 200.0, 172.1, 200.0, 200.0, 149.0, 185.0, 141.5, 200.0, 184.7, 195.2, 178.1, 175.7, 194.6, 150.5, 175.1, 186.5, 161.0, 190.1, 174.8, 188.0, 192.8, 188.9, 100.4, 172.1, 193.7, 193.7, 161.0, 167.0, 187.4, 187.7, 157.4, 184.4, 182.0, 157.7, 196.4, 194.6, 173.9, 182.0, 188.0, 188.0, 192.0, 190.0, 200.0, 117.5, 188.0, 188.0], "policy_predator_policy_reward": [0.0, 12.0, 22.0, 16.0, 0.0, 13.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 18.0, 6.0, 6.0, 9.0, 0.0, 0.0, 10.0, 0.0, 9.0, 7.0, 7.0, 10.0, 10.0, 7.0, 8.0, 7.0, 12.0, 0.0, 4.0, 4.0, 6.0, 8.0, 7.0, 2.0, 0.0, 0.0, 13.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 0.0, 10.0, 10.0, 0.0, 13.0, 0.0, 21.0, 9.0, 0.0, 0.0, 11.0, 0.0, 4.0, 0.0, 18.0, 0.0, 0.0, 8.0, 6.0, 0.0, 0.0, 10.0, 0.0, 6.0, 0.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 0.0, 10.0, 0.0, 3.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 3.0, 0.0, 7.0, 0.0, 0.0, 16.0, 17.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 13.0, 11.0, 7.0, 0.0, 11.0, 0.0, 12.0, 0.0, 17.0, 6.0, 4.0, 1.0, 0.0, 0.0, 0.0, 7.0, 0.0, 8.0, 12.0, 0.0, 0.0, 0.0, 17.0, 18.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 9.0, 24.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 2.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 13.0, 7.0, 11.0, 0.0, 1.0, 7.0, 0.0, 14.0, 10.0, 0.0, 8.0, 6.0, 13.0, 0.0, 4.0, 1.0, 0.0, 23.0, 2.0, 0.0, 0.0, 9.0, 12.0, 2.0, 0.0, 13.0, 6.0, 0.0, 6.0, 0.0, 0.0, 6.0, 0.0, 1.0, 0.0, 0.0, 2.0, 11.0, 15.0, 0.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.448583222001342, "mean_inference_ms": 13.996037401574728, "mean_action_processing_ms": 3.9656900937897124, "mean_env_wait_ms": 0.44027307080026334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013616323471069336, "StateBufferConnector_ms": 0.00345003604888916, "ViewRequirementAgentConnector_ms": 0.12008559703826904}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 296.5, "episode_return_mean": 368.01399999999995, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.9810491161197, "num_env_steps_trained_throughput_per_sec": 305.9810491161197, "timesteps_total": 628000, "num_env_steps_sampled_lifetime": 628000, "num_agent_steps_sampled_lifetime": 2512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2512000, "timers": {"training_iteration_time_ms": 13134.286, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13134.236, "sample_time_ms": 1611.681, "learn_time_ms": 11503.271, "learn_throughput": 347.727, "synch_weights_time_ms": 16.042}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 2512000, "num_agent_steps_trained": 2512000}, "done": false, "training_iteration": 157, "trial_id": "e4caa_00000", "date": "2024-08-13_23-13-53", "timestamp": 1723605233, "time_this_iter_s": 13.106380701065063, "time_total_s": 12560.901190042496, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2985430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12560.901190042496, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 50.82631578947369, "ram_util_percent": 83.67894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5547794293080057, "cur_kl_coeff": 0.014062500000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5473776266979122, "policy_loss": -0.007858996185173512, "vf_loss": 0.5551856690790767, "vf_explained_var": 0.5372254922907188, "kl": 0.0036234215628872324, "entropy": 0.9438997103423669, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 297675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.079803571905251, "cur_kl_coeff": 2.166671187435641e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4096894547343254, "policy_loss": -0.0002753753890160215, "vf_loss": 0.4099648298121614, "vf_explained_var": 0.055277600364079554, "kl": 0.0010535635432486132, "entropy": 0.022494573875517638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 297675.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 281.29999999999984, "episode_reward_mean": 367.411, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 77.29999999999998, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 26.0}, "policy_reward_mean": {"prey_policy": 179.26550000000003, "predator_policy": 4.44}, "custom_metrics": {}, "hist_stats": {"episode_reward": [362.0, 325.90000000000003, 386.1, 373.1, 352.4, 366.70000000000005, 357.70000000000005, 336.3, 371.9, 370.1, 370.1, 364.0, 386.5, 366.3, 383.3, 358.0, 341.0, 381.7, 365.6, 371.8, 360.4, 394.4, 370.7, 394.6, 367.1, 384.2, 381.6, 393.7, 391.9, 343.9, 379.7, 386.5, 361.0, 369.20000000000005, 362.20000000000005, 394.6, 348.0, 373.0, 319.0, 360.7, 346.5, 354.3, 382.0, 380.6, 350.70000000000005, 350.8, 400.0, 363.6, 376.2, 399.1, 393.7, 341.1, 328.6, 380.2, 371.9, 391.3, 376.9, 389.2, 356.3, 372.1, 400.0, 352.0, 359.5, 380.9, 360.8, 369.1, 369.6, 370.1, 366.8, 382.7, 297.5, 387.4, 349.0, 377.1, 360.8, 345.70000000000005, 391.0, 361.9, 377.0, 384.0, 343.5, 384.0, 355.90000000000003, 400.0, 343.5, 372.5, 375.1, 362.2, 362.1, 381.0, 393.7, 358.3, 322.8, 394.0, 400.0, 390.1, 369.0, 341.0, 336.2, 281.29999999999984], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [179.0, 173.0, 179.0, 131.89999999999998, 192.2, 191.9, 200.0, 160.1, 170.0, 172.4, 166.7, 200.0, 192.8, 164.9, 190.1, 120.2, 176.0, 185.9, 165.5, 194.6, 179.0, 178.1, 134.0, 200.0, 186.5, 200.0, 163.4, 191.9, 188.0, 191.3, 167.0, 173.0, 148.0, 185.0, 175.7, 200.0, 163.7, 191.9, 181.1, 184.7, 181.1, 179.3, 200.0, 193.4, 187.4, 176.3, 194.6, 200.0, 187.1, 170.0, 187.4, 192.8, 185.6, 194.0, 194.6, 199.1, 191.9, 200.0, 180.2, 148.7, 190.7, 182.0, 200.0, 186.5, 138.8, 189.2, 199.1, 169.1, 167.6, 194.6, 194.6, 200.0, 132.0, 192.0, 186.0, 180.0, 190.0, 118.0, 174.2, 174.5, 137.0, 186.5, 188.0, 161.3, 200.0, 182.0, 179.0, 194.6, 200.0, 142.7, 182.0, 156.8, 200.0, 200.0, 194.6, 134.0, 197.0, 177.2, 199.1, 200.0, 194.6, 199.1, 173.9, 147.2, 119.9, 184.7, 191.0, 189.2, 177.5, 187.4, 191.0, 197.3, 180.2, 193.7, 194.6, 194.6, 177.5, 168.8, 200.0, 172.1, 200.0, 200.0, 149.0, 185.0, 141.5, 200.0, 184.7, 195.2, 178.1, 175.7, 194.6, 150.5, 175.1, 186.5, 161.0, 190.1, 174.8, 188.0, 192.8, 188.9, 100.4, 172.1, 193.7, 193.7, 161.0, 167.0, 187.4, 187.7, 157.4, 184.4, 182.0, 157.7, 196.4, 194.6, 173.9, 182.0, 188.0, 188.0, 192.0, 190.0, 200.0, 117.5, 188.0, 188.0, 191.9, 164.0, 200.0, 200.0, 132.2, 179.3, 179.0, 186.5, 170.0, 190.1, 178.4, 183.8, 163.1, 185.0, 176.0, 200.0, 199.1, 194.6, 143.3, 200.0, 127.7, 178.1, 191.0, 200.0, 200.0, 200.0, 197.3, 192.8, 168.0, 191.0, 126.0, 200.0, 172.1, 133.1, 191.0, 77.29999999999998], "policy_predator_policy_reward": [4.0, 6.0, 8.0, 7.0, 2.0, 0.0, 0.0, 13.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 26.0, 0.0, 10.0, 10.0, 0.0, 13.0, 0.0, 21.0, 9.0, 0.0, 0.0, 11.0, 0.0, 4.0, 0.0, 18.0, 0.0, 0.0, 8.0, 6.0, 0.0, 0.0, 10.0, 0.0, 6.0, 0.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 0.0, 10.0, 0.0, 3.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 3.0, 0.0, 7.0, 0.0, 0.0, 16.0, 17.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 13.0, 11.0, 7.0, 0.0, 11.0, 0.0, 12.0, 0.0, 17.0, 6.0, 4.0, 1.0, 0.0, 0.0, 0.0, 7.0, 0.0, 8.0, 12.0, 0.0, 0.0, 0.0, 17.0, 18.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 9.0, 24.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 2.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 13.0, 7.0, 11.0, 0.0, 1.0, 7.0, 0.0, 14.0, 10.0, 0.0, 8.0, 6.0, 13.0, 0.0, 4.0, 1.0, 0.0, 23.0, 2.0, 0.0, 0.0, 9.0, 12.0, 2.0, 0.0, 13.0, 6.0, 0.0, 6.0, 0.0, 0.0, 6.0, 0.0, 1.0, 0.0, 0.0, 2.0, 11.0, 15.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 16.0, 16.0, 7.0, 0.0, 8.0, 7.0, 0.0, 0.0, 14.0, 0.0, 0.0, 5.0, 0.0, 0.0, 15.0, 0.0, 4.0, 13.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 15.0, 23.0, 8.0, 3.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4440458503603317, "mean_inference_ms": 13.926549445109526, "mean_action_processing_ms": 3.9441577477220005, "mean_env_wait_ms": 0.4389788210769305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013760566711425781, "StateBufferConnector_ms": 0.0035053491592407227, "ViewRequirementAgentConnector_ms": 0.1177682876586914}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 281.29999999999984, "episode_return_mean": 367.411, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.34910113649215, "num_env_steps_trained_throughput_per_sec": 311.34910113649215, "timesteps_total": 632000, "num_env_steps_sampled_lifetime": 632000, "num_agent_steps_sampled_lifetime": 2528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2528000, "timers": {"training_iteration_time_ms": 13088.382, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13088.333, "sample_time_ms": 1597.483, "learn_time_ms": 11470.64, "learn_throughput": 348.716, "synch_weights_time_ms": 17.176}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 2528000, "num_agent_steps_trained": 2528000}, "done": false, "training_iteration": 158, "trial_id": "e4caa_00000", "date": "2024-08-13_23-14-06", "timestamp": 1723605246, "time_this_iter_s": 12.902184009552002, "time_total_s": 12573.803374052048, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2987ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12573.803374052048, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 50.578947368421055, "ram_util_percent": 83.7578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4714016182003198, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.38005357054263145, "policy_loss": -0.009113338666785726, "vf_loss": 0.38911684124303053, "vf_explained_var": 0.3986981158534055, "kl": 0.007120883199184541, "entropy": 0.9541008644003086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 299565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0717249915319145, "cur_kl_coeff": 1.0833355937178205e-35, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.27029544941726186, "policy_loss": -0.000689435970018465, "vf_loss": 0.2709848853315981, "vf_explained_var": 0.16060435885474794, "kl": 0.001434611589040165, "entropy": 0.026659243444483432, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 299565.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 281.29999999999984, "episode_reward_mean": 368.52899999999994, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 77.29999999999998, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 24.0}, "policy_reward_mean": {"prey_policy": 180.05450000000002, "predator_policy": 4.21}, "custom_metrics": {}, "hist_stats": {"episode_reward": [365.6, 371.8, 360.4, 394.4, 370.7, 394.6, 367.1, 384.2, 381.6, 393.7, 391.9, 343.9, 379.7, 386.5, 361.0, 369.20000000000005, 362.20000000000005, 394.6, 348.0, 373.0, 319.0, 360.7, 346.5, 354.3, 382.0, 380.6, 350.70000000000005, 350.8, 400.0, 363.6, 376.2, 399.1, 393.7, 341.1, 328.6, 380.2, 371.9, 391.3, 376.9, 389.2, 356.3, 372.1, 400.0, 352.0, 359.5, 380.9, 360.8, 369.1, 369.6, 370.1, 366.8, 382.7, 297.5, 387.4, 349.0, 377.1, 360.8, 345.70000000000005, 391.0, 361.9, 377.0, 384.0, 343.5, 384.0, 355.90000000000003, 400.0, 343.5, 372.5, 375.1, 362.2, 362.1, 381.0, 393.7, 358.3, 322.8, 394.0, 400.0, 390.1, 369.0, 341.0, 336.2, 281.29999999999984, 390.1, 371.7, 302.29999999999995, 338.6, 366.9, 384.0, 368.5, 370.0, 367.3, 400.0, 380.1, 360.6, 361.4, 389.9, 358.0, 399.0, 391.9, 364.6], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [163.7, 191.9, 181.1, 184.7, 181.1, 179.3, 200.0, 193.4, 187.4, 176.3, 194.6, 200.0, 187.1, 170.0, 187.4, 192.8, 185.6, 194.0, 194.6, 199.1, 191.9, 200.0, 180.2, 148.7, 190.7, 182.0, 200.0, 186.5, 138.8, 189.2, 199.1, 169.1, 167.6, 194.6, 194.6, 200.0, 132.0, 192.0, 186.0, 180.0, 190.0, 118.0, 174.2, 174.5, 137.0, 186.5, 188.0, 161.3, 200.0, 182.0, 179.0, 194.6, 200.0, 142.7, 182.0, 156.8, 200.0, 200.0, 194.6, 134.0, 197.0, 177.2, 199.1, 200.0, 194.6, 199.1, 173.9, 147.2, 119.9, 184.7, 191.0, 189.2, 177.5, 187.4, 191.0, 197.3, 180.2, 193.7, 194.6, 194.6, 177.5, 168.8, 200.0, 172.1, 200.0, 200.0, 149.0, 185.0, 141.5, 200.0, 184.7, 195.2, 178.1, 175.7, 194.6, 150.5, 175.1, 186.5, 161.0, 190.1, 174.8, 188.0, 192.8, 188.9, 100.4, 172.1, 193.7, 193.7, 161.0, 167.0, 187.4, 187.7, 157.4, 184.4, 182.0, 157.7, 196.4, 194.6, 173.9, 182.0, 188.0, 188.0, 192.0, 190.0, 200.0, 117.5, 188.0, 188.0, 191.9, 164.0, 200.0, 200.0, 132.2, 179.3, 179.0, 186.5, 170.0, 190.1, 178.4, 183.8, 163.1, 185.0, 176.0, 200.0, 199.1, 194.6, 143.3, 200.0, 127.7, 178.1, 191.0, 200.0, 200.0, 200.0, 197.3, 192.8, 168.0, 191.0, 126.0, 200.0, 172.1, 133.1, 191.0, 77.29999999999998, 197.3, 192.8, 184.7, 185.0, 142.7, 146.6, 137.6, 176.0, 176.0, 182.9, 200.0, 176.0, 171.2, 188.3, 182.0, 182.0, 197.3, 155.0, 200.0, 200.0, 190.1, 185.0, 200.0, 131.6, 155.6, 192.8, 200.0, 188.9, 168.0, 190.0, 200.0, 199.0, 200.0, 191.9, 176.6, 182.0], "policy_predator_policy_reward": [0.0, 10.0, 0.0, 6.0, 0.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 0.0, 10.0, 0.0, 3.0, 1.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 3.0, 0.0, 7.0, 0.0, 0.0, 16.0, 17.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 13.0, 11.0, 7.0, 0.0, 11.0, 0.0, 12.0, 0.0, 17.0, 6.0, 4.0, 1.0, 0.0, 0.0, 0.0, 7.0, 0.0, 8.0, 12.0, 0.0, 0.0, 0.0, 17.0, 18.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 9.0, 24.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 2.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 13.0, 7.0, 11.0, 0.0, 1.0, 7.0, 0.0, 14.0, 10.0, 0.0, 8.0, 6.0, 13.0, 0.0, 4.0, 1.0, 0.0, 23.0, 2.0, 0.0, 0.0, 9.0, 12.0, 2.0, 0.0, 13.0, 6.0, 0.0, 6.0, 0.0, 0.0, 6.0, 0.0, 1.0, 0.0, 0.0, 2.0, 11.0, 15.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 16.0, 16.0, 7.0, 0.0, 8.0, 7.0, 0.0, 0.0, 14.0, 0.0, 0.0, 5.0, 0.0, 0.0, 15.0, 0.0, 4.0, 13.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 15.0, 23.0, 8.0, 3.0, 10.0, 0.0, 0.0, 2.0, 0.0, 1.0, 12.0, 8.0, 17.0, 0.0, 8.0, 0.0, 8.0, 0.0, 9.0, 6.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 5.0, 8.0, 21.0, 6.0, 7.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4395287867453674, "mean_inference_ms": 13.857895355831989, "mean_action_processing_ms": 3.922897619062087, "mean_env_wait_ms": 0.4377135459134034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014640212059020996, "StateBufferConnector_ms": 0.005346536636352539, "ViewRequirementAgentConnector_ms": 0.11100530624389648}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 281.29999999999984, "episode_return_mean": 368.52899999999994, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.4252907641213, "num_env_steps_trained_throughput_per_sec": 311.4252907641213, "timesteps_total": 636000, "num_env_steps_sampled_lifetime": 636000, "num_agent_steps_sampled_lifetime": 2544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2544000, "timers": {"training_iteration_time_ms": 13069.541, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13069.493, "sample_time_ms": 1606.581, "learn_time_ms": 11442.728, "learn_throughput": 349.567, "synch_weights_time_ms": 17.195}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 2544000, "num_agent_steps_trained": 2544000}, "done": false, "training_iteration": 159, "trial_id": "e4caa_00000", "date": "2024-08-13_23-14-19", "timestamp": 1723605259, "time_this_iter_s": 12.88321828842163, "time_total_s": 12586.68659234047, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b21ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12586.68659234047, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 49.39444444444444, "ram_util_percent": 83.62777777777777}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6927227467456192, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.41269565486674387, "policy_loss": -0.009098747911463891, "vf_loss": 0.4216998452374899, "vf_explained_var": 0.5317966605305041, "kl": 0.013448040659868106, "entropy": 0.9452507005797492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 301455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1057259765330445, "cur_kl_coeff": 5.416677968589102e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.20804979985668545, "policy_loss": -0.0020840914674822696, "vf_loss": 0.21013389158982873, "vf_explained_var": 0.14911752913994764, "kl": 0.0016693352511030848, "entropy": 0.03272309870922337, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 301455.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 281.29999999999984, "episode_reward_mean": 368.76300000000003, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 77.29999999999998, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 24.0}, "policy_reward_mean": {"prey_policy": 180.0865, "predator_policy": 4.295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.8, 400.0, 363.6, 376.2, 399.1, 393.7, 341.1, 328.6, 380.2, 371.9, 391.3, 376.9, 389.2, 356.3, 372.1, 400.0, 352.0, 359.5, 380.9, 360.8, 369.1, 369.6, 370.1, 366.8, 382.7, 297.5, 387.4, 349.0, 377.1, 360.8, 345.70000000000005, 391.0, 361.9, 377.0, 384.0, 343.5, 384.0, 355.90000000000003, 400.0, 343.5, 372.5, 375.1, 362.2, 362.1, 381.0, 393.7, 358.3, 322.8, 394.0, 400.0, 390.1, 369.0, 341.0, 336.2, 281.29999999999984, 390.1, 371.7, 302.29999999999995, 338.6, 366.9, 384.0, 368.5, 370.0, 367.3, 400.0, 380.1, 360.6, 361.4, 389.9, 358.0, 399.0, 391.9, 364.6, 367.1, 378.4, 375.0, 363.0, 389.5, 396.4, 339.8, 348.2, 397.3, 361.5, 373.4, 332.9, 348.1, 365.4, 375.8, 393.7, 361.1, 377.7, 387.5, 319.80000000000007, 400.0, 344.0, 384.0, 381.0, 383.0, 374.0, 393.7], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [182.0, 156.8, 200.0, 200.0, 194.6, 134.0, 197.0, 177.2, 199.1, 200.0, 194.6, 199.1, 173.9, 147.2, 119.9, 184.7, 191.0, 189.2, 177.5, 187.4, 191.0, 197.3, 180.2, 193.7, 194.6, 194.6, 177.5, 168.8, 200.0, 172.1, 200.0, 200.0, 149.0, 185.0, 141.5, 200.0, 184.7, 195.2, 178.1, 175.7, 194.6, 150.5, 175.1, 186.5, 161.0, 190.1, 174.8, 188.0, 192.8, 188.9, 100.4, 172.1, 193.7, 193.7, 161.0, 167.0, 187.4, 187.7, 157.4, 184.4, 182.0, 157.7, 196.4, 194.6, 173.9, 182.0, 188.0, 188.0, 192.0, 190.0, 200.0, 117.5, 188.0, 188.0, 191.9, 164.0, 200.0, 200.0, 132.2, 179.3, 179.0, 186.5, 170.0, 190.1, 178.4, 183.8, 163.1, 185.0, 176.0, 200.0, 199.1, 194.6, 143.3, 200.0, 127.7, 178.1, 191.0, 200.0, 200.0, 200.0, 197.3, 192.8, 168.0, 191.0, 126.0, 200.0, 172.1, 133.1, 191.0, 77.29999999999998, 197.3, 192.8, 184.7, 185.0, 142.7, 146.6, 137.6, 176.0, 176.0, 182.9, 200.0, 176.0, 171.2, 188.3, 182.0, 182.0, 197.3, 155.0, 200.0, 200.0, 190.1, 185.0, 200.0, 131.6, 155.6, 192.8, 200.0, 188.9, 168.0, 190.0, 200.0, 199.0, 200.0, 191.9, 176.6, 182.0, 151.1, 200.0, 181.1, 197.3, 176.0, 188.0, 179.0, 173.0, 200.0, 186.5, 199.1, 197.3, 187.4, 139.4, 150.2, 182.0, 197.3, 200.0, 153.5, 200.0, 187.4, 179.0, 150.8, 166.1, 160.1, 176.0, 157.1, 188.3, 183.8, 188.0, 196.4, 197.3, 181.1, 167.0, 173.0, 193.7, 177.5, 200.0, 181.4, 133.39999999999998, 200.0, 200.0, 177.0, 164.0, 194.0, 188.0, 187.0, 194.0, 200.0, 164.0, 188.0, 176.0, 193.7, 200.0], "policy_predator_policy_reward": [12.0, 0.0, 0.0, 0.0, 17.0, 18.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 11.0, 9.0, 24.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 3.0, 0.0, 3.0, 0.0, 0.0, 2.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 13.0, 7.0, 11.0, 0.0, 1.0, 7.0, 0.0, 14.0, 10.0, 0.0, 8.0, 6.0, 13.0, 0.0, 4.0, 1.0, 0.0, 23.0, 2.0, 0.0, 0.0, 9.0, 12.0, 2.0, 0.0, 13.0, 6.0, 0.0, 6.0, 0.0, 0.0, 6.0, 0.0, 1.0, 0.0, 0.0, 2.0, 11.0, 15.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 16.0, 16.0, 7.0, 0.0, 8.0, 7.0, 0.0, 0.0, 14.0, 0.0, 0.0, 5.0, 0.0, 0.0, 15.0, 0.0, 4.0, 13.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 15.0, 23.0, 8.0, 3.0, 10.0, 0.0, 0.0, 2.0, 0.0, 1.0, 12.0, 8.0, 17.0, 0.0, 8.0, 0.0, 8.0, 0.0, 9.0, 6.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 5.0, 8.0, 21.0, 6.0, 7.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 16.0, 0.0, 0.0, 2.0, 9.0, 11.0, 0.0, 0.0, 3.0, 0.0, 0.0, 12.0, 1.0, 10.0, 6.0, 0.0, 0.0, 8.0, 0.0, 0.0, 7.0, 16.0, 0.0, 0.0, 12.0, 6.0, 14.0, 4.0, 0.0, 0.0, 0.0, 13.0, 0.0, 9.0, 2.0, 5.0, 5.0, 1.0, 4.0, 0.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 7.0, 12.0, 10.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4407715182371055, "mean_inference_ms": 13.610149088445713, "mean_action_processing_ms": 4.0360940776877445, "mean_env_wait_ms": 0.4361168241742447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012546539306640625, "StateBufferConnector_ms": 0.006265997886657715, "ViewRequirementAgentConnector_ms": 0.12040472030639648}, "num_episodes": 27, "episode_return_max": 400.0, "episode_return_min": 281.29999999999984, "episode_return_mean": 368.76300000000003, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.0585095618622, "num_env_steps_trained_throughput_per_sec": 311.0585095618622, "timesteps_total": 640000, "num_env_steps_sampled_lifetime": 640000, "num_agent_steps_sampled_lifetime": 2560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2560000, "timers": {"training_iteration_time_ms": 13056.242, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13056.189, "sample_time_ms": 1606.494, "learn_time_ms": 11428.711, "learn_throughput": 349.996, "synch_weights_time_ms": 17.379}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "done": false, "training_iteration": 160, "trial_id": "e4caa_00000", "date": "2024-08-13_23-14-32", "timestamp": 1723605272, "time_this_iter_s": 12.91207504272461, "time_total_s": 12599.598667383194, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d5a790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12599.598667383194, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 51.26111111111111, "ram_util_percent": 83.74444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7979825117127606, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5716836820799419, "policy_loss": -0.007591807614844391, "vf_loss": 0.5791880674364548, "vf_explained_var": 0.41342503939356123, "kl": 0.012433450702083721, "entropy": 0.9766438013031369, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 303345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.361911437120387, "cur_kl_coeff": 2.708338984294551e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.45615995246424246, "policy_loss": -0.002174059955265235, "vf_loss": 0.45833401028584275, "vf_explained_var": 0.09379896442726175, "kl": 0.0018819240975927031, "entropy": 0.0330712968902416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 303345.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 281.29999999999984, "episode_reward_mean": 367.56699999999995, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 77.29999999999998, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 23.0}, "policy_reward_mean": {"prey_policy": 179.3635, "predator_policy": 4.42}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.9, 360.8, 369.1, 369.6, 370.1, 366.8, 382.7, 297.5, 387.4, 349.0, 377.1, 360.8, 345.70000000000005, 391.0, 361.9, 377.0, 384.0, 343.5, 384.0, 355.90000000000003, 400.0, 343.5, 372.5, 375.1, 362.2, 362.1, 381.0, 393.7, 358.3, 322.8, 394.0, 400.0, 390.1, 369.0, 341.0, 336.2, 281.29999999999984, 390.1, 371.7, 302.29999999999995, 338.6, 366.9, 384.0, 368.5, 370.0, 367.3, 400.0, 380.1, 360.6, 361.4, 389.9, 358.0, 399.0, 391.9, 364.6, 367.1, 378.4, 375.0, 363.0, 389.5, 396.4, 339.8, 348.2, 397.3, 361.5, 373.4, 332.9, 348.1, 365.4, 375.8, 393.7, 361.1, 377.7, 387.5, 319.80000000000007, 400.0, 344.0, 384.0, 381.0, 383.0, 374.0, 393.7, 335.1, 377.5, 347.2, 392.0, 384.4, 346.7, 400.0, 329.3, 383.3, 345.5, 376.0, 393.7, 375.3, 370.29999999999995, 387.0, 322.0, 366.6, 351.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [184.7, 195.2, 178.1, 175.7, 194.6, 150.5, 175.1, 186.5, 161.0, 190.1, 174.8, 188.0, 192.8, 188.9, 100.4, 172.1, 193.7, 193.7, 161.0, 167.0, 187.4, 187.7, 157.4, 184.4, 182.0, 157.7, 196.4, 194.6, 173.9, 182.0, 188.0, 188.0, 192.0, 190.0, 200.0, 117.5, 188.0, 188.0, 191.9, 164.0, 200.0, 200.0, 132.2, 179.3, 179.0, 186.5, 170.0, 190.1, 178.4, 183.8, 163.1, 185.0, 176.0, 200.0, 199.1, 194.6, 143.3, 200.0, 127.7, 178.1, 191.0, 200.0, 200.0, 200.0, 197.3, 192.8, 168.0, 191.0, 126.0, 200.0, 172.1, 133.1, 191.0, 77.29999999999998, 197.3, 192.8, 184.7, 185.0, 142.7, 146.6, 137.6, 176.0, 176.0, 182.9, 200.0, 176.0, 171.2, 188.3, 182.0, 182.0, 197.3, 155.0, 200.0, 200.0, 190.1, 185.0, 200.0, 131.6, 155.6, 192.8, 200.0, 188.9, 168.0, 190.0, 200.0, 199.0, 200.0, 191.9, 176.6, 182.0, 151.1, 200.0, 181.1, 197.3, 176.0, 188.0, 179.0, 173.0, 200.0, 186.5, 199.1, 197.3, 187.4, 139.4, 150.2, 182.0, 197.3, 200.0, 153.5, 200.0, 187.4, 179.0, 150.8, 166.1, 160.1, 176.0, 157.1, 188.3, 183.8, 188.0, 196.4, 197.3, 181.1, 167.0, 173.0, 193.7, 177.5, 200.0, 181.4, 133.39999999999998, 200.0, 200.0, 177.0, 164.0, 194.0, 188.0, 187.0, 194.0, 200.0, 164.0, 188.0, 176.0, 193.7, 200.0, 181.1, 140.0, 183.8, 193.7, 187.4, 147.8, 200.0, 188.0, 184.4, 194.0, 138.5, 189.2, 200.0, 200.0, 145.7, 167.6, 176.3, 200.0, 182.9, 143.6, 191.9, 181.1, 193.7, 200.0, 188.6, 184.7, 181.1, 180.2, 191.0, 194.0, 172.0, 135.0, 143.0, 185.6, 144.5, 195.5], "policy_predator_policy_reward": [0.0, 1.0, 7.0, 0.0, 14.0, 10.0, 0.0, 8.0, 6.0, 13.0, 0.0, 4.0, 1.0, 0.0, 23.0, 2.0, 0.0, 0.0, 9.0, 12.0, 2.0, 0.0, 13.0, 6.0, 0.0, 6.0, 0.0, 0.0, 6.0, 0.0, 1.0, 0.0, 0.0, 2.0, 11.0, 15.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 16.0, 16.0, 7.0, 0.0, 8.0, 7.0, 0.0, 0.0, 14.0, 0.0, 0.0, 5.0, 0.0, 0.0, 15.0, 0.0, 4.0, 13.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 15.0, 23.0, 8.0, 3.0, 10.0, 0.0, 0.0, 2.0, 0.0, 1.0, 12.0, 8.0, 17.0, 0.0, 8.0, 0.0, 8.0, 0.0, 9.0, 6.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 5.0, 8.0, 21.0, 6.0, 7.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 16.0, 0.0, 0.0, 2.0, 9.0, 11.0, 0.0, 0.0, 3.0, 0.0, 0.0, 12.0, 1.0, 10.0, 6.0, 0.0, 0.0, 8.0, 0.0, 0.0, 7.0, 16.0, 0.0, 0.0, 12.0, 6.0, 14.0, 4.0, 0.0, 0.0, 0.0, 13.0, 0.0, 9.0, 2.0, 5.0, 5.0, 1.0, 4.0, 0.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 7.0, 12.0, 10.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 12.0, 0.0, 4.0, 0.0, 6.0, 6.0, 13.0, 0.0, 0.0, 16.0, 0.0, 7.0, 0.0, 12.0, 7.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 9.0, 2.0, 0.0, 2.0, 13.0, 19.0, 19.0, 11.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4287788324700137, "mean_inference_ms": 13.69272453054084, "mean_action_processing_ms": 3.871643627005241, "mean_env_wait_ms": 0.43466290550871295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013367414474487305, "StateBufferConnector_ms": 0.006204009056091309, "ViewRequirementAgentConnector_ms": 0.11827433109283447}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 281.29999999999984, "episode_return_mean": 367.56699999999995, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.62148802011995, "num_env_steps_trained_throughput_per_sec": 313.62148802011995, "timesteps_total": 644000, "num_env_steps_sampled_lifetime": 644000, "num_agent_steps_sampled_lifetime": 2576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2576000, "timers": {"training_iteration_time_ms": 13027.64, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13027.591, "sample_time_ms": 1598.197, "learn_time_ms": 11408.471, "learn_throughput": 350.617, "synch_weights_time_ms": 17.349}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 2576000, "num_agent_steps_trained": 2576000}, "done": false, "training_iteration": 161, "trial_id": "e4caa_00000", "date": "2024-08-13_23-14-45", "timestamp": 1723605285, "time_this_iter_s": 12.795532941818237, "time_total_s": 12612.394200325012, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b213a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12612.394200325012, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 49.05, "ram_util_percent": 83.72222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.512480204367133, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.48205089703542253, "policy_loss": -0.0085609568804059, "vf_loss": 0.49056808105694555, "vf_explained_var": 0.33764371764722956, "kl": 0.00622560777849324, "entropy": 0.952495278378643, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 305235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1569143102597939, "cur_kl_coeff": 1.3541694921472756e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.38356493830523164, "policy_loss": -0.00591026808692034, "vf_loss": 0.3894752067210099, "vf_explained_var": 0.10007189203191687, "kl": 0.19879670821704393, "entropy": 0.07226402753466375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 305235.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 281.29999999999984, "episode_reward_mean": 366.9550000000001, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 77.29999999999998, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 34.0}, "policy_reward_mean": {"prey_policy": 178.7275, "predator_policy": 4.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [384.0, 355.90000000000003, 400.0, 343.5, 372.5, 375.1, 362.2, 362.1, 381.0, 393.7, 358.3, 322.8, 394.0, 400.0, 390.1, 369.0, 341.0, 336.2, 281.29999999999984, 390.1, 371.7, 302.29999999999995, 338.6, 366.9, 384.0, 368.5, 370.0, 367.3, 400.0, 380.1, 360.6, 361.4, 389.9, 358.0, 399.0, 391.9, 364.6, 367.1, 378.4, 375.0, 363.0, 389.5, 396.4, 339.8, 348.2, 397.3, 361.5, 373.4, 332.9, 348.1, 365.4, 375.8, 393.7, 361.1, 377.7, 387.5, 319.80000000000007, 400.0, 344.0, 384.0, 381.0, 383.0, 374.0, 393.7, 335.1, 377.5, 347.2, 392.0, 384.4, 346.7, 400.0, 329.3, 383.3, 345.5, 376.0, 393.7, 375.3, 370.29999999999995, 387.0, 322.0, 366.6, 351.0, 347.2, 363.8, 313.1, 358.2, 389.2, 351.7, 365.4, 366.0, 386.5, 341.0, 376.6, 383.8, 369.8, 367.0, 379.0, 345.0, 391.5, 318.9000000000001], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [188.0, 188.0, 191.9, 164.0, 200.0, 200.0, 132.2, 179.3, 179.0, 186.5, 170.0, 190.1, 178.4, 183.8, 163.1, 185.0, 176.0, 200.0, 199.1, 194.6, 143.3, 200.0, 127.7, 178.1, 191.0, 200.0, 200.0, 200.0, 197.3, 192.8, 168.0, 191.0, 126.0, 200.0, 172.1, 133.1, 191.0, 77.29999999999998, 197.3, 192.8, 184.7, 185.0, 142.7, 146.6, 137.6, 176.0, 176.0, 182.9, 200.0, 176.0, 171.2, 188.3, 182.0, 182.0, 197.3, 155.0, 200.0, 200.0, 190.1, 185.0, 200.0, 131.6, 155.6, 192.8, 200.0, 188.9, 168.0, 190.0, 200.0, 199.0, 200.0, 191.9, 176.6, 182.0, 151.1, 200.0, 181.1, 197.3, 176.0, 188.0, 179.0, 173.0, 200.0, 186.5, 199.1, 197.3, 187.4, 139.4, 150.2, 182.0, 197.3, 200.0, 153.5, 200.0, 187.4, 179.0, 150.8, 166.1, 160.1, 176.0, 157.1, 188.3, 183.8, 188.0, 196.4, 197.3, 181.1, 167.0, 173.0, 193.7, 177.5, 200.0, 181.4, 133.39999999999998, 200.0, 200.0, 177.0, 164.0, 194.0, 188.0, 187.0, 194.0, 200.0, 164.0, 188.0, 176.0, 193.7, 200.0, 181.1, 140.0, 183.8, 193.7, 187.4, 147.8, 200.0, 188.0, 184.4, 194.0, 138.5, 189.2, 200.0, 200.0, 145.7, 167.6, 176.3, 200.0, 182.9, 143.6, 191.9, 181.1, 193.7, 200.0, 188.6, 184.7, 181.1, 180.2, 191.0, 194.0, 172.0, 135.0, 143.0, 185.6, 144.5, 195.5, 153.20000000000002, 173.0, 183.8, 167.0, 107.0, 160.1, 153.2, 185.0, 189.2, 200.0, 135.2, 195.5, 187.4, 167.0, 164.0, 185.0, 197.3, 189.2, 161.0, 167.0, 185.6, 191.0, 187.4, 196.4, 170.0, 192.8, 131.0, 200.0, 193.0, 186.0, 144.0, 199.0, 195.5, 194.0, 94.39999999999999, 195.5], "policy_predator_policy_reward": [0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 16.0, 16.0, 7.0, 0.0, 8.0, 7.0, 0.0, 0.0, 14.0, 0.0, 0.0, 5.0, 0.0, 0.0, 15.0, 0.0, 4.0, 13.0, 0.0, 3.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 15.0, 23.0, 8.0, 3.0, 10.0, 0.0, 0.0, 2.0, 0.0, 1.0, 12.0, 8.0, 17.0, 0.0, 8.0, 0.0, 8.0, 0.0, 9.0, 6.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 5.0, 8.0, 21.0, 6.0, 7.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 16.0, 0.0, 0.0, 2.0, 9.0, 11.0, 0.0, 0.0, 3.0, 0.0, 0.0, 12.0, 1.0, 10.0, 6.0, 0.0, 0.0, 8.0, 0.0, 0.0, 7.0, 16.0, 0.0, 0.0, 12.0, 6.0, 14.0, 4.0, 0.0, 0.0, 0.0, 13.0, 0.0, 9.0, 2.0, 5.0, 5.0, 1.0, 4.0, 0.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 7.0, 12.0, 10.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 12.0, 0.0, 4.0, 0.0, 6.0, 6.0, 13.0, 0.0, 0.0, 16.0, 0.0, 7.0, 0.0, 12.0, 7.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 9.0, 2.0, 0.0, 2.0, 13.0, 19.0, 19.0, 11.0, 0.0, 12.0, 9.0, 7.0, 6.0, 12.0, 34.0, 5.0, 15.0, 0.0, 0.0, 21.0, 0.0, 0.0, 11.0, 12.0, 5.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 15.0, 21.0, 0.0, 0.0, 2.0, 0.0, 2.0, 0.0, 13.0, 16.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4247699647266472, "mean_inference_ms": 13.627389852009191, "mean_action_processing_ms": 3.851244081389284, "mean_env_wait_ms": 0.43357947327071167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015244364738464355, "StateBufferConnector_ms": 0.0061986446380615234, "ViewRequirementAgentConnector_ms": 0.1240619421005249}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 281.29999999999984, "episode_return_mean": 366.9550000000001, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.34148112649245, "num_env_steps_trained_throughput_per_sec": 294.34148112649245, "timesteps_total": 648000, "num_env_steps_sampled_lifetime": 648000, "num_agent_steps_sampled_lifetime": 2592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2592000, "timers": {"training_iteration_time_ms": 13064.338, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13064.281, "sample_time_ms": 1651.865, "learn_time_ms": 11391.643, "learn_throughput": 351.135, "synch_weights_time_ms": 17.036}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 2592000, "num_agent_steps_trained": 2592000}, "done": false, "training_iteration": 162, "trial_id": "e4caa_00000", "date": "2024-08-13_23-14-58", "timestamp": 1723605298, "time_this_iter_s": 13.639209985733032, "time_total_s": 12626.033410310745, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bf9e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12626.033410310745, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 53.175, "ram_util_percent": 83.62999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4479360888007458, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3287364106403575, "policy_loss": -0.006259844422576919, "vf_loss": 0.33494727165803495, "vf_explained_var": 0.2687933106901784, "kl": 0.006966446775346005, "entropy": 0.9481902504408801, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 307125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3548173793961131, "cur_kl_coeff": 2.031254238220913e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2365999284165877, "policy_loss": -0.0017989910398634574, "vf_loss": 0.23839891902355861, "vf_explained_var": 0.26898574554730975, "kl": 0.041813358101805, "entropy": 0.3561951803388419, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 307125.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 281.29999999999984, "episode_reward_mean": 367.204, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 77.29999999999998, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 34.0}, "policy_reward_mean": {"prey_policy": 178.787, "predator_policy": 4.815}, "custom_metrics": {}, "hist_stats": {"episode_reward": [281.29999999999984, 390.1, 371.7, 302.29999999999995, 338.6, 366.9, 384.0, 368.5, 370.0, 367.3, 400.0, 380.1, 360.6, 361.4, 389.9, 358.0, 399.0, 391.9, 364.6, 367.1, 378.4, 375.0, 363.0, 389.5, 396.4, 339.8, 348.2, 397.3, 361.5, 373.4, 332.9, 348.1, 365.4, 375.8, 393.7, 361.1, 377.7, 387.5, 319.80000000000007, 400.0, 344.0, 384.0, 381.0, 383.0, 374.0, 393.7, 335.1, 377.5, 347.2, 392.0, 384.4, 346.7, 400.0, 329.3, 383.3, 345.5, 376.0, 393.7, 375.3, 370.29999999999995, 387.0, 322.0, 366.6, 351.0, 347.2, 363.8, 313.1, 358.2, 389.2, 351.7, 365.4, 366.0, 386.5, 341.0, 376.6, 383.8, 369.8, 367.0, 379.0, 345.0, 391.5, 318.9000000000001, 382.9, 375.8, 359.2, 361.6, 383.8, 379.7, 390.8, 366.1, 390.1, 349.1, 362.0, 353.0, 358.6, 371.0, 370.0, 389.0, 363.5, 360.1], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [191.0, 77.29999999999998, 197.3, 192.8, 184.7, 185.0, 142.7, 146.6, 137.6, 176.0, 176.0, 182.9, 200.0, 176.0, 171.2, 188.3, 182.0, 182.0, 197.3, 155.0, 200.0, 200.0, 190.1, 185.0, 200.0, 131.6, 155.6, 192.8, 200.0, 188.9, 168.0, 190.0, 200.0, 199.0, 200.0, 191.9, 176.6, 182.0, 151.1, 200.0, 181.1, 197.3, 176.0, 188.0, 179.0, 173.0, 200.0, 186.5, 199.1, 197.3, 187.4, 139.4, 150.2, 182.0, 197.3, 200.0, 153.5, 200.0, 187.4, 179.0, 150.8, 166.1, 160.1, 176.0, 157.1, 188.3, 183.8, 188.0, 196.4, 197.3, 181.1, 167.0, 173.0, 193.7, 177.5, 200.0, 181.4, 133.39999999999998, 200.0, 200.0, 177.0, 164.0, 194.0, 188.0, 187.0, 194.0, 200.0, 164.0, 188.0, 176.0, 193.7, 200.0, 181.1, 140.0, 183.8, 193.7, 187.4, 147.8, 200.0, 188.0, 184.4, 194.0, 138.5, 189.2, 200.0, 200.0, 145.7, 167.6, 176.3, 200.0, 182.9, 143.6, 191.9, 181.1, 193.7, 200.0, 188.6, 184.7, 181.1, 180.2, 191.0, 194.0, 172.0, 135.0, 143.0, 185.6, 144.5, 195.5, 153.20000000000002, 173.0, 183.8, 167.0, 107.0, 160.1, 153.2, 185.0, 189.2, 200.0, 135.2, 195.5, 187.4, 167.0, 164.0, 185.0, 197.3, 189.2, 161.0, 167.0, 185.6, 191.0, 187.4, 196.4, 170.0, 192.8, 131.0, 200.0, 193.0, 186.0, 144.0, 199.0, 195.5, 194.0, 94.39999999999999, 195.5, 195.5, 187.4, 178.1, 193.7, 173.0, 177.2, 197.3, 146.3, 200.0, 183.8, 179.0, 193.7, 200.0, 189.8, 173.0, 181.1, 190.1, 200.0, 131.0, 190.1, 170.0, 182.0, 146.0, 188.0, 176.6, 173.0, 191.0, 155.0, 179.0, 176.0, 200.0, 189.0, 195.5, 152.0, 172.1, 176.0], "policy_predator_policy_reward": [3.0, 10.0, 0.0, 0.0, 2.0, 0.0, 1.0, 12.0, 8.0, 17.0, 0.0, 8.0, 0.0, 8.0, 0.0, 9.0, 6.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 5.0, 8.0, 21.0, 6.0, 7.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 16.0, 0.0, 0.0, 2.0, 9.0, 11.0, 0.0, 0.0, 3.0, 0.0, 0.0, 12.0, 1.0, 10.0, 6.0, 0.0, 0.0, 8.0, 0.0, 0.0, 7.0, 16.0, 0.0, 0.0, 12.0, 6.0, 14.0, 4.0, 0.0, 0.0, 0.0, 13.0, 0.0, 9.0, 2.0, 5.0, 5.0, 1.0, 4.0, 0.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 7.0, 12.0, 10.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 12.0, 0.0, 4.0, 0.0, 6.0, 6.0, 13.0, 0.0, 0.0, 16.0, 0.0, 7.0, 0.0, 12.0, 7.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 9.0, 2.0, 0.0, 2.0, 13.0, 19.0, 19.0, 11.0, 0.0, 12.0, 9.0, 7.0, 6.0, 12.0, 34.0, 5.0, 15.0, 0.0, 0.0, 21.0, 0.0, 0.0, 11.0, 12.0, 5.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 15.0, 21.0, 0.0, 0.0, 2.0, 0.0, 2.0, 0.0, 13.0, 16.0, 0.0, 0.0, 4.0, 0.0, 0.0, 9.0, 5.0, 13.0, 0.0, 0.0, 7.0, 0.0, 0.0, 1.0, 4.0, 8.0, 0.0, 0.0, 23.0, 5.0, 0.0, 10.0, 1.0, 18.0, 9.0, 0.0, 10.0, 15.0, 7.0, 8.0, 0.0, 0.0, 16.0, 0.0, 9.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4208103075196257, "mean_inference_ms": 13.563034184992675, "mean_action_processing_ms": 3.831141318753831, "mean_env_wait_ms": 0.43253065956857456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015170574188232422, "StateBufferConnector_ms": 0.0061064958572387695, "ViewRequirementAgentConnector_ms": 0.13036155700683594}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 281.29999999999984, "episode_return_mean": 367.204, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.190557035018, "num_env_steps_trained_throughput_per_sec": 302.190557035018, "timesteps_total": 652000, "num_env_steps_sampled_lifetime": 652000, "num_agent_steps_sampled_lifetime": 2608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2608000, "timers": {"training_iteration_time_ms": 13028.371, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13028.313, "sample_time_ms": 1622.484, "learn_time_ms": 11385.157, "learn_throughput": 351.335, "synch_weights_time_ms": 17.217}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 2608000, "num_agent_steps_trained": 2608000}, "done": false, "training_iteration": 163, "trial_id": "e4caa_00000", "date": "2024-08-13_23-15-12", "timestamp": 1723605312, "time_this_iter_s": 13.265697002410889, "time_total_s": 12639.299107313156, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bf9af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12639.299107313156, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 49.78333333333333, "ram_util_percent": 83.6222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7061393953031965, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5590980018372032, "policy_loss": -0.008967702899857488, "vf_loss": 0.5679954282939434, "vf_explained_var": 0.37700165462872337, "kl": 0.009994776279607938, "entropy": 0.9578819820805201, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 309015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6241895860465114, "cur_kl_coeff": 3.0468813573313684e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.513001219944033, "policy_loss": -0.002932675945616904, "vf_loss": 0.5159338967542031, "vf_explained_var": 0.06183845656258719, "kl": 0.012173523397474587, "entropy": 0.2928769384111677, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 309015.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 296.0, "episode_reward_mean": 367.79600000000005, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 94.39999999999999, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 34.0}, "policy_reward_mean": {"prey_policy": 178.793, "predator_policy": 5.105}, "custom_metrics": {}, "hist_stats": {"episode_reward": [389.5, 396.4, 339.8, 348.2, 397.3, 361.5, 373.4, 332.9, 348.1, 365.4, 375.8, 393.7, 361.1, 377.7, 387.5, 319.80000000000007, 400.0, 344.0, 384.0, 381.0, 383.0, 374.0, 393.7, 335.1, 377.5, 347.2, 392.0, 384.4, 346.7, 400.0, 329.3, 383.3, 345.5, 376.0, 393.7, 375.3, 370.29999999999995, 387.0, 322.0, 366.6, 351.0, 347.2, 363.8, 313.1, 358.2, 389.2, 351.7, 365.4, 366.0, 386.5, 341.0, 376.6, 383.8, 369.8, 367.0, 379.0, 345.0, 391.5, 318.9000000000001, 382.9, 375.8, 359.2, 361.6, 383.8, 379.7, 390.8, 366.1, 390.1, 349.1, 362.0, 353.0, 358.6, 371.0, 370.0, 389.0, 363.5, 360.1, 389.0, 348.0, 361.3, 377.0, 360.4, 357.7, 389.2, 390.0, 383.5, 321.9, 296.0, 368.1, 383.8, 392.4, 382.6, 393.7, 360.7, 369.0, 389.0, 366.0, 380.0, 346.3, 383.3], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 186.5, 199.1, 197.3, 187.4, 139.4, 150.2, 182.0, 197.3, 200.0, 153.5, 200.0, 187.4, 179.0, 150.8, 166.1, 160.1, 176.0, 157.1, 188.3, 183.8, 188.0, 196.4, 197.3, 181.1, 167.0, 173.0, 193.7, 177.5, 200.0, 181.4, 133.39999999999998, 200.0, 200.0, 177.0, 164.0, 194.0, 188.0, 187.0, 194.0, 200.0, 164.0, 188.0, 176.0, 193.7, 200.0, 181.1, 140.0, 183.8, 193.7, 187.4, 147.8, 200.0, 188.0, 184.4, 194.0, 138.5, 189.2, 200.0, 200.0, 145.7, 167.6, 176.3, 200.0, 182.9, 143.6, 191.9, 181.1, 193.7, 200.0, 188.6, 184.7, 181.1, 180.2, 191.0, 194.0, 172.0, 135.0, 143.0, 185.6, 144.5, 195.5, 153.20000000000002, 173.0, 183.8, 167.0, 107.0, 160.1, 153.2, 185.0, 189.2, 200.0, 135.2, 195.5, 187.4, 167.0, 164.0, 185.0, 197.3, 189.2, 161.0, 167.0, 185.6, 191.0, 187.4, 196.4, 170.0, 192.8, 131.0, 200.0, 193.0, 186.0, 144.0, 199.0, 195.5, 194.0, 94.39999999999999, 195.5, 195.5, 187.4, 178.1, 193.7, 173.0, 177.2, 197.3, 146.3, 200.0, 183.8, 179.0, 193.7, 200.0, 189.8, 173.0, 181.1, 190.1, 200.0, 131.0, 190.1, 170.0, 182.0, 146.0, 188.0, 176.6, 173.0, 191.0, 155.0, 179.0, 176.0, 200.0, 189.0, 195.5, 152.0, 172.1, 176.0, 191.0, 197.0, 176.0, 134.0, 200.0, 143.3, 200.0, 170.0, 150.2, 189.2, 193.7, 146.0, 200.0, 189.2, 185.0, 200.0, 177.5, 200.0, 170.0, 116.9, 109.69999999999999, 161.3, 184.1, 176.0, 200.0, 183.8, 191.3, 199.1, 190.4, 189.2, 200.0, 193.7, 179.3, 172.4, 199.0, 155.0, 200.0, 189.0, 192.0, 174.0, 182.0, 191.0, 197.3, 125.0, 197.0, 179.3], "policy_predator_policy_reward": [0.0, 3.0, 0.0, 0.0, 12.0, 1.0, 10.0, 6.0, 0.0, 0.0, 8.0, 0.0, 0.0, 7.0, 16.0, 0.0, 0.0, 12.0, 6.0, 14.0, 4.0, 0.0, 0.0, 0.0, 13.0, 0.0, 9.0, 2.0, 5.0, 5.0, 1.0, 4.0, 0.0, 0.0, 0.0, 3.0, 2.0, 0.0, 0.0, 0.0, 7.0, 12.0, 10.0, 0.0, 0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 12.0, 0.0, 4.0, 0.0, 6.0, 6.0, 13.0, 0.0, 0.0, 16.0, 0.0, 7.0, 0.0, 12.0, 7.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 9.0, 2.0, 0.0, 2.0, 13.0, 19.0, 19.0, 11.0, 0.0, 12.0, 9.0, 7.0, 6.0, 12.0, 34.0, 5.0, 15.0, 0.0, 0.0, 21.0, 0.0, 0.0, 11.0, 12.0, 5.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 15.0, 21.0, 0.0, 0.0, 2.0, 0.0, 2.0, 0.0, 13.0, 16.0, 0.0, 0.0, 4.0, 0.0, 0.0, 9.0, 5.0, 13.0, 0.0, 0.0, 7.0, 0.0, 0.0, 1.0, 4.0, 8.0, 0.0, 0.0, 23.0, 5.0, 0.0, 10.0, 1.0, 18.0, 9.0, 0.0, 10.0, 15.0, 7.0, 8.0, 0.0, 0.0, 16.0, 0.0, 9.0, 3.0, 1.0, 0.0, 16.0, 22.0, 0.0, 18.0, 7.0, 0.0, 5.0, 16.0, 1.0, 17.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 4.0, 31.0, 13.0, 12.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 9.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 8.0, 16.0, 7.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4122622653676606, "mean_inference_ms": 13.185943448378463, "mean_action_processing_ms": 3.962535718366111, "mean_env_wait_ms": 0.4310093552034291, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01155853271484375, "StateBufferConnector_ms": 0.004297971725463867, "ViewRequirementAgentConnector_ms": 0.12690949440002441}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 296.0, "episode_return_mean": 367.79600000000005, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.4193026932384, "num_env_steps_trained_throughput_per_sec": 307.4193026932384, "timesteps_total": 656000, "num_env_steps_sampled_lifetime": 656000, "num_agent_steps_sampled_lifetime": 2624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2624000, "timers": {"training_iteration_time_ms": 13022.127, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13022.069, "sample_time_ms": 1622.577, "learn_time_ms": 11378.924, "learn_throughput": 351.527, "synch_weights_time_ms": 17.062}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 2624000, "num_agent_steps_trained": 2624000}, "done": false, "training_iteration": 164, "trial_id": "e4caa_00000", "date": "2024-08-13_23-15-25", "timestamp": 1723605325, "time_this_iter_s": 13.052747011184692, "time_total_s": 12652.35185432434, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b213a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12652.35185432434, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 48.88421052631579, "ram_util_percent": 83.5315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8252704085496367, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0187589931819174, "policy_loss": -0.00940785319100888, "vf_loss": 1.0280883109758772, "vf_explained_var": 0.46719184634546757, "kl": 0.011169574455623903, "entropy": 0.9706224173465103, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 310905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4206188555117008, "cur_kl_coeff": 3.0468813573313684e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8857942714104576, "policy_loss": 0.00024455978643523636, "vf_loss": 0.8855497116607333, "vf_explained_var": 0.10509638638092728, "kl": 0.004042730355058047, "entropy": 0.2332523593669215, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 310905.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 177.59999999999954, "episode_reward_mean": 364.867, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -0.4000000000000057, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 34.0}, "policy_reward_mean": {"prey_policy": 177.3235, "predator_policy": 5.11}, "custom_metrics": {}, "hist_stats": {"episode_reward": [393.7, 335.1, 377.5, 347.2, 392.0, 384.4, 346.7, 400.0, 329.3, 383.3, 345.5, 376.0, 393.7, 375.3, 370.29999999999995, 387.0, 322.0, 366.6, 351.0, 347.2, 363.8, 313.1, 358.2, 389.2, 351.7, 365.4, 366.0, 386.5, 341.0, 376.6, 383.8, 369.8, 367.0, 379.0, 345.0, 391.5, 318.9000000000001, 382.9, 375.8, 359.2, 361.6, 383.8, 379.7, 390.8, 366.1, 390.1, 349.1, 362.0, 353.0, 358.6, 371.0, 370.0, 389.0, 363.5, 360.1, 389.0, 348.0, 361.3, 377.0, 360.4, 357.7, 389.2, 390.0, 383.5, 321.9, 296.0, 368.1, 383.8, 392.4, 382.6, 393.7, 360.7, 369.0, 389.0, 366.0, 380.0, 346.3, 383.3, 397.3, 400.0, 344.6, 392.8, 361.5, 392.8, 391.9, 389.2, 388.3, 359.5, 348.0, 392.8, 279.0, 346.50000000000006, 390.1, 396.4, 177.59999999999954, 227.99999999999946, 382.0, 372.0, 360.9, 350.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [193.7, 200.0, 181.1, 140.0, 183.8, 193.7, 187.4, 147.8, 200.0, 188.0, 184.4, 194.0, 138.5, 189.2, 200.0, 200.0, 145.7, 167.6, 176.3, 200.0, 182.9, 143.6, 191.9, 181.1, 193.7, 200.0, 188.6, 184.7, 181.1, 180.2, 191.0, 194.0, 172.0, 135.0, 143.0, 185.6, 144.5, 195.5, 153.20000000000002, 173.0, 183.8, 167.0, 107.0, 160.1, 153.2, 185.0, 189.2, 200.0, 135.2, 195.5, 187.4, 167.0, 164.0, 185.0, 197.3, 189.2, 161.0, 167.0, 185.6, 191.0, 187.4, 196.4, 170.0, 192.8, 131.0, 200.0, 193.0, 186.0, 144.0, 199.0, 195.5, 194.0, 94.39999999999999, 195.5, 195.5, 187.4, 178.1, 193.7, 173.0, 177.2, 197.3, 146.3, 200.0, 183.8, 179.0, 193.7, 200.0, 189.8, 173.0, 181.1, 190.1, 200.0, 131.0, 190.1, 170.0, 182.0, 146.0, 188.0, 176.6, 173.0, 191.0, 155.0, 179.0, 176.0, 200.0, 189.0, 195.5, 152.0, 172.1, 176.0, 191.0, 197.0, 176.0, 134.0, 200.0, 143.3, 200.0, 170.0, 150.2, 189.2, 193.7, 146.0, 200.0, 189.2, 185.0, 200.0, 177.5, 200.0, 170.0, 116.9, 109.69999999999999, 161.3, 184.1, 176.0, 200.0, 183.8, 191.3, 199.1, 190.4, 189.2, 200.0, 193.7, 179.3, 172.4, 199.0, 155.0, 200.0, 189.0, 192.0, 174.0, 182.0, 191.0, 197.3, 125.0, 197.0, 179.3, 200.0, 197.3, 200.0, 200.0, 137.3, 182.3, 192.8, 200.0, 147.2, 197.3, 200.0, 192.8, 193.7, 198.2, 198.2, 191.0, 199.1, 189.2, 159.5, 200.0, 188.0, 146.0, 200.0, 192.8, 70.99999999999999, 173.0, 144.5, 200.0, 200.0, 190.1, 196.4, 200.0, 137.0, -0.4000000000000057, 180.5, 42.49999999999998, 175.0, 200.0, 188.0, 184.0, 160.7, 189.2, 187.4, 146.60000000000002], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 14.0, 0.0, 0.0, 0.0, 12.0, 0.0, 4.0, 0.0, 6.0, 6.0, 13.0, 0.0, 0.0, 16.0, 0.0, 7.0, 0.0, 12.0, 7.0, 3.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 9.0, 2.0, 0.0, 2.0, 13.0, 19.0, 19.0, 11.0, 0.0, 12.0, 9.0, 7.0, 6.0, 12.0, 34.0, 5.0, 15.0, 0.0, 0.0, 21.0, 0.0, 0.0, 11.0, 12.0, 5.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 15.0, 21.0, 0.0, 0.0, 2.0, 0.0, 2.0, 0.0, 13.0, 16.0, 0.0, 0.0, 4.0, 0.0, 0.0, 9.0, 5.0, 13.0, 0.0, 0.0, 7.0, 0.0, 0.0, 1.0, 4.0, 8.0, 0.0, 0.0, 23.0, 5.0, 0.0, 10.0, 1.0, 18.0, 9.0, 0.0, 10.0, 15.0, 7.0, 8.0, 0.0, 0.0, 16.0, 0.0, 9.0, 3.0, 1.0, 0.0, 16.0, 22.0, 0.0, 18.0, 7.0, 0.0, 5.0, 16.0, 1.0, 17.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 4.0, 31.0, 13.0, 12.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 9.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 8.0, 16.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 16.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 5.0, 0.0, 0.0, 13.0, 22.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 15.0, 26.0, 5.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 11.0, 12.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4114343053812264, "mean_inference_ms": 13.409271579543613, "mean_action_processing_ms": 3.78287656564037, "mean_env_wait_ms": 0.42998623866419927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006900668144226074, "StateBufferConnector_ms": 0.0033512115478515625, "ViewRequirementAgentConnector_ms": 0.11583054065704346}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 177.59999999999954, "episode_return_mean": 364.867, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.8306196798974, "num_env_steps_trained_throughput_per_sec": 303.8306196798974, "timesteps_total": 660000, "num_env_steps_sampled_lifetime": 660000, "num_agent_steps_sampled_lifetime": 2640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2640000, "timers": {"training_iteration_time_ms": 13017.898, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13017.84, "sample_time_ms": 1620.1, "learn_time_ms": 11377.113, "learn_throughput": 351.583, "synch_weights_time_ms": 17.067}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "done": false, "training_iteration": 165, "trial_id": "e4caa_00000", "date": "2024-08-13_23-15-38", "timestamp": 1723605338, "time_this_iter_s": 13.21047592163086, "time_total_s": 12665.562330245972, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2bbd940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12665.562330245972, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 49.38888888888889, "ram_util_percent": 83.63888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5583114270337675, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5024955089412668, "policy_loss": -0.006391806338011982, "vf_loss": 0.5088194251368463, "vf_explained_var": 0.5825969256736614, "kl": 0.00965547383740705, "entropy": 0.9337070333263862, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 312795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1091847141741444, "cur_kl_coeff": 1.5234406786656842e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.21477753982420952, "policy_loss": -0.0011088256470405708, "vf_loss": 0.21588636579795215, "vf_explained_var": 0.11715657553344808, "kl": 0.026349823642594212, "entropy": 0.32289692128776876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 312795.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 177.59999999999954, "episode_reward_mean": 365.55100000000004, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -0.4000000000000057, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 34.0}, "policy_reward_mean": {"prey_policy": 177.93550000000002, "predator_policy": 4.84}, "custom_metrics": {}, "hist_stats": {"episode_reward": [351.0, 347.2, 363.8, 313.1, 358.2, 389.2, 351.7, 365.4, 366.0, 386.5, 341.0, 376.6, 383.8, 369.8, 367.0, 379.0, 345.0, 391.5, 318.9000000000001, 382.9, 375.8, 359.2, 361.6, 383.8, 379.7, 390.8, 366.1, 390.1, 349.1, 362.0, 353.0, 358.6, 371.0, 370.0, 389.0, 363.5, 360.1, 389.0, 348.0, 361.3, 377.0, 360.4, 357.7, 389.2, 390.0, 383.5, 321.9, 296.0, 368.1, 383.8, 392.4, 382.6, 393.7, 360.7, 369.0, 389.0, 366.0, 380.0, 346.3, 383.3, 397.3, 400.0, 344.6, 392.8, 361.5, 392.8, 391.9, 389.2, 388.3, 359.5, 348.0, 392.8, 279.0, 346.50000000000006, 390.1, 396.4, 177.59999999999954, 227.99999999999946, 382.0, 372.0, 360.9, 350.0, 351.4, 385.4, 382.0, 387.4, 346.0, 379.2, 389.2, 372.1, 393.7, 315.20000000000005, 351.40000000000003, 385.9, 368.1, 360.4, 377.0, 391.0, 374.8, 383.8], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [144.5, 195.5, 153.20000000000002, 173.0, 183.8, 167.0, 107.0, 160.1, 153.2, 185.0, 189.2, 200.0, 135.2, 195.5, 187.4, 167.0, 164.0, 185.0, 197.3, 189.2, 161.0, 167.0, 185.6, 191.0, 187.4, 196.4, 170.0, 192.8, 131.0, 200.0, 193.0, 186.0, 144.0, 199.0, 195.5, 194.0, 94.39999999999999, 195.5, 195.5, 187.4, 178.1, 193.7, 173.0, 177.2, 197.3, 146.3, 200.0, 183.8, 179.0, 193.7, 200.0, 189.8, 173.0, 181.1, 190.1, 200.0, 131.0, 190.1, 170.0, 182.0, 146.0, 188.0, 176.6, 173.0, 191.0, 155.0, 179.0, 176.0, 200.0, 189.0, 195.5, 152.0, 172.1, 176.0, 191.0, 197.0, 176.0, 134.0, 200.0, 143.3, 200.0, 170.0, 150.2, 189.2, 193.7, 146.0, 200.0, 189.2, 185.0, 200.0, 177.5, 200.0, 170.0, 116.9, 109.69999999999999, 161.3, 184.1, 176.0, 200.0, 183.8, 191.3, 199.1, 190.4, 189.2, 200.0, 193.7, 179.3, 172.4, 199.0, 155.0, 200.0, 189.0, 192.0, 174.0, 182.0, 191.0, 197.3, 125.0, 197.0, 179.3, 200.0, 197.3, 200.0, 200.0, 137.3, 182.3, 192.8, 200.0, 147.2, 197.3, 200.0, 192.8, 193.7, 198.2, 198.2, 191.0, 199.1, 189.2, 159.5, 200.0, 188.0, 146.0, 200.0, 192.8, 70.99999999999999, 173.0, 144.5, 200.0, 200.0, 190.1, 196.4, 200.0, 137.0, -0.4000000000000057, 180.5, 42.49999999999998, 175.0, 200.0, 188.0, 184.0, 160.7, 189.2, 187.4, 146.60000000000002, 167.6, 174.8, 177.2, 198.2, 193.7, 188.3, 194.6, 192.8, 147.8, 189.2, 189.2, 182.0, 193.7, 195.5, 195.5, 176.6, 200.0, 193.7, 200.0, 96.2, 200.0, 142.39999999999998, 191.9, 191.0, 154.1, 191.0, 175.4, 176.0, 191.0, 173.0, 191.0, 200.0, 188.3, 186.5, 197.3, 186.5], "policy_predator_policy_reward": [11.0, 0.0, 12.0, 9.0, 7.0, 6.0, 12.0, 34.0, 5.0, 15.0, 0.0, 0.0, 21.0, 0.0, 0.0, 11.0, 12.0, 5.0, 0.0, 0.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 15.0, 21.0, 0.0, 0.0, 2.0, 0.0, 2.0, 0.0, 13.0, 16.0, 0.0, 0.0, 4.0, 0.0, 0.0, 9.0, 5.0, 13.0, 0.0, 0.0, 7.0, 0.0, 0.0, 1.0, 4.0, 8.0, 0.0, 0.0, 23.0, 5.0, 0.0, 10.0, 1.0, 18.0, 9.0, 0.0, 10.0, 15.0, 7.0, 8.0, 0.0, 0.0, 16.0, 0.0, 9.0, 3.0, 1.0, 0.0, 16.0, 22.0, 0.0, 18.0, 7.0, 0.0, 5.0, 16.0, 1.0, 17.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 4.0, 31.0, 13.0, 12.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 9.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 8.0, 16.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 16.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 5.0, 0.0, 0.0, 13.0, 22.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 15.0, 26.0, 5.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 11.0, 12.0, 4.0, 0.0, 9.0, 6.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 9.0, 0.0, 3.0, 12.0, 11.0, 0.0, 9.0, 12.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4076332230690727, "mean_inference_ms": 13.34762611578849, "mean_action_processing_ms": 3.7635152212741887, "mean_env_wait_ms": 0.42895071874842317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006471037864685059, "StateBufferConnector_ms": 0.003412485122680664, "ViewRequirementAgentConnector_ms": 0.126845121383667}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 177.59999999999954, "episode_return_mean": 365.55100000000004, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.21648235889086, "num_env_steps_trained_throughput_per_sec": 303.21648235889086, "timesteps_total": 664000, "num_env_steps_sampled_lifetime": 664000, "num_agent_steps_sampled_lifetime": 2656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2656000, "timers": {"training_iteration_time_ms": 13057.286, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13057.229, "sample_time_ms": 1620.312, "learn_time_ms": 11416.001, "learn_throughput": 350.385, "synch_weights_time_ms": 17.167}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 2656000, "num_agent_steps_trained": 2656000}, "done": false, "training_iteration": 166, "trial_id": "e4caa_00000", "date": "2024-08-13_23-15-51", "timestamp": 1723605351, "time_this_iter_s": 13.257184028625488, "time_total_s": 12678.819514274597, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b2f790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12678.819514274597, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 50.44736842105263, "ram_util_percent": 83.7421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6104131641526702, "cur_kl_coeff": 0.007031250000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9924102168234568, "policy_loss": -0.013188427213392166, "vf_loss": 1.0054327913535335, "vf_explained_var": 0.6331166864387573, "kl": 0.023587923684400616, "entropy": 0.9158547302402517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 314685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9967459517181234, "cur_kl_coeff": 2.2851610179985277e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1909087741185749, "policy_loss": 0.00016118245145118742, "vf_loss": 1.190747588589078, "vf_explained_var": 0.06059012618014421, "kl": 0.009235342227511515, "entropy": 0.28360025943429384, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 314685.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 169.29999999999978, "episode_reward_mean": 363.293, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -19.900000000000013, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 46.0}, "policy_reward_mean": {"prey_policy": 176.62649999999996, "predator_policy": 5.02}, "custom_metrics": {}, "hist_stats": {"episode_reward": [318.9000000000001, 382.9, 375.8, 359.2, 361.6, 383.8, 379.7, 390.8, 366.1, 390.1, 349.1, 362.0, 353.0, 358.6, 371.0, 370.0, 389.0, 363.5, 360.1, 389.0, 348.0, 361.3, 377.0, 360.4, 357.7, 389.2, 390.0, 383.5, 321.9, 296.0, 368.1, 383.8, 392.4, 382.6, 393.7, 360.7, 369.0, 389.0, 366.0, 380.0, 346.3, 383.3, 397.3, 400.0, 344.6, 392.8, 361.5, 392.8, 391.9, 389.2, 388.3, 359.5, 348.0, 392.8, 279.0, 346.50000000000006, 390.1, 396.4, 177.59999999999954, 227.99999999999946, 382.0, 372.0, 360.9, 350.0, 351.4, 385.4, 382.0, 387.4, 346.0, 379.2, 389.2, 372.1, 393.7, 315.20000000000005, 351.40000000000003, 385.9, 368.1, 360.4, 377.0, 391.0, 374.8, 383.8, 396.4, 392.8, 207.09999999999943, 373.4, 169.29999999999978, 340.2, 354.8, 299.40000000000003, 378.0, 382.0, 381.1, 387.4, 377.0, 339.6, 392.0, 392.0, 370.0, 387.5], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [94.39999999999999, 195.5, 195.5, 187.4, 178.1, 193.7, 173.0, 177.2, 197.3, 146.3, 200.0, 183.8, 179.0, 193.7, 200.0, 189.8, 173.0, 181.1, 190.1, 200.0, 131.0, 190.1, 170.0, 182.0, 146.0, 188.0, 176.6, 173.0, 191.0, 155.0, 179.0, 176.0, 200.0, 189.0, 195.5, 152.0, 172.1, 176.0, 191.0, 197.0, 176.0, 134.0, 200.0, 143.3, 200.0, 170.0, 150.2, 189.2, 193.7, 146.0, 200.0, 189.2, 185.0, 200.0, 177.5, 200.0, 170.0, 116.9, 109.69999999999999, 161.3, 184.1, 176.0, 200.0, 183.8, 191.3, 199.1, 190.4, 189.2, 200.0, 193.7, 179.3, 172.4, 199.0, 155.0, 200.0, 189.0, 192.0, 174.0, 182.0, 191.0, 197.3, 125.0, 197.0, 179.3, 200.0, 197.3, 200.0, 200.0, 137.3, 182.3, 192.8, 200.0, 147.2, 197.3, 200.0, 192.8, 193.7, 198.2, 198.2, 191.0, 199.1, 189.2, 159.5, 200.0, 188.0, 146.0, 200.0, 192.8, 70.99999999999999, 173.0, 144.5, 200.0, 200.0, 190.1, 196.4, 200.0, 137.0, -0.4000000000000057, 180.5, 42.49999999999998, 175.0, 200.0, 188.0, 184.0, 160.7, 189.2, 187.4, 146.60000000000002, 167.6, 174.8, 177.2, 198.2, 193.7, 188.3, 194.6, 192.8, 147.8, 189.2, 189.2, 182.0, 193.7, 195.5, 195.5, 176.6, 200.0, 193.7, 200.0, 96.2, 200.0, 142.39999999999998, 191.9, 191.0, 154.1, 191.0, 175.4, 176.0, 191.0, 173.0, 191.0, 200.0, 188.3, 186.5, 197.3, 186.5, 198.2, 198.2, 200.0, 192.8, -19.900000000000013, 185.0, 177.2, 189.2, -7.30000000000004, 122.6, 178.4, 132.8, 183.8, 170.0, 76.39999999999999, 173.0, 200.0, 167.0, 194.6, 187.4, 200.0, 172.1, 193.7, 193.7, 194.6, 175.4, 164.0, 152.6, 188.0, 200.0, 200.0, 192.0, 185.0, 170.0, 188.0, 195.5], "policy_predator_policy_reward": [13.0, 16.0, 0.0, 0.0, 4.0, 0.0, 0.0, 9.0, 5.0, 13.0, 0.0, 0.0, 7.0, 0.0, 0.0, 1.0, 4.0, 8.0, 0.0, 0.0, 23.0, 5.0, 0.0, 10.0, 1.0, 18.0, 9.0, 0.0, 10.0, 15.0, 7.0, 8.0, 0.0, 0.0, 16.0, 0.0, 9.0, 3.0, 1.0, 0.0, 16.0, 22.0, 0.0, 18.0, 7.0, 0.0, 5.0, 16.0, 1.0, 17.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 4.0, 31.0, 13.0, 12.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 9.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 8.0, 16.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 16.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 5.0, 0.0, 0.0, 13.0, 22.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 15.0, 26.0, 5.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 11.0, 12.0, 4.0, 0.0, 9.0, 6.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 9.0, 0.0, 3.0, 12.0, 11.0, 0.0, 9.0, 12.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 23.0, 19.0, 7.0, 0.0, 46.0, 8.0, 10.0, 19.0, 0.0, 1.0, 20.0, 30.0, 0.0, 11.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 2.0, 5.0, 14.0, 9.0, 4.0, 0.0, 0.0, 0.0, 5.0, 10.0, 2.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4036149028344636, "mean_inference_ms": 13.285812874292107, "mean_action_processing_ms": 3.7443034416398095, "mean_env_wait_ms": 0.4278129241318831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004620790481567383, "StateBufferConnector_ms": 0.003425121307373047, "ViewRequirementAgentConnector_ms": 0.12104940414428711}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 169.29999999999978, "episode_return_mean": 363.293, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 241.95874308255247, "num_env_steps_trained_throughput_per_sec": 241.95874308255247, "timesteps_total": 668000, "num_env_steps_sampled_lifetime": 668000, "num_agent_steps_sampled_lifetime": 2672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2672000, "timers": {"training_iteration_time_ms": 13403.19, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13403.132, "sample_time_ms": 1623.361, "learn_time_ms": 11757.742, "learn_throughput": 340.201, "synch_weights_time_ms": 17.923}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 2672000, "num_agent_steps_trained": 2672000}, "done": false, "training_iteration": 167, "trial_id": "e4caa_00000", "date": "2024-08-13_23-16-08", "timestamp": 1723605368, "time_this_iter_s": 16.594574213027954, "time_total_s": 12695.414088487625, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2985a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12695.414088487625, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 65.42608695652174, "ram_util_percent": 82.5782608695652}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5697094024331482, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.490303262169399, "policy_loss": -0.011830863285016407, "vf_loss": 1.5019803143052197, "vf_explained_var": 0.6886815872457293, "kl": 0.014583507237125199, "entropy": 0.958567598320189, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 316575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2501494122718375, "cur_kl_coeff": 2.2851610179985277e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.246799277801993, "policy_loss": 0.0001574774469845194, "vf_loss": 1.246641797079611, "vf_explained_var": 0.04130221394004015, "kl": 0.007159429308617152, "entropy": 0.38371944105814376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 316575.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 145.0, "episode_reward_mean": 355.61400000000003, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -19.900000000000013, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 46.0}, "policy_reward_mean": {"prey_policy": 172.322, "predator_policy": 5.485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.1, 389.0, 348.0, 361.3, 377.0, 360.4, 357.7, 389.2, 390.0, 383.5, 321.9, 296.0, 368.1, 383.8, 392.4, 382.6, 393.7, 360.7, 369.0, 389.0, 366.0, 380.0, 346.3, 383.3, 397.3, 400.0, 344.6, 392.8, 361.5, 392.8, 391.9, 389.2, 388.3, 359.5, 348.0, 392.8, 279.0, 346.50000000000006, 390.1, 396.4, 177.59999999999954, 227.99999999999946, 382.0, 372.0, 360.9, 350.0, 351.4, 385.4, 382.0, 387.4, 346.0, 379.2, 389.2, 372.1, 393.7, 315.20000000000005, 351.40000000000003, 385.9, 368.1, 360.4, 377.0, 391.0, 374.8, 383.8, 396.4, 392.8, 207.09999999999943, 373.4, 169.29999999999978, 340.2, 354.8, 299.40000000000003, 378.0, 382.0, 381.1, 387.4, 377.0, 339.6, 392.0, 392.0, 370.0, 387.5, 397.3, 386.5, 372.5, 380.2, 383.2, 356.0, 340.2, 377.5, 365.6, 281.49999999999994, 344.2, 391.0, 356.20000000000005, 254.1999999999996, 199.0, 145.0, 358.5, 168.5999999999995], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [172.1, 176.0, 191.0, 197.0, 176.0, 134.0, 200.0, 143.3, 200.0, 170.0, 150.2, 189.2, 193.7, 146.0, 200.0, 189.2, 185.0, 200.0, 177.5, 200.0, 170.0, 116.9, 109.69999999999999, 161.3, 184.1, 176.0, 200.0, 183.8, 191.3, 199.1, 190.4, 189.2, 200.0, 193.7, 179.3, 172.4, 199.0, 155.0, 200.0, 189.0, 192.0, 174.0, 182.0, 191.0, 197.3, 125.0, 197.0, 179.3, 200.0, 197.3, 200.0, 200.0, 137.3, 182.3, 192.8, 200.0, 147.2, 197.3, 200.0, 192.8, 193.7, 198.2, 198.2, 191.0, 199.1, 189.2, 159.5, 200.0, 188.0, 146.0, 200.0, 192.8, 70.99999999999999, 173.0, 144.5, 200.0, 200.0, 190.1, 196.4, 200.0, 137.0, -0.4000000000000057, 180.5, 42.49999999999998, 175.0, 200.0, 188.0, 184.0, 160.7, 189.2, 187.4, 146.60000000000002, 167.6, 174.8, 177.2, 198.2, 193.7, 188.3, 194.6, 192.8, 147.8, 189.2, 189.2, 182.0, 193.7, 195.5, 195.5, 176.6, 200.0, 193.7, 200.0, 96.2, 200.0, 142.39999999999998, 191.9, 191.0, 154.1, 191.0, 175.4, 176.0, 191.0, 173.0, 191.0, 200.0, 188.3, 186.5, 197.3, 186.5, 198.2, 198.2, 200.0, 192.8, -19.900000000000013, 185.0, 177.2, 189.2, -7.30000000000004, 122.6, 178.4, 132.8, 183.8, 170.0, 76.39999999999999, 173.0, 200.0, 167.0, 194.6, 187.4, 200.0, 172.1, 193.7, 193.7, 194.6, 175.4, 164.0, 152.6, 188.0, 200.0, 200.0, 192.0, 185.0, 170.0, 188.0, 195.5, 200.0, 197.3, 198.2, 188.3, 179.0, 186.5, 193.7, 186.5, 192.8, 187.4, 194.6, 148.4, 167.0, 135.2, 192.8, 184.7, 164.0, 185.6, 54.19999999999998, 176.3, 156.2, 167.0, 195.5, 195.5, 193.7, 150.5, 200.0, 27.199999999999974, 11.0, 155.0, 123.0, 0.0, 148.70000000000002, 192.8, 20.000000000000014, 113.6], "policy_predator_policy_reward": [9.0, 3.0, 1.0, 0.0, 16.0, 22.0, 0.0, 18.0, 7.0, 0.0, 5.0, 16.0, 1.0, 17.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 4.0, 31.0, 13.0, 12.0, 8.0, 0.0, 0.0, 0.0, 0.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 9.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 8.0, 16.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 16.0, 0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 5.0, 0.0, 0.0, 13.0, 22.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 15.0, 26.0, 5.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 11.0, 12.0, 4.0, 0.0, 9.0, 6.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 9.0, 0.0, 3.0, 12.0, 11.0, 0.0, 9.0, 12.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 23.0, 19.0, 7.0, 0.0, 46.0, 8.0, 10.0, 19.0, 0.0, 1.0, 20.0, 30.0, 0.0, 11.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 2.0, 5.0, 14.0, 9.0, 4.0, 0.0, 0.0, 0.0, 5.0, 10.0, 2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 3.0, 0.0, 13.0, 14.0, 24.0, 0.0, 0.0, 12.0, 4.0, 23.0, 28.0, 11.0, 10.0, 0.0, 0.0, 6.0, 6.0, 14.0, 13.0, 7.0, 26.0, 0.0, 22.0, 9.0, 8.0, 17.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3997690724657292, "mean_inference_ms": 13.225299384790732, "mean_action_processing_ms": 3.7253960631718575, "mean_env_wait_ms": 0.42676836057542256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008667469024658203, "StateBufferConnector_ms": 0.0034238100051879883, "ViewRequirementAgentConnector_ms": 0.12416577339172363}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 145.0, "episode_return_mean": 355.61400000000003, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.5206800032396, "num_env_steps_trained_throughput_per_sec": 285.5206800032396, "timesteps_total": 672000, "num_env_steps_sampled_lifetime": 672000, "num_agent_steps_sampled_lifetime": 2688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2688000, "timers": {"training_iteration_time_ms": 13519.408, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13519.349, "sample_time_ms": 1672.366, "learn_time_ms": 11825.553, "learn_throughput": 338.251, "synch_weights_time_ms": 16.979}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 2688000, "num_agent_steps_trained": 2688000}, "done": false, "training_iteration": 168, "trial_id": "e4caa_00000", "date": "2024-08-13_23-16-22", "timestamp": 1723605382, "time_this_iter_s": 14.063220977783203, "time_total_s": 12709.477309465408, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2987ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12709.477309465408, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 66.32500000000002, "ram_util_percent": 82.49499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.891515280298455, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8647559639943576, "policy_loss": -0.008333377796594823, "vf_loss": 0.8729959911849133, "vf_explained_var": 0.6528430115293573, "kl": 0.008851162230447506, "entropy": 0.9055260071678767, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 318465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9980274892515606, "cur_kl_coeff": 2.2851610179985277e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8046809836827888, "policy_loss": -0.001317441204646553, "vf_loss": 0.8059984247599329, "vf_explained_var": 0.07824797179333116, "kl": 0.005796883297718132, "entropy": 0.3345961382622441, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 318465.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 145.0, "episode_reward_mean": 351.18299999999994, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -19.900000000000013, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 46.0}, "policy_reward_mean": {"prey_policy": 169.2415, "predator_policy": 6.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [392.8, 361.5, 392.8, 391.9, 389.2, 388.3, 359.5, 348.0, 392.8, 279.0, 346.50000000000006, 390.1, 396.4, 177.59999999999954, 227.99999999999946, 382.0, 372.0, 360.9, 350.0, 351.4, 385.4, 382.0, 387.4, 346.0, 379.2, 389.2, 372.1, 393.7, 315.20000000000005, 351.40000000000003, 385.9, 368.1, 360.4, 377.0, 391.0, 374.8, 383.8, 396.4, 392.8, 207.09999999999943, 373.4, 169.29999999999978, 340.2, 354.8, 299.40000000000003, 378.0, 382.0, 381.1, 387.4, 377.0, 339.6, 392.0, 392.0, 370.0, 387.5, 397.3, 386.5, 372.5, 380.2, 383.2, 356.0, 340.2, 377.5, 365.6, 281.49999999999994, 344.2, 391.0, 356.20000000000005, 254.1999999999996, 199.0, 145.0, 358.5, 168.5999999999995, 400.0, 373.0, 385.7, 358.1, 357.7, 358.3, 383.0, 353.9, 374.1, 196.89999999999947, 370.2, 373.4, 399.1, 348.0, 278.4, 393.5, 364.9, 380.6, 339.20000000000005, 360.1, 385.6, 274.0, 370.0, 325.0, 369.7, 275.4, 400.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [192.8, 200.0, 147.2, 197.3, 200.0, 192.8, 193.7, 198.2, 198.2, 191.0, 199.1, 189.2, 159.5, 200.0, 188.0, 146.0, 200.0, 192.8, 70.99999999999999, 173.0, 144.5, 200.0, 200.0, 190.1, 196.4, 200.0, 137.0, -0.4000000000000057, 180.5, 42.49999999999998, 175.0, 200.0, 188.0, 184.0, 160.7, 189.2, 187.4, 146.60000000000002, 167.6, 174.8, 177.2, 198.2, 193.7, 188.3, 194.6, 192.8, 147.8, 189.2, 189.2, 182.0, 193.7, 195.5, 195.5, 176.6, 200.0, 193.7, 200.0, 96.2, 200.0, 142.39999999999998, 191.9, 191.0, 154.1, 191.0, 175.4, 176.0, 191.0, 173.0, 191.0, 200.0, 188.3, 186.5, 197.3, 186.5, 198.2, 198.2, 200.0, 192.8, -19.900000000000013, 185.0, 177.2, 189.2, -7.30000000000004, 122.6, 178.4, 132.8, 183.8, 170.0, 76.39999999999999, 173.0, 200.0, 167.0, 194.6, 187.4, 200.0, 172.1, 193.7, 193.7, 194.6, 175.4, 164.0, 152.6, 188.0, 200.0, 200.0, 192.0, 185.0, 170.0, 188.0, 195.5, 200.0, 197.3, 198.2, 188.3, 179.0, 186.5, 193.7, 186.5, 192.8, 187.4, 194.6, 148.4, 167.0, 135.2, 192.8, 184.7, 164.0, 185.6, 54.19999999999998, 176.3, 156.2, 167.0, 195.5, 195.5, 193.7, 150.5, 200.0, 27.199999999999974, 11.0, 155.0, 123.0, 0.0, 148.70000000000002, 192.8, 20.000000000000014, 113.6, 200.0, 200.0, 173.9, 199.1, 193.7, 188.0, 172.1, 170.0, 188.0, 154.7, 199.1, 147.2, 191.0, 188.0, 98.9, 200.0, 190.1, 176.0, 154.7, -5.800000000000011, 176.0, 186.2, 174.5, 191.9, 199.1, 200.0, 110.0, 200.0, 112.7, 121.7, 195.5, 197.0, 194.0, 152.9, 191.6, 182.0, 197.3, 119.9, 140.9, 189.2, 188.3, 197.3, 193.0, 58.0, 184.0, 186.0, 160.0, 128.0, 164.0, 193.7, 118.4, 107.0, 200.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 17.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 5.0, 0.0, 0.0, 13.0, 22.0, 0.0, 2.0, 0.0, 0.0, 0.0, 0.0, 15.0, 26.0, 5.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 11.0, 12.0, 4.0, 0.0, 9.0, 6.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 9.0, 0.0, 3.0, 12.0, 11.0, 0.0, 9.0, 12.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 23.0, 19.0, 7.0, 0.0, 46.0, 8.0, 10.0, 19.0, 0.0, 1.0, 20.0, 30.0, 0.0, 11.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 2.0, 5.0, 14.0, 9.0, 4.0, 0.0, 0.0, 0.0, 5.0, 10.0, 2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 3.0, 0.0, 13.0, 14.0, 24.0, 0.0, 0.0, 12.0, 4.0, 23.0, 28.0, 11.0, 10.0, 0.0, 0.0, 6.0, 6.0, 14.0, 13.0, 7.0, 26.0, 0.0, 22.0, 9.0, 8.0, 17.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 13.0, 11.0, 4.0, 11.0, 1.0, 4.0, 0.0, 26.0, 29.0, 8.0, 0.0, 22.0, 26.0, 8.0, 0.0, 0.0, 7.0, 0.0, 0.0, 30.0, 8.0, 19.0, 25.0, 0.0, 1.0, 15.0, 3.0, 0.0, 7.0, 12.0, 10.0, 13.0, 17.0, 0.0, 0.0, 22.0, 1.0, 0.0, 0.0, 18.0, 19.0, 12.0, 0.0, 36.0, 14.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4015472232979638, "mean_inference_ms": 12.998173202155508, "mean_action_processing_ms": 3.8342085047585845, "mean_env_wait_ms": 0.4255860207803554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011815786361694336, "StateBufferConnector_ms": 0.004179716110229492, "ViewRequirementAgentConnector_ms": 0.13785815238952637}, "num_episodes": 27, "episode_return_max": 400.0, "episode_return_min": 145.0, "episode_return_mean": 351.18299999999994, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.87555323365314, "num_env_steps_trained_throughput_per_sec": 267.87555323365314, "timesteps_total": 676000, "num_env_steps_sampled_lifetime": 676000, "num_agent_steps_sampled_lifetime": 2704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2704000, "timers": {"training_iteration_time_ms": 13728.222, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13728.162, "sample_time_ms": 1697.651, "learn_time_ms": 12008.71, "learn_throughput": 333.092, "synch_weights_time_ms": 16.953}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 2704000, "num_agent_steps_trained": 2704000}, "done": false, "training_iteration": 169, "trial_id": "e4caa_00000", "date": "2024-08-13_23-16-37", "timestamp": 1723605397, "time_this_iter_s": 14.976051092147827, "time_total_s": 12724.453360557556, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b2f790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12724.453360557556, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 63.28636363636363, "ram_util_percent": 81.85909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.702099316886493, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.554508278104994, "policy_loss": -0.006941084824157534, "vf_loss": 0.5613533919401191, "vf_explained_var": 0.5842338461724539, "kl": 0.009099426174316009, "entropy": 0.8908842131574318, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 320355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8138815511944433, "cur_kl_coeff": 2.2851610179985277e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6179659614329616, "policy_loss": -0.0016944291681130097, "vf_loss": 0.6196603900974705, "vf_explained_var": 0.07985452290565248, "kl": 0.008052030400672379, "entropy": 0.32710376543500436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 320355.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 145.0, "episode_reward_mean": 352.693, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -19.900000000000013, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 46.0}, "policy_reward_mean": {"prey_policy": 169.6165, "predator_policy": 6.73}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.0, 351.4, 385.4, 382.0, 387.4, 346.0, 379.2, 389.2, 372.1, 393.7, 315.20000000000005, 351.40000000000003, 385.9, 368.1, 360.4, 377.0, 391.0, 374.8, 383.8, 396.4, 392.8, 207.09999999999943, 373.4, 169.29999999999978, 340.2, 354.8, 299.40000000000003, 378.0, 382.0, 381.1, 387.4, 377.0, 339.6, 392.0, 392.0, 370.0, 387.5, 397.3, 386.5, 372.5, 380.2, 383.2, 356.0, 340.2, 377.5, 365.6, 281.49999999999994, 344.2, 391.0, 356.20000000000005, 254.1999999999996, 199.0, 145.0, 358.5, 168.5999999999995, 400.0, 373.0, 385.7, 358.1, 357.7, 358.3, 383.0, 353.9, 374.1, 196.89999999999947, 370.2, 373.4, 399.1, 348.0, 278.4, 393.5, 364.9, 380.6, 339.20000000000005, 360.1, 385.6, 274.0, 370.0, 325.0, 369.7, 275.4, 400.0, 374.8, 372.5, 384.0, 370.3, 350.6, 349.30000000000007, 341.0, 388.6, 400.0, 377.3, 325.1, 354.40000000000003, 390.0, 340.2, 282.0, 396.0, 324.8, 379.4], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [187.4, 146.60000000000002, 167.6, 174.8, 177.2, 198.2, 193.7, 188.3, 194.6, 192.8, 147.8, 189.2, 189.2, 182.0, 193.7, 195.5, 195.5, 176.6, 200.0, 193.7, 200.0, 96.2, 200.0, 142.39999999999998, 191.9, 191.0, 154.1, 191.0, 175.4, 176.0, 191.0, 173.0, 191.0, 200.0, 188.3, 186.5, 197.3, 186.5, 198.2, 198.2, 200.0, 192.8, -19.900000000000013, 185.0, 177.2, 189.2, -7.30000000000004, 122.6, 178.4, 132.8, 183.8, 170.0, 76.39999999999999, 173.0, 200.0, 167.0, 194.6, 187.4, 200.0, 172.1, 193.7, 193.7, 194.6, 175.4, 164.0, 152.6, 188.0, 200.0, 200.0, 192.0, 185.0, 170.0, 188.0, 195.5, 200.0, 197.3, 198.2, 188.3, 179.0, 186.5, 193.7, 186.5, 192.8, 187.4, 194.6, 148.4, 167.0, 135.2, 192.8, 184.7, 164.0, 185.6, 54.19999999999998, 176.3, 156.2, 167.0, 195.5, 195.5, 193.7, 150.5, 200.0, 27.199999999999974, 11.0, 155.0, 123.0, 0.0, 148.70000000000002, 192.8, 20.000000000000014, 113.6, 200.0, 200.0, 173.9, 199.1, 193.7, 188.0, 172.1, 170.0, 188.0, 154.7, 199.1, 147.2, 191.0, 188.0, 98.9, 200.0, 190.1, 176.0, 154.7, -5.800000000000011, 176.0, 186.2, 174.5, 191.9, 199.1, 200.0, 110.0, 200.0, 112.7, 121.7, 195.5, 197.0, 194.0, 152.9, 191.6, 182.0, 197.3, 119.9, 140.9, 189.2, 188.3, 197.3, 193.0, 58.0, 184.0, 186.0, 160.0, 128.0, 164.0, 193.7, 118.4, 107.0, 200.0, 200.0, 196.4, 178.4, 193.7, 171.8, 176.0, 200.0, 152.3, 200.0, 161.0, 176.6, 200.0, 143.3, 146.0, 176.0, 191.0, 194.6, 200.0, 200.0, 188.3, 179.0, 177.8, 110.3, 154.4, 197.0, 200.0, 179.0, 162.2, 158.0, 75.0, 186.0, 200.0, 196.0, 151.7, 151.1, 173.0, 196.4], "policy_predator_policy_reward": [12.0, 4.0, 0.0, 9.0, 6.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 4.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 19.0, 0.0, 0.0, 9.0, 0.0, 3.0, 12.0, 11.0, 0.0, 9.0, 12.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 23.0, 19.0, 7.0, 0.0, 46.0, 8.0, 10.0, 19.0, 0.0, 1.0, 20.0, 30.0, 0.0, 11.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 2.0, 5.0, 14.0, 9.0, 4.0, 0.0, 0.0, 0.0, 5.0, 10.0, 2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 3.0, 0.0, 13.0, 14.0, 24.0, 0.0, 0.0, 12.0, 4.0, 23.0, 28.0, 11.0, 10.0, 0.0, 0.0, 6.0, 6.0, 14.0, 13.0, 7.0, 26.0, 0.0, 22.0, 9.0, 8.0, 17.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 13.0, 11.0, 4.0, 11.0, 1.0, 4.0, 0.0, 26.0, 29.0, 8.0, 0.0, 22.0, 26.0, 8.0, 0.0, 0.0, 7.0, 0.0, 0.0, 30.0, 8.0, 19.0, 25.0, 0.0, 1.0, 15.0, 3.0, 0.0, 7.0, 12.0, 10.0, 13.0, 17.0, 0.0, 0.0, 22.0, 1.0, 0.0, 0.0, 18.0, 19.0, 12.0, 0.0, 36.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 0.0, 9.0, 9.0, 13.0, 0.0, 0.0, 6.0, 1.0, 18.0, 0.0, 3.0, 0.0, 0.0, 4.0, 6.0, 17.0, 20.0, 0.0, 3.0, 4.0, 7.0, 16.0, 4.0, 9.0, 12.0, 0.0, 0.0, 21.0, 1.0, 9.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.390675776641615, "mean_inference_ms": 13.080787257444177, "mean_action_processing_ms": 3.679966738926043, "mean_env_wait_ms": 0.42441474345796165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011879682540893555, "StateBufferConnector_ms": 0.004183769226074219, "ViewRequirementAgentConnector_ms": 0.1359875202178955}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 145.0, "episode_return_mean": 352.693, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.64981014334916, "num_env_steps_trained_throughput_per_sec": 308.64981014334916, "timesteps_total": 680000, "num_env_steps_sampled_lifetime": 680000, "num_agent_steps_sampled_lifetime": 2720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2720000, "timers": {"training_iteration_time_ms": 13738.253, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13738.198, "sample_time_ms": 1700.767, "learn_time_ms": 12016.216, "learn_throughput": 332.884, "synch_weights_time_ms": 17.005}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "done": false, "training_iteration": 170, "trial_id": "e4caa_00000", "date": "2024-08-13_23-16-50", "timestamp": 1723605410, "time_this_iter_s": 13.007030963897705, "time_total_s": 12737.460391521454, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b8f790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12737.460391521454, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 51.85, "ram_util_percent": 79.93333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4752349993539235, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6138211406631858, "policy_loss": -0.006895782096587397, "vf_loss": 0.6206436041131537, "vf_explained_var": 0.4817305724772196, "kl": 0.00695190767609135, "entropy": 0.8880920319014756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 322245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.464201620631117, "cur_kl_coeff": 2.2851610179985277e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6753320980482, "policy_loss": -0.002348311578795787, "vf_loss": 0.677680408803342, "vf_explained_var": 0.12673074599927064, "kl": 0.006127563015333268, "entropy": 0.2859855253623907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 322245.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 145.0, "episode_reward_mean": 352.095, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -19.900000000000013, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 46.0}, "policy_reward_mean": {"prey_policy": 168.5375, "predator_policy": 7.51}, "custom_metrics": {}, "hist_stats": {"episode_reward": [383.8, 396.4, 392.8, 207.09999999999943, 373.4, 169.29999999999978, 340.2, 354.8, 299.40000000000003, 378.0, 382.0, 381.1, 387.4, 377.0, 339.6, 392.0, 392.0, 370.0, 387.5, 397.3, 386.5, 372.5, 380.2, 383.2, 356.0, 340.2, 377.5, 365.6, 281.49999999999994, 344.2, 391.0, 356.20000000000005, 254.1999999999996, 199.0, 145.0, 358.5, 168.5999999999995, 400.0, 373.0, 385.7, 358.1, 357.7, 358.3, 383.0, 353.9, 374.1, 196.89999999999947, 370.2, 373.4, 399.1, 348.0, 278.4, 393.5, 364.9, 380.6, 339.20000000000005, 360.1, 385.6, 274.0, 370.0, 325.0, 369.7, 275.4, 400.0, 374.8, 372.5, 384.0, 370.3, 350.6, 349.30000000000007, 341.0, 388.6, 400.0, 377.3, 325.1, 354.40000000000003, 390.0, 340.2, 282.0, 396.0, 324.8, 379.4, 384.6, 340.0, 381.5, 334.8, 381.7, 343.30000000000007, 381.7, 389.2, 371.2, 319.80000000000007, 333.9, 347.9, 388.1, 394.4, 349.0, 384.0, 391.9, 383.4], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [197.3, 186.5, 198.2, 198.2, 200.0, 192.8, -19.900000000000013, 185.0, 177.2, 189.2, -7.30000000000004, 122.6, 178.4, 132.8, 183.8, 170.0, 76.39999999999999, 173.0, 200.0, 167.0, 194.6, 187.4, 200.0, 172.1, 193.7, 193.7, 194.6, 175.4, 164.0, 152.6, 188.0, 200.0, 200.0, 192.0, 185.0, 170.0, 188.0, 195.5, 200.0, 197.3, 198.2, 188.3, 179.0, 186.5, 193.7, 186.5, 192.8, 187.4, 194.6, 148.4, 167.0, 135.2, 192.8, 184.7, 164.0, 185.6, 54.19999999999998, 176.3, 156.2, 167.0, 195.5, 195.5, 193.7, 150.5, 200.0, 27.199999999999974, 11.0, 155.0, 123.0, 0.0, 148.70000000000002, 192.8, 20.000000000000014, 113.6, 200.0, 200.0, 173.9, 199.1, 193.7, 188.0, 172.1, 170.0, 188.0, 154.7, 199.1, 147.2, 191.0, 188.0, 98.9, 200.0, 190.1, 176.0, 154.7, -5.800000000000011, 176.0, 186.2, 174.5, 191.9, 199.1, 200.0, 110.0, 200.0, 112.7, 121.7, 195.5, 197.0, 194.0, 152.9, 191.6, 182.0, 197.3, 119.9, 140.9, 189.2, 188.3, 197.3, 193.0, 58.0, 184.0, 186.0, 160.0, 128.0, 164.0, 193.7, 118.4, 107.0, 200.0, 200.0, 196.4, 178.4, 193.7, 171.8, 176.0, 200.0, 152.3, 200.0, 161.0, 176.6, 200.0, 143.3, 146.0, 176.0, 191.0, 194.6, 200.0, 200.0, 188.3, 179.0, 177.8, 110.3, 154.4, 197.0, 200.0, 179.0, 162.2, 158.0, 75.0, 186.0, 200.0, 196.0, 151.7, 151.1, 173.0, 196.4, 183.2, 196.4, 185.0, 110.0, 200.0, 174.5, 103.4, 190.4, 193.7, 167.0, 151.4, 191.9, 193.7, 176.0, 196.4, 192.8, 188.3, 182.9, 99.80000000000001, 185.0, 92.0, 191.9, 153.8, 181.1, 200.0, 187.1, 197.0, 196.4, 125.0, 182.0, 184.0, 200.0, 191.9, 200.0, 182.0, 190.4], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 23.0, 19.0, 7.0, 0.0, 46.0, 8.0, 10.0, 19.0, 0.0, 1.0, 20.0, 30.0, 0.0, 11.0, 0.0, 0.0, 0.0, 9.0, 0.0, 0.0, 2.0, 5.0, 14.0, 9.0, 4.0, 0.0, 0.0, 0.0, 5.0, 10.0, 2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 3.0, 0.0, 13.0, 14.0, 24.0, 0.0, 0.0, 12.0, 4.0, 23.0, 28.0, 11.0, 10.0, 0.0, 0.0, 6.0, 6.0, 14.0, 13.0, 7.0, 26.0, 0.0, 22.0, 9.0, 8.0, 17.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 13.0, 11.0, 4.0, 11.0, 1.0, 4.0, 0.0, 26.0, 29.0, 8.0, 0.0, 22.0, 26.0, 8.0, 0.0, 0.0, 7.0, 0.0, 0.0, 30.0, 8.0, 19.0, 25.0, 0.0, 1.0, 15.0, 3.0, 0.0, 7.0, 12.0, 10.0, 13.0, 17.0, 0.0, 0.0, 22.0, 1.0, 0.0, 0.0, 18.0, 19.0, 12.0, 0.0, 36.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 0.0, 9.0, 9.0, 13.0, 0.0, 0.0, 6.0, 1.0, 18.0, 0.0, 3.0, 0.0, 0.0, 4.0, 6.0, 17.0, 20.0, 0.0, 3.0, 4.0, 7.0, 16.0, 4.0, 9.0, 12.0, 0.0, 0.0, 21.0, 1.0, 9.0, 1.0, 5.0, 0.0, 20.0, 25.0, 4.0, 3.0, 27.0, 14.0, 10.0, 11.0, 0.0, 0.0, 5.0, 7.0, 0.0, 0.0, 0.0, 0.0, 17.0, 18.0, 35.0, 15.0, 9.0, 4.0, 0.0, 1.0, 1.0, 0.0, 22.0, 20.0, 0.0, 0.0, 0.0, 0.0, 6.0, 5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3871123668696759, "mean_inference_ms": 13.022694946070665, "mean_action_processing_ms": 3.6618029976094726, "mean_env_wait_ms": 0.42350013236431217, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01156926155090332, "StateBufferConnector_ms": 0.004292130470275879, "ViewRequirementAgentConnector_ms": 0.1288614273071289}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 145.0, "episode_return_mean": 352.095, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.80785287586843, "num_env_steps_trained_throughput_per_sec": 307.80785287586843, "timesteps_total": 684000, "num_env_steps_sampled_lifetime": 684000, "num_agent_steps_sampled_lifetime": 2736000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2736000, "timers": {"training_iteration_time_ms": 13762.342, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13762.289, "sample_time_ms": 1718.691, "learn_time_ms": 12022.66, "learn_throughput": 332.705, "synch_weights_time_ms": 16.696}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 2736000, "num_agent_steps_trained": 2736000}, "done": false, "training_iteration": 171, "trial_id": "e4caa_00000", "date": "2024-08-13_23-17-03", "timestamp": 1723605423, "time_this_iter_s": 13.001769065856934, "time_total_s": 12750.46216058731, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b8f9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12750.46216058731, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 51.83157894736843, "ram_util_percent": 79.30526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.455835872478586, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3963697173901237, "policy_loss": -0.005039615351361809, "vf_loss": 0.40126727600101497, "vf_explained_var": 0.5035488789674466, "kl": 0.013469171764065997, "entropy": 0.8705971623223926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 324135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0948538147189, "cur_kl_coeff": 2.2851610179985277e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3295369110015965, "policy_loss": -0.001802458799389935, "vf_loss": 0.33133937034715294, "vf_explained_var": 0.18730690375206963, "kl": 0.004285260415248818, "entropy": 0.2685712742505881, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 324135.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 145.0, "episode_reward_mean": 355.33099999999996, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5.800000000000011, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 36.0}, "policy_reward_mean": {"prey_policy": 170.47549999999998, "predator_policy": 7.19}, "custom_metrics": {}, "hist_stats": {"episode_reward": [387.5, 397.3, 386.5, 372.5, 380.2, 383.2, 356.0, 340.2, 377.5, 365.6, 281.49999999999994, 344.2, 391.0, 356.20000000000005, 254.1999999999996, 199.0, 145.0, 358.5, 168.5999999999995, 400.0, 373.0, 385.7, 358.1, 357.7, 358.3, 383.0, 353.9, 374.1, 196.89999999999947, 370.2, 373.4, 399.1, 348.0, 278.4, 393.5, 364.9, 380.6, 339.20000000000005, 360.1, 385.6, 274.0, 370.0, 325.0, 369.7, 275.4, 400.0, 374.8, 372.5, 384.0, 370.3, 350.6, 349.30000000000007, 341.0, 388.6, 400.0, 377.3, 325.1, 354.40000000000003, 390.0, 340.2, 282.0, 396.0, 324.8, 379.4, 384.6, 340.0, 381.5, 334.8, 381.7, 343.30000000000007, 381.7, 389.2, 371.2, 319.80000000000007, 333.9, 347.9, 388.1, 394.4, 349.0, 384.0, 391.9, 383.4, 365.7, 381.0, 345.40000000000003, 375.7, 373.8, 383.70000000000005, 384.5, 390.1, 377.7, 375.9, 361.7, 321.30000000000007, 395.5, 383.8, 309.0, 368.0, 379.7, 367.4], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [188.0, 195.5, 200.0, 197.3, 198.2, 188.3, 179.0, 186.5, 193.7, 186.5, 192.8, 187.4, 194.6, 148.4, 167.0, 135.2, 192.8, 184.7, 164.0, 185.6, 54.19999999999998, 176.3, 156.2, 167.0, 195.5, 195.5, 193.7, 150.5, 200.0, 27.199999999999974, 11.0, 155.0, 123.0, 0.0, 148.70000000000002, 192.8, 20.000000000000014, 113.6, 200.0, 200.0, 173.9, 199.1, 193.7, 188.0, 172.1, 170.0, 188.0, 154.7, 199.1, 147.2, 191.0, 188.0, 98.9, 200.0, 190.1, 176.0, 154.7, -5.800000000000011, 176.0, 186.2, 174.5, 191.9, 199.1, 200.0, 110.0, 200.0, 112.7, 121.7, 195.5, 197.0, 194.0, 152.9, 191.6, 182.0, 197.3, 119.9, 140.9, 189.2, 188.3, 197.3, 193.0, 58.0, 184.0, 186.0, 160.0, 128.0, 164.0, 193.7, 118.4, 107.0, 200.0, 200.0, 196.4, 178.4, 193.7, 171.8, 176.0, 200.0, 152.3, 200.0, 161.0, 176.6, 200.0, 143.3, 146.0, 176.0, 191.0, 194.6, 200.0, 200.0, 188.3, 179.0, 177.8, 110.3, 154.4, 197.0, 200.0, 179.0, 162.2, 158.0, 75.0, 186.0, 200.0, 196.0, 151.7, 151.1, 173.0, 196.4, 183.2, 196.4, 185.0, 110.0, 200.0, 174.5, 103.4, 190.4, 193.7, 167.0, 151.4, 191.9, 193.7, 176.0, 196.4, 192.8, 188.3, 182.9, 99.80000000000001, 185.0, 92.0, 191.9, 153.8, 181.1, 200.0, 187.1, 197.0, 196.4, 125.0, 182.0, 184.0, 200.0, 191.9, 200.0, 182.0, 190.4, 166.1, 185.6, 191.0, 179.0, 142.39999999999998, 191.0, 190.7, 176.0, 162.8, 194.0, 185.0, 193.7, 189.8, 193.7, 191.0, 199.1, 198.2, 171.5, 200.0, 167.9, 163.7, 182.0, 128.3, 182.0, 195.5, 200.0, 189.2, 194.6, 153.0, 113.0, 200.0, 152.0, 193.7, 179.0, 163.7, 193.7], "policy_predator_policy_reward": [2.0, 2.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 3.0, 0.0, 13.0, 14.0, 24.0, 0.0, 0.0, 12.0, 4.0, 23.0, 28.0, 11.0, 10.0, 0.0, 0.0, 6.0, 6.0, 14.0, 13.0, 7.0, 26.0, 0.0, 22.0, 9.0, 8.0, 17.0, 18.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 3.0, 13.0, 11.0, 4.0, 11.0, 1.0, 4.0, 0.0, 26.0, 29.0, 8.0, 0.0, 22.0, 26.0, 8.0, 0.0, 0.0, 7.0, 0.0, 0.0, 30.0, 8.0, 19.0, 25.0, 0.0, 1.0, 15.0, 3.0, 0.0, 7.0, 12.0, 10.0, 13.0, 17.0, 0.0, 0.0, 22.0, 1.0, 0.0, 0.0, 18.0, 19.0, 12.0, 0.0, 36.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 0.0, 9.0, 9.0, 13.0, 0.0, 0.0, 6.0, 1.0, 18.0, 0.0, 3.0, 0.0, 0.0, 4.0, 6.0, 17.0, 20.0, 0.0, 3.0, 4.0, 7.0, 16.0, 4.0, 9.0, 12.0, 0.0, 0.0, 21.0, 1.0, 9.0, 1.0, 5.0, 0.0, 20.0, 25.0, 4.0, 3.0, 27.0, 14.0, 10.0, 11.0, 0.0, 0.0, 5.0, 7.0, 0.0, 0.0, 0.0, 0.0, 17.0, 18.0, 35.0, 15.0, 9.0, 4.0, 0.0, 1.0, 1.0, 0.0, 22.0, 20.0, 0.0, 0.0, 0.0, 0.0, 6.0, 5.0, 2.0, 12.0, 9.0, 2.0, 9.0, 3.0, 9.0, 0.0, 8.0, 9.0, 5.0, 0.0, 1.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 8.0, 15.0, 1.0, 9.0, 2.0, 0.0, 0.0, 0.0, 0.0, 15.0, 28.0, 16.0, 0.0, 0.0, 7.0, 9.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3835913914860247, "mean_inference_ms": 12.965521070139234, "mean_action_processing_ms": 3.643846929156537, "mean_env_wait_ms": 0.42263344839502426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01615118980407715, "StateBufferConnector_ms": 0.004912972450256348, "ViewRequirementAgentConnector_ms": 0.12900972366333008}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 145.0, "episode_return_mean": 355.33099999999996, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.1661959320024, "num_env_steps_trained_throughput_per_sec": 302.1661959320024, "timesteps_total": 688000, "num_env_steps_sampled_lifetime": 688000, "num_agent_steps_sampled_lifetime": 2752000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2752000, "timers": {"training_iteration_time_ms": 13727.151, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13727.106, "sample_time_ms": 1666.962, "learn_time_ms": 12039.555, "learn_throughput": 332.238, "synch_weights_time_ms": 16.606}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 2752000, "num_agent_steps_trained": 2752000}, "done": false, "training_iteration": 172, "trial_id": "e4caa_00000", "date": "2024-08-13_23-17-16", "timestamp": 1723605436, "time_this_iter_s": 13.242713928222656, "time_total_s": 12763.704874515533, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b8fd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12763.704874515533, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 48.538888888888884, "ram_util_percent": 79.36666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.642496630628273, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4824768101295121, "policy_loss": -0.012794158709723325, "vf_loss": 0.4951743676194123, "vf_explained_var": 0.5274311364958526, "kl": 0.009159144955128009, "entropy": 0.8659414093961161, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 326025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0180232649127012, "cur_kl_coeff": 1.1425805089992638e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3522794208829365, "policy_loss": -0.0036048359350946847, "vf_loss": 0.35588425705381843, "vf_explained_var": 0.15771366982232957, "kl": 0.043619271150076244, "entropy": 0.2967243188588077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 326025.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 196.89999999999947, "episode_reward_mean": 362.86799999999994, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -5.800000000000011, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 36.0}, "policy_reward_mean": {"prey_policy": 174.71400000000003, "predator_policy": 6.72}, "custom_metrics": {}, "hist_stats": {"episode_reward": [357.7, 358.3, 383.0, 353.9, 374.1, 196.89999999999947, 370.2, 373.4, 399.1, 348.0, 278.4, 393.5, 364.9, 380.6, 339.20000000000005, 360.1, 385.6, 274.0, 370.0, 325.0, 369.7, 275.4, 400.0, 374.8, 372.5, 384.0, 370.3, 350.6, 349.30000000000007, 341.0, 388.6, 400.0, 377.3, 325.1, 354.40000000000003, 390.0, 340.2, 282.0, 396.0, 324.8, 379.4, 384.6, 340.0, 381.5, 334.8, 381.7, 343.30000000000007, 381.7, 389.2, 371.2, 319.80000000000007, 333.9, 347.9, 388.1, 394.4, 349.0, 384.0, 391.9, 383.4, 365.7, 381.0, 345.40000000000003, 375.7, 373.8, 383.70000000000005, 384.5, 390.1, 377.7, 375.9, 361.7, 321.30000000000007, 395.5, 383.8, 309.0, 368.0, 379.7, 367.4, 323.6, 375.70000000000005, 389.0, 339.3, 338.6, 373.7, 400.0, 368.8, 363.2, 379.1, 374.2, 396.4, 360.6, 372.1, 362.7, 400.0, 386.5, 364.0, 314.0, 366.0, 385.7, 391.9, 390.1], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [188.0, 154.7, 199.1, 147.2, 191.0, 188.0, 98.9, 200.0, 190.1, 176.0, 154.7, -5.800000000000011, 176.0, 186.2, 174.5, 191.9, 199.1, 200.0, 110.0, 200.0, 112.7, 121.7, 195.5, 197.0, 194.0, 152.9, 191.6, 182.0, 197.3, 119.9, 140.9, 189.2, 188.3, 197.3, 193.0, 58.0, 184.0, 186.0, 160.0, 128.0, 164.0, 193.7, 118.4, 107.0, 200.0, 200.0, 196.4, 178.4, 193.7, 171.8, 176.0, 200.0, 152.3, 200.0, 161.0, 176.6, 200.0, 143.3, 146.0, 176.0, 191.0, 194.6, 200.0, 200.0, 188.3, 179.0, 177.8, 110.3, 154.4, 197.0, 200.0, 179.0, 162.2, 158.0, 75.0, 186.0, 200.0, 196.0, 151.7, 151.1, 173.0, 196.4, 183.2, 196.4, 185.0, 110.0, 200.0, 174.5, 103.4, 190.4, 193.7, 167.0, 151.4, 191.9, 193.7, 176.0, 196.4, 192.8, 188.3, 182.9, 99.80000000000001, 185.0, 92.0, 191.9, 153.8, 181.1, 200.0, 187.1, 197.0, 196.4, 125.0, 182.0, 184.0, 200.0, 191.9, 200.0, 182.0, 190.4, 166.1, 185.6, 191.0, 179.0, 142.39999999999998, 191.0, 190.7, 176.0, 162.8, 194.0, 185.0, 193.7, 189.8, 193.7, 191.0, 199.1, 198.2, 171.5, 200.0, 167.9, 163.7, 182.0, 128.3, 182.0, 195.5, 200.0, 189.2, 194.6, 153.0, 113.0, 200.0, 152.0, 193.7, 179.0, 163.7, 193.7, 136.4, 156.2, 199.1, 176.6, 191.0, 197.0, 127.39999999999999, 191.9, 113.6, 173.0, 166.1, 194.6, 200.0, 200.0, 174.8, 182.0, 160.1, 190.1, 172.1, 197.0, 191.0, 171.2, 196.4, 200.0, 187.4, 165.2, 194.6, 177.5, 181.4, 170.3, 200.0, 200.0, 190.1, 196.4, 176.0, 176.0, 186.0, 110.0, 179.0, 179.0, 188.0, 193.7, 194.6, 197.3, 191.9, 198.2], "policy_predator_policy_reward": [11.0, 4.0, 11.0, 1.0, 4.0, 0.0, 26.0, 29.0, 8.0, 0.0, 22.0, 26.0, 8.0, 0.0, 0.0, 7.0, 0.0, 0.0, 30.0, 8.0, 19.0, 25.0, 0.0, 1.0, 15.0, 3.0, 0.0, 7.0, 12.0, 10.0, 13.0, 17.0, 0.0, 0.0, 22.0, 1.0, 0.0, 0.0, 18.0, 19.0, 12.0, 0.0, 36.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 0.0, 9.0, 9.0, 13.0, 0.0, 0.0, 6.0, 1.0, 18.0, 0.0, 3.0, 0.0, 0.0, 4.0, 6.0, 17.0, 20.0, 0.0, 3.0, 4.0, 7.0, 16.0, 4.0, 9.0, 12.0, 0.0, 0.0, 21.0, 1.0, 9.0, 1.0, 5.0, 0.0, 20.0, 25.0, 4.0, 3.0, 27.0, 14.0, 10.0, 11.0, 0.0, 0.0, 5.0, 7.0, 0.0, 0.0, 0.0, 0.0, 17.0, 18.0, 35.0, 15.0, 9.0, 4.0, 0.0, 1.0, 1.0, 0.0, 22.0, 20.0, 0.0, 0.0, 0.0, 0.0, 6.0, 5.0, 2.0, 12.0, 9.0, 2.0, 9.0, 3.0, 9.0, 0.0, 8.0, 9.0, 5.0, 0.0, 1.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 8.0, 15.0, 1.0, 9.0, 2.0, 0.0, 0.0, 0.0, 0.0, 15.0, 28.0, 16.0, 0.0, 0.0, 7.0, 9.0, 1.0, 17.0, 14.0, 0.0, 0.0, 0.0, 1.0, 5.0, 15.0, 25.0, 27.0, 5.0, 8.0, 0.0, 0.0, 12.0, 0.0, 0.0, 13.0, 0.0, 10.0, 9.0, 3.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 18.0, 0.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3753944047676765, "mean_inference_ms": 12.611685734837605, "mean_action_processing_ms": 3.769321963240235, "mean_env_wait_ms": 0.42120582610766877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012039780616760254, "StateBufferConnector_ms": 0.0048732757568359375, "ViewRequirementAgentConnector_ms": 0.12020325660705566}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 196.89999999999947, "episode_return_mean": 362.86799999999994, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.74456101686417, "num_env_steps_trained_throughput_per_sec": 310.74456101686417, "timesteps_total": 692000, "num_env_steps_sampled_lifetime": 692000, "num_agent_steps_sampled_lifetime": 2768000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2768000, "timers": {"training_iteration_time_ms": 13690.714, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13690.67, "sample_time_ms": 1661.536, "learn_time_ms": 12008.762, "learn_throughput": 333.09, "synch_weights_time_ms": 16.407}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 2768000, "num_agent_steps_trained": 2768000}, "done": false, "training_iteration": 173, "trial_id": "e4caa_00000", "date": "2024-08-13_23-17-29", "timestamp": 1723605449, "time_this_iter_s": 12.87854790687561, "time_total_s": 12776.583422422409, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2987dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12776.583422422409, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 47.96315789473683, "ram_util_percent": 79.48421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5877842397601516, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.43270409677163657, "policy_loss": -0.00851774856241213, "vf_loss": 0.4410633678791956, "vf_explained_var": 0.4211538731421112, "kl": 0.015025958588299497, "entropy": 0.8172316843870455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 327915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5710142838891852, "cur_kl_coeff": 1.7138707634988943e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3823570152123769, "policy_loss": -0.002347342808183933, "vf_loss": 0.38470435785400686, "vf_explained_var": 0.08838259789048049, "kl": 0.009752038619528551, "entropy": 0.3372919142719299, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 327915.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 282.0, "episode_reward_mean": 368.42900000000003, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 75.0, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 35.0}, "policy_reward_mean": {"prey_policy": 178.7345, "predator_policy": 5.48}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, 374.8, 372.5, 384.0, 370.3, 350.6, 349.30000000000007, 341.0, 388.6, 400.0, 377.3, 325.1, 354.40000000000003, 390.0, 340.2, 282.0, 396.0, 324.8, 379.4, 384.6, 340.0, 381.5, 334.8, 381.7, 343.30000000000007, 381.7, 389.2, 371.2, 319.80000000000007, 333.9, 347.9, 388.1, 394.4, 349.0, 384.0, 391.9, 383.4, 365.7, 381.0, 345.40000000000003, 375.7, 373.8, 383.70000000000005, 384.5, 390.1, 377.7, 375.9, 361.7, 321.30000000000007, 395.5, 383.8, 309.0, 368.0, 379.7, 367.4, 323.6, 375.70000000000005, 389.0, 339.3, 338.6, 373.7, 400.0, 368.8, 363.2, 379.1, 374.2, 396.4, 360.6, 372.1, 362.7, 400.0, 386.5, 364.0, 314.0, 366.0, 385.7, 391.9, 390.1, 378.0, 370.0, 358.5, 370.1, 384.7, 359.9, 337.2, 375.7, 366.4, 350.5, 368.2, 400.0, 350.8, 380.3, 368.5, 386.8, 378.8, 394.6, 387.0, 374.0, 376.1, 371.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 200.0, 196.4, 178.4, 193.7, 171.8, 176.0, 200.0, 152.3, 200.0, 161.0, 176.6, 200.0, 143.3, 146.0, 176.0, 191.0, 194.6, 200.0, 200.0, 188.3, 179.0, 177.8, 110.3, 154.4, 197.0, 200.0, 179.0, 162.2, 158.0, 75.0, 186.0, 200.0, 196.0, 151.7, 151.1, 173.0, 196.4, 183.2, 196.4, 185.0, 110.0, 200.0, 174.5, 103.4, 190.4, 193.7, 167.0, 151.4, 191.9, 193.7, 176.0, 196.4, 192.8, 188.3, 182.9, 99.80000000000001, 185.0, 92.0, 191.9, 153.8, 181.1, 200.0, 187.1, 197.0, 196.4, 125.0, 182.0, 184.0, 200.0, 191.9, 200.0, 182.0, 190.4, 166.1, 185.6, 191.0, 179.0, 142.39999999999998, 191.0, 190.7, 176.0, 162.8, 194.0, 185.0, 193.7, 189.8, 193.7, 191.0, 199.1, 198.2, 171.5, 200.0, 167.9, 163.7, 182.0, 128.3, 182.0, 195.5, 200.0, 189.2, 194.6, 153.0, 113.0, 200.0, 152.0, 193.7, 179.0, 163.7, 193.7, 136.4, 156.2, 199.1, 176.6, 191.0, 197.0, 127.39999999999999, 191.9, 113.6, 173.0, 166.1, 194.6, 200.0, 200.0, 174.8, 182.0, 160.1, 190.1, 172.1, 197.0, 191.0, 171.2, 196.4, 200.0, 187.4, 165.2, 194.6, 177.5, 181.4, 170.3, 200.0, 200.0, 190.1, 196.4, 176.0, 176.0, 186.0, 110.0, 179.0, 179.0, 188.0, 193.7, 194.6, 197.3, 191.9, 198.2, 182.0, 185.0, 155.0, 200.0, 153.5, 191.0, 184.1, 176.0, 200.0, 184.7, 137.9, 200.0, 129.2, 185.0, 188.3, 187.4, 182.0, 178.4, 178.4, 145.1, 176.6, 185.6, 200.0, 200.0, 157.7, 190.1, 188.0, 188.3, 179.3, 180.2, 196.4, 187.4, 179.0, 192.8, 200.0, 194.6, 191.0, 196.0, 181.0, 185.0, 175.4, 193.7, 155.0, 200.0], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 0.0, 9.0, 9.0, 13.0, 0.0, 0.0, 6.0, 1.0, 18.0, 0.0, 3.0, 0.0, 0.0, 4.0, 6.0, 17.0, 20.0, 0.0, 3.0, 4.0, 7.0, 16.0, 4.0, 9.0, 12.0, 0.0, 0.0, 21.0, 1.0, 9.0, 1.0, 5.0, 0.0, 20.0, 25.0, 4.0, 3.0, 27.0, 14.0, 10.0, 11.0, 0.0, 0.0, 5.0, 7.0, 0.0, 0.0, 0.0, 0.0, 17.0, 18.0, 35.0, 15.0, 9.0, 4.0, 0.0, 1.0, 1.0, 0.0, 22.0, 20.0, 0.0, 0.0, 0.0, 0.0, 6.0, 5.0, 2.0, 12.0, 9.0, 2.0, 9.0, 3.0, 9.0, 0.0, 8.0, 9.0, 5.0, 0.0, 1.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 8.0, 15.0, 1.0, 9.0, 2.0, 0.0, 0.0, 0.0, 0.0, 15.0, 28.0, 16.0, 0.0, 0.0, 7.0, 9.0, 1.0, 17.0, 14.0, 0.0, 0.0, 0.0, 1.0, 5.0, 15.0, 25.0, 27.0, 5.0, 8.0, 0.0, 0.0, 12.0, 0.0, 0.0, 13.0, 0.0, 10.0, 9.0, 3.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 18.0, 0.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 15.0, 0.0, 14.0, 0.0, 10.0, 0.0, 0.0, 7.0, 15.0, 1.0, 22.0, 0.0, 0.0, 6.0, 0.0, 10.0, 17.0, 6.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 7.0, 1.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.37471138591681, "mean_inference_ms": 12.826120423269476, "mean_action_processing_ms": 3.600389624828705, "mean_env_wait_ms": 0.420260505365174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009103059768676758, "StateBufferConnector_ms": 0.0041495561599731445, "ViewRequirementAgentConnector_ms": 0.10739266872406006}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 282.0, "episode_return_mean": 368.42900000000003, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.53271288118816, "num_env_steps_trained_throughput_per_sec": 297.53271288118816, "timesteps_total": 696000, "num_env_steps_sampled_lifetime": 696000, "num_agent_steps_sampled_lifetime": 2784000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2784000, "timers": {"training_iteration_time_ms": 13733.949, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13733.906, "sample_time_ms": 1668.056, "learn_time_ms": 12045.584, "learn_throughput": 332.072, "synch_weights_time_ms": 16.115}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 2784000, "num_agent_steps_trained": 2784000}, "done": false, "training_iteration": 174, "trial_id": "e4caa_00000", "date": "2024-08-13_23-17-43", "timestamp": 1723605463, "time_this_iter_s": 13.480636835098267, "time_total_s": 12790.064059257507, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2c22f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12790.064059257507, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 49.68421052631579, "ram_util_percent": 79.73684210526315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4555154923881803, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6394269603665206, "policy_loss": -0.006976977167109017, "vf_loss": 0.6462718584027792, "vf_explained_var": 0.46656075006439574, "kl": 0.012523043197591488, "entropy": 0.7589140327203842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 329805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7086787030179664, "cur_kl_coeff": 1.7138707634988943e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7362825363401383, "policy_loss": -0.0014322984626112634, "vf_loss": 0.7377148346689643, "vf_explained_var": 0.03756587104822593, "kl": 0.009107403002903471, "entropy": 0.37102042395601825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 329805.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 223.7, "episode_reward_mean": 367.69999999999993, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 57.19999999999998, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 36.0}, "policy_reward_mean": {"prey_policy": 177.87, "predator_policy": 5.98}, "custom_metrics": {}, "hist_stats": {"episode_reward": [379.4, 384.6, 340.0, 381.5, 334.8, 381.7, 343.30000000000007, 381.7, 389.2, 371.2, 319.80000000000007, 333.9, 347.9, 388.1, 394.4, 349.0, 384.0, 391.9, 383.4, 365.7, 381.0, 345.40000000000003, 375.7, 373.8, 383.70000000000005, 384.5, 390.1, 377.7, 375.9, 361.7, 321.30000000000007, 395.5, 383.8, 309.0, 368.0, 379.7, 367.4, 323.6, 375.70000000000005, 389.0, 339.3, 338.6, 373.7, 400.0, 368.8, 363.2, 379.1, 374.2, 396.4, 360.6, 372.1, 362.7, 400.0, 386.5, 364.0, 314.0, 366.0, 385.7, 391.9, 390.1, 378.0, 370.0, 358.5, 370.1, 384.7, 359.9, 337.2, 375.7, 366.4, 350.5, 368.2, 400.0, 350.8, 380.3, 368.5, 386.8, 378.8, 394.6, 387.0, 374.0, 376.1, 371.0, 368.8, 223.7, 386.6, 370.4, 388.1, 335.1, 390.4, 356.6, 345.0, 359.4, 361.9, 383.8, 322.5, 358.6, 384.0, 361.0, 391.7, 360.4], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [173.0, 196.4, 183.2, 196.4, 185.0, 110.0, 200.0, 174.5, 103.4, 190.4, 193.7, 167.0, 151.4, 191.9, 193.7, 176.0, 196.4, 192.8, 188.3, 182.9, 99.80000000000001, 185.0, 92.0, 191.9, 153.8, 181.1, 200.0, 187.1, 197.0, 196.4, 125.0, 182.0, 184.0, 200.0, 191.9, 200.0, 182.0, 190.4, 166.1, 185.6, 191.0, 179.0, 142.39999999999998, 191.0, 190.7, 176.0, 162.8, 194.0, 185.0, 193.7, 189.8, 193.7, 191.0, 199.1, 198.2, 171.5, 200.0, 167.9, 163.7, 182.0, 128.3, 182.0, 195.5, 200.0, 189.2, 194.6, 153.0, 113.0, 200.0, 152.0, 193.7, 179.0, 163.7, 193.7, 136.4, 156.2, 199.1, 176.6, 191.0, 197.0, 127.39999999999999, 191.9, 113.6, 173.0, 166.1, 194.6, 200.0, 200.0, 174.8, 182.0, 160.1, 190.1, 172.1, 197.0, 191.0, 171.2, 196.4, 200.0, 187.4, 165.2, 194.6, 177.5, 181.4, 170.3, 200.0, 200.0, 190.1, 196.4, 176.0, 176.0, 186.0, 110.0, 179.0, 179.0, 188.0, 193.7, 194.6, 197.3, 191.9, 198.2, 182.0, 185.0, 155.0, 200.0, 153.5, 191.0, 184.1, 176.0, 200.0, 184.7, 137.9, 200.0, 129.2, 185.0, 188.3, 187.4, 182.0, 178.4, 178.4, 145.1, 176.6, 185.6, 200.0, 200.0, 157.7, 190.1, 188.0, 188.3, 179.3, 180.2, 196.4, 187.4, 179.0, 192.8, 200.0, 194.6, 191.0, 196.0, 181.0, 185.0, 175.4, 193.7, 155.0, 200.0, 186.5, 179.3, 105.5, 57.19999999999998, 194.6, 188.0, 200.0, 157.4, 200.0, 166.1, 108.5, 194.6, 187.4, 200.0, 173.0, 173.6, 129.2, 192.8, 178.4, 170.0, 188.3, 152.6, 195.5, 188.3, 171.5, 104.0, 194.6, 143.0, 194.0, 185.0, 155.0, 191.0, 190.7, 200.0, 178.7, 175.7], "policy_predator_policy_reward": [9.0, 1.0, 5.0, 0.0, 20.0, 25.0, 4.0, 3.0, 27.0, 14.0, 10.0, 11.0, 0.0, 0.0, 5.0, 7.0, 0.0, 0.0, 0.0, 0.0, 17.0, 18.0, 35.0, 15.0, 9.0, 4.0, 0.0, 1.0, 1.0, 0.0, 22.0, 20.0, 0.0, 0.0, 0.0, 0.0, 6.0, 5.0, 2.0, 12.0, 9.0, 2.0, 9.0, 3.0, 9.0, 0.0, 8.0, 9.0, 5.0, 0.0, 1.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 8.0, 15.0, 1.0, 9.0, 2.0, 0.0, 0.0, 0.0, 0.0, 15.0, 28.0, 16.0, 0.0, 0.0, 7.0, 9.0, 1.0, 17.0, 14.0, 0.0, 0.0, 0.0, 1.0, 5.0, 15.0, 25.0, 27.0, 5.0, 8.0, 0.0, 0.0, 12.0, 0.0, 0.0, 13.0, 0.0, 10.0, 9.0, 3.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 18.0, 0.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 15.0, 0.0, 14.0, 0.0, 10.0, 0.0, 0.0, 7.0, 15.0, 1.0, 22.0, 0.0, 0.0, 6.0, 0.0, 10.0, 17.0, 6.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 7.0, 1.0, 15.0, 0.0, 3.0, 36.0, 25.0, 4.0, 0.0, 6.0, 7.0, 11.0, 11.0, 17.0, 15.0, 3.0, 0.0, 0.0, 10.0, 23.0, 0.0, 8.0, 3.0, 10.0, 11.0, 0.0, 0.0, 20.0, 27.0, 2.0, 19.0, 5.0, 0.0, 0.0, 15.0, 0.0, 1.0, 0.0, 6.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3711004988735027, "mean_inference_ms": 12.769736880604677, "mean_action_processing_ms": 3.582889119963223, "mean_env_wait_ms": 0.41924956331125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009033203125, "StateBufferConnector_ms": 0.004117131233215332, "ViewRequirementAgentConnector_ms": 0.11463057994842529}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 223.7, "episode_return_mean": 367.69999999999993, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.3063925269362, "num_env_steps_trained_throughput_per_sec": 301.3063925269362, "timesteps_total": 700000, "num_env_steps_sampled_lifetime": 700000, "num_agent_steps_sampled_lifetime": 2800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2800000, "timers": {"training_iteration_time_ms": 13744.979, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13744.936, "sample_time_ms": 1653.114, "learn_time_ms": 12071.595, "learn_throughput": 331.356, "synch_weights_time_ms": 16.418}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "done": false, "training_iteration": 175, "trial_id": "e4caa_00000", "date": "2024-08-13_23-17-56", "timestamp": 1723605476, "time_this_iter_s": 13.328866004943848, "time_total_s": 12803.392925262451, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b8fd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12803.392925262451, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 52.85263157894737, "ram_util_percent": 81.91578947368419}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.42984116653759, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.26726231064229206, "policy_loss": -0.005083643884161517, "vf_loss": 0.2722674008535847, "vf_explained_var": 0.3864854688682253, "kl": 0.007448014595995152, "entropy": 0.7075646270519842, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 331695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9486371398050949, "cur_kl_coeff": 1.7138707634988943e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1996953443668428, "policy_loss": -0.002547816932694149, "vf_loss": 0.20224316140418755, "vf_explained_var": 0.022696411420428563, "kl": 0.015611868612640335, "entropy": 0.2984234275168212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 331695.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 223.7, "episode_reward_mean": 369.2289999999999, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 57.19999999999998, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 36.0}, "policy_reward_mean": {"prey_policy": 179.0395, "predator_policy": 5.575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [383.4, 365.7, 381.0, 345.40000000000003, 375.7, 373.8, 383.70000000000005, 384.5, 390.1, 377.7, 375.9, 361.7, 321.30000000000007, 395.5, 383.8, 309.0, 368.0, 379.7, 367.4, 323.6, 375.70000000000005, 389.0, 339.3, 338.6, 373.7, 400.0, 368.8, 363.2, 379.1, 374.2, 396.4, 360.6, 372.1, 362.7, 400.0, 386.5, 364.0, 314.0, 366.0, 385.7, 391.9, 390.1, 378.0, 370.0, 358.5, 370.1, 384.7, 359.9, 337.2, 375.7, 366.4, 350.5, 368.2, 400.0, 350.8, 380.3, 368.5, 386.8, 378.8, 394.6, 387.0, 374.0, 376.1, 371.0, 368.8, 223.7, 386.6, 370.4, 388.1, 335.1, 390.4, 356.6, 345.0, 359.4, 361.9, 383.8, 322.5, 358.6, 384.0, 361.0, 391.7, 360.4, 391.9, 376.1, 364.9, 400.0, 393.5, 364.4, 394.6, 383.6, 359.1, 371.4, 327.90000000000003, 400.0, 349.6, 390.1, 379.0, 384.0, 381.2, 338.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [182.0, 190.4, 166.1, 185.6, 191.0, 179.0, 142.39999999999998, 191.0, 190.7, 176.0, 162.8, 194.0, 185.0, 193.7, 189.8, 193.7, 191.0, 199.1, 198.2, 171.5, 200.0, 167.9, 163.7, 182.0, 128.3, 182.0, 195.5, 200.0, 189.2, 194.6, 153.0, 113.0, 200.0, 152.0, 193.7, 179.0, 163.7, 193.7, 136.4, 156.2, 199.1, 176.6, 191.0, 197.0, 127.39999999999999, 191.9, 113.6, 173.0, 166.1, 194.6, 200.0, 200.0, 174.8, 182.0, 160.1, 190.1, 172.1, 197.0, 191.0, 171.2, 196.4, 200.0, 187.4, 165.2, 194.6, 177.5, 181.4, 170.3, 200.0, 200.0, 190.1, 196.4, 176.0, 176.0, 186.0, 110.0, 179.0, 179.0, 188.0, 193.7, 194.6, 197.3, 191.9, 198.2, 182.0, 185.0, 155.0, 200.0, 153.5, 191.0, 184.1, 176.0, 200.0, 184.7, 137.9, 200.0, 129.2, 185.0, 188.3, 187.4, 182.0, 178.4, 178.4, 145.1, 176.6, 185.6, 200.0, 200.0, 157.7, 190.1, 188.0, 188.3, 179.3, 180.2, 196.4, 187.4, 179.0, 192.8, 200.0, 194.6, 191.0, 196.0, 181.0, 185.0, 175.4, 193.7, 155.0, 200.0, 186.5, 179.3, 105.5, 57.19999999999998, 194.6, 188.0, 200.0, 157.4, 200.0, 166.1, 108.5, 194.6, 187.4, 200.0, 173.0, 173.6, 129.2, 192.8, 178.4, 170.0, 188.3, 152.6, 195.5, 188.3, 171.5, 104.0, 194.6, 143.0, 194.0, 185.0, 155.0, 191.0, 190.7, 200.0, 178.7, 175.7, 191.9, 200.0, 199.1, 170.0, 186.5, 178.4, 200.0, 200.0, 197.0, 195.5, 178.4, 179.0, 200.0, 194.6, 191.0, 191.6, 200.0, 139.1, 173.0, 187.4, 86.9, 191.0, 200.0, 200.0, 182.3, 140.3, 200.0, 190.1, 170.0, 197.0, 195.0, 179.0, 191.9, 185.3, 119.0, 167.0], "policy_predator_policy_reward": [6.0, 5.0, 2.0, 12.0, 9.0, 2.0, 9.0, 3.0, 9.0, 0.0, 8.0, 9.0, 5.0, 0.0, 1.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 8.0, 15.0, 1.0, 9.0, 2.0, 0.0, 0.0, 0.0, 0.0, 15.0, 28.0, 16.0, 0.0, 0.0, 7.0, 9.0, 1.0, 17.0, 14.0, 0.0, 0.0, 0.0, 1.0, 5.0, 15.0, 25.0, 27.0, 5.0, 8.0, 0.0, 0.0, 12.0, 0.0, 0.0, 13.0, 0.0, 10.0, 9.0, 3.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 18.0, 0.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 15.0, 0.0, 14.0, 0.0, 10.0, 0.0, 0.0, 7.0, 15.0, 1.0, 22.0, 0.0, 0.0, 6.0, 0.0, 10.0, 17.0, 6.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 7.0, 1.0, 15.0, 0.0, 3.0, 36.0, 25.0, 4.0, 0.0, 6.0, 7.0, 11.0, 11.0, 17.0, 15.0, 3.0, 0.0, 0.0, 10.0, 23.0, 0.0, 8.0, 3.0, 10.0, 11.0, 0.0, 0.0, 20.0, 27.0, 2.0, 19.0, 5.0, 0.0, 0.0, 15.0, 0.0, 1.0, 0.0, 6.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 1.0, 20.0, 0.0, 6.0, 5.0, 21.0, 29.0, 0.0, 0.0, 21.0, 6.0, 0.0, 0.0, 1.0, 11.0, 4.0, 6.0, 4.0, 0.0, 20.0, 32.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3675282157346742, "mean_inference_ms": 12.713949337173482, "mean_action_processing_ms": 3.5655959533515023, "mean_env_wait_ms": 0.41824198727760176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008970260620117188, "StateBufferConnector_ms": 0.004046916961669922, "ViewRequirementAgentConnector_ms": 0.11626672744750977}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 223.7, "episode_return_mean": 369.2289999999999, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.30657650958045, "num_env_steps_trained_throughput_per_sec": 302.30657650958045, "timesteps_total": 704000, "num_env_steps_sampled_lifetime": 704000, "num_agent_steps_sampled_lifetime": 2816000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2816000, "timers": {"training_iteration_time_ms": 13748.949, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13748.906, "sample_time_ms": 1663.678, "learn_time_ms": 12065.711, "learn_throughput": 331.518, "synch_weights_time_ms": 16.201}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 2816000, "num_agent_steps_trained": 2816000}, "done": false, "training_iteration": 176, "trial_id": "e4caa_00000", "date": "2024-08-13_23-18-09", "timestamp": 1723605489, "time_this_iter_s": 13.29548692703247, "time_total_s": 12816.688412189484, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2dee3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12816.688412189484, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 53.96842105263157, "ram_util_percent": 83.53684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6554184485364842, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9718321053914863, "policy_loss": -0.007591284029727812, "vf_loss": 0.9793551769363817, "vf_explained_var": 0.5198359182902745, "kl": 0.0064675621481965866, "entropy": 0.7569370887582264, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 333585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.314915583050125, "cur_kl_coeff": 1.7138707634988943e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.40875984274205707, "policy_loss": -0.0013199730266240382, "vf_loss": 0.41007981509729113, "vf_explained_var": 0.15020625871956034, "kl": 0.008980905848908432, "entropy": 0.3155499437025615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 333585.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 82.99999999999991, "episode_reward_mean": 367.21200000000005, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 1.0999999999999865, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 36.0}, "policy_reward_mean": {"prey_policy": 178.141, "predator_policy": 5.465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [367.4, 323.6, 375.70000000000005, 389.0, 339.3, 338.6, 373.7, 400.0, 368.8, 363.2, 379.1, 374.2, 396.4, 360.6, 372.1, 362.7, 400.0, 386.5, 364.0, 314.0, 366.0, 385.7, 391.9, 390.1, 378.0, 370.0, 358.5, 370.1, 384.7, 359.9, 337.2, 375.7, 366.4, 350.5, 368.2, 400.0, 350.8, 380.3, 368.5, 386.8, 378.8, 394.6, 387.0, 374.0, 376.1, 371.0, 368.8, 223.7, 386.6, 370.4, 388.1, 335.1, 390.4, 356.6, 345.0, 359.4, 361.9, 383.8, 322.5, 358.6, 384.0, 361.0, 391.7, 360.4, 391.9, 376.1, 364.9, 400.0, 393.5, 364.4, 394.6, 383.6, 359.1, 371.4, 327.90000000000003, 400.0, 349.6, 390.1, 379.0, 384.0, 381.2, 338.0, 392.8, 400.0, 385.6, 337.6, 382.0, 394.6, 334.4, 82.99999999999991, 384.7, 336.4, 392.8, 384.7, 379.3, 393.29999999999995, 329.0, 350.0, 400.0, 394.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [163.7, 193.7, 136.4, 156.2, 199.1, 176.6, 191.0, 197.0, 127.39999999999999, 191.9, 113.6, 173.0, 166.1, 194.6, 200.0, 200.0, 174.8, 182.0, 160.1, 190.1, 172.1, 197.0, 191.0, 171.2, 196.4, 200.0, 187.4, 165.2, 194.6, 177.5, 181.4, 170.3, 200.0, 200.0, 190.1, 196.4, 176.0, 176.0, 186.0, 110.0, 179.0, 179.0, 188.0, 193.7, 194.6, 197.3, 191.9, 198.2, 182.0, 185.0, 155.0, 200.0, 153.5, 191.0, 184.1, 176.0, 200.0, 184.7, 137.9, 200.0, 129.2, 185.0, 188.3, 187.4, 182.0, 178.4, 178.4, 145.1, 176.6, 185.6, 200.0, 200.0, 157.7, 190.1, 188.0, 188.3, 179.3, 180.2, 196.4, 187.4, 179.0, 192.8, 200.0, 194.6, 191.0, 196.0, 181.0, 185.0, 175.4, 193.7, 155.0, 200.0, 186.5, 179.3, 105.5, 57.19999999999998, 194.6, 188.0, 200.0, 157.4, 200.0, 166.1, 108.5, 194.6, 187.4, 200.0, 173.0, 173.6, 129.2, 192.8, 178.4, 170.0, 188.3, 152.6, 195.5, 188.3, 171.5, 104.0, 194.6, 143.0, 194.0, 185.0, 155.0, 191.0, 190.7, 200.0, 178.7, 175.7, 191.9, 200.0, 199.1, 170.0, 186.5, 178.4, 200.0, 200.0, 197.0, 195.5, 178.4, 179.0, 200.0, 194.6, 191.0, 191.6, 200.0, 139.1, 173.0, 187.4, 86.9, 191.0, 200.0, 200.0, 182.3, 140.3, 200.0, 190.1, 170.0, 197.0, 195.0, 179.0, 191.9, 185.3, 119.0, 167.0, 195.5, 197.3, 200.0, 200.0, 193.7, 191.9, 146.6, 167.0, 191.0, 191.0, 199.1, 195.5, 172.1, 131.3, 62.89999999999998, 1.0999999999999865, 200.0, 184.7, 135.2, 174.2, 200.0, 192.8, 200.0, 184.7, 197.3, 173.0, 198.2, 193.1, 199.0, 117.0, 188.0, 123.0, 200.0, 200.0, 191.0, 200.0], "policy_predator_policy_reward": [9.0, 1.0, 17.0, 14.0, 0.0, 0.0, 0.0, 1.0, 5.0, 15.0, 25.0, 27.0, 5.0, 8.0, 0.0, 0.0, 12.0, 0.0, 0.0, 13.0, 0.0, 10.0, 9.0, 3.0, 0.0, 0.0, 0.0, 8.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 12.0, 18.0, 0.0, 8.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 6.0, 0.0, 15.0, 0.0, 14.0, 0.0, 10.0, 0.0, 0.0, 7.0, 15.0, 1.0, 22.0, 0.0, 0.0, 6.0, 0.0, 10.0, 17.0, 6.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 7.0, 1.0, 15.0, 0.0, 3.0, 36.0, 25.0, 4.0, 0.0, 6.0, 7.0, 11.0, 11.0, 17.0, 15.0, 3.0, 0.0, 0.0, 10.0, 23.0, 0.0, 8.0, 3.0, 10.0, 11.0, 0.0, 0.0, 20.0, 27.0, 2.0, 19.0, 5.0, 0.0, 0.0, 15.0, 0.0, 1.0, 0.0, 6.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 1.0, 20.0, 0.0, 6.0, 5.0, 21.0, 29.0, 0.0, 0.0, 21.0, 6.0, 0.0, 0.0, 1.0, 11.0, 4.0, 6.0, 4.0, 0.0, 20.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 13.0, 19.0, 0.0, 0.0, 0.0, 15.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 2.0, 0.0, 13.0, 17.0, 22.0, 0.0, 0.0, 0.0, 3.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3640285361733546, "mean_inference_ms": 12.658658779158245, "mean_action_processing_ms": 3.548501434957045, "mean_env_wait_ms": 0.4172315491607143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004298806190490723, "StateBufferConnector_ms": 0.003278374671936035, "ViewRequirementAgentConnector_ms": 0.11323654651641846}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 82.99999999999991, "episode_return_mean": 367.21200000000005, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.5268453527928, "num_env_steps_trained_throughput_per_sec": 303.5268453527928, "timesteps_total": 708000, "num_env_steps_sampled_lifetime": 708000, "num_agent_steps_sampled_lifetime": 2832000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2832000, "timers": {"training_iteration_time_ms": 13413.615, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13413.573, "sample_time_ms": 1668.036, "learn_time_ms": 11726.666, "learn_throughput": 341.103, "synch_weights_time_ms": 15.871}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 2832000, "num_agent_steps_trained": 2832000}, "done": false, "training_iteration": 177, "trial_id": "e4caa_00000", "date": "2024-08-13_23-18-23", "timestamp": 1723605503, "time_this_iter_s": 13.227825164794922, "time_total_s": 12829.916237354279, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2dee5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12829.916237354279, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 49.777777777777786, "ram_util_percent": 83.57222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.664942557092697, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7139401735746543, "policy_loss": -0.007945106149449077, "vf_loss": 0.7218153095513424, "vf_explained_var": 0.48748171465106743, "kl": 0.006634374371517075, "entropy": 0.6949664917572466, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 335475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.940014902482588, "cur_kl_coeff": 1.7138707634988943e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7418655838758227, "policy_loss": -0.0015838796351716, "vf_loss": 0.7434494620947926, "vf_explained_var": 0.08910849293073018, "kl": 0.007338038611055496, "entropy": 0.29968323763558474, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 335475.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 82.99999999999991, "episode_reward_mean": 364.61699999999996, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 1.0999999999999865, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 36.0}, "policy_reward_mean": {"prey_policy": 176.74349999999998, "predator_policy": 5.565}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.1, 384.7, 359.9, 337.2, 375.7, 366.4, 350.5, 368.2, 400.0, 350.8, 380.3, 368.5, 386.8, 378.8, 394.6, 387.0, 374.0, 376.1, 371.0, 368.8, 223.7, 386.6, 370.4, 388.1, 335.1, 390.4, 356.6, 345.0, 359.4, 361.9, 383.8, 322.5, 358.6, 384.0, 361.0, 391.7, 360.4, 391.9, 376.1, 364.9, 400.0, 393.5, 364.4, 394.6, 383.6, 359.1, 371.4, 327.90000000000003, 400.0, 349.6, 390.1, 379.0, 384.0, 381.2, 338.0, 392.8, 400.0, 385.6, 337.6, 382.0, 394.6, 334.4, 82.99999999999991, 384.7, 336.4, 392.8, 384.7, 379.3, 393.29999999999995, 329.0, 350.0, 400.0, 394.0, 388.3, 361.0, 384.4, 395.5, 372.8, 318.1, 310.3, 390.0, 391.0, 347.8, 390.1, 380.0, 201.29999999999941, 353.6, 351.6, 373.2, 382.2, 355.4, 378.4, 387.4, 378.2, 392.0, 363.0, 293.0, 372.9, 368.2, 349.9], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [184.1, 176.0, 200.0, 184.7, 137.9, 200.0, 129.2, 185.0, 188.3, 187.4, 182.0, 178.4, 178.4, 145.1, 176.6, 185.6, 200.0, 200.0, 157.7, 190.1, 188.0, 188.3, 179.3, 180.2, 196.4, 187.4, 179.0, 192.8, 200.0, 194.6, 191.0, 196.0, 181.0, 185.0, 175.4, 193.7, 155.0, 200.0, 186.5, 179.3, 105.5, 57.19999999999998, 194.6, 188.0, 200.0, 157.4, 200.0, 166.1, 108.5, 194.6, 187.4, 200.0, 173.0, 173.6, 129.2, 192.8, 178.4, 170.0, 188.3, 152.6, 195.5, 188.3, 171.5, 104.0, 194.6, 143.0, 194.0, 185.0, 155.0, 191.0, 190.7, 200.0, 178.7, 175.7, 191.9, 200.0, 199.1, 170.0, 186.5, 178.4, 200.0, 200.0, 197.0, 195.5, 178.4, 179.0, 200.0, 194.6, 191.0, 191.6, 200.0, 139.1, 173.0, 187.4, 86.9, 191.0, 200.0, 200.0, 182.3, 140.3, 200.0, 190.1, 170.0, 197.0, 195.0, 179.0, 191.9, 185.3, 119.0, 167.0, 195.5, 197.3, 200.0, 200.0, 193.7, 191.9, 146.6, 167.0, 191.0, 191.0, 199.1, 195.5, 172.1, 131.3, 62.89999999999998, 1.0999999999999865, 200.0, 184.7, 135.2, 174.2, 200.0, 192.8, 200.0, 184.7, 197.3, 173.0, 198.2, 193.1, 199.0, 117.0, 188.0, 123.0, 200.0, 200.0, 191.0, 200.0, 192.8, 195.5, 155.0, 185.0, 196.39999999999998, 182.0, 195.5, 200.0, 183.8, 179.0, 200.0, 109.1, 151.4, 134.9, 200.0, 185.0, 200.0, 191.0, 176.0, 162.8, 200.0, 190.1, 185.0, 185.0, 174.2, 19.1, 189.8, 132.8, 190.1, 144.5, 200.0, 156.2, 185.0, 192.2, 152.0, 187.4, 188.3, 190.1, 200.0, 187.4, 182.0, 189.2, 200.0, 192.0, 185.0, 163.0, 64.0, 197.0, 189.2, 178.7, 198.2, 143.0, 198.2, 130.7], "policy_predator_policy_reward": [0.0, 10.0, 0.0, 0.0, 7.0, 15.0, 1.0, 22.0, 0.0, 0.0, 6.0, 0.0, 10.0, 17.0, 6.0, 0.0, 0.0, 0.0, 0.0, 3.0, 4.0, 0.0, 0.0, 9.0, 3.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 7.0, 1.0, 15.0, 0.0, 3.0, 36.0, 25.0, 4.0, 0.0, 6.0, 7.0, 11.0, 11.0, 17.0, 15.0, 3.0, 0.0, 0.0, 10.0, 23.0, 0.0, 8.0, 3.0, 10.0, 11.0, 0.0, 0.0, 20.0, 27.0, 2.0, 19.0, 5.0, 0.0, 0.0, 15.0, 0.0, 1.0, 0.0, 6.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 1.0, 20.0, 0.0, 6.0, 5.0, 21.0, 29.0, 0.0, 0.0, 21.0, 6.0, 0.0, 0.0, 1.0, 11.0, 4.0, 6.0, 4.0, 0.0, 20.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 13.0, 19.0, 0.0, 0.0, 0.0, 15.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 2.0, 0.0, 13.0, 17.0, 22.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 8.0, 13.0, 0.0, 6.0, 0.0, 0.0, 6.0, 4.0, 9.0, 0.0, 0.0, 24.0, 5.0, 0.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 8.0, 14.0, 17.0, 17.0, 0.0, 14.0, 3.0, 5.0, 0.0, 11.0, 5.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 9.0, 6.0, 16.0, 16.0, 5.0, 0.0, 16.0, 11.0, 0.0, 21.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3659649932204538, "mean_inference_ms": 12.446184973946213, "mean_action_processing_ms": 3.652825925456581, "mean_env_wait_ms": 0.41601426839503647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005016207695007324, "StateBufferConnector_ms": 0.0038080215454101562, "ViewRequirementAgentConnector_ms": 0.12799930572509766}, "num_episodes": 27, "episode_return_max": 400.0, "episode_return_min": 82.99999999999991, "episode_return_mean": 364.61699999999996, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.06278662467287, "num_env_steps_trained_throughput_per_sec": 302.06278662467287, "timesteps_total": 712000, "num_env_steps_sampled_lifetime": 712000, "num_agent_steps_sampled_lifetime": 2848000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2848000, "timers": {"training_iteration_time_ms": 13336.894, "restore_workers_time_ms": 0.013, "training_step_time_ms": 13336.853, "sample_time_ms": 1629.422, "learn_time_ms": 11688.139, "learn_throughput": 342.227, "synch_weights_time_ms": 16.49}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 2848000, "num_agent_steps_trained": 2848000}, "done": false, "training_iteration": 178, "trial_id": "e4caa_00000", "date": "2024-08-13_23-18-36", "timestamp": 1723605516, "time_this_iter_s": 13.281368732452393, "time_total_s": 12843.197606086731, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2dee940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12843.197606086731, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 52.61578947368421, "ram_util_percent": 83.44210526315791}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6057899504111557, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.46800394038307586, "policy_loss": -0.009825757422568228, "vf_loss": 0.4777749691680862, "vf_explained_var": 0.5687951810145504, "kl": 0.005189216020264621, "entropy": 0.7466140821812645, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 337365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6850086416201617, "cur_kl_coeff": 1.7138707634988943e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3256229189337877, "policy_loss": -0.002538124517976213, "vf_loss": 0.3281610437131748, "vf_explained_var": 0.08578230883709337, "kl": 0.02044426510187409, "entropy": 0.2704239025712013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 337365.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 82.99999999999991, "episode_reward_mean": 364.53, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 1.0999999999999865, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 36.0}, "policy_reward_mean": {"prey_policy": 176.38, "predator_policy": 5.885}, "custom_metrics": {}, "hist_stats": {"episode_reward": [371.0, 368.8, 223.7, 386.6, 370.4, 388.1, 335.1, 390.4, 356.6, 345.0, 359.4, 361.9, 383.8, 322.5, 358.6, 384.0, 361.0, 391.7, 360.4, 391.9, 376.1, 364.9, 400.0, 393.5, 364.4, 394.6, 383.6, 359.1, 371.4, 327.90000000000003, 400.0, 349.6, 390.1, 379.0, 384.0, 381.2, 338.0, 392.8, 400.0, 385.6, 337.6, 382.0, 394.6, 334.4, 82.99999999999991, 384.7, 336.4, 392.8, 384.7, 379.3, 393.29999999999995, 329.0, 350.0, 400.0, 394.0, 388.3, 361.0, 384.4, 395.5, 372.8, 318.1, 310.3, 390.0, 391.0, 347.8, 390.1, 380.0, 201.29999999999941, 353.6, 351.6, 373.2, 382.2, 355.4, 378.4, 387.4, 378.2, 392.0, 363.0, 293.0, 372.9, 368.2, 349.9, 388.3, 396.4, 356.0, 397.3, 379.1, 364.2, 332.0, 390.1, 343.8, 379.5, 359.2, 373.5, 385.6, 394.4, 312.0, 391.0, 376.1, 382.4], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [155.0, 200.0, 186.5, 179.3, 105.5, 57.19999999999998, 194.6, 188.0, 200.0, 157.4, 200.0, 166.1, 108.5, 194.6, 187.4, 200.0, 173.0, 173.6, 129.2, 192.8, 178.4, 170.0, 188.3, 152.6, 195.5, 188.3, 171.5, 104.0, 194.6, 143.0, 194.0, 185.0, 155.0, 191.0, 190.7, 200.0, 178.7, 175.7, 191.9, 200.0, 199.1, 170.0, 186.5, 178.4, 200.0, 200.0, 197.0, 195.5, 178.4, 179.0, 200.0, 194.6, 191.0, 191.6, 200.0, 139.1, 173.0, 187.4, 86.9, 191.0, 200.0, 200.0, 182.3, 140.3, 200.0, 190.1, 170.0, 197.0, 195.0, 179.0, 191.9, 185.3, 119.0, 167.0, 195.5, 197.3, 200.0, 200.0, 193.7, 191.9, 146.6, 167.0, 191.0, 191.0, 199.1, 195.5, 172.1, 131.3, 62.89999999999998, 1.0999999999999865, 200.0, 184.7, 135.2, 174.2, 200.0, 192.8, 200.0, 184.7, 197.3, 173.0, 198.2, 193.1, 199.0, 117.0, 188.0, 123.0, 200.0, 200.0, 191.0, 200.0, 192.8, 195.5, 155.0, 185.0, 196.39999999999998, 182.0, 195.5, 200.0, 183.8, 179.0, 200.0, 109.1, 151.4, 134.9, 200.0, 185.0, 200.0, 191.0, 176.0, 162.8, 200.0, 190.1, 185.0, 185.0, 174.2, 19.1, 189.8, 132.8, 190.1, 144.5, 200.0, 156.2, 185.0, 192.2, 152.0, 187.4, 188.3, 190.1, 200.0, 187.4, 182.0, 189.2, 200.0, 192.0, 185.0, 163.0, 64.0, 197.0, 189.2, 178.7, 198.2, 143.0, 198.2, 130.7, 192.8, 195.5, 199.1, 197.3, 200.0, 134.0, 197.3, 200.0, 184.1, 185.0, 197.3, 158.9, 107.0, 182.0, 198.2, 191.9, 179.0, 129.8, 189.5, 185.0, 170.9, 176.3, 200.0, 162.5, 200.0, 185.6, 197.0, 196.4, 116.0, 167.0, 199.0, 192.0, 190.1, 170.0, 175.4, 200.0], "policy_predator_policy_reward": [1.0, 15.0, 0.0, 3.0, 36.0, 25.0, 4.0, 0.0, 6.0, 7.0, 11.0, 11.0, 17.0, 15.0, 3.0, 0.0, 0.0, 10.0, 23.0, 0.0, 8.0, 3.0, 10.0, 11.0, 0.0, 0.0, 20.0, 27.0, 2.0, 19.0, 5.0, 0.0, 0.0, 15.0, 0.0, 1.0, 0.0, 6.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 1.0, 20.0, 0.0, 6.0, 5.0, 21.0, 29.0, 0.0, 0.0, 21.0, 6.0, 0.0, 0.0, 1.0, 11.0, 4.0, 6.0, 4.0, 0.0, 20.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 13.0, 19.0, 0.0, 0.0, 0.0, 15.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 2.0, 0.0, 13.0, 17.0, 22.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 8.0, 13.0, 0.0, 6.0, 0.0, 0.0, 6.0, 4.0, 9.0, 0.0, 0.0, 24.0, 5.0, 0.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 8.0, 14.0, 17.0, 17.0, 0.0, 14.0, 3.0, 5.0, 0.0, 11.0, 5.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 9.0, 6.0, 16.0, 16.0, 5.0, 0.0, 16.0, 11.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 5.0, 5.0, 8.0, 0.0, 24.0, 19.0, 0.0, 0.0, 22.0, 13.0, 5.0, 0.0, 12.0, 0.0, 11.0, 0.0, 0.0, 0.0, 1.0, 0.0, 26.0, 3.0, 0.0, 0.0, 7.0, 9.0, 7.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3557072208225571, "mean_inference_ms": 12.526252997956117, "mean_action_processing_ms": 3.507248824030611, "mean_env_wait_ms": 0.4148142840609505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004940509796142578, "StateBufferConnector_ms": 0.004473328590393066, "ViewRequirementAgentConnector_ms": 0.12565112113952637}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 82.99999999999991, "episode_return_mean": 364.53, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.8650669255109, "num_env_steps_trained_throughput_per_sec": 299.8650669255109, "timesteps_total": 716000, "num_env_steps_sampled_lifetime": 716000, "num_agent_steps_sampled_lifetime": 2864000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2864000, "timers": {"training_iteration_time_ms": 13177.596, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13177.555, "sample_time_ms": 1603.049, "learn_time_ms": 11555.837, "learn_throughput": 346.145, "synch_weights_time_ms": 16.135}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 2864000, "num_agent_steps_trained": 2864000}, "done": false, "training_iteration": 179, "trial_id": "e4caa_00000", "date": "2024-08-13_23-18-49", "timestamp": 1723605529, "time_this_iter_s": 13.366651773452759, "time_total_s": 12856.564257860184, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2c22e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12856.564257860184, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 48.72631578947368, "ram_util_percent": 83.04210526315791}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.634949006920769, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9680029237948398, "policy_loss": -0.006964163744462427, "vf_loss": 0.9748530660908689, "vf_explained_var": 0.7100806940169562, "kl": 0.010810720264495692, "entropy": 0.7360072713680368, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 339255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9525929082717214, "cur_kl_coeff": 2.570806145248342e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.13015537008657932, "policy_loss": -0.0006320955872378022, "vf_loss": 0.1307874656354432, "vf_explained_var": 0.126621517302498, "kl": 0.017159978802274007, "entropy": 0.3565164933996226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 339255.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 82.99999999999991, "episode_reward_mean": 363.703, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 1.0999999999999865, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 32.0}, "policy_reward_mean": {"prey_policy": 176.7365, "predator_policy": 5.115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.4, 391.9, 376.1, 364.9, 400.0, 393.5, 364.4, 394.6, 383.6, 359.1, 371.4, 327.90000000000003, 400.0, 349.6, 390.1, 379.0, 384.0, 381.2, 338.0, 392.8, 400.0, 385.6, 337.6, 382.0, 394.6, 334.4, 82.99999999999991, 384.7, 336.4, 392.8, 384.7, 379.3, 393.29999999999995, 329.0, 350.0, 400.0, 394.0, 388.3, 361.0, 384.4, 395.5, 372.8, 318.1, 310.3, 390.0, 391.0, 347.8, 390.1, 380.0, 201.29999999999941, 353.6, 351.6, 373.2, 382.2, 355.4, 378.4, 387.4, 378.2, 392.0, 363.0, 293.0, 372.9, 368.2, 349.9, 388.3, 396.4, 356.0, 397.3, 379.1, 364.2, 332.0, 390.1, 343.8, 379.5, 359.2, 373.5, 385.6, 394.4, 312.0, 391.0, 376.1, 382.4, 389.7, 200.99999999999935, 369.1, 385.5, 363.6, 376.6, 206.49999999999932, 376.4, 381.9, 353.9, 350.5, 385.6, 378.4, 379.1, 368.0, 363.0, 357.0, 390.1], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [178.7, 175.7, 191.9, 200.0, 199.1, 170.0, 186.5, 178.4, 200.0, 200.0, 197.0, 195.5, 178.4, 179.0, 200.0, 194.6, 191.0, 191.6, 200.0, 139.1, 173.0, 187.4, 86.9, 191.0, 200.0, 200.0, 182.3, 140.3, 200.0, 190.1, 170.0, 197.0, 195.0, 179.0, 191.9, 185.3, 119.0, 167.0, 195.5, 197.3, 200.0, 200.0, 193.7, 191.9, 146.6, 167.0, 191.0, 191.0, 199.1, 195.5, 172.1, 131.3, 62.89999999999998, 1.0999999999999865, 200.0, 184.7, 135.2, 174.2, 200.0, 192.8, 200.0, 184.7, 197.3, 173.0, 198.2, 193.1, 199.0, 117.0, 188.0, 123.0, 200.0, 200.0, 191.0, 200.0, 192.8, 195.5, 155.0, 185.0, 196.39999999999998, 182.0, 195.5, 200.0, 183.8, 179.0, 200.0, 109.1, 151.4, 134.9, 200.0, 185.0, 200.0, 191.0, 176.0, 162.8, 200.0, 190.1, 185.0, 185.0, 174.2, 19.1, 189.8, 132.8, 190.1, 144.5, 200.0, 156.2, 185.0, 192.2, 152.0, 187.4, 188.3, 190.1, 200.0, 187.4, 182.0, 189.2, 200.0, 192.0, 185.0, 163.0, 64.0, 197.0, 189.2, 178.7, 198.2, 143.0, 198.2, 130.7, 192.8, 195.5, 199.1, 197.3, 200.0, 134.0, 197.3, 200.0, 184.1, 185.0, 197.3, 158.9, 107.0, 182.0, 198.2, 191.9, 179.0, 129.8, 189.5, 185.0, 170.9, 176.3, 200.0, 162.5, 200.0, 185.6, 197.0, 196.4, 116.0, 167.0, 199.0, 192.0, 190.1, 170.0, 175.4, 200.0, 193.7, 188.0, 167.0, 20.000000000000014, 180.2, 182.9, 185.0, 195.5, 167.0, 185.6, 194.6, 173.0, 20.000000000000014, 186.5, 175.4, 191.0, 200.0, 176.9, 178.1, 150.8, 173.3, 162.2, 200.0, 185.6, 178.4, 200.0, 190.4, 184.7, 178.0, 180.0, 185.0, 160.0, 179.0, 164.0, 190.1, 200.0], "policy_predator_policy_reward": [0.0, 6.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 1.0, 20.0, 0.0, 6.0, 5.0, 21.0, 29.0, 0.0, 0.0, 21.0, 6.0, 0.0, 0.0, 1.0, 11.0, 4.0, 6.0, 4.0, 0.0, 20.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 13.0, 19.0, 0.0, 0.0, 0.0, 15.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 2.0, 0.0, 13.0, 17.0, 22.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 8.0, 13.0, 0.0, 6.0, 0.0, 0.0, 6.0, 4.0, 9.0, 0.0, 0.0, 24.0, 5.0, 0.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 8.0, 14.0, 17.0, 17.0, 0.0, 14.0, 3.0, 5.0, 0.0, 11.0, 5.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 9.0, 6.0, 16.0, 16.0, 5.0, 0.0, 16.0, 11.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 5.0, 5.0, 8.0, 0.0, 24.0, 19.0, 0.0, 0.0, 22.0, 13.0, 5.0, 0.0, 12.0, 0.0, 11.0, 0.0, 0.0, 0.0, 1.0, 0.0, 26.0, 3.0, 0.0, 0.0, 7.0, 9.0, 7.0, 0.0, 4.0, 4.0, 8.0, 6.0, 0.0, 6.0, 0.0, 5.0, 5.0, 6.0, 0.0, 9.0, 0.0, 0.0, 7.0, 3.0, 0.0, 5.0, 4.0, 21.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 1.0, 9.0, 13.0, 5.0, 14.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.352286942832287, "mean_inference_ms": 12.47302960819271, "mean_action_processing_ms": 3.490728772065049, "mean_env_wait_ms": 0.4138668207766139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005008220672607422, "StateBufferConnector_ms": 0.00446009635925293, "ViewRequirementAgentConnector_ms": 0.1227421760559082}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 82.99999999999991, "episode_return_mean": 363.703, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.26152922727044, "num_env_steps_trained_throughput_per_sec": 302.26152922727044, "timesteps_total": 720000, "num_env_steps_sampled_lifetime": 720000, "num_agent_steps_sampled_lifetime": 2880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2880000, "timers": {"training_iteration_time_ms": 13204.987, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13204.944, "sample_time_ms": 1597.054, "learn_time_ms": 11589.347, "learn_throughput": 345.145, "synch_weights_time_ms": 15.882}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "done": false, "training_iteration": 180, "trial_id": "e4caa_00000", "date": "2024-08-13_23-19-03", "timestamp": 1723605543, "time_this_iter_s": 13.280848979949951, "time_total_s": 12869.845106840134, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2987e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12869.845106840134, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 50.58421052631579, "ram_util_percent": 83.2421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6866738301736337, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.1850626487344031, "policy_loss": -0.0129786077187096, "vf_loss": 1.1979684484698785, "vf_explained_var": 0.7349638173189112, "kl": 0.006902813053763705, "entropy": 0.7286394905476343, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 341145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.789172494427237, "cur_kl_coeff": 2.570806145248342e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.501223197618805, "policy_loss": -0.001966954640817469, "vf_loss": 0.50319015085845, "vf_explained_var": 0.07222997262364342, "kl": 0.018912679887661297, "entropy": 0.3585229143973381, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 341145.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 82.99999999999991, "episode_reward_mean": 358.56200000000007, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 1.0999999999999865, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 32.0}, "policy_reward_mean": {"prey_policy": 174.416, "predator_policy": 4.865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [338.0, 392.8, 400.0, 385.6, 337.6, 382.0, 394.6, 334.4, 82.99999999999991, 384.7, 336.4, 392.8, 384.7, 379.3, 393.29999999999995, 329.0, 350.0, 400.0, 394.0, 388.3, 361.0, 384.4, 395.5, 372.8, 318.1, 310.3, 390.0, 391.0, 347.8, 390.1, 380.0, 201.29999999999941, 353.6, 351.6, 373.2, 382.2, 355.4, 378.4, 387.4, 378.2, 392.0, 363.0, 293.0, 372.9, 368.2, 349.9, 388.3, 396.4, 356.0, 397.3, 379.1, 364.2, 332.0, 390.1, 343.8, 379.5, 359.2, 373.5, 385.6, 394.4, 312.0, 391.0, 376.1, 382.4, 389.7, 200.99999999999935, 369.1, 385.5, 363.6, 376.6, 206.49999999999932, 376.4, 381.9, 353.9, 350.5, 385.6, 378.4, 379.1, 368.0, 363.0, 357.0, 390.1, 397.3, 392.8, 105.20000000000005, 392.8, 387.5, 356.8, 389.0, 364.2, 392.6, 350.2, 395.5, 235.1, 219.99999999999926, 364.0, 400.0, 359.0, 366.8, 388.8], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [119.0, 167.0, 195.5, 197.3, 200.0, 200.0, 193.7, 191.9, 146.6, 167.0, 191.0, 191.0, 199.1, 195.5, 172.1, 131.3, 62.89999999999998, 1.0999999999999865, 200.0, 184.7, 135.2, 174.2, 200.0, 192.8, 200.0, 184.7, 197.3, 173.0, 198.2, 193.1, 199.0, 117.0, 188.0, 123.0, 200.0, 200.0, 191.0, 200.0, 192.8, 195.5, 155.0, 185.0, 196.39999999999998, 182.0, 195.5, 200.0, 183.8, 179.0, 200.0, 109.1, 151.4, 134.9, 200.0, 185.0, 200.0, 191.0, 176.0, 162.8, 200.0, 190.1, 185.0, 185.0, 174.2, 19.1, 189.8, 132.8, 190.1, 144.5, 200.0, 156.2, 185.0, 192.2, 152.0, 187.4, 188.3, 190.1, 200.0, 187.4, 182.0, 189.2, 200.0, 192.0, 185.0, 163.0, 64.0, 197.0, 189.2, 178.7, 198.2, 143.0, 198.2, 130.7, 192.8, 195.5, 199.1, 197.3, 200.0, 134.0, 197.3, 200.0, 184.1, 185.0, 197.3, 158.9, 107.0, 182.0, 198.2, 191.9, 179.0, 129.8, 189.5, 185.0, 170.9, 176.3, 200.0, 162.5, 200.0, 185.6, 197.0, 196.4, 116.0, 167.0, 199.0, 192.0, 190.1, 170.0, 175.4, 200.0, 193.7, 188.0, 167.0, 20.000000000000014, 180.2, 182.9, 185.0, 195.5, 167.0, 185.6, 194.6, 173.0, 20.000000000000014, 186.5, 175.4, 191.0, 200.0, 176.9, 178.1, 150.8, 173.3, 162.2, 200.0, 185.6, 178.4, 200.0, 190.4, 184.7, 178.0, 180.0, 185.0, 160.0, 179.0, 164.0, 190.1, 200.0, 197.3, 200.0, 200.0, 192.8, 78.49999999999997, 16.699999999999996, 200.0, 192.8, 200.0, 183.5, 136.1, 193.7, 198.2, 189.8, 200.0, 147.2, 194.6, 197.0, 172.1, 166.1, 200.0, 195.5, 109.99999999999997, 124.1, 20.000000000000014, 200.0, 182.0, 170.0, 200.0, 200.0, 168.0, 176.0, 192.8, 170.0, 196.4, 190.4], "policy_predator_policy_reward": [20.0, 32.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 24.0, 0.0, 0.0, 0.0, 0.0, 0.0, 18.0, 13.0, 19.0, 0.0, 0.0, 0.0, 15.0, 12.0, 0.0, 0.0, 0.0, 0.0, 0.0, 9.0, 0.0, 2.0, 0.0, 13.0, 17.0, 22.0, 0.0, 0.0, 0.0, 3.0, 0.0, 0.0, 8.0, 13.0, 0.0, 6.0, 0.0, 0.0, 6.0, 4.0, 9.0, 0.0, 0.0, 24.0, 5.0, 0.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 8.0, 14.0, 17.0, 17.0, 0.0, 14.0, 3.0, 5.0, 0.0, 11.0, 5.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 9.0, 6.0, 16.0, 16.0, 5.0, 0.0, 16.0, 11.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 5.0, 5.0, 8.0, 0.0, 24.0, 19.0, 0.0, 0.0, 22.0, 13.0, 5.0, 0.0, 12.0, 0.0, 11.0, 0.0, 0.0, 0.0, 1.0, 0.0, 26.0, 3.0, 0.0, 0.0, 7.0, 9.0, 7.0, 0.0, 4.0, 4.0, 8.0, 6.0, 0.0, 6.0, 0.0, 5.0, 5.0, 6.0, 0.0, 9.0, 0.0, 0.0, 7.0, 3.0, 0.0, 5.0, 4.0, 21.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 1.0, 9.0, 13.0, 5.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 4.0, 20.0, 7.0, 1.0, 0.0, 17.0, 0.0, 1.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 15.0, 0.0, 4.0, 0.0, 2.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3488971245554984, "mean_inference_ms": 12.420375631361104, "mean_action_processing_ms": 3.4743718647960993, "mean_env_wait_ms": 0.41292141936070625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053414106369018555, "StateBufferConnector_ms": 0.004409313201904297, "ViewRequirementAgentConnector_ms": 0.11778533458709717}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 82.99999999999991, "episode_return_mean": 358.56200000000007, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.6642608983213, "num_env_steps_trained_throughput_per_sec": 302.6642608983213, "timesteps_total": 724000, "num_env_steps_sampled_lifetime": 724000, "num_agent_steps_sampled_lifetime": 2896000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2896000, "timers": {"training_iteration_time_ms": 13227.071, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13227.028, "sample_time_ms": 1588.99, "learn_time_ms": 11618.718, "learn_throughput": 344.272, "synch_weights_time_ms": 16.785}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 2896000, "num_agent_steps_trained": 2896000}, "done": false, "training_iteration": 181, "trial_id": "e4caa_00000", "date": "2024-08-13_23-19-16", "timestamp": 1723605556, "time_this_iter_s": 13.26116394996643, "time_total_s": 12883.1062707901, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d5a790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12883.1062707901, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 50.652631578947364, "ram_util_percent": 83.41052631578945}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6392041805559996, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7340922911666216, "policy_loss": -0.010040012022194567, "vf_loss": 0.7440740348391787, "vf_explained_var": 0.6621003770323658, "kl": 0.005524946242205496, "entropy": 0.6943852977147178, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 343035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.356850168960435, "cur_kl_coeff": 2.570806145248342e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7522044514379804, "policy_loss": -0.0011603461536603473, "vf_loss": 0.7533647976066701, "vf_explained_var": 0.045763761782772326, "kl": 0.007611146188865778, "entropy": 0.3584623819069257, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 343035.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 37.60000000000028, "episode_reward_mean": 355.4419999999999, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -0.40000000000000924, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 27.0}, "policy_reward_mean": {"prey_policy": 172.35600000000002, "predator_policy": 5.365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [372.8, 318.1, 310.3, 390.0, 391.0, 347.8, 390.1, 380.0, 201.29999999999941, 353.6, 351.6, 373.2, 382.2, 355.4, 378.4, 387.4, 378.2, 392.0, 363.0, 293.0, 372.9, 368.2, 349.9, 388.3, 396.4, 356.0, 397.3, 379.1, 364.2, 332.0, 390.1, 343.8, 379.5, 359.2, 373.5, 385.6, 394.4, 312.0, 391.0, 376.1, 382.4, 389.7, 200.99999999999935, 369.1, 385.5, 363.6, 376.6, 206.49999999999932, 376.4, 381.9, 353.9, 350.5, 385.6, 378.4, 379.1, 368.0, 363.0, 357.0, 390.1, 397.3, 392.8, 105.20000000000005, 392.8, 387.5, 356.8, 389.0, 364.2, 392.6, 350.2, 395.5, 235.1, 219.99999999999926, 364.0, 400.0, 359.0, 366.8, 388.8, 370.5, 374.6, 382.6, 332.5, 400.0, 332.70000000000005, 362.1, 365.5, 37.60000000000028, 343.3, 398.2, 312.1, 362.0, 375.70000000000005, 352.70000000000005, 335.0, 311.5, 348.0, 375.0, 386.0, 394.2, 368.6, 389.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [183.8, 179.0, 200.0, 109.1, 151.4, 134.9, 200.0, 185.0, 200.0, 191.0, 176.0, 162.8, 200.0, 190.1, 185.0, 185.0, 174.2, 19.1, 189.8, 132.8, 190.1, 144.5, 200.0, 156.2, 185.0, 192.2, 152.0, 187.4, 188.3, 190.1, 200.0, 187.4, 182.0, 189.2, 200.0, 192.0, 185.0, 163.0, 64.0, 197.0, 189.2, 178.7, 198.2, 143.0, 198.2, 130.7, 192.8, 195.5, 199.1, 197.3, 200.0, 134.0, 197.3, 200.0, 184.1, 185.0, 197.3, 158.9, 107.0, 182.0, 198.2, 191.9, 179.0, 129.8, 189.5, 185.0, 170.9, 176.3, 200.0, 162.5, 200.0, 185.6, 197.0, 196.4, 116.0, 167.0, 199.0, 192.0, 190.1, 170.0, 175.4, 200.0, 193.7, 188.0, 167.0, 20.000000000000014, 180.2, 182.9, 185.0, 195.5, 167.0, 185.6, 194.6, 173.0, 20.000000000000014, 186.5, 175.4, 191.0, 200.0, 176.9, 178.1, 150.8, 173.3, 162.2, 200.0, 185.6, 178.4, 200.0, 190.4, 184.7, 178.0, 180.0, 185.0, 160.0, 179.0, 164.0, 190.1, 200.0, 197.3, 200.0, 200.0, 192.8, 78.49999999999997, 16.699999999999996, 200.0, 192.8, 200.0, 183.5, 136.1, 193.7, 198.2, 189.8, 200.0, 147.2, 194.6, 197.0, 172.1, 166.1, 200.0, 195.5, 109.99999999999997, 124.1, 20.000000000000014, 200.0, 182.0, 170.0, 200.0, 200.0, 168.0, 176.0, 192.8, 170.0, 196.4, 190.4, 186.5, 176.0, 173.6, 200.0, 176.6, 200.0, 200.0, 96.5, 200.0, 200.0, 180.5, 126.2, 182.0, 163.1, 150.5, 200.0, 20.000000000000014, -0.40000000000000924, 137.3, 164.0, 198.2, 200.0, 157.7, 112.4, 176.3, 178.7, 177.5, 198.2, 173.9, 171.8, 191.0, 122.0, 171.2, 104.3, 173.0, 155.0, 155.0, 200.0, 179.0, 200.0, 194.0, 198.2, 170.6, 185.0, 188.9, 199.1], "policy_predator_policy_reward": [6.0, 4.0, 9.0, 0.0, 0.0, 24.0, 5.0, 0.0, 0.0, 0.0, 8.0, 1.0, 0.0, 0.0, 5.0, 5.0, 0.0, 8.0, 14.0, 17.0, 17.0, 0.0, 14.0, 3.0, 5.0, 0.0, 11.0, 5.0, 0.0, 0.0, 0.0, 0.0, 1.0, 6.0, 0.0, 0.0, 9.0, 6.0, 16.0, 16.0, 5.0, 0.0, 16.0, 11.0, 0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 5.0, 5.0, 8.0, 0.0, 24.0, 19.0, 0.0, 0.0, 22.0, 13.0, 5.0, 0.0, 12.0, 0.0, 11.0, 0.0, 0.0, 0.0, 1.0, 0.0, 26.0, 3.0, 0.0, 0.0, 7.0, 9.0, 7.0, 0.0, 4.0, 4.0, 8.0, 6.0, 0.0, 6.0, 0.0, 5.0, 5.0, 6.0, 0.0, 9.0, 0.0, 0.0, 7.0, 3.0, 0.0, 5.0, 4.0, 21.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 1.0, 9.0, 13.0, 5.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 4.0, 20.0, 7.0, 1.0, 0.0, 17.0, 0.0, 1.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 15.0, 0.0, 4.0, 0.0, 2.0, 0.0, 8.0, 1.0, 0.0, 6.0, 0.0, 23.0, 13.0, 0.0, 0.0, 15.0, 11.0, 10.0, 7.0, 15.0, 0.0, 11.0, 7.0, 27.0, 15.0, 0.0, 0.0, 20.0, 22.0, 6.0, 1.0, 0.0, 0.0, 0.0, 7.0, 7.0, 15.0, 19.0, 17.0, 9.0, 11.0, 11.0, 9.0, 7.0, 0.0, 2.0, 0.0, 5.0, 8.0, 0.0, 1.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3411996112616358, "mean_inference_ms": 12.087223074118185, "mean_action_processing_ms": 3.594466122278904, "mean_env_wait_ms": 0.41150589668648097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009061217308044434, "StateBufferConnector_ms": 0.0049713850021362305, "ViewRequirementAgentConnector_ms": 0.11956393718719482}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 37.60000000000028, "episode_return_mean": 355.4419999999999, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.5943851072482, "num_env_steps_trained_throughput_per_sec": 314.5943851072482, "timesteps_total": 728000, "num_env_steps_sampled_lifetime": 728000, "num_agent_steps_sampled_lifetime": 2912000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2912000, "timers": {"training_iteration_time_ms": 13174.775, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13174.732, "sample_time_ms": 1587.382, "learn_time_ms": 11568.171, "learn_throughput": 345.776, "synch_weights_time_ms": 16.624}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 2912000, "num_agent_steps_trained": 2912000}, "done": false, "training_iteration": 182, "trial_id": "e4caa_00000", "date": "2024-08-13_23-19-29", "timestamp": 1723605569, "time_this_iter_s": 12.76715612411499, "time_total_s": 12895.873426914215, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d82040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12895.873426914215, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 50.45, "ram_util_percent": 83.3388888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6057357124708318, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7539358457412433, "policy_loss": -0.010223703509659836, "vf_loss": 0.7640752193089279, "vf_explained_var": 0.4828570347299021, "kl": 0.007995633381470345, "entropy": 0.7334762128887984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 344925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.872462053951763, "cur_kl_coeff": 2.570806145248342e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.584221847252871, "policy_loss": -0.0024185427003811117, "vf_loss": 0.5866403909572573, "vf_explained_var": 0.08629628101353923, "kl": 0.00527198719095301, "entropy": 0.21086584226321922, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 344925.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 37.60000000000028, "episode_reward_mean": 356.74199999999996, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -0.40000000000000924, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 27.0}, "policy_reward_mean": {"prey_policy": 172.96099999999998, "predator_policy": 5.41}, "custom_metrics": {}, "hist_stats": {"episode_reward": [349.9, 388.3, 396.4, 356.0, 397.3, 379.1, 364.2, 332.0, 390.1, 343.8, 379.5, 359.2, 373.5, 385.6, 394.4, 312.0, 391.0, 376.1, 382.4, 389.7, 200.99999999999935, 369.1, 385.5, 363.6, 376.6, 206.49999999999932, 376.4, 381.9, 353.9, 350.5, 385.6, 378.4, 379.1, 368.0, 363.0, 357.0, 390.1, 397.3, 392.8, 105.20000000000005, 392.8, 387.5, 356.8, 389.0, 364.2, 392.6, 350.2, 395.5, 235.1, 219.99999999999926, 364.0, 400.0, 359.0, 366.8, 388.8, 370.5, 374.6, 382.6, 332.5, 400.0, 332.70000000000005, 362.1, 365.5, 37.60000000000028, 343.3, 398.2, 312.1, 362.0, 375.70000000000005, 352.70000000000005, 335.0, 311.5, 348.0, 375.0, 386.0, 394.2, 368.6, 389.0, 364.2, 362.1, 391.9, 377.2, 341.9, 395.5, 375.7, 375.6, 353.5, 359.5, 372.2, 384.7, 356.0, 350.0, 346.90000000000003, 386.0, 348.6, 359.3, 396.0, 346.0, 351.6, 286.1], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [198.2, 130.7, 192.8, 195.5, 199.1, 197.3, 200.0, 134.0, 197.3, 200.0, 184.1, 185.0, 197.3, 158.9, 107.0, 182.0, 198.2, 191.9, 179.0, 129.8, 189.5, 185.0, 170.9, 176.3, 200.0, 162.5, 200.0, 185.6, 197.0, 196.4, 116.0, 167.0, 199.0, 192.0, 190.1, 170.0, 175.4, 200.0, 193.7, 188.0, 167.0, 20.000000000000014, 180.2, 182.9, 185.0, 195.5, 167.0, 185.6, 194.6, 173.0, 20.000000000000014, 186.5, 175.4, 191.0, 200.0, 176.9, 178.1, 150.8, 173.3, 162.2, 200.0, 185.6, 178.4, 200.0, 190.4, 184.7, 178.0, 180.0, 185.0, 160.0, 179.0, 164.0, 190.1, 200.0, 197.3, 200.0, 200.0, 192.8, 78.49999999999997, 16.699999999999996, 200.0, 192.8, 200.0, 183.5, 136.1, 193.7, 198.2, 189.8, 200.0, 147.2, 194.6, 197.0, 172.1, 166.1, 200.0, 195.5, 109.99999999999997, 124.1, 20.000000000000014, 200.0, 182.0, 170.0, 200.0, 200.0, 168.0, 176.0, 192.8, 170.0, 196.4, 190.4, 186.5, 176.0, 173.6, 200.0, 176.6, 200.0, 200.0, 96.5, 200.0, 200.0, 180.5, 126.2, 182.0, 163.1, 150.5, 200.0, 20.000000000000014, -0.40000000000000924, 137.3, 164.0, 198.2, 200.0, 157.7, 112.4, 176.3, 178.7, 177.5, 198.2, 173.9, 171.8, 191.0, 122.0, 171.2, 104.3, 173.0, 155.0, 155.0, 200.0, 179.0, 200.0, 194.0, 198.2, 170.6, 185.0, 188.9, 199.1, 200.0, 147.2, 178.1, 173.0, 193.7, 198.2, 182.0, 189.2, 140.9, 176.0, 200.0, 195.5, 176.0, 184.7, 200.0, 170.6, 151.1, 178.4, 163.1, 196.4, 180.2, 185.0, 184.7, 200.0, 170.0, 167.0, 149.3, 184.7, 156.8, 190.1, 200.0, 179.0, 192.5, 151.1, 170.0, 179.3, 200.0, 196.0, 195.0, 122.0, 200.0, 134.6, 85.4, 157.7], "policy_predator_policy_reward": [0.0, 21.0, 0.0, 0.0, 0.0, 0.0, 22.0, 0.0, 0.0, 0.0, 5.0, 5.0, 8.0, 0.0, 24.0, 19.0, 0.0, 0.0, 22.0, 13.0, 5.0, 0.0, 12.0, 0.0, 11.0, 0.0, 0.0, 0.0, 1.0, 0.0, 26.0, 3.0, 0.0, 0.0, 7.0, 9.0, 7.0, 0.0, 4.0, 4.0, 8.0, 6.0, 0.0, 6.0, 0.0, 5.0, 5.0, 6.0, 0.0, 9.0, 0.0, 0.0, 7.0, 3.0, 0.0, 5.0, 4.0, 21.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 1.0, 9.0, 13.0, 5.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 4.0, 20.0, 7.0, 1.0, 0.0, 17.0, 0.0, 1.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 15.0, 0.0, 4.0, 0.0, 2.0, 0.0, 8.0, 1.0, 0.0, 6.0, 0.0, 23.0, 13.0, 0.0, 0.0, 15.0, 11.0, 10.0, 7.0, 15.0, 0.0, 11.0, 7.0, 27.0, 15.0, 0.0, 0.0, 20.0, 22.0, 6.0, 1.0, 0.0, 0.0, 0.0, 7.0, 7.0, 15.0, 19.0, 17.0, 9.0, 11.0, 11.0, 9.0, 7.0, 0.0, 2.0, 0.0, 5.0, 8.0, 0.0, 1.0, 17.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 6.0, 8.0, 17.0, 0.0, 0.0, 7.0, 8.0, 5.0, 0.0, 12.0, 12.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 5.0, 14.0, 0.0, 16.0, 0.0, 0.0, 7.0, 0.0, 1.0, 4.0, 10.0, 0.0, 0.0, 0.0, 15.0, 14.0, 17.0, 0.0, 25.0, 18.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3407178711375047, "mean_inference_ms": 12.294238230560932, "mean_action_processing_ms": 3.435128056450943, "mean_env_wait_ms": 0.4107129422782435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012987256050109863, "StateBufferConnector_ms": 0.004823803901672363, "ViewRequirementAgentConnector_ms": 0.11003851890563965}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 37.60000000000028, "episode_return_mean": 356.74199999999996, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.6947080054701, "num_env_steps_trained_throughput_per_sec": 303.6947080054701, "timesteps_total": 732000, "num_env_steps_sampled_lifetime": 732000, "num_agent_steps_sampled_lifetime": 2928000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2928000, "timers": {"training_iteration_time_ms": 13204.656, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13204.612, "sample_time_ms": 1604.439, "learn_time_ms": 11580.276, "learn_throughput": 345.415, "synch_weights_time_ms": 16.926}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 2928000, "num_agent_steps_trained": 2928000}, "done": false, "training_iteration": 183, "trial_id": "e4caa_00000", "date": "2024-08-13_23-19-42", "timestamp": 1723605582, "time_this_iter_s": 13.2276132106781, "time_total_s": 12909.101040124893, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d82280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12909.101040124893, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 50.31052631578948, "ram_util_percent": 83.61578947368422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5028840746040697, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6469237048352148, "policy_loss": -0.010570175954628558, "vf_loss": 0.6574339846778592, "vf_explained_var": 0.5060403122157647, "kl": 0.0056791899566946726, "entropy": 0.783333933353424, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 346815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6146092145058213, "cur_kl_coeff": 2.570806145248342e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5263824311040697, "policy_loss": -0.0013652332006367268, "vf_loss": 0.5277476642576475, "vf_explained_var": 0.06022147397515635, "kl": 0.006597990577870142, "entropy": 0.22417990159263057, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 346815.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 37.60000000000028, "episode_reward_mean": 354.72799999999995, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -0.40000000000000924, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 27.0}, "policy_reward_mean": {"prey_policy": 171.829, "predator_policy": 5.535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [382.4, 389.7, 200.99999999999935, 369.1, 385.5, 363.6, 376.6, 206.49999999999932, 376.4, 381.9, 353.9, 350.5, 385.6, 378.4, 379.1, 368.0, 363.0, 357.0, 390.1, 397.3, 392.8, 105.20000000000005, 392.8, 387.5, 356.8, 389.0, 364.2, 392.6, 350.2, 395.5, 235.1, 219.99999999999926, 364.0, 400.0, 359.0, 366.8, 388.8, 370.5, 374.6, 382.6, 332.5, 400.0, 332.70000000000005, 362.1, 365.5, 37.60000000000028, 343.3, 398.2, 312.1, 362.0, 375.70000000000005, 352.70000000000005, 335.0, 311.5, 348.0, 375.0, 386.0, 394.2, 368.6, 389.0, 364.2, 362.1, 391.9, 377.2, 341.9, 395.5, 375.7, 375.6, 353.5, 359.5, 372.2, 384.7, 356.0, 350.0, 346.90000000000003, 386.0, 348.6, 359.3, 396.0, 346.0, 351.6, 286.1, 391.0, 362.3, 366.3, 377.5, 381.2, 378.1, 287.4, 246.69999999999985, 359.5, 357.5, 378.3, 393.7, 355.8, 359.0, 367.0, 344.0, 368.0, 393.7], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [175.4, 200.0, 193.7, 188.0, 167.0, 20.000000000000014, 180.2, 182.9, 185.0, 195.5, 167.0, 185.6, 194.6, 173.0, 20.000000000000014, 186.5, 175.4, 191.0, 200.0, 176.9, 178.1, 150.8, 173.3, 162.2, 200.0, 185.6, 178.4, 200.0, 190.4, 184.7, 178.0, 180.0, 185.0, 160.0, 179.0, 164.0, 190.1, 200.0, 197.3, 200.0, 200.0, 192.8, 78.49999999999997, 16.699999999999996, 200.0, 192.8, 200.0, 183.5, 136.1, 193.7, 198.2, 189.8, 200.0, 147.2, 194.6, 197.0, 172.1, 166.1, 200.0, 195.5, 109.99999999999997, 124.1, 20.000000000000014, 200.0, 182.0, 170.0, 200.0, 200.0, 168.0, 176.0, 192.8, 170.0, 196.4, 190.4, 186.5, 176.0, 173.6, 200.0, 176.6, 200.0, 200.0, 96.5, 200.0, 200.0, 180.5, 126.2, 182.0, 163.1, 150.5, 200.0, 20.000000000000014, -0.40000000000000924, 137.3, 164.0, 198.2, 200.0, 157.7, 112.4, 176.3, 178.7, 177.5, 198.2, 173.9, 171.8, 191.0, 122.0, 171.2, 104.3, 173.0, 155.0, 155.0, 200.0, 179.0, 200.0, 194.0, 198.2, 170.6, 185.0, 188.9, 199.1, 200.0, 147.2, 178.1, 173.0, 193.7, 198.2, 182.0, 189.2, 140.9, 176.0, 200.0, 195.5, 176.0, 184.7, 200.0, 170.6, 151.1, 178.4, 163.1, 196.4, 180.2, 185.0, 184.7, 200.0, 170.0, 167.0, 149.3, 184.7, 156.8, 190.1, 200.0, 179.0, 192.5, 151.1, 170.0, 179.3, 200.0, 196.0, 195.0, 122.0, 200.0, 134.6, 85.4, 157.7, 200.0, 191.0, 149.3, 200.0, 158.0, 197.3, 200.0, 177.5, 191.0, 183.2, 200.0, 172.1, 122.3, 127.1, 54.50000000000013, 168.2, 166.70000000000002, 183.8, 192.8, 136.70000000000002, 188.3, 182.0, 200.0, 193.7, 170.0, 168.8, 143.0, 200.0, 175.0, 184.0, 147.0, 160.0, 152.0, 200.0, 200.0, 193.7], "policy_predator_policy_reward": [7.0, 0.0, 4.0, 4.0, 8.0, 6.0, 0.0, 6.0, 0.0, 5.0, 5.0, 6.0, 0.0, 9.0, 0.0, 0.0, 7.0, 3.0, 0.0, 5.0, 4.0, 21.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.0, 1.0, 9.0, 13.0, 5.0, 14.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 4.0, 20.0, 7.0, 1.0, 0.0, 17.0, 0.0, 1.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 15.0, 0.0, 4.0, 0.0, 2.0, 0.0, 8.0, 1.0, 0.0, 6.0, 0.0, 23.0, 13.0, 0.0, 0.0, 15.0, 11.0, 10.0, 7.0, 15.0, 0.0, 11.0, 7.0, 27.0, 15.0, 0.0, 0.0, 20.0, 22.0, 6.0, 1.0, 0.0, 0.0, 0.0, 7.0, 7.0, 15.0, 19.0, 17.0, 9.0, 11.0, 11.0, 9.0, 7.0, 0.0, 2.0, 0.0, 5.0, 8.0, 0.0, 1.0, 17.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 6.0, 8.0, 17.0, 0.0, 0.0, 7.0, 8.0, 5.0, 0.0, 12.0, 12.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 5.0, 14.0, 0.0, 16.0, 0.0, 0.0, 7.0, 0.0, 1.0, 4.0, 10.0, 0.0, 0.0, 0.0, 15.0, 14.0, 17.0, 0.0, 25.0, 18.0, 0.0, 0.0, 0.0, 13.0, 9.0, 2.0, 0.0, 0.0, 0.0, 7.0, 0.0, 6.0, 16.0, 22.0, 14.0, 10.0, 0.0, 9.0, 19.0, 9.0, 6.0, 2.0, 0.0, 0.0, 5.0, 12.0, 16.0, 0.0, 0.0, 8.0, 16.0, 21.0, 16.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3373922534083869, "mean_inference_ms": 12.2435219765086, "mean_action_processing_ms": 3.4193920276024015, "mean_env_wait_ms": 0.40986933868843844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013362407684326172, "StateBufferConnector_ms": 0.004467129707336426, "ViewRequirementAgentConnector_ms": 0.11418449878692627}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 37.60000000000028, "episode_return_mean": 354.72799999999995, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000, "num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.2588382072176, "num_env_steps_trained_throughput_per_sec": 297.2588382072176, "timesteps_total": 736000, "num_env_steps_sampled_lifetime": 736000, "num_agent_steps_sampled_lifetime": 2944000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2944000, "timers": {"training_iteration_time_ms": 13205.895, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13205.85, "sample_time_ms": 1599.955, "learn_time_ms": 11586.976, "learn_throughput": 345.215, "synch_weights_time_ms": 16.495}, "counters": {"num_env_steps_sampled": 736000, "num_env_steps_trained": 736000, "num_agent_steps_sampled": 2944000, "num_agent_steps_trained": 2944000}, "done": false, "training_iteration": 184, "trial_id": "e4caa_00000", "date": "2024-08-13_23-19-55", "timestamp": 1723605595, "time_this_iter_s": 13.481360912322998, "time_total_s": 12922.582401037216, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e01d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12922.582401037216, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 51.58421052631579, "ram_util_percent": 83.6842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8620535437707548, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.46318085762208927, "policy_loss": -0.009284800834332902, "vf_loss": 0.4724032833600643, "vf_explained_var": 0.6560872566447686, "kl": 0.005914065096647856, "entropy": 0.7646627441915885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 348705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.035451973911631, "cur_kl_coeff": 2.570806145248342e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.24799516163175067, "policy_loss": -0.0007302554792394399, "vf_loss": 0.24872541678040758, "vf_explained_var": -0.0633637112599832, "kl": 0.005404796825683497, "entropy": 0.2675193209102545, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 348705.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 37.60000000000028, "episode_reward_mean": 356.573, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -0.40000000000000924, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 40.0}, "policy_reward_mean": {"prey_policy": 172.77650000000003, "predator_policy": 5.51}, "custom_metrics": {}, "hist_stats": {"episode_reward": [390.1, 397.3, 392.8, 105.20000000000005, 392.8, 387.5, 356.8, 389.0, 364.2, 392.6, 350.2, 395.5, 235.1, 219.99999999999926, 364.0, 400.0, 359.0, 366.8, 388.8, 370.5, 374.6, 382.6, 332.5, 400.0, 332.70000000000005, 362.1, 365.5, 37.60000000000028, 343.3, 398.2, 312.1, 362.0, 375.70000000000005, 352.70000000000005, 335.0, 311.5, 348.0, 375.0, 386.0, 394.2, 368.6, 389.0, 364.2, 362.1, 391.9, 377.2, 341.9, 395.5, 375.7, 375.6, 353.5, 359.5, 372.2, 384.7, 356.0, 350.0, 346.90000000000003, 386.0, 348.6, 359.3, 396.0, 346.0, 351.6, 286.1, 391.0, 362.3, 366.3, 377.5, 381.2, 378.1, 287.4, 246.69999999999985, 359.5, 357.5, 378.3, 393.7, 355.8, 359.0, 367.0, 344.0, 368.0, 393.7, 249.7, 362.2, 374.3, 327.1, 400.0, 372.2, 357.50000000000006, 389.2, 366.4, 383.8, 386.5, 360.4, 372.1, 393.70000000000005, 383.0, 338.0, 375.0, 361.6], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [190.1, 200.0, 197.3, 200.0, 200.0, 192.8, 78.49999999999997, 16.699999999999996, 200.0, 192.8, 200.0, 183.5, 136.1, 193.7, 198.2, 189.8, 200.0, 147.2, 194.6, 197.0, 172.1, 166.1, 200.0, 195.5, 109.99999999999997, 124.1, 20.000000000000014, 200.0, 182.0, 170.0, 200.0, 200.0, 168.0, 176.0, 192.8, 170.0, 196.4, 190.4, 186.5, 176.0, 173.6, 200.0, 176.6, 200.0, 200.0, 96.5, 200.0, 200.0, 180.5, 126.2, 182.0, 163.1, 150.5, 200.0, 20.000000000000014, -0.40000000000000924, 137.3, 164.0, 198.2, 200.0, 157.7, 112.4, 176.3, 178.7, 177.5, 198.2, 173.9, 171.8, 191.0, 122.0, 171.2, 104.3, 173.0, 155.0, 155.0, 200.0, 179.0, 200.0, 194.0, 198.2, 170.6, 185.0, 188.9, 199.1, 200.0, 147.2, 178.1, 173.0, 193.7, 198.2, 182.0, 189.2, 140.9, 176.0, 200.0, 195.5, 176.0, 184.7, 200.0, 170.6, 151.1, 178.4, 163.1, 196.4, 180.2, 185.0, 184.7, 200.0, 170.0, 167.0, 149.3, 184.7, 156.8, 190.1, 200.0, 179.0, 192.5, 151.1, 170.0, 179.3, 200.0, 196.0, 195.0, 122.0, 200.0, 134.6, 85.4, 157.7, 200.0, 191.0, 149.3, 200.0, 158.0, 197.3, 200.0, 177.5, 191.0, 183.2, 200.0, 172.1, 122.3, 127.1, 54.50000000000013, 168.2, 166.70000000000002, 183.8, 192.8, 136.70000000000002, 188.3, 182.0, 200.0, 193.7, 170.0, 168.8, 143.0, 200.0, 175.0, 184.0, 147.0, 160.0, 152.0, 200.0, 200.0, 193.7, 109.4, 68.3, 178.4, 183.8, 179.0, 188.3, 193.7, 133.39999999999998, 200.0, 200.0, 198.2, 161.0, 200.0, 153.5, 192.8, 196.4, 166.4, 179.0, 184.7, 199.1, 200.0, 186.5, 172.1, 188.3, 171.5, 185.6, 193.7, 200.0, 197.0, 186.0, 137.0, 194.0, 185.0, 185.0, 155.9, 193.7], "policy_predator_policy_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 5.0, 0.0, 0.0, 0.0, 4.0, 20.0, 7.0, 1.0, 0.0, 17.0, 0.0, 1.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 10.0, 2.0, 0.0, 0.0, 0.0, 15.0, 0.0, 4.0, 0.0, 2.0, 0.0, 8.0, 1.0, 0.0, 6.0, 0.0, 23.0, 13.0, 0.0, 0.0, 15.0, 11.0, 10.0, 7.0, 15.0, 0.0, 11.0, 7.0, 27.0, 15.0, 0.0, 0.0, 20.0, 22.0, 6.0, 1.0, 0.0, 0.0, 0.0, 7.0, 7.0, 15.0, 19.0, 17.0, 9.0, 11.0, 11.0, 9.0, 7.0, 0.0, 2.0, 0.0, 5.0, 8.0, 0.0, 1.0, 17.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 6.0, 8.0, 17.0, 0.0, 0.0, 7.0, 8.0, 5.0, 0.0, 12.0, 12.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 5.0, 14.0, 0.0, 16.0, 0.0, 0.0, 7.0, 0.0, 1.0, 4.0, 10.0, 0.0, 0.0, 0.0, 15.0, 14.0, 17.0, 0.0, 25.0, 18.0, 0.0, 0.0, 0.0, 13.0, 9.0, 2.0, 0.0, 0.0, 0.0, 7.0, 0.0, 6.0, 16.0, 22.0, 14.0, 10.0, 0.0, 9.0, 19.0, 9.0, 6.0, 2.0, 0.0, 0.0, 5.0, 12.0, 16.0, 0.0, 0.0, 8.0, 16.0, 21.0, 16.0, 0.0, 0.0, 0.0, 32.0, 40.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 2.0, 2.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 2.0, 5.0, 0.0, 0.0, 12.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3341325945775628, "mean_inference_ms": 12.193311721693076, "mean_action_processing_ms": 3.4038150809972456, "mean_env_wait_ms": 0.40900373887666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013669013977050781, "StateBufferConnector_ms": 0.004649043083190918, "ViewRequirementAgentConnector_ms": 0.1128685474395752}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 37.60000000000028, "episode_return_mean": 356.573, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000, "num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.368473183298, "num_env_steps_trained_throughput_per_sec": 305.368473183298, "timesteps_total": 740000, "num_env_steps_sampled_lifetime": 740000, "num_agent_steps_sampled_lifetime": 2960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2960000, "timers": {"training_iteration_time_ms": 13188.236, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13188.191, "sample_time_ms": 1603.5, "learn_time_ms": 11565.426, "learn_throughput": 345.858, "synch_weights_time_ms": 16.656}, "counters": {"num_env_steps_sampled": 740000, "num_env_steps_trained": 740000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "done": false, "training_iteration": 185, "trial_id": "e4caa_00000", "date": "2024-08-13_23-20-09", "timestamp": 1723605609, "time_this_iter_s": 13.155286073684692, "time_total_s": 12935.7376871109, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b8f820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12935.7376871109, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 49.97368421052631, "ram_util_percent": 83.55789473684212}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3134068245413126, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3004788775346781, "policy_loss": -0.009925276088212967, "vf_loss": 0.3103247641858019, "vf_explained_var": 0.49917306026453695, "kl": 0.007527306020294541, "entropy": 0.7370034051950647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 350595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.219484649062472, "cur_kl_coeff": 2.570806145248342e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.23886546764384817, "policy_loss": -0.003331615038526555, "vf_loss": 0.2421970822947548, "vf_explained_var": 0.17930590289610404, "kl": 0.01479587475165326, "entropy": 0.2690472521873378, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 350595.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 37.60000000000028, "episode_reward_mean": 360.2710000000001, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": -0.40000000000000924, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 40.0}, "policy_reward_mean": {"prey_policy": 174.22549999999998, "predator_policy": 5.91}, "custom_metrics": {}, "hist_stats": {"episode_reward": [388.8, 370.5, 374.6, 382.6, 332.5, 400.0, 332.70000000000005, 362.1, 365.5, 37.60000000000028, 343.3, 398.2, 312.1, 362.0, 375.70000000000005, 352.70000000000005, 335.0, 311.5, 348.0, 375.0, 386.0, 394.2, 368.6, 389.0, 364.2, 362.1, 391.9, 377.2, 341.9, 395.5, 375.7, 375.6, 353.5, 359.5, 372.2, 384.7, 356.0, 350.0, 346.90000000000003, 386.0, 348.6, 359.3, 396.0, 346.0, 351.6, 286.1, 391.0, 362.3, 366.3, 377.5, 381.2, 378.1, 287.4, 246.69999999999985, 359.5, 357.5, 378.3, 393.7, 355.8, 359.0, 367.0, 344.0, 368.0, 393.7, 249.7, 362.2, 374.3, 327.1, 400.0, 372.2, 357.50000000000006, 389.2, 366.4, 383.8, 386.5, 360.4, 372.1, 393.70000000000005, 383.0, 338.0, 375.0, 361.6, 392.8, 352.4, 352.7, 374.0, 372.8, 390.0, 391.0, 368.2, 345.2, 359.8, 363.7, 279.5, 393.7, 394.6, 372.0, 374.0, 373.0, 379.3], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [196.4, 190.4, 186.5, 176.0, 173.6, 200.0, 176.6, 200.0, 200.0, 96.5, 200.0, 200.0, 180.5, 126.2, 182.0, 163.1, 150.5, 200.0, 20.000000000000014, -0.40000000000000924, 137.3, 164.0, 198.2, 200.0, 157.7, 112.4, 176.3, 178.7, 177.5, 198.2, 173.9, 171.8, 191.0, 122.0, 171.2, 104.3, 173.0, 155.0, 155.0, 200.0, 179.0, 200.0, 194.0, 198.2, 170.6, 185.0, 188.9, 199.1, 200.0, 147.2, 178.1, 173.0, 193.7, 198.2, 182.0, 189.2, 140.9, 176.0, 200.0, 195.5, 176.0, 184.7, 200.0, 170.6, 151.1, 178.4, 163.1, 196.4, 180.2, 185.0, 184.7, 200.0, 170.0, 167.0, 149.3, 184.7, 156.8, 190.1, 200.0, 179.0, 192.5, 151.1, 170.0, 179.3, 200.0, 196.0, 195.0, 122.0, 200.0, 134.6, 85.4, 157.7, 200.0, 191.0, 149.3, 200.0, 158.0, 197.3, 200.0, 177.5, 191.0, 183.2, 200.0, 172.1, 122.3, 127.1, 54.50000000000013, 168.2, 166.70000000000002, 183.8, 192.8, 136.70000000000002, 188.3, 182.0, 200.0, 193.7, 170.0, 168.8, 143.0, 200.0, 175.0, 184.0, 147.0, 160.0, 152.0, 200.0, 200.0, 193.7, 109.4, 68.3, 178.4, 183.8, 179.0, 188.3, 193.7, 133.39999999999998, 200.0, 200.0, 198.2, 161.0, 200.0, 153.5, 192.8, 196.4, 166.4, 179.0, 184.7, 199.1, 200.0, 186.5, 172.1, 188.3, 171.5, 185.6, 193.7, 200.0, 197.0, 186.0, 137.0, 194.0, 185.0, 185.0, 155.9, 193.7, 200.0, 192.8, 155.0, 187.4, 149.3, 187.4, 185.0, 182.0, 163.7, 199.1, 188.0, 197.0, 191.0, 200.0, 173.0, 180.2, 162.2, 161.0, 191.0, 156.8, 182.0, 175.7, 127.1, 97.4, 194.6, 199.1, 200.0, 194.6, 160.0, 197.0, 190.0, 173.0, 197.3, 175.7, 189.2, 190.1], "policy_predator_policy_reward": [0.0, 2.0, 0.0, 8.0, 1.0, 0.0, 6.0, 0.0, 23.0, 13.0, 0.0, 0.0, 15.0, 11.0, 10.0, 7.0, 15.0, 0.0, 11.0, 7.0, 27.0, 15.0, 0.0, 0.0, 20.0, 22.0, 6.0, 1.0, 0.0, 0.0, 0.0, 7.0, 7.0, 15.0, 19.0, 17.0, 9.0, 11.0, 11.0, 9.0, 7.0, 0.0, 2.0, 0.0, 5.0, 8.0, 0.0, 1.0, 17.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 6.0, 8.0, 17.0, 0.0, 0.0, 7.0, 8.0, 5.0, 0.0, 12.0, 12.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 5.0, 14.0, 0.0, 16.0, 0.0, 0.0, 7.0, 0.0, 1.0, 4.0, 10.0, 0.0, 0.0, 0.0, 15.0, 14.0, 17.0, 0.0, 25.0, 18.0, 0.0, 0.0, 0.0, 13.0, 9.0, 2.0, 0.0, 0.0, 0.0, 7.0, 0.0, 6.0, 16.0, 22.0, 14.0, 10.0, 0.0, 9.0, 19.0, 9.0, 6.0, 2.0, 0.0, 0.0, 5.0, 12.0, 16.0, 0.0, 0.0, 8.0, 16.0, 21.0, 16.0, 0.0, 0.0, 0.0, 32.0, 40.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 2.0, 2.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 2.0, 5.0, 0.0, 0.0, 12.0, 0.0, 0.0, 3.0, 7.0, 9.0, 7.0, 7.0, 0.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 9.0, 6.0, 6.0, 16.0, 6.0, 6.0, 6.0, 0.0, 37.0, 18.0, 0.0, 0.0, 0.0, 0.0, 9.0, 6.0, 3.0, 8.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.330915613698886, "mean_inference_ms": 12.143677297873431, "mean_action_processing_ms": 3.3884062903119565, "mean_env_wait_ms": 0.40815351316374743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013308286666870117, "StateBufferConnector_ms": 0.004617094993591309, "ViewRequirementAgentConnector_ms": 0.11213433742523193}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 37.60000000000028, "episode_return_mean": 360.2710000000001, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000, "num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.5309649287905, "num_env_steps_trained_throughput_per_sec": 311.5309649287905, "timesteps_total": 744000, "num_env_steps_sampled_lifetime": 744000, "num_agent_steps_sampled_lifetime": 2976000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2976000, "timers": {"training_iteration_time_ms": 13149.057, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13149.012, "sample_time_ms": 1598.512, "learn_time_ms": 11530.765, "learn_throughput": 346.898, "synch_weights_time_ms": 17.0}, "counters": {"num_env_steps_sampled": 744000, "num_env_steps_trained": 744000, "num_agent_steps_sampled": 2976000, "num_agent_steps_trained": 2976000}, "done": false, "training_iteration": 186, "trial_id": "e4caa_00000", "date": "2024-08-13_23-20-22", "timestamp": 1723605622, "time_this_iter_s": 12.895440816879272, "time_total_s": 12948.63312792778, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2dee310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12948.63312792778, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 50.42105263157895, "ram_util_percent": 83.51578947368422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8242492702587572, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8822470812508886, "policy_loss": -0.005068290598996023, "vf_loss": 0.887247922827327, "vf_explained_var": 0.5052810425796206, "kl": 0.00639517012744007, "entropy": 0.754938995270502, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 352485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.34046900436361, "cur_kl_coeff": 2.570806145248342e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.39341760995999847, "policy_loss": -0.0011606707299256294, "vf_loss": 0.3945782809937126, "vf_explained_var": 0.18006997212531076, "kl": 0.005280211461027933, "entropy": 0.2555900039496245, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 352485.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 205.59999999999977, "episode_reward_mean": 364.579, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 54.50000000000013, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 40.0}, "policy_reward_mean": {"prey_policy": 177.29449999999997, "predator_policy": 4.995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [377.2, 341.9, 395.5, 375.7, 375.6, 353.5, 359.5, 372.2, 384.7, 356.0, 350.0, 346.90000000000003, 386.0, 348.6, 359.3, 396.0, 346.0, 351.6, 286.1, 391.0, 362.3, 366.3, 377.5, 381.2, 378.1, 287.4, 246.69999999999985, 359.5, 357.5, 378.3, 393.7, 355.8, 359.0, 367.0, 344.0, 368.0, 393.7, 249.7, 362.2, 374.3, 327.1, 400.0, 372.2, 357.50000000000006, 389.2, 366.4, 383.8, 386.5, 360.4, 372.1, 393.70000000000005, 383.0, 338.0, 375.0, 361.6, 392.8, 352.4, 352.7, 374.0, 372.8, 390.0, 391.0, 368.2, 345.2, 359.8, 363.7, 279.5, 393.7, 394.6, 372.0, 374.0, 373.0, 379.3, 385.5, 349.0, 386.5, 394.6, 360.0, 205.59999999999977, 381.1, 291.0999999999999, 394.6, 385.0, 388.0, 343.7, 370.3, 336.4, 391.5, 391.9, 375.8, 376.2, 382.0, 398.2, 372.9, 390.0, 390.0, 382.0, 385.5, 343.8, 396.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [182.0, 189.2, 140.9, 176.0, 200.0, 195.5, 176.0, 184.7, 200.0, 170.6, 151.1, 178.4, 163.1, 196.4, 180.2, 185.0, 184.7, 200.0, 170.0, 167.0, 149.3, 184.7, 156.8, 190.1, 200.0, 179.0, 192.5, 151.1, 170.0, 179.3, 200.0, 196.0, 195.0, 122.0, 200.0, 134.6, 85.4, 157.7, 200.0, 191.0, 149.3, 200.0, 158.0, 197.3, 200.0, 177.5, 191.0, 183.2, 200.0, 172.1, 122.3, 127.1, 54.50000000000013, 168.2, 166.70000000000002, 183.8, 192.8, 136.70000000000002, 188.3, 182.0, 200.0, 193.7, 170.0, 168.8, 143.0, 200.0, 175.0, 184.0, 147.0, 160.0, 152.0, 200.0, 200.0, 193.7, 109.4, 68.3, 178.4, 183.8, 179.0, 188.3, 193.7, 133.39999999999998, 200.0, 200.0, 198.2, 161.0, 200.0, 153.5, 192.8, 196.4, 166.4, 179.0, 184.7, 199.1, 200.0, 186.5, 172.1, 188.3, 171.5, 185.6, 193.7, 200.0, 197.0, 186.0, 137.0, 194.0, 185.0, 185.0, 155.9, 193.7, 200.0, 192.8, 155.0, 187.4, 149.3, 187.4, 185.0, 182.0, 163.7, 199.1, 188.0, 197.0, 191.0, 200.0, 173.0, 180.2, 162.2, 161.0, 191.0, 156.8, 182.0, 175.7, 127.1, 97.4, 194.6, 199.1, 200.0, 194.6, 160.0, 197.0, 190.0, 173.0, 197.3, 175.7, 189.2, 190.1, 200.0, 180.5, 169.4, 146.6, 191.9, 194.6, 194.6, 200.0, 182.0, 167.0, 60.49999999999996, 145.1, 187.4, 193.7, 181.1, 109.99999999999997, 200.0, 194.6, 182.0, 197.0, 200.0, 182.0, 167.0, 157.7, 170.3, 200.0, 168.8, 137.6, 195.5, 194.0, 193.7, 198.2, 176.0, 183.8, 186.2, 182.0, 191.9, 190.1, 200.0, 198.2, 178.7, 189.2, 197.0, 193.0, 196.0, 191.0, 167.0, 193.0, 195.2, 185.3, 137.3, 186.5, 194.0, 200.0], "policy_predator_policy_reward": [0.0, 6.0, 8.0, 17.0, 0.0, 0.0, 7.0, 8.0, 5.0, 0.0, 12.0, 12.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 5.0, 14.0, 0.0, 16.0, 0.0, 0.0, 7.0, 0.0, 1.0, 4.0, 10.0, 0.0, 0.0, 0.0, 15.0, 14.0, 17.0, 0.0, 25.0, 18.0, 0.0, 0.0, 0.0, 13.0, 9.0, 2.0, 0.0, 0.0, 0.0, 7.0, 0.0, 6.0, 16.0, 22.0, 14.0, 10.0, 0.0, 9.0, 19.0, 9.0, 6.0, 2.0, 0.0, 0.0, 5.0, 12.0, 16.0, 0.0, 0.0, 8.0, 16.0, 21.0, 16.0, 0.0, 0.0, 0.0, 32.0, 40.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 2.0, 2.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 2.0, 5.0, 0.0, 0.0, 12.0, 0.0, 0.0, 3.0, 7.0, 9.0, 7.0, 7.0, 0.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 9.0, 6.0, 6.0, 16.0, 6.0, 6.0, 6.0, 0.0, 37.0, 18.0, 0.0, 0.0, 0.0, 0.0, 9.0, 6.0, 3.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 13.0, 20.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 19.0, 0.0, 0.0, 21.0, 9.0, 0.0, 2.0, 0.0, 0.0, 8.0, 8.0, 7.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 3.0, 11.0, 11.0, 5.0, 0.0, 20.0, 0.0, 2.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.332746117669579, "mean_inference_ms": 11.945657435098868, "mean_action_processing_ms": 3.4887655544219403, "mean_env_wait_ms": 0.4071490399977538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009858846664428711, "StateBufferConnector_ms": 0.004207491874694824, "ViewRequirementAgentConnector_ms": 0.11218976974487305}, "num_episodes": 27, "episode_return_max": 400.0, "episode_return_min": 205.59999999999977, "episode_return_mean": 364.579, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000, "num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.7040387033209, "num_env_steps_trained_throughput_per_sec": 299.7040387033209, "timesteps_total": 748000, "num_env_steps_sampled_lifetime": 748000, "num_agent_steps_sampled_lifetime": 2992000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2992000, "timers": {"training_iteration_time_ms": 13165.867, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13165.82, "sample_time_ms": 1601.891, "learn_time_ms": 11542.927, "learn_throughput": 346.533, "synch_weights_time_ms": 16.731}, "counters": {"num_env_steps_sampled": 748000, "num_env_steps_trained": 748000, "num_agent_steps_sampled": 2992000, "num_agent_steps_trained": 2992000}, "done": false, "training_iteration": 187, "trial_id": "e4caa_00000", "date": "2024-08-13_23-20-35", "timestamp": 1723605635, "time_this_iter_s": 13.391799688339233, "time_total_s": 12962.02492761612, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e01d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12962.02492761612, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 56.099999999999994, "ram_util_percent": 83.78947368421053}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5228294514316731, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6206174875244624, "policy_loss": -0.0070731582529054435, "vf_loss": 0.6275764593489902, "vf_explained_var": 0.5422335062392805, "kl": 0.010826558906277631, "entropy": 0.7012264150791068, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 354375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.343862500960234, "cur_kl_coeff": 2.570806145248342e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3442061137821939, "policy_loss": -0.0015893015942767892, "vf_loss": 0.34579541627071286, "vf_explained_var": 0.2130514518293754, "kl": 0.008936829406555402, "entropy": 0.21579297707667427, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 354375.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 205.59999999999977, "episode_reward_mean": 364.80899999999997, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 54.50000000000013, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 40.0}, "policy_reward_mean": {"prey_policy": 177.40449999999998, "predator_policy": 5.0}, "custom_metrics": {}, "hist_stats": {"episode_reward": [286.1, 391.0, 362.3, 366.3, 377.5, 381.2, 378.1, 287.4, 246.69999999999985, 359.5, 357.5, 378.3, 393.7, 355.8, 359.0, 367.0, 344.0, 368.0, 393.7, 249.7, 362.2, 374.3, 327.1, 400.0, 372.2, 357.50000000000006, 389.2, 366.4, 383.8, 386.5, 360.4, 372.1, 393.70000000000005, 383.0, 338.0, 375.0, 361.6, 392.8, 352.4, 352.7, 374.0, 372.8, 390.0, 391.0, 368.2, 345.2, 359.8, 363.7, 279.5, 393.7, 394.6, 372.0, 374.0, 373.0, 379.3, 385.5, 349.0, 386.5, 394.6, 360.0, 205.59999999999977, 381.1, 291.0999999999999, 394.6, 385.0, 388.0, 343.7, 370.3, 336.4, 391.5, 391.9, 375.8, 376.2, 382.0, 398.2, 372.9, 390.0, 390.0, 382.0, 385.5, 343.8, 396.0, 309.3, 400.0, 396.4, 398.2, 324.5, 380.6, 375.7, 391.0, 380.2, 380.4, 329.1, 372.5, 397.3, 386.5, 297.0, 347.0, 378.7, 354.8], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [85.4, 157.7, 200.0, 191.0, 149.3, 200.0, 158.0, 197.3, 200.0, 177.5, 191.0, 183.2, 200.0, 172.1, 122.3, 127.1, 54.50000000000013, 168.2, 166.70000000000002, 183.8, 192.8, 136.70000000000002, 188.3, 182.0, 200.0, 193.7, 170.0, 168.8, 143.0, 200.0, 175.0, 184.0, 147.0, 160.0, 152.0, 200.0, 200.0, 193.7, 109.4, 68.3, 178.4, 183.8, 179.0, 188.3, 193.7, 133.39999999999998, 200.0, 200.0, 198.2, 161.0, 200.0, 153.5, 192.8, 196.4, 166.4, 179.0, 184.7, 199.1, 200.0, 186.5, 172.1, 188.3, 171.5, 185.6, 193.7, 200.0, 197.0, 186.0, 137.0, 194.0, 185.0, 185.0, 155.9, 193.7, 200.0, 192.8, 155.0, 187.4, 149.3, 187.4, 185.0, 182.0, 163.7, 199.1, 188.0, 197.0, 191.0, 200.0, 173.0, 180.2, 162.2, 161.0, 191.0, 156.8, 182.0, 175.7, 127.1, 97.4, 194.6, 199.1, 200.0, 194.6, 160.0, 197.0, 190.0, 173.0, 197.3, 175.7, 189.2, 190.1, 200.0, 180.5, 169.4, 146.6, 191.9, 194.6, 194.6, 200.0, 182.0, 167.0, 60.49999999999996, 145.1, 187.4, 193.7, 181.1, 109.99999999999997, 200.0, 194.6, 182.0, 197.0, 200.0, 182.0, 167.0, 157.7, 170.3, 200.0, 168.8, 137.6, 195.5, 194.0, 193.7, 198.2, 176.0, 183.8, 186.2, 182.0, 191.9, 190.1, 200.0, 198.2, 178.7, 189.2, 197.0, 193.0, 196.0, 191.0, 167.0, 193.0, 195.2, 185.3, 137.3, 186.5, 194.0, 200.0, 136.1, 135.2, 200.0, 200.0, 200.0, 196.4, 198.2, 200.0, 132.5, 164.0, 179.0, 194.6, 183.8, 191.9, 193.7, 197.3, 191.0, 189.2, 200.0, 172.4, 169.4, 127.7, 179.0, 186.5, 200.0, 197.3, 193.7, 192.8, 164.0, 100.0, 196.0, 140.0, 195.5, 180.2, 171.8, 164.0], "policy_predator_policy_reward": [25.0, 18.0, 0.0, 0.0, 0.0, 13.0, 9.0, 2.0, 0.0, 0.0, 0.0, 7.0, 0.0, 6.0, 16.0, 22.0, 14.0, 10.0, 0.0, 9.0, 19.0, 9.0, 6.0, 2.0, 0.0, 0.0, 5.0, 12.0, 16.0, 0.0, 0.0, 8.0, 16.0, 21.0, 16.0, 0.0, 0.0, 0.0, 32.0, 40.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 2.0, 2.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 2.0, 5.0, 0.0, 0.0, 12.0, 0.0, 0.0, 3.0, 7.0, 9.0, 7.0, 7.0, 0.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 9.0, 6.0, 6.0, 16.0, 6.0, 6.0, 6.0, 0.0, 37.0, 18.0, 0.0, 0.0, 0.0, 0.0, 9.0, 6.0, 3.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 13.0, 20.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 19.0, 0.0, 0.0, 21.0, 9.0, 0.0, 2.0, 0.0, 0.0, 8.0, 8.0, 7.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 3.0, 11.0, 11.0, 5.0, 0.0, 20.0, 0.0, 2.0, 0.0, 12.0, 26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 23.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 28.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, 11.0, 2.0, 1.0, 12.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.323012346881757, "mean_inference_ms": 12.02402905659256, "mean_action_processing_ms": 3.351110444102499, "mean_env_wait_ms": 0.40608999625702, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005190849304199219, "StateBufferConnector_ms": 0.003767848014831543, "ViewRequirementAgentConnector_ms": 0.10533034801483154}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 205.59999999999977, "episode_return_mean": 364.80899999999997, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000, "num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.10514304889443, "num_env_steps_trained_throughput_per_sec": 307.10514304889443, "timesteps_total": 752000, "num_env_steps_sampled_lifetime": 752000, "num_agent_steps_sampled_lifetime": 3008000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3008000, "timers": {"training_iteration_time_ms": 13144.124, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13144.077, "sample_time_ms": 1592.752, "learn_time_ms": 11530.947, "learn_throughput": 346.893, "synch_weights_time_ms": 16.225}, "counters": {"num_env_steps_sampled": 752000, "num_env_steps_trained": 752000, "num_agent_steps_sampled": 3008000, "num_agent_steps_trained": 3008000}, "done": false, "training_iteration": 188, "trial_id": "e4caa_00000", "date": "2024-08-13_23-20-48", "timestamp": 1723605648, "time_this_iter_s": 13.082773923873901, "time_total_s": 12975.107701539993, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2deef70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12975.107701539993, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 50.833333333333336, "ram_util_percent": 83.70555555555556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8959088475931258, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.7188261980533344, "policy_loss": -0.00896850895387904, "vf_loss": 0.7277289092619583, "vf_explained_var": 0.7058694882683022, "kl": 0.0062385523161874856, "entropy": 0.7155204373377341, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 356265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0550417689971192, "cur_kl_coeff": 2.570806145248342e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1585683342399539, "policy_loss": -0.0019615714358801523, "vf_loss": 0.16052990629302002, "vf_explained_var": 0.19536479408778842, "kl": 0.007819895306823685, "entropy": 0.17151003189424358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 356265.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 205.59999999999977, "episode_reward_mean": 364.7299999999999, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 48.79999999999997, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 40.0}, "policy_reward_mean": {"prey_policy": 178.19, "predator_policy": 4.175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [393.7, 249.7, 362.2, 374.3, 327.1, 400.0, 372.2, 357.50000000000006, 389.2, 366.4, 383.8, 386.5, 360.4, 372.1, 393.70000000000005, 383.0, 338.0, 375.0, 361.6, 392.8, 352.4, 352.7, 374.0, 372.8, 390.0, 391.0, 368.2, 345.2, 359.8, 363.7, 279.5, 393.7, 394.6, 372.0, 374.0, 373.0, 379.3, 385.5, 349.0, 386.5, 394.6, 360.0, 205.59999999999977, 381.1, 291.0999999999999, 394.6, 385.0, 388.0, 343.7, 370.3, 336.4, 391.5, 391.9, 375.8, 376.2, 382.0, 398.2, 372.9, 390.0, 390.0, 382.0, 385.5, 343.8, 396.0, 309.3, 400.0, 396.4, 398.2, 324.5, 380.6, 375.7, 391.0, 380.2, 380.4, 329.1, 372.5, 397.3, 386.5, 297.0, 347.0, 378.7, 354.8, 356.3, 374.5, 371.4, 240.79999999999947, 384.7, 396.4, 370.6, 389.0, 328.9, 231.49999999999957, 326.59999999999997, 368.2, 374.5, 367.70000000000005, 372.0, 361.0, 350.20000000000005, 387.20000000000005], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 193.7, 109.4, 68.3, 178.4, 183.8, 179.0, 188.3, 193.7, 133.39999999999998, 200.0, 200.0, 198.2, 161.0, 200.0, 153.5, 192.8, 196.4, 166.4, 179.0, 184.7, 199.1, 200.0, 186.5, 172.1, 188.3, 171.5, 185.6, 193.7, 200.0, 197.0, 186.0, 137.0, 194.0, 185.0, 185.0, 155.9, 193.7, 200.0, 192.8, 155.0, 187.4, 149.3, 187.4, 185.0, 182.0, 163.7, 199.1, 188.0, 197.0, 191.0, 200.0, 173.0, 180.2, 162.2, 161.0, 191.0, 156.8, 182.0, 175.7, 127.1, 97.4, 194.6, 199.1, 200.0, 194.6, 160.0, 197.0, 190.0, 173.0, 197.3, 175.7, 189.2, 190.1, 200.0, 180.5, 169.4, 146.6, 191.9, 194.6, 194.6, 200.0, 182.0, 167.0, 60.49999999999996, 145.1, 187.4, 193.7, 181.1, 109.99999999999997, 200.0, 194.6, 182.0, 197.0, 200.0, 182.0, 167.0, 157.7, 170.3, 200.0, 168.8, 137.6, 195.5, 194.0, 193.7, 198.2, 176.0, 183.8, 186.2, 182.0, 191.9, 190.1, 200.0, 198.2, 178.7, 189.2, 197.0, 193.0, 196.0, 191.0, 167.0, 193.0, 195.2, 185.3, 137.3, 186.5, 194.0, 200.0, 136.1, 135.2, 200.0, 200.0, 200.0, 196.4, 198.2, 200.0, 132.5, 164.0, 179.0, 194.6, 183.8, 191.9, 193.7, 197.3, 191.0, 189.2, 200.0, 172.4, 169.4, 127.7, 179.0, 186.5, 200.0, 197.3, 193.7, 192.8, 164.0, 100.0, 196.0, 140.0, 195.5, 180.2, 171.8, 164.0, 182.0, 143.3, 186.5, 182.0, 176.0, 187.4, 48.79999999999997, 188.0, 184.7, 200.0, 200.0, 196.4, 187.1, 177.5, 197.0, 191.0, 128.89999999999998, 200.0, 54.19999999999996, 167.3, 122.6, 200.0, 164.0, 189.2, 168.5, 194.0, 178.4, 185.29999999999998, 180.0, 191.0, 175.0, 179.0, 196.4, 147.8, 196.39999999999998, 189.8], "policy_predator_policy_reward": [0.0, 0.0, 32.0, 40.0, 0.0, 0.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 13.0, 0.0, 2.0, 2.0, 0.0, 0.0, 11.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 8.0, 0.0, 0.0, 0.0, 0.0, 5.0, 2.0, 5.0, 0.0, 0.0, 12.0, 0.0, 0.0, 3.0, 7.0, 9.0, 7.0, 7.0, 0.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 9.0, 6.0, 6.0, 16.0, 6.0, 6.0, 6.0, 0.0, 37.0, 18.0, 0.0, 0.0, 0.0, 0.0, 9.0, 6.0, 3.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 13.0, 20.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 19.0, 0.0, 0.0, 21.0, 9.0, 0.0, 2.0, 0.0, 0.0, 8.0, 8.0, 7.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 3.0, 11.0, 11.0, 5.0, 0.0, 20.0, 0.0, 2.0, 0.0, 12.0, 26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 23.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 28.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, 11.0, 2.0, 1.0, 12.0, 7.0, 15.0, 16.0, 0.0, 6.0, 8.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 4.0, 1.0, 3.0, 6.0, 9.0, 9.0, 3.0, 4.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 6.0, 1.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3198595802807518, "mean_inference_ms": 11.975645980048998, "mean_action_processing_ms": 3.3361138448400647, "mean_env_wait_ms": 0.40522121520642673, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004744410514831543, "StateBufferConnector_ms": 0.006694912910461426, "ViewRequirementAgentConnector_ms": 0.10698485374450684}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 205.59999999999977, "episode_return_mean": 364.7299999999999, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000, "num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.5875362191147, "num_env_steps_trained_throughput_per_sec": 315.5875362191147, "timesteps_total": 756000, "num_env_steps_sampled_lifetime": 756000, "num_agent_steps_sampled_lifetime": 3024000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3024000, "timers": {"training_iteration_time_ms": 13077.668, "restore_workers_time_ms": 0.015, "training_step_time_ms": 13077.621, "sample_time_ms": 1593.979, "learn_time_ms": 11462.787, "learn_throughput": 348.955, "synch_weights_time_ms": 16.364}, "counters": {"num_env_steps_sampled": 756000, "num_env_steps_trained": 756000, "num_agent_steps_sampled": 3024000, "num_agent_steps_trained": 3024000}, "done": false, "training_iteration": 189, "trial_id": "e4caa_00000", "date": "2024-08-13_23-21-01", "timestamp": 1723605661, "time_this_iter_s": 12.71717095375061, "time_total_s": 12987.824872493744, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2c1f4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 12987.824872493744, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 50.622222222222234, "ram_util_percent": 83.46666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5312037175452267, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.47049908658967565, "policy_loss": -0.01548358997029484, "vf_loss": 0.4859200176867908, "vf_explained_var": 0.6685777616879297, "kl": 0.0059409945675339875, "entropy": 0.7079998694084308, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 358155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.287896817954129, "cur_kl_coeff": 2.570806145248342e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.12934363694595438, "policy_loss": -0.0012366304192544212, "vf_loss": 0.1305802675421416, "vf_explained_var": 0.3211491980565288, "kl": 0.009252973575231775, "entropy": 0.17888504293545213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 358155.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 205.59999999999977, "episode_reward_mean": 365.1119999999999, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 48.79999999999997, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 37.0}, "policy_reward_mean": {"prey_policy": 178.37599999999998, "predator_policy": 4.18}, "custom_metrics": {}, "hist_stats": {"episode_reward": [361.6, 392.8, 352.4, 352.7, 374.0, 372.8, 390.0, 391.0, 368.2, 345.2, 359.8, 363.7, 279.5, 393.7, 394.6, 372.0, 374.0, 373.0, 379.3, 385.5, 349.0, 386.5, 394.6, 360.0, 205.59999999999977, 381.1, 291.0999999999999, 394.6, 385.0, 388.0, 343.7, 370.3, 336.4, 391.5, 391.9, 375.8, 376.2, 382.0, 398.2, 372.9, 390.0, 390.0, 382.0, 385.5, 343.8, 396.0, 309.3, 400.0, 396.4, 398.2, 324.5, 380.6, 375.7, 391.0, 380.2, 380.4, 329.1, 372.5, 397.3, 386.5, 297.0, 347.0, 378.7, 354.8, 356.3, 374.5, 371.4, 240.79999999999947, 384.7, 396.4, 370.6, 389.0, 328.9, 231.49999999999957, 326.59999999999997, 368.2, 374.5, 367.70000000000005, 372.0, 361.0, 350.20000000000005, 387.20000000000005, 379.1, 296.79999999999984, 383.8, 388.9, 315.39999999999986, 353.7, 378.4, 369.5, 367.0, 380.2, 374.8, 384.1, 382.3, 337.40000000000003, 381.0, 377.0, 391.9, 381.7], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [155.9, 193.7, 200.0, 192.8, 155.0, 187.4, 149.3, 187.4, 185.0, 182.0, 163.7, 199.1, 188.0, 197.0, 191.0, 200.0, 173.0, 180.2, 162.2, 161.0, 191.0, 156.8, 182.0, 175.7, 127.1, 97.4, 194.6, 199.1, 200.0, 194.6, 160.0, 197.0, 190.0, 173.0, 197.3, 175.7, 189.2, 190.1, 200.0, 180.5, 169.4, 146.6, 191.9, 194.6, 194.6, 200.0, 182.0, 167.0, 60.49999999999996, 145.1, 187.4, 193.7, 181.1, 109.99999999999997, 200.0, 194.6, 182.0, 197.0, 200.0, 182.0, 167.0, 157.7, 170.3, 200.0, 168.8, 137.6, 195.5, 194.0, 193.7, 198.2, 176.0, 183.8, 186.2, 182.0, 191.9, 190.1, 200.0, 198.2, 178.7, 189.2, 197.0, 193.0, 196.0, 191.0, 167.0, 193.0, 195.2, 185.3, 137.3, 186.5, 194.0, 200.0, 136.1, 135.2, 200.0, 200.0, 200.0, 196.4, 198.2, 200.0, 132.5, 164.0, 179.0, 194.6, 183.8, 191.9, 193.7, 197.3, 191.0, 189.2, 200.0, 172.4, 169.4, 127.7, 179.0, 186.5, 200.0, 197.3, 193.7, 192.8, 164.0, 100.0, 196.0, 140.0, 195.5, 180.2, 171.8, 164.0, 182.0, 143.3, 186.5, 182.0, 176.0, 187.4, 48.79999999999997, 188.0, 184.7, 200.0, 200.0, 196.4, 187.1, 177.5, 197.0, 191.0, 128.89999999999998, 200.0, 54.19999999999996, 167.3, 122.6, 200.0, 164.0, 189.2, 168.5, 194.0, 178.4, 185.29999999999998, 180.0, 191.0, 175.0, 179.0, 196.4, 147.8, 196.39999999999998, 189.8, 178.1, 194.0, 103.69999999999997, 190.1, 200.0, 183.8, 188.3, 194.6, 199.1, 116.29999999999998, 167.29999999999998, 175.4, 196.4, 173.0, 173.0, 186.5, 194.0, 131.0, 197.3, 182.9, 167.0, 192.8, 190.1, 191.0, 200.0, 179.3, 179.0, 151.4, 194.0, 173.0, 195.0, 173.0, 192.8, 199.1, 193.7, 182.0], "policy_predator_policy_reward": [0.0, 12.0, 0.0, 0.0, 3.0, 7.0, 9.0, 7.0, 7.0, 0.0, 10.0, 0.0, 0.0, 5.0, 0.0, 0.0, 9.0, 6.0, 6.0, 16.0, 6.0, 6.0, 6.0, 0.0, 37.0, 18.0, 0.0, 0.0, 0.0, 0.0, 9.0, 6.0, 3.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 13.0, 20.0, 0.0, 0.0, 0.0, 0.0, 11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 19.0, 0.0, 0.0, 21.0, 9.0, 0.0, 2.0, 0.0, 0.0, 8.0, 8.0, 7.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 3.0, 11.0, 11.0, 5.0, 0.0, 20.0, 0.0, 2.0, 0.0, 12.0, 26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 23.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 28.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, 11.0, 2.0, 1.0, 12.0, 7.0, 15.0, 16.0, 0.0, 6.0, 8.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 4.0, 1.0, 3.0, 6.0, 9.0, 9.0, 3.0, 4.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 6.0, 1.0, 0.0, 0.0, 7.0, 0.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 11.0, 0.0, 0.0, 9.0, 5.0, 5.0, 20.0, 22.0, 0.0, 0.0, 9.0, 6.0, 3.0, 0.0, 3.0, 0.0, 7.0, 0.0, 5.0, 9.0, 9.0, 0.0, 0.0, 0.0, 2.0, 4.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3167302649470438, "mean_inference_ms": 11.927891400058439, "mean_action_processing_ms": 3.3212851550023936, "mean_env_wait_ms": 0.40440008731772165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043926239013671875, "StateBufferConnector_ms": 0.008134245872497559, "ViewRequirementAgentConnector_ms": 0.10909390449523926}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 205.59999999999977, "episode_return_mean": 365.1119999999999, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000, "num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.7463651866337, "num_env_steps_trained_throughput_per_sec": 302.7463651866337, "timesteps_total": 760000, "num_env_steps_sampled_lifetime": 760000, "num_agent_steps_sampled_lifetime": 3040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3040000, "timers": {"training_iteration_time_ms": 13075.549, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13075.503, "sample_time_ms": 1597.336, "learn_time_ms": 11456.869, "learn_throughput": 349.136, "synch_weights_time_ms": 16.937}, "counters": {"num_env_steps_sampled": 760000, "num_env_steps_trained": 760000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "done": false, "training_iteration": 190, "trial_id": "e4caa_00000", "date": "2024-08-13_23-21-14", "timestamp": 1723605674, "time_this_iter_s": 13.258146047592163, "time_total_s": 13001.083018541336, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d82430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13001.083018541336, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 51.04736842105263, "ram_util_percent": 83.64210526315789}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5202581889572597, "cur_kl_coeff": 0.010546875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.41942448443573005, "policy_loss": -0.008771411171084438, "vf_loss": 0.42814786574561836, "vf_explained_var": 0.4918459303479977, "kl": 0.0045539767849619404, "entropy": 0.7239530165359457, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 360045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9465363969878545, "cur_kl_coeff": 2.570806145248342e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.23998470876425032, "policy_loss": -0.0017761242269198336, "vf_loss": 0.24176083189273923, "vf_explained_var": 0.16157604140579385, "kl": 0.008961389086555388, "entropy": 0.21839277701718465, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 360045.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 205.59999999999977, "episode_reward_mean": 365.4799999999999, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 48.79999999999997, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 33.0}, "policy_reward_mean": {"prey_policy": 178.76, "predator_policy": 3.98}, "custom_metrics": {}, "hist_stats": {"episode_reward": [360.0, 205.59999999999977, 381.1, 291.0999999999999, 394.6, 385.0, 388.0, 343.7, 370.3, 336.4, 391.5, 391.9, 375.8, 376.2, 382.0, 398.2, 372.9, 390.0, 390.0, 382.0, 385.5, 343.8, 396.0, 309.3, 400.0, 396.4, 398.2, 324.5, 380.6, 375.7, 391.0, 380.2, 380.4, 329.1, 372.5, 397.3, 386.5, 297.0, 347.0, 378.7, 354.8, 356.3, 374.5, 371.4, 240.79999999999947, 384.7, 396.4, 370.6, 389.0, 328.9, 231.49999999999957, 326.59999999999997, 368.2, 374.5, 367.70000000000005, 372.0, 361.0, 350.20000000000005, 387.20000000000005, 379.1, 296.79999999999984, 383.8, 388.9, 315.39999999999986, 353.7, 378.4, 369.5, 367.0, 380.2, 374.8, 384.1, 382.3, 337.40000000000003, 381.0, 377.0, 391.9, 381.7, 393.7, 381.1, 361.8, 391.0, 379.3, 384.2, 366.5, 362.7, 339.6, 322.9, 383.6, 370.6, 360.6, 378.8, 378.1, 343.3, 358.5, 394.0, 393.0, 379.0, 381.7, 370.2, 368.5], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [182.0, 167.0, 60.49999999999996, 145.1, 187.4, 193.7, 181.1, 109.99999999999997, 200.0, 194.6, 182.0, 197.0, 200.0, 182.0, 167.0, 157.7, 170.3, 200.0, 168.8, 137.6, 195.5, 194.0, 193.7, 198.2, 176.0, 183.8, 186.2, 182.0, 191.9, 190.1, 200.0, 198.2, 178.7, 189.2, 197.0, 193.0, 196.0, 191.0, 167.0, 193.0, 195.2, 185.3, 137.3, 186.5, 194.0, 200.0, 136.1, 135.2, 200.0, 200.0, 200.0, 196.4, 198.2, 200.0, 132.5, 164.0, 179.0, 194.6, 183.8, 191.9, 193.7, 197.3, 191.0, 189.2, 200.0, 172.4, 169.4, 127.7, 179.0, 186.5, 200.0, 197.3, 193.7, 192.8, 164.0, 100.0, 196.0, 140.0, 195.5, 180.2, 171.8, 164.0, 182.0, 143.3, 186.5, 182.0, 176.0, 187.4, 48.79999999999997, 188.0, 184.7, 200.0, 200.0, 196.4, 187.1, 177.5, 197.0, 191.0, 128.89999999999998, 200.0, 54.19999999999996, 167.3, 122.6, 200.0, 164.0, 189.2, 168.5, 194.0, 178.4, 185.29999999999998, 180.0, 191.0, 175.0, 179.0, 196.4, 147.8, 196.39999999999998, 189.8, 178.1, 194.0, 103.69999999999997, 190.1, 200.0, 183.8, 188.3, 194.6, 199.1, 116.29999999999998, 167.29999999999998, 175.4, 196.4, 173.0, 173.0, 186.5, 194.0, 131.0, 197.3, 182.9, 167.0, 192.8, 190.1, 191.0, 200.0, 179.3, 179.0, 151.4, 194.0, 173.0, 195.0, 173.0, 192.8, 199.1, 193.7, 182.0, 200.0, 193.7, 146.0, 199.1, 174.5, 173.3, 197.3, 193.7, 199.1, 180.2, 178.1, 199.1, 186.5, 170.0, 169.4, 182.3, 185.0, 149.6, 128.0, 173.9, 188.9, 193.7, 167.6, 200.0, 179.6, 164.0, 179.0, 192.8, 179.0, 190.1, 188.0, 137.3, 182.6, 161.9, 200.0, 194.0, 192.0, 200.0, 185.0, 185.0, 188.0, 187.7, 192.8, 172.4, 195.5, 173.0], "policy_predator_policy_reward": [11.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 6.0, 0.0, 0.0, 19.0, 0.0, 0.0, 21.0, 9.0, 0.0, 2.0, 0.0, 0.0, 8.0, 8.0, 7.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 0.0, 0.0, 0.0, 3.0, 11.0, 11.0, 5.0, 0.0, 20.0, 0.0, 2.0, 0.0, 12.0, 26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 23.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 28.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, 11.0, 2.0, 1.0, 12.0, 7.0, 15.0, 16.0, 0.0, 6.0, 8.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 4.0, 1.0, 3.0, 6.0, 9.0, 9.0, 3.0, 4.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 6.0, 1.0, 0.0, 0.0, 7.0, 0.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 11.0, 0.0, 0.0, 9.0, 5.0, 5.0, 20.0, 22.0, 0.0, 0.0, 9.0, 6.0, 3.0, 0.0, 3.0, 0.0, 7.0, 0.0, 5.0, 9.0, 9.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 18.0, 18.0, 1.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 10.0, 6.0, 5.0, 5.0, 0.0, 0.0, 21.0, 1.0, 0.0, 0.0, 3.0, 12.0, 5.0, 7.0, 0.0, 0.0, 9.0, 0.0, 18.0, 4.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 2.0, 4.0, 5.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3093624226206788, "mean_inference_ms": 11.61332253101963, "mean_action_processing_ms": 3.4364113446794358, "mean_env_wait_ms": 0.40310956269091763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004017233848571777, "StateBufferConnector_ms": 0.008562326431274414, "ViewRequirementAgentConnector_ms": 0.11130523681640625}, "num_episodes": 23, "episode_return_max": 400.0, "episode_return_min": 205.59999999999977, "episode_return_mean": 365.4799999999999, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000, "num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.29681957530903, "num_env_steps_trained_throughput_per_sec": 296.29681957530903, "timesteps_total": 764000, "num_env_steps_sampled_lifetime": 764000, "num_agent_steps_sampled_lifetime": 3056000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3056000, "timers": {"training_iteration_time_ms": 13103.95, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13103.904, "sample_time_ms": 1591.217, "learn_time_ms": 11488.861, "learn_throughput": 348.163, "synch_weights_time_ms": 17.654}, "counters": {"num_env_steps_sampled": 764000, "num_env_steps_trained": 764000, "num_agent_steps_sampled": 3056000, "num_agent_steps_trained": 3056000}, "done": false, "training_iteration": 191, "trial_id": "e4caa_00000", "date": "2024-08-13_23-21-28", "timestamp": 1723605688, "time_this_iter_s": 13.57128095626831, "time_total_s": 13014.654299497604, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d84670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13014.654299497604, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 54.98421052631578, "ram_util_percent": 83.27368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8619511110284341, "cur_kl_coeff": 0.0052734375, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.452157641878452, "policy_loss": -0.009330455245937974, "vf_loss": 0.46142293142854535, "vf_explained_var": 0.511429000090039, "kl": 0.0123576096397963, "entropy": 0.6532068168675458, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 361935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2868045687360108, "cur_kl_coeff": 2.570806145248342e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.27428261315617614, "policy_loss": -0.0016427737631140248, "vf_loss": 0.27592538546218914, "vf_explained_var": 0.23141026194133454, "kl": 0.005148726201095468, "entropy": 0.21411637450179094, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 361935.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 231.49999999999957, "episode_reward_mean": 367.5879999999999, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 48.79999999999997, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 33.0}, "policy_reward_mean": {"prey_policy": 179.87900000000002, "predator_policy": 3.915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [396.0, 309.3, 400.0, 396.4, 398.2, 324.5, 380.6, 375.7, 391.0, 380.2, 380.4, 329.1, 372.5, 397.3, 386.5, 297.0, 347.0, 378.7, 354.8, 356.3, 374.5, 371.4, 240.79999999999947, 384.7, 396.4, 370.6, 389.0, 328.9, 231.49999999999957, 326.59999999999997, 368.2, 374.5, 367.70000000000005, 372.0, 361.0, 350.20000000000005, 387.20000000000005, 379.1, 296.79999999999984, 383.8, 388.9, 315.39999999999986, 353.7, 378.4, 369.5, 367.0, 380.2, 374.8, 384.1, 382.3, 337.40000000000003, 381.0, 377.0, 391.9, 381.7, 393.7, 381.1, 361.8, 391.0, 379.3, 384.2, 366.5, 362.7, 339.6, 322.9, 383.6, 370.6, 360.6, 378.8, 378.1, 343.3, 358.5, 394.0, 393.0, 379.0, 381.7, 370.2, 368.5, 383.8, 358.7, 357.8, 359.0, 383.7, 341.0, 400.0, 375.9, 375.0, 367.6, 391.0, 349.8, 388.0, 370.6, 370.4, 360.5, 400.0, 362.8, 383.0, 384.0, 389.2, 394.6], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [194.0, 200.0, 136.1, 135.2, 200.0, 200.0, 200.0, 196.4, 198.2, 200.0, 132.5, 164.0, 179.0, 194.6, 183.8, 191.9, 193.7, 197.3, 191.0, 189.2, 200.0, 172.4, 169.4, 127.7, 179.0, 186.5, 200.0, 197.3, 193.7, 192.8, 164.0, 100.0, 196.0, 140.0, 195.5, 180.2, 171.8, 164.0, 182.0, 143.3, 186.5, 182.0, 176.0, 187.4, 48.79999999999997, 188.0, 184.7, 200.0, 200.0, 196.4, 187.1, 177.5, 197.0, 191.0, 128.89999999999998, 200.0, 54.19999999999996, 167.3, 122.6, 200.0, 164.0, 189.2, 168.5, 194.0, 178.4, 185.29999999999998, 180.0, 191.0, 175.0, 179.0, 196.4, 147.8, 196.39999999999998, 189.8, 178.1, 194.0, 103.69999999999997, 190.1, 200.0, 183.8, 188.3, 194.6, 199.1, 116.29999999999998, 167.29999999999998, 175.4, 196.4, 173.0, 173.0, 186.5, 194.0, 131.0, 197.3, 182.9, 167.0, 192.8, 190.1, 191.0, 200.0, 179.3, 179.0, 151.4, 194.0, 173.0, 195.0, 173.0, 192.8, 199.1, 193.7, 182.0, 200.0, 193.7, 146.0, 199.1, 174.5, 173.3, 197.3, 193.7, 199.1, 180.2, 178.1, 199.1, 186.5, 170.0, 169.4, 182.3, 185.0, 149.6, 128.0, 173.9, 188.9, 193.7, 167.6, 200.0, 179.6, 164.0, 179.0, 192.8, 179.0, 190.1, 188.0, 137.3, 182.6, 161.9, 200.0, 194.0, 192.0, 200.0, 185.0, 185.0, 188.0, 187.7, 192.8, 172.4, 195.5, 173.0, 200.0, 183.8, 173.0, 175.7, 145.1, 193.7, 191.0, 152.0, 182.3, 196.4, 155.0, 158.0, 200.0, 200.0, 175.1, 192.8, 196.4, 170.6, 167.6, 200.0, 191.0, 200.0, 171.5, 170.3, 182.0, 200.0, 164.0, 194.6, 179.0, 187.4, 168.5, 188.0, 200.0, 200.0, 165.8, 191.0, 185.0, 198.0, 196.0, 182.0, 189.2, 200.0, 200.0, 194.6], "policy_predator_policy_reward": [2.0, 0.0, 12.0, 26.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 5.0, 23.0, 7.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 4.0, 28.0, 6.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 33.0, 0.0, 11.0, 2.0, 1.0, 12.0, 7.0, 15.0, 16.0, 0.0, 6.0, 8.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 4.0, 1.0, 3.0, 6.0, 9.0, 9.0, 3.0, 4.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 6.0, 1.0, 0.0, 0.0, 7.0, 0.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 11.0, 0.0, 0.0, 9.0, 5.0, 5.0, 20.0, 22.0, 0.0, 0.0, 9.0, 6.0, 3.0, 0.0, 3.0, 0.0, 7.0, 0.0, 5.0, 9.0, 9.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 18.0, 18.0, 1.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 10.0, 6.0, 5.0, 5.0, 0.0, 0.0, 21.0, 1.0, 0.0, 0.0, 3.0, 12.0, 5.0, 7.0, 0.0, 0.0, 9.0, 0.0, 18.0, 4.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 2.0, 4.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 4.0, 15.0, 0.0, 16.0, 5.0, 0.0, 13.0, 15.0, 0.0, 0.0, 8.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 5.0, 12.0, 0.0, 4.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.309383066053012, "mean_inference_ms": 11.813118109012981, "mean_action_processing_ms": 3.2856145895218556, "mean_env_wait_ms": 0.4024337085071012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004147052764892578, "StateBufferConnector_ms": 0.008867979049682617, "ViewRequirementAgentConnector_ms": 0.11443102359771729}, "num_episodes": 22, "episode_return_max": 400.0, "episode_return_min": 231.49999999999957, "episode_return_mean": 367.5879999999999, "episodes_this_iter": 22}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000, "num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 258.9158653102348, "num_env_steps_trained_throughput_per_sec": 258.9158653102348, "timesteps_total": 768000, "num_env_steps_sampled_lifetime": 768000, "num_agent_steps_sampled_lifetime": 3072000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3072000, "timers": {"training_iteration_time_ms": 13377.375, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13377.328, "sample_time_ms": 1676.765, "learn_time_ms": 11675.592, "learn_throughput": 342.595, "synch_weights_time_ms": 18.501}, "counters": {"num_env_steps_sampled": 768000, "num_env_steps_trained": 768000, "num_agent_steps_sampled": 3072000, "num_agent_steps_trained": 3072000}, "done": false, "training_iteration": 192, "trial_id": "e4caa_00000", "date": "2024-08-13_23-21-43", "timestamp": 1723605703, "time_this_iter_s": 15.609047174453735, "time_total_s": 13030.263346672058, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b8f550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13030.263346672058, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 67.51818181818182, "ram_util_percent": 83.10454545454546}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.445760878699797, "cur_kl_coeff": 0.0052734375, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5418104416552794, "policy_loss": -0.011488311926996897, "vf_loss": 0.5532583341247614, "vf_explained_var": 0.4802668712757252, "kl": 0.007664618440752564, "entropy": 0.6244323543139867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 363825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5610284020661047, "cur_kl_coeff": 2.570806145248342e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4306335236502703, "policy_loss": -0.001412146681890128, "vf_loss": 0.4320456690204246, "vf_explained_var": 0.10059226975239142, "kl": 0.03143235548297459, "entropy": 0.26932499892812556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 363825.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 231.49999999999957, "episode_reward_mean": 367.425, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 48.79999999999997, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 22.0}, "policy_reward_mean": {"prey_policy": 179.8725, "predator_policy": 3.84}, "custom_metrics": {}, "hist_stats": {"episode_reward": [354.8, 356.3, 374.5, 371.4, 240.79999999999947, 384.7, 396.4, 370.6, 389.0, 328.9, 231.49999999999957, 326.59999999999997, 368.2, 374.5, 367.70000000000005, 372.0, 361.0, 350.20000000000005, 387.20000000000005, 379.1, 296.79999999999984, 383.8, 388.9, 315.39999999999986, 353.7, 378.4, 369.5, 367.0, 380.2, 374.8, 384.1, 382.3, 337.40000000000003, 381.0, 377.0, 391.9, 381.7, 393.7, 381.1, 361.8, 391.0, 379.3, 384.2, 366.5, 362.7, 339.6, 322.9, 383.6, 370.6, 360.6, 378.8, 378.1, 343.3, 358.5, 394.0, 393.0, 379.0, 381.7, 370.2, 368.5, 383.8, 358.7, 357.8, 359.0, 383.7, 341.0, 400.0, 375.9, 375.0, 367.6, 391.0, 349.8, 388.0, 370.6, 370.4, 360.5, 400.0, 362.8, 383.0, 384.0, 389.2, 394.6, 355.3, 350.3, 379.0, 359.8, 372.3, 347.1, 356.9, 393.7, 391.9, 349.70000000000005, 363.5, 373.0, 344.2, 355.40000000000003, 394.0, 380.0, 384.7, 373.3], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [171.8, 164.0, 182.0, 143.3, 186.5, 182.0, 176.0, 187.4, 48.79999999999997, 188.0, 184.7, 200.0, 200.0, 196.4, 187.1, 177.5, 197.0, 191.0, 128.89999999999998, 200.0, 54.19999999999996, 167.3, 122.6, 200.0, 164.0, 189.2, 168.5, 194.0, 178.4, 185.29999999999998, 180.0, 191.0, 175.0, 179.0, 196.4, 147.8, 196.39999999999998, 189.8, 178.1, 194.0, 103.69999999999997, 190.1, 200.0, 183.8, 188.3, 194.6, 199.1, 116.29999999999998, 167.29999999999998, 175.4, 196.4, 173.0, 173.0, 186.5, 194.0, 131.0, 197.3, 182.9, 167.0, 192.8, 190.1, 191.0, 200.0, 179.3, 179.0, 151.4, 194.0, 173.0, 195.0, 173.0, 192.8, 199.1, 193.7, 182.0, 200.0, 193.7, 146.0, 199.1, 174.5, 173.3, 197.3, 193.7, 199.1, 180.2, 178.1, 199.1, 186.5, 170.0, 169.4, 182.3, 185.0, 149.6, 128.0, 173.9, 188.9, 193.7, 167.6, 200.0, 179.6, 164.0, 179.0, 192.8, 179.0, 190.1, 188.0, 137.3, 182.6, 161.9, 200.0, 194.0, 192.0, 200.0, 185.0, 185.0, 188.0, 187.7, 192.8, 172.4, 195.5, 173.0, 200.0, 183.8, 173.0, 175.7, 145.1, 193.7, 191.0, 152.0, 182.3, 196.4, 155.0, 158.0, 200.0, 200.0, 175.1, 192.8, 196.4, 170.6, 167.6, 200.0, 191.0, 200.0, 171.5, 170.3, 182.0, 200.0, 164.0, 194.6, 179.0, 187.4, 168.5, 188.0, 200.0, 200.0, 165.8, 191.0, 185.0, 198.0, 196.0, 182.0, 189.2, 200.0, 200.0, 194.6, 170.3, 161.0, 141.20000000000005, 199.1, 180.2, 192.8, 194.6, 162.2, 197.3, 167.0, 191.0, 136.1, 160.1, 183.8, 200.0, 193.7, 200.0, 191.9, 199.1, 140.6, 152.0, 195.5, 200.0, 158.0, 170.6, 167.6, 148.39999999999998, 200.0, 194.0, 200.0, 188.0, 188.0, 189.2, 195.5, 182.3, 179.0], "policy_predator_policy_reward": [12.0, 7.0, 15.0, 16.0, 0.0, 6.0, 8.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 1.0, 0.0, 0.0, 6.0, 4.0, 1.0, 3.0, 6.0, 9.0, 9.0, 3.0, 4.0, 0.0, 0.0, 1.0, 0.0, 7.0, 0.0, 6.0, 1.0, 0.0, 0.0, 7.0, 0.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 11.0, 0.0, 0.0, 9.0, 5.0, 5.0, 20.0, 22.0, 0.0, 0.0, 9.0, 6.0, 3.0, 0.0, 3.0, 0.0, 7.0, 0.0, 5.0, 9.0, 9.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 18.0, 18.0, 1.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 10.0, 6.0, 5.0, 5.0, 0.0, 0.0, 21.0, 1.0, 0.0, 0.0, 3.0, 12.0, 5.0, 7.0, 0.0, 0.0, 9.0, 0.0, 18.0, 4.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 2.0, 4.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 4.0, 15.0, 0.0, 16.0, 5.0, 0.0, 13.0, 15.0, 0.0, 0.0, 8.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 5.0, 12.0, 0.0, 4.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 10.0, 14.0, 10.0, 0.0, 0.0, 6.0, 3.0, 0.0, 5.0, 3.0, 8.0, 12.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 16.0, 11.0, 4.0, 6.0, 0.0, 0.0, 7.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 5.0, 7.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3066430422400799, "mean_inference_ms": 11.767221261024329, "mean_action_processing_ms": 3.2713170095801174, "mean_env_wait_ms": 0.40168847900126436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004253029823303223, "StateBufferConnector_ms": 0.008966445922851562, "ViewRequirementAgentConnector_ms": 0.12340497970581055}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 231.49999999999957, "episode_return_mean": 367.425, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000, "num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.3923847262316, "num_env_steps_trained_throughput_per_sec": 285.3923847262316, "timesteps_total": 772000, "num_env_steps_sampled_lifetime": 772000, "num_agent_steps_sampled_lifetime": 3088000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3088000, "timers": {"training_iteration_time_ms": 13461.842, "restore_workers_time_ms": 0.014, "training_step_time_ms": 13461.79, "sample_time_ms": 1681.348, "learn_time_ms": 11754.13, "learn_throughput": 340.306, "synch_weights_time_ms": 19.787}, "counters": {"num_env_steps_sampled": 772000, "num_env_steps_trained": 772000, "num_agent_steps_sampled": 3088000, "num_agent_steps_trained": 3088000}, "done": false, "training_iteration": 193, "trial_id": "e4caa_00000", "date": "2024-08-13_23-21-58", "timestamp": 1723605718, "time_this_iter_s": 14.275514841079712, "time_total_s": 13044.538861513138, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2b38c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13044.538861513138, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 62.776190476190486, "ram_util_percent": 82.74285714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.634455598354655, "cur_kl_coeff": 0.0052734375, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.39090535607190174, "policy_loss": -0.007595035080581155, "vf_loss": 0.3984698727687515, "vf_explained_var": 0.3845580919079049, "kl": 0.00578723912323728, "entropy": 0.6378149270380615, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 365715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2829812704886079, "cur_kl_coeff": 3.856209217872515e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.21930689971164735, "policy_loss": -0.00242918079778079, "vf_loss": 0.2217360803811865, "vf_explained_var": 0.2390618468087817, "kl": 0.011959775198719508, "entropy": 0.2110355797544043, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 365715.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 288.6, "episode_reward_mean": 370.528, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 103.69999999999997, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 26.0}, "policy_reward_mean": {"prey_policy": 181.21900000000002, "predator_policy": 4.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [387.20000000000005, 379.1, 296.79999999999984, 383.8, 388.9, 315.39999999999986, 353.7, 378.4, 369.5, 367.0, 380.2, 374.8, 384.1, 382.3, 337.40000000000003, 381.0, 377.0, 391.9, 381.7, 393.7, 381.1, 361.8, 391.0, 379.3, 384.2, 366.5, 362.7, 339.6, 322.9, 383.6, 370.6, 360.6, 378.8, 378.1, 343.3, 358.5, 394.0, 393.0, 379.0, 381.7, 370.2, 368.5, 383.8, 358.7, 357.8, 359.0, 383.7, 341.0, 400.0, 375.9, 375.0, 367.6, 391.0, 349.8, 388.0, 370.6, 370.4, 360.5, 400.0, 362.8, 383.0, 384.0, 389.2, 394.6, 355.3, 350.3, 379.0, 359.8, 372.3, 347.1, 356.9, 393.7, 391.9, 349.70000000000005, 363.5, 373.0, 344.2, 355.40000000000003, 394.0, 380.0, 384.7, 373.3, 396.2, 374.1, 355.79999999999995, 369.4, 387.7, 360.6, 375.1, 364.0, 359.6, 356.9, 378.4, 350.8, 288.6, 389.2, 366.0, 370.0, 387.9, 399.1], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [196.39999999999998, 189.8, 178.1, 194.0, 103.69999999999997, 190.1, 200.0, 183.8, 188.3, 194.6, 199.1, 116.29999999999998, 167.29999999999998, 175.4, 196.4, 173.0, 173.0, 186.5, 194.0, 131.0, 197.3, 182.9, 167.0, 192.8, 190.1, 191.0, 200.0, 179.3, 179.0, 151.4, 194.0, 173.0, 195.0, 173.0, 192.8, 199.1, 193.7, 182.0, 200.0, 193.7, 146.0, 199.1, 174.5, 173.3, 197.3, 193.7, 199.1, 180.2, 178.1, 199.1, 186.5, 170.0, 169.4, 182.3, 185.0, 149.6, 128.0, 173.9, 188.9, 193.7, 167.6, 200.0, 179.6, 164.0, 179.0, 192.8, 179.0, 190.1, 188.0, 137.3, 182.6, 161.9, 200.0, 194.0, 192.0, 200.0, 185.0, 185.0, 188.0, 187.7, 192.8, 172.4, 195.5, 173.0, 200.0, 183.8, 173.0, 175.7, 145.1, 193.7, 191.0, 152.0, 182.3, 196.4, 155.0, 158.0, 200.0, 200.0, 175.1, 192.8, 196.4, 170.6, 167.6, 200.0, 191.0, 200.0, 171.5, 170.3, 182.0, 200.0, 164.0, 194.6, 179.0, 187.4, 168.5, 188.0, 200.0, 200.0, 165.8, 191.0, 185.0, 198.0, 196.0, 182.0, 189.2, 200.0, 200.0, 194.6, 170.3, 161.0, 141.20000000000005, 199.1, 180.2, 192.8, 194.6, 162.2, 197.3, 167.0, 191.0, 136.1, 160.1, 183.8, 200.0, 193.7, 200.0, 191.9, 199.1, 140.6, 152.0, 195.5, 200.0, 158.0, 170.6, 167.6, 148.39999999999998, 200.0, 194.0, 200.0, 188.0, 188.0, 189.2, 195.5, 182.3, 179.0, 200.0, 195.2, 184.1, 179.0, 196.39999999999998, 118.4, 187.4, 173.0, 191.0, 193.7, 186.5, 166.1, 197.0, 172.1, 177.5, 186.5, 185.6, 161.0, 143.0, 191.9, 186.5, 191.9, 181.1, 148.7, 117.5, 145.1, 200.0, 189.2, 171.0, 188.0, 185.0, 180.0, 188.6, 197.3, 199.1, 200.0], "policy_predator_policy_reward": [1.0, 0.0, 0.0, 7.0, 0.0, 3.0, 0.0, 0.0, 3.0, 3.0, 0.0, 0.0, 11.0, 0.0, 0.0, 9.0, 5.0, 5.0, 20.0, 22.0, 0.0, 0.0, 9.0, 6.0, 3.0, 0.0, 3.0, 0.0, 7.0, 0.0, 5.0, 9.0, 9.0, 0.0, 0.0, 0.0, 2.0, 4.0, 0.0, 0.0, 18.0, 18.0, 1.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 10.0, 6.0, 5.0, 5.0, 0.0, 0.0, 21.0, 1.0, 0.0, 0.0, 3.0, 12.0, 5.0, 7.0, 0.0, 0.0, 9.0, 0.0, 18.0, 4.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 2.0, 4.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 4.0, 15.0, 0.0, 16.0, 5.0, 0.0, 13.0, 15.0, 0.0, 0.0, 8.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 5.0, 12.0, 0.0, 4.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 10.0, 14.0, 10.0, 0.0, 0.0, 6.0, 3.0, 0.0, 5.0, 3.0, 8.0, 12.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 16.0, 11.0, 4.0, 6.0, 0.0, 0.0, 7.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 5.0, 7.0, 0.0, 1.0, 0.0, 11.0, 25.0, 16.0, 9.0, 0.0, 0.0, 3.0, 3.0, 5.0, 0.0, 6.0, 0.0, 0.0, 2.0, 11.0, 7.0, 15.0, 0.0, 0.0, 6.0, 15.0, 26.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3044120663066732, "mean_inference_ms": 11.723038582782062, "mean_action_processing_ms": 3.257416246575923, "mean_env_wait_ms": 0.401123824709138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042983293533325195, "StateBufferConnector_ms": 0.005749821662902832, "ViewRequirementAgentConnector_ms": 0.1303156614303589}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 288.6, "episode_return_mean": 370.528, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000, "num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.08423192647297, "num_env_steps_trained_throughput_per_sec": 302.08423192647297, "timesteps_total": 776000, "num_env_steps_sampled_lifetime": 776000, "num_agent_steps_sampled_lifetime": 3104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3104000, "timers": {"training_iteration_time_ms": 13440.349, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13440.28, "sample_time_ms": 1791.757, "learn_time_ms": 11621.97, "learn_throughput": 344.176, "synch_weights_time_ms": 20.021}, "counters": {"num_env_steps_sampled": 776000, "num_env_steps_trained": 776000, "num_agent_steps_sampled": 3104000, "num_agent_steps_trained": 3104000}, "done": false, "training_iteration": 194, "trial_id": "e4caa_00000", "date": "2024-08-13_23-22-11", "timestamp": 1723605731, "time_this_iter_s": 13.300444841384888, "time_total_s": 13057.839306354523, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2c1e040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13057.839306354523, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 54.505263157894746, "ram_util_percent": 81.57894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6553681701106369, "cur_kl_coeff": 0.0052734375, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.47443662455142843, "policy_loss": -0.009853977860301417, "vf_loss": 0.4842667079446887, "vf_explained_var": 0.48952154378411633, "kl": 0.004531180672770533, "entropy": 0.6503492341155097, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 367605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.678802990022475, "cur_kl_coeff": 3.856209217872515e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.3227625955349554, "policy_loss": -0.0013258344720477465, "vf_loss": 0.3240884301751586, "vf_explained_var": 0.09564180408836041, "kl": 0.007962078571338597, "entropy": 0.3287263829714407, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 367605.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 288.6, "episode_reward_mean": 371.541, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 117.5, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 26.0}, "policy_reward_mean": {"prey_policy": 181.7305, "predator_policy": 4.04}, "custom_metrics": {}, "hist_stats": {"episode_reward": [381.7, 393.7, 381.1, 361.8, 391.0, 379.3, 384.2, 366.5, 362.7, 339.6, 322.9, 383.6, 370.6, 360.6, 378.8, 378.1, 343.3, 358.5, 394.0, 393.0, 379.0, 381.7, 370.2, 368.5, 383.8, 358.7, 357.8, 359.0, 383.7, 341.0, 400.0, 375.9, 375.0, 367.6, 391.0, 349.8, 388.0, 370.6, 370.4, 360.5, 400.0, 362.8, 383.0, 384.0, 389.2, 394.6, 355.3, 350.3, 379.0, 359.8, 372.3, 347.1, 356.9, 393.7, 391.9, 349.70000000000005, 363.5, 373.0, 344.2, 355.40000000000003, 394.0, 380.0, 384.7, 373.3, 396.2, 374.1, 355.79999999999995, 369.4, 387.7, 360.6, 375.1, 364.0, 359.6, 356.9, 378.4, 350.8, 288.6, 389.2, 366.0, 370.0, 387.9, 399.1, 343.7, 369.2, 380.0, 390.6, 378.0, 321.9, 391.9, 378.4, 388.3, 386.2, 363.3, 389.0, 378.1, 400.0, 350.0, 386.0, 384.2, 351.0], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [193.7, 182.0, 200.0, 193.7, 146.0, 199.1, 174.5, 173.3, 197.3, 193.7, 199.1, 180.2, 178.1, 199.1, 186.5, 170.0, 169.4, 182.3, 185.0, 149.6, 128.0, 173.9, 188.9, 193.7, 167.6, 200.0, 179.6, 164.0, 179.0, 192.8, 179.0, 190.1, 188.0, 137.3, 182.6, 161.9, 200.0, 194.0, 192.0, 200.0, 185.0, 185.0, 188.0, 187.7, 192.8, 172.4, 195.5, 173.0, 200.0, 183.8, 173.0, 175.7, 145.1, 193.7, 191.0, 152.0, 182.3, 196.4, 155.0, 158.0, 200.0, 200.0, 175.1, 192.8, 196.4, 170.6, 167.6, 200.0, 191.0, 200.0, 171.5, 170.3, 182.0, 200.0, 164.0, 194.6, 179.0, 187.4, 168.5, 188.0, 200.0, 200.0, 165.8, 191.0, 185.0, 198.0, 196.0, 182.0, 189.2, 200.0, 200.0, 194.6, 170.3, 161.0, 141.20000000000005, 199.1, 180.2, 192.8, 194.6, 162.2, 197.3, 167.0, 191.0, 136.1, 160.1, 183.8, 200.0, 193.7, 200.0, 191.9, 199.1, 140.6, 152.0, 195.5, 200.0, 158.0, 170.6, 167.6, 148.39999999999998, 200.0, 194.0, 200.0, 188.0, 188.0, 189.2, 195.5, 182.3, 179.0, 200.0, 195.2, 184.1, 179.0, 196.39999999999998, 118.4, 187.4, 173.0, 191.0, 193.7, 186.5, 166.1, 197.0, 172.1, 177.5, 186.5, 185.6, 161.0, 143.0, 191.9, 186.5, 191.9, 181.1, 148.7, 117.5, 145.1, 200.0, 189.2, 171.0, 188.0, 185.0, 180.0, 188.6, 197.3, 199.1, 200.0, 154.7, 182.0, 174.5, 193.7, 170.0, 200.0, 194.0, 194.6, 188.0, 179.0, 170.0, 125.9, 200.0, 191.9, 179.3, 199.1, 200.0, 188.3, 200.0, 180.2, 175.1, 180.2, 195.5, 192.5, 199.1, 155.0, 200.0, 200.0, 184.0, 165.0, 186.0, 200.0, 173.0, 198.2, 197.0, 125.0], "policy_predator_policy_reward": [2.0, 4.0, 0.0, 0.0, 18.0, 18.0, 1.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 10.0, 6.0, 5.0, 5.0, 0.0, 0.0, 21.0, 1.0, 0.0, 0.0, 3.0, 12.0, 5.0, 7.0, 0.0, 0.0, 9.0, 0.0, 18.0, 4.0, 10.0, 0.0, 0.0, 0.0, 1.0, 0.0, 9.0, 2.0, 4.0, 5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 4.0, 15.0, 0.0, 16.0, 5.0, 0.0, 13.0, 15.0, 0.0, 0.0, 8.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 5.0, 12.0, 0.0, 4.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 10.0, 14.0, 10.0, 0.0, 0.0, 6.0, 3.0, 0.0, 5.0, 3.0, 8.0, 12.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 16.0, 11.0, 4.0, 6.0, 0.0, 0.0, 7.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 5.0, 7.0, 0.0, 1.0, 0.0, 11.0, 25.0, 16.0, 9.0, 0.0, 0.0, 3.0, 3.0, 5.0, 0.0, 6.0, 0.0, 0.0, 2.0, 11.0, 7.0, 15.0, 0.0, 0.0, 6.0, 15.0, 26.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 7.0, 0.0, 1.0, 0.0, 10.0, 0.0, 2.0, 0.0, 7.0, 4.0, 10.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 0.0, 0.0, 1.0, 14.0, 10.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 8.0, 5.0, 13.0, 16.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3023119491147903, "mean_inference_ms": 11.679472133225731, "mean_action_processing_ms": 3.243675964740172, "mean_env_wait_ms": 0.40056571252580186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004439234733581543, "StateBufferConnector_ms": 0.00427091121673584, "ViewRequirementAgentConnector_ms": 0.13962912559509277}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 288.6, "episode_return_mean": 371.541, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000, "num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.09655225066865, "num_env_steps_trained_throughput_per_sec": 302.09655225066865, "timesteps_total": 780000, "num_env_steps_sampled_lifetime": 780000, "num_agent_steps_sampled_lifetime": 3120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3120000, "timers": {"training_iteration_time_ms": 13454.536, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13454.466, "sample_time_ms": 1814.374, "learn_time_ms": 11613.558, "learn_throughput": 344.425, "synch_weights_time_ms": 20.104}, "counters": {"num_env_steps_sampled": 780000, "num_env_steps_trained": 780000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "done": false, "training_iteration": 195, "trial_id": "e4caa_00000", "date": "2024-08-13_23-22-24", "timestamp": 1723605744, "time_this_iter_s": 13.274538040161133, "time_total_s": 13071.113844394684, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2c1e280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13071.113844394684, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 55.4, "ram_util_percent": 80.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.943733048218268, "cur_kl_coeff": 0.00263671875, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6569861465754608, "policy_loss": -0.005650495770436628, "vf_loss": 0.6626237151897931, "vf_explained_var": 0.5772415570165745, "kl": 0.004903038828626944, "entropy": 0.6503762845009092, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 369495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8963777089875842, "cur_kl_coeff": 3.856209217872515e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.32829895552504, "policy_loss": -0.0007667802784237124, "vf_loss": 0.3290657356925304, "vf_explained_var": 0.13917179277965, "kl": 0.004559113080179179, "entropy": 0.22390412812825863, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 369495.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 288.6, "episode_reward_mean": 368.961, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 95.3000000000001, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 26.0}, "policy_reward_mean": {"prey_policy": 180.4505, "predator_policy": 4.03}, "custom_metrics": {}, "hist_stats": {"episode_reward": [359.0, 383.7, 341.0, 400.0, 375.9, 375.0, 367.6, 391.0, 349.8, 388.0, 370.6, 370.4, 360.5, 400.0, 362.8, 383.0, 384.0, 389.2, 394.6, 355.3, 350.3, 379.0, 359.8, 372.3, 347.1, 356.9, 393.7, 391.9, 349.70000000000005, 363.5, 373.0, 344.2, 355.40000000000003, 394.0, 380.0, 384.7, 373.3, 396.2, 374.1, 355.79999999999995, 369.4, 387.7, 360.6, 375.1, 364.0, 359.6, 356.9, 378.4, 350.8, 288.6, 389.2, 366.0, 370.0, 387.9, 399.1, 343.7, 369.2, 380.0, 390.6, 378.0, 321.9, 391.9, 378.4, 388.3, 386.2, 363.3, 389.0, 378.1, 400.0, 350.0, 386.0, 384.2, 351.0, 384.2, 387.0, 389.5, 347.4, 288.8, 380.2, 359.7, 354.0, 367.1, 386.4, 352.0, 354.5, 327.7, 377.5, 355.0, 314.4999999999999, 367.6, 367.4, 385.6, 351.4, 352.30000000000007, 384.0, 376.0, 361.0, 366.0, 376.6, 353.3], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [191.0, 152.0, 182.3, 196.4, 155.0, 158.0, 200.0, 200.0, 175.1, 192.8, 196.4, 170.6, 167.6, 200.0, 191.0, 200.0, 171.5, 170.3, 182.0, 200.0, 164.0, 194.6, 179.0, 187.4, 168.5, 188.0, 200.0, 200.0, 165.8, 191.0, 185.0, 198.0, 196.0, 182.0, 189.2, 200.0, 200.0, 194.6, 170.3, 161.0, 141.20000000000005, 199.1, 180.2, 192.8, 194.6, 162.2, 197.3, 167.0, 191.0, 136.1, 160.1, 183.8, 200.0, 193.7, 200.0, 191.9, 199.1, 140.6, 152.0, 195.5, 200.0, 158.0, 170.6, 167.6, 148.39999999999998, 200.0, 194.0, 200.0, 188.0, 188.0, 189.2, 195.5, 182.3, 179.0, 200.0, 195.2, 184.1, 179.0, 196.39999999999998, 118.4, 187.4, 173.0, 191.0, 193.7, 186.5, 166.1, 197.0, 172.1, 177.5, 186.5, 185.6, 161.0, 143.0, 191.9, 186.5, 191.9, 181.1, 148.7, 117.5, 145.1, 200.0, 189.2, 171.0, 188.0, 185.0, 180.0, 188.6, 197.3, 199.1, 200.0, 154.7, 182.0, 174.5, 193.7, 170.0, 200.0, 194.0, 194.6, 188.0, 179.0, 170.0, 125.9, 200.0, 191.9, 179.3, 199.1, 200.0, 188.3, 200.0, 180.2, 175.1, 180.2, 195.5, 192.5, 199.1, 155.0, 200.0, 200.0, 184.0, 165.0, 186.0, 200.0, 173.0, 198.2, 197.0, 125.0, 199.1, 178.1, 191.0, 194.0, 195.5, 191.0, 176.0, 160.4, 177.5, 95.3000000000001, 192.8, 187.4, 172.7, 170.0, 158.0, 182.0, 184.7, 175.4, 200.0, 181.4, 161.9, 175.1, 200.0, 132.5, 139.7, 155.0, 189.5, 179.0, 164.0, 182.0, 120.79999999999998, 193.7, 199.1, 168.5, 190.1, 167.3, 185.6, 200.0, 170.3, 172.1, 200.0, 152.3, 193.0, 190.0, 176.0, 200.0, 169.0, 185.0, 161.0, 191.0, 193.7, 182.9, 176.0, 161.3], "policy_predator_policy_reward": [0.0, 16.0, 5.0, 0.0, 13.0, 15.0, 0.0, 0.0, 8.0, 0.0, 8.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 0.0, 1.0, 5.0, 12.0, 0.0, 4.0, 0.0, 0.0, 4.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 6.0, 0.0, 0.0, 0.0, 0.0, 10.0, 14.0, 10.0, 0.0, 0.0, 6.0, 3.0, 0.0, 5.0, 3.0, 8.0, 12.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 16.0, 11.0, 4.0, 6.0, 0.0, 0.0, 7.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 5.0, 7.0, 0.0, 1.0, 0.0, 11.0, 25.0, 16.0, 9.0, 0.0, 0.0, 3.0, 3.0, 5.0, 0.0, 6.0, 0.0, 0.0, 2.0, 11.0, 7.0, 15.0, 0.0, 0.0, 6.0, 15.0, 26.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 7.0, 0.0, 1.0, 0.0, 10.0, 0.0, 2.0, 0.0, 7.0, 4.0, 10.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 0.0, 0.0, 1.0, 14.0, 10.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 8.0, 5.0, 13.0, 16.0, 0.0, 7.0, 2.0, 0.0, 0.0, 3.0, 8.0, 3.0, 0.0, 16.0, 0.0, 0.0, 10.0, 7.0, 6.0, 8.0, 0.0, 7.0, 0.0, 5.0, 10.0, 5.0, 8.0, 14.0, 18.0, 15.0, 0.0, 9.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 7.0, 6.0, 8.0, 0.0, 0.0, 8.0, 8.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.3056837884370396, "mean_inference_ms": 11.496479893694106, "mean_action_processing_ms": 3.340794049134453, "mean_env_wait_ms": 0.3999727143513756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004419207572937012, "StateBufferConnector_ms": 0.00734710693359375, "ViewRequirementAgentConnector_ms": 0.1363670825958252}, "num_episodes": 27, "episode_return_max": 400.0, "episode_return_min": 288.6, "episode_return_mean": 368.961, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000, "num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.27430524081757, "num_env_steps_trained_throughput_per_sec": 304.27430524081757, "timesteps_total": 784000, "num_env_steps_sampled_lifetime": 784000, "num_agent_steps_sampled_lifetime": 3136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3136000, "timers": {"training_iteration_time_ms": 13485.157, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13485.087, "sample_time_ms": 1827.786, "learn_time_ms": 11631.432, "learn_throughput": 343.896, "synch_weights_time_ms": 19.566}, "counters": {"num_env_steps_sampled": 784000, "num_env_steps_trained": 784000, "num_agent_steps_sampled": 3136000, "num_agent_steps_trained": 3136000}, "done": false, "training_iteration": 196, "trial_id": "e4caa_00000", "date": "2024-08-13_23-22-38", "timestamp": 1723605758, "time_this_iter_s": 13.191933870315552, "time_total_s": 13084.305778265, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e1dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13084.305778265, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 58.95000000000001, "ram_util_percent": 81.14444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4466915538386693, "cur_kl_coeff": 0.001318359375, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.4143900661538946, "policy_loss": -0.009668577095326135, "vf_loss": 0.42405032109762986, "vf_explained_var": 0.3651043451652325, "kl": 0.006313163494329328, "entropy": 0.6917354828150815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 371385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9602149059375127, "cur_kl_coeff": 1.9281046089362575e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.18469043594560827, "policy_loss": -0.0015607509848282292, "vf_loss": 0.18625118714047684, "vf_explained_var": 0.2098250833768693, "kl": 0.005635160363996334, "entropy": 0.2517772727227085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 371385.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 288.6, "episode_reward_mean": 369.594, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 95.3000000000001, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 26.0}, "policy_reward_mean": {"prey_policy": 180.73199999999997, "predator_policy": 4.065}, "custom_metrics": {}, "hist_stats": {"episode_reward": [394.6, 355.3, 350.3, 379.0, 359.8, 372.3, 347.1, 356.9, 393.7, 391.9, 349.70000000000005, 363.5, 373.0, 344.2, 355.40000000000003, 394.0, 380.0, 384.7, 373.3, 396.2, 374.1, 355.79999999999995, 369.4, 387.7, 360.6, 375.1, 364.0, 359.6, 356.9, 378.4, 350.8, 288.6, 389.2, 366.0, 370.0, 387.9, 399.1, 343.7, 369.2, 380.0, 390.6, 378.0, 321.9, 391.9, 378.4, 388.3, 386.2, 363.3, 389.0, 378.1, 400.0, 350.0, 386.0, 384.2, 351.0, 384.2, 387.0, 389.5, 347.4, 288.8, 380.2, 359.7, 354.0, 367.1, 386.4, 352.0, 354.5, 327.7, 377.5, 355.0, 314.4999999999999, 367.6, 367.4, 385.6, 351.4, 352.30000000000007, 384.0, 376.0, 361.0, 366.0, 376.6, 353.3, 368.6, 400.0, 391.0, 394.6, 381.1, 361.0, 373.0, 385.6, 381.7, 362.6, 382.5, 373.3, 376.2, 366.0, 373.0, 386.0, 399.1, 359.5], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [200.0, 194.6, 170.3, 161.0, 141.20000000000005, 199.1, 180.2, 192.8, 194.6, 162.2, 197.3, 167.0, 191.0, 136.1, 160.1, 183.8, 200.0, 193.7, 200.0, 191.9, 199.1, 140.6, 152.0, 195.5, 200.0, 158.0, 170.6, 167.6, 148.39999999999998, 200.0, 194.0, 200.0, 188.0, 188.0, 189.2, 195.5, 182.3, 179.0, 200.0, 195.2, 184.1, 179.0, 196.39999999999998, 118.4, 187.4, 173.0, 191.0, 193.7, 186.5, 166.1, 197.0, 172.1, 177.5, 186.5, 185.6, 161.0, 143.0, 191.9, 186.5, 191.9, 181.1, 148.7, 117.5, 145.1, 200.0, 189.2, 171.0, 188.0, 185.0, 180.0, 188.6, 197.3, 199.1, 200.0, 154.7, 182.0, 174.5, 193.7, 170.0, 200.0, 194.0, 194.6, 188.0, 179.0, 170.0, 125.9, 200.0, 191.9, 179.3, 199.1, 200.0, 188.3, 200.0, 180.2, 175.1, 180.2, 195.5, 192.5, 199.1, 155.0, 200.0, 200.0, 184.0, 165.0, 186.0, 200.0, 173.0, 198.2, 197.0, 125.0, 199.1, 178.1, 191.0, 194.0, 195.5, 191.0, 176.0, 160.4, 177.5, 95.3000000000001, 192.8, 187.4, 172.7, 170.0, 158.0, 182.0, 184.7, 175.4, 200.0, 181.4, 161.9, 175.1, 200.0, 132.5, 139.7, 155.0, 189.5, 179.0, 164.0, 182.0, 120.79999999999998, 193.7, 199.1, 168.5, 190.1, 167.3, 185.6, 200.0, 170.3, 172.1, 200.0, 152.3, 193.0, 190.0, 176.0, 200.0, 169.0, 185.0, 161.0, 191.0, 193.7, 182.9, 176.0, 161.3, 161.0, 194.6, 200.0, 200.0, 200.0, 191.0, 200.0, 194.6, 197.3, 183.8, 182.0, 167.0, 185.0, 176.0, 185.6, 200.0, 198.2, 177.5, 194.6, 152.0, 194.0, 186.5, 194.0, 170.3, 200.0, 165.2, 149.0, 200.0, 189.0, 176.0, 197.0, 186.0, 200.0, 199.1, 182.9, 167.6], "policy_predator_policy_reward": [0.0, 0.0, 10.0, 14.0, 10.0, 0.0, 0.0, 6.0, 3.0, 0.0, 5.0, 3.0, 8.0, 12.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 2.0, 0.0, 16.0, 11.0, 4.0, 6.0, 0.0, 0.0, 7.0, 0.0, 0.0, 3.0, 1.0, 0.0, 0.0, 5.0, 7.0, 0.0, 1.0, 0.0, 11.0, 25.0, 16.0, 9.0, 0.0, 0.0, 3.0, 3.0, 5.0, 0.0, 6.0, 0.0, 0.0, 2.0, 11.0, 7.0, 15.0, 0.0, 0.0, 6.0, 15.0, 26.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 7.0, 0.0, 1.0, 0.0, 10.0, 0.0, 2.0, 0.0, 7.0, 4.0, 10.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 0.0, 0.0, 1.0, 14.0, 10.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 8.0, 5.0, 13.0, 16.0, 0.0, 7.0, 2.0, 0.0, 0.0, 3.0, 8.0, 3.0, 0.0, 16.0, 0.0, 0.0, 10.0, 7.0, 6.0, 8.0, 0.0, 7.0, 0.0, 5.0, 10.0, 5.0, 8.0, 14.0, 18.0, 15.0, 0.0, 9.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 7.0, 6.0, 8.0, 0.0, 0.0, 8.0, 8.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 12.0, 0.0, 0.0, 6.0, 0.0, 0.0, 16.0, 2.0, 0.0, 0.0, 9.0, 11.0, 0.0, 0.0, 17.0, 0.0, 8.0, 1.0, 2.0, 0.0, 0.0, 9.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2972474513856769, "mean_inference_ms": 11.574918334027213, "mean_action_processing_ms": 3.2105645277261634, "mean_env_wait_ms": 0.3991992215831909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004889845848083496, "StateBufferConnector_ms": 0.00708162784576416, "ViewRequirementAgentConnector_ms": 0.13403117656707764}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 288.6, "episode_return_mean": 369.594, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000, "num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.0182941694571, "num_env_steps_trained_throughput_per_sec": 295.0182941694571, "timesteps_total": 788000, "num_env_steps_sampled_lifetime": 788000, "num_agent_steps_sampled_lifetime": 3152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3152000, "timers": {"training_iteration_time_ms": 13506.356, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13506.287, "sample_time_ms": 1819.15, "learn_time_ms": 11662.137, "learn_throughput": 342.99, "synch_weights_time_ms": 19.622}, "counters": {"num_env_steps_sampled": 788000, "num_env_steps_trained": 788000, "num_agent_steps_sampled": 3152000, "num_agent_steps_trained": 3152000}, "done": false, "training_iteration": 197, "trial_id": "e4caa_00000", "date": "2024-08-13_23-22-51", "timestamp": 1723605771, "time_this_iter_s": 13.604326963424683, "time_total_s": 13097.910105228424, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d82430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13097.910105228424, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 55.720000000000006, "ram_util_percent": 81.715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.635214230150142, "cur_kl_coeff": 0.001318359375, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.6056935164073443, "policy_loss": -0.01661564249190546, "vf_loss": 0.6222922497517651, "vf_explained_var": 0.45522918155584385, "kl": 0.012824800698877526, "entropy": 0.7138900901905443, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 373275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3875194939434843, "cur_kl_coeff": 1.9281046089362575e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.49686881062530336, "policy_loss": -0.002545356870476137, "vf_loss": 0.4994141661783769, "vf_explained_var": 0.1006960984260317, "kl": 0.007318093147040323, "entropy": 0.2262726564965551, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 373275.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 288.6, "episode_reward_mean": 368.816, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 95.3000000000001, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 26.0}, "policy_reward_mean": {"prey_policy": 180.213, "predator_policy": 4.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [373.3, 396.2, 374.1, 355.79999999999995, 369.4, 387.7, 360.6, 375.1, 364.0, 359.6, 356.9, 378.4, 350.8, 288.6, 389.2, 366.0, 370.0, 387.9, 399.1, 343.7, 369.2, 380.0, 390.6, 378.0, 321.9, 391.9, 378.4, 388.3, 386.2, 363.3, 389.0, 378.1, 400.0, 350.0, 386.0, 384.2, 351.0, 384.2, 387.0, 389.5, 347.4, 288.8, 380.2, 359.7, 354.0, 367.1, 386.4, 352.0, 354.5, 327.7, 377.5, 355.0, 314.4999999999999, 367.6, 367.4, 385.6, 351.4, 352.30000000000007, 384.0, 376.0, 361.0, 366.0, 376.6, 353.3, 368.6, 400.0, 391.0, 394.6, 381.1, 361.0, 373.0, 385.6, 381.7, 362.6, 382.5, 373.3, 376.2, 366.0, 373.0, 386.0, 399.1, 359.5, 365.6, 332.0, 339.70000000000005, 361.3, 360.2, 388.3, 356.4, 384.6, 383.8, 360.1, 362.5, 393.7, 390.0, 338.70000000000005, 335.0, 366.0, 379.1, 370.6], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [182.3, 179.0, 200.0, 195.2, 184.1, 179.0, 196.39999999999998, 118.4, 187.4, 173.0, 191.0, 193.7, 186.5, 166.1, 197.0, 172.1, 177.5, 186.5, 185.6, 161.0, 143.0, 191.9, 186.5, 191.9, 181.1, 148.7, 117.5, 145.1, 200.0, 189.2, 171.0, 188.0, 185.0, 180.0, 188.6, 197.3, 199.1, 200.0, 154.7, 182.0, 174.5, 193.7, 170.0, 200.0, 194.0, 194.6, 188.0, 179.0, 170.0, 125.9, 200.0, 191.9, 179.3, 199.1, 200.0, 188.3, 200.0, 180.2, 175.1, 180.2, 195.5, 192.5, 199.1, 155.0, 200.0, 200.0, 184.0, 165.0, 186.0, 200.0, 173.0, 198.2, 197.0, 125.0, 199.1, 178.1, 191.0, 194.0, 195.5, 191.0, 176.0, 160.4, 177.5, 95.3000000000001, 192.8, 187.4, 172.7, 170.0, 158.0, 182.0, 184.7, 175.4, 200.0, 181.4, 161.9, 175.1, 200.0, 132.5, 139.7, 155.0, 189.5, 179.0, 164.0, 182.0, 120.79999999999998, 193.7, 199.1, 168.5, 190.1, 167.3, 185.6, 200.0, 170.3, 172.1, 200.0, 152.3, 193.0, 190.0, 176.0, 200.0, 169.0, 185.0, 161.0, 191.0, 193.7, 182.9, 176.0, 161.3, 161.0, 194.6, 200.0, 200.0, 200.0, 191.0, 200.0, 194.6, 197.3, 183.8, 182.0, 167.0, 185.0, 176.0, 185.6, 200.0, 198.2, 177.5, 194.6, 152.0, 194.0, 186.5, 194.0, 170.3, 200.0, 165.2, 149.0, 200.0, 189.0, 176.0, 197.0, 186.0, 200.0, 199.1, 182.9, 167.6, 170.0, 185.6, 164.0, 146.0, 154.7, 176.0, 158.6, 193.7, 180.2, 170.0, 192.8, 195.5, 170.3, 172.1, 185.0, 194.6, 183.8, 200.0, 157.1, 185.0, 166.1, 181.4, 200.0, 193.7, 185.0, 200.0, 126.5, 198.2, 146.0, 167.0, 179.0, 185.0, 169.1, 200.0, 174.8, 192.8], "policy_predator_policy_reward": [5.0, 7.0, 0.0, 1.0, 0.0, 11.0, 25.0, 16.0, 9.0, 0.0, 0.0, 3.0, 3.0, 5.0, 0.0, 6.0, 0.0, 0.0, 2.0, 11.0, 7.0, 15.0, 0.0, 0.0, 6.0, 15.0, 26.0, 0.0, 0.0, 0.0, 0.0, 7.0, 0.0, 5.0, 2.0, 0.0, 0.0, 0.0, 7.0, 0.0, 1.0, 0.0, 10.0, 0.0, 2.0, 0.0, 7.0, 4.0, 10.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 0.0, 0.0, 1.0, 14.0, 10.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 8.0, 5.0, 13.0, 16.0, 0.0, 7.0, 2.0, 0.0, 0.0, 3.0, 8.0, 3.0, 0.0, 16.0, 0.0, 0.0, 10.0, 7.0, 6.0, 8.0, 0.0, 7.0, 0.0, 5.0, 10.0, 5.0, 8.0, 14.0, 18.0, 15.0, 0.0, 9.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 7.0, 6.0, 8.0, 0.0, 0.0, 8.0, 8.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 12.0, 0.0, 0.0, 6.0, 0.0, 0.0, 16.0, 2.0, 0.0, 0.0, 9.0, 11.0, 0.0, 0.0, 17.0, 0.0, 8.0, 1.0, 2.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 8.0, 14.0, 0.0, 9.0, 4.0, 5.0, 4.0, 6.0, 0.0, 0.0, 14.0, 0.0, 0.0, 5.0, 0.0, 0.0, 3.0, 15.0, 14.0, 1.0, 0.0, 0.0, 5.0, 0.0, 14.0, 0.0, 0.0, 22.0, 2.0, 0.0, 0.0, 10.0, 3.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2949748368597545, "mean_inference_ms": 11.53240197058029, "mean_action_processing_ms": 3.1972445289418543, "mean_env_wait_ms": 0.39862954620956165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005619406700134277, "StateBufferConnector_ms": 0.007064700126647949, "ViewRequirementAgentConnector_ms": 0.12855923175811768}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 288.6, "episode_return_mean": 368.816, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000, "num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.8909348306665, "num_env_steps_trained_throughput_per_sec": 309.8909348306665, "timesteps_total": 792000, "num_env_steps_sampled_lifetime": 792000, "num_agent_steps_sampled_lifetime": 3168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3168000, "timers": {"training_iteration_time_ms": 13494.647, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13494.578, "sample_time_ms": 1827.288, "learn_time_ms": 11642.299, "learn_throughput": 343.575, "synch_weights_time_ms": 19.613}, "counters": {"num_env_steps_sampled": 792000, "num_env_steps_trained": 792000, "num_agent_steps_sampled": 3168000, "num_agent_steps_trained": 3168000}, "done": false, "training_iteration": 198, "trial_id": "e4caa_00000", "date": "2024-08-13_23-23-04", "timestamp": 1723605784, "time_this_iter_s": 12.963721990585327, "time_total_s": 13110.87382721901, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2d840d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13110.87382721901, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 52.233333333333334, "ram_util_percent": 80.65}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.622671944738696, "cur_kl_coeff": 0.001318359375, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8425696968874603, "policy_loss": -0.006655532365329761, "vf_loss": 0.8492191228601668, "vf_explained_var": 0.39878610334699116, "kl": 0.0046330539958801265, "entropy": 0.7394471370984638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 375165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9413998559511528, "cur_kl_coeff": 1.9281046089362575e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.2983831693255712, "policy_loss": -0.0019280567508999002, "vf_loss": 0.30031122583994474, "vf_explained_var": 0.11214993138792653, "kl": 0.0067519790026386965, "entropy": 0.19255558046950866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 375165.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 288.8, "episode_reward_mean": 368.73400000000004, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 86.6, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 33.0}, "policy_reward_mean": {"prey_policy": 179.64199999999997, "predator_policy": 4.725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [399.1, 343.7, 369.2, 380.0, 390.6, 378.0, 321.9, 391.9, 378.4, 388.3, 386.2, 363.3, 389.0, 378.1, 400.0, 350.0, 386.0, 384.2, 351.0, 384.2, 387.0, 389.5, 347.4, 288.8, 380.2, 359.7, 354.0, 367.1, 386.4, 352.0, 354.5, 327.7, 377.5, 355.0, 314.4999999999999, 367.6, 367.4, 385.6, 351.4, 352.30000000000007, 384.0, 376.0, 361.0, 366.0, 376.6, 353.3, 368.6, 400.0, 391.0, 394.6, 381.1, 361.0, 373.0, 385.6, 381.7, 362.6, 382.5, 373.3, 376.2, 366.0, 373.0, 386.0, 399.1, 359.5, 365.6, 332.0, 339.70000000000005, 361.3, 360.2, 388.3, 356.4, 384.6, 383.8, 360.1, 362.5, 393.7, 390.0, 338.70000000000005, 335.0, 366.0, 379.1, 370.6, 393.7, 389.7, 388.3, 380.0, 390.0, 380.8, 374.2, 381.1, 323.8, 390.1, 343.4, 378.3, 321.69999999999993, 333.9, 338.0, 362.0, 351.1, 375.3], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [199.1, 200.0, 154.7, 182.0, 174.5, 193.7, 170.0, 200.0, 194.0, 194.6, 188.0, 179.0, 170.0, 125.9, 200.0, 191.9, 179.3, 199.1, 200.0, 188.3, 200.0, 180.2, 175.1, 180.2, 195.5, 192.5, 199.1, 155.0, 200.0, 200.0, 184.0, 165.0, 186.0, 200.0, 173.0, 198.2, 197.0, 125.0, 199.1, 178.1, 191.0, 194.0, 195.5, 191.0, 176.0, 160.4, 177.5, 95.3000000000001, 192.8, 187.4, 172.7, 170.0, 158.0, 182.0, 184.7, 175.4, 200.0, 181.4, 161.9, 175.1, 200.0, 132.5, 139.7, 155.0, 189.5, 179.0, 164.0, 182.0, 120.79999999999998, 193.7, 199.1, 168.5, 190.1, 167.3, 185.6, 200.0, 170.3, 172.1, 200.0, 152.3, 193.0, 190.0, 176.0, 200.0, 169.0, 185.0, 161.0, 191.0, 193.7, 182.9, 176.0, 161.3, 161.0, 194.6, 200.0, 200.0, 200.0, 191.0, 200.0, 194.6, 197.3, 183.8, 182.0, 167.0, 185.0, 176.0, 185.6, 200.0, 198.2, 177.5, 194.6, 152.0, 194.0, 186.5, 194.0, 170.3, 200.0, 165.2, 149.0, 200.0, 189.0, 176.0, 197.0, 186.0, 200.0, 199.1, 182.9, 167.6, 170.0, 185.6, 164.0, 146.0, 154.7, 176.0, 158.6, 193.7, 180.2, 170.0, 192.8, 195.5, 170.3, 172.1, 185.0, 194.6, 183.8, 200.0, 157.1, 185.0, 166.1, 181.4, 200.0, 193.7, 185.0, 200.0, 126.5, 198.2, 146.0, 167.0, 179.0, 185.0, 169.1, 200.0, 174.8, 192.8, 195.5, 198.2, 194.0, 193.7, 200.0, 188.3, 188.0, 182.0, 185.0, 200.0, 200.0, 174.8, 166.1, 190.1, 182.9, 198.2, 164.0, 126.8, 193.7, 196.4, 86.6, 192.8, 188.3, 179.0, 197.3, 124.39999999999999, 185.0, 89.9, 141.0, 179.0, 190.0, 158.0, 188.0, 121.1, 197.3, 167.0], "policy_predator_policy_reward": [0.0, 0.0, 7.0, 0.0, 1.0, 0.0, 10.0, 0.0, 2.0, 0.0, 7.0, 4.0, 10.0, 16.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 6.0, 0.0, 8.0, 0.0, 0.0, 1.0, 14.0, 10.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 8.0, 5.0, 13.0, 16.0, 0.0, 7.0, 2.0, 0.0, 0.0, 3.0, 8.0, 3.0, 0.0, 16.0, 0.0, 0.0, 10.0, 7.0, 6.0, 8.0, 0.0, 7.0, 0.0, 5.0, 10.0, 5.0, 8.0, 14.0, 18.0, 15.0, 0.0, 9.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 7.0, 6.0, 8.0, 0.0, 0.0, 8.0, 8.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 12.0, 0.0, 0.0, 6.0, 0.0, 0.0, 16.0, 2.0, 0.0, 0.0, 9.0, 11.0, 0.0, 0.0, 17.0, 0.0, 8.0, 1.0, 2.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 8.0, 14.0, 0.0, 9.0, 4.0, 5.0, 4.0, 6.0, 0.0, 0.0, 14.0, 0.0, 0.0, 5.0, 0.0, 0.0, 3.0, 15.0, 14.0, 1.0, 0.0, 0.0, 5.0, 0.0, 14.0, 0.0, 0.0, 22.0, 2.0, 0.0, 0.0, 10.0, 3.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 10.0, 0.0, 5.0, 0.0, 6.0, 0.0, 11.0, 7.0, 0.0, 0.0, 14.0, 19.0, 0.0, 0.0, 31.0, 33.0, 4.0, 7.0, 0.0, 0.0, 31.0, 28.0, 0.0, 18.0, 14.0, 0.0, 22.0, 20.0, 11.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.292220876936692, "mean_inference_ms": 11.48901582672248, "mean_action_processing_ms": 3.1838067305848488, "mean_env_wait_ms": 0.39789986552233586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00556337833404541, "StateBufferConnector_ms": 0.007108092308044434, "ViewRequirementAgentConnector_ms": 0.11592745780944824}, "num_episodes": 18, "episode_return_max": 400.0, "episode_return_min": 288.8, "episode_return_mean": 368.73400000000004, "episodes_this_iter": 18}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000, "num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.2571082764881, "num_env_steps_trained_throughput_per_sec": 289.2571082764881, "timesteps_total": 796000, "num_env_steps_sampled_lifetime": 796000, "num_agent_steps_sampled_lifetime": 3184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3184000, "timers": {"training_iteration_time_ms": 13610.022, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13609.954, "sample_time_ms": 1817.862, "learn_time_ms": 11767.637, "learn_throughput": 339.915, "synch_weights_time_ms": 19.414}, "counters": {"num_env_steps_sampled": 796000, "num_env_steps_trained": 796000, "num_agent_steps_sampled": 3184000, "num_agent_steps_trained": 3184000}, "done": false, "training_iteration": 199, "trial_id": "e4caa_00000", "date": "2024-08-13_23-23-18", "timestamp": 1723605798, "time_this_iter_s": 13.871556043624878, "time_total_s": 13124.745383262634, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2e1dd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13124.745383262634, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 63.09999999999999, "ram_util_percent": 82.89500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0372026690414975, "cur_kl_coeff": 0.0006591796875, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2506855822902507, "policy_loss": -0.009608955295736748, "vf_loss": 1.2602879115513392, "vf_explained_var": 0.4784166186259537, "kl": 0.010048803683089535, "entropy": 0.7578097061505393, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 377055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.906822719570821, "cur_kl_coeff": 1.9281046089362575e-36, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.18132219669808233, "policy_loss": -0.0003538015176586452, "vf_loss": 0.18167599855968974, "vf_explained_var": -0.11637505072134513, "kl": 0.006721467864711308, "entropy": 0.13722815498433732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 126.98412698412699, "num_grad_updates_lifetime": 377055.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "env_runners": {"episode_reward_max": 400.0, "episode_reward_min": 218.20000000000002, "episode_reward_mean": 357.699, "episode_len_mean": 200.0, "episode_media": {}, "episodes_timesteps_total": 20000, "policy_reward_min": {"prey_policy": 27.200000000000088, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 200.0, "predator_policy": 33.0}, "policy_reward_mean": {"prey_policy": 174.18949999999998, "predator_policy": 4.66}, "custom_metrics": {}, "hist_stats": {"episode_reward": [367.1, 386.4, 352.0, 354.5, 327.7, 377.5, 355.0, 314.4999999999999, 367.6, 367.4, 385.6, 351.4, 352.30000000000007, 384.0, 376.0, 361.0, 366.0, 376.6, 353.3, 368.6, 400.0, 391.0, 394.6, 381.1, 361.0, 373.0, 385.6, 381.7, 362.6, 382.5, 373.3, 376.2, 366.0, 373.0, 386.0, 399.1, 359.5, 365.6, 332.0, 339.70000000000005, 361.3, 360.2, 388.3, 356.4, 384.6, 383.8, 360.1, 362.5, 393.7, 390.0, 338.70000000000005, 335.0, 366.0, 379.1, 370.6, 393.7, 389.7, 388.3, 380.0, 390.0, 380.8, 374.2, 381.1, 323.8, 390.1, 343.4, 378.3, 321.69999999999993, 333.9, 338.0, 362.0, 351.1, 375.3, 363.4, 256.5999999999996, 397.1, 366.1, 397.3, 384.7, 370.0, 357.4, 325.29999999999995, 338.0, 356.6, 391.9, 281.1999999999998, 381.1, 218.20000000000002, 256.89999999999964, 316.29999999999995, 383.9, 222.69999999999933, 244.09999999999997, 345.3, 357.0, 234.0, 302.0, 371.9, 385.6, 311.6], "episode_lengths": [200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200, 200], "policy_prey_policy_reward": [184.7, 175.4, 200.0, 181.4, 161.9, 175.1, 200.0, 132.5, 139.7, 155.0, 189.5, 179.0, 164.0, 182.0, 120.79999999999998, 193.7, 199.1, 168.5, 190.1, 167.3, 185.6, 200.0, 170.3, 172.1, 200.0, 152.3, 193.0, 190.0, 176.0, 200.0, 169.0, 185.0, 161.0, 191.0, 193.7, 182.9, 176.0, 161.3, 161.0, 194.6, 200.0, 200.0, 200.0, 191.0, 200.0, 194.6, 197.3, 183.8, 182.0, 167.0, 185.0, 176.0, 185.6, 200.0, 198.2, 177.5, 194.6, 152.0, 194.0, 186.5, 194.0, 170.3, 200.0, 165.2, 149.0, 200.0, 189.0, 176.0, 197.0, 186.0, 200.0, 199.1, 182.9, 167.6, 170.0, 185.6, 164.0, 146.0, 154.7, 176.0, 158.6, 193.7, 180.2, 170.0, 192.8, 195.5, 170.3, 172.1, 185.0, 194.6, 183.8, 200.0, 157.1, 185.0, 166.1, 181.4, 200.0, 193.7, 185.0, 200.0, 126.5, 198.2, 146.0, 167.0, 179.0, 185.0, 169.1, 200.0, 174.8, 192.8, 195.5, 198.2, 194.0, 193.7, 200.0, 188.3, 188.0, 182.0, 185.0, 200.0, 200.0, 174.8, 166.1, 190.1, 182.9, 198.2, 164.0, 126.8, 193.7, 196.4, 86.6, 192.8, 188.3, 179.0, 197.3, 124.39999999999999, 185.0, 89.9, 141.0, 179.0, 190.0, 158.0, 188.0, 121.1, 197.3, 167.0, 177.8, 176.6, 182.0, 68.59999999999997, 199.1, 197.0, 190.1, 164.0, 200.0, 197.3, 192.8, 191.9, 152.6, 196.4, 173.0, 166.4, 200.0, 125.29999999999998, 164.0, 161.0, 155.6, 200.0, 199.1, 192.8, 187.4, 93.79999999999998, 193.7, 187.4, 104.59999999999998, 113.59999999999998, 68.59999999999997, 188.3, 190.1, 126.19999999999999, 191.9, 176.0, 27.200000000000088, 195.5, 118.99999999999999, 124.1, 119.3, 200.0, 155.0, 185.0, 55.0, 176.0, 179.0, 106.0, 170.0, 191.9, 196.4, 189.2, 125.0, 161.6], "policy_predator_policy_reward": [0.0, 7.0, 0.0, 5.0, 10.0, 5.0, 8.0, 14.0, 18.0, 15.0, 0.0, 9.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 9.0, 0.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 7.0, 6.0, 8.0, 0.0, 0.0, 8.0, 8.0, 0.0, 13.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 3.0, 9.0, 0.0, 12.0, 0.0, 0.0, 6.0, 0.0, 0.0, 16.0, 2.0, 0.0, 0.0, 9.0, 11.0, 0.0, 0.0, 17.0, 0.0, 8.0, 1.0, 2.0, 0.0, 0.0, 9.0, 0.0, 0.0, 10.0, 8.0, 14.0, 0.0, 9.0, 4.0, 5.0, 4.0, 6.0, 0.0, 0.0, 14.0, 0.0, 0.0, 5.0, 0.0, 0.0, 3.0, 15.0, 14.0, 1.0, 0.0, 0.0, 5.0, 0.0, 14.0, 0.0, 0.0, 22.0, 2.0, 0.0, 0.0, 10.0, 3.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 0.0, 10.0, 0.0, 5.0, 0.0, 6.0, 0.0, 11.0, 7.0, 0.0, 0.0, 14.0, 19.0, 0.0, 0.0, 31.0, 33.0, 4.0, 7.0, 0.0, 0.0, 31.0, 28.0, 0.0, 18.0, 14.0, 0.0, 22.0, 20.0, 11.0, 0.0, 1.0, 8.0, 6.0, 0.0, 0.0, 1.0, 0.0, 12.0, 0.0, 0.0, 0.0, 0.0, 8.0, 13.0, 9.0, 9.0, 0.0, 0.0, 0.0, 13.0, 0.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 8.0, 8.0, 0.0, 0.0, 1.0, 0.0, 0.0, 26.0, 17.0, 0.0, 3.0, 0.0, 7.0, 10.0, 0.0, 10.0, 0.0, 0.0, 25.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.2780276095162306, "mean_inference_ms": 11.303584149682356, "mean_action_processing_ms": 3.1776822537022524, "mean_env_wait_ms": 0.39669776309031307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005686402320861816, "StateBufferConnector_ms": 0.0036329030990600586, "ViewRequirementAgentConnector_ms": 0.11319530010223389}, "num_episodes": 27, "episode_return_max": 400.0, "episode_return_min": 218.20000000000002, "episode_return_mean": 357.699, "episodes_this_iter": 27}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000, "num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.54740265838706, "num_env_steps_trained_throughput_per_sec": 285.54740265838706, "timesteps_total": 800000, "num_env_steps_sampled_lifetime": 800000, "num_agent_steps_sampled_lifetime": 3200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3200000, "timers": {"training_iteration_time_ms": 13689.602, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13689.533, "sample_time_ms": 1842.814, "learn_time_ms": 11821.354, "learn_throughput": 338.371, "synch_weights_time_ms": 20.466}, "counters": {"num_env_steps_sampled": 800000, "num_env_steps_trained": 800000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "done": true, "training_iteration": 200, "trial_id": "e4caa_00000", "date": "2024-08-13_23-23-32", "timestamp": 1723605812, "time_this_iter_s": 14.20445990562439, "time_total_s": 13138.949843168259, "pid": 49375, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"num_prey": 2, "num_predators": 2, "prey_speed": 1, "predator_speed": 1, "map_size": 30, "max_steps": 200, "screen_size": 600, "grid_size": 10}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 1, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3b2de2d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 13138.949843168259, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 67.21000000000001, "ram_util_percent": 83.935}}
