{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0999596992497722, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.114413466781535, "policy_loss": -0.007482803368536884, "vf_loss": 7.120382306941603, "vf_explained_var": 0.02895324842008964, "kl": 0.007569755576600237, "entropy": 1.605868097209426, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2108854943166965, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.02093021554291, "policy_loss": -0.009898269939773455, "vf_loss": 6.0296366757186, "vf_explained_var": 0.019302749886083857, "kl": 0.005959085755976578, "entropy": 1.6054063929451836, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 473.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 4008, "num_env_steps_trained": 4008, "num_agent_steps_sampled": 16032, "num_agent_steps_trained": 16032}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16032, "num_agent_steps_trained": 16032, "num_env_steps_sampled": 4008, "num_env_steps_trained": 4008, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 123.07909901882047, "num_env_steps_trained_throughput_per_sec": 123.07909901882047, "timesteps_total": 4008, "num_env_steps_sampled_lifetime": 4008, "num_agent_steps_sampled_lifetime": 16032, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 16032, "timers": {"training_iteration_time_ms": 32564.433, "restore_workers_time_ms": 0.02, "training_step_time_ms": 32564.354, "sample_time_ms": 8004.115, "learn_time_ms": 24545.372, "learn_throughput": 163.289, "synch_weights_time_ms": 11.222}, "counters": {"num_env_steps_sampled": 4008, "num_env_steps_trained": 4008, "num_agent_steps_sampled": 16032, "num_agent_steps_trained": 16032}, "done": false, "training_iteration": 1, "trial_id": "7f713_00000", "date": "2024-08-23_09-47-10", "timestamp": 1724386630, "time_this_iter_s": 32.62082624435425, "time_total_s": 32.62082624435425, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30f768550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 32.62082624435425, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 45.44468085106382, "ram_util_percent": 83.85106382978725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5104795686782353, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.91892781131482, "policy_loss": -0.01483864268533166, "vf_loss": 5.931904712051311, "vf_explained_var": 0.14242639938990276, "kl": 0.009308679591095636, "entropy": 1.597139773923884, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0246841660252324, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.325701200394404, "policy_loss": -0.01097486166569291, "vf_loss": 4.335596022782503, "vf_explained_var": 0.1121632696459533, "kl": 0.005400261204325097, "entropy": 1.6023147632205297, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 1418.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 8016, "num_env_steps_trained": 8016, "num_agent_steps_sampled": 32064, "num_agent_steps_trained": 32064}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32064, "num_agent_steps_trained": 32064, "num_env_steps_sampled": 8016, "num_env_steps_trained": 8016, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 151.62008723825403, "num_env_steps_trained_throughput_per_sec": 151.62008723825403, "timesteps_total": 8016, "num_env_steps_sampled_lifetime": 8016, "num_agent_steps_sampled_lifetime": 32064, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 32064, "timers": {"training_iteration_time_ms": 29499.48, "restore_workers_time_ms": 0.045, "training_step_time_ms": 29498.163, "sample_time_ms": 5482.465, "learn_time_ms": 23990.589, "learn_throughput": 167.066, "synch_weights_time_ms": 17.288}, "counters": {"num_env_steps_sampled": 8016, "num_env_steps_trained": 8016, "num_agent_steps_sampled": 32064, "num_agent_steps_trained": 32064}, "done": false, "training_iteration": 2, "trial_id": "7f713_00000", "date": "2024-08-23_09-47-39", "timestamp": 1724386659, "time_this_iter_s": 26.46212387084961, "time_total_s": 59.08295011520386, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30f592550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 59.08295011520386, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 43.61707317073171, "ram_util_percent": 83.32926829268294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.753962796201151, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.738608189234658, "policy_loss": -0.014524012185120708, "vf_loss": 5.751487837392817, "vf_explained_var": 0.22815171650477817, "kl": 0.00822176777008704, "entropy": 1.5879713251477197, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 2363.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952094}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.737671946217774, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 3.7422743277574972, "policy_loss": -0.015667095493091636, "vf_loss": 3.756701595821078, "vf_explained_var": 0.13128882053667906, "kl": 0.0061991857858768925, "entropy": 1.594981783786148, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 2363.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952094}}, "num_env_steps_sampled": 12024, "num_env_steps_trained": 12024, "num_agent_steps_sampled": 48096, "num_agent_steps_trained": 48096}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48096, "num_agent_steps_trained": 48096, "num_env_steps_sampled": 12024, "num_env_steps_trained": 12024, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 152.61851530179703, "num_env_steps_trained_throughput_per_sec": 152.61851530179703, "timesteps_total": 12024, "num_env_steps_sampled_lifetime": 12024, "num_agent_steps_sampled_lifetime": 48096, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 48096, "timers": {"training_iteration_time_ms": 28420.183, "restore_workers_time_ms": 0.038, "training_step_time_ms": 28418.758, "sample_time_ms": 4580.567, "learn_time_ms": 23812.449, "learn_throughput": 168.315, "synch_weights_time_ms": 19.448}, "counters": {"num_env_steps_sampled": 12024, "num_env_steps_trained": 12024, "num_agent_steps_sampled": 48096, "num_agent_steps_trained": 48096}, "done": false, "training_iteration": 3, "trial_id": "7f713_00000", "date": "2024-08-23_09-48-05", "timestamp": 1724386685, "time_this_iter_s": 26.284745931625366, "time_total_s": 85.36769604682922, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30f74f820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 85.36769604682922, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 44.232432432432425, "ram_util_percent": 83.33243243243243}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.640384504088649, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.515718745680713, "policy_loss": -0.015223083538914878, "vf_loss": 5.52900384519466, "vf_explained_var": 0.31455066506824797, "kl": 0.009689901277137102, "entropy": 1.5741964669454664, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 3308.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952094}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.152020900211637, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.908896389713994, "policy_loss": -0.018490047493478944, "vf_loss": 2.9257041190667126, "vf_explained_var": 0.14651275236139852, "kl": 0.008411605797570061, "entropy": 1.585461058440032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 3308.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952094}}, "num_env_steps_sampled": 16032, "num_env_steps_trained": 16032, "num_agent_steps_sampled": 64128, "num_agent_steps_trained": 64128}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64128, "num_agent_steps_trained": 64128, "num_env_steps_sampled": 16032, "num_env_steps_trained": 16032, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 145.2334993385872, "num_env_steps_trained_throughput_per_sec": 145.2334993385872, "timesteps_total": 16032, "num_env_steps_sampled_lifetime": 16032, "num_agent_steps_sampled_lifetime": 64128, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 64128, "timers": {"training_iteration_time_ms": 28214.389, "restore_workers_time_ms": 0.039, "training_step_time_ms": 28213.287, "sample_time_ms": 4473.181, "learn_time_ms": 23717.007, "learn_throughput": 168.993, "synch_weights_time_ms": 18.001}, "counters": {"num_env_steps_sampled": 16032, "num_env_steps_trained": 16032, "num_agent_steps_sampled": 64128, "num_agent_steps_trained": 64128}, "done": false, "training_iteration": 4, "trial_id": "7f713_00000", "date": "2024-08-23_09-48-33", "timestamp": 1724386713, "time_this_iter_s": 27.640167951583862, "time_total_s": 113.00786399841309, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x173753ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 113.00786399841309, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 42.56923076923078, "ram_util_percent": 83.29230769230769}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.877251539406953, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.564506064016352, "policy_loss": -0.018723868965183597, "vf_loss": 5.581341139475504, "vf_explained_var": 0.36273244398611565, "kl": 0.009443935264079344, "entropy": 1.5643340897938562, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 4253.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.197122785717091, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.4160743830695983, "policy_loss": -0.018901757951320774, "vf_loss": 2.4334402457746878, "vf_explained_var": 0.1586853642943044, "kl": 0.007679472636510298, "entropy": 1.576953029254126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 4253.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 20040, "num_env_steps_trained": 20040, "num_agent_steps_sampled": 80160, "num_agent_steps_trained": 80160}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80160, "num_agent_steps_trained": 80160, "num_env_steps_sampled": 20040, "num_env_steps_trained": 20040, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 141.46574492451364, "num_env_steps_trained_throughput_per_sec": 141.46574492451364, "timesteps_total": 20040, "num_env_steps_sampled_lifetime": 20040, "num_agent_steps_sampled_lifetime": 80160, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 80160, "timers": {"training_iteration_time_ms": 28237.902, "restore_workers_time_ms": 0.034, "training_step_time_ms": 28236.978, "sample_time_ms": 4319.221, "learn_time_ms": 23891.237, "learn_throughput": 167.76, "synch_weights_time_ms": 21.609}, "counters": {"num_env_steps_sampled": 20040, "num_env_steps_trained": 20040, "num_agent_steps_sampled": 80160, "num_agent_steps_trained": 80160}, "done": false, "training_iteration": 5, "trial_id": "7f713_00000", "date": "2024-08-23_09-49-01", "timestamp": 1724386741, "time_this_iter_s": 28.381221771240234, "time_total_s": 141.38908576965332, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30f7a0b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 141.38908576965332, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 47.87804878048781, "ram_util_percent": 83.39512195121952}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.917602319818325, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.063180086852381, "policy_loss": -0.01652276001860777, "vf_loss": 6.077852944974546, "vf_explained_var": 0.4126341042064485, "kl": 0.00924942259548636, "entropy": 1.556754115649632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 5198.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8733856529155106, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.219787915673836, "policy_loss": -0.01915771129329211, "vf_loss": 2.236968977867611, "vf_explained_var": 0.18383935090726014, "kl": 0.009883283073742869, "entropy": 1.564304909882722, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 5198.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 24048, "num_env_steps_trained": 24048, "num_agent_steps_sampled": 96192, "num_agent_steps_trained": 96192}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96192, "num_agent_steps_trained": 96192, "num_env_steps_sampled": 24048, "num_env_steps_trained": 24048, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 146.84487225483429, "num_env_steps_trained_throughput_per_sec": 146.84487225483429, "timesteps_total": 24048, "num_env_steps_sampled_lifetime": 24048, "num_agent_steps_sampled_lifetime": 96192, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 96192, "timers": {"training_iteration_time_ms": 28080.608, "restore_workers_time_ms": 0.033, "training_step_time_ms": 28079.824, "sample_time_ms": 4115.067, "learn_time_ms": 23938.941, "learn_throughput": 167.426, "synch_weights_time_ms": 20.265}, "counters": {"num_env_steps_sampled": 24048, "num_env_steps_trained": 24048, "num_agent_steps_sampled": 96192, "num_agent_steps_trained": 96192}, "done": false, "training_iteration": 6, "trial_id": "7f713_00000", "date": "2024-08-23_09-49-28", "timestamp": 1724386768, "time_this_iter_s": 27.312912702560425, "time_total_s": 168.70199847221375, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30f74fe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 168.70199847221375, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 41.2, "ram_util_percent": 83.27894736842104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.341029457945042, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.104330228371595, "policy_loss": -0.013714253200247647, "vf_loss": 6.116194140721881, "vf_explained_var": 0.48393339000681723, "kl": 0.009251571442961456, "entropy": 1.5527558070641976, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 6143.0, "diff_num_grad_updates_vs_sampler_policy": 506.8952095808381}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.183544974478464, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 1.9709172689094745, "policy_loss": -0.016133719386049995, "vf_loss": 1.9850414618613228, "vf_explained_var": 0.16630343879972184, "kl": 0.01004763812753101, "entropy": 1.5598825908842542, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 6143.0, "diff_num_grad_updates_vs_sampler_policy": 506.8952095808381}}, "num_env_steps_sampled": 28056, "num_env_steps_trained": 28056, "num_agent_steps_sampled": 112224, "num_agent_steps_trained": 112224}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112224, "num_agent_steps_trained": 112224, "num_env_steps_sampled": 28056, "num_env_steps_trained": 28056, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 154.57788394561376, "num_env_steps_trained_throughput_per_sec": 154.57788394561376, "timesteps_total": 28056, "num_env_steps_sampled_lifetime": 28056, "num_agent_steps_sampled_lifetime": 112224, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 112224, "timers": {"training_iteration_time_ms": 27773.207, "restore_workers_time_ms": 0.031, "training_step_time_ms": 27771.327, "sample_time_ms": 3848.027, "learn_time_ms": 23897.618, "learn_throughput": 167.715, "synch_weights_time_ms": 20.493}, "counters": {"num_env_steps_sampled": 28056, "num_env_steps_trained": 28056, "num_agent_steps_sampled": 112224, "num_agent_steps_trained": 112224}, "done": false, "training_iteration": 7, "trial_id": "7f713_00000", "date": "2024-08-23_09-49-54", "timestamp": 1724386794, "time_this_iter_s": 25.966090202331543, "time_total_s": 194.6680886745453, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30f7a0af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 194.6680886745453, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 38.17837837837837, "ram_util_percent": 83.26486486486486}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.938646763973135, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.442342873729726, "policy_loss": -0.012329733297019389, "vf_loss": 6.452571958208841, "vf_explained_var": 0.5665375865325726, "kl": 0.010503126339366039, "entropy": 1.549127778805122, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 7088.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7678091212555214, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.1545591525930576, "policy_loss": -0.01666699602717051, "vf_loss": 2.1697630787652638, "vf_explained_var": 0.271796278915708, "kl": 0.0073153573642706585, "entropy": 1.54839623592518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 7088.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 32064, "num_env_steps_trained": 32064, "num_agent_steps_sampled": 128256, "num_agent_steps_trained": 128256}, "env_runners": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_timesteps_total": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_episodes": 0, "episode_return_max": NaN, "episode_return_min": NaN, "episode_return_mean": NaN, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128256, "num_agent_steps_trained": 128256, "num_env_steps_sampled": 32064, "num_env_steps_trained": 32064, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 154.36553911741467, "num_env_steps_trained_throughput_per_sec": 154.36553911741467, "timesteps_total": 32064, "num_env_steps_sampled_lifetime": 32064, "num_agent_steps_sampled_lifetime": 128256, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 128256, "timers": {"training_iteration_time_ms": 27547.102, "restore_workers_time_ms": 0.03, "training_step_time_ms": 27545.404, "sample_time_ms": 3665.903, "learn_time_ms": 23853.052, "learn_throughput": 168.029, "synch_weights_time_ms": 20.784}, "counters": {"num_env_steps_sampled": 32064, "num_env_steps_trained": 32064, "num_agent_steps_sampled": 128256, "num_agent_steps_trained": 128256}, "done": false, "training_iteration": 8, "trial_id": "7f713_00000", "date": "2024-08-23_09-50-20", "timestamp": 1724386820, "time_this_iter_s": 25.993574142456055, "time_total_s": 220.66166281700134, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17374e9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 220.66166281700134, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 37.53611111111111, "ram_util_percent": 83.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.272643022499388, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.428332052281294, "policy_loss": -0.013347261812212685, "vf_loss": 6.440002975766621, "vf_explained_var": 0.63167573396491, "kl": 0.008381568936128465, "entropy": 1.5469406688024128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 8033.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952094}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.453677571829034, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.020457015466438, "policy_loss": -0.014290120768010933, "vf_loss": 2.033544515428089, "vf_explained_var": 0.297452493256362, "kl": 0.0060131152183871975, "entropy": 1.545365020080849, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 8033.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952094}}, "num_env_steps_sampled": 36072, "num_env_steps_trained": 36072, "num_agent_steps_sampled": 144288, "num_agent_steps_trained": 144288}, "env_runners": {"episode_reward_max": 417.5343435266533, "episode_reward_min": 417.5343435266533, "episode_reward_mean": 417.5343435266533, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 400, "policy_reward_min": {"prey_policy": -14.066595544171463, "predator_policy": 15.228015512713306}, "policy_reward_max": {"prey_policy": 325.8371596512905, "predator_policy": 90.5357639068188}, "policy_reward_mean": {"prey_policy": 155.88528205355954, "predator_policy": 52.88188970976606}, "custom_metrics": {}, "hist_stats": {"episode_reward": [417.5343435266533], "episode_lengths": [400], "policy_prey_policy_reward": [325.8371596512905, -14.066595544171463], "policy_predator_policy_reward": [90.5357639068188, 15.228015512713306]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.934242038886323, "mean_inference_ms": 5.907788783703512, "mean_action_processing_ms": 3.890386191747522, "mean_env_wait_ms": 13.33530487552766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038623809814453125, "StateBufferConnector_ms": 0.004649162292480469, "ViewRequirementAgentConnector_ms": 0.13365745544433594}, "num_episodes": 1, "episode_return_max": 417.5343435266533, "episode_return_min": 417.5343435266533, "episode_return_mean": 417.5343435266533, "episodes_this_iter": 1}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144288, "num_agent_steps_trained": 144288, "num_env_steps_sampled": 36072, "num_env_steps_trained": 36072, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 153.08361593920617, "num_env_steps_trained_throughput_per_sec": 153.08361593920617, "timesteps_total": 36072, "num_env_steps_sampled_lifetime": 36072, "num_agent_steps_sampled_lifetime": 144288, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 144288, "timers": {"training_iteration_time_ms": 27395.447, "restore_workers_time_ms": 0.036, "training_step_time_ms": 27393.877, "sample_time_ms": 3525.796, "learn_time_ms": 23843.057, "learn_throughput": 168.099, "synch_weights_time_ms": 19.818}, "counters": {"num_env_steps_sampled": 36072, "num_env_steps_trained": 36072, "num_agent_steps_sampled": 144288, "num_agent_steps_trained": 144288}, "done": false, "training_iteration": 9, "trial_id": "7f713_00000", "date": "2024-08-23_09-50-47", "timestamp": 1724386847, "time_this_iter_s": 26.260868787765503, "time_total_s": 246.92253160476685, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17374ea60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 246.92253160476685, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 37.38421052631579, "ram_util_percent": 82.70789473684209}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.640680337204504, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.641732089229362, "policy_loss": -0.014742863127005795, "vf_loss": 6.654036662692115, "vf_explained_var": 0.5767675390319219, "kl": 0.012191452387050189, "entropy": 1.5125943916815299, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 8978.0, "diff_num_grad_updates_vs_sampler_policy": 489.44760479041906}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.7054527492750258, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 2.79145071809254, "policy_loss": -0.014499261175040846, "vf_loss": 2.804123145941073, "vf_explained_var": 0.2394541271779903, "kl": 0.009134125333308938, "entropy": 1.5109218061285674, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 8978.0, "diff_num_grad_updates_vs_sampler_policy": 489.44760479041906}}, "num_env_steps_sampled": 40080, "num_env_steps_trained": 40080, "num_agent_steps_sampled": 160320, "num_agent_steps_trained": 160320}, "env_runners": {"episode_reward_max": 670.4657532097299, "episode_reward_min": 63.60000000000064, "episode_reward_mean": 336.9056698611064, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 15600, "policy_reward_min": {"prey_policy": -758.6585363618319, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.39812476934185, "predator_policy": 783.6585363618342}, "policy_reward_mean": {"prey_policy": 21.278074417272617, "predator_policy": 147.17476051328046}, "custom_metrics": {}, "hist_stats": {"episode_reward": [417.5343435266533, 277.8285699626214, 221.19999999999936, 643.9, 217.00397617930216, 438.5000000000002, 159.2660234904566, 332.49544780735414, 192.69999999999973, 287.9000000000004, 143.99448238067174, 378.49572215097396, 437.43638924704425, 153.40910651768354, 353.59999999999945, 414.1516219677084, 101.6486787787439, 264.59999999999934, 515.0028044225024, 407.29999999999984, 290.29999999999967, 545.3147051543704, 394.34971644140677, 665.6000000000005, 621.1999999999999, 284.4999999999995, 501.4000000000009, 105.67729972191381, 63.60000000000064, 198.49999999999898, 352.3000000000001, 670.4657532097299, 221.09999999999962, 629.0999999999996, 154.49999999999994, 256.9999999999994, 79.69999999999962, 423.000000000001, 323.74648362401234], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [325.8371596512905, -14.066595544171463, -52.82313893759988, -164.29114468296177, -85.79998739110636, -13.588793554722963, 332.25124387886655, 147.02160009375768, -306.45739063662944, -21.600829801829633, -282.40666517856624, 333.7236823683511, 126.89217078280518, -244.1617395240107, -224.39920693922377, 21.636981978496625, 61.214644984156436, 9.731502500465899, 125.08735692812344, -70.61764791948775, -359.44473114452876, -90.41735263040046, 344.9859562925368, -207.00166412683598, 27.153898748503124, 206.73432372834432, -291.68556273332206, -127.16768449543281, -181.7418281411219, 295.1456082653041, 179.27971810034433, -172.30657667290544, -62.73608616131373, -43.5923167389877, -6.12397680961007, 40.0000000000003, 126.35804996745358, -16.451004416941213, 174.76638057430276, 141.58990226650653, -151.0803453527665, 75.0092566176061, 293.7884928854844, -98.6787160452382, -146.08424078765182, 250.09438681607867, 214.71094155909972, 325.3109994183159, 305.92638234323067, 282.64884921322357, -37.451571777250734, 113.12324094697021, 72.18847733527721, 306.4, -16.995319437314592, -146.9979262421549, -226.0092898303175, -3.457610657704323, 92.21325366904411, -16.407833461053997, 286.41980717170986, -278.46588591139624, 298.890892915558, 273.993164387872, -65.64240675168766, 85.13802047925101, 327.0249248929636, 169.982926618297, -150.67429004253253, 52.18061525315246, 132.19494739734043, -107.024059833389, -130.97540666716122, -143.89284111669446, 395.39812476934185, -758.6585363618319, -186.81663920847404, -8.163237585832512], "policy_predator_policy_reward": [90.5357639068188, 15.228015512713306, 167.28756920935112, 327.6552843738314, 270.59998739110836, 49.98879355472337, 1.0487561211334353, 163.5783999062422, 462.27026839099625, 82.79192822676666, 347.90666517856687, 39.27631763164891, 271.44918173648574, 5.086410495174961, 388.1692403635816, 147.08843240449977, 7.48637412593246, 114.26747838944519, 21.0126430718765, 212.41764791948722, 336.68689146078236, 257.16967469481847, 0.9528870870811664, 239.55854289818868, 138.7698710795997, 64.77829569059766, 244.94575896189616, 327.31659478454617, 220.1817266907309, 20.01449318508697, 101.19618293032259, 305.9822976099472, 190.58481178859418, 17.392269890450866, 230.7239768096096, 0.0, 247.211678964181, 157.88407990780874, 16.233619425697366, 74.71009773349365, 187.080345352766, 179.29074338239357, 242.63330379578125, 107.5716245183428, 222.46533743401005, 67.87423297896892, 106.3890584409003, 19.18900058168418, 7.773617656768911, 24.851150786776262, 73.65157177725125, 135.1767590530293, 122.81152266472283, 0.0, 231.09299802403564, 38.57754737734721, 252.6092898303161, 40.457610657704485, 31.519248473314622, 91.1753313186957, 41.580192828290166, 302.76588591139597, 84.51697263197974, 13.064723274320055, 108.24240675168575, 93.36197952074849, 41.975075107036375, 90.11707338170315, 181.77429004253102, 71.21938474684747, 89.80505260265919, 142.0240598333892, 178.67540666716008, 175.89284111669278, 2.6018752306581194, 783.6585363618342, 114.95902213546077, 403.76733828285836]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.485308903796186, "mean_inference_ms": 6.5408376499322305, "mean_action_processing_ms": 2.7938875058651425, "mean_env_wait_ms": 15.436348208202721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02658397723466922, "StateBufferConnector_ms": 0.038650096991123296, "ViewRequirementAgentConnector_ms": 0.19992651083530524}, "num_episodes": 38, "episode_return_max": 670.4657532097299, "episode_return_min": 63.60000000000064, "episode_return_mean": 336.9056698611064, "episodes_this_iter": 38}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160320, "num_agent_steps_trained": 160320, "num_env_steps_sampled": 40080, "num_env_steps_trained": 40080, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 147.10276386250283, "num_env_steps_trained_throughput_per_sec": 147.10276386250283, "timesteps_total": 40080, "num_env_steps_sampled_lifetime": 40080, "num_agent_steps_sampled_lifetime": 160320, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 160320, "timers": {"training_iteration_time_ms": 27380.529, "restore_workers_time_ms": 0.034, "training_step_time_ms": 27379.081, "sample_time_ms": 3518.468, "learn_time_ms": 23834.57, "learn_throughput": 168.159, "synch_weights_time_ms": 20.534}, "counters": {"num_env_steps_sampled": 40080, "num_env_steps_trained": 40080, "num_agent_steps_sampled": 160320, "num_agent_steps_trained": 160320}, "done": false, "training_iteration": 10, "trial_id": "7f713_00000", "date": "2024-08-23_09-51-14", "timestamp": 1724386874, "time_this_iter_s": 27.274626970291138, "time_total_s": 274.197158575058, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30f7a09d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 274.197158575058, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 40.973684210526315, "ram_util_percent": 83.32105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.176492629732405, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.130541820122452, "policy_loss": -0.018681992188209384, "vf_loss": 7.146651255390632, "vf_explained_var": 0.5695227716965651, "kl": 0.012862734756279717, "entropy": 1.4597820005719624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 9923.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.7736968368449535, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.058989996632571, "policy_loss": -0.01616837241238466, "vf_loss": 4.072729989460536, "vf_explained_var": 0.26963392704252215, "kl": 0.012142037838283512, "entropy": 1.4522173254578201, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 9923.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 44088, "num_env_steps_trained": 44088, "num_agent_steps_sampled": 176352, "num_agent_steps_trained": 176352}, "env_runners": {"episode_reward_max": 670.4657532097299, "episode_reward_min": 42.80000000000034, "episode_reward_mean": 330.3150406514247, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 34800, "policy_reward_min": {"prey_policy": -758.6585363618319, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.39812476934185, "predator_policy": 783.6585363618342}, "policy_reward_mean": {"prey_policy": -2.4113117162611974, "predator_policy": 167.56883204197365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [417.5343435266533, 277.8285699626214, 221.19999999999936, 643.9, 217.00397617930216, 438.5000000000002, 159.2660234904566, 332.49544780735414, 192.69999999999973, 287.9000000000004, 143.99448238067174, 378.49572215097396, 437.43638924704425, 153.40910651768354, 353.59999999999945, 414.1516219677084, 101.6486787787439, 264.59999999999934, 515.0028044225024, 407.29999999999984, 290.29999999999967, 545.3147051543704, 394.34971644140677, 665.6000000000005, 621.1999999999999, 284.4999999999995, 501.4000000000009, 105.67729972191381, 63.60000000000064, 198.49999999999898, 352.3000000000001, 670.4657532097299, 221.09999999999962, 629.0999999999996, 154.49999999999994, 256.9999999999994, 79.69999999999962, 423.000000000001, 323.74648362401234, 321.5000000000007, 329.36978953802776, 114.05682186513761, 65.40000000000056, 505.7365625446176, 129.2827968280098, 67.30000000000048, 670.4, 277.9999999999992, 291.75355525037304, 522.3, 608.3010619640653, 107.59999999999776, 596.5999999999999, 303.3924651254909, 361.88191575745566, 659.0999999999997, 270.8999999999987, 121.45074684130286, 510.57008704771323, 122.85126795394909, 571.9318860065107, 559.6353745792964, 108.00003119897707, 302.07392108222916, 247.4999999999993, 71.30000000000021, 481.90951227473926, 489.8400500106608, 253.01411288372555, 660.0, 522.8999999999994, 438.3303508817331, 374.4578809205934, 538.0406665379096, 200.49999999999875, 334.7475285834867, 297.4477650030325, 221.89999999999947, 249.40000000000006, 198.08712801520244, 201.9028439330807, 279.2811508032777, 129.2999999999964, 422.90000000000026, 231.05119283126314, 212.08894582895084, 42.80000000000034], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [325.8371596512905, -14.066595544171463, -52.82313893759988, -164.29114468296177, -85.79998739110636, -13.588793554722963, 332.25124387886655, 147.02160009375768, -306.45739063662944, -21.600829801829633, -282.40666517856624, 333.7236823683511, 126.89217078280518, -244.1617395240107, -224.39920693922377, 21.636981978496625, 61.214644984156436, 9.731502500465899, 125.08735692812344, -70.61764791948775, -359.44473114452876, -90.41735263040046, 344.9859562925368, -207.00166412683598, 27.153898748503124, 206.73432372834432, -291.68556273332206, -127.16768449543281, -181.7418281411219, 295.1456082653041, 179.27971810034433, -172.30657667290544, -62.73608616131373, -43.5923167389877, -6.12397680961007, 40.0000000000003, 126.35804996745358, -16.451004416941213, 174.76638057430276, 141.58990226650653, -151.0803453527665, 75.0092566176061, 293.7884928854844, -98.6787160452382, -146.08424078765182, 250.09438681607867, 214.71094155909972, 325.3109994183159, 305.92638234323067, 282.64884921322357, -37.451571777250734, 113.12324094697021, 72.18847733527721, 306.4, -16.995319437314592, -146.9979262421549, -226.0092898303175, -3.457610657704323, 92.21325366904411, -16.407833461053997, 286.41980717170986, -278.46588591139624, 298.890892915558, 273.993164387872, -65.64240675168766, 85.13802047925101, 327.0249248929636, 169.982926618297, -150.67429004253253, 52.18061525315246, 132.19494739734043, -107.024059833389, -130.97540666716122, -143.89284111669446, 395.39812476934185, -758.6585363618319, -186.81663920847404, -8.163237585832512, 108.81981236909809, -3.6813319629675316, -64.49713907669849, 27.951592460839663, -319.5205835999528, -40.04460267249184, -205.60227842247784, -28.455214419978688, 223.96495654996568, 82.53603114734284, -188.37547724398033, -374.2335805551724, -26.02851519330637, -167.17748388133202, 307.0308544748754, 224.0352042114469, -314.86364508444206, 172.22438696943794, -229.65944365151347, 110.16785192377645, 154.21336504227446, 141.8362415184777, 176.210990988467, 359.2803960284418, 38.66922523697843, 65.20000000000026, 300.46011903659183, 117.01241024637199, -269.4365288253797, 150.6621114084103, 152.88152010046525, -162.57465910513324, 373.1244720704615, 208.52936765249945, -182.65799150133213, 13.410193929284532, -379.64596658755823, -172.43544257926874, 176.101704516153, 176.74328061761727, -322.8436087421259, -720.4894772232338, 247.7236899655024, 196.57807904239291, 215.93817452112108, 33.02760521068543, -391.7883166093885, -24.82171398185354, -88.31031822991562, -359.980290578632, 15.560412252291057, 124.92062043693758, 1.2905787169666054, -57.60153609110647, -26.580689797320545, 244.6745416415708, 18.37427625913751, 222.78399511159145, -83.89427172069635, -66.26943583963137, 82.87169810412195, 364.0095963114548, 394.32050087599856, -32.87614273232302, 106.47756025710967, -70.35220922302227, 13.62643583516342, -55.56818982142299, 219.27378477358272, -43.850475462987696, 15.487354990899146, -244.2390861051677, -409.65733170506445, 5.890431249136977, 20.975457323458585, -99.28716634005158, -570.507498935162, 2.579257326784008, 67.3573303255069, -48.34657759345873, -67.39815027658582, -393.7638080850911, -204.45985932592498, -156.37791014014618, 24.029907860919806, 89.11977908836727, -31.632124365771688, 84.81428328726112, 143.24482113232295, 104.23273283174996, -144.09286564788707, -237.75121529788905, -148.35878287730966, -85.91269398348457, -407.7601844409984, -275.8452208713854], "policy_predator_policy_reward": [90.5357639068188, 15.228015512713306, 167.28756920935112, 327.6552843738314, 270.59998739110836, 49.98879355472337, 1.0487561211334353, 163.5783999062422, 462.27026839099625, 82.79192822676666, 347.90666517856687, 39.27631763164891, 271.44918173648574, 5.086410495174961, 388.1692403635816, 147.08843240449977, 7.48637412593246, 114.26747838944519, 21.0126430718765, 212.41764791948722, 336.68689146078236, 257.16967469481847, 0.9528870870811664, 239.55854289818868, 138.7698710795997, 64.77829569059766, 244.94575896189616, 327.31659478454617, 220.1817266907309, 20.01449318508697, 101.19618293032259, 305.9822976099472, 190.58481178859418, 17.392269890450866, 230.7239768096096, 0.0, 247.211678964181, 157.88407990780874, 16.233619425697366, 74.71009773349365, 187.080345352766, 179.29074338239357, 242.63330379578125, 107.5716245183428, 222.46533743401005, 67.87423297896892, 106.3890584409003, 19.18900058168418, 7.773617656768911, 24.851150786776262, 73.65157177725125, 135.1767590530293, 122.81152266472283, 0.0, 231.09299802403564, 38.57754737734721, 252.6092898303161, 40.457610657704485, 31.519248473314622, 91.1753313186957, 41.580192828290166, 302.76588591139597, 84.51697263197974, 13.064723274320055, 108.24240675168575, 93.36197952074849, 41.975075107036375, 90.11707338170315, 181.77429004253102, 71.21938474684747, 89.80505260265919, 142.0240598333892, 178.67540666716008, 175.89284111669278, 2.6018752306581194, 783.6585363618342, 114.95902213546077, 403.76733828285836, 175.2801876309016, 41.081331962967845, 332.9943569262601, 32.92097922762657, 338.5804921631364, 135.0415159744452, 236.2022784224761, 63.25521441997917, 2.758820967932773, 196.476753879377, 250.26531291269495, 441.6265417144673, 61.32851519330687, 199.17748388133208, 66.96914552512459, 72.36479578855297, 336.26364508444453, 84.3756130305621, 228.99110723508903, 182.2540397430192, 104.18663495772498, 122.06375848152194, 69.547728433925, 3.261946513231429, 3.730774763021854, 0.0, 25.97737151015313, 153.15009920688297, 67.37813104162926, 354.7887515008322, 325.76534332235474, 45.8097114397696, 29.077900686865714, 48.36825959017337, 212.25799150133045, 227.88980607071548, 542.4390857271544, 131.09307028097987, 132.3238067252953, 25.40129518864795, 673.0493656817617, 493.1349882375474, 83.46753979735674, 44.16257720125898, 20.768242892220385, 289.9013519552689, 412.5907750978729, 112.01928669235305, 264.29924631196064, 486.065283578816, 22.839587747708954, 84.17937956306244, 36.70942128303364, 90.9015360911054, 175.64976087246959, 88.1658995580193, 161.54310745661883, 87.13867118331342, 303.25762808901123, 99.92019235504287, 195.12830189587794, 17.990403688545197, 2.6794991240014334, 158.77614273232288, 87.27851402563361, 314.92648582201303, 240.4503627568255, 175.94927215002676, 255.16213325500277, 107.45522397231186, 274.3196313028929, 154.9320998113754, 466.68633628422674, 271.8280927551873, 282.15895763593164, 93.60051638369279, 582.2074989351645, 207.62074267321603, 32.142669674493234, 198.24657759345797, 564.5433945995038, 94.70569177737467, 385.39458530651916, 177.3460280926323, 21.49074240701647, 144.6407214469759, 66.83212436577219, 9.28571671273771, 72.0075580190766, 103.41488801685033, 56.20187143399512, 556.693402343045, 380.8867931495047, 65.47362954024008, 426.5601844409974, 299.8452208713855]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.293200810794888, "mean_inference_ms": 6.495024427196798, "mean_action_processing_ms": 2.7013385493964805, "mean_env_wait_ms": 15.456340792794874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01422125717689251, "StateBufferConnector_ms": 0.021077298569953305, "ViewRequirementAgentConnector_ms": 0.18462326334810805}, "num_episodes": 48, "episode_return_max": 670.4657532097299, "episode_return_min": 42.80000000000034, "episode_return_mean": 330.3150406514247, "episodes_this_iter": 48}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176352, "num_agent_steps_trained": 176352, "num_env_steps_sampled": 44088, "num_env_steps_trained": 44088, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 151.86329879720293, "num_env_steps_trained_throughput_per_sec": 151.86329879720293, "timesteps_total": 44088, "num_env_steps_sampled_lifetime": 44088, "num_agent_steps_sampled_lifetime": 176352, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 176352, "timers": {"training_iteration_time_ms": 26763.307, "restore_workers_time_ms": 0.035, "training_step_time_ms": 26761.749, "sample_time_ms": 2969.745, "learn_time_ms": 23764.462, "learn_throughput": 168.655, "synch_weights_time_ms": 22.058}, "counters": {"num_env_steps_sampled": 44088, "num_env_steps_trained": 44088, "num_agent_steps_sampled": 176352, "num_agent_steps_trained": 176352}, "done": false, "training_iteration": 11, "trial_id": "7f713_00000", "date": "2024-08-23_09-51-41", "timestamp": 1724386901, "time_this_iter_s": 26.448455095291138, "time_total_s": 300.6456136703491, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x173753940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 300.6456136703491, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 39.660526315789475, "ram_util_percent": 83.25263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.016691411361492, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.545366338194993, "policy_loss": -0.016509037413979293, "vf_loss": 7.559517397703948, "vf_explained_var": 0.5408430268524815, "kl": 0.011789785998641814, "entropy": 1.4145446506126849, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 10868.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.55155085596458, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.062715423422516, "policy_loss": -0.018965333647947148, "vf_loss": 5.078984352898976, "vf_explained_var": 0.24717698746888095, "kl": 0.013481993323300408, "entropy": 1.3976785710248998, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 10868.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 48096, "num_env_steps_trained": 48096, "num_agent_steps_sampled": 192384, "num_agent_steps_trained": 192384}, "env_runners": {"episode_reward_max": 736.2007203177695, "episode_reward_min": 42.80000000000034, "episode_reward_mean": 328.669360067591, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -758.6585363618319, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.39812476934185, "predator_policy": 783.6585363618342}, "policy_reward_mean": {"prey_policy": -7.004041894462348, "predator_policy": 171.33872192825794}, "custom_metrics": {}, "hist_stats": {"episode_reward": [332.49544780735414, 192.69999999999973, 287.9000000000004, 143.99448238067174, 378.49572215097396, 437.43638924704425, 153.40910651768354, 353.59999999999945, 414.1516219677084, 101.6486787787439, 264.59999999999934, 515.0028044225024, 407.29999999999984, 290.29999999999967, 545.3147051543704, 394.34971644140677, 665.6000000000005, 621.1999999999999, 284.4999999999995, 501.4000000000009, 105.67729972191381, 63.60000000000064, 198.49999999999898, 352.3000000000001, 670.4657532097299, 221.09999999999962, 629.0999999999996, 154.49999999999994, 256.9999999999994, 79.69999999999962, 423.000000000001, 323.74648362401234, 321.5000000000007, 329.36978953802776, 114.05682186513761, 65.40000000000056, 505.7365625446176, 129.2827968280098, 67.30000000000048, 670.4, 277.9999999999992, 291.75355525037304, 522.3, 608.3010619640653, 107.59999999999776, 596.5999999999999, 303.3924651254909, 361.88191575745566, 659.0999999999997, 270.8999999999987, 121.45074684130286, 510.57008704771323, 122.85126795394909, 571.9318860065107, 559.6353745792964, 108.00003119897707, 302.07392108222916, 247.4999999999993, 71.30000000000021, 481.90951227473926, 489.8400500106608, 253.01411288372555, 660.0, 522.8999999999994, 438.3303508817331, 374.4578809205934, 538.0406665379096, 200.49999999999875, 334.7475285834867, 297.4477650030325, 221.89999999999947, 249.40000000000006, 198.08712801520244, 201.9028439330807, 279.2811508032777, 129.2999999999964, 422.90000000000026, 231.05119283126314, 212.08894582895084, 42.80000000000034, 419.400000000002, 190.7133390692015, 256.58004854601654, 206.66075850822185, 180.3514675305671, 241.1811606511069, 169.73913222789707, 736.2007203177695, 444.5527879505099, 171.34917641266662, 528.9999999999997, 141.99999999999943, 477.09999999999945, 339.1903572412453, 503.74115559848485, 148.0221481097201, 459.9781310807839, 357.0000000000002, 457.8000000000002, 74.20000000000005], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-224.39920693922377, 21.636981978496625, 61.214644984156436, 9.731502500465899, 125.08735692812344, -70.61764791948775, -359.44473114452876, -90.41735263040046, 344.9859562925368, -207.00166412683598, 27.153898748503124, 206.73432372834432, -291.68556273332206, -127.16768449543281, -181.7418281411219, 295.1456082653041, 179.27971810034433, -172.30657667290544, -62.73608616131373, -43.5923167389877, -6.12397680961007, 40.0000000000003, 126.35804996745358, -16.451004416941213, 174.76638057430276, 141.58990226650653, -151.0803453527665, 75.0092566176061, 293.7884928854844, -98.6787160452382, -146.08424078765182, 250.09438681607867, 214.71094155909972, 325.3109994183159, 305.92638234323067, 282.64884921322357, -37.451571777250734, 113.12324094697021, 72.18847733527721, 306.4, -16.995319437314592, -146.9979262421549, -226.0092898303175, -3.457610657704323, 92.21325366904411, -16.407833461053997, 286.41980717170986, -278.46588591139624, 298.890892915558, 273.993164387872, -65.64240675168766, 85.13802047925101, 327.0249248929636, 169.982926618297, -150.67429004253253, 52.18061525315246, 132.19494739734043, -107.024059833389, -130.97540666716122, -143.89284111669446, 395.39812476934185, -758.6585363618319, -186.81663920847404, -8.163237585832512, 108.81981236909809, -3.6813319629675316, -64.49713907669849, 27.951592460839663, -319.5205835999528, -40.04460267249184, -205.60227842247784, -28.455214419978688, 223.96495654996568, 82.53603114734284, -188.37547724398033, -374.2335805551724, -26.02851519330637, -167.17748388133202, 307.0308544748754, 224.0352042114469, -314.86364508444206, 172.22438696943794, -229.65944365151347, 110.16785192377645, 154.21336504227446, 141.8362415184777, 176.210990988467, 359.2803960284418, 38.66922523697843, 65.20000000000026, 300.46011903659183, 117.01241024637199, -269.4365288253797, 150.6621114084103, 152.88152010046525, -162.57465910513324, 373.1244720704615, 208.52936765249945, -182.65799150133213, 13.410193929284532, -379.64596658755823, -172.43544257926874, 176.101704516153, 176.74328061761727, -322.8436087421259, -720.4894772232338, 247.7236899655024, 196.57807904239291, 215.93817452112108, 33.02760521068543, -391.7883166093885, -24.82171398185354, -88.31031822991562, -359.980290578632, 15.560412252291057, 124.92062043693758, 1.2905787169666054, -57.60153609110647, -26.580689797320545, 244.6745416415708, 18.37427625913751, 222.78399511159145, -83.89427172069635, -66.26943583963137, 82.87169810412195, 364.0095963114548, 394.32050087599856, -32.87614273232302, 106.47756025710967, -70.35220922302227, 13.62643583516342, -55.56818982142299, 219.27378477358272, -43.850475462987696, 15.487354990899146, -244.2390861051677, -409.65733170506445, 5.890431249136977, 20.975457323458585, -99.28716634005158, -570.507498935162, 2.579257326784008, 67.3573303255069, -48.34657759345873, -67.39815027658582, -393.7638080850911, -204.45985932592498, -156.37791014014618, 24.029907860919806, 89.11977908836727, -31.632124365771688, 84.81428328726112, 143.24482113232295, 104.23273283174996, -144.09286564788707, -237.75121529788905, -148.35878287730966, -85.91269398348457, -407.7601844409984, -275.8452208713854, -62.493665516959915, 373.38849697078194, -1.1281041293728964, 23.42792829164796, -11.639212214654904, -108.45532574556333, -175.0578949082198, -602.6792855691608, -75.82440168396103, -232.79180783841878, 86.2572411341429, -506.1461191263618, -78.09224207905555, -36.51993144183948, 277.42917606285914, 291.26383588136724, 196.31849932747937, 189.03178725494604, -257.0980509155165, -515.1621249452353, 227.17697012819804, 229.1422309168554, -88.75144710702902, -316.2114541933408, 248.45841354397098, -5.968071176865834, 153.79450517304633, -132.78319039213343, 165.63107228813112, 48.78538298034627, -412.2885145996719, -116.37231203144117, -92.13984553003213, 207.76234063873528, 298.02667761036565, -352.86891556462797, 175.6258949686735, 149.819705390926, -94.27819128189459, 32.69938068933513], "policy_predator_policy_reward": [388.1692403635816, 147.08843240449977, 7.48637412593246, 114.26747838944519, 21.0126430718765, 212.41764791948722, 336.68689146078236, 257.16967469481847, 0.9528870870811664, 239.55854289818868, 138.7698710795997, 64.77829569059766, 244.94575896189616, 327.31659478454617, 220.1817266907309, 20.01449318508697, 101.19618293032259, 305.9822976099472, 190.58481178859418, 17.392269890450866, 230.7239768096096, 0.0, 247.211678964181, 157.88407990780874, 16.233619425697366, 74.71009773349365, 187.080345352766, 179.29074338239357, 242.63330379578125, 107.5716245183428, 222.46533743401005, 67.87423297896892, 106.3890584409003, 19.18900058168418, 7.773617656768911, 24.851150786776262, 73.65157177725125, 135.1767590530293, 122.81152266472283, 0.0, 231.09299802403564, 38.57754737734721, 252.6092898303161, 40.457610657704485, 31.519248473314622, 91.1753313186957, 41.580192828290166, 302.76588591139597, 84.51697263197974, 13.064723274320055, 108.24240675168575, 93.36197952074849, 41.975075107036375, 90.11707338170315, 181.77429004253102, 71.21938474684747, 89.80505260265919, 142.0240598333892, 178.67540666716008, 175.89284111669278, 2.6018752306581194, 783.6585363618342, 114.95902213546077, 403.76733828285836, 175.2801876309016, 41.081331962967845, 332.9943569262601, 32.92097922762657, 338.5804921631364, 135.0415159744452, 236.2022784224761, 63.25521441997917, 2.758820967932773, 196.476753879377, 250.26531291269495, 441.6265417144673, 61.32851519330687, 199.17748388133208, 66.96914552512459, 72.36479578855297, 336.26364508444453, 84.3756130305621, 228.99110723508903, 182.2540397430192, 104.18663495772498, 122.06375848152194, 69.547728433925, 3.261946513231429, 3.730774763021854, 0.0, 25.97737151015313, 153.15009920688297, 67.37813104162926, 354.7887515008322, 325.76534332235474, 45.8097114397696, 29.077900686865714, 48.36825959017337, 212.25799150133045, 227.88980607071548, 542.4390857271544, 131.09307028097987, 132.3238067252953, 25.40129518864795, 673.0493656817617, 493.1349882375474, 83.46753979735674, 44.16257720125898, 20.768242892220385, 289.9013519552689, 412.5907750978729, 112.01928669235305, 264.29924631196064, 486.065283578816, 22.839587747708954, 84.17937956306244, 36.70942128303364, 90.9015360911054, 175.64976087246959, 88.1658995580193, 161.54310745661883, 87.13867118331342, 303.25762808901123, 99.92019235504287, 195.12830189587794, 17.990403688545197, 2.6794991240014334, 158.77614273232288, 87.27851402563361, 314.92648582201303, 240.4503627568255, 175.94927215002676, 255.16213325500277, 107.45522397231186, 274.3196313028929, 154.9320998113754, 466.68633628422674, 271.8280927551873, 282.15895763593164, 93.60051638369279, 582.2074989351645, 207.62074267321603, 32.142669674493234, 198.24657759345797, 564.5433945995038, 94.70569177737467, 385.39458530651916, 177.3460280926323, 21.49074240701647, 144.6407214469759, 66.83212436577219, 9.28571671273771, 72.0075580190766, 103.41488801685033, 56.20187143399512, 556.693402343045, 380.8867931495047, 65.47362954024008, 426.5601844409974, 299.8452208713855, 96.69366551696005, 11.81150302921808, 5.211905980485061, 163.2016089264419, 259.49809979939965, 117.17648670683566, 318.6071120005597, 665.7908269850432, 12.63462893237487, 476.33304812057173, 415.86876173800965, 245.20127690531643, 214.99224207905462, 69.35906366973727, 90.90382219248754, 76.6038861810555, 35.24162032874874, 23.960881039335653, 280.31370393583757, 663.2956483375804, 58.87709615534794, 13.803702799598609, 103.74488222516067, 443.2180190752114, 74.941586456029, 159.66807117686568, 103.26729663065399, 214.91174582967977, 86.31849197407305, 203.0062083559338, 553.1720785414558, 123.51089619937594, 263.35364805618445, 81.00198791589598, 35.67332238963438, 376.1689155646287, 40.57410503132649, 91.78029460907386, 125.8781912818928, 9.900619310665093]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.396467398896768, "mean_inference_ms": 6.503149165538036, "mean_action_processing_ms": 2.5504104257364753, "mean_env_wait_ms": 15.598866221761911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013234615325927734, "StateBufferConnector_ms": 0.020670294761657715, "ViewRequirementAgentConnector_ms": 0.2076319456100464}, "num_episodes": 20, "episode_return_max": 736.2007203177695, "episode_return_min": 42.80000000000034, "episode_return_mean": 328.669360067591, "episodes_this_iter": 20}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192384, "num_agent_steps_trained": 192384, "num_env_steps_sampled": 48096, "num_env_steps_trained": 48096, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 149.54974984346924, "num_env_steps_trained_throughput_per_sec": 149.54974984346924, "timesteps_total": 48096, "num_env_steps_sampled_lifetime": 48096, "num_agent_steps_sampled_lifetime": 192384, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 192384, "timers": {"training_iteration_time_ms": 26799.901, "restore_workers_time_ms": 0.03, "training_step_time_ms": 26798.592, "sample_time_ms": 2956.253, "learn_time_ms": 23817.087, "learn_throughput": 168.283, "synch_weights_time_ms": 20.827}, "counters": {"num_env_steps_sampled": 48096, "num_env_steps_trained": 48096, "num_agent_steps_sampled": 192384, "num_agent_steps_trained": 192384}, "done": false, "training_iteration": 12, "trial_id": "7f713_00000", "date": "2024-08-23_09-52-07", "timestamp": 1724386927, "time_this_iter_s": 26.840282201766968, "time_total_s": 327.4858958721161, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737539d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 327.4858958721161, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 40.18648648648649, "ram_util_percent": 83.16216216216216}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.956184001826735, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.679634101302535, "policy_loss": -0.016488077934023248, "vf_loss": 7.693295222489291, "vf_explained_var": 0.3803516626358032, "kl": 0.014134902636909847, "entropy": 1.3940018232537326, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 11813.0, "diff_num_grad_updates_vs_sampler_policy": 489.44760479041906}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.190584555757109, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.710357731612271, "policy_loss": -0.01532589788474734, "vf_loss": 5.722895345233735, "vf_explained_var": 0.23076343839130706, "kl": 0.013941431049967095, "entropy": 1.3441374501223287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 11813.0, "diff_num_grad_updates_vs_sampler_policy": 489.44760479041906}}, "num_env_steps_sampled": 52104, "num_env_steps_trained": 52104, "num_agent_steps_sampled": 208416, "num_agent_steps_trained": 208416}, "env_runners": {"episode_reward_max": 736.2007203177695, "episode_reward_min": 42.80000000000034, "episode_reward_mean": 327.0742581755636, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -758.6585363618319, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.39812476934185, "predator_policy": 783.6585363618342}, "policy_reward_mean": {"prey_policy": -8.274950730787086, "predator_policy": 171.81207981856898}, "custom_metrics": {}, "hist_stats": {"episode_reward": [192.69999999999973, 287.9000000000004, 143.99448238067174, 378.49572215097396, 437.43638924704425, 153.40910651768354, 353.59999999999945, 414.1516219677084, 101.6486787787439, 264.59999999999934, 515.0028044225024, 407.29999999999984, 290.29999999999967, 545.3147051543704, 394.34971644140677, 665.6000000000005, 621.1999999999999, 284.4999999999995, 501.4000000000009, 105.67729972191381, 63.60000000000064, 198.49999999999898, 352.3000000000001, 670.4657532097299, 221.09999999999962, 629.0999999999996, 154.49999999999994, 256.9999999999994, 79.69999999999962, 423.000000000001, 323.74648362401234, 321.5000000000007, 329.36978953802776, 114.05682186513761, 65.40000000000056, 505.7365625446176, 129.2827968280098, 67.30000000000048, 670.4, 277.9999999999992, 291.75355525037304, 522.3, 608.3010619640653, 107.59999999999776, 596.5999999999999, 303.3924651254909, 361.88191575745566, 659.0999999999997, 270.8999999999987, 121.45074684130286, 510.57008704771323, 122.85126795394909, 571.9318860065107, 559.6353745792964, 108.00003119897707, 302.07392108222916, 247.4999999999993, 71.30000000000021, 481.90951227473926, 489.8400500106608, 253.01411288372555, 660.0, 522.8999999999994, 438.3303508817331, 374.4578809205934, 538.0406665379096, 200.49999999999875, 334.7475285834867, 297.4477650030325, 221.89999999999947, 249.40000000000006, 198.08712801520244, 201.9028439330807, 279.2811508032777, 129.2999999999964, 422.90000000000026, 231.05119283126314, 212.08894582895084, 42.80000000000034, 419.400000000002, 190.7133390692015, 256.58004854601654, 206.66075850822185, 180.3514675305671, 241.1811606511069, 169.73913222789707, 736.2007203177695, 444.5527879505099, 171.34917641266662, 528.9999999999997, 141.99999999999943, 477.09999999999945, 339.1903572412453, 503.74115559848485, 148.0221481097201, 459.9781310807839, 357.0000000000002, 457.8000000000002, 74.20000000000005, 172.98525860460566], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [61.214644984156436, 9.731502500465899, 125.08735692812344, -70.61764791948775, -359.44473114452876, -90.41735263040046, 344.9859562925368, -207.00166412683598, 27.153898748503124, 206.73432372834432, -291.68556273332206, -127.16768449543281, -181.7418281411219, 295.1456082653041, 179.27971810034433, -172.30657667290544, -62.73608616131373, -43.5923167389877, -6.12397680961007, 40.0000000000003, 126.35804996745358, -16.451004416941213, 174.76638057430276, 141.58990226650653, -151.0803453527665, 75.0092566176061, 293.7884928854844, -98.6787160452382, -146.08424078765182, 250.09438681607867, 214.71094155909972, 325.3109994183159, 305.92638234323067, 282.64884921322357, -37.451571777250734, 113.12324094697021, 72.18847733527721, 306.4, -16.995319437314592, -146.9979262421549, -226.0092898303175, -3.457610657704323, 92.21325366904411, -16.407833461053997, 286.41980717170986, -278.46588591139624, 298.890892915558, 273.993164387872, -65.64240675168766, 85.13802047925101, 327.0249248929636, 169.982926618297, -150.67429004253253, 52.18061525315246, 132.19494739734043, -107.024059833389, -130.97540666716122, -143.89284111669446, 395.39812476934185, -758.6585363618319, -186.81663920847404, -8.163237585832512, 108.81981236909809, -3.6813319629675316, -64.49713907669849, 27.951592460839663, -319.5205835999528, -40.04460267249184, -205.60227842247784, -28.455214419978688, 223.96495654996568, 82.53603114734284, -188.37547724398033, -374.2335805551724, -26.02851519330637, -167.17748388133202, 307.0308544748754, 224.0352042114469, -314.86364508444206, 172.22438696943794, -229.65944365151347, 110.16785192377645, 154.21336504227446, 141.8362415184777, 176.210990988467, 359.2803960284418, 38.66922523697843, 65.20000000000026, 300.46011903659183, 117.01241024637199, -269.4365288253797, 150.6621114084103, 152.88152010046525, -162.57465910513324, 373.1244720704615, 208.52936765249945, -182.65799150133213, 13.410193929284532, -379.64596658755823, -172.43544257926874, 176.101704516153, 176.74328061761727, -322.8436087421259, -720.4894772232338, 247.7236899655024, 196.57807904239291, 215.93817452112108, 33.02760521068543, -391.7883166093885, -24.82171398185354, -88.31031822991562, -359.980290578632, 15.560412252291057, 124.92062043693758, 1.2905787169666054, -57.60153609110647, -26.580689797320545, 244.6745416415708, 18.37427625913751, 222.78399511159145, -83.89427172069635, -66.26943583963137, 82.87169810412195, 364.0095963114548, 394.32050087599856, -32.87614273232302, 106.47756025710967, -70.35220922302227, 13.62643583516342, -55.56818982142299, 219.27378477358272, -43.850475462987696, 15.487354990899146, -244.2390861051677, -409.65733170506445, 5.890431249136977, 20.975457323458585, -99.28716634005158, -570.507498935162, 2.579257326784008, 67.3573303255069, -48.34657759345873, -67.39815027658582, -393.7638080850911, -204.45985932592498, -156.37791014014618, 24.029907860919806, 89.11977908836727, -31.632124365771688, 84.81428328726112, 143.24482113232295, 104.23273283174996, -144.09286564788707, -237.75121529788905, -148.35878287730966, -85.91269398348457, -407.7601844409984, -275.8452208713854, -62.493665516959915, 373.38849697078194, -1.1281041293728964, 23.42792829164796, -11.639212214654904, -108.45532574556333, -175.0578949082198, -602.6792855691608, -75.82440168396103, -232.79180783841878, 86.2572411341429, -506.1461191263618, -78.09224207905555, -36.51993144183948, 277.42917606285914, 291.26383588136724, 196.31849932747937, 189.03178725494604, -257.0980509155165, -515.1621249452353, 227.17697012819804, 229.1422309168554, -88.75144710702902, -316.2114541933408, 248.45841354397098, -5.968071176865834, 153.79450517304633, -132.78319039213343, 165.63107228813112, 48.78538298034627, -412.2885145996719, -116.37231203144117, -92.13984553003213, 207.76234063873528, 298.02667761036565, -352.86891556462797, 175.6258949686735, 149.819705390926, -94.27819128189459, 32.69938068933513, -188.86334254549385, -268.0806496801812], "policy_predator_policy_reward": [7.48637412593246, 114.26747838944519, 21.0126430718765, 212.41764791948722, 336.68689146078236, 257.16967469481847, 0.9528870870811664, 239.55854289818868, 138.7698710795997, 64.77829569059766, 244.94575896189616, 327.31659478454617, 220.1817266907309, 20.01449318508697, 101.19618293032259, 305.9822976099472, 190.58481178859418, 17.392269890450866, 230.7239768096096, 0.0, 247.211678964181, 157.88407990780874, 16.233619425697366, 74.71009773349365, 187.080345352766, 179.29074338239357, 242.63330379578125, 107.5716245183428, 222.46533743401005, 67.87423297896892, 106.3890584409003, 19.18900058168418, 7.773617656768911, 24.851150786776262, 73.65157177725125, 135.1767590530293, 122.81152266472283, 0.0, 231.09299802403564, 38.57754737734721, 252.6092898303161, 40.457610657704485, 31.519248473314622, 91.1753313186957, 41.580192828290166, 302.76588591139597, 84.51697263197974, 13.064723274320055, 108.24240675168575, 93.36197952074849, 41.975075107036375, 90.11707338170315, 181.77429004253102, 71.21938474684747, 89.80505260265919, 142.0240598333892, 178.67540666716008, 175.89284111669278, 2.6018752306581194, 783.6585363618342, 114.95902213546077, 403.76733828285836, 175.2801876309016, 41.081331962967845, 332.9943569262601, 32.92097922762657, 338.5804921631364, 135.0415159744452, 236.2022784224761, 63.25521441997917, 2.758820967932773, 196.476753879377, 250.26531291269495, 441.6265417144673, 61.32851519330687, 199.17748388133208, 66.96914552512459, 72.36479578855297, 336.26364508444453, 84.3756130305621, 228.99110723508903, 182.2540397430192, 104.18663495772498, 122.06375848152194, 69.547728433925, 3.261946513231429, 3.730774763021854, 0.0, 25.97737151015313, 153.15009920688297, 67.37813104162926, 354.7887515008322, 325.76534332235474, 45.8097114397696, 29.077900686865714, 48.36825959017337, 212.25799150133045, 227.88980607071548, 542.4390857271544, 131.09307028097987, 132.3238067252953, 25.40129518864795, 673.0493656817617, 493.1349882375474, 83.46753979735674, 44.16257720125898, 20.768242892220385, 289.9013519552689, 412.5907750978729, 112.01928669235305, 264.29924631196064, 486.065283578816, 22.839587747708954, 84.17937956306244, 36.70942128303364, 90.9015360911054, 175.64976087246959, 88.1658995580193, 161.54310745661883, 87.13867118331342, 303.25762808901123, 99.92019235504287, 195.12830189587794, 17.990403688545197, 2.6794991240014334, 158.77614273232288, 87.27851402563361, 314.92648582201303, 240.4503627568255, 175.94927215002676, 255.16213325500277, 107.45522397231186, 274.3196313028929, 154.9320998113754, 466.68633628422674, 271.8280927551873, 282.15895763593164, 93.60051638369279, 582.2074989351645, 207.62074267321603, 32.142669674493234, 198.24657759345797, 564.5433945995038, 94.70569177737467, 385.39458530651916, 177.3460280926323, 21.49074240701647, 144.6407214469759, 66.83212436577219, 9.28571671273771, 72.0075580190766, 103.41488801685033, 56.20187143399512, 556.693402343045, 380.8867931495047, 65.47362954024008, 426.5601844409974, 299.8452208713855, 96.69366551696005, 11.81150302921808, 5.211905980485061, 163.2016089264419, 259.49809979939965, 117.17648670683566, 318.6071120005597, 665.7908269850432, 12.63462893237487, 476.33304812057173, 415.86876173800965, 245.20127690531643, 214.99224207905462, 69.35906366973727, 90.90382219248754, 76.6038861810555, 35.24162032874874, 23.960881039335653, 280.31370393583757, 663.2956483375804, 58.87709615534794, 13.803702799598609, 103.74488222516067, 443.2180190752114, 74.941586456029, 159.66807117686568, 103.26729663065399, 214.91174582967977, 86.31849197407305, 203.0062083559338, 553.1720785414558, 123.51089619937594, 263.35364805618445, 81.00198791589598, 35.67332238963438, 376.1689155646287, 40.57410503132649, 91.78029460907386, 125.8781912818928, 9.900619310665093, 556.1667272678665, 73.76252356241389]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.385119638732483, "mean_inference_ms": 6.505220068513397, "mean_action_processing_ms": 2.5406245754228167, "mean_env_wait_ms": 15.579826848925888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013222694396972656, "StateBufferConnector_ms": 0.020653605461120605, "ViewRequirementAgentConnector_ms": 0.20699357986450195}, "num_episodes": 1, "episode_return_max": 736.2007203177695, "episode_return_min": 42.80000000000034, "episode_return_mean": 327.0742581755636, "episodes_this_iter": 1}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208416, "num_agent_steps_trained": 208416, "num_env_steps_sampled": 52104, "num_env_steps_trained": 52104, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 154.27377582830508, "num_env_steps_trained_throughput_per_sec": 154.27377582830508, "timesteps_total": 52104, "num_env_steps_sampled_lifetime": 52104, "num_agent_steps_sampled_lifetime": 208416, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 208416, "timers": {"training_iteration_time_ms": 26771.727, "restore_workers_time_ms": 0.029, "training_step_time_ms": 26770.545, "sample_time_ms": 2918.379, "learn_time_ms": 23827.319, "learn_throughput": 168.21, "synch_weights_time_ms": 20.528}, "counters": {"num_env_steps_sampled": 52104, "num_env_steps_trained": 52104, "num_agent_steps_sampled": 208416, "num_agent_steps_trained": 208416}, "done": false, "training_iteration": 13, "trial_id": "7f713_00000", "date": "2024-08-23_09-52-33", "timestamp": 1724386953, "time_this_iter_s": 26.009368896484375, "time_total_s": 353.49526476860046, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30f7a1670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 353.49526476860046, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 36.662162162162154, "ram_util_percent": 81.87027027027027}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.966669131965233, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.537136953848379, "policy_loss": -0.015095878927845252, "vf_loss": 7.549445784533465, "vf_explained_var": 0.36021422822639426, "kl": 0.013935289112111879, "entropy": 1.3751972440689328, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 12758.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.510596047255097, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.965138193160769, "policy_loss": -0.016693354188587774, "vf_loss": 5.979076707930792, "vf_explained_var": 0.22473701131406915, "kl": 0.01377416093237501, "entropy": 1.3293921195640765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 12758.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 56112, "num_env_steps_trained": 56112, "num_agent_steps_sampled": 224448, "num_agent_steps_trained": 224448}, "env_runners": {"episode_reward_max": 736.2007203177695, "episode_reward_min": 42.80000000000034, "episode_reward_mean": 327.0742581755636, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -758.6585363618319, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.39812476934185, "predator_policy": 783.6585363618342}, "policy_reward_mean": {"prey_policy": -8.274950730787086, "predator_policy": 171.81207981856898}, "custom_metrics": {}, "hist_stats": {"episode_reward": [192.69999999999973, 287.9000000000004, 143.99448238067174, 378.49572215097396, 437.43638924704425, 153.40910651768354, 353.59999999999945, 414.1516219677084, 101.6486787787439, 264.59999999999934, 515.0028044225024, 407.29999999999984, 290.29999999999967, 545.3147051543704, 394.34971644140677, 665.6000000000005, 621.1999999999999, 284.4999999999995, 501.4000000000009, 105.67729972191381, 63.60000000000064, 198.49999999999898, 352.3000000000001, 670.4657532097299, 221.09999999999962, 629.0999999999996, 154.49999999999994, 256.9999999999994, 79.69999999999962, 423.000000000001, 323.74648362401234, 321.5000000000007, 329.36978953802776, 114.05682186513761, 65.40000000000056, 505.7365625446176, 129.2827968280098, 67.30000000000048, 670.4, 277.9999999999992, 291.75355525037304, 522.3, 608.3010619640653, 107.59999999999776, 596.5999999999999, 303.3924651254909, 361.88191575745566, 659.0999999999997, 270.8999999999987, 121.45074684130286, 510.57008704771323, 122.85126795394909, 571.9318860065107, 559.6353745792964, 108.00003119897707, 302.07392108222916, 247.4999999999993, 71.30000000000021, 481.90951227473926, 489.8400500106608, 253.01411288372555, 660.0, 522.8999999999994, 438.3303508817331, 374.4578809205934, 538.0406665379096, 200.49999999999875, 334.7475285834867, 297.4477650030325, 221.89999999999947, 249.40000000000006, 198.08712801520244, 201.9028439330807, 279.2811508032777, 129.2999999999964, 422.90000000000026, 231.05119283126314, 212.08894582895084, 42.80000000000034, 419.400000000002, 190.7133390692015, 256.58004854601654, 206.66075850822185, 180.3514675305671, 241.1811606511069, 169.73913222789707, 736.2007203177695, 444.5527879505099, 171.34917641266662, 528.9999999999997, 141.99999999999943, 477.09999999999945, 339.1903572412453, 503.74115559848485, 148.0221481097201, 459.9781310807839, 357.0000000000002, 457.8000000000002, 74.20000000000005, 172.98525860460566], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [61.214644984156436, 9.731502500465899, 125.08735692812344, -70.61764791948775, -359.44473114452876, -90.41735263040046, 344.9859562925368, -207.00166412683598, 27.153898748503124, 206.73432372834432, -291.68556273332206, -127.16768449543281, -181.7418281411219, 295.1456082653041, 179.27971810034433, -172.30657667290544, -62.73608616131373, -43.5923167389877, -6.12397680961007, 40.0000000000003, 126.35804996745358, -16.451004416941213, 174.76638057430276, 141.58990226650653, -151.0803453527665, 75.0092566176061, 293.7884928854844, -98.6787160452382, -146.08424078765182, 250.09438681607867, 214.71094155909972, 325.3109994183159, 305.92638234323067, 282.64884921322357, -37.451571777250734, 113.12324094697021, 72.18847733527721, 306.4, -16.995319437314592, -146.9979262421549, -226.0092898303175, -3.457610657704323, 92.21325366904411, -16.407833461053997, 286.41980717170986, -278.46588591139624, 298.890892915558, 273.993164387872, -65.64240675168766, 85.13802047925101, 327.0249248929636, 169.982926618297, -150.67429004253253, 52.18061525315246, 132.19494739734043, -107.024059833389, -130.97540666716122, -143.89284111669446, 395.39812476934185, -758.6585363618319, -186.81663920847404, -8.163237585832512, 108.81981236909809, -3.6813319629675316, -64.49713907669849, 27.951592460839663, -319.5205835999528, -40.04460267249184, -205.60227842247784, -28.455214419978688, 223.96495654996568, 82.53603114734284, -188.37547724398033, -374.2335805551724, -26.02851519330637, -167.17748388133202, 307.0308544748754, 224.0352042114469, -314.86364508444206, 172.22438696943794, -229.65944365151347, 110.16785192377645, 154.21336504227446, 141.8362415184777, 176.210990988467, 359.2803960284418, 38.66922523697843, 65.20000000000026, 300.46011903659183, 117.01241024637199, -269.4365288253797, 150.6621114084103, 152.88152010046525, -162.57465910513324, 373.1244720704615, 208.52936765249945, -182.65799150133213, 13.410193929284532, -379.64596658755823, -172.43544257926874, 176.101704516153, 176.74328061761727, -322.8436087421259, -720.4894772232338, 247.7236899655024, 196.57807904239291, 215.93817452112108, 33.02760521068543, -391.7883166093885, -24.82171398185354, -88.31031822991562, -359.980290578632, 15.560412252291057, 124.92062043693758, 1.2905787169666054, -57.60153609110647, -26.580689797320545, 244.6745416415708, 18.37427625913751, 222.78399511159145, -83.89427172069635, -66.26943583963137, 82.87169810412195, 364.0095963114548, 394.32050087599856, -32.87614273232302, 106.47756025710967, -70.35220922302227, 13.62643583516342, -55.56818982142299, 219.27378477358272, -43.850475462987696, 15.487354990899146, -244.2390861051677, -409.65733170506445, 5.890431249136977, 20.975457323458585, -99.28716634005158, -570.507498935162, 2.579257326784008, 67.3573303255069, -48.34657759345873, -67.39815027658582, -393.7638080850911, -204.45985932592498, -156.37791014014618, 24.029907860919806, 89.11977908836727, -31.632124365771688, 84.81428328726112, 143.24482113232295, 104.23273283174996, -144.09286564788707, -237.75121529788905, -148.35878287730966, -85.91269398348457, -407.7601844409984, -275.8452208713854, -62.493665516959915, 373.38849697078194, -1.1281041293728964, 23.42792829164796, -11.639212214654904, -108.45532574556333, -175.0578949082198, -602.6792855691608, -75.82440168396103, -232.79180783841878, 86.2572411341429, -506.1461191263618, -78.09224207905555, -36.51993144183948, 277.42917606285914, 291.26383588136724, 196.31849932747937, 189.03178725494604, -257.0980509155165, -515.1621249452353, 227.17697012819804, 229.1422309168554, -88.75144710702902, -316.2114541933408, 248.45841354397098, -5.968071176865834, 153.79450517304633, -132.78319039213343, 165.63107228813112, 48.78538298034627, -412.2885145996719, -116.37231203144117, -92.13984553003213, 207.76234063873528, 298.02667761036565, -352.86891556462797, 175.6258949686735, 149.819705390926, -94.27819128189459, 32.69938068933513, -188.86334254549385, -268.0806496801812], "policy_predator_policy_reward": [7.48637412593246, 114.26747838944519, 21.0126430718765, 212.41764791948722, 336.68689146078236, 257.16967469481847, 0.9528870870811664, 239.55854289818868, 138.7698710795997, 64.77829569059766, 244.94575896189616, 327.31659478454617, 220.1817266907309, 20.01449318508697, 101.19618293032259, 305.9822976099472, 190.58481178859418, 17.392269890450866, 230.7239768096096, 0.0, 247.211678964181, 157.88407990780874, 16.233619425697366, 74.71009773349365, 187.080345352766, 179.29074338239357, 242.63330379578125, 107.5716245183428, 222.46533743401005, 67.87423297896892, 106.3890584409003, 19.18900058168418, 7.773617656768911, 24.851150786776262, 73.65157177725125, 135.1767590530293, 122.81152266472283, 0.0, 231.09299802403564, 38.57754737734721, 252.6092898303161, 40.457610657704485, 31.519248473314622, 91.1753313186957, 41.580192828290166, 302.76588591139597, 84.51697263197974, 13.064723274320055, 108.24240675168575, 93.36197952074849, 41.975075107036375, 90.11707338170315, 181.77429004253102, 71.21938474684747, 89.80505260265919, 142.0240598333892, 178.67540666716008, 175.89284111669278, 2.6018752306581194, 783.6585363618342, 114.95902213546077, 403.76733828285836, 175.2801876309016, 41.081331962967845, 332.9943569262601, 32.92097922762657, 338.5804921631364, 135.0415159744452, 236.2022784224761, 63.25521441997917, 2.758820967932773, 196.476753879377, 250.26531291269495, 441.6265417144673, 61.32851519330687, 199.17748388133208, 66.96914552512459, 72.36479578855297, 336.26364508444453, 84.3756130305621, 228.99110723508903, 182.2540397430192, 104.18663495772498, 122.06375848152194, 69.547728433925, 3.261946513231429, 3.730774763021854, 0.0, 25.97737151015313, 153.15009920688297, 67.37813104162926, 354.7887515008322, 325.76534332235474, 45.8097114397696, 29.077900686865714, 48.36825959017337, 212.25799150133045, 227.88980607071548, 542.4390857271544, 131.09307028097987, 132.3238067252953, 25.40129518864795, 673.0493656817617, 493.1349882375474, 83.46753979735674, 44.16257720125898, 20.768242892220385, 289.9013519552689, 412.5907750978729, 112.01928669235305, 264.29924631196064, 486.065283578816, 22.839587747708954, 84.17937956306244, 36.70942128303364, 90.9015360911054, 175.64976087246959, 88.1658995580193, 161.54310745661883, 87.13867118331342, 303.25762808901123, 99.92019235504287, 195.12830189587794, 17.990403688545197, 2.6794991240014334, 158.77614273232288, 87.27851402563361, 314.92648582201303, 240.4503627568255, 175.94927215002676, 255.16213325500277, 107.45522397231186, 274.3196313028929, 154.9320998113754, 466.68633628422674, 271.8280927551873, 282.15895763593164, 93.60051638369279, 582.2074989351645, 207.62074267321603, 32.142669674493234, 198.24657759345797, 564.5433945995038, 94.70569177737467, 385.39458530651916, 177.3460280926323, 21.49074240701647, 144.6407214469759, 66.83212436577219, 9.28571671273771, 72.0075580190766, 103.41488801685033, 56.20187143399512, 556.693402343045, 380.8867931495047, 65.47362954024008, 426.5601844409974, 299.8452208713855, 96.69366551696005, 11.81150302921808, 5.211905980485061, 163.2016089264419, 259.49809979939965, 117.17648670683566, 318.6071120005597, 665.7908269850432, 12.63462893237487, 476.33304812057173, 415.86876173800965, 245.20127690531643, 214.99224207905462, 69.35906366973727, 90.90382219248754, 76.6038861810555, 35.24162032874874, 23.960881039335653, 280.31370393583757, 663.2956483375804, 58.87709615534794, 13.803702799598609, 103.74488222516067, 443.2180190752114, 74.941586456029, 159.66807117686568, 103.26729663065399, 214.91174582967977, 86.31849197407305, 203.0062083559338, 553.1720785414558, 123.51089619937594, 263.35364805618445, 81.00198791589598, 35.67332238963438, 376.1689155646287, 40.57410503132649, 91.78029460907386, 125.8781912818928, 9.900619310665093, 556.1667272678665, 73.76252356241389]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.385119638732483, "mean_inference_ms": 6.505220068513397, "mean_action_processing_ms": 2.5406245754228167, "mean_env_wait_ms": 15.579826848925888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013222694396972656, "StateBufferConnector_ms": 0.020653605461120605, "ViewRequirementAgentConnector_ms": 0.20699357986450195}, "num_episodes": 0, "episode_return_max": 736.2007203177695, "episode_return_min": 42.80000000000034, "episode_return_mean": 327.0742581755636, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224448, "num_agent_steps_trained": 224448, "num_env_steps_sampled": 56112, "num_env_steps_trained": 56112, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 152.40943912079976, "num_env_steps_trained_throughput_per_sec": 152.40943912079976, "timesteps_total": 56112, "num_env_steps_sampled_lifetime": 56112, "num_agent_steps_sampled_lifetime": 224448, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 224448, "timers": {"training_iteration_time_ms": 26641.787, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26640.611, "sample_time_ms": 2719.429, "learn_time_ms": 23896.124, "learn_throughput": 167.726, "synch_weights_time_ms": 20.515}, "counters": {"num_env_steps_sampled": 56112, "num_env_steps_trained": 56112, "num_agent_steps_sampled": 224448, "num_agent_steps_trained": 224448}, "done": false, "training_iteration": 14, "trial_id": "7f713_00000", "date": "2024-08-23_09-53-00", "timestamp": 1724386980, "time_this_iter_s": 26.369275093078613, "time_total_s": 379.8645398616791, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737538b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 379.8645398616791, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 37.984210526315785, "ram_util_percent": 82.68947368421054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.355521666562115, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.300728761077558, "policy_loss": -0.01183068920271816, "vf_loss": 7.310255887773302, "vf_explained_var": 0.3760463114138003, "kl": 0.011517800448866434, "entropy": 1.3849322074304813, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 13703.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.3048549951068935, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.252138898233888, "policy_loss": -0.018933993757322982, "vf_loss": 5.267697351950186, "vf_explained_var": 0.26717152393684185, "kl": 0.016877833844985438, "entropy": 1.296313416137897, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 13703.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 60120, "num_env_steps_trained": 60120, "num_agent_steps_sampled": 240480, "num_agent_steps_trained": 240480}, "env_runners": {"episode_reward_max": 736.2007203177695, "episode_reward_min": 42.80000000000034, "episode_reward_mean": 327.0742581755636, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -758.6585363618319, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.39812476934185, "predator_policy": 783.6585363618342}, "policy_reward_mean": {"prey_policy": -8.274950730787086, "predator_policy": 171.81207981856898}, "custom_metrics": {}, "hist_stats": {"episode_reward": [192.69999999999973, 287.9000000000004, 143.99448238067174, 378.49572215097396, 437.43638924704425, 153.40910651768354, 353.59999999999945, 414.1516219677084, 101.6486787787439, 264.59999999999934, 515.0028044225024, 407.29999999999984, 290.29999999999967, 545.3147051543704, 394.34971644140677, 665.6000000000005, 621.1999999999999, 284.4999999999995, 501.4000000000009, 105.67729972191381, 63.60000000000064, 198.49999999999898, 352.3000000000001, 670.4657532097299, 221.09999999999962, 629.0999999999996, 154.49999999999994, 256.9999999999994, 79.69999999999962, 423.000000000001, 323.74648362401234, 321.5000000000007, 329.36978953802776, 114.05682186513761, 65.40000000000056, 505.7365625446176, 129.2827968280098, 67.30000000000048, 670.4, 277.9999999999992, 291.75355525037304, 522.3, 608.3010619640653, 107.59999999999776, 596.5999999999999, 303.3924651254909, 361.88191575745566, 659.0999999999997, 270.8999999999987, 121.45074684130286, 510.57008704771323, 122.85126795394909, 571.9318860065107, 559.6353745792964, 108.00003119897707, 302.07392108222916, 247.4999999999993, 71.30000000000021, 481.90951227473926, 489.8400500106608, 253.01411288372555, 660.0, 522.8999999999994, 438.3303508817331, 374.4578809205934, 538.0406665379096, 200.49999999999875, 334.7475285834867, 297.4477650030325, 221.89999999999947, 249.40000000000006, 198.08712801520244, 201.9028439330807, 279.2811508032777, 129.2999999999964, 422.90000000000026, 231.05119283126314, 212.08894582895084, 42.80000000000034, 419.400000000002, 190.7133390692015, 256.58004854601654, 206.66075850822185, 180.3514675305671, 241.1811606511069, 169.73913222789707, 736.2007203177695, 444.5527879505099, 171.34917641266662, 528.9999999999997, 141.99999999999943, 477.09999999999945, 339.1903572412453, 503.74115559848485, 148.0221481097201, 459.9781310807839, 357.0000000000002, 457.8000000000002, 74.20000000000005, 172.98525860460566], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [61.214644984156436, 9.731502500465899, 125.08735692812344, -70.61764791948775, -359.44473114452876, -90.41735263040046, 344.9859562925368, -207.00166412683598, 27.153898748503124, 206.73432372834432, -291.68556273332206, -127.16768449543281, -181.7418281411219, 295.1456082653041, 179.27971810034433, -172.30657667290544, -62.73608616131373, -43.5923167389877, -6.12397680961007, 40.0000000000003, 126.35804996745358, -16.451004416941213, 174.76638057430276, 141.58990226650653, -151.0803453527665, 75.0092566176061, 293.7884928854844, -98.6787160452382, -146.08424078765182, 250.09438681607867, 214.71094155909972, 325.3109994183159, 305.92638234323067, 282.64884921322357, -37.451571777250734, 113.12324094697021, 72.18847733527721, 306.4, -16.995319437314592, -146.9979262421549, -226.0092898303175, -3.457610657704323, 92.21325366904411, -16.407833461053997, 286.41980717170986, -278.46588591139624, 298.890892915558, 273.993164387872, -65.64240675168766, 85.13802047925101, 327.0249248929636, 169.982926618297, -150.67429004253253, 52.18061525315246, 132.19494739734043, -107.024059833389, -130.97540666716122, -143.89284111669446, 395.39812476934185, -758.6585363618319, -186.81663920847404, -8.163237585832512, 108.81981236909809, -3.6813319629675316, -64.49713907669849, 27.951592460839663, -319.5205835999528, -40.04460267249184, -205.60227842247784, -28.455214419978688, 223.96495654996568, 82.53603114734284, -188.37547724398033, -374.2335805551724, -26.02851519330637, -167.17748388133202, 307.0308544748754, 224.0352042114469, -314.86364508444206, 172.22438696943794, -229.65944365151347, 110.16785192377645, 154.21336504227446, 141.8362415184777, 176.210990988467, 359.2803960284418, 38.66922523697843, 65.20000000000026, 300.46011903659183, 117.01241024637199, -269.4365288253797, 150.6621114084103, 152.88152010046525, -162.57465910513324, 373.1244720704615, 208.52936765249945, -182.65799150133213, 13.410193929284532, -379.64596658755823, -172.43544257926874, 176.101704516153, 176.74328061761727, -322.8436087421259, -720.4894772232338, 247.7236899655024, 196.57807904239291, 215.93817452112108, 33.02760521068543, -391.7883166093885, -24.82171398185354, -88.31031822991562, -359.980290578632, 15.560412252291057, 124.92062043693758, 1.2905787169666054, -57.60153609110647, -26.580689797320545, 244.6745416415708, 18.37427625913751, 222.78399511159145, -83.89427172069635, -66.26943583963137, 82.87169810412195, 364.0095963114548, 394.32050087599856, -32.87614273232302, 106.47756025710967, -70.35220922302227, 13.62643583516342, -55.56818982142299, 219.27378477358272, -43.850475462987696, 15.487354990899146, -244.2390861051677, -409.65733170506445, 5.890431249136977, 20.975457323458585, -99.28716634005158, -570.507498935162, 2.579257326784008, 67.3573303255069, -48.34657759345873, -67.39815027658582, -393.7638080850911, -204.45985932592498, -156.37791014014618, 24.029907860919806, 89.11977908836727, -31.632124365771688, 84.81428328726112, 143.24482113232295, 104.23273283174996, -144.09286564788707, -237.75121529788905, -148.35878287730966, -85.91269398348457, -407.7601844409984, -275.8452208713854, -62.493665516959915, 373.38849697078194, -1.1281041293728964, 23.42792829164796, -11.639212214654904, -108.45532574556333, -175.0578949082198, -602.6792855691608, -75.82440168396103, -232.79180783841878, 86.2572411341429, -506.1461191263618, -78.09224207905555, -36.51993144183948, 277.42917606285914, 291.26383588136724, 196.31849932747937, 189.03178725494604, -257.0980509155165, -515.1621249452353, 227.17697012819804, 229.1422309168554, -88.75144710702902, -316.2114541933408, 248.45841354397098, -5.968071176865834, 153.79450517304633, -132.78319039213343, 165.63107228813112, 48.78538298034627, -412.2885145996719, -116.37231203144117, -92.13984553003213, 207.76234063873528, 298.02667761036565, -352.86891556462797, 175.6258949686735, 149.819705390926, -94.27819128189459, 32.69938068933513, -188.86334254549385, -268.0806496801812], "policy_predator_policy_reward": [7.48637412593246, 114.26747838944519, 21.0126430718765, 212.41764791948722, 336.68689146078236, 257.16967469481847, 0.9528870870811664, 239.55854289818868, 138.7698710795997, 64.77829569059766, 244.94575896189616, 327.31659478454617, 220.1817266907309, 20.01449318508697, 101.19618293032259, 305.9822976099472, 190.58481178859418, 17.392269890450866, 230.7239768096096, 0.0, 247.211678964181, 157.88407990780874, 16.233619425697366, 74.71009773349365, 187.080345352766, 179.29074338239357, 242.63330379578125, 107.5716245183428, 222.46533743401005, 67.87423297896892, 106.3890584409003, 19.18900058168418, 7.773617656768911, 24.851150786776262, 73.65157177725125, 135.1767590530293, 122.81152266472283, 0.0, 231.09299802403564, 38.57754737734721, 252.6092898303161, 40.457610657704485, 31.519248473314622, 91.1753313186957, 41.580192828290166, 302.76588591139597, 84.51697263197974, 13.064723274320055, 108.24240675168575, 93.36197952074849, 41.975075107036375, 90.11707338170315, 181.77429004253102, 71.21938474684747, 89.80505260265919, 142.0240598333892, 178.67540666716008, 175.89284111669278, 2.6018752306581194, 783.6585363618342, 114.95902213546077, 403.76733828285836, 175.2801876309016, 41.081331962967845, 332.9943569262601, 32.92097922762657, 338.5804921631364, 135.0415159744452, 236.2022784224761, 63.25521441997917, 2.758820967932773, 196.476753879377, 250.26531291269495, 441.6265417144673, 61.32851519330687, 199.17748388133208, 66.96914552512459, 72.36479578855297, 336.26364508444453, 84.3756130305621, 228.99110723508903, 182.2540397430192, 104.18663495772498, 122.06375848152194, 69.547728433925, 3.261946513231429, 3.730774763021854, 0.0, 25.97737151015313, 153.15009920688297, 67.37813104162926, 354.7887515008322, 325.76534332235474, 45.8097114397696, 29.077900686865714, 48.36825959017337, 212.25799150133045, 227.88980607071548, 542.4390857271544, 131.09307028097987, 132.3238067252953, 25.40129518864795, 673.0493656817617, 493.1349882375474, 83.46753979735674, 44.16257720125898, 20.768242892220385, 289.9013519552689, 412.5907750978729, 112.01928669235305, 264.29924631196064, 486.065283578816, 22.839587747708954, 84.17937956306244, 36.70942128303364, 90.9015360911054, 175.64976087246959, 88.1658995580193, 161.54310745661883, 87.13867118331342, 303.25762808901123, 99.92019235504287, 195.12830189587794, 17.990403688545197, 2.6794991240014334, 158.77614273232288, 87.27851402563361, 314.92648582201303, 240.4503627568255, 175.94927215002676, 255.16213325500277, 107.45522397231186, 274.3196313028929, 154.9320998113754, 466.68633628422674, 271.8280927551873, 282.15895763593164, 93.60051638369279, 582.2074989351645, 207.62074267321603, 32.142669674493234, 198.24657759345797, 564.5433945995038, 94.70569177737467, 385.39458530651916, 177.3460280926323, 21.49074240701647, 144.6407214469759, 66.83212436577219, 9.28571671273771, 72.0075580190766, 103.41488801685033, 56.20187143399512, 556.693402343045, 380.8867931495047, 65.47362954024008, 426.5601844409974, 299.8452208713855, 96.69366551696005, 11.81150302921808, 5.211905980485061, 163.2016089264419, 259.49809979939965, 117.17648670683566, 318.6071120005597, 665.7908269850432, 12.63462893237487, 476.33304812057173, 415.86876173800965, 245.20127690531643, 214.99224207905462, 69.35906366973727, 90.90382219248754, 76.6038861810555, 35.24162032874874, 23.960881039335653, 280.31370393583757, 663.2956483375804, 58.87709615534794, 13.803702799598609, 103.74488222516067, 443.2180190752114, 74.941586456029, 159.66807117686568, 103.26729663065399, 214.91174582967977, 86.31849197407305, 203.0062083559338, 553.1720785414558, 123.51089619937594, 263.35364805618445, 81.00198791589598, 35.67332238963438, 376.1689155646287, 40.57410503132649, 91.78029460907386, 125.8781912818928, 9.900619310665093, 556.1667272678665, 73.76252356241389]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.385119638732483, "mean_inference_ms": 6.505220068513397, "mean_action_processing_ms": 2.5406245754228167, "mean_env_wait_ms": 15.579826848925888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013222694396972656, "StateBufferConnector_ms": 0.020653605461120605, "ViewRequirementAgentConnector_ms": 0.20699357986450195}, "num_episodes": 0, "episode_return_max": 736.2007203177695, "episode_return_min": 42.80000000000034, "episode_return_mean": 327.0742581755636, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240480, "num_agent_steps_trained": 240480, "num_env_steps_sampled": 60120, "num_env_steps_trained": 60120, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 150.50348208898606, "num_env_steps_trained_throughput_per_sec": 150.50348208898606, "timesteps_total": 60120, "num_env_steps_sampled_lifetime": 60120, "num_agent_steps_sampled_lifetime": 240480, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 240480, "timers": {"training_iteration_time_ms": 26471.654, "restore_workers_time_ms": 0.027, "training_step_time_ms": 26470.437, "sample_time_ms": 2598.118, "learn_time_ms": 23848.605, "learn_throughput": 168.06, "synch_weights_time_ms": 19.186}, "counters": {"num_env_steps_sampled": 60120, "num_env_steps_trained": 60120, "num_agent_steps_sampled": 240480, "num_agent_steps_trained": 240480}, "done": false, "training_iteration": 15, "trial_id": "7f713_00000", "date": "2024-08-23_09-53-27", "timestamp": 1724387007, "time_this_iter_s": 26.68172597885132, "time_total_s": 406.5462658405304, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30f7a0af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 406.5462658405304, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 43.445945945945944, "ram_util_percent": 83.22162162162164}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.339826188011775, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.301831584506565, "policy_loss": -0.01376317372772271, "vf_loss": 7.313266931261335, "vf_explained_var": 0.3876771750904265, "kl": 0.011639169592252642, "entropy": 1.3615684143449895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 14648.0, "diff_num_grad_updates_vs_sampler_policy": 480.72380239521044}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.269024895234082, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.787244615605268, "policy_loss": -0.01820018323478363, "vf_loss": 4.802632859901146, "vf_explained_var": 0.319205952069116, "kl": 0.01405982663017259, "entropy": 1.2657078620617983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 14648.0, "diff_num_grad_updates_vs_sampler_policy": 480.72380239521044}}, "num_env_steps_sampled": 64128, "num_env_steps_trained": 64128, "num_agent_steps_sampled": 256512, "num_agent_steps_trained": 256512}, "env_runners": {"episode_reward_max": 736.2007203177695, "episode_reward_min": 42.80000000000034, "episode_reward_mean": 327.0742581755636, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -758.6585363618319, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.39812476934185, "predator_policy": 783.6585363618342}, "policy_reward_mean": {"prey_policy": -8.274950730787086, "predator_policy": 171.81207981856898}, "custom_metrics": {}, "hist_stats": {"episode_reward": [192.69999999999973, 287.9000000000004, 143.99448238067174, 378.49572215097396, 437.43638924704425, 153.40910651768354, 353.59999999999945, 414.1516219677084, 101.6486787787439, 264.59999999999934, 515.0028044225024, 407.29999999999984, 290.29999999999967, 545.3147051543704, 394.34971644140677, 665.6000000000005, 621.1999999999999, 284.4999999999995, 501.4000000000009, 105.67729972191381, 63.60000000000064, 198.49999999999898, 352.3000000000001, 670.4657532097299, 221.09999999999962, 629.0999999999996, 154.49999999999994, 256.9999999999994, 79.69999999999962, 423.000000000001, 323.74648362401234, 321.5000000000007, 329.36978953802776, 114.05682186513761, 65.40000000000056, 505.7365625446176, 129.2827968280098, 67.30000000000048, 670.4, 277.9999999999992, 291.75355525037304, 522.3, 608.3010619640653, 107.59999999999776, 596.5999999999999, 303.3924651254909, 361.88191575745566, 659.0999999999997, 270.8999999999987, 121.45074684130286, 510.57008704771323, 122.85126795394909, 571.9318860065107, 559.6353745792964, 108.00003119897707, 302.07392108222916, 247.4999999999993, 71.30000000000021, 481.90951227473926, 489.8400500106608, 253.01411288372555, 660.0, 522.8999999999994, 438.3303508817331, 374.4578809205934, 538.0406665379096, 200.49999999999875, 334.7475285834867, 297.4477650030325, 221.89999999999947, 249.40000000000006, 198.08712801520244, 201.9028439330807, 279.2811508032777, 129.2999999999964, 422.90000000000026, 231.05119283126314, 212.08894582895084, 42.80000000000034, 419.400000000002, 190.7133390692015, 256.58004854601654, 206.66075850822185, 180.3514675305671, 241.1811606511069, 169.73913222789707, 736.2007203177695, 444.5527879505099, 171.34917641266662, 528.9999999999997, 141.99999999999943, 477.09999999999945, 339.1903572412453, 503.74115559848485, 148.0221481097201, 459.9781310807839, 357.0000000000002, 457.8000000000002, 74.20000000000005, 172.98525860460566], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [61.214644984156436, 9.731502500465899, 125.08735692812344, -70.61764791948775, -359.44473114452876, -90.41735263040046, 344.9859562925368, -207.00166412683598, 27.153898748503124, 206.73432372834432, -291.68556273332206, -127.16768449543281, -181.7418281411219, 295.1456082653041, 179.27971810034433, -172.30657667290544, -62.73608616131373, -43.5923167389877, -6.12397680961007, 40.0000000000003, 126.35804996745358, -16.451004416941213, 174.76638057430276, 141.58990226650653, -151.0803453527665, 75.0092566176061, 293.7884928854844, -98.6787160452382, -146.08424078765182, 250.09438681607867, 214.71094155909972, 325.3109994183159, 305.92638234323067, 282.64884921322357, -37.451571777250734, 113.12324094697021, 72.18847733527721, 306.4, -16.995319437314592, -146.9979262421549, -226.0092898303175, -3.457610657704323, 92.21325366904411, -16.407833461053997, 286.41980717170986, -278.46588591139624, 298.890892915558, 273.993164387872, -65.64240675168766, 85.13802047925101, 327.0249248929636, 169.982926618297, -150.67429004253253, 52.18061525315246, 132.19494739734043, -107.024059833389, -130.97540666716122, -143.89284111669446, 395.39812476934185, -758.6585363618319, -186.81663920847404, -8.163237585832512, 108.81981236909809, -3.6813319629675316, -64.49713907669849, 27.951592460839663, -319.5205835999528, -40.04460267249184, -205.60227842247784, -28.455214419978688, 223.96495654996568, 82.53603114734284, -188.37547724398033, -374.2335805551724, -26.02851519330637, -167.17748388133202, 307.0308544748754, 224.0352042114469, -314.86364508444206, 172.22438696943794, -229.65944365151347, 110.16785192377645, 154.21336504227446, 141.8362415184777, 176.210990988467, 359.2803960284418, 38.66922523697843, 65.20000000000026, 300.46011903659183, 117.01241024637199, -269.4365288253797, 150.6621114084103, 152.88152010046525, -162.57465910513324, 373.1244720704615, 208.52936765249945, -182.65799150133213, 13.410193929284532, -379.64596658755823, -172.43544257926874, 176.101704516153, 176.74328061761727, -322.8436087421259, -720.4894772232338, 247.7236899655024, 196.57807904239291, 215.93817452112108, 33.02760521068543, -391.7883166093885, -24.82171398185354, -88.31031822991562, -359.980290578632, 15.560412252291057, 124.92062043693758, 1.2905787169666054, -57.60153609110647, -26.580689797320545, 244.6745416415708, 18.37427625913751, 222.78399511159145, -83.89427172069635, -66.26943583963137, 82.87169810412195, 364.0095963114548, 394.32050087599856, -32.87614273232302, 106.47756025710967, -70.35220922302227, 13.62643583516342, -55.56818982142299, 219.27378477358272, -43.850475462987696, 15.487354990899146, -244.2390861051677, -409.65733170506445, 5.890431249136977, 20.975457323458585, -99.28716634005158, -570.507498935162, 2.579257326784008, 67.3573303255069, -48.34657759345873, -67.39815027658582, -393.7638080850911, -204.45985932592498, -156.37791014014618, 24.029907860919806, 89.11977908836727, -31.632124365771688, 84.81428328726112, 143.24482113232295, 104.23273283174996, -144.09286564788707, -237.75121529788905, -148.35878287730966, -85.91269398348457, -407.7601844409984, -275.8452208713854, -62.493665516959915, 373.38849697078194, -1.1281041293728964, 23.42792829164796, -11.639212214654904, -108.45532574556333, -175.0578949082198, -602.6792855691608, -75.82440168396103, -232.79180783841878, 86.2572411341429, -506.1461191263618, -78.09224207905555, -36.51993144183948, 277.42917606285914, 291.26383588136724, 196.31849932747937, 189.03178725494604, -257.0980509155165, -515.1621249452353, 227.17697012819804, 229.1422309168554, -88.75144710702902, -316.2114541933408, 248.45841354397098, -5.968071176865834, 153.79450517304633, -132.78319039213343, 165.63107228813112, 48.78538298034627, -412.2885145996719, -116.37231203144117, -92.13984553003213, 207.76234063873528, 298.02667761036565, -352.86891556462797, 175.6258949686735, 149.819705390926, -94.27819128189459, 32.69938068933513, -188.86334254549385, -268.0806496801812], "policy_predator_policy_reward": [7.48637412593246, 114.26747838944519, 21.0126430718765, 212.41764791948722, 336.68689146078236, 257.16967469481847, 0.9528870870811664, 239.55854289818868, 138.7698710795997, 64.77829569059766, 244.94575896189616, 327.31659478454617, 220.1817266907309, 20.01449318508697, 101.19618293032259, 305.9822976099472, 190.58481178859418, 17.392269890450866, 230.7239768096096, 0.0, 247.211678964181, 157.88407990780874, 16.233619425697366, 74.71009773349365, 187.080345352766, 179.29074338239357, 242.63330379578125, 107.5716245183428, 222.46533743401005, 67.87423297896892, 106.3890584409003, 19.18900058168418, 7.773617656768911, 24.851150786776262, 73.65157177725125, 135.1767590530293, 122.81152266472283, 0.0, 231.09299802403564, 38.57754737734721, 252.6092898303161, 40.457610657704485, 31.519248473314622, 91.1753313186957, 41.580192828290166, 302.76588591139597, 84.51697263197974, 13.064723274320055, 108.24240675168575, 93.36197952074849, 41.975075107036375, 90.11707338170315, 181.77429004253102, 71.21938474684747, 89.80505260265919, 142.0240598333892, 178.67540666716008, 175.89284111669278, 2.6018752306581194, 783.6585363618342, 114.95902213546077, 403.76733828285836, 175.2801876309016, 41.081331962967845, 332.9943569262601, 32.92097922762657, 338.5804921631364, 135.0415159744452, 236.2022784224761, 63.25521441997917, 2.758820967932773, 196.476753879377, 250.26531291269495, 441.6265417144673, 61.32851519330687, 199.17748388133208, 66.96914552512459, 72.36479578855297, 336.26364508444453, 84.3756130305621, 228.99110723508903, 182.2540397430192, 104.18663495772498, 122.06375848152194, 69.547728433925, 3.261946513231429, 3.730774763021854, 0.0, 25.97737151015313, 153.15009920688297, 67.37813104162926, 354.7887515008322, 325.76534332235474, 45.8097114397696, 29.077900686865714, 48.36825959017337, 212.25799150133045, 227.88980607071548, 542.4390857271544, 131.09307028097987, 132.3238067252953, 25.40129518864795, 673.0493656817617, 493.1349882375474, 83.46753979735674, 44.16257720125898, 20.768242892220385, 289.9013519552689, 412.5907750978729, 112.01928669235305, 264.29924631196064, 486.065283578816, 22.839587747708954, 84.17937956306244, 36.70942128303364, 90.9015360911054, 175.64976087246959, 88.1658995580193, 161.54310745661883, 87.13867118331342, 303.25762808901123, 99.92019235504287, 195.12830189587794, 17.990403688545197, 2.6794991240014334, 158.77614273232288, 87.27851402563361, 314.92648582201303, 240.4503627568255, 175.94927215002676, 255.16213325500277, 107.45522397231186, 274.3196313028929, 154.9320998113754, 466.68633628422674, 271.8280927551873, 282.15895763593164, 93.60051638369279, 582.2074989351645, 207.62074267321603, 32.142669674493234, 198.24657759345797, 564.5433945995038, 94.70569177737467, 385.39458530651916, 177.3460280926323, 21.49074240701647, 144.6407214469759, 66.83212436577219, 9.28571671273771, 72.0075580190766, 103.41488801685033, 56.20187143399512, 556.693402343045, 380.8867931495047, 65.47362954024008, 426.5601844409974, 299.8452208713855, 96.69366551696005, 11.81150302921808, 5.211905980485061, 163.2016089264419, 259.49809979939965, 117.17648670683566, 318.6071120005597, 665.7908269850432, 12.63462893237487, 476.33304812057173, 415.86876173800965, 245.20127690531643, 214.99224207905462, 69.35906366973727, 90.90382219248754, 76.6038861810555, 35.24162032874874, 23.960881039335653, 280.31370393583757, 663.2956483375804, 58.87709615534794, 13.803702799598609, 103.74488222516067, 443.2180190752114, 74.941586456029, 159.66807117686568, 103.26729663065399, 214.91174582967977, 86.31849197407305, 203.0062083559338, 553.1720785414558, 123.51089619937594, 263.35364805618445, 81.00198791589598, 35.67332238963438, 376.1689155646287, 40.57410503132649, 91.78029460907386, 125.8781912818928, 9.900619310665093, 556.1667272678665, 73.76252356241389]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.385119638732483, "mean_inference_ms": 6.505220068513397, "mean_action_processing_ms": 2.5406245754228167, "mean_env_wait_ms": 15.579826848925888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013222694396972656, "StateBufferConnector_ms": 0.020653605461120605, "ViewRequirementAgentConnector_ms": 0.20699357986450195}, "num_episodes": 0, "episode_return_max": 736.2007203177695, "episode_return_min": 42.80000000000034, "episode_return_mean": 327.0742581755636, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256512, "num_agent_steps_trained": 256512, "num_env_steps_sampled": 64128, "num_env_steps_trained": 64128, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 152.7440425557201, "num_env_steps_trained_throughput_per_sec": 152.7440425557201, "timesteps_total": 64128, "num_env_steps_sampled_lifetime": 64128, "num_agent_steps_sampled_lifetime": 256512, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 256512, "timers": {"training_iteration_time_ms": 26366.24, "restore_workers_time_ms": 0.027, "training_step_time_ms": 26365.024, "sample_time_ms": 2531.654, "learn_time_ms": 23810.123, "learn_throughput": 168.332, "synch_weights_time_ms": 19.222}, "counters": {"num_env_steps_sampled": 64128, "num_env_steps_trained": 64128, "num_agent_steps_sampled": 256512, "num_agent_steps_trained": 256512}, "done": false, "training_iteration": 16, "trial_id": "7f713_00000", "date": "2024-08-23_09-53-53", "timestamp": 1724387033, "time_this_iter_s": 26.279135942459106, "time_total_s": 432.8254017829895, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17379e700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 432.8254017829895, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 37.78947368421053, "ram_util_percent": 82.94473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.999977255372142, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.311209312822453, "policy_loss": -0.014884150566326247, "vf_loss": 7.32379537360378, "vf_explained_var": 0.41024220431292496, "kl": 0.011490542441113758, "entropy": 1.3787698474510637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 15593.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.231461221705038, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.211735277579575, "policy_loss": -0.013221939633447657, "vf_loss": 5.222054809741873, "vf_explained_var": 0.3321132268855181, "kl": 0.014511932130587638, "entropy": 1.2236809822617385, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 15593.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 68136, "num_env_steps_trained": 68136, "num_agent_steps_sampled": 272544, "num_agent_steps_trained": 272544}, "env_runners": {"episode_reward_max": 736.2007203177695, "episode_reward_min": 42.80000000000034, "episode_reward_mean": 327.0742581755636, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -758.6585363618319, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.39812476934185, "predator_policy": 783.6585363618342}, "policy_reward_mean": {"prey_policy": -8.274950730787086, "predator_policy": 171.81207981856898}, "custom_metrics": {}, "hist_stats": {"episode_reward": [192.69999999999973, 287.9000000000004, 143.99448238067174, 378.49572215097396, 437.43638924704425, 153.40910651768354, 353.59999999999945, 414.1516219677084, 101.6486787787439, 264.59999999999934, 515.0028044225024, 407.29999999999984, 290.29999999999967, 545.3147051543704, 394.34971644140677, 665.6000000000005, 621.1999999999999, 284.4999999999995, 501.4000000000009, 105.67729972191381, 63.60000000000064, 198.49999999999898, 352.3000000000001, 670.4657532097299, 221.09999999999962, 629.0999999999996, 154.49999999999994, 256.9999999999994, 79.69999999999962, 423.000000000001, 323.74648362401234, 321.5000000000007, 329.36978953802776, 114.05682186513761, 65.40000000000056, 505.7365625446176, 129.2827968280098, 67.30000000000048, 670.4, 277.9999999999992, 291.75355525037304, 522.3, 608.3010619640653, 107.59999999999776, 596.5999999999999, 303.3924651254909, 361.88191575745566, 659.0999999999997, 270.8999999999987, 121.45074684130286, 510.57008704771323, 122.85126795394909, 571.9318860065107, 559.6353745792964, 108.00003119897707, 302.07392108222916, 247.4999999999993, 71.30000000000021, 481.90951227473926, 489.8400500106608, 253.01411288372555, 660.0, 522.8999999999994, 438.3303508817331, 374.4578809205934, 538.0406665379096, 200.49999999999875, 334.7475285834867, 297.4477650030325, 221.89999999999947, 249.40000000000006, 198.08712801520244, 201.9028439330807, 279.2811508032777, 129.2999999999964, 422.90000000000026, 231.05119283126314, 212.08894582895084, 42.80000000000034, 419.400000000002, 190.7133390692015, 256.58004854601654, 206.66075850822185, 180.3514675305671, 241.1811606511069, 169.73913222789707, 736.2007203177695, 444.5527879505099, 171.34917641266662, 528.9999999999997, 141.99999999999943, 477.09999999999945, 339.1903572412453, 503.74115559848485, 148.0221481097201, 459.9781310807839, 357.0000000000002, 457.8000000000002, 74.20000000000005, 172.98525860460566], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [61.214644984156436, 9.731502500465899, 125.08735692812344, -70.61764791948775, -359.44473114452876, -90.41735263040046, 344.9859562925368, -207.00166412683598, 27.153898748503124, 206.73432372834432, -291.68556273332206, -127.16768449543281, -181.7418281411219, 295.1456082653041, 179.27971810034433, -172.30657667290544, -62.73608616131373, -43.5923167389877, -6.12397680961007, 40.0000000000003, 126.35804996745358, -16.451004416941213, 174.76638057430276, 141.58990226650653, -151.0803453527665, 75.0092566176061, 293.7884928854844, -98.6787160452382, -146.08424078765182, 250.09438681607867, 214.71094155909972, 325.3109994183159, 305.92638234323067, 282.64884921322357, -37.451571777250734, 113.12324094697021, 72.18847733527721, 306.4, -16.995319437314592, -146.9979262421549, -226.0092898303175, -3.457610657704323, 92.21325366904411, -16.407833461053997, 286.41980717170986, -278.46588591139624, 298.890892915558, 273.993164387872, -65.64240675168766, 85.13802047925101, 327.0249248929636, 169.982926618297, -150.67429004253253, 52.18061525315246, 132.19494739734043, -107.024059833389, -130.97540666716122, -143.89284111669446, 395.39812476934185, -758.6585363618319, -186.81663920847404, -8.163237585832512, 108.81981236909809, -3.6813319629675316, -64.49713907669849, 27.951592460839663, -319.5205835999528, -40.04460267249184, -205.60227842247784, -28.455214419978688, 223.96495654996568, 82.53603114734284, -188.37547724398033, -374.2335805551724, -26.02851519330637, -167.17748388133202, 307.0308544748754, 224.0352042114469, -314.86364508444206, 172.22438696943794, -229.65944365151347, 110.16785192377645, 154.21336504227446, 141.8362415184777, 176.210990988467, 359.2803960284418, 38.66922523697843, 65.20000000000026, 300.46011903659183, 117.01241024637199, -269.4365288253797, 150.6621114084103, 152.88152010046525, -162.57465910513324, 373.1244720704615, 208.52936765249945, -182.65799150133213, 13.410193929284532, -379.64596658755823, -172.43544257926874, 176.101704516153, 176.74328061761727, -322.8436087421259, -720.4894772232338, 247.7236899655024, 196.57807904239291, 215.93817452112108, 33.02760521068543, -391.7883166093885, -24.82171398185354, -88.31031822991562, -359.980290578632, 15.560412252291057, 124.92062043693758, 1.2905787169666054, -57.60153609110647, -26.580689797320545, 244.6745416415708, 18.37427625913751, 222.78399511159145, -83.89427172069635, -66.26943583963137, 82.87169810412195, 364.0095963114548, 394.32050087599856, -32.87614273232302, 106.47756025710967, -70.35220922302227, 13.62643583516342, -55.56818982142299, 219.27378477358272, -43.850475462987696, 15.487354990899146, -244.2390861051677, -409.65733170506445, 5.890431249136977, 20.975457323458585, -99.28716634005158, -570.507498935162, 2.579257326784008, 67.3573303255069, -48.34657759345873, -67.39815027658582, -393.7638080850911, -204.45985932592498, -156.37791014014618, 24.029907860919806, 89.11977908836727, -31.632124365771688, 84.81428328726112, 143.24482113232295, 104.23273283174996, -144.09286564788707, -237.75121529788905, -148.35878287730966, -85.91269398348457, -407.7601844409984, -275.8452208713854, -62.493665516959915, 373.38849697078194, -1.1281041293728964, 23.42792829164796, -11.639212214654904, -108.45532574556333, -175.0578949082198, -602.6792855691608, -75.82440168396103, -232.79180783841878, 86.2572411341429, -506.1461191263618, -78.09224207905555, -36.51993144183948, 277.42917606285914, 291.26383588136724, 196.31849932747937, 189.03178725494604, -257.0980509155165, -515.1621249452353, 227.17697012819804, 229.1422309168554, -88.75144710702902, -316.2114541933408, 248.45841354397098, -5.968071176865834, 153.79450517304633, -132.78319039213343, 165.63107228813112, 48.78538298034627, -412.2885145996719, -116.37231203144117, -92.13984553003213, 207.76234063873528, 298.02667761036565, -352.86891556462797, 175.6258949686735, 149.819705390926, -94.27819128189459, 32.69938068933513, -188.86334254549385, -268.0806496801812], "policy_predator_policy_reward": [7.48637412593246, 114.26747838944519, 21.0126430718765, 212.41764791948722, 336.68689146078236, 257.16967469481847, 0.9528870870811664, 239.55854289818868, 138.7698710795997, 64.77829569059766, 244.94575896189616, 327.31659478454617, 220.1817266907309, 20.01449318508697, 101.19618293032259, 305.9822976099472, 190.58481178859418, 17.392269890450866, 230.7239768096096, 0.0, 247.211678964181, 157.88407990780874, 16.233619425697366, 74.71009773349365, 187.080345352766, 179.29074338239357, 242.63330379578125, 107.5716245183428, 222.46533743401005, 67.87423297896892, 106.3890584409003, 19.18900058168418, 7.773617656768911, 24.851150786776262, 73.65157177725125, 135.1767590530293, 122.81152266472283, 0.0, 231.09299802403564, 38.57754737734721, 252.6092898303161, 40.457610657704485, 31.519248473314622, 91.1753313186957, 41.580192828290166, 302.76588591139597, 84.51697263197974, 13.064723274320055, 108.24240675168575, 93.36197952074849, 41.975075107036375, 90.11707338170315, 181.77429004253102, 71.21938474684747, 89.80505260265919, 142.0240598333892, 178.67540666716008, 175.89284111669278, 2.6018752306581194, 783.6585363618342, 114.95902213546077, 403.76733828285836, 175.2801876309016, 41.081331962967845, 332.9943569262601, 32.92097922762657, 338.5804921631364, 135.0415159744452, 236.2022784224761, 63.25521441997917, 2.758820967932773, 196.476753879377, 250.26531291269495, 441.6265417144673, 61.32851519330687, 199.17748388133208, 66.96914552512459, 72.36479578855297, 336.26364508444453, 84.3756130305621, 228.99110723508903, 182.2540397430192, 104.18663495772498, 122.06375848152194, 69.547728433925, 3.261946513231429, 3.730774763021854, 0.0, 25.97737151015313, 153.15009920688297, 67.37813104162926, 354.7887515008322, 325.76534332235474, 45.8097114397696, 29.077900686865714, 48.36825959017337, 212.25799150133045, 227.88980607071548, 542.4390857271544, 131.09307028097987, 132.3238067252953, 25.40129518864795, 673.0493656817617, 493.1349882375474, 83.46753979735674, 44.16257720125898, 20.768242892220385, 289.9013519552689, 412.5907750978729, 112.01928669235305, 264.29924631196064, 486.065283578816, 22.839587747708954, 84.17937956306244, 36.70942128303364, 90.9015360911054, 175.64976087246959, 88.1658995580193, 161.54310745661883, 87.13867118331342, 303.25762808901123, 99.92019235504287, 195.12830189587794, 17.990403688545197, 2.6794991240014334, 158.77614273232288, 87.27851402563361, 314.92648582201303, 240.4503627568255, 175.94927215002676, 255.16213325500277, 107.45522397231186, 274.3196313028929, 154.9320998113754, 466.68633628422674, 271.8280927551873, 282.15895763593164, 93.60051638369279, 582.2074989351645, 207.62074267321603, 32.142669674493234, 198.24657759345797, 564.5433945995038, 94.70569177737467, 385.39458530651916, 177.3460280926323, 21.49074240701647, 144.6407214469759, 66.83212436577219, 9.28571671273771, 72.0075580190766, 103.41488801685033, 56.20187143399512, 556.693402343045, 380.8867931495047, 65.47362954024008, 426.5601844409974, 299.8452208713855, 96.69366551696005, 11.81150302921808, 5.211905980485061, 163.2016089264419, 259.49809979939965, 117.17648670683566, 318.6071120005597, 665.7908269850432, 12.63462893237487, 476.33304812057173, 415.86876173800965, 245.20127690531643, 214.99224207905462, 69.35906366973727, 90.90382219248754, 76.6038861810555, 35.24162032874874, 23.960881039335653, 280.31370393583757, 663.2956483375804, 58.87709615534794, 13.803702799598609, 103.74488222516067, 443.2180190752114, 74.941586456029, 159.66807117686568, 103.26729663065399, 214.91174582967977, 86.31849197407305, 203.0062083559338, 553.1720785414558, 123.51089619937594, 263.35364805618445, 81.00198791589598, 35.67332238963438, 376.1689155646287, 40.57410503132649, 91.78029460907386, 125.8781912818928, 9.900619310665093, 556.1667272678665, 73.76252356241389]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.385119638732483, "mean_inference_ms": 6.505220068513397, "mean_action_processing_ms": 2.5406245754228167, "mean_env_wait_ms": 15.579826848925888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013222694396972656, "StateBufferConnector_ms": 0.020653605461120605, "ViewRequirementAgentConnector_ms": 0.20699357986450195}, "num_episodes": 0, "episode_return_max": 736.2007203177695, "episode_return_min": 42.80000000000034, "episode_return_mean": 327.0742581755636, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272544, "num_agent_steps_trained": 272544, "num_env_steps_sampled": 68136, "num_env_steps_trained": 68136, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 152.5234112434271, "num_env_steps_trained_throughput_per_sec": 152.5234112434271, "timesteps_total": 68136, "num_env_steps_sampled_lifetime": 68136, "num_agent_steps_sampled_lifetime": 272544, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 272544, "timers": {"training_iteration_time_ms": 26401.155, "restore_workers_time_ms": 0.027, "training_step_time_ms": 26400.758, "sample_time_ms": 2561.854, "learn_time_ms": 23815.684, "learn_throughput": 168.292, "synch_weights_time_ms": 19.271}, "counters": {"num_env_steps_sampled": 68136, "num_env_steps_trained": 68136, "num_agent_steps_sampled": 272544, "num_agent_steps_trained": 272544}, "done": false, "training_iteration": 17, "trial_id": "7f713_00000", "date": "2024-08-23_09-54-19", "timestamp": 1724387059, "time_this_iter_s": 26.307785987854004, "time_total_s": 459.1331877708435, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737b1670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 459.1331877708435, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 38.21891891891891, "ram_util_percent": 83.01621621621621}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.285145224086822, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.236714367134861, "policy_loss": -0.011095843498629552, "vf_loss": 7.24532357473222, "vf_explained_var": 0.4046890374844667, "kl": 0.012433180084363336, "entropy": 1.3587926339850855, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 16538.0, "diff_num_grad_updates_vs_sampler_policy": 498.17140718562956}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.237687727004762, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.958920626413255, "policy_loss": -0.013787896135851505, "vf_loss": 4.970145349906235, "vf_explained_var": 0.356609482172305, "kl": 0.01281582909936785, "entropy": 1.2031815705475983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 16538.0, "diff_num_grad_updates_vs_sampler_policy": 498.17140718562956}}, "num_env_steps_sampled": 72144, "num_env_steps_trained": 72144, "num_agent_steps_sampled": 288576, "num_agent_steps_trained": 288576}, "env_runners": {"episode_reward_max": 736.2007203177695, "episode_reward_min": 42.80000000000034, "episode_reward_mean": 327.0742581755636, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -758.6585363618319, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.39812476934185, "predator_policy": 783.6585363618342}, "policy_reward_mean": {"prey_policy": -8.274950730787086, "predator_policy": 171.81207981856898}, "custom_metrics": {}, "hist_stats": {"episode_reward": [192.69999999999973, 287.9000000000004, 143.99448238067174, 378.49572215097396, 437.43638924704425, 153.40910651768354, 353.59999999999945, 414.1516219677084, 101.6486787787439, 264.59999999999934, 515.0028044225024, 407.29999999999984, 290.29999999999967, 545.3147051543704, 394.34971644140677, 665.6000000000005, 621.1999999999999, 284.4999999999995, 501.4000000000009, 105.67729972191381, 63.60000000000064, 198.49999999999898, 352.3000000000001, 670.4657532097299, 221.09999999999962, 629.0999999999996, 154.49999999999994, 256.9999999999994, 79.69999999999962, 423.000000000001, 323.74648362401234, 321.5000000000007, 329.36978953802776, 114.05682186513761, 65.40000000000056, 505.7365625446176, 129.2827968280098, 67.30000000000048, 670.4, 277.9999999999992, 291.75355525037304, 522.3, 608.3010619640653, 107.59999999999776, 596.5999999999999, 303.3924651254909, 361.88191575745566, 659.0999999999997, 270.8999999999987, 121.45074684130286, 510.57008704771323, 122.85126795394909, 571.9318860065107, 559.6353745792964, 108.00003119897707, 302.07392108222916, 247.4999999999993, 71.30000000000021, 481.90951227473926, 489.8400500106608, 253.01411288372555, 660.0, 522.8999999999994, 438.3303508817331, 374.4578809205934, 538.0406665379096, 200.49999999999875, 334.7475285834867, 297.4477650030325, 221.89999999999947, 249.40000000000006, 198.08712801520244, 201.9028439330807, 279.2811508032777, 129.2999999999964, 422.90000000000026, 231.05119283126314, 212.08894582895084, 42.80000000000034, 419.400000000002, 190.7133390692015, 256.58004854601654, 206.66075850822185, 180.3514675305671, 241.1811606511069, 169.73913222789707, 736.2007203177695, 444.5527879505099, 171.34917641266662, 528.9999999999997, 141.99999999999943, 477.09999999999945, 339.1903572412453, 503.74115559848485, 148.0221481097201, 459.9781310807839, 357.0000000000002, 457.8000000000002, 74.20000000000005, 172.98525860460566], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [61.214644984156436, 9.731502500465899, 125.08735692812344, -70.61764791948775, -359.44473114452876, -90.41735263040046, 344.9859562925368, -207.00166412683598, 27.153898748503124, 206.73432372834432, -291.68556273332206, -127.16768449543281, -181.7418281411219, 295.1456082653041, 179.27971810034433, -172.30657667290544, -62.73608616131373, -43.5923167389877, -6.12397680961007, 40.0000000000003, 126.35804996745358, -16.451004416941213, 174.76638057430276, 141.58990226650653, -151.0803453527665, 75.0092566176061, 293.7884928854844, -98.6787160452382, -146.08424078765182, 250.09438681607867, 214.71094155909972, 325.3109994183159, 305.92638234323067, 282.64884921322357, -37.451571777250734, 113.12324094697021, 72.18847733527721, 306.4, -16.995319437314592, -146.9979262421549, -226.0092898303175, -3.457610657704323, 92.21325366904411, -16.407833461053997, 286.41980717170986, -278.46588591139624, 298.890892915558, 273.993164387872, -65.64240675168766, 85.13802047925101, 327.0249248929636, 169.982926618297, -150.67429004253253, 52.18061525315246, 132.19494739734043, -107.024059833389, -130.97540666716122, -143.89284111669446, 395.39812476934185, -758.6585363618319, -186.81663920847404, -8.163237585832512, 108.81981236909809, -3.6813319629675316, -64.49713907669849, 27.951592460839663, -319.5205835999528, -40.04460267249184, -205.60227842247784, -28.455214419978688, 223.96495654996568, 82.53603114734284, -188.37547724398033, -374.2335805551724, -26.02851519330637, -167.17748388133202, 307.0308544748754, 224.0352042114469, -314.86364508444206, 172.22438696943794, -229.65944365151347, 110.16785192377645, 154.21336504227446, 141.8362415184777, 176.210990988467, 359.2803960284418, 38.66922523697843, 65.20000000000026, 300.46011903659183, 117.01241024637199, -269.4365288253797, 150.6621114084103, 152.88152010046525, -162.57465910513324, 373.1244720704615, 208.52936765249945, -182.65799150133213, 13.410193929284532, -379.64596658755823, -172.43544257926874, 176.101704516153, 176.74328061761727, -322.8436087421259, -720.4894772232338, 247.7236899655024, 196.57807904239291, 215.93817452112108, 33.02760521068543, -391.7883166093885, -24.82171398185354, -88.31031822991562, -359.980290578632, 15.560412252291057, 124.92062043693758, 1.2905787169666054, -57.60153609110647, -26.580689797320545, 244.6745416415708, 18.37427625913751, 222.78399511159145, -83.89427172069635, -66.26943583963137, 82.87169810412195, 364.0095963114548, 394.32050087599856, -32.87614273232302, 106.47756025710967, -70.35220922302227, 13.62643583516342, -55.56818982142299, 219.27378477358272, -43.850475462987696, 15.487354990899146, -244.2390861051677, -409.65733170506445, 5.890431249136977, 20.975457323458585, -99.28716634005158, -570.507498935162, 2.579257326784008, 67.3573303255069, -48.34657759345873, -67.39815027658582, -393.7638080850911, -204.45985932592498, -156.37791014014618, 24.029907860919806, 89.11977908836727, -31.632124365771688, 84.81428328726112, 143.24482113232295, 104.23273283174996, -144.09286564788707, -237.75121529788905, -148.35878287730966, -85.91269398348457, -407.7601844409984, -275.8452208713854, -62.493665516959915, 373.38849697078194, -1.1281041293728964, 23.42792829164796, -11.639212214654904, -108.45532574556333, -175.0578949082198, -602.6792855691608, -75.82440168396103, -232.79180783841878, 86.2572411341429, -506.1461191263618, -78.09224207905555, -36.51993144183948, 277.42917606285914, 291.26383588136724, 196.31849932747937, 189.03178725494604, -257.0980509155165, -515.1621249452353, 227.17697012819804, 229.1422309168554, -88.75144710702902, -316.2114541933408, 248.45841354397098, -5.968071176865834, 153.79450517304633, -132.78319039213343, 165.63107228813112, 48.78538298034627, -412.2885145996719, -116.37231203144117, -92.13984553003213, 207.76234063873528, 298.02667761036565, -352.86891556462797, 175.6258949686735, 149.819705390926, -94.27819128189459, 32.69938068933513, -188.86334254549385, -268.0806496801812], "policy_predator_policy_reward": [7.48637412593246, 114.26747838944519, 21.0126430718765, 212.41764791948722, 336.68689146078236, 257.16967469481847, 0.9528870870811664, 239.55854289818868, 138.7698710795997, 64.77829569059766, 244.94575896189616, 327.31659478454617, 220.1817266907309, 20.01449318508697, 101.19618293032259, 305.9822976099472, 190.58481178859418, 17.392269890450866, 230.7239768096096, 0.0, 247.211678964181, 157.88407990780874, 16.233619425697366, 74.71009773349365, 187.080345352766, 179.29074338239357, 242.63330379578125, 107.5716245183428, 222.46533743401005, 67.87423297896892, 106.3890584409003, 19.18900058168418, 7.773617656768911, 24.851150786776262, 73.65157177725125, 135.1767590530293, 122.81152266472283, 0.0, 231.09299802403564, 38.57754737734721, 252.6092898303161, 40.457610657704485, 31.519248473314622, 91.1753313186957, 41.580192828290166, 302.76588591139597, 84.51697263197974, 13.064723274320055, 108.24240675168575, 93.36197952074849, 41.975075107036375, 90.11707338170315, 181.77429004253102, 71.21938474684747, 89.80505260265919, 142.0240598333892, 178.67540666716008, 175.89284111669278, 2.6018752306581194, 783.6585363618342, 114.95902213546077, 403.76733828285836, 175.2801876309016, 41.081331962967845, 332.9943569262601, 32.92097922762657, 338.5804921631364, 135.0415159744452, 236.2022784224761, 63.25521441997917, 2.758820967932773, 196.476753879377, 250.26531291269495, 441.6265417144673, 61.32851519330687, 199.17748388133208, 66.96914552512459, 72.36479578855297, 336.26364508444453, 84.3756130305621, 228.99110723508903, 182.2540397430192, 104.18663495772498, 122.06375848152194, 69.547728433925, 3.261946513231429, 3.730774763021854, 0.0, 25.97737151015313, 153.15009920688297, 67.37813104162926, 354.7887515008322, 325.76534332235474, 45.8097114397696, 29.077900686865714, 48.36825959017337, 212.25799150133045, 227.88980607071548, 542.4390857271544, 131.09307028097987, 132.3238067252953, 25.40129518864795, 673.0493656817617, 493.1349882375474, 83.46753979735674, 44.16257720125898, 20.768242892220385, 289.9013519552689, 412.5907750978729, 112.01928669235305, 264.29924631196064, 486.065283578816, 22.839587747708954, 84.17937956306244, 36.70942128303364, 90.9015360911054, 175.64976087246959, 88.1658995580193, 161.54310745661883, 87.13867118331342, 303.25762808901123, 99.92019235504287, 195.12830189587794, 17.990403688545197, 2.6794991240014334, 158.77614273232288, 87.27851402563361, 314.92648582201303, 240.4503627568255, 175.94927215002676, 255.16213325500277, 107.45522397231186, 274.3196313028929, 154.9320998113754, 466.68633628422674, 271.8280927551873, 282.15895763593164, 93.60051638369279, 582.2074989351645, 207.62074267321603, 32.142669674493234, 198.24657759345797, 564.5433945995038, 94.70569177737467, 385.39458530651916, 177.3460280926323, 21.49074240701647, 144.6407214469759, 66.83212436577219, 9.28571671273771, 72.0075580190766, 103.41488801685033, 56.20187143399512, 556.693402343045, 380.8867931495047, 65.47362954024008, 426.5601844409974, 299.8452208713855, 96.69366551696005, 11.81150302921808, 5.211905980485061, 163.2016089264419, 259.49809979939965, 117.17648670683566, 318.6071120005597, 665.7908269850432, 12.63462893237487, 476.33304812057173, 415.86876173800965, 245.20127690531643, 214.99224207905462, 69.35906366973727, 90.90382219248754, 76.6038861810555, 35.24162032874874, 23.960881039335653, 280.31370393583757, 663.2956483375804, 58.87709615534794, 13.803702799598609, 103.74488222516067, 443.2180190752114, 74.941586456029, 159.66807117686568, 103.26729663065399, 214.91174582967977, 86.31849197407305, 203.0062083559338, 553.1720785414558, 123.51089619937594, 263.35364805618445, 81.00198791589598, 35.67332238963438, 376.1689155646287, 40.57410503132649, 91.78029460907386, 125.8781912818928, 9.900619310665093, 556.1667272678665, 73.76252356241389]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.385119638732483, "mean_inference_ms": 6.505220068513397, "mean_action_processing_ms": 2.5406245754228167, "mean_env_wait_ms": 15.579826848925888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013222694396972656, "StateBufferConnector_ms": 0.020653605461120605, "ViewRequirementAgentConnector_ms": 0.20699357986450195}, "num_episodes": 0, "episode_return_max": 736.2007203177695, "episode_return_min": 42.80000000000034, "episode_return_mean": 327.0742581755636, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288576, "num_agent_steps_trained": 288576, "num_env_steps_sampled": 72144, "num_env_steps_trained": 72144, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 150.55327253558522, "num_env_steps_trained_throughput_per_sec": 150.55327253558522, "timesteps_total": 72144, "num_env_steps_sampled_lifetime": 72144, "num_agent_steps_sampled_lifetime": 288576, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 288576, "timers": {"training_iteration_time_ms": 26466.901, "restore_workers_time_ms": 0.027, "training_step_time_ms": 26466.497, "sample_time_ms": 2618.445, "learn_time_ms": 23825.542, "learn_throughput": 168.223, "synch_weights_time_ms": 19.26}, "counters": {"num_env_steps_sampled": 72144, "num_env_steps_trained": 72144, "num_agent_steps_sampled": 288576, "num_agent_steps_trained": 288576}, "done": false, "training_iteration": 18, "trial_id": "7f713_00000", "date": "2024-08-23_09-54-46", "timestamp": 1724387086, "time_this_iter_s": 26.666764974594116, "time_total_s": 485.7999527454376, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17374ea60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 485.7999527454376, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 40.03684210526317, "ram_util_percent": 83.02105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.237162171091352, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.090849440942996, "policy_loss": -0.01030432166009353, "vf_loss": 7.098653024340432, "vf_explained_var": 0.47267551169824346, "kl": 0.01250369118270341, "entropy": 1.3432963142950067, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 17483.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.797328600807796, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.593362030654988, "policy_loss": -0.010365428867202903, "vf_loss": 5.601440383769848, "vf_explained_var": 0.35487882870214954, "kl": 0.011435321026614735, "entropy": 1.1369019205608064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 17483.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 76152, "num_env_steps_trained": 76152, "num_agent_steps_sampled": 304608, "num_agent_steps_trained": 304608}, "env_runners": {"episode_reward_max": 736.2007203177695, "episode_reward_min": 42.80000000000034, "episode_reward_mean": 331.77567982861734, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -758.6585363618319, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.39812476934185, "predator_policy": 844.1605566343036}, "policy_reward_mean": {"prey_policy": -14.984778213116623, "predator_policy": 180.87261812742543}, "custom_metrics": {}, "hist_stats": {"episode_reward": [153.40910651768354, 353.59999999999945, 414.1516219677084, 101.6486787787439, 264.59999999999934, 515.0028044225024, 407.29999999999984, 290.29999999999967, 545.3147051543704, 394.34971644140677, 665.6000000000005, 621.1999999999999, 284.4999999999995, 501.4000000000009, 105.67729972191381, 63.60000000000064, 198.49999999999898, 352.3000000000001, 670.4657532097299, 221.09999999999962, 629.0999999999996, 154.49999999999994, 256.9999999999994, 79.69999999999962, 423.000000000001, 323.74648362401234, 321.5000000000007, 329.36978953802776, 114.05682186513761, 65.40000000000056, 505.7365625446176, 129.2827968280098, 67.30000000000048, 670.4, 277.9999999999992, 291.75355525037304, 522.3, 608.3010619640653, 107.59999999999776, 596.5999999999999, 303.3924651254909, 361.88191575745566, 659.0999999999997, 270.8999999999987, 121.45074684130286, 510.57008704771323, 122.85126795394909, 571.9318860065107, 559.6353745792964, 108.00003119897707, 302.07392108222916, 247.4999999999993, 71.30000000000021, 481.90951227473926, 489.8400500106608, 253.01411288372555, 660.0, 522.8999999999994, 438.3303508817331, 374.4578809205934, 538.0406665379096, 200.49999999999875, 334.7475285834867, 297.4477650030325, 221.89999999999947, 249.40000000000006, 198.08712801520244, 201.9028439330807, 279.2811508032777, 129.2999999999964, 422.90000000000026, 231.05119283126314, 212.08894582895084, 42.80000000000034, 419.400000000002, 190.7133390692015, 256.58004854601654, 206.66075850822185, 180.3514675305671, 241.1811606511069, 169.73913222789707, 736.2007203177695, 444.5527879505099, 171.34917641266662, 528.9999999999997, 141.99999999999943, 477.09999999999945, 339.1903572412453, 503.74115559848485, 148.0221481097201, 459.9781310807839, 357.0000000000002, 457.8000000000002, 74.20000000000005, 172.98525860460566, 160.62042081549004, 659.3188679365117, 221.90633672914277, 230.67118884781723, 638.1519447551046], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-291.68556273332206, -127.16768449543281, -181.7418281411219, 295.1456082653041, 179.27971810034433, -172.30657667290544, -62.73608616131373, -43.5923167389877, -6.12397680961007, 40.0000000000003, 126.35804996745358, -16.451004416941213, 174.76638057430276, 141.58990226650653, -151.0803453527665, 75.0092566176061, 293.7884928854844, -98.6787160452382, -146.08424078765182, 250.09438681607867, 214.71094155909972, 325.3109994183159, 305.92638234323067, 282.64884921322357, -37.451571777250734, 113.12324094697021, 72.18847733527721, 306.4, -16.995319437314592, -146.9979262421549, -226.0092898303175, -3.457610657704323, 92.21325366904411, -16.407833461053997, 286.41980717170986, -278.46588591139624, 298.890892915558, 273.993164387872, -65.64240675168766, 85.13802047925101, 327.0249248929636, 169.982926618297, -150.67429004253253, 52.18061525315246, 132.19494739734043, -107.024059833389, -130.97540666716122, -143.89284111669446, 395.39812476934185, -758.6585363618319, -186.81663920847404, -8.163237585832512, 108.81981236909809, -3.6813319629675316, -64.49713907669849, 27.951592460839663, -319.5205835999528, -40.04460267249184, -205.60227842247784, -28.455214419978688, 223.96495654996568, 82.53603114734284, -188.37547724398033, -374.2335805551724, -26.02851519330637, -167.17748388133202, 307.0308544748754, 224.0352042114469, -314.86364508444206, 172.22438696943794, -229.65944365151347, 110.16785192377645, 154.21336504227446, 141.8362415184777, 176.210990988467, 359.2803960284418, 38.66922523697843, 65.20000000000026, 300.46011903659183, 117.01241024637199, -269.4365288253797, 150.6621114084103, 152.88152010046525, -162.57465910513324, 373.1244720704615, 208.52936765249945, -182.65799150133213, 13.410193929284532, -379.64596658755823, -172.43544257926874, 176.101704516153, 176.74328061761727, -322.8436087421259, -720.4894772232338, 247.7236899655024, 196.57807904239291, 215.93817452112108, 33.02760521068543, -391.7883166093885, -24.82171398185354, -88.31031822991562, -359.980290578632, 15.560412252291057, 124.92062043693758, 1.2905787169666054, -57.60153609110647, -26.580689797320545, 244.6745416415708, 18.37427625913751, 222.78399511159145, -83.89427172069635, -66.26943583963137, 82.87169810412195, 364.0095963114548, 394.32050087599856, -32.87614273232302, 106.47756025710967, -70.35220922302227, 13.62643583516342, -55.56818982142299, 219.27378477358272, -43.850475462987696, 15.487354990899146, -244.2390861051677, -409.65733170506445, 5.890431249136977, 20.975457323458585, -99.28716634005158, -570.507498935162, 2.579257326784008, 67.3573303255069, -48.34657759345873, -67.39815027658582, -393.7638080850911, -204.45985932592498, -156.37791014014618, 24.029907860919806, 89.11977908836727, -31.632124365771688, 84.81428328726112, 143.24482113232295, 104.23273283174996, -144.09286564788707, -237.75121529788905, -148.35878287730966, -85.91269398348457, -407.7601844409984, -275.8452208713854, -62.493665516959915, 373.38849697078194, -1.1281041293728964, 23.42792829164796, -11.639212214654904, -108.45532574556333, -175.0578949082198, -602.6792855691608, -75.82440168396103, -232.79180783841878, 86.2572411341429, -506.1461191263618, -78.09224207905555, -36.51993144183948, 277.42917606285914, 291.26383588136724, 196.31849932747937, 189.03178725494604, -257.0980509155165, -515.1621249452353, 227.17697012819804, 229.1422309168554, -88.75144710702902, -316.2114541933408, 248.45841354397098, -5.968071176865834, 153.79450517304633, -132.78319039213343, 165.63107228813112, 48.78538298034627, -412.2885145996719, -116.37231203144117, -92.13984553003213, 207.76234063873528, 298.02667761036565, -352.86891556462797, 175.6258949686735, 149.819705390926, -94.27819128189459, 32.69938068933513, -188.86334254549385, -268.0806496801812, -552.3516938569489, -268.33423523189805, 256.4046835121837, 112.01865808418535, 28.91468721702126, -359.0409250904782, -493.4784948889794, 18.238743251889023, 87.12255404254157, -124.03318614454753], "policy_predator_policy_reward": [244.94575896189616, 327.31659478454617, 220.1817266907309, 20.01449318508697, 101.19618293032259, 305.9822976099472, 190.58481178859418, 17.392269890450866, 230.7239768096096, 0.0, 247.211678964181, 157.88407990780874, 16.233619425697366, 74.71009773349365, 187.080345352766, 179.29074338239357, 242.63330379578125, 107.5716245183428, 222.46533743401005, 67.87423297896892, 106.3890584409003, 19.18900058168418, 7.773617656768911, 24.851150786776262, 73.65157177725125, 135.1767590530293, 122.81152266472283, 0.0, 231.09299802403564, 38.57754737734721, 252.6092898303161, 40.457610657704485, 31.519248473314622, 91.1753313186957, 41.580192828290166, 302.76588591139597, 84.51697263197974, 13.064723274320055, 108.24240675168575, 93.36197952074849, 41.975075107036375, 90.11707338170315, 181.77429004253102, 71.21938474684747, 89.80505260265919, 142.0240598333892, 178.67540666716008, 175.89284111669278, 2.6018752306581194, 783.6585363618342, 114.95902213546077, 403.76733828285836, 175.2801876309016, 41.081331962967845, 332.9943569262601, 32.92097922762657, 338.5804921631364, 135.0415159744452, 236.2022784224761, 63.25521441997917, 2.758820967932773, 196.476753879377, 250.26531291269495, 441.6265417144673, 61.32851519330687, 199.17748388133208, 66.96914552512459, 72.36479578855297, 336.26364508444453, 84.3756130305621, 228.99110723508903, 182.2540397430192, 104.18663495772498, 122.06375848152194, 69.547728433925, 3.261946513231429, 3.730774763021854, 0.0, 25.97737151015313, 153.15009920688297, 67.37813104162926, 354.7887515008322, 325.76534332235474, 45.8097114397696, 29.077900686865714, 48.36825959017337, 212.25799150133045, 227.88980607071548, 542.4390857271544, 131.09307028097987, 132.3238067252953, 25.40129518864795, 673.0493656817617, 493.1349882375474, 83.46753979735674, 44.16257720125898, 20.768242892220385, 289.9013519552689, 412.5907750978729, 112.01928669235305, 264.29924631196064, 486.065283578816, 22.839587747708954, 84.17937956306244, 36.70942128303364, 90.9015360911054, 175.64976087246959, 88.1658995580193, 161.54310745661883, 87.13867118331342, 303.25762808901123, 99.92019235504287, 195.12830189587794, 17.990403688545197, 2.6794991240014334, 158.77614273232288, 87.27851402563361, 314.92648582201303, 240.4503627568255, 175.94927215002676, 255.16213325500277, 107.45522397231186, 274.3196313028929, 154.9320998113754, 466.68633628422674, 271.8280927551873, 282.15895763593164, 93.60051638369279, 582.2074989351645, 207.62074267321603, 32.142669674493234, 198.24657759345797, 564.5433945995038, 94.70569177737467, 385.39458530651916, 177.3460280926323, 21.49074240701647, 144.6407214469759, 66.83212436577219, 9.28571671273771, 72.0075580190766, 103.41488801685033, 56.20187143399512, 556.693402343045, 380.8867931495047, 65.47362954024008, 426.5601844409974, 299.8452208713855, 96.69366551696005, 11.81150302921808, 5.211905980485061, 163.2016089264419, 259.49809979939965, 117.17648670683566, 318.6071120005597, 665.7908269850432, 12.63462893237487, 476.33304812057173, 415.86876173800965, 245.20127690531643, 214.99224207905462, 69.35906366973727, 90.90382219248754, 76.6038861810555, 35.24162032874874, 23.960881039335653, 280.31370393583757, 663.2956483375804, 58.87709615534794, 13.803702799598609, 103.74488222516067, 443.2180190752114, 74.941586456029, 159.66807117686568, 103.26729663065399, 214.91174582967977, 86.31849197407305, 203.0062083559338, 553.1720785414558, 123.51089619937594, 263.35364805618445, 81.00198791589598, 35.67332238963438, 376.1689155646287, 40.57410503132649, 91.78029460907386, 125.8781912818928, 9.900619310665093, 556.1667272678665, 73.76252356241389, 844.1605566343036, 137.145793270035, 148.2714999802627, 142.6240263598799, 518.1208060413994, 33.91176856120184, 347.25892924538556, 358.6520112395229, 297.1550045416419, 377.9075723154688]}, "sampler_perf": {"mean_raw_obs_processing_ms": 10.375320795494028, "mean_inference_ms": 6.488394366463028, "mean_action_processing_ms": 2.460816942816452, "mean_env_wait_ms": 15.572546820743591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013192057609558105, "StateBufferConnector_ms": 0.02067887783050537, "ViewRequirementAgentConnector_ms": 0.20377671718597412}, "num_episodes": 5, "episode_return_max": 736.2007203177695, "episode_return_min": 42.80000000000034, "episode_return_mean": 331.77567982861734, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304608, "num_agent_steps_trained": 304608, "num_env_steps_sampled": 76152, "num_env_steps_trained": 76152, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 143.0301702232865, "num_env_steps_trained_throughput_per_sec": 143.0301702232865, "timesteps_total": 76152, "num_env_steps_sampled_lifetime": 76152, "num_agent_steps_sampled_lifetime": 304608, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 304608, "timers": {"training_iteration_time_ms": 26650.889, "restore_workers_time_ms": 0.02, "training_step_time_ms": 26650.532, "sample_time_ms": 2810.097, "learn_time_ms": 23817.842, "learn_throughput": 168.277, "synch_weights_time_ms": 19.309}, "counters": {"num_env_steps_sampled": 76152, "num_env_steps_trained": 76152, "num_agent_steps_sampled": 304608, "num_agent_steps_trained": 304608}, "done": false, "training_iteration": 19, "trial_id": "7f713_00000", "date": "2024-08-23_09-55-14", "timestamp": 1724387114, "time_this_iter_s": 28.06714391708374, "time_total_s": 513.8670966625214, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737539d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 513.8670966625214, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 41.6875, "ram_util_percent": 83.1975}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.05208958065699, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.28837721486571, "policy_loss": -0.012628748138785046, "vf_loss": 7.298696227300734, "vf_explained_var": 0.42577603323749763, "kl": 0.011548823668133645, "entropy": 1.2936265413092558, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 18428.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.643019214004436, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.993161386661429, "policy_loss": -0.01532765498484002, "vf_loss": 6.0056838484668225, "vf_explained_var": 0.378705054868466, "kl": 0.014025823020735982, "entropy": 1.0508180985375055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 18428.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 80160, "num_env_steps_trained": 80160, "num_agent_steps_sampled": 320640, "num_agent_steps_trained": 320640}, "env_runners": {"episode_reward_max": 736.2007203177695, "episode_reward_min": 42.80000000000034, "episode_reward_mean": 322.05792183568997, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1134.906062009939, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.39812476934185, "predator_policy": 1150.8187242137233}, "policy_reward_mean": {"prey_policy": -98.46253484880988, "predator_policy": 259.49149576665496}, "custom_metrics": {}, "hist_stats": {"episode_reward": [79.69999999999962, 423.000000000001, 323.74648362401234, 321.5000000000007, 329.36978953802776, 114.05682186513761, 65.40000000000056, 505.7365625446176, 129.2827968280098, 67.30000000000048, 670.4, 277.9999999999992, 291.75355525037304, 522.3, 608.3010619640653, 107.59999999999776, 596.5999999999999, 303.3924651254909, 361.88191575745566, 659.0999999999997, 270.8999999999987, 121.45074684130286, 510.57008704771323, 122.85126795394909, 571.9318860065107, 559.6353745792964, 108.00003119897707, 302.07392108222916, 247.4999999999993, 71.30000000000021, 481.90951227473926, 489.8400500106608, 253.01411288372555, 660.0, 522.8999999999994, 438.3303508817331, 374.4578809205934, 538.0406665379096, 200.49999999999875, 334.7475285834867, 297.4477650030325, 221.89999999999947, 249.40000000000006, 198.08712801520244, 201.9028439330807, 279.2811508032777, 129.2999999999964, 422.90000000000026, 231.05119283126314, 212.08894582895084, 42.80000000000034, 419.400000000002, 190.7133390692015, 256.58004854601654, 206.66075850822185, 180.3514675305671, 241.1811606511069, 169.73913222789707, 736.2007203177695, 444.5527879505099, 171.34917641266662, 528.9999999999997, 141.99999999999943, 477.09999999999945, 339.1903572412453, 503.74115559848485, 148.0221481097201, 459.9781310807839, 357.0000000000002, 457.8000000000002, 74.20000000000005, 172.98525860460566, 160.62042081549004, 659.3188679365117, 221.90633672914277, 230.67118884781723, 638.1519447551046, 274.0516774636687, 647.2870451678109, 399.0644277531893, 227.67859935054113, 216.95169171486634, 166.14960583569706, 530.3872056670588, 93.25000883782951, 360.2027287705395, 270.60000000000184, 293.4775368156875, 313.6504434637064, 92.38118653981144, 285.12676692195095, 668.7833082297502, 229.0043714436179, 359.28971980977076, 208.89999999999822, 356.79346642132487, 349.5043199772353, 185.7232432948898, 234.58081409429056, 430.0057193480827], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-130.97540666716122, -143.89284111669446, 395.39812476934185, -758.6585363618319, -186.81663920847404, -8.163237585832512, 108.81981236909809, -3.6813319629675316, -64.49713907669849, 27.951592460839663, -319.5205835999528, -40.04460267249184, -205.60227842247784, -28.455214419978688, 223.96495654996568, 82.53603114734284, -188.37547724398033, -374.2335805551724, -26.02851519330637, -167.17748388133202, 307.0308544748754, 224.0352042114469, -314.86364508444206, 172.22438696943794, -229.65944365151347, 110.16785192377645, 154.21336504227446, 141.8362415184777, 176.210990988467, 359.2803960284418, 38.66922523697843, 65.20000000000026, 300.46011903659183, 117.01241024637199, -269.4365288253797, 150.6621114084103, 152.88152010046525, -162.57465910513324, 373.1244720704615, 208.52936765249945, -182.65799150133213, 13.410193929284532, -379.64596658755823, -172.43544257926874, 176.101704516153, 176.74328061761727, -322.8436087421259, -720.4894772232338, 247.7236899655024, 196.57807904239291, 215.93817452112108, 33.02760521068543, -391.7883166093885, -24.82171398185354, -88.31031822991562, -359.980290578632, 15.560412252291057, 124.92062043693758, 1.2905787169666054, -57.60153609110647, -26.580689797320545, 244.6745416415708, 18.37427625913751, 222.78399511159145, -83.89427172069635, -66.26943583963137, 82.87169810412195, 364.0095963114548, 394.32050087599856, -32.87614273232302, 106.47756025710967, -70.35220922302227, 13.62643583516342, -55.56818982142299, 219.27378477358272, -43.850475462987696, 15.487354990899146, -244.2390861051677, -409.65733170506445, 5.890431249136977, 20.975457323458585, -99.28716634005158, -570.507498935162, 2.579257326784008, 67.3573303255069, -48.34657759345873, -67.39815027658582, -393.7638080850911, -204.45985932592498, -156.37791014014618, 24.029907860919806, 89.11977908836727, -31.632124365771688, 84.81428328726112, 143.24482113232295, 104.23273283174996, -144.09286564788707, -237.75121529788905, -148.35878287730966, -85.91269398348457, -407.7601844409984, -275.8452208713854, -62.493665516959915, 373.38849697078194, -1.1281041293728964, 23.42792829164796, -11.639212214654904, -108.45532574556333, -175.0578949082198, -602.6792855691608, -75.82440168396103, -232.79180783841878, 86.2572411341429, -506.1461191263618, -78.09224207905555, -36.51993144183948, 277.42917606285914, 291.26383588136724, 196.31849932747937, 189.03178725494604, -257.0980509155165, -515.1621249452353, 227.17697012819804, 229.1422309168554, -88.75144710702902, -316.2114541933408, 248.45841354397098, -5.968071176865834, 153.79450517304633, -132.78319039213343, 165.63107228813112, 48.78538298034627, -412.2885145996719, -116.37231203144117, -92.13984553003213, 207.76234063873528, 298.02667761036565, -352.86891556462797, 175.6258949686735, 149.819705390926, -94.27819128189459, 32.69938068933513, -188.86334254549385, -268.0806496801812, -552.3516938569489, -268.33423523189805, 256.4046835121837, 112.01865808418535, 28.91468721702126, -359.0409250904782, -493.4784948889794, 18.238743251889023, 87.12255404254157, -124.03318614454753, -230.37068881741348, -646.60849277567, 322.2258740802783, 80.54302735961991, 244.72328648184543, -578.0990919054888, -583.6454691849461, -214.59996055378468, -142.01525866847487, -828.3763975903887, -244.18032657209466, -563.427683130207, 139.69878754518834, -204.6273328062902, -1134.906062009939, -780.225044025636, -166.7645838112108, 25.749756106188876, -133.76705890123336, 28.02546838777758, -299.30339886328215, -546.7581881903168, -219.53085333611244, -247.39982803793976, -887.7978530743577, -1016.5436843305299, -331.63386711290036, -431.22081803292645, 250.26988290189286, 301.05218643555554, -652.3321399917786, -932.7496034723418, -123.98425375128767, -383.4782187481201, -250.2761599104728, 122.94366786350504, -38.973813971874826, -575.9324638134804, -576.1003951790785, -72.3039662618586, -695.1693090452412, 32.4702634907824, -110.88619227564014, -602.8708555677028, -129.45962943458102, -99.32987784239054], "policy_predator_policy_reward": [178.67540666716008, 175.89284111669278, 2.6018752306581194, 783.6585363618342, 114.95902213546077, 403.76733828285836, 175.2801876309016, 41.081331962967845, 332.9943569262601, 32.92097922762657, 338.5804921631364, 135.0415159744452, 236.2022784224761, 63.25521441997917, 2.758820967932773, 196.476753879377, 250.26531291269495, 441.6265417144673, 61.32851519330687, 199.17748388133208, 66.96914552512459, 72.36479578855297, 336.26364508444453, 84.3756130305621, 228.99110723508903, 182.2540397430192, 104.18663495772498, 122.06375848152194, 69.547728433925, 3.261946513231429, 3.730774763021854, 0.0, 25.97737151015313, 153.15009920688297, 67.37813104162926, 354.7887515008322, 325.76534332235474, 45.8097114397696, 29.077900686865714, 48.36825959017337, 212.25799150133045, 227.88980607071548, 542.4390857271544, 131.09307028097987, 132.3238067252953, 25.40129518864795, 673.0493656817617, 493.1349882375474, 83.46753979735674, 44.16257720125898, 20.768242892220385, 289.9013519552689, 412.5907750978729, 112.01928669235305, 264.29924631196064, 486.065283578816, 22.839587747708954, 84.17937956306244, 36.70942128303364, 90.9015360911054, 175.64976087246959, 88.1658995580193, 161.54310745661883, 87.13867118331342, 303.25762808901123, 99.92019235504287, 195.12830189587794, 17.990403688545197, 2.6794991240014334, 158.77614273232288, 87.27851402563361, 314.92648582201303, 240.4503627568255, 175.94927215002676, 255.16213325500277, 107.45522397231186, 274.3196313028929, 154.9320998113754, 466.68633628422674, 271.8280927551873, 282.15895763593164, 93.60051638369279, 582.2074989351645, 207.62074267321603, 32.142669674493234, 198.24657759345797, 564.5433945995038, 94.70569177737467, 385.39458530651916, 177.3460280926323, 21.49074240701647, 144.6407214469759, 66.83212436577219, 9.28571671273771, 72.0075580190766, 103.41488801685033, 56.20187143399512, 556.693402343045, 380.8867931495047, 65.47362954024008, 426.5601844409974, 299.8452208713855, 96.69366551696005, 11.81150302921808, 5.211905980485061, 163.2016089264419, 259.49809979939965, 117.17648670683566, 318.6071120005597, 665.7908269850432, 12.63462893237487, 476.33304812057173, 415.86876173800965, 245.20127690531643, 214.99224207905462, 69.35906366973727, 90.90382219248754, 76.6038861810555, 35.24162032874874, 23.960881039335653, 280.31370393583757, 663.2956483375804, 58.87709615534794, 13.803702799598609, 103.74488222516067, 443.2180190752114, 74.941586456029, 159.66807117686568, 103.26729663065399, 214.91174582967977, 86.31849197407305, 203.0062083559338, 553.1720785414558, 123.51089619937594, 263.35364805618445, 81.00198791589598, 35.67332238963438, 376.1689155646287, 40.57410503132649, 91.78029460907386, 125.8781912818928, 9.900619310665093, 556.1667272678665, 73.76252356241389, 844.1605566343036, 137.145793270035, 148.2714999802627, 142.6240263598799, 518.1208060413994, 33.91176856120184, 347.25892924538556, 358.6520112395229, 297.1550045416419, 377.9075723154688, 404.3391227989633, 746.6917362577885, 213.62093313990408, 30.897210588008548, 18.569244759055273, 713.8709884177767, 608.8596453603081, 417.06438372896315, 302.64075593650796, 884.7025920372221, 67.16988602029342, 906.5877295177052, 197.81086311615516, 397.5048878120054, 857.5623906596809, 1150.8187242137233, 140.18747851929925, 361.03007795626166, 24.228538302530914, 352.11305221092493, 403.1097305403002, 736.429393328986, 586.5124713993491, 194.06865343840676, 1064.2323616144004, 932.4903623302974, 847.0799566503208, 200.90149541745657, 0.0, 117.46123889230186, 990.505871927333, 823.5802429804057, 807.2783152705186, 59.473877038659396, 321.77615991047566, 14.45633213649489, 571.5295184698679, 400.17022573681214, 197.70356761624996, 800.2051138019231, 50.69651951473691, 797.7257693346135, 565.7773344801346, 382.56052745750026, 189.87929198272772, 468.91593464232614]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.80659611699315, "mean_inference_ms": 6.409304507554013, "mean_action_processing_ms": 2.5524040998194653, "mean_env_wait_ms": 15.474357272438366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00547635555267334, "StateBufferConnector_ms": 0.007912039756774902, "ViewRequirementAgentConnector_ms": 0.2163238525390625}, "num_episodes": 23, "episode_return_max": 736.2007203177695, "episode_return_min": 42.80000000000034, "episode_return_mean": 322.05792183568997, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320640, "num_agent_steps_trained": 320640, "num_env_steps_sampled": 80160, "num_env_steps_trained": 80160, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 150.8564325016694, "num_env_steps_trained_throughput_per_sec": 150.8564325016694, "timesteps_total": 80160, "num_env_steps_sampled_lifetime": 80160, "num_agent_steps_sampled_lifetime": 320640, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 320640, "timers": {"training_iteration_time_ms": 26583.096, "restore_workers_time_ms": 0.021, "training_step_time_ms": 26582.724, "sample_time_ms": 2766.605, "learn_time_ms": 23794.24, "learn_throughput": 168.444, "synch_weights_time_ms": 19.083}, "counters": {"num_env_steps_sampled": 80160, "num_env_steps_trained": 80160, "num_agent_steps_sampled": 320640, "num_agent_steps_trained": 320640}, "done": false, "training_iteration": 20, "trial_id": "7f713_00000", "date": "2024-08-23_09-55-41", "timestamp": 1724387141, "time_this_iter_s": 26.624545097351074, "time_total_s": 540.4916417598724, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737b19d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 540.4916417598724, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 37.83783783783784, "ram_util_percent": 83.05945945945946}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.31617122907487, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.400111610674984, "policy_loss": -0.01443201468705579, "vf_loss": 7.411975021463222, "vf_explained_var": 0.4830980692590986, "kl": 0.012843037647485891, "entropy": 1.2542484337690647, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 19373.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.8406778334309815, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.12640730085827, "policy_loss": -0.011944776636957333, "vf_loss": 6.135958441981563, "vf_explained_var": 0.3824984699960739, "kl": 0.011968258851104313, "entropy": 1.012338439181999, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 19373.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 84168, "num_env_steps_trained": 84168, "num_agent_steps_sampled": 336672, "num_agent_steps_trained": 336672}, "env_runners": {"episode_reward_max": 736.2007203177695, "episode_reward_min": 42.80000000000034, "episode_reward_mean": 309.6780288429232, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1134.906062009939, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 394.32050087599856, "predator_policy": 1150.8187242137233}, "policy_reward_mean": {"prey_policy": -159.45520061816148, "predator_policy": 314.29421503962317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [270.8999999999987, 121.45074684130286, 510.57008704771323, 122.85126795394909, 571.9318860065107, 559.6353745792964, 108.00003119897707, 302.07392108222916, 247.4999999999993, 71.30000000000021, 481.90951227473926, 489.8400500106608, 253.01411288372555, 660.0, 522.8999999999994, 438.3303508817331, 374.4578809205934, 538.0406665379096, 200.49999999999875, 334.7475285834867, 297.4477650030325, 221.89999999999947, 249.40000000000006, 198.08712801520244, 201.9028439330807, 279.2811508032777, 129.2999999999964, 422.90000000000026, 231.05119283126314, 212.08894582895084, 42.80000000000034, 419.400000000002, 190.7133390692015, 256.58004854601654, 206.66075850822185, 180.3514675305671, 241.1811606511069, 169.73913222789707, 736.2007203177695, 444.5527879505099, 171.34917641266662, 528.9999999999997, 141.99999999999943, 477.09999999999945, 339.1903572412453, 503.74115559848485, 148.0221481097201, 459.9781310807839, 357.0000000000002, 457.8000000000002, 74.20000000000005, 172.98525860460566, 160.62042081549004, 659.3188679365117, 221.90633672914277, 230.67118884781723, 638.1519447551046, 274.0516774636687, 647.2870451678109, 399.0644277531893, 227.67859935054113, 216.95169171486634, 166.14960583569706, 530.3872056670588, 93.25000883782951, 360.2027287705395, 270.60000000000184, 293.4775368156875, 313.6504434637064, 92.38118653981144, 285.12676692195095, 668.7833082297502, 229.0043714436179, 359.28971980977076, 208.89999999999822, 356.79346642132487, 349.5043199772353, 185.7232432948898, 234.58081409429056, 430.0057193480827, 308.74362819929024, 317.49375499122397, 114.10000000000014, 285.5812851942449, 223.40577115613752, 388.17984926308674, 241.75433963109643, 262.05602118840807, 265.805933096582, 366.8057837254455, 127.4332081018022, 295.41748261869327, 252.66821521963985, 309.18651279702055, 443.90000000000236, 276.54586927032574, 354.4210108159406, 160.41824479951907, 222.54889165177767, 303.96635150026674], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-182.65799150133213, 13.410193929284532, -379.64596658755823, -172.43544257926874, 176.101704516153, 176.74328061761727, -322.8436087421259, -720.4894772232338, 247.7236899655024, 196.57807904239291, 215.93817452112108, 33.02760521068543, -391.7883166093885, -24.82171398185354, -88.31031822991562, -359.980290578632, 15.560412252291057, 124.92062043693758, 1.2905787169666054, -57.60153609110647, -26.580689797320545, 244.6745416415708, 18.37427625913751, 222.78399511159145, -83.89427172069635, -66.26943583963137, 82.87169810412195, 364.0095963114548, 394.32050087599856, -32.87614273232302, 106.47756025710967, -70.35220922302227, 13.62643583516342, -55.56818982142299, 219.27378477358272, -43.850475462987696, 15.487354990899146, -244.2390861051677, -409.65733170506445, 5.890431249136977, 20.975457323458585, -99.28716634005158, -570.507498935162, 2.579257326784008, 67.3573303255069, -48.34657759345873, -67.39815027658582, -393.7638080850911, -204.45985932592498, -156.37791014014618, 24.029907860919806, 89.11977908836727, -31.632124365771688, 84.81428328726112, 143.24482113232295, 104.23273283174996, -144.09286564788707, -237.75121529788905, -148.35878287730966, -85.91269398348457, -407.7601844409984, -275.8452208713854, -62.493665516959915, 373.38849697078194, -1.1281041293728964, 23.42792829164796, -11.639212214654904, -108.45532574556333, -175.0578949082198, -602.6792855691608, -75.82440168396103, -232.79180783841878, 86.2572411341429, -506.1461191263618, -78.09224207905555, -36.51993144183948, 277.42917606285914, 291.26383588136724, 196.31849932747937, 189.03178725494604, -257.0980509155165, -515.1621249452353, 227.17697012819804, 229.1422309168554, -88.75144710702902, -316.2114541933408, 248.45841354397098, -5.968071176865834, 153.79450517304633, -132.78319039213343, 165.63107228813112, 48.78538298034627, -412.2885145996719, -116.37231203144117, -92.13984553003213, 207.76234063873528, 298.02667761036565, -352.86891556462797, 175.6258949686735, 149.819705390926, -94.27819128189459, 32.69938068933513, -188.86334254549385, -268.0806496801812, -552.3516938569489, -268.33423523189805, 256.4046835121837, 112.01865808418535, 28.91468721702126, -359.0409250904782, -493.4784948889794, 18.238743251889023, 87.12255404254157, -124.03318614454753, -230.37068881741348, -646.60849277567, 322.2258740802783, 80.54302735961991, 244.72328648184543, -578.0990919054888, -583.6454691849461, -214.59996055378468, -142.01525866847487, -828.3763975903887, -244.18032657209466, -563.427683130207, 139.69878754518834, -204.6273328062902, -1134.906062009939, -780.225044025636, -166.7645838112108, 25.749756106188876, -133.76705890123336, 28.02546838777758, -299.30339886328215, -546.7581881903168, -219.53085333611244, -247.39982803793976, -887.7978530743577, -1016.5436843305299, -331.63386711290036, -431.22081803292645, 250.26988290189286, 301.05218643555554, -652.3321399917786, -932.7496034723418, -123.98425375128767, -383.4782187481201, -250.2761599104728, 122.94366786350504, -38.973813971874826, -575.9324638134804, -576.1003951790785, -72.3039662618586, -695.1693090452412, 32.4702634907824, -110.88619227564014, -602.8708555677028, -129.45962943458102, -99.32987784239054, -735.3608360424288, 5.116255256499876, -226.02151603472294, -499.57502869491617, -538.2555722428593, 19.397575023169217, -751.2260395350033, -466.92135765683685, -230.64026186572266, -342.7830347132893, 110.37886973922255, -424.52746756163236, -400.74385622195615, -335.8320736417272, 0.5607629935585452, -523.743831375594, -548.2556391318509, -288.16927179721347, -820.363176145111, 344.7930961090693, -402.3213279132123, -272.80274747405326, -246.70251238881065, -539.6198282603177, 29.05902443855439, -491.0521545043065, -131.39019481293585, -269.27251321351133, 382.2438854647713, 47.16314126990436, -883.1465967724434, 240.74255559719154, -558.2947696950021, -90.67415086647465, -0.9643575056370063, -1025.4363792665533, -558.4745188411896, -219.5118389202687, -287.0346996563557, -1.31887743957817], "policy_predator_policy_reward": [212.25799150133045, 227.88980607071548, 542.4390857271544, 131.09307028097987, 132.3238067252953, 25.40129518864795, 673.0493656817617, 493.1349882375474, 83.46753979735674, 44.16257720125898, 20.768242892220385, 289.9013519552689, 412.5907750978729, 112.01928669235305, 264.29924631196064, 486.065283578816, 22.839587747708954, 84.17937956306244, 36.70942128303364, 90.9015360911054, 175.64976087246959, 88.1658995580193, 161.54310745661883, 87.13867118331342, 303.25762808901123, 99.92019235504287, 195.12830189587794, 17.990403688545197, 2.6794991240014334, 158.77614273232288, 87.27851402563361, 314.92648582201303, 240.4503627568255, 175.94927215002676, 255.16213325500277, 107.45522397231186, 274.3196313028929, 154.9320998113754, 466.68633628422674, 271.8280927551873, 282.15895763593164, 93.60051638369279, 582.2074989351645, 207.62074267321603, 32.142669674493234, 198.24657759345797, 564.5433945995038, 94.70569177737467, 385.39458530651916, 177.3460280926323, 21.49074240701647, 144.6407214469759, 66.83212436577219, 9.28571671273771, 72.0075580190766, 103.41488801685033, 56.20187143399512, 556.693402343045, 380.8867931495047, 65.47362954024008, 426.5601844409974, 299.8452208713855, 96.69366551696005, 11.81150302921808, 5.211905980485061, 163.2016089264419, 259.49809979939965, 117.17648670683566, 318.6071120005597, 665.7908269850432, 12.63462893237487, 476.33304812057173, 415.86876173800965, 245.20127690531643, 214.99224207905462, 69.35906366973727, 90.90382219248754, 76.6038861810555, 35.24162032874874, 23.960881039335653, 280.31370393583757, 663.2956483375804, 58.87709615534794, 13.803702799598609, 103.74488222516067, 443.2180190752114, 74.941586456029, 159.66807117686568, 103.26729663065399, 214.91174582967977, 86.31849197407305, 203.0062083559338, 553.1720785414558, 123.51089619937594, 263.35364805618445, 81.00198791589598, 35.67332238963438, 376.1689155646287, 40.57410503132649, 91.78029460907386, 125.8781912818928, 9.900619310665093, 556.1667272678665, 73.76252356241389, 844.1605566343036, 137.145793270035, 148.2714999802627, 142.6240263598799, 518.1208060413994, 33.91176856120184, 347.25892924538556, 358.6520112395229, 297.1550045416419, 377.9075723154688, 404.3391227989633, 746.6917362577885, 213.62093313990408, 30.897210588008548, 18.569244759055273, 713.8709884177767, 608.8596453603081, 417.06438372896315, 302.64075593650796, 884.7025920372221, 67.16988602029342, 906.5877295177052, 197.81086311615516, 397.5048878120054, 857.5623906596809, 1150.8187242137233, 140.18747851929925, 361.03007795626166, 24.228538302530914, 352.11305221092493, 403.1097305403002, 736.429393328986, 586.5124713993491, 194.06865343840676, 1064.2323616144004, 932.4903623302974, 847.0799566503208, 200.90149541745657, 0.0, 117.46123889230186, 990.505871927333, 823.5802429804057, 807.2783152705186, 59.473877038659396, 321.77615991047566, 14.45633213649489, 571.5295184698679, 400.17022573681214, 197.70356761624996, 800.2051138019231, 50.69651951473691, 797.7257693346135, 565.7773344801346, 382.56052745750026, 189.87929198272772, 468.91593464232614, 778.0655522063146, 260.9226567789045, 722.4677166878545, 320.62258303300956, 613.6555722428594, 19.302424976830796, 711.1894494005518, 792.5392329855341, 88.47220936964929, 708.3568583655007, 46.048890498392296, 656.2795565871047, 843.8419299781441, 134.48833951663485, 729.0762786160601, 56.16281095438585, 1018.5569391344316, 83.67390489121532, 842.375863761488, 0.0, 484.75099993275074, 317.80628355631706, 113.28372167260744, 968.456101595214, 603.7640328730419, 110.89731241235133, 7.316855970954057, 702.5323648525139, 5.601096291708557, 8.891876973616, 915.1658567302533, 3.7840537153253377, 488.88114339172, 514.5087879856974, 365.0114876277068, 821.8074939440035, 842.520569689653, 158.014679723583, 572.9699736865462, 19.34995490965471]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.792569215912485, "mean_inference_ms": 6.3850630919896005, "mean_action_processing_ms": 2.3426323256467327, "mean_env_wait_ms": 15.633794616773343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005932450294494629, "StateBufferConnector_ms": 0.0099257230758667, "ViewRequirementAgentConnector_ms": 0.25828564167022705}, "num_episodes": 20, "episode_return_max": 736.2007203177695, "episode_return_min": 42.80000000000034, "episode_return_mean": 309.6780288429232, "episodes_this_iter": 20}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336672, "num_agent_steps_trained": 336672, "num_env_steps_sampled": 84168, "num_env_steps_trained": 84168, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 150.02399633169318, "num_env_steps_trained_throughput_per_sec": 150.02399633169318, "timesteps_total": 84168, "num_env_steps_sampled_lifetime": 84168, "num_agent_steps_sampled_lifetime": 336672, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 336672, "timers": {"training_iteration_time_ms": 26615.45, "restore_workers_time_ms": 0.021, "training_step_time_ms": 26615.03, "sample_time_ms": 2839.095, "learn_time_ms": 23754.398, "learn_throughput": 168.727, "synch_weights_time_ms": 18.801}, "counters": {"num_env_steps_sampled": 84168, "num_env_steps_trained": 84168, "num_agent_steps_sampled": 336672, "num_agent_steps_trained": 336672}, "done": false, "training_iteration": 21, "trial_id": "7f713_00000", "date": "2024-08-23_09-56-07", "timestamp": 1724387167, "time_this_iter_s": 26.759732246398926, "time_total_s": 567.2513740062714, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737c11f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 567.2513740062714, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 38.41052631578947, "ram_util_percent": 83.13421052631581}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.17799629105462, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.834463410150438, "policy_loss": -0.01718298011316509, "vf_loss": 7.848576107226982, "vf_explained_var": 0.39682457327211973, "kl": 0.015351389494364855, "entropy": 1.2034492252995728, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 20318.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.010598911557878, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.9267380421754545, "policy_loss": -0.01356424191897666, "vf_loss": 6.938052328806075, "vf_explained_var": 0.3738323358000902, "kl": 0.011249943715199906, "entropy": 0.8982279243292632, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 20318.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 88176, "num_env_steps_trained": 88176, "num_agent_steps_sampled": 352704, "num_agent_steps_trained": 352704}, "env_runners": {"episode_reward_max": 736.2007203177695, "episode_reward_min": 42.80000000000034, "episode_reward_mean": 293.68500007087687, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1253.8492873253065, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 382.2438854647713, "predator_policy": 1258.9492873253068}, "policy_reward_mean": {"prey_policy": -239.42509216238344, "predator_policy": 386.26759219782195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [198.08712801520244, 201.9028439330807, 279.2811508032777, 129.2999999999964, 422.90000000000026, 231.05119283126314, 212.08894582895084, 42.80000000000034, 419.400000000002, 190.7133390692015, 256.58004854601654, 206.66075850822185, 180.3514675305671, 241.1811606511069, 169.73913222789707, 736.2007203177695, 444.5527879505099, 171.34917641266662, 528.9999999999997, 141.99999999999943, 477.09999999999945, 339.1903572412453, 503.74115559848485, 148.0221481097201, 459.9781310807839, 357.0000000000002, 457.8000000000002, 74.20000000000005, 172.98525860460566, 160.62042081549004, 659.3188679365117, 221.90633672914277, 230.67118884781723, 638.1519447551046, 274.0516774636687, 647.2870451678109, 399.0644277531893, 227.67859935054113, 216.95169171486634, 166.14960583569706, 530.3872056670588, 93.25000883782951, 360.2027287705395, 270.60000000000184, 293.4775368156875, 313.6504434637064, 92.38118653981144, 285.12676692195095, 668.7833082297502, 229.0043714436179, 359.28971980977076, 208.89999999999822, 356.79346642132487, 349.5043199772353, 185.7232432948898, 234.58081409429056, 430.0057193480827, 308.74362819929024, 317.49375499122397, 114.10000000000014, 285.5812851942449, 223.40577115613752, 388.17984926308674, 241.75433963109643, 262.05602118840807, 265.805933096582, 366.8057837254455, 127.4332081018022, 295.41748261869327, 252.66821521963985, 309.18651279702055, 443.90000000000236, 276.54586927032574, 354.4210108159406, 160.41824479951907, 222.54889165177767, 303.96635150026674, 191.54372710740702, 118.83261397489645, 667.9009550385617, 226.21821329378227, 579.9024671491954, 328.06308966975496, 101.81440254917186, 372.9459021728395, 307.91238586369053, 201.26689905023235, 127.5580181952474, 163.58797160118667, 56.784577035701005, 367.81892955743535, 150.51725108794852, 229.31197163661247, 419.50355558919716, 306.1907800014097, 290.7757418526289, 173.43987778103914, 190.43680892858404, 568.0336728015583, 209.03849266314398], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-67.39815027658582, -393.7638080850911, -204.45985932592498, -156.37791014014618, 24.029907860919806, 89.11977908836727, -31.632124365771688, 84.81428328726112, 143.24482113232295, 104.23273283174996, -144.09286564788707, -237.75121529788905, -148.35878287730966, -85.91269398348457, -407.7601844409984, -275.8452208713854, -62.493665516959915, 373.38849697078194, -1.1281041293728964, 23.42792829164796, -11.639212214654904, -108.45532574556333, -175.0578949082198, -602.6792855691608, -75.82440168396103, -232.79180783841878, 86.2572411341429, -506.1461191263618, -78.09224207905555, -36.51993144183948, 277.42917606285914, 291.26383588136724, 196.31849932747937, 189.03178725494604, -257.0980509155165, -515.1621249452353, 227.17697012819804, 229.1422309168554, -88.75144710702902, -316.2114541933408, 248.45841354397098, -5.968071176865834, 153.79450517304633, -132.78319039213343, 165.63107228813112, 48.78538298034627, -412.2885145996719, -116.37231203144117, -92.13984553003213, 207.76234063873528, 298.02667761036565, -352.86891556462797, 175.6258949686735, 149.819705390926, -94.27819128189459, 32.69938068933513, -188.86334254549385, -268.0806496801812, -552.3516938569489, -268.33423523189805, 256.4046835121837, 112.01865808418535, 28.91468721702126, -359.0409250904782, -493.4784948889794, 18.238743251889023, 87.12255404254157, -124.03318614454753, -230.37068881741348, -646.60849277567, 322.2258740802783, 80.54302735961991, 244.72328648184543, -578.0990919054888, -583.6454691849461, -214.59996055378468, -142.01525866847487, -828.3763975903887, -244.18032657209466, -563.427683130207, 139.69878754518834, -204.6273328062902, -1134.906062009939, -780.225044025636, -166.7645838112108, 25.749756106188876, -133.76705890123336, 28.02546838777758, -299.30339886328215, -546.7581881903168, -219.53085333611244, -247.39982803793976, -887.7978530743577, -1016.5436843305299, -331.63386711290036, -431.22081803292645, 250.26988290189286, 301.05218643555554, -652.3321399917786, -932.7496034723418, -123.98425375128767, -383.4782187481201, -250.2761599104728, 122.94366786350504, -38.973813971874826, -575.9324638134804, -576.1003951790785, -72.3039662618586, -695.1693090452412, 32.4702634907824, -110.88619227564014, -602.8708555677028, -129.45962943458102, -99.32987784239054, -735.3608360424288, 5.116255256499876, -226.02151603472294, -499.57502869491617, -538.2555722428593, 19.397575023169217, -751.2260395350033, -466.92135765683685, -230.64026186572266, -342.7830347132893, 110.37886973922255, -424.52746756163236, -400.74385622195615, -335.8320736417272, 0.5607629935585452, -523.743831375594, -548.2556391318509, -288.16927179721347, -820.363176145111, 344.7930961090693, -402.3213279132123, -272.80274747405326, -246.70251238881065, -539.6198282603177, 29.05902443855439, -491.0521545043065, -131.39019481293585, -269.27251321351133, 382.2438854647713, 47.16314126990436, -883.1465967724434, 240.74255559719154, -558.2947696950021, -90.67415086647465, -0.9643575056370063, -1025.4363792665533, -558.4745188411896, -219.5118389202687, -287.0346996563557, -1.31887743957817, -260.5440598750406, -895.9164551016788, -786.820054370004, -677.8880182502794, 224.7981416143054, 234.3089986882769, -210.22219540382451, -723.4392102701397, 69.37546253452919, 275.7098793361405, -146.17445528769315, -537.0143017175972, -963.4409041925637, -565.892290124409, -252.42924053964452, -421.3049007075414, -201.25671348202636, -366.93062837392796, -194.08884530235036, 48.191211834663704, -371.4637676360478, -666.3697868260084, -25.89866443180263, -809.7130961534187, -1008.2743495270397, -1253.8492873253065, 76.27429525811394, -607.9380763811248, -490.91723632079703, -219.58774438678284, -827.7922618162081, -176.5918250894054, -148.8728891711479, 185.29273706496457, 218.03366053518087, -1069.571508096973, -423.4912884233411, -1.0330137225058351, -525.8078693595045, -407.80099468100804, -735.5846136572503, -654.7268459327829, -250.30872197089113, 358.4526981940348, -441.2834715652103, -836.1829862375849], "policy_predator_policy_reward": [564.5433945995038, 94.70569177737467, 385.39458530651916, 177.3460280926323, 21.49074240701647, 144.6407214469759, 66.83212436577219, 9.28571671273771, 72.0075580190766, 103.41488801685033, 56.20187143399512, 556.693402343045, 380.8867931495047, 65.47362954024008, 426.5601844409974, 299.8452208713855, 96.69366551696005, 11.81150302921808, 5.211905980485061, 163.2016089264419, 259.49809979939965, 117.17648670683566, 318.6071120005597, 665.7908269850432, 12.63462893237487, 476.33304812057173, 415.86876173800965, 245.20127690531643, 214.99224207905462, 69.35906366973727, 90.90382219248754, 76.6038861810555, 35.24162032874874, 23.960881039335653, 280.31370393583757, 663.2956483375804, 58.87709615534794, 13.803702799598609, 103.74488222516067, 443.2180190752114, 74.941586456029, 159.66807117686568, 103.26729663065399, 214.91174582967977, 86.31849197407305, 203.0062083559338, 553.1720785414558, 123.51089619937594, 263.35364805618445, 81.00198791589598, 35.67332238963438, 376.1689155646287, 40.57410503132649, 91.78029460907386, 125.8781912818928, 9.900619310665093, 556.1667272678665, 73.76252356241389, 844.1605566343036, 137.145793270035, 148.2714999802627, 142.6240263598799, 518.1208060413994, 33.91176856120184, 347.25892924538556, 358.6520112395229, 297.1550045416419, 377.9075723154688, 404.3391227989633, 746.6917362577885, 213.62093313990408, 30.897210588008548, 18.569244759055273, 713.8709884177767, 608.8596453603081, 417.06438372896315, 302.64075593650796, 884.7025920372221, 67.16988602029342, 906.5877295177052, 197.81086311615516, 397.5048878120054, 857.5623906596809, 1150.8187242137233, 140.18747851929925, 361.03007795626166, 24.228538302530914, 352.11305221092493, 403.1097305403002, 736.429393328986, 586.5124713993491, 194.06865343840676, 1064.2323616144004, 932.4903623302974, 847.0799566503208, 200.90149541745657, 0.0, 117.46123889230186, 990.505871927333, 823.5802429804057, 807.2783152705186, 59.473877038659396, 321.77615991047566, 14.45633213649489, 571.5295184698679, 400.17022573681214, 197.70356761624996, 800.2051138019231, 50.69651951473691, 797.7257693346135, 565.7773344801346, 382.56052745750026, 189.87929198272772, 468.91593464232614, 778.0655522063146, 260.9226567789045, 722.4677166878545, 320.62258303300956, 613.6555722428594, 19.302424976830796, 711.1894494005518, 792.5392329855341, 88.47220936964929, 708.3568583655007, 46.048890498392296, 656.2795565871047, 843.8419299781441, 134.48833951663485, 729.0762786160601, 56.16281095438585, 1018.5569391344316, 83.67390489121532, 842.375863761488, 0.0, 484.75099993275074, 317.80628355631706, 113.28372167260744, 968.456101595214, 603.7640328730419, 110.89731241235133, 7.316855970954057, 702.5323648525139, 5.601096291708557, 8.891876973616, 915.1658567302533, 3.7840537153253377, 488.88114339172, 514.5087879856974, 365.0114876277068, 821.8074939440035, 842.520569689653, 158.014679723583, 572.9699736865462, 19.34995490965471, 403.5581606748639, 944.4460814092635, 809.6706942548269, 773.8699923403536, 110.20185838569462, 98.5919563502848, 326.81086450660507, 833.0687544611426, 42.619790640279355, 192.1973346382464, 571.6697930778544, 439.5820535971901, 1041.9629319470284, 589.1846649191149, 172.24493273047295, 874.4351106895516, 813.7127464004624, 62.386981319182745, 223.5888453023487, 123.57568721556773, 428.61591644258016, 736.7756562147244, 686.4558942613535, 312.74383792505483, 1059.9589265627405, 1258.9492873253068, 880.1213141879607, 19.361396492486424, 558.4476774206996, 302.574554374833, 254.46831162847417, 979.2277469137528, 255.51673213716055, 127.56697555821557, 66.08318962039358, 1091.6454379428078, 705.4559595622103, 9.84408443626538, 840.0405513613354, 267.0081904602188, 852.4718145969987, 728.2764539216187, 459.16617816911327, 0.7235184092995441, 1001.6078222701616, 484.8971281957761]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.286414488675163, "mean_inference_ms": 6.389149865363736, "mean_action_processing_ms": 2.4766563376754176, "mean_env_wait_ms": 15.62807857192977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007760763168334961, "StateBufferConnector_ms": 0.00969541072845459, "ViewRequirementAgentConnector_ms": 0.3537464141845703}, "num_episodes": 23, "episode_return_max": 736.2007203177695, "episode_return_min": 42.80000000000034, "episode_return_mean": 293.68500007087687, "episodes_this_iter": 23}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352704, "num_agent_steps_trained": 352704, "num_env_steps_sampled": 88176, "num_env_steps_trained": 88176, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 141.77079967573167, "num_env_steps_trained_throughput_per_sec": 141.77079967573167, "timesteps_total": 88176, "num_env_steps_sampled_lifetime": 88176, "num_agent_steps_sampled_lifetime": 352704, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 352704, "timers": {"training_iteration_time_ms": 26762.51, "restore_workers_time_ms": 0.032, "training_step_time_ms": 26762.072, "sample_time_ms": 3006.933, "learn_time_ms": 23733.197, "learn_throughput": 168.877, "synch_weights_time_ms": 19.115}, "counters": {"num_env_steps_sampled": 88176, "num_env_steps_trained": 88176, "num_agent_steps_sampled": 352704, "num_agent_steps_trained": 352704}, "done": false, "training_iteration": 22, "trial_id": "7f713_00000", "date": "2024-08-23_09-56-36", "timestamp": 1724387196, "time_this_iter_s": 28.316901206970215, "time_total_s": 595.5682752132416, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737a68b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 595.5682752132416, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 40.53414634146341, "ram_util_percent": 82.5658536585366}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.840300236177193, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.8011224136150705, "policy_loss": -0.012293945237619694, "vf_loss": 7.811143428055698, "vf_explained_var": 0.4349161260342472, "kl": 0.01136443048479065, "entropy": 1.206856094340168, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 21263.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.170153167891124, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.165605894219938, "policy_loss": -0.011683157184432266, "vf_loss": 7.175171267797077, "vf_explained_var": 0.36832034001274716, "kl": 0.010588813092677838, "entropy": 0.869251343182155, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 21263.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 92184, "num_env_steps_trained": 92184, "num_agent_steps_sampled": 368736, "num_agent_steps_trained": 368736}, "env_runners": {"episode_reward_max": 668.7833082297502, "episode_reward_min": 36.08295480144898, "episode_reward_mean": 288.6035236531887, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1253.8492873253065, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 382.2438854647713, "predator_policy": 1258.9492873253068}, "policy_reward_mean": {"prey_policy": -338.3660447116602, "predator_policy": 482.66780653825475}, "custom_metrics": {}, "hist_stats": {"episode_reward": [459.9781310807839, 357.0000000000002, 457.8000000000002, 74.20000000000005, 172.98525860460566, 160.62042081549004, 659.3188679365117, 221.90633672914277, 230.67118884781723, 638.1519447551046, 274.0516774636687, 647.2870451678109, 399.0644277531893, 227.67859935054113, 216.95169171486634, 166.14960583569706, 530.3872056670588, 93.25000883782951, 360.2027287705395, 270.60000000000184, 293.4775368156875, 313.6504434637064, 92.38118653981144, 285.12676692195095, 668.7833082297502, 229.0043714436179, 359.28971980977076, 208.89999999999822, 356.79346642132487, 349.5043199772353, 185.7232432948898, 234.58081409429056, 430.0057193480827, 308.74362819929024, 317.49375499122397, 114.10000000000014, 285.5812851942449, 223.40577115613752, 388.17984926308674, 241.75433963109643, 262.05602118840807, 265.805933096582, 366.8057837254455, 127.4332081018022, 295.41748261869327, 252.66821521963985, 309.18651279702055, 443.90000000000236, 276.54586927032574, 354.4210108159406, 160.41824479951907, 222.54889165177767, 303.96635150026674, 191.54372710740702, 118.83261397489645, 667.9009550385617, 226.21821329378227, 579.9024671491954, 328.06308966975496, 101.81440254917186, 372.9459021728395, 307.91238586369053, 201.26689905023235, 127.5580181952474, 163.58797160118667, 56.784577035701005, 367.81892955743535, 150.51725108794852, 229.31197163661247, 419.50355558919716, 306.1907800014097, 290.7757418526289, 173.43987778103914, 190.43680892858404, 568.0336728015583, 209.03849266314398, 212.63285581862132, 131.36552214738884, 124.53421320099332, 356.9673866686898, 394.3473674626494, 228.52171755807075, 378.0984067043365, 346.45285140834164, 39.39625610525704, 241.29326649716182, 332.06002997685096, 195.69022342899802, 152.41521297134312, 270.28533158242055, 286.1296488557566, 200.3556350695616, 217.20925827568144, 577.4, 179.06882849500414, 496.0161915988429, 36.08295480144898, 330.8000000000038, 402.06109795748125, 235.8616152214617], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-92.13984553003213, 207.76234063873528, 298.02667761036565, -352.86891556462797, 175.6258949686735, 149.819705390926, -94.27819128189459, 32.69938068933513, -188.86334254549385, -268.0806496801812, -552.3516938569489, -268.33423523189805, 256.4046835121837, 112.01865808418535, 28.91468721702126, -359.0409250904782, -493.4784948889794, 18.238743251889023, 87.12255404254157, -124.03318614454753, -230.37068881741348, -646.60849277567, 322.2258740802783, 80.54302735961991, 244.72328648184543, -578.0990919054888, -583.6454691849461, -214.59996055378468, -142.01525866847487, -828.3763975903887, -244.18032657209466, -563.427683130207, 139.69878754518834, -204.6273328062902, -1134.906062009939, -780.225044025636, -166.7645838112108, 25.749756106188876, -133.76705890123336, 28.02546838777758, -299.30339886328215, -546.7581881903168, -219.53085333611244, -247.39982803793976, -887.7978530743577, -1016.5436843305299, -331.63386711290036, -431.22081803292645, 250.26988290189286, 301.05218643555554, -652.3321399917786, -932.7496034723418, -123.98425375128767, -383.4782187481201, -250.2761599104728, 122.94366786350504, -38.973813971874826, -575.9324638134804, -576.1003951790785, -72.3039662618586, -695.1693090452412, 32.4702634907824, -110.88619227564014, -602.8708555677028, -129.45962943458102, -99.32987784239054, -735.3608360424288, 5.116255256499876, -226.02151603472294, -499.57502869491617, -538.2555722428593, 19.397575023169217, -751.2260395350033, -466.92135765683685, -230.64026186572266, -342.7830347132893, 110.37886973922255, -424.52746756163236, -400.74385622195615, -335.8320736417272, 0.5607629935585452, -523.743831375594, -548.2556391318509, -288.16927179721347, -820.363176145111, 344.7930961090693, -402.3213279132123, -272.80274747405326, -246.70251238881065, -539.6198282603177, 29.05902443855439, -491.0521545043065, -131.39019481293585, -269.27251321351133, 382.2438854647713, 47.16314126990436, -883.1465967724434, 240.74255559719154, -558.2947696950021, -90.67415086647465, -0.9643575056370063, -1025.4363792665533, -558.4745188411896, -219.5118389202687, -287.0346996563557, -1.31887743957817, -260.5440598750406, -895.9164551016788, -786.820054370004, -677.8880182502794, 224.7981416143054, 234.3089986882769, -210.22219540382451, -723.4392102701397, 69.37546253452919, 275.7098793361405, -146.17445528769315, -537.0143017175972, -963.4409041925637, -565.892290124409, -252.42924053964452, -421.3049007075414, -201.25671348202636, -366.93062837392796, -194.08884530235036, 48.191211834663704, -371.4637676360478, -666.3697868260084, -25.89866443180263, -809.7130961534187, -1008.2743495270397, -1253.8492873253065, 76.27429525811394, -607.9380763811248, -490.91723632079703, -219.58774438678284, -827.7922618162081, -176.5918250894054, -148.8728891711479, 185.29273706496457, 218.03366053518087, -1069.571508096973, -423.4912884233411, -1.0330137225058351, -525.8078693595045, -407.80099468100804, -735.5846136572503, -654.7268459327829, -250.30872197089113, 358.4526981940348, -441.2834715652103, -836.1829862375849, -560.698289164504, -647.6693629856813, -629.8307680579841, -811.959949737021, -855.3421231385325, -249.5017891933268, 253.09248399826424, -1001.1377152616908, 4.503937365712156, -597.5292856209692, -342.26051487216256, -577.4513344425684, -103.87515121037526, -1162.184376818474, -139.5092733067992, -210.29048840409556, -764.5728899108738, -1208.063536710598, -607.3227104421428, -627.2620661721458, -300.8925141220266, -280.27930331378445, -325.8466208703903, -473.2736489103899, -972.3909928818077, -800.549050194874, -255.8783415529534, -697.6057723429011, -260.5488908267291, -379.5644083007533, -958.7001862800086, -427.4443924452798, -595.0735955818818, -121.80426881613002, 249.17128350311648, 124.3341711240042, -600.8871011175007, -649.5731263909953, -35.87498186212572, -607.1630153598793, -726.4574488641996, -1121.9357658810573, -48.437861413271094, -343.9409656527499, -302.4533299723081, -31.424118832673855, -183.17030221063393, -754.929663172081], "policy_predator_policy_reward": [263.35364805618445, 81.00198791589598, 35.67332238963438, 376.1689155646287, 40.57410503132649, 91.78029460907386, 125.8781912818928, 9.900619310665093, 556.1667272678665, 73.76252356241389, 844.1605566343036, 137.145793270035, 148.2714999802627, 142.6240263598799, 518.1208060413994, 33.91176856120184, 347.25892924538556, 358.6520112395229, 297.1550045416419, 377.9075723154688, 404.3391227989633, 746.6917362577885, 213.62093313990408, 30.897210588008548, 18.569244759055273, 713.8709884177767, 608.8596453603081, 417.06438372896315, 302.64075593650796, 884.7025920372221, 67.16988602029342, 906.5877295177052, 197.81086311615516, 397.5048878120054, 857.5623906596809, 1150.8187242137233, 140.18747851929925, 361.03007795626166, 24.228538302530914, 352.11305221092493, 403.1097305403002, 736.429393328986, 586.5124713993491, 194.06865343840676, 1064.2323616144004, 932.4903623302974, 847.0799566503208, 200.90149541745657, 0.0, 117.46123889230186, 990.505871927333, 823.5802429804057, 807.2783152705186, 59.473877038659396, 321.77615991047566, 14.45633213649489, 571.5295184698679, 400.17022573681214, 197.70356761624996, 800.2051138019231, 50.69651951473691, 797.7257693346135, 565.7773344801346, 382.56052745750026, 189.87929198272772, 468.91593464232614, 778.0655522063146, 260.9226567789045, 722.4677166878545, 320.62258303300956, 613.6555722428594, 19.302424976830796, 711.1894494005518, 792.5392329855341, 88.47220936964929, 708.3568583655007, 46.048890498392296, 656.2795565871047, 843.8419299781441, 134.48833951663485, 729.0762786160601, 56.16281095438585, 1018.5569391344316, 83.67390489121532, 842.375863761488, 0.0, 484.75099993275074, 317.80628355631706, 113.28372167260744, 968.456101595214, 603.7640328730419, 110.89731241235133, 7.316855970954057, 702.5323648525139, 5.601096291708557, 8.891876973616, 915.1658567302533, 3.7840537153253377, 488.88114339172, 514.5087879856974, 365.0114876277068, 821.8074939440035, 842.520569689653, 158.014679723583, 572.9699736865462, 19.34995490965471, 403.5581606748639, 944.4460814092635, 809.6706942548269, 773.8699923403536, 110.20185838569462, 98.5919563502848, 326.81086450660507, 833.0687544611426, 42.619790640279355, 192.1973346382464, 571.6697930778544, 439.5820535971901, 1041.9629319470284, 589.1846649191149, 172.24493273047295, 874.4351106895516, 813.7127464004624, 62.386981319182745, 223.5888453023487, 123.57568721556773, 428.61591644258016, 736.7756562147244, 686.4558942613535, 312.74383792505483, 1059.9589265627405, 1258.9492873253068, 880.1213141879607, 19.361396492486424, 558.4476774206996, 302.574554374833, 254.46831162847417, 979.2277469137528, 255.51673213716055, 127.56697555821557, 66.08318962039358, 1091.6454379428078, 705.4559595622103, 9.84408443626538, 840.0405513613354, 267.0081904602188, 852.4718145969987, 728.2764539216187, 459.16617816911327, 0.7235184092995441, 1001.6078222701616, 484.8971281957761, 953.006564631768, 467.99394333703816, 1084.919619455594, 488.23662048679984, 770.2293044937759, 459.1488210390772, 1045.3302256338618, 59.682392298254655, 513.8931729913884, 473.4795427265192, 91.73019839822818, 1056.5033684745738, 872.6126571196393, 771.545277613548, 487.98095627566744, 208.27165684356547, 796.9691460161304, 1215.063536710598, 1138.7125236068975, 337.1655195045534, 381.2712243157401, 531.9606230969264, 968.9126062369805, 25.8978869728041, 817.9889252004249, 1107.366330847601, 814.3318828399969, 409.43756263827817, 0.9023107683710899, 925.3406372148706, 1047.5601929999928, 538.9400207948579, 169.94739761038613, 764.139725063307, 6.228716496883488, 197.66582887599577, 788.4585382126173, 641.0705177908826, 595.9968743562689, 543.0573144645786, 760.261996448745, 1124.214173097961, 5.184388793118768, 717.9944382729027, 731.8439371940248, 4.094609568439207, 522.5653672449009, 651.3962133592751]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.045868063670722, "mean_inference_ms": 6.365341101606896, "mean_action_processing_ms": 2.4372387848055284, "mean_env_wait_ms": 15.817180689086957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007721900939941406, "StateBufferConnector_ms": 0.008874654769897461, "ViewRequirementAgentConnector_ms": 0.32380497455596924}, "num_episodes": 24, "episode_return_max": 668.7833082297502, "episode_return_min": 36.08295480144898, "episode_return_mean": 288.6035236531887, "episodes_this_iter": 24}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368736, "num_agent_steps_trained": 368736, "num_env_steps_sampled": 92184, "num_env_steps_trained": 92184, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 151.61481162465964, "num_env_steps_trained_throughput_per_sec": 151.61481162465964, "timesteps_total": 92184, "num_env_steps_sampled_lifetime": 92184, "num_agent_steps_sampled_lifetime": 368736, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 368736, "timers": {"training_iteration_time_ms": 26808.069, "restore_workers_time_ms": 0.032, "training_step_time_ms": 26807.621, "sample_time_ms": 3017.372, "learn_time_ms": 23767.98, "learn_throughput": 168.63, "synch_weights_time_ms": 19.365}, "counters": {"num_env_steps_sampled": 92184, "num_env_steps_trained": 92184, "num_agent_steps_sampled": 368736, "num_agent_steps_trained": 368736}, "done": false, "training_iteration": 23, "trial_id": "7f713_00000", "date": "2024-08-23_09-57-02", "timestamp": 1724387222, "time_this_iter_s": 26.500848054885864, "time_total_s": 622.0691232681274, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30f7a0af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 622.0691232681274, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 37.62432432432432, "ram_util_percent": 82.79459459459459}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.056472967667554, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.157482673503734, "policy_loss": -0.012997516056414318, "vf_loss": 8.168136026493457, "vf_explained_var": 0.37551918408227347, "kl": 0.01172064913254448, "entropy": 1.1854252733250774, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 22208.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.827948952099634, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.604468353715523, "policy_loss": -0.009244716535051349, "vf_loss": 7.612038040665722, "vf_explained_var": 0.34844945063666694, "kl": 0.008375018265433413, "entropy": 0.8424517946899253, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 22208.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 96192, "num_env_steps_trained": 96192, "num_agent_steps_sampled": 384768, "num_agent_steps_trained": 384768}, "env_runners": {"episode_reward_max": 668.7833082297502, "episode_reward_min": 36.08295480144898, "episode_reward_mean": 289.4045966603401, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1253.8492873253065, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 382.2438854647713, "predator_policy": 1258.9492873253068}, "policy_reward_mean": {"prey_policy": -354.24267099991516, "predator_policy": 498.9449693300853}, "custom_metrics": {}, "hist_stats": {"episode_reward": [399.0644277531893, 227.67859935054113, 216.95169171486634, 166.14960583569706, 530.3872056670588, 93.25000883782951, 360.2027287705395, 270.60000000000184, 293.4775368156875, 313.6504434637064, 92.38118653981144, 285.12676692195095, 668.7833082297502, 229.0043714436179, 359.28971980977076, 208.89999999999822, 356.79346642132487, 349.5043199772353, 185.7232432948898, 234.58081409429056, 430.0057193480827, 308.74362819929024, 317.49375499122397, 114.10000000000014, 285.5812851942449, 223.40577115613752, 388.17984926308674, 241.75433963109643, 262.05602118840807, 265.805933096582, 366.8057837254455, 127.4332081018022, 295.41748261869327, 252.66821521963985, 309.18651279702055, 443.90000000000236, 276.54586927032574, 354.4210108159406, 160.41824479951907, 222.54889165177767, 303.96635150026674, 191.54372710740702, 118.83261397489645, 667.9009550385617, 226.21821329378227, 579.9024671491954, 328.06308966975496, 101.81440254917186, 372.9459021728395, 307.91238586369053, 201.26689905023235, 127.5580181952474, 163.58797160118667, 56.784577035701005, 367.81892955743535, 150.51725108794852, 229.31197163661247, 419.50355558919716, 306.1907800014097, 290.7757418526289, 173.43987778103914, 190.43680892858404, 568.0336728015583, 209.03849266314398, 212.63285581862132, 131.36552214738884, 124.53421320099332, 356.9673866686898, 394.3473674626494, 228.52171755807075, 378.0984067043365, 346.45285140834164, 39.39625610525704, 241.29326649716182, 332.06002997685096, 195.69022342899802, 152.41521297134312, 270.28533158242055, 286.1296488557566, 200.3556350695616, 217.20925827568144, 577.4, 179.06882849500414, 496.0161915988429, 36.08295480144898, 330.8000000000038, 402.06109795748125, 235.8616152214617, 656.7403054366971, 350.89679328625357, 128.30851987182993, 321.1000000000005, 144.0999999999984, 630.9, 503.1340641344233, 668.2999999999997, 94.09783896770361, 386.0640319439285, 377.40978166696044, 173.02683680828054], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [244.72328648184543, -578.0990919054888, -583.6454691849461, -214.59996055378468, -142.01525866847487, -828.3763975903887, -244.18032657209466, -563.427683130207, 139.69878754518834, -204.6273328062902, -1134.906062009939, -780.225044025636, -166.7645838112108, 25.749756106188876, -133.76705890123336, 28.02546838777758, -299.30339886328215, -546.7581881903168, -219.53085333611244, -247.39982803793976, -887.7978530743577, -1016.5436843305299, -331.63386711290036, -431.22081803292645, 250.26988290189286, 301.05218643555554, -652.3321399917786, -932.7496034723418, -123.98425375128767, -383.4782187481201, -250.2761599104728, 122.94366786350504, -38.973813971874826, -575.9324638134804, -576.1003951790785, -72.3039662618586, -695.1693090452412, 32.4702634907824, -110.88619227564014, -602.8708555677028, -129.45962943458102, -99.32987784239054, -735.3608360424288, 5.116255256499876, -226.02151603472294, -499.57502869491617, -538.2555722428593, 19.397575023169217, -751.2260395350033, -466.92135765683685, -230.64026186572266, -342.7830347132893, 110.37886973922255, -424.52746756163236, -400.74385622195615, -335.8320736417272, 0.5607629935585452, -523.743831375594, -548.2556391318509, -288.16927179721347, -820.363176145111, 344.7930961090693, -402.3213279132123, -272.80274747405326, -246.70251238881065, -539.6198282603177, 29.05902443855439, -491.0521545043065, -131.39019481293585, -269.27251321351133, 382.2438854647713, 47.16314126990436, -883.1465967724434, 240.74255559719154, -558.2947696950021, -90.67415086647465, -0.9643575056370063, -1025.4363792665533, -558.4745188411896, -219.5118389202687, -287.0346996563557, -1.31887743957817, -260.5440598750406, -895.9164551016788, -786.820054370004, -677.8880182502794, 224.7981416143054, 234.3089986882769, -210.22219540382451, -723.4392102701397, 69.37546253452919, 275.7098793361405, -146.17445528769315, -537.0143017175972, -963.4409041925637, -565.892290124409, -252.42924053964452, -421.3049007075414, -201.25671348202636, -366.93062837392796, -194.08884530235036, 48.191211834663704, -371.4637676360478, -666.3697868260084, -25.89866443180263, -809.7130961534187, -1008.2743495270397, -1253.8492873253065, 76.27429525811394, -607.9380763811248, -490.91723632079703, -219.58774438678284, -827.7922618162081, -176.5918250894054, -148.8728891711479, 185.29273706496457, 218.03366053518087, -1069.571508096973, -423.4912884233411, -1.0330137225058351, -525.8078693595045, -407.80099468100804, -735.5846136572503, -654.7268459327829, -250.30872197089113, 358.4526981940348, -441.2834715652103, -836.1829862375849, -560.698289164504, -647.6693629856813, -629.8307680579841, -811.959949737021, -855.3421231385325, -249.5017891933268, 253.09248399826424, -1001.1377152616908, 4.503937365712156, -597.5292856209692, -342.26051487216256, -577.4513344425684, -103.87515121037526, -1162.184376818474, -139.5092733067992, -210.29048840409556, -764.5728899108738, -1208.063536710598, -607.3227104421428, -627.2620661721458, -300.8925141220266, -280.27930331378445, -325.8466208703903, -473.2736489103899, -972.3909928818077, -800.549050194874, -255.8783415529534, -697.6057723429011, -260.5488908267291, -379.5644083007533, -958.7001862800086, -427.4443924452798, -595.0735955818818, -121.80426881613002, 249.17128350311648, 124.3341711240042, -600.8871011175007, -649.5731263909953, -35.87498186212572, -607.1630153598793, -726.4574488641996, -1121.9357658810573, -48.437861413271094, -343.9409656527499, -302.4533299723081, -31.424118832673855, -183.17030221063393, -754.929663172081, 228.40113161463543, 139.2557819790748, -1031.0474285038483, 259.18582610400097, -491.0099369849244, -541.0086710787457, 18.390308687597198, 276.56840196005936, -879.8672294792666, 40.0000000000003, 176.31170565797433, 127.05401360397548, 26.007997979716002, -299.0808492033642, 375.70341259233055, 280.29999999999995, -868.269523615941, -684.9635408569266, 280.5386301152141, -812.3688056489764, -593.842871156427, -298.01892952557324, -623.7637568446399, -180.84735960933932], "policy_predator_policy_reward": [18.569244759055273, 713.8709884177767, 608.8596453603081, 417.06438372896315, 302.64075593650796, 884.7025920372221, 67.16988602029342, 906.5877295177052, 197.81086311615516, 397.5048878120054, 857.5623906596809, 1150.8187242137233, 140.18747851929925, 361.03007795626166, 24.228538302530914, 352.11305221092493, 403.1097305403002, 736.429393328986, 586.5124713993491, 194.06865343840676, 1064.2323616144004, 932.4903623302974, 847.0799566503208, 200.90149541745657, 0.0, 117.46123889230186, 990.505871927333, 823.5802429804057, 807.2783152705186, 59.473877038659396, 321.77615991047566, 14.45633213649489, 571.5295184698679, 400.17022573681214, 197.70356761624996, 800.2051138019231, 50.69651951473691, 797.7257693346135, 565.7773344801346, 382.56052745750026, 189.87929198272772, 468.91593464232614, 778.0655522063146, 260.9226567789045, 722.4677166878545, 320.62258303300956, 613.6555722428594, 19.302424976830796, 711.1894494005518, 792.5392329855341, 88.47220936964929, 708.3568583655007, 46.048890498392296, 656.2795565871047, 843.8419299781441, 134.48833951663485, 729.0762786160601, 56.16281095438585, 1018.5569391344316, 83.67390489121532, 842.375863761488, 0.0, 484.75099993275074, 317.80628355631706, 113.28372167260744, 968.456101595214, 603.7640328730419, 110.89731241235133, 7.316855970954057, 702.5323648525139, 5.601096291708557, 8.891876973616, 915.1658567302533, 3.7840537153253377, 488.88114339172, 514.5087879856974, 365.0114876277068, 821.8074939440035, 842.520569689653, 158.014679723583, 572.9699736865462, 19.34995490965471, 403.5581606748639, 944.4460814092635, 809.6706942548269, 773.8699923403536, 110.20185838569462, 98.5919563502848, 326.81086450660507, 833.0687544611426, 42.619790640279355, 192.1973346382464, 571.6697930778544, 439.5820535971901, 1041.9629319470284, 589.1846649191149, 172.24493273047295, 874.4351106895516, 813.7127464004624, 62.386981319182745, 223.5888453023487, 123.57568721556773, 428.61591644258016, 736.7756562147244, 686.4558942613535, 312.74383792505483, 1059.9589265627405, 1258.9492873253068, 880.1213141879607, 19.361396492486424, 558.4476774206996, 302.574554374833, 254.46831162847417, 979.2277469137528, 255.51673213716055, 127.56697555821557, 66.08318962039358, 1091.6454379428078, 705.4559595622103, 9.84408443626538, 840.0405513613354, 267.0081904602188, 852.4718145969987, 728.2764539216187, 459.16617816911327, 0.7235184092995441, 1001.6078222701616, 484.8971281957761, 953.006564631768, 467.99394333703816, 1084.919619455594, 488.23662048679984, 770.2293044937759, 459.1488210390772, 1045.3302256338618, 59.682392298254655, 513.8931729913884, 473.4795427265192, 91.73019839822818, 1056.5033684745738, 872.6126571196393, 771.545277613548, 487.98095627566744, 208.27165684356547, 796.9691460161304, 1215.063536710598, 1138.7125236068975, 337.1655195045534, 381.2712243157401, 531.9606230969264, 968.9126062369805, 25.8978869728041, 817.9889252004249, 1107.366330847601, 814.3318828399969, 409.43756263827817, 0.9023107683710899, 925.3406372148706, 1047.5601929999928, 538.9400207948579, 169.94739761038613, 764.139725063307, 6.228716496883488, 197.66582887599577, 788.4585382126173, 641.0705177908826, 595.9968743562689, 543.0573144645786, 760.261996448745, 1124.214173097961, 5.184388793118768, 717.9944382729027, 731.8439371940248, 4.094609568439207, 522.5653672449009, 651.3962133592751, 226.280133021367, 62.80325882161985, 135.24735788879974, 987.5110377972962, 1067.5370827150969, 92.79004522041136, 20.309691312402812, 5.831598039940642, 39.91783259907678, 944.0493968801898, 181.44675886972348, 146.08752186832652, 718.3180264947191, 57.88888886335232, 12.29658740766948, 0.0, 749.0352380589379, 898.2956653816374, 1.0755973373173793, 916.8186101403727, 995.7599707043771, 273.511611644584, 149.27212543961366, 828.3658278226497]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.073873963802619, "mean_inference_ms": 6.394345000310396, "mean_action_processing_ms": 2.4006252324130393, "mean_env_wait_ms": 15.960747705368124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007745981216430664, "StateBufferConnector_ms": 0.008637785911560059, "ViewRequirementAgentConnector_ms": 0.3350883722305298}, "num_episodes": 12, "episode_return_max": 668.7833082297502, "episode_return_min": 36.08295480144898, "episode_return_mean": 289.4045966603401, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384768, "num_agent_steps_trained": 384768, "num_env_steps_sampled": 96192, "num_env_steps_trained": 96192, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 149.67428488107302, "num_env_steps_trained_throughput_per_sec": 149.67428488107302, "timesteps_total": 96192, "num_env_steps_sampled_lifetime": 96192, "num_agent_steps_sampled_lifetime": 384768, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 384768, "timers": {"training_iteration_time_ms": 26856.128, "restore_workers_time_ms": 0.036, "training_step_time_ms": 26855.672, "sample_time_ms": 3119.069, "learn_time_ms": 23714.076, "learn_throughput": 169.014, "synch_weights_time_ms": 19.738}, "counters": {"num_env_steps_sampled": 96192, "num_env_steps_trained": 96192, "num_agent_steps_sampled": 384768, "num_agent_steps_trained": 384768}, "done": false, "training_iteration": 24, "trial_id": "7f713_00000", "date": "2024-08-23_09-57-29", "timestamp": 1724387249, "time_this_iter_s": 26.805352210998535, "time_total_s": 648.874475479126, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17374e790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 648.874475479126, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 38.526315789473685, "ram_util_percent": 83.02105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.874677053330437, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.448212586256561, "policy_loss": -0.011509792867951864, "vf_loss": 8.457210712836533, "vf_explained_var": 0.36708232359911397, "kl": 0.012558492414022564, "entropy": 1.1583324790631653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 23153.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.47804806005387, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.987345306457035, "policy_loss": -0.008995580249441365, "vf_loss": 7.9944676732260085, "vf_explained_var": 0.33570595285879873, "kl": 0.009365889137591083, "entropy": 0.7761170830045427, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 23153.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 100200, "num_env_steps_trained": 100200, "num_agent_steps_sampled": 400800, "num_agent_steps_trained": 400800}, "env_runners": {"episode_reward_max": 668.7833082297502, "episode_reward_min": 36.08295480144898, "episode_reward_mean": 287.25198948492766, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1253.8492873253065, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 382.2438854647713, "predator_policy": 1258.9492873253068}, "policy_reward_mean": {"prey_policy": -360.17302909404566, "predator_policy": 503.79902383650966}, "custom_metrics": {}, "hist_stats": {"episode_reward": [227.67859935054113, 216.95169171486634, 166.14960583569706, 530.3872056670588, 93.25000883782951, 360.2027287705395, 270.60000000000184, 293.4775368156875, 313.6504434637064, 92.38118653981144, 285.12676692195095, 668.7833082297502, 229.0043714436179, 359.28971980977076, 208.89999999999822, 356.79346642132487, 349.5043199772353, 185.7232432948898, 234.58081409429056, 430.0057193480827, 308.74362819929024, 317.49375499122397, 114.10000000000014, 285.5812851942449, 223.40577115613752, 388.17984926308674, 241.75433963109643, 262.05602118840807, 265.805933096582, 366.8057837254455, 127.4332081018022, 295.41748261869327, 252.66821521963985, 309.18651279702055, 443.90000000000236, 276.54586927032574, 354.4210108159406, 160.41824479951907, 222.54889165177767, 303.96635150026674, 191.54372710740702, 118.83261397489645, 667.9009550385617, 226.21821329378227, 579.9024671491954, 328.06308966975496, 101.81440254917186, 372.9459021728395, 307.91238586369053, 201.26689905023235, 127.5580181952474, 163.58797160118667, 56.784577035701005, 367.81892955743535, 150.51725108794852, 229.31197163661247, 419.50355558919716, 306.1907800014097, 290.7757418526289, 173.43987778103914, 190.43680892858404, 568.0336728015583, 209.03849266314398, 212.63285581862132, 131.36552214738884, 124.53421320099332, 356.9673866686898, 394.3473674626494, 228.52171755807075, 378.0984067043365, 346.45285140834164, 39.39625610525704, 241.29326649716182, 332.06002997685096, 195.69022342899802, 152.41521297134312, 270.28533158242055, 286.1296488557566, 200.3556350695616, 217.20925827568144, 577.4, 179.06882849500414, 496.0161915988429, 36.08295480144898, 330.8000000000038, 402.06109795748125, 235.8616152214617, 656.7403054366971, 350.89679328625357, 128.30851987182993, 321.1000000000005, 144.0999999999984, 630.9, 503.1340641344233, 668.2999999999997, 94.09783896770361, 386.0640319439285, 377.40978166696044, 173.02683680828054, 183.8037102119468], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-583.6454691849461, -214.59996055378468, -142.01525866847487, -828.3763975903887, -244.18032657209466, -563.427683130207, 139.69878754518834, -204.6273328062902, -1134.906062009939, -780.225044025636, -166.7645838112108, 25.749756106188876, -133.76705890123336, 28.02546838777758, -299.30339886328215, -546.7581881903168, -219.53085333611244, -247.39982803793976, -887.7978530743577, -1016.5436843305299, -331.63386711290036, -431.22081803292645, 250.26988290189286, 301.05218643555554, -652.3321399917786, -932.7496034723418, -123.98425375128767, -383.4782187481201, -250.2761599104728, 122.94366786350504, -38.973813971874826, -575.9324638134804, -576.1003951790785, -72.3039662618586, -695.1693090452412, 32.4702634907824, -110.88619227564014, -602.8708555677028, -129.45962943458102, -99.32987784239054, -735.3608360424288, 5.116255256499876, -226.02151603472294, -499.57502869491617, -538.2555722428593, 19.397575023169217, -751.2260395350033, -466.92135765683685, -230.64026186572266, -342.7830347132893, 110.37886973922255, -424.52746756163236, -400.74385622195615, -335.8320736417272, 0.5607629935585452, -523.743831375594, -548.2556391318509, -288.16927179721347, -820.363176145111, 344.7930961090693, -402.3213279132123, -272.80274747405326, -246.70251238881065, -539.6198282603177, 29.05902443855439, -491.0521545043065, -131.39019481293585, -269.27251321351133, 382.2438854647713, 47.16314126990436, -883.1465967724434, 240.74255559719154, -558.2947696950021, -90.67415086647465, -0.9643575056370063, -1025.4363792665533, -558.4745188411896, -219.5118389202687, -287.0346996563557, -1.31887743957817, -260.5440598750406, -895.9164551016788, -786.820054370004, -677.8880182502794, 224.7981416143054, 234.3089986882769, -210.22219540382451, -723.4392102701397, 69.37546253452919, 275.7098793361405, -146.17445528769315, -537.0143017175972, -963.4409041925637, -565.892290124409, -252.42924053964452, -421.3049007075414, -201.25671348202636, -366.93062837392796, -194.08884530235036, 48.191211834663704, -371.4637676360478, -666.3697868260084, -25.89866443180263, -809.7130961534187, -1008.2743495270397, -1253.8492873253065, 76.27429525811394, -607.9380763811248, -490.91723632079703, -219.58774438678284, -827.7922618162081, -176.5918250894054, -148.8728891711479, 185.29273706496457, 218.03366053518087, -1069.571508096973, -423.4912884233411, -1.0330137225058351, -525.8078693595045, -407.80099468100804, -735.5846136572503, -654.7268459327829, -250.30872197089113, 358.4526981940348, -441.2834715652103, -836.1829862375849, -560.698289164504, -647.6693629856813, -629.8307680579841, -811.959949737021, -855.3421231385325, -249.5017891933268, 253.09248399826424, -1001.1377152616908, 4.503937365712156, -597.5292856209692, -342.26051487216256, -577.4513344425684, -103.87515121037526, -1162.184376818474, -139.5092733067992, -210.29048840409556, -764.5728899108738, -1208.063536710598, -607.3227104421428, -627.2620661721458, -300.8925141220266, -280.27930331378445, -325.8466208703903, -473.2736489103899, -972.3909928818077, -800.549050194874, -255.8783415529534, -697.6057723429011, -260.5488908267291, -379.5644083007533, -958.7001862800086, -427.4443924452798, -595.0735955818818, -121.80426881613002, 249.17128350311648, 124.3341711240042, -600.8871011175007, -649.5731263909953, -35.87498186212572, -607.1630153598793, -726.4574488641996, -1121.9357658810573, -48.437861413271094, -343.9409656527499, -302.4533299723081, -31.424118832673855, -183.17030221063393, -754.929663172081, 228.40113161463543, 139.2557819790748, -1031.0474285038483, 259.18582610400097, -491.0099369849244, -541.0086710787457, 18.390308687597198, 276.56840196005936, -879.8672294792666, 40.0000000000003, 176.31170565797433, 127.05401360397548, 26.007997979716002, -299.0808492033642, 375.70341259233055, 280.29999999999995, -868.269523615941, -684.9635408569266, 280.5386301152141, -812.3688056489764, -593.842871156427, -298.01892952557324, -623.7637568446399, -180.84735960933932, -497.8966961512025, -1021.5507280985466], "policy_predator_policy_reward": [608.8596453603081, 417.06438372896315, 302.64075593650796, 884.7025920372221, 67.16988602029342, 906.5877295177052, 197.81086311615516, 397.5048878120054, 857.5623906596809, 1150.8187242137233, 140.18747851929925, 361.03007795626166, 24.228538302530914, 352.11305221092493, 403.1097305403002, 736.429393328986, 586.5124713993491, 194.06865343840676, 1064.2323616144004, 932.4903623302974, 847.0799566503208, 200.90149541745657, 0.0, 117.46123889230186, 990.505871927333, 823.5802429804057, 807.2783152705186, 59.473877038659396, 321.77615991047566, 14.45633213649489, 571.5295184698679, 400.17022573681214, 197.70356761624996, 800.2051138019231, 50.69651951473691, 797.7257693346135, 565.7773344801346, 382.56052745750026, 189.87929198272772, 468.91593464232614, 778.0655522063146, 260.9226567789045, 722.4677166878545, 320.62258303300956, 613.6555722428594, 19.302424976830796, 711.1894494005518, 792.5392329855341, 88.47220936964929, 708.3568583655007, 46.048890498392296, 656.2795565871047, 843.8419299781441, 134.48833951663485, 729.0762786160601, 56.16281095438585, 1018.5569391344316, 83.67390489121532, 842.375863761488, 0.0, 484.75099993275074, 317.80628355631706, 113.28372167260744, 968.456101595214, 603.7640328730419, 110.89731241235133, 7.316855970954057, 702.5323648525139, 5.601096291708557, 8.891876973616, 915.1658567302533, 3.7840537153253377, 488.88114339172, 514.5087879856974, 365.0114876277068, 821.8074939440035, 842.520569689653, 158.014679723583, 572.9699736865462, 19.34995490965471, 403.5581606748639, 944.4460814092635, 809.6706942548269, 773.8699923403536, 110.20185838569462, 98.5919563502848, 326.81086450660507, 833.0687544611426, 42.619790640279355, 192.1973346382464, 571.6697930778544, 439.5820535971901, 1041.9629319470284, 589.1846649191149, 172.24493273047295, 874.4351106895516, 813.7127464004624, 62.386981319182745, 223.5888453023487, 123.57568721556773, 428.61591644258016, 736.7756562147244, 686.4558942613535, 312.74383792505483, 1059.9589265627405, 1258.9492873253068, 880.1213141879607, 19.361396492486424, 558.4476774206996, 302.574554374833, 254.46831162847417, 979.2277469137528, 255.51673213716055, 127.56697555821557, 66.08318962039358, 1091.6454379428078, 705.4559595622103, 9.84408443626538, 840.0405513613354, 267.0081904602188, 852.4718145969987, 728.2764539216187, 459.16617816911327, 0.7235184092995441, 1001.6078222701616, 484.8971281957761, 953.006564631768, 467.99394333703816, 1084.919619455594, 488.23662048679984, 770.2293044937759, 459.1488210390772, 1045.3302256338618, 59.682392298254655, 513.8931729913884, 473.4795427265192, 91.73019839822818, 1056.5033684745738, 872.6126571196393, 771.545277613548, 487.98095627566744, 208.27165684356547, 796.9691460161304, 1215.063536710598, 1138.7125236068975, 337.1655195045534, 381.2712243157401, 531.9606230969264, 968.9126062369805, 25.8978869728041, 817.9889252004249, 1107.366330847601, 814.3318828399969, 409.43756263827817, 0.9023107683710899, 925.3406372148706, 1047.5601929999928, 538.9400207948579, 169.94739761038613, 764.139725063307, 6.228716496883488, 197.66582887599577, 788.4585382126173, 641.0705177908826, 595.9968743562689, 543.0573144645786, 760.261996448745, 1124.214173097961, 5.184388793118768, 717.9944382729027, 731.8439371940248, 4.094609568439207, 522.5653672449009, 651.3962133592751, 226.280133021367, 62.80325882161985, 135.24735788879974, 987.5110377972962, 1067.5370827150969, 92.79004522041136, 20.309691312402812, 5.831598039940642, 39.91783259907678, 944.0493968801898, 181.44675886972348, 146.08752186832652, 718.3180264947191, 57.88888886335232, 12.29658740766948, 0.0, 749.0352380589379, 898.2956653816374, 1.0755973373173793, 916.8186101403727, 995.7599707043771, 273.511611644584, 149.27212543961366, 828.3658278226497, 841.8820952788783, 861.3690391828177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.070901928445716, "mean_inference_ms": 6.40644896884388, "mean_action_processing_ms": 2.395739123147284, "mean_env_wait_ms": 15.953987867041787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007737636566162109, "StateBufferConnector_ms": 0.00863349437713623, "ViewRequirementAgentConnector_ms": 0.3333609104156494}, "num_episodes": 1, "episode_return_max": 668.7833082297502, "episode_return_min": 36.08295480144898, "episode_return_mean": 287.25198948492766, "episodes_this_iter": 1}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400800, "num_agent_steps_trained": 400800, "num_env_steps_sampled": 100200, "num_env_steps_trained": 100200, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 151.2533009407578, "num_env_steps_trained_throughput_per_sec": 151.2533009407578, "timesteps_total": 100200, "num_env_steps_sampled_lifetime": 100200, "num_agent_steps_sampled_lifetime": 400800, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 400800, "timers": {"training_iteration_time_ms": 26842.927, "restore_workers_time_ms": 0.037, "training_step_time_ms": 26842.43, "sample_time_ms": 3125.653, "learn_time_ms": 23692.984, "learn_throughput": 169.164, "synch_weights_time_ms": 20.251}, "counters": {"num_env_steps_sampled": 100200, "num_env_steps_trained": 100200, "num_agent_steps_sampled": 400800, "num_agent_steps_trained": 400800}, "done": false, "training_iteration": 25, "trial_id": "7f713_00000", "date": "2024-08-23_09-57-56", "timestamp": 1724387276, "time_this_iter_s": 26.520360946655273, "time_total_s": 675.3948364257812, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737c1dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 675.3948364257812, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 38.90263157894737, "ram_util_percent": 82.6657894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.356400790416375, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.53102640373997, "policy_loss": -0.012951063023752006, "vf_loss": 8.541448929700902, "vf_explained_var": 0.3860829734928394, "kl": 0.0126425624829988, "entropy": 1.128082452627717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 24098.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.449362930166659, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.238672282708386, "policy_loss": -0.011605526015123047, "vf_loss": 8.248623311078108, "vf_explained_var": 0.2866425809406099, "kl": 0.008272366347431979, "entropy": 0.7404724092079848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 24098.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 104208, "num_env_steps_trained": 104208, "num_agent_steps_sampled": 416832, "num_agent_steps_trained": 416832}, "env_runners": {"episode_reward_max": 668.7833082297502, "episode_reward_min": 36.08295480144898, "episode_reward_mean": 287.25198948492766, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1253.8492873253065, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 382.2438854647713, "predator_policy": 1258.9492873253068}, "policy_reward_mean": {"prey_policy": -360.17302909404566, "predator_policy": 503.79902383650966}, "custom_metrics": {}, "hist_stats": {"episode_reward": [227.67859935054113, 216.95169171486634, 166.14960583569706, 530.3872056670588, 93.25000883782951, 360.2027287705395, 270.60000000000184, 293.4775368156875, 313.6504434637064, 92.38118653981144, 285.12676692195095, 668.7833082297502, 229.0043714436179, 359.28971980977076, 208.89999999999822, 356.79346642132487, 349.5043199772353, 185.7232432948898, 234.58081409429056, 430.0057193480827, 308.74362819929024, 317.49375499122397, 114.10000000000014, 285.5812851942449, 223.40577115613752, 388.17984926308674, 241.75433963109643, 262.05602118840807, 265.805933096582, 366.8057837254455, 127.4332081018022, 295.41748261869327, 252.66821521963985, 309.18651279702055, 443.90000000000236, 276.54586927032574, 354.4210108159406, 160.41824479951907, 222.54889165177767, 303.96635150026674, 191.54372710740702, 118.83261397489645, 667.9009550385617, 226.21821329378227, 579.9024671491954, 328.06308966975496, 101.81440254917186, 372.9459021728395, 307.91238586369053, 201.26689905023235, 127.5580181952474, 163.58797160118667, 56.784577035701005, 367.81892955743535, 150.51725108794852, 229.31197163661247, 419.50355558919716, 306.1907800014097, 290.7757418526289, 173.43987778103914, 190.43680892858404, 568.0336728015583, 209.03849266314398, 212.63285581862132, 131.36552214738884, 124.53421320099332, 356.9673866686898, 394.3473674626494, 228.52171755807075, 378.0984067043365, 346.45285140834164, 39.39625610525704, 241.29326649716182, 332.06002997685096, 195.69022342899802, 152.41521297134312, 270.28533158242055, 286.1296488557566, 200.3556350695616, 217.20925827568144, 577.4, 179.06882849500414, 496.0161915988429, 36.08295480144898, 330.8000000000038, 402.06109795748125, 235.8616152214617, 656.7403054366971, 350.89679328625357, 128.30851987182993, 321.1000000000005, 144.0999999999984, 630.9, 503.1340641344233, 668.2999999999997, 94.09783896770361, 386.0640319439285, 377.40978166696044, 173.02683680828054, 183.8037102119468], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-583.6454691849461, -214.59996055378468, -142.01525866847487, -828.3763975903887, -244.18032657209466, -563.427683130207, 139.69878754518834, -204.6273328062902, -1134.906062009939, -780.225044025636, -166.7645838112108, 25.749756106188876, -133.76705890123336, 28.02546838777758, -299.30339886328215, -546.7581881903168, -219.53085333611244, -247.39982803793976, -887.7978530743577, -1016.5436843305299, -331.63386711290036, -431.22081803292645, 250.26988290189286, 301.05218643555554, -652.3321399917786, -932.7496034723418, -123.98425375128767, -383.4782187481201, -250.2761599104728, 122.94366786350504, -38.973813971874826, -575.9324638134804, -576.1003951790785, -72.3039662618586, -695.1693090452412, 32.4702634907824, -110.88619227564014, -602.8708555677028, -129.45962943458102, -99.32987784239054, -735.3608360424288, 5.116255256499876, -226.02151603472294, -499.57502869491617, -538.2555722428593, 19.397575023169217, -751.2260395350033, -466.92135765683685, -230.64026186572266, -342.7830347132893, 110.37886973922255, -424.52746756163236, -400.74385622195615, -335.8320736417272, 0.5607629935585452, -523.743831375594, -548.2556391318509, -288.16927179721347, -820.363176145111, 344.7930961090693, -402.3213279132123, -272.80274747405326, -246.70251238881065, -539.6198282603177, 29.05902443855439, -491.0521545043065, -131.39019481293585, -269.27251321351133, 382.2438854647713, 47.16314126990436, -883.1465967724434, 240.74255559719154, -558.2947696950021, -90.67415086647465, -0.9643575056370063, -1025.4363792665533, -558.4745188411896, -219.5118389202687, -287.0346996563557, -1.31887743957817, -260.5440598750406, -895.9164551016788, -786.820054370004, -677.8880182502794, 224.7981416143054, 234.3089986882769, -210.22219540382451, -723.4392102701397, 69.37546253452919, 275.7098793361405, -146.17445528769315, -537.0143017175972, -963.4409041925637, -565.892290124409, -252.42924053964452, -421.3049007075414, -201.25671348202636, -366.93062837392796, -194.08884530235036, 48.191211834663704, -371.4637676360478, -666.3697868260084, -25.89866443180263, -809.7130961534187, -1008.2743495270397, -1253.8492873253065, 76.27429525811394, -607.9380763811248, -490.91723632079703, -219.58774438678284, -827.7922618162081, -176.5918250894054, -148.8728891711479, 185.29273706496457, 218.03366053518087, -1069.571508096973, -423.4912884233411, -1.0330137225058351, -525.8078693595045, -407.80099468100804, -735.5846136572503, -654.7268459327829, -250.30872197089113, 358.4526981940348, -441.2834715652103, -836.1829862375849, -560.698289164504, -647.6693629856813, -629.8307680579841, -811.959949737021, -855.3421231385325, -249.5017891933268, 253.09248399826424, -1001.1377152616908, 4.503937365712156, -597.5292856209692, -342.26051487216256, -577.4513344425684, -103.87515121037526, -1162.184376818474, -139.5092733067992, -210.29048840409556, -764.5728899108738, -1208.063536710598, -607.3227104421428, -627.2620661721458, -300.8925141220266, -280.27930331378445, -325.8466208703903, -473.2736489103899, -972.3909928818077, -800.549050194874, -255.8783415529534, -697.6057723429011, -260.5488908267291, -379.5644083007533, -958.7001862800086, -427.4443924452798, -595.0735955818818, -121.80426881613002, 249.17128350311648, 124.3341711240042, -600.8871011175007, -649.5731263909953, -35.87498186212572, -607.1630153598793, -726.4574488641996, -1121.9357658810573, -48.437861413271094, -343.9409656527499, -302.4533299723081, -31.424118832673855, -183.17030221063393, -754.929663172081, 228.40113161463543, 139.2557819790748, -1031.0474285038483, 259.18582610400097, -491.0099369849244, -541.0086710787457, 18.390308687597198, 276.56840196005936, -879.8672294792666, 40.0000000000003, 176.31170565797433, 127.05401360397548, 26.007997979716002, -299.0808492033642, 375.70341259233055, 280.29999999999995, -868.269523615941, -684.9635408569266, 280.5386301152141, -812.3688056489764, -593.842871156427, -298.01892952557324, -623.7637568446399, -180.84735960933932, -497.8966961512025, -1021.5507280985466], "policy_predator_policy_reward": [608.8596453603081, 417.06438372896315, 302.64075593650796, 884.7025920372221, 67.16988602029342, 906.5877295177052, 197.81086311615516, 397.5048878120054, 857.5623906596809, 1150.8187242137233, 140.18747851929925, 361.03007795626166, 24.228538302530914, 352.11305221092493, 403.1097305403002, 736.429393328986, 586.5124713993491, 194.06865343840676, 1064.2323616144004, 932.4903623302974, 847.0799566503208, 200.90149541745657, 0.0, 117.46123889230186, 990.505871927333, 823.5802429804057, 807.2783152705186, 59.473877038659396, 321.77615991047566, 14.45633213649489, 571.5295184698679, 400.17022573681214, 197.70356761624996, 800.2051138019231, 50.69651951473691, 797.7257693346135, 565.7773344801346, 382.56052745750026, 189.87929198272772, 468.91593464232614, 778.0655522063146, 260.9226567789045, 722.4677166878545, 320.62258303300956, 613.6555722428594, 19.302424976830796, 711.1894494005518, 792.5392329855341, 88.47220936964929, 708.3568583655007, 46.048890498392296, 656.2795565871047, 843.8419299781441, 134.48833951663485, 729.0762786160601, 56.16281095438585, 1018.5569391344316, 83.67390489121532, 842.375863761488, 0.0, 484.75099993275074, 317.80628355631706, 113.28372167260744, 968.456101595214, 603.7640328730419, 110.89731241235133, 7.316855970954057, 702.5323648525139, 5.601096291708557, 8.891876973616, 915.1658567302533, 3.7840537153253377, 488.88114339172, 514.5087879856974, 365.0114876277068, 821.8074939440035, 842.520569689653, 158.014679723583, 572.9699736865462, 19.34995490965471, 403.5581606748639, 944.4460814092635, 809.6706942548269, 773.8699923403536, 110.20185838569462, 98.5919563502848, 326.81086450660507, 833.0687544611426, 42.619790640279355, 192.1973346382464, 571.6697930778544, 439.5820535971901, 1041.9629319470284, 589.1846649191149, 172.24493273047295, 874.4351106895516, 813.7127464004624, 62.386981319182745, 223.5888453023487, 123.57568721556773, 428.61591644258016, 736.7756562147244, 686.4558942613535, 312.74383792505483, 1059.9589265627405, 1258.9492873253068, 880.1213141879607, 19.361396492486424, 558.4476774206996, 302.574554374833, 254.46831162847417, 979.2277469137528, 255.51673213716055, 127.56697555821557, 66.08318962039358, 1091.6454379428078, 705.4559595622103, 9.84408443626538, 840.0405513613354, 267.0081904602188, 852.4718145969987, 728.2764539216187, 459.16617816911327, 0.7235184092995441, 1001.6078222701616, 484.8971281957761, 953.006564631768, 467.99394333703816, 1084.919619455594, 488.23662048679984, 770.2293044937759, 459.1488210390772, 1045.3302256338618, 59.682392298254655, 513.8931729913884, 473.4795427265192, 91.73019839822818, 1056.5033684745738, 872.6126571196393, 771.545277613548, 487.98095627566744, 208.27165684356547, 796.9691460161304, 1215.063536710598, 1138.7125236068975, 337.1655195045534, 381.2712243157401, 531.9606230969264, 968.9126062369805, 25.8978869728041, 817.9889252004249, 1107.366330847601, 814.3318828399969, 409.43756263827817, 0.9023107683710899, 925.3406372148706, 1047.5601929999928, 538.9400207948579, 169.94739761038613, 764.139725063307, 6.228716496883488, 197.66582887599577, 788.4585382126173, 641.0705177908826, 595.9968743562689, 543.0573144645786, 760.261996448745, 1124.214173097961, 5.184388793118768, 717.9944382729027, 731.8439371940248, 4.094609568439207, 522.5653672449009, 651.3962133592751, 226.280133021367, 62.80325882161985, 135.24735788879974, 987.5110377972962, 1067.5370827150969, 92.79004522041136, 20.309691312402812, 5.831598039940642, 39.91783259907678, 944.0493968801898, 181.44675886972348, 146.08752186832652, 718.3180264947191, 57.88888886335232, 12.29658740766948, 0.0, 749.0352380589379, 898.2956653816374, 1.0755973373173793, 916.8186101403727, 995.7599707043771, 273.511611644584, 149.27212543961366, 828.3658278226497, 841.8820952788783, 861.3690391828177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.070901928445716, "mean_inference_ms": 6.40644896884388, "mean_action_processing_ms": 2.395739123147284, "mean_env_wait_ms": 15.953987867041787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007737636566162109, "StateBufferConnector_ms": 0.00863349437713623, "ViewRequirementAgentConnector_ms": 0.3333609104156494}, "num_episodes": 0, "episode_return_max": 668.7833082297502, "episode_return_min": 36.08295480144898, "episode_return_mean": 287.25198948492766, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416832, "num_agent_steps_trained": 416832, "num_env_steps_sampled": 104208, "num_env_steps_trained": 104208, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 151.2316196736321, "num_env_steps_trained_throughput_per_sec": 151.2316196736321, "timesteps_total": 104208, "num_env_steps_sampled_lifetime": 104208, "num_agent_steps_sampled_lifetime": 416832, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 416832, "timers": {"training_iteration_time_ms": 26869.169, "restore_workers_time_ms": 0.168, "training_step_time_ms": 26868.518, "sample_time_ms": 3157.871, "learn_time_ms": 23686.994, "learn_throughput": 169.207, "synch_weights_time_ms": 20.193}, "counters": {"num_env_steps_sampled": 104208, "num_env_steps_trained": 104208, "num_agent_steps_sampled": 416832, "num_agent_steps_trained": 416832}, "done": false, "training_iteration": 26, "trial_id": "7f713_00000", "date": "2024-08-23_09-58-22", "timestamp": 1724387302, "time_this_iter_s": 26.542891025543213, "time_total_s": 701.9377274513245, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17379eb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 701.9377274513245, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 38.107894736842105, "ram_util_percent": 83.15526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.375195768522838, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.449699901903747, "policy_loss": -0.014770834926619299, "vf_loss": 8.462127858116514, "vf_explained_var": 0.43542590891873395, "kl": 0.011714453245981266, "entropy": 1.0644336950842035, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 25043.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.875766551053083, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.350853333649813, "policy_loss": -0.00953358967823011, "vf_loss": 8.358979000111736, "vf_explained_var": 0.29976632323845354, "kl": 0.0070395712546077824, "entropy": 0.6595843161855425, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 25043.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 108216, "num_env_steps_trained": 108216, "num_agent_steps_sampled": 432864, "num_agent_steps_trained": 432864}, "env_runners": {"episode_reward_max": 668.7833082297502, "episode_reward_min": 36.08295480144898, "episode_reward_mean": 287.25198948492766, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1253.8492873253065, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 382.2438854647713, "predator_policy": 1258.9492873253068}, "policy_reward_mean": {"prey_policy": -360.17302909404566, "predator_policy": 503.79902383650966}, "custom_metrics": {}, "hist_stats": {"episode_reward": [227.67859935054113, 216.95169171486634, 166.14960583569706, 530.3872056670588, 93.25000883782951, 360.2027287705395, 270.60000000000184, 293.4775368156875, 313.6504434637064, 92.38118653981144, 285.12676692195095, 668.7833082297502, 229.0043714436179, 359.28971980977076, 208.89999999999822, 356.79346642132487, 349.5043199772353, 185.7232432948898, 234.58081409429056, 430.0057193480827, 308.74362819929024, 317.49375499122397, 114.10000000000014, 285.5812851942449, 223.40577115613752, 388.17984926308674, 241.75433963109643, 262.05602118840807, 265.805933096582, 366.8057837254455, 127.4332081018022, 295.41748261869327, 252.66821521963985, 309.18651279702055, 443.90000000000236, 276.54586927032574, 354.4210108159406, 160.41824479951907, 222.54889165177767, 303.96635150026674, 191.54372710740702, 118.83261397489645, 667.9009550385617, 226.21821329378227, 579.9024671491954, 328.06308966975496, 101.81440254917186, 372.9459021728395, 307.91238586369053, 201.26689905023235, 127.5580181952474, 163.58797160118667, 56.784577035701005, 367.81892955743535, 150.51725108794852, 229.31197163661247, 419.50355558919716, 306.1907800014097, 290.7757418526289, 173.43987778103914, 190.43680892858404, 568.0336728015583, 209.03849266314398, 212.63285581862132, 131.36552214738884, 124.53421320099332, 356.9673866686898, 394.3473674626494, 228.52171755807075, 378.0984067043365, 346.45285140834164, 39.39625610525704, 241.29326649716182, 332.06002997685096, 195.69022342899802, 152.41521297134312, 270.28533158242055, 286.1296488557566, 200.3556350695616, 217.20925827568144, 577.4, 179.06882849500414, 496.0161915988429, 36.08295480144898, 330.8000000000038, 402.06109795748125, 235.8616152214617, 656.7403054366971, 350.89679328625357, 128.30851987182993, 321.1000000000005, 144.0999999999984, 630.9, 503.1340641344233, 668.2999999999997, 94.09783896770361, 386.0640319439285, 377.40978166696044, 173.02683680828054, 183.8037102119468], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-583.6454691849461, -214.59996055378468, -142.01525866847487, -828.3763975903887, -244.18032657209466, -563.427683130207, 139.69878754518834, -204.6273328062902, -1134.906062009939, -780.225044025636, -166.7645838112108, 25.749756106188876, -133.76705890123336, 28.02546838777758, -299.30339886328215, -546.7581881903168, -219.53085333611244, -247.39982803793976, -887.7978530743577, -1016.5436843305299, -331.63386711290036, -431.22081803292645, 250.26988290189286, 301.05218643555554, -652.3321399917786, -932.7496034723418, -123.98425375128767, -383.4782187481201, -250.2761599104728, 122.94366786350504, -38.973813971874826, -575.9324638134804, -576.1003951790785, -72.3039662618586, -695.1693090452412, 32.4702634907824, -110.88619227564014, -602.8708555677028, -129.45962943458102, -99.32987784239054, -735.3608360424288, 5.116255256499876, -226.02151603472294, -499.57502869491617, -538.2555722428593, 19.397575023169217, -751.2260395350033, -466.92135765683685, -230.64026186572266, -342.7830347132893, 110.37886973922255, -424.52746756163236, -400.74385622195615, -335.8320736417272, 0.5607629935585452, -523.743831375594, -548.2556391318509, -288.16927179721347, -820.363176145111, 344.7930961090693, -402.3213279132123, -272.80274747405326, -246.70251238881065, -539.6198282603177, 29.05902443855439, -491.0521545043065, -131.39019481293585, -269.27251321351133, 382.2438854647713, 47.16314126990436, -883.1465967724434, 240.74255559719154, -558.2947696950021, -90.67415086647465, -0.9643575056370063, -1025.4363792665533, -558.4745188411896, -219.5118389202687, -287.0346996563557, -1.31887743957817, -260.5440598750406, -895.9164551016788, -786.820054370004, -677.8880182502794, 224.7981416143054, 234.3089986882769, -210.22219540382451, -723.4392102701397, 69.37546253452919, 275.7098793361405, -146.17445528769315, -537.0143017175972, -963.4409041925637, -565.892290124409, -252.42924053964452, -421.3049007075414, -201.25671348202636, -366.93062837392796, -194.08884530235036, 48.191211834663704, -371.4637676360478, -666.3697868260084, -25.89866443180263, -809.7130961534187, -1008.2743495270397, -1253.8492873253065, 76.27429525811394, -607.9380763811248, -490.91723632079703, -219.58774438678284, -827.7922618162081, -176.5918250894054, -148.8728891711479, 185.29273706496457, 218.03366053518087, -1069.571508096973, -423.4912884233411, -1.0330137225058351, -525.8078693595045, -407.80099468100804, -735.5846136572503, -654.7268459327829, -250.30872197089113, 358.4526981940348, -441.2834715652103, -836.1829862375849, -560.698289164504, -647.6693629856813, -629.8307680579841, -811.959949737021, -855.3421231385325, -249.5017891933268, 253.09248399826424, -1001.1377152616908, 4.503937365712156, -597.5292856209692, -342.26051487216256, -577.4513344425684, -103.87515121037526, -1162.184376818474, -139.5092733067992, -210.29048840409556, -764.5728899108738, -1208.063536710598, -607.3227104421428, -627.2620661721458, -300.8925141220266, -280.27930331378445, -325.8466208703903, -473.2736489103899, -972.3909928818077, -800.549050194874, -255.8783415529534, -697.6057723429011, -260.5488908267291, -379.5644083007533, -958.7001862800086, -427.4443924452798, -595.0735955818818, -121.80426881613002, 249.17128350311648, 124.3341711240042, -600.8871011175007, -649.5731263909953, -35.87498186212572, -607.1630153598793, -726.4574488641996, -1121.9357658810573, -48.437861413271094, -343.9409656527499, -302.4533299723081, -31.424118832673855, -183.17030221063393, -754.929663172081, 228.40113161463543, 139.2557819790748, -1031.0474285038483, 259.18582610400097, -491.0099369849244, -541.0086710787457, 18.390308687597198, 276.56840196005936, -879.8672294792666, 40.0000000000003, 176.31170565797433, 127.05401360397548, 26.007997979716002, -299.0808492033642, 375.70341259233055, 280.29999999999995, -868.269523615941, -684.9635408569266, 280.5386301152141, -812.3688056489764, -593.842871156427, -298.01892952557324, -623.7637568446399, -180.84735960933932, -497.8966961512025, -1021.5507280985466], "policy_predator_policy_reward": [608.8596453603081, 417.06438372896315, 302.64075593650796, 884.7025920372221, 67.16988602029342, 906.5877295177052, 197.81086311615516, 397.5048878120054, 857.5623906596809, 1150.8187242137233, 140.18747851929925, 361.03007795626166, 24.228538302530914, 352.11305221092493, 403.1097305403002, 736.429393328986, 586.5124713993491, 194.06865343840676, 1064.2323616144004, 932.4903623302974, 847.0799566503208, 200.90149541745657, 0.0, 117.46123889230186, 990.505871927333, 823.5802429804057, 807.2783152705186, 59.473877038659396, 321.77615991047566, 14.45633213649489, 571.5295184698679, 400.17022573681214, 197.70356761624996, 800.2051138019231, 50.69651951473691, 797.7257693346135, 565.7773344801346, 382.56052745750026, 189.87929198272772, 468.91593464232614, 778.0655522063146, 260.9226567789045, 722.4677166878545, 320.62258303300956, 613.6555722428594, 19.302424976830796, 711.1894494005518, 792.5392329855341, 88.47220936964929, 708.3568583655007, 46.048890498392296, 656.2795565871047, 843.8419299781441, 134.48833951663485, 729.0762786160601, 56.16281095438585, 1018.5569391344316, 83.67390489121532, 842.375863761488, 0.0, 484.75099993275074, 317.80628355631706, 113.28372167260744, 968.456101595214, 603.7640328730419, 110.89731241235133, 7.316855970954057, 702.5323648525139, 5.601096291708557, 8.891876973616, 915.1658567302533, 3.7840537153253377, 488.88114339172, 514.5087879856974, 365.0114876277068, 821.8074939440035, 842.520569689653, 158.014679723583, 572.9699736865462, 19.34995490965471, 403.5581606748639, 944.4460814092635, 809.6706942548269, 773.8699923403536, 110.20185838569462, 98.5919563502848, 326.81086450660507, 833.0687544611426, 42.619790640279355, 192.1973346382464, 571.6697930778544, 439.5820535971901, 1041.9629319470284, 589.1846649191149, 172.24493273047295, 874.4351106895516, 813.7127464004624, 62.386981319182745, 223.5888453023487, 123.57568721556773, 428.61591644258016, 736.7756562147244, 686.4558942613535, 312.74383792505483, 1059.9589265627405, 1258.9492873253068, 880.1213141879607, 19.361396492486424, 558.4476774206996, 302.574554374833, 254.46831162847417, 979.2277469137528, 255.51673213716055, 127.56697555821557, 66.08318962039358, 1091.6454379428078, 705.4559595622103, 9.84408443626538, 840.0405513613354, 267.0081904602188, 852.4718145969987, 728.2764539216187, 459.16617816911327, 0.7235184092995441, 1001.6078222701616, 484.8971281957761, 953.006564631768, 467.99394333703816, 1084.919619455594, 488.23662048679984, 770.2293044937759, 459.1488210390772, 1045.3302256338618, 59.682392298254655, 513.8931729913884, 473.4795427265192, 91.73019839822818, 1056.5033684745738, 872.6126571196393, 771.545277613548, 487.98095627566744, 208.27165684356547, 796.9691460161304, 1215.063536710598, 1138.7125236068975, 337.1655195045534, 381.2712243157401, 531.9606230969264, 968.9126062369805, 25.8978869728041, 817.9889252004249, 1107.366330847601, 814.3318828399969, 409.43756263827817, 0.9023107683710899, 925.3406372148706, 1047.5601929999928, 538.9400207948579, 169.94739761038613, 764.139725063307, 6.228716496883488, 197.66582887599577, 788.4585382126173, 641.0705177908826, 595.9968743562689, 543.0573144645786, 760.261996448745, 1124.214173097961, 5.184388793118768, 717.9944382729027, 731.8439371940248, 4.094609568439207, 522.5653672449009, 651.3962133592751, 226.280133021367, 62.80325882161985, 135.24735788879974, 987.5110377972962, 1067.5370827150969, 92.79004522041136, 20.309691312402812, 5.831598039940642, 39.91783259907678, 944.0493968801898, 181.44675886972348, 146.08752186832652, 718.3180264947191, 57.88888886335232, 12.29658740766948, 0.0, 749.0352380589379, 898.2956653816374, 1.0755973373173793, 916.8186101403727, 995.7599707043771, 273.511611644584, 149.27212543961366, 828.3658278226497, 841.8820952788783, 861.3690391828177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.070901928445716, "mean_inference_ms": 6.40644896884388, "mean_action_processing_ms": 2.395739123147284, "mean_env_wait_ms": 15.953987867041787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007737636566162109, "StateBufferConnector_ms": 0.00863349437713623, "ViewRequirementAgentConnector_ms": 0.3333609104156494}, "num_episodes": 0, "episode_return_max": 668.7833082297502, "episode_return_min": 36.08295480144898, "episode_return_mean": 287.25198948492766, "episodes_this_iter": 0}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432864, "num_agent_steps_trained": 432864, "num_env_steps_sampled": 108216, "num_env_steps_trained": 108216, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 150.94083216358803, "num_env_steps_trained_throughput_per_sec": 150.94083216358803, "timesteps_total": 108216, "num_env_steps_sampled_lifetime": 108216, "num_agent_steps_sampled_lifetime": 432864, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 432864, "timers": {"training_iteration_time_ms": 26896.724, "restore_workers_time_ms": 0.169, "training_step_time_ms": 26896.022, "sample_time_ms": 3173.91, "learn_time_ms": 23698.05, "learn_throughput": 169.128, "synch_weights_time_ms": 20.209}, "counters": {"num_env_steps_sampled": 108216, "num_env_steps_trained": 108216, "num_agent_steps_sampled": 432864, "num_agent_steps_trained": 432864}, "done": false, "training_iteration": 27, "trial_id": "7f713_00000", "date": "2024-08-23_09-58-49", "timestamp": 1724387329, "time_this_iter_s": 26.602721691131592, "time_total_s": 728.540449142456, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17374e4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 728.540449142456, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 39.37027027027027, "ram_util_percent": 83.01621621621625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.29411865580019, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.547370200686984, "policy_loss": -0.00997054773979086, "vf_loss": 8.555416286307038, "vf_explained_var": 0.531566595400452, "kl": 0.00962233459823346, "entropy": 1.0630462295163876, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 25988.0, "diff_num_grad_updates_vs_sampler_policy": 489.4476047904208}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.319900610964135, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.161217931717161, "policy_loss": -0.010943772615717044, "vf_loss": 8.170604013513636, "vf_explained_var": 0.31725467948055774, "kl": 0.00778848940097584, "entropy": 0.6465946135066805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 25988.0, "diff_num_grad_updates_vs_sampler_policy": 489.4476047904208}}, "num_env_steps_sampled": 112224, "num_env_steps_trained": 112224, "num_agent_steps_sampled": 448896, "num_agent_steps_trained": 448896}, "env_runners": {"episode_reward_max": 668.7833082297502, "episode_reward_min": 36.08295480144898, "episode_reward_mean": 285.54131446189547, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1301.0450556223416, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 382.2438854647713, "predator_policy": 1258.9492873253068}, "policy_reward_mean": {"prey_policy": -367.9561936680405, "predator_policy": 510.7268508989884}, "custom_metrics": {}, "hist_stats": {"episode_reward": [166.14960583569706, 530.3872056670588, 93.25000883782951, 360.2027287705395, 270.60000000000184, 293.4775368156875, 313.6504434637064, 92.38118653981144, 285.12676692195095, 668.7833082297502, 229.0043714436179, 359.28971980977076, 208.89999999999822, 356.79346642132487, 349.5043199772353, 185.7232432948898, 234.58081409429056, 430.0057193480827, 308.74362819929024, 317.49375499122397, 114.10000000000014, 285.5812851942449, 223.40577115613752, 388.17984926308674, 241.75433963109643, 262.05602118840807, 265.805933096582, 366.8057837254455, 127.4332081018022, 295.41748261869327, 252.66821521963985, 309.18651279702055, 443.90000000000236, 276.54586927032574, 354.4210108159406, 160.41824479951907, 222.54889165177767, 303.96635150026674, 191.54372710740702, 118.83261397489645, 667.9009550385617, 226.21821329378227, 579.9024671491954, 328.06308966975496, 101.81440254917186, 372.9459021728395, 307.91238586369053, 201.26689905023235, 127.5580181952474, 163.58797160118667, 56.784577035701005, 367.81892955743535, 150.51725108794852, 229.31197163661247, 419.50355558919716, 306.1907800014097, 290.7757418526289, 173.43987778103914, 190.43680892858404, 568.0336728015583, 209.03849266314398, 212.63285581862132, 131.36552214738884, 124.53421320099332, 356.9673866686898, 394.3473674626494, 228.52171755807075, 378.0984067043365, 346.45285140834164, 39.39625610525704, 241.29326649716182, 332.06002997685096, 195.69022342899802, 152.41521297134312, 270.28533158242055, 286.1296488557566, 200.3556350695616, 217.20925827568144, 577.4, 179.06882849500414, 496.0161915988429, 36.08295480144898, 330.8000000000038, 402.06109795748125, 235.8616152214617, 656.7403054366971, 350.89679328625357, 128.30851987182993, 321.1000000000005, 144.0999999999984, 630.9, 503.1340641344233, 668.2999999999997, 94.09783896770361, 386.0640319439285, 377.40978166696044, 173.02683680828054, 183.8037102119468, 77.75754060615014, 195.80524815603968], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-244.18032657209466, -563.427683130207, 139.69878754518834, -204.6273328062902, -1134.906062009939, -780.225044025636, -166.7645838112108, 25.749756106188876, -133.76705890123336, 28.02546838777758, -299.30339886328215, -546.7581881903168, -219.53085333611244, -247.39982803793976, -887.7978530743577, -1016.5436843305299, -331.63386711290036, -431.22081803292645, 250.26988290189286, 301.05218643555554, -652.3321399917786, -932.7496034723418, -123.98425375128767, -383.4782187481201, -250.2761599104728, 122.94366786350504, -38.973813971874826, -575.9324638134804, -576.1003951790785, -72.3039662618586, -695.1693090452412, 32.4702634907824, -110.88619227564014, -602.8708555677028, -129.45962943458102, -99.32987784239054, -735.3608360424288, 5.116255256499876, -226.02151603472294, -499.57502869491617, -538.2555722428593, 19.397575023169217, -751.2260395350033, -466.92135765683685, -230.64026186572266, -342.7830347132893, 110.37886973922255, -424.52746756163236, -400.74385622195615, -335.8320736417272, 0.5607629935585452, -523.743831375594, -548.2556391318509, -288.16927179721347, -820.363176145111, 344.7930961090693, -402.3213279132123, -272.80274747405326, -246.70251238881065, -539.6198282603177, 29.05902443855439, -491.0521545043065, -131.39019481293585, -269.27251321351133, 382.2438854647713, 47.16314126990436, -883.1465967724434, 240.74255559719154, -558.2947696950021, -90.67415086647465, -0.9643575056370063, -1025.4363792665533, -558.4745188411896, -219.5118389202687, -287.0346996563557, -1.31887743957817, -260.5440598750406, -895.9164551016788, -786.820054370004, -677.8880182502794, 224.7981416143054, 234.3089986882769, -210.22219540382451, -723.4392102701397, 69.37546253452919, 275.7098793361405, -146.17445528769315, -537.0143017175972, -963.4409041925637, -565.892290124409, -252.42924053964452, -421.3049007075414, -201.25671348202636, -366.93062837392796, -194.08884530235036, 48.191211834663704, -371.4637676360478, -666.3697868260084, -25.89866443180263, -809.7130961534187, -1008.2743495270397, -1253.8492873253065, 76.27429525811394, -607.9380763811248, -490.91723632079703, -219.58774438678284, -827.7922618162081, -176.5918250894054, -148.8728891711479, 185.29273706496457, 218.03366053518087, -1069.571508096973, -423.4912884233411, -1.0330137225058351, -525.8078693595045, -407.80099468100804, -735.5846136572503, -654.7268459327829, -250.30872197089113, 358.4526981940348, -441.2834715652103, -836.1829862375849, -560.698289164504, -647.6693629856813, -629.8307680579841, -811.959949737021, -855.3421231385325, -249.5017891933268, 253.09248399826424, -1001.1377152616908, 4.503937365712156, -597.5292856209692, -342.26051487216256, -577.4513344425684, -103.87515121037526, -1162.184376818474, -139.5092733067992, -210.29048840409556, -764.5728899108738, -1208.063536710598, -607.3227104421428, -627.2620661721458, -300.8925141220266, -280.27930331378445, -325.8466208703903, -473.2736489103899, -972.3909928818077, -800.549050194874, -255.8783415529534, -697.6057723429011, -260.5488908267291, -379.5644083007533, -958.7001862800086, -427.4443924452798, -595.0735955818818, -121.80426881613002, 249.17128350311648, 124.3341711240042, -600.8871011175007, -649.5731263909953, -35.87498186212572, -607.1630153598793, -726.4574488641996, -1121.9357658810573, -48.437861413271094, -343.9409656527499, -302.4533299723081, -31.424118832673855, -183.17030221063393, -754.929663172081, 228.40113161463543, 139.2557819790748, -1031.0474285038483, 259.18582610400097, -491.0099369849244, -541.0086710787457, 18.390308687597198, 276.56840196005936, -879.8672294792666, 40.0000000000003, 176.31170565797433, 127.05401360397548, 26.007997979716002, -299.0808492033642, 375.70341259233055, 280.29999999999995, -868.269523615941, -684.9635408569266, 280.5386301152141, -812.3688056489764, -593.842871156427, -298.01892952557324, -623.7637568446399, -180.84735960933932, -497.8966961512025, -1021.5507280985466, -587.3422651801804, -1147.077358352779, -1301.0450556223416, -289.80532164126237], "policy_predator_policy_reward": [67.16988602029342, 906.5877295177052, 197.81086311615516, 397.5048878120054, 857.5623906596809, 1150.8187242137233, 140.18747851929925, 361.03007795626166, 24.228538302530914, 352.11305221092493, 403.1097305403002, 736.429393328986, 586.5124713993491, 194.06865343840676, 1064.2323616144004, 932.4903623302974, 847.0799566503208, 200.90149541745657, 0.0, 117.46123889230186, 990.505871927333, 823.5802429804057, 807.2783152705186, 59.473877038659396, 321.77615991047566, 14.45633213649489, 571.5295184698679, 400.17022573681214, 197.70356761624996, 800.2051138019231, 50.69651951473691, 797.7257693346135, 565.7773344801346, 382.56052745750026, 189.87929198272772, 468.91593464232614, 778.0655522063146, 260.9226567789045, 722.4677166878545, 320.62258303300956, 613.6555722428594, 19.302424976830796, 711.1894494005518, 792.5392329855341, 88.47220936964929, 708.3568583655007, 46.048890498392296, 656.2795565871047, 843.8419299781441, 134.48833951663485, 729.0762786160601, 56.16281095438585, 1018.5569391344316, 83.67390489121532, 842.375863761488, 0.0, 484.75099993275074, 317.80628355631706, 113.28372167260744, 968.456101595214, 603.7640328730419, 110.89731241235133, 7.316855970954057, 702.5323648525139, 5.601096291708557, 8.891876973616, 915.1658567302533, 3.7840537153253377, 488.88114339172, 514.5087879856974, 365.0114876277068, 821.8074939440035, 842.520569689653, 158.014679723583, 572.9699736865462, 19.34995490965471, 403.5581606748639, 944.4460814092635, 809.6706942548269, 773.8699923403536, 110.20185838569462, 98.5919563502848, 326.81086450660507, 833.0687544611426, 42.619790640279355, 192.1973346382464, 571.6697930778544, 439.5820535971901, 1041.9629319470284, 589.1846649191149, 172.24493273047295, 874.4351106895516, 813.7127464004624, 62.386981319182745, 223.5888453023487, 123.57568721556773, 428.61591644258016, 736.7756562147244, 686.4558942613535, 312.74383792505483, 1059.9589265627405, 1258.9492873253068, 880.1213141879607, 19.361396492486424, 558.4476774206996, 302.574554374833, 254.46831162847417, 979.2277469137528, 255.51673213716055, 127.56697555821557, 66.08318962039358, 1091.6454379428078, 705.4559595622103, 9.84408443626538, 840.0405513613354, 267.0081904602188, 852.4718145969987, 728.2764539216187, 459.16617816911327, 0.7235184092995441, 1001.6078222701616, 484.8971281957761, 953.006564631768, 467.99394333703816, 1084.919619455594, 488.23662048679984, 770.2293044937759, 459.1488210390772, 1045.3302256338618, 59.682392298254655, 513.8931729913884, 473.4795427265192, 91.73019839822818, 1056.5033684745738, 872.6126571196393, 771.545277613548, 487.98095627566744, 208.27165684356547, 796.9691460161304, 1215.063536710598, 1138.7125236068975, 337.1655195045534, 381.2712243157401, 531.9606230969264, 968.9126062369805, 25.8978869728041, 817.9889252004249, 1107.366330847601, 814.3318828399969, 409.43756263827817, 0.9023107683710899, 925.3406372148706, 1047.5601929999928, 538.9400207948579, 169.94739761038613, 764.139725063307, 6.228716496883488, 197.66582887599577, 788.4585382126173, 641.0705177908826, 595.9968743562689, 543.0573144645786, 760.261996448745, 1124.214173097961, 5.184388793118768, 717.9944382729027, 731.8439371940248, 4.094609568439207, 522.5653672449009, 651.3962133592751, 226.280133021367, 62.80325882161985, 135.24735788879974, 987.5110377972962, 1067.5370827150969, 92.79004522041136, 20.309691312402812, 5.831598039940642, 39.91783259907678, 944.0493968801898, 181.44675886972348, 146.08752186832652, 718.3180264947191, 57.88888886335232, 12.29658740766948, 0.0, 749.0352380589379, 898.2956653816374, 1.0755973373173793, 916.8186101403727, 995.7599707043771, 273.511611644584, 149.27212543961366, 828.3658278226497, 841.8820952788783, 861.3690391828177, 636.0567198419633, 1176.1204442971507, 695.5232333170917, 1091.1323921025507]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.077538313925363, "mean_inference_ms": 6.407000077797281, "mean_action_processing_ms": 2.3794025237001977, "mean_env_wait_ms": 15.960482284379102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007057905197143555, "StateBufferConnector_ms": 0.008708357810974121, "ViewRequirementAgentConnector_ms": 0.33900773525238037}, "num_episodes": 2, "episode_return_max": 668.7833082297502, "episode_return_min": 36.08295480144898, "episode_return_mean": 285.54131446189547, "episodes_this_iter": 2}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448896, "num_agent_steps_trained": 448896, "num_env_steps_sampled": 112224, "num_env_steps_trained": 112224, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 146.93495350495388, "num_env_steps_trained_throughput_per_sec": 146.93495350495388, "timesteps_total": 112224, "num_env_steps_sampled_lifetime": 112224, "num_agent_steps_sampled_lifetime": 448896, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 448896, "timers": {"training_iteration_time_ms": 26962.281, "restore_workers_time_ms": 0.17, "training_step_time_ms": 26961.531, "sample_time_ms": 3248.327, "learn_time_ms": 23688.656, "learn_throughput": 169.195, "synch_weights_time_ms": 20.457}, "counters": {"num_env_steps_sampled": 112224, "num_env_steps_trained": 112224, "num_agent_steps_sampled": 448896, "num_agent_steps_trained": 448896}, "done": false, "training_iteration": 28, "trial_id": "7f713_00000", "date": "2024-08-23_09-59-16", "timestamp": 1724387356, "time_this_iter_s": 27.307178020477295, "time_total_s": 755.8476271629333, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737b1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 755.8476271629333, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 44.01025641025642, "ram_util_percent": 83.13589743589743}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.971014159697074, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.50424328708144, "policy_loss": -0.009547786051456732, "vf_loss": 8.511983133749988, "vf_explained_var": 0.5151959484847134, "kl": 0.009039661752444412, "entropy": 1.0261335939957352, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 26933.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.160511190550668, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.2393181281115, "policy_loss": -0.00779831403467272, "vf_loss": 8.245685593034855, "vf_explained_var": 0.3187140603544851, "kl": 0.007154041256450077, "entropy": 0.6262979054577136, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 26933.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 116232, "num_env_steps_trained": 116232, "num_agent_steps_sampled": 464928, "num_agent_steps_trained": 464928}, "env_runners": {"episode_reward_max": 668.7833082297502, "episode_reward_min": 23.72459634014661, "episode_reward_mean": 279.57432800993644, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1334.6434248207615, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 382.2438854647713, "predator_policy": 1334.4861819120827}, "policy_reward_mean": {"prey_policy": -399.7144223541234, "predator_policy": 539.5015863590919}, "custom_metrics": {}, "hist_stats": {"episode_reward": [92.38118653981144, 285.12676692195095, 668.7833082297502, 229.0043714436179, 359.28971980977076, 208.89999999999822, 356.79346642132487, 349.5043199772353, 185.7232432948898, 234.58081409429056, 430.0057193480827, 308.74362819929024, 317.49375499122397, 114.10000000000014, 285.5812851942449, 223.40577115613752, 388.17984926308674, 241.75433963109643, 262.05602118840807, 265.805933096582, 366.8057837254455, 127.4332081018022, 295.41748261869327, 252.66821521963985, 309.18651279702055, 443.90000000000236, 276.54586927032574, 354.4210108159406, 160.41824479951907, 222.54889165177767, 303.96635150026674, 191.54372710740702, 118.83261397489645, 667.9009550385617, 226.21821329378227, 579.9024671491954, 328.06308966975496, 101.81440254917186, 372.9459021728395, 307.91238586369053, 201.26689905023235, 127.5580181952474, 163.58797160118667, 56.784577035701005, 367.81892955743535, 150.51725108794852, 229.31197163661247, 419.50355558919716, 306.1907800014097, 290.7757418526289, 173.43987778103914, 190.43680892858404, 568.0336728015583, 209.03849266314398, 212.63285581862132, 131.36552214738884, 124.53421320099332, 356.9673866686898, 394.3473674626494, 228.52171755807075, 378.0984067043365, 346.45285140834164, 39.39625610525704, 241.29326649716182, 332.06002997685096, 195.69022342899802, 152.41521297134312, 270.28533158242055, 286.1296488557566, 200.3556350695616, 217.20925827568144, 577.4, 179.06882849500414, 496.0161915988429, 36.08295480144898, 330.8000000000038, 402.06109795748125, 235.8616152214617, 656.7403054366971, 350.89679328625357, 128.30851987182993, 321.1000000000005, 144.0999999999984, 630.9, 503.1340641344233, 668.2999999999997, 94.09783896770361, 386.0640319439285, 377.40978166696044, 173.02683680828054, 183.8037102119468, 77.75754060615014, 195.80524815603968, 107.53412603564897, 115.01915711507733, 23.72459634014661, 228.50674403110025, 134.67795573316386, 443.86570616602745, 377.6905987734492], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-887.7978530743577, -1016.5436843305299, -331.63386711290036, -431.22081803292645, 250.26988290189286, 301.05218643555554, -652.3321399917786, -932.7496034723418, -123.98425375128767, -383.4782187481201, -250.2761599104728, 122.94366786350504, -38.973813971874826, -575.9324638134804, -576.1003951790785, -72.3039662618586, -695.1693090452412, 32.4702634907824, -110.88619227564014, -602.8708555677028, -129.45962943458102, -99.32987784239054, -735.3608360424288, 5.116255256499876, -226.02151603472294, -499.57502869491617, -538.2555722428593, 19.397575023169217, -751.2260395350033, -466.92135765683685, -230.64026186572266, -342.7830347132893, 110.37886973922255, -424.52746756163236, -400.74385622195615, -335.8320736417272, 0.5607629935585452, -523.743831375594, -548.2556391318509, -288.16927179721347, -820.363176145111, 344.7930961090693, -402.3213279132123, -272.80274747405326, -246.70251238881065, -539.6198282603177, 29.05902443855439, -491.0521545043065, -131.39019481293585, -269.27251321351133, 382.2438854647713, 47.16314126990436, -883.1465967724434, 240.74255559719154, -558.2947696950021, -90.67415086647465, -0.9643575056370063, -1025.4363792665533, -558.4745188411896, -219.5118389202687, -287.0346996563557, -1.31887743957817, -260.5440598750406, -895.9164551016788, -786.820054370004, -677.8880182502794, 224.7981416143054, 234.3089986882769, -210.22219540382451, -723.4392102701397, 69.37546253452919, 275.7098793361405, -146.17445528769315, -537.0143017175972, -963.4409041925637, -565.892290124409, -252.42924053964452, -421.3049007075414, -201.25671348202636, -366.93062837392796, -194.08884530235036, 48.191211834663704, -371.4637676360478, -666.3697868260084, -25.89866443180263, -809.7130961534187, -1008.2743495270397, -1253.8492873253065, 76.27429525811394, -607.9380763811248, -490.91723632079703, -219.58774438678284, -827.7922618162081, -176.5918250894054, -148.8728891711479, 185.29273706496457, 218.03366053518087, -1069.571508096973, -423.4912884233411, -1.0330137225058351, -525.8078693595045, -407.80099468100804, -735.5846136572503, -654.7268459327829, -250.30872197089113, 358.4526981940348, -441.2834715652103, -836.1829862375849, -560.698289164504, -647.6693629856813, -629.8307680579841, -811.959949737021, -855.3421231385325, -249.5017891933268, 253.09248399826424, -1001.1377152616908, 4.503937365712156, -597.5292856209692, -342.26051487216256, -577.4513344425684, -103.87515121037526, -1162.184376818474, -139.5092733067992, -210.29048840409556, -764.5728899108738, -1208.063536710598, -607.3227104421428, -627.2620661721458, -300.8925141220266, -280.27930331378445, -325.8466208703903, -473.2736489103899, -972.3909928818077, -800.549050194874, -255.8783415529534, -697.6057723429011, -260.5488908267291, -379.5644083007533, -958.7001862800086, -427.4443924452798, -595.0735955818818, -121.80426881613002, 249.17128350311648, 124.3341711240042, -600.8871011175007, -649.5731263909953, -35.87498186212572, -607.1630153598793, -726.4574488641996, -1121.9357658810573, -48.437861413271094, -343.9409656527499, -302.4533299723081, -31.424118832673855, -183.17030221063393, -754.929663172081, 228.40113161463543, 139.2557819790748, -1031.0474285038483, 259.18582610400097, -491.0099369849244, -541.0086710787457, 18.390308687597198, 276.56840196005936, -879.8672294792666, 40.0000000000003, 176.31170565797433, 127.05401360397548, 26.007997979716002, -299.0808492033642, 375.70341259233055, 280.29999999999995, -868.269523615941, -684.9635408569266, 280.5386301152141, -812.3688056489764, -593.842871156427, -298.01892952557324, -623.7637568446399, -180.84735960933932, -497.8966961512025, -1021.5507280985466, -587.3422651801804, -1147.077358352779, -1301.0450556223416, -289.80532164126237, -693.5139482571528, -1279.6503729124347, 90.18778626777912, -1168.8336512883855, -1334.6434248207615, -1062.5135084460833, 107.57405763102209, -1287.2485168615106, -1193.7436397765682, -490.0402743391811, 41.84914404421343, -796.7700189134359, -679.7594456118023, -951.9562715773949], "policy_predator_policy_reward": [1064.2323616144004, 932.4903623302974, 847.0799566503208, 200.90149541745657, 0.0, 117.46123889230186, 990.505871927333, 823.5802429804057, 807.2783152705186, 59.473877038659396, 321.77615991047566, 14.45633213649489, 571.5295184698679, 400.17022573681214, 197.70356761624996, 800.2051138019231, 50.69651951473691, 797.7257693346135, 565.7773344801346, 382.56052745750026, 189.87929198272772, 468.91593464232614, 778.0655522063146, 260.9226567789045, 722.4677166878545, 320.62258303300956, 613.6555722428594, 19.302424976830796, 711.1894494005518, 792.5392329855341, 88.47220936964929, 708.3568583655007, 46.048890498392296, 656.2795565871047, 843.8419299781441, 134.48833951663485, 729.0762786160601, 56.16281095438585, 1018.5569391344316, 83.67390489121532, 842.375863761488, 0.0, 484.75099993275074, 317.80628355631706, 113.28372167260744, 968.456101595214, 603.7640328730419, 110.89731241235133, 7.316855970954057, 702.5323648525139, 5.601096291708557, 8.891876973616, 915.1658567302533, 3.7840537153253377, 488.88114339172, 514.5087879856974, 365.0114876277068, 821.8074939440035, 842.520569689653, 158.014679723583, 572.9699736865462, 19.34995490965471, 403.5581606748639, 944.4460814092635, 809.6706942548269, 773.8699923403536, 110.20185838569462, 98.5919563502848, 326.81086450660507, 833.0687544611426, 42.619790640279355, 192.1973346382464, 571.6697930778544, 439.5820535971901, 1041.9629319470284, 589.1846649191149, 172.24493273047295, 874.4351106895516, 813.7127464004624, 62.386981319182745, 223.5888453023487, 123.57568721556773, 428.61591644258016, 736.7756562147244, 686.4558942613535, 312.74383792505483, 1059.9589265627405, 1258.9492873253068, 880.1213141879607, 19.361396492486424, 558.4476774206996, 302.574554374833, 254.46831162847417, 979.2277469137528, 255.51673213716055, 127.56697555821557, 66.08318962039358, 1091.6454379428078, 705.4559595622103, 9.84408443626538, 840.0405513613354, 267.0081904602188, 852.4718145969987, 728.2764539216187, 459.16617816911327, 0.7235184092995441, 1001.6078222701616, 484.8971281957761, 953.006564631768, 467.99394333703816, 1084.919619455594, 488.23662048679984, 770.2293044937759, 459.1488210390772, 1045.3302256338618, 59.682392298254655, 513.8931729913884, 473.4795427265192, 91.73019839822818, 1056.5033684745738, 872.6126571196393, 771.545277613548, 487.98095627566744, 208.27165684356547, 796.9691460161304, 1215.063536710598, 1138.7125236068975, 337.1655195045534, 381.2712243157401, 531.9606230969264, 968.9126062369805, 25.8978869728041, 817.9889252004249, 1107.366330847601, 814.3318828399969, 409.43756263827817, 0.9023107683710899, 925.3406372148706, 1047.5601929999928, 538.9400207948579, 169.94739761038613, 764.139725063307, 6.228716496883488, 197.66582887599577, 788.4585382126173, 641.0705177908826, 595.9968743562689, 543.0573144645786, 760.261996448745, 1124.214173097961, 5.184388793118768, 717.9944382729027, 731.8439371940248, 4.094609568439207, 522.5653672449009, 651.3962133592751, 226.280133021367, 62.80325882161985, 135.24735788879974, 987.5110377972962, 1067.5370827150969, 92.79004522041136, 20.309691312402812, 5.831598039940642, 39.91783259907678, 944.0493968801898, 181.44675886972348, 146.08752186832652, 718.3180264947191, 57.88888886335232, 12.29658740766948, 0.0, 749.0352380589379, 898.2956653816374, 1.0755973373173793, 916.8186101403727, 995.7599707043771, 273.511611644584, 149.27212543961366, 828.3658278226497, 841.8820952788783, 861.3690391828177, 636.0567198419633, 1176.1204442971507, 695.5232333170917, 1091.1323921025507, 793.6397329101088, 1287.0587142951256, 0.885942659815168, 1192.7790794758685, 1334.4861819120827, 1086.3953476949087, 1073.6672765407861, 334.51392672080294, 1290.1249434176734, 528.3369264312364, 692.2537144774636, 506.53286655778936, 1212.9765273160158, 796.4297886466277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.031285701224679, "mean_inference_ms": 6.391750201874134, "mean_action_processing_ms": 2.364588523577469, "mean_env_wait_ms": 15.987934242720014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009978890419006348, "StateBufferConnector_ms": 0.010412216186523438, "ViewRequirementAgentConnector_ms": 0.3241533041000366}, "num_episodes": 7, "episode_return_max": 668.7833082297502, "episode_return_min": 23.72459634014661, "episode_return_mean": 279.57432800993644, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464928, "num_agent_steps_trained": 464928, "num_env_steps_sampled": 116232, "num_env_steps_trained": 116232, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 154.0808451815019, "num_env_steps_trained_throughput_per_sec": 154.0808451815019, "timesteps_total": 116232, "num_env_steps_sampled_lifetime": 116232, "num_agent_steps_sampled_lifetime": 464928, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 464928, "timers": {"training_iteration_time_ms": 26761.308, "restore_workers_time_ms": 0.173, "training_step_time_ms": 26760.553, "sample_time_ms": 3047.934, "learn_time_ms": 23687.923, "learn_throughput": 169.2, "synch_weights_time_ms": 20.571}, "counters": {"num_env_steps_sampled": 116232, "num_env_steps_trained": 116232, "num_agent_steps_sampled": 464928, "num_agent_steps_trained": 464928}, "done": false, "training_iteration": 29, "trial_id": "7f713_00000", "date": "2024-08-23_09-59-42", "timestamp": 1724387382, "time_this_iter_s": 26.054385900497437, "time_total_s": 781.9020130634308, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17378cb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 781.9020130634308, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 36.654054054054065, "ram_util_percent": 81.30540540540542}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.74827691512133, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.361148325097624, "policy_loss": -0.012708944301786167, "vf_loss": 8.371797639352303, "vf_explained_var": 0.569671343306385, "kl": 0.010298050139789228, "entropy": 1.001040480250404, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 27878.0, "diff_num_grad_updates_vs_sampler_policy": 480.95958083832375}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.67669595461043, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.982276701044153, "policy_loss": -0.01044541960705328, "vf_loss": 7.991232591962057, "vf_explained_var": 0.3667828947778732, "kl": 0.007447587724075352, "entropy": 0.6263648160235592, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 27878.0, "diff_num_grad_updates_vs_sampler_policy": 480.95958083832375}}, "num_env_steps_sampled": 120240, "num_env_steps_trained": 120240, "num_agent_steps_sampled": 480960, "num_agent_steps_trained": 480960}, "env_runners": {"episode_reward_max": 668.2999999999997, "episode_reward_min": 0.20084320761501173, "episode_reward_mean": 254.1780642096414, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1604.266800583997, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 382.2438854647713, "predator_policy": 1604.266800583997}, "policy_reward_mean": {"prey_policy": -505.18276437557097, "predator_policy": 632.2717964803919}, "custom_metrics": {}, "hist_stats": {"episode_reward": [388.17984926308674, 241.75433963109643, 262.05602118840807, 265.805933096582, 366.8057837254455, 127.4332081018022, 295.41748261869327, 252.66821521963985, 309.18651279702055, 443.90000000000236, 276.54586927032574, 354.4210108159406, 160.41824479951907, 222.54889165177767, 303.96635150026674, 191.54372710740702, 118.83261397489645, 667.9009550385617, 226.21821329378227, 579.9024671491954, 328.06308966975496, 101.81440254917186, 372.9459021728395, 307.91238586369053, 201.26689905023235, 127.5580181952474, 163.58797160118667, 56.784577035701005, 367.81892955743535, 150.51725108794852, 229.31197163661247, 419.50355558919716, 306.1907800014097, 290.7757418526289, 173.43987778103914, 190.43680892858404, 568.0336728015583, 209.03849266314398, 212.63285581862132, 131.36552214738884, 124.53421320099332, 356.9673866686898, 394.3473674626494, 228.52171755807075, 378.0984067043365, 346.45285140834164, 39.39625610525704, 241.29326649716182, 332.06002997685096, 195.69022342899802, 152.41521297134312, 270.28533158242055, 286.1296488557566, 200.3556350695616, 217.20925827568144, 577.4, 179.06882849500414, 496.0161915988429, 36.08295480144898, 330.8000000000038, 402.06109795748125, 235.8616152214617, 656.7403054366971, 350.89679328625357, 128.30851987182993, 321.1000000000005, 144.0999999999984, 630.9, 503.1340641344233, 668.2999999999997, 94.09783896770361, 386.0640319439285, 377.40978166696044, 173.02683680828054, 183.8037102119468, 77.75754060615014, 195.80524815603968, 107.53412603564897, 115.01915711507733, 23.72459634014661, 228.50674403110025, 134.67795573316386, 443.86570616602745, 377.6905987734492, 267.5801501744776, 219.86623722516515, 1.379911379854743, 0.20084320761501173, 258.5681334686508, 125.70860181130755, 196.05688532729272, 259.6036476146954, 63.39976845702112, 28.956330777917636, 27.773474228883412, 206.71395493008916, 66.08658375650391, 141.6466202322916, 2.299999999999995, 243.9498330003517], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [110.37886973922255, -424.52746756163236, -400.74385622195615, -335.8320736417272, 0.5607629935585452, -523.743831375594, -548.2556391318509, -288.16927179721347, -820.363176145111, 344.7930961090693, -402.3213279132123, -272.80274747405326, -246.70251238881065, -539.6198282603177, 29.05902443855439, -491.0521545043065, -131.39019481293585, -269.27251321351133, 382.2438854647713, 47.16314126990436, -883.1465967724434, 240.74255559719154, -558.2947696950021, -90.67415086647465, -0.9643575056370063, -1025.4363792665533, -558.4745188411896, -219.5118389202687, -287.0346996563557, -1.31887743957817, -260.5440598750406, -895.9164551016788, -786.820054370004, -677.8880182502794, 224.7981416143054, 234.3089986882769, -210.22219540382451, -723.4392102701397, 69.37546253452919, 275.7098793361405, -146.17445528769315, -537.0143017175972, -963.4409041925637, -565.892290124409, -252.42924053964452, -421.3049007075414, -201.25671348202636, -366.93062837392796, -194.08884530235036, 48.191211834663704, -371.4637676360478, -666.3697868260084, -25.89866443180263, -809.7130961534187, -1008.2743495270397, -1253.8492873253065, 76.27429525811394, -607.9380763811248, -490.91723632079703, -219.58774438678284, -827.7922618162081, -176.5918250894054, -148.8728891711479, 185.29273706496457, 218.03366053518087, -1069.571508096973, -423.4912884233411, -1.0330137225058351, -525.8078693595045, -407.80099468100804, -735.5846136572503, -654.7268459327829, -250.30872197089113, 358.4526981940348, -441.2834715652103, -836.1829862375849, -560.698289164504, -647.6693629856813, -629.8307680579841, -811.959949737021, -855.3421231385325, -249.5017891933268, 253.09248399826424, -1001.1377152616908, 4.503937365712156, -597.5292856209692, -342.26051487216256, -577.4513344425684, -103.87515121037526, -1162.184376818474, -139.5092733067992, -210.29048840409556, -764.5728899108738, -1208.063536710598, -607.3227104421428, -627.2620661721458, -300.8925141220266, -280.27930331378445, -325.8466208703903, -473.2736489103899, -972.3909928818077, -800.549050194874, -255.8783415529534, -697.6057723429011, -260.5488908267291, -379.5644083007533, -958.7001862800086, -427.4443924452798, -595.0735955818818, -121.80426881613002, 249.17128350311648, 124.3341711240042, -600.8871011175007, -649.5731263909953, -35.87498186212572, -607.1630153598793, -726.4574488641996, -1121.9357658810573, -48.437861413271094, -343.9409656527499, -302.4533299723081, -31.424118832673855, -183.17030221063393, -754.929663172081, 228.40113161463543, 139.2557819790748, -1031.0474285038483, 259.18582610400097, -491.0099369849244, -541.0086710787457, 18.390308687597198, 276.56840196005936, -879.8672294792666, 40.0000000000003, 176.31170565797433, 127.05401360397548, 26.007997979716002, -299.0808492033642, 375.70341259233055, 280.29999999999995, -868.269523615941, -684.9635408569266, 280.5386301152141, -812.3688056489764, -593.842871156427, -298.01892952557324, -623.7637568446399, -180.84735960933932, -497.8966961512025, -1021.5507280985466, -587.3422651801804, -1147.077358352779, -1301.0450556223416, -289.80532164126237, -693.5139482571528, -1279.6503729124347, 90.18778626777912, -1168.8336512883855, -1334.6434248207615, -1062.5135084460833, 107.57405763102209, -1287.2485168615106, -1193.7436397765682, -490.0402743391811, 41.84914404421343, -796.7700189134359, -679.7594456118023, -951.9562715773949, -1173.0833634602775, 181.09972930333592, -669.8929260183131, -809.0317471343722, -1065.9340458292345, -1034.7302521679724, -1604.266800583997, -1440.6188584035492, 258.51766656316323, -1373.391305181807, -895.6211579884788, -133.09595066646744, -1194.1864867461738, -568.4318061781602, -1306.9671357875275, -349.3613141817732, -1268.146075262068, -1208.2511487302772, -1264.3652432280758, -1009.8973073151318, -980.0427720963698, -1293.948741753348, -1132.2059667931949, -1438.4724910051773, -1252.0215349245186, -1086.172036604786, -957.0921935294833, -977.4725504831958, -1347.1012388525135, -1466.2419875865173, -811.8649107544206, -1391.953368539757], "policy_predator_policy_reward": [46.048890498392296, 656.2795565871047, 843.8419299781441, 134.48833951663485, 729.0762786160601, 56.16281095438585, 1018.5569391344316, 83.67390489121532, 842.375863761488, 0.0, 484.75099993275074, 317.80628355631706, 113.28372167260744, 968.456101595214, 603.7640328730419, 110.89731241235133, 7.316855970954057, 702.5323648525139, 5.601096291708557, 8.891876973616, 915.1658567302533, 3.7840537153253377, 488.88114339172, 514.5087879856974, 365.0114876277068, 821.8074939440035, 842.520569689653, 158.014679723583, 572.9699736865462, 19.34995490965471, 403.5581606748639, 944.4460814092635, 809.6706942548269, 773.8699923403536, 110.20185838569462, 98.5919563502848, 326.81086450660507, 833.0687544611426, 42.619790640279355, 192.1973346382464, 571.6697930778544, 439.5820535971901, 1041.9629319470284, 589.1846649191149, 172.24493273047295, 874.4351106895516, 813.7127464004624, 62.386981319182745, 223.5888453023487, 123.57568721556773, 428.61591644258016, 736.7756562147244, 686.4558942613535, 312.74383792505483, 1059.9589265627405, 1258.9492873253068, 880.1213141879607, 19.361396492486424, 558.4476774206996, 302.574554374833, 254.46831162847417, 979.2277469137528, 255.51673213716055, 127.56697555821557, 66.08318962039358, 1091.6454379428078, 705.4559595622103, 9.84408443626538, 840.0405513613354, 267.0081904602188, 852.4718145969987, 728.2764539216187, 459.16617816911327, 0.7235184092995441, 1001.6078222701616, 484.8971281957761, 953.006564631768, 467.99394333703816, 1084.919619455594, 488.23662048679984, 770.2293044937759, 459.1488210390772, 1045.3302256338618, 59.682392298254655, 513.8931729913884, 473.4795427265192, 91.73019839822818, 1056.5033684745738, 872.6126571196393, 771.545277613548, 487.98095627566744, 208.27165684356547, 796.9691460161304, 1215.063536710598, 1138.7125236068975, 337.1655195045534, 381.2712243157401, 531.9606230969264, 968.9126062369805, 25.8978869728041, 817.9889252004249, 1107.366330847601, 814.3318828399969, 409.43756263827817, 0.9023107683710899, 925.3406372148706, 1047.5601929999928, 538.9400207948579, 169.94739761038613, 764.139725063307, 6.228716496883488, 197.66582887599577, 788.4585382126173, 641.0705177908826, 595.9968743562689, 543.0573144645786, 760.261996448745, 1124.214173097961, 5.184388793118768, 717.9944382729027, 731.8439371940248, 4.094609568439207, 522.5653672449009, 651.3962133592751, 226.280133021367, 62.80325882161985, 135.24735788879974, 987.5110377972962, 1067.5370827150969, 92.79004522041136, 20.309691312402812, 5.831598039940642, 39.91783259907678, 944.0493968801898, 181.44675886972348, 146.08752186832652, 718.3180264947191, 57.88888886335232, 12.29658740766948, 0.0, 749.0352380589379, 898.2956653816374, 1.0755973373173793, 916.8186101403727, 995.7599707043771, 273.511611644584, 149.27212543961366, 828.3658278226497, 841.8820952788783, 861.3690391828177, 636.0567198419633, 1176.1204442971507, 695.5232333170917, 1091.1323921025507, 793.6397329101088, 1287.0587142951256, 0.885942659815168, 1192.7790794758685, 1334.4861819120827, 1086.3953476949087, 1073.6672765407861, 334.51392672080294, 1290.1249434176734, 528.3369264312364, 692.2537144774636, 506.53286655778936, 1212.9765273160158, 796.4297886466277, 1182.4063708133306, 77.15741351808822, 593.8878254141173, 1104.903084963733, 1027.054450492248, 1074.989758884814, 1604.266800583997, 1440.8197016111642, 0.0, 1373.4417720872946, 4.142265687372903, 1150.2834447788816, 1194.2956665992945, 764.3795116523324, 802.7025876306355, 1113.2295099533665, 1570.6813961374496, 969.1155963119196, 1273.465243228076, 1029.75363809305, 1025.0518898224286, 1276.713098256175, 1412.0907786431317, 1365.3016340853317, 1283.4465847737222, 1120.8335705120865, 983.5497364114573, 1092.6616278335134, 1349.4012388525136, 1466.2419875865173, 1378.8437769563275, 1068.924335338203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.978943655472017, "mean_inference_ms": 6.442120918988726, "mean_action_processing_ms": 2.3370148950746694, "mean_env_wait_ms": 16.139444015670332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019342899322509766, "StateBufferConnector_ms": 0.010522842407226562, "ViewRequirementAgentConnector_ms": 0.3152817487716675}, "num_episodes": 16, "episode_return_max": 668.2999999999997, "episode_return_min": 0.20084320761501173, "episode_return_mean": 254.1780642096414, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480960, "num_agent_steps_trained": 480960, "num_env_steps_sampled": 120240, "num_env_steps_trained": 120240, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 148.98239744195212, "num_env_steps_trained_throughput_per_sec": 148.98239744195212, "timesteps_total": 120240, "num_env_steps_sampled_lifetime": 120240, "num_agent_steps_sampled_lifetime": 480960, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 480960, "timers": {"training_iteration_time_ms": 26794.731, "restore_workers_time_ms": 0.172, "training_step_time_ms": 26793.943, "sample_time_ms": 3094.111, "learn_time_ms": 23675.488, "learn_throughput": 169.289, "synch_weights_time_ms": 20.308}, "counters": {"num_env_steps_sampled": 120240, "num_env_steps_trained": 120240, "num_agent_steps_sampled": 480960, "num_agent_steps_trained": 480960}, "done": false, "training_iteration": 30, "trial_id": "7f713_00000", "date": "2024-08-23_10-00-09", "timestamp": 1724387409, "time_this_iter_s": 26.953119039535522, "time_total_s": 808.8551321029663, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17378cdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 808.8551321029663, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 38.85, "ram_util_percent": 82.27105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.53447036730549, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.176456352516457, "policy_loss": -0.010439594143572898, "vf_loss": 8.185034450652108, "vf_explained_var": 0.52579607673423, "kl": 0.009307425026165902, "entropy": 0.9613666407014958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 28823.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.20094914259734, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.022238646108637, "policy_loss": -0.00917029211139947, "vf_loss": 8.0300714921699, "vf_explained_var": 0.3640963556274535, "kl": 0.006687133138132079, "entropy": 0.597894939102193, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 28823.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 124248, "num_env_steps_trained": 124248, "num_agent_steps_sampled": 496992, "num_agent_steps_trained": 496992}, "env_runners": {"episode_reward_max": 668.2999999999997, "episode_reward_min": 0.20084320761501173, "episode_reward_mean": 243.47204243262448, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1604.266800583997, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 375.70341259233055, "predator_policy": 1604.266800583997}, "policy_reward_mean": {"prey_policy": -571.8035168767628, "predator_policy": 693.5395380930754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [222.54889165177767, 303.96635150026674, 191.54372710740702, 118.83261397489645, 667.9009550385617, 226.21821329378227, 579.9024671491954, 328.06308966975496, 101.81440254917186, 372.9459021728395, 307.91238586369053, 201.26689905023235, 127.5580181952474, 163.58797160118667, 56.784577035701005, 367.81892955743535, 150.51725108794852, 229.31197163661247, 419.50355558919716, 306.1907800014097, 290.7757418526289, 173.43987778103914, 190.43680892858404, 568.0336728015583, 209.03849266314398, 212.63285581862132, 131.36552214738884, 124.53421320099332, 356.9673866686898, 394.3473674626494, 228.52171755807075, 378.0984067043365, 346.45285140834164, 39.39625610525704, 241.29326649716182, 332.06002997685096, 195.69022342899802, 152.41521297134312, 270.28533158242055, 286.1296488557566, 200.3556350695616, 217.20925827568144, 577.4, 179.06882849500414, 496.0161915988429, 36.08295480144898, 330.8000000000038, 402.06109795748125, 235.8616152214617, 656.7403054366971, 350.89679328625357, 128.30851987182993, 321.1000000000005, 144.0999999999984, 630.9, 503.1340641344233, 668.2999999999997, 94.09783896770361, 386.0640319439285, 377.40978166696044, 173.02683680828054, 183.8037102119468, 77.75754060615014, 195.80524815603968, 107.53412603564897, 115.01915711507733, 23.72459634014661, 228.50674403110025, 134.67795573316386, 443.86570616602745, 377.6905987734492, 267.5801501744776, 219.86623722516515, 1.379911379854743, 0.20084320761501173, 258.5681334686508, 125.70860181130755, 196.05688532729272, 259.6036476146954, 63.39976845702112, 28.956330777917636, 27.773474228883412, 206.71395493008916, 66.08658375650391, 141.6466202322916, 2.299999999999995, 243.9498330003517, 396.3640397947582, 8.515364328623644, 259.70403056654493, 284.1639284150277, 340.1708310097941, 316.0916335318144, 134.04951604569948, 189.28255759799293, 335.5917161715117, 210.12155826215826, 9.997778012332212, 3.8808038190765988, 186.05653527053073], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-558.4745188411896, -219.5118389202687, -287.0346996563557, -1.31887743957817, -260.5440598750406, -895.9164551016788, -786.820054370004, -677.8880182502794, 224.7981416143054, 234.3089986882769, -210.22219540382451, -723.4392102701397, 69.37546253452919, 275.7098793361405, -146.17445528769315, -537.0143017175972, -963.4409041925637, -565.892290124409, -252.42924053964452, -421.3049007075414, -201.25671348202636, -366.93062837392796, -194.08884530235036, 48.191211834663704, -371.4637676360478, -666.3697868260084, -25.89866443180263, -809.7130961534187, -1008.2743495270397, -1253.8492873253065, 76.27429525811394, -607.9380763811248, -490.91723632079703, -219.58774438678284, -827.7922618162081, -176.5918250894054, -148.8728891711479, 185.29273706496457, 218.03366053518087, -1069.571508096973, -423.4912884233411, -1.0330137225058351, -525.8078693595045, -407.80099468100804, -735.5846136572503, -654.7268459327829, -250.30872197089113, 358.4526981940348, -441.2834715652103, -836.1829862375849, -560.698289164504, -647.6693629856813, -629.8307680579841, -811.959949737021, -855.3421231385325, -249.5017891933268, 253.09248399826424, -1001.1377152616908, 4.503937365712156, -597.5292856209692, -342.26051487216256, -577.4513344425684, -103.87515121037526, -1162.184376818474, -139.5092733067992, -210.29048840409556, -764.5728899108738, -1208.063536710598, -607.3227104421428, -627.2620661721458, -300.8925141220266, -280.27930331378445, -325.8466208703903, -473.2736489103899, -972.3909928818077, -800.549050194874, -255.8783415529534, -697.6057723429011, -260.5488908267291, -379.5644083007533, -958.7001862800086, -427.4443924452798, -595.0735955818818, -121.80426881613002, 249.17128350311648, 124.3341711240042, -600.8871011175007, -649.5731263909953, -35.87498186212572, -607.1630153598793, -726.4574488641996, -1121.9357658810573, -48.437861413271094, -343.9409656527499, -302.4533299723081, -31.424118832673855, -183.17030221063393, -754.929663172081, 228.40113161463543, 139.2557819790748, -1031.0474285038483, 259.18582610400097, -491.0099369849244, -541.0086710787457, 18.390308687597198, 276.56840196005936, -879.8672294792666, 40.0000000000003, 176.31170565797433, 127.05401360397548, 26.007997979716002, -299.0808492033642, 375.70341259233055, 280.29999999999995, -868.269523615941, -684.9635408569266, 280.5386301152141, -812.3688056489764, -593.842871156427, -298.01892952557324, -623.7637568446399, -180.84735960933932, -497.8966961512025, -1021.5507280985466, -587.3422651801804, -1147.077358352779, -1301.0450556223416, -289.80532164126237, -693.5139482571528, -1279.6503729124347, 90.18778626777912, -1168.8336512883855, -1334.6434248207615, -1062.5135084460833, 107.57405763102209, -1287.2485168615106, -1193.7436397765682, -490.0402743391811, 41.84914404421343, -796.7700189134359, -679.7594456118023, -951.9562715773949, -1173.0833634602775, 181.09972930333592, -669.8929260183131, -809.0317471343722, -1065.9340458292345, -1034.7302521679724, -1604.266800583997, -1440.6188584035492, 258.51766656316323, -1373.391305181807, -895.6211579884788, -133.09595066646744, -1194.1864867461738, -568.4318061781602, -1306.9671357875275, -349.3613141817732, -1268.146075262068, -1208.2511487302772, -1264.3652432280758, -1009.8973073151318, -980.0427720963698, -1293.948741753348, -1132.2059667931949, -1438.4724910051773, -1252.0215349245186, -1086.172036604786, -957.0921935294833, -977.4725504831958, -1347.1012388525135, -1466.2419875865173, -811.8649107544206, -1391.953368539757, -337.5948776521533, -1268.836005075753, -850.014524082227, -1478.6601754054159, -111.57392265130278, -750.2779776612543, -198.39899751066253, -608.7316741292225, -878.396830866205, 167.5065612967733, -510.1662939441267, -874.6295482117968, -848.3463960252484, -900.7125515637906, -719.2286519483218, -312.1253694111769, -894.2300515214957, -264.7495609470833, -1251.891432937354, -996.3184951766791, -1288.4633760096985, -1336.361775828583, -1260.0227462266932, -1308.2937392159076, -1162.0843230162207, -179.9192774528517], "policy_predator_policy_reward": [842.520569689653, 158.014679723583, 572.9699736865462, 19.34995490965471, 403.5581606748639, 944.4460814092635, 809.6706942548269, 773.8699923403536, 110.20185838569462, 98.5919563502848, 326.81086450660507, 833.0687544611426, 42.619790640279355, 192.1973346382464, 571.6697930778544, 439.5820535971901, 1041.9629319470284, 589.1846649191149, 172.24493273047295, 874.4351106895516, 813.7127464004624, 62.386981319182745, 223.5888453023487, 123.57568721556773, 428.61591644258016, 736.7756562147244, 686.4558942613535, 312.74383792505483, 1059.9589265627405, 1258.9492873253068, 880.1213141879607, 19.361396492486424, 558.4476774206996, 302.574554374833, 254.46831162847417, 979.2277469137528, 255.51673213716055, 127.56697555821557, 66.08318962039358, 1091.6454379428078, 705.4559595622103, 9.84408443626538, 840.0405513613354, 267.0081904602188, 852.4718145969987, 728.2764539216187, 459.16617816911327, 0.7235184092995441, 1001.6078222701616, 484.8971281957761, 953.006564631768, 467.99394333703816, 1084.919619455594, 488.23662048679984, 770.2293044937759, 459.1488210390772, 1045.3302256338618, 59.682392298254655, 513.8931729913884, 473.4795427265192, 91.73019839822818, 1056.5033684745738, 872.6126571196393, 771.545277613548, 487.98095627566744, 208.27165684356547, 796.9691460161304, 1215.063536710598, 1138.7125236068975, 337.1655195045534, 381.2712243157401, 531.9606230969264, 968.9126062369805, 25.8978869728041, 817.9889252004249, 1107.366330847601, 814.3318828399969, 409.43756263827817, 0.9023107683710899, 925.3406372148706, 1047.5601929999928, 538.9400207948579, 169.94739761038613, 764.139725063307, 6.228716496883488, 197.66582887599577, 788.4585382126173, 641.0705177908826, 595.9968743562689, 543.0573144645786, 760.261996448745, 1124.214173097961, 5.184388793118768, 717.9944382729027, 731.8439371940248, 4.094609568439207, 522.5653672449009, 651.3962133592751, 226.280133021367, 62.80325882161985, 135.24735788879974, 987.5110377972962, 1067.5370827150969, 92.79004522041136, 20.309691312402812, 5.831598039940642, 39.91783259907678, 944.0493968801898, 181.44675886972348, 146.08752186832652, 718.3180264947191, 57.88888886335232, 12.29658740766948, 0.0, 749.0352380589379, 898.2956653816374, 1.0755973373173793, 916.8186101403727, 995.7599707043771, 273.511611644584, 149.27212543961366, 828.3658278226497, 841.8820952788783, 861.3690391828177, 636.0567198419633, 1176.1204442971507, 695.5232333170917, 1091.1323921025507, 793.6397329101088, 1287.0587142951256, 0.885942659815168, 1192.7790794758685, 1334.4861819120827, 1086.3953476949087, 1073.6672765407861, 334.51392672080294, 1290.1249434176734, 528.3369264312364, 692.2537144774636, 506.53286655778936, 1212.9765273160158, 796.4297886466277, 1182.4063708133306, 77.15741351808822, 593.8878254141173, 1104.903084963733, 1027.054450492248, 1074.989758884814, 1604.266800583997, 1440.8197016111642, 0.0, 1373.4417720872946, 4.142265687372903, 1150.2834447788816, 1194.2956665992945, 764.3795116523324, 802.7025876306355, 1113.2295099533665, 1570.6813961374496, 969.1155963119196, 1273.465243228076, 1029.75363809305, 1025.0518898224286, 1276.713098256175, 1412.0907786431317, 1365.3016340853317, 1283.4465847737222, 1120.8335705120865, 983.5497364114573, 1092.6616278335134, 1349.4012388525136, 1466.2419875865173, 1378.8437769563275, 1068.924335338203, 823.565050456178, 1179.2298720664924, 859.3022496036598, 1477.887814212607, 344.76743968465115, 776.7884911944548, 5.868378675096686, 1085.4262213798158, 88.12836782512457, 962.9327327541005, 843.0040659409012, 857.8834097468407, 971.7422690222592, 911.3661946124802, 1186.730973105699, 33.90560585179279, 896.248282070415, 598.3230465696741, 1250.137175184871, 1208.1943111913224, 1314.2356149738425, 1320.5873148767716, 1262.705393136078, 1309.4918961255992, 929.3241411630039, 598.7359945765987]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.857631476721117, "mean_inference_ms": 6.4701390129897005, "mean_action_processing_ms": 2.3340485457882263, "mean_env_wait_ms": 16.19148785427465, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0191652774810791, "StateBufferConnector_ms": 0.010484457015991211, "ViewRequirementAgentConnector_ms": 0.2820471525192261}, "num_episodes": 13, "episode_return_max": 668.2999999999997, "episode_return_min": 0.20084320761501173, "episode_return_mean": 243.47204243262448, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496992, "num_agent_steps_trained": 496992, "num_env_steps_sampled": 124248, "num_env_steps_trained": 124248, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 151.40702496399183, "num_env_steps_trained_throughput_per_sec": 151.40702496399183, "timesteps_total": 124248, "num_env_steps_sampled_lifetime": 124248, "num_agent_steps_sampled_lifetime": 496992, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 496992, "timers": {"training_iteration_time_ms": 26770.327, "restore_workers_time_ms": 0.173, "training_step_time_ms": 26769.698, "sample_time_ms": 3036.1, "learn_time_ms": 23710.212, "learn_throughput": 169.041, "synch_weights_time_ms": 19.442}, "counters": {"num_env_steps_sampled": 124248, "num_env_steps_trained": 124248, "num_agent_steps_sampled": 496992, "num_agent_steps_trained": 496992}, "done": false, "training_iteration": 31, "trial_id": "7f713_00000", "date": "2024-08-23_10-00-36", "timestamp": 1724387436, "time_this_iter_s": 26.51014804840088, "time_total_s": 835.3652801513672, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x173753c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 835.3652801513672, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 37.55945945945947, "ram_util_percent": 81.7891891891892}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.471920077762906, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.05359654552722, "policy_loss": -0.01002477209068953, "vf_loss": 8.061890713626115, "vf_explained_var": 0.509265562403139, "kl": 0.00865311593817616, "entropy": 0.9930360392287926, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 29768.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.618497090617184, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.028851624645254, "policy_loss": -0.009046558526260828, "vf_loss": 8.03649922880546, "vf_explained_var": 0.3719984559785752, "kl": 0.006994710046127833, "entropy": 0.6245626841903363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 29768.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 128256, "num_env_steps_trained": 128256, "num_agent_steps_sampled": 513024, "num_agent_steps_trained": 513024}, "env_runners": {"episode_reward_max": 668.2999999999997, "episode_reward_min": 0.20084320761501173, "episode_reward_mean": 232.48988566943882, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1604.266800583997, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 375.70341259233055, "predator_policy": 1604.266800583997}, "policy_reward_mean": {"prey_policy": -646.2248097843815, "predator_policy": 762.4697526191013}, "custom_metrics": {}, "hist_stats": {"episode_reward": [163.58797160118667, 56.784577035701005, 367.81892955743535, 150.51725108794852, 229.31197163661247, 419.50355558919716, 306.1907800014097, 290.7757418526289, 173.43987778103914, 190.43680892858404, 568.0336728015583, 209.03849266314398, 212.63285581862132, 131.36552214738884, 124.53421320099332, 356.9673866686898, 394.3473674626494, 228.52171755807075, 378.0984067043365, 346.45285140834164, 39.39625610525704, 241.29326649716182, 332.06002997685096, 195.69022342899802, 152.41521297134312, 270.28533158242055, 286.1296488557566, 200.3556350695616, 217.20925827568144, 577.4, 179.06882849500414, 496.0161915988429, 36.08295480144898, 330.8000000000038, 402.06109795748125, 235.8616152214617, 656.7403054366971, 350.89679328625357, 128.30851987182993, 321.1000000000005, 144.0999999999984, 630.9, 503.1340641344233, 668.2999999999997, 94.09783896770361, 386.0640319439285, 377.40978166696044, 173.02683680828054, 183.8037102119468, 77.75754060615014, 195.80524815603968, 107.53412603564897, 115.01915711507733, 23.72459634014661, 228.50674403110025, 134.67795573316386, 443.86570616602745, 377.6905987734492, 267.5801501744776, 219.86623722516515, 1.379911379854743, 0.20084320761501173, 258.5681334686508, 125.70860181130755, 196.05688532729272, 259.6036476146954, 63.39976845702112, 28.956330777917636, 27.773474228883412, 206.71395493008916, 66.08658375650391, 141.6466202322916, 2.299999999999995, 243.9498330003517, 396.3640397947582, 8.515364328623644, 259.70403056654493, 284.1639284150277, 340.1708310097941, 316.0916335318144, 134.04951604569948, 189.28255759799293, 335.5917161715117, 210.12155826215826, 9.997778012332212, 3.8808038190765988, 186.05653527053073, 136.7417868383303, 385.7540797087853, 193.41440310426452, 255.76522426475012, 154.3252719554891, 182.44929949581208, 192.2499191406796, 424.8759303246241, 116.44266605545852, 131.32534692022438, 66.76928384530245, 343.57076697537644, 68.57426226916672], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-25.89866443180263, -809.7130961534187, -1008.2743495270397, -1253.8492873253065, 76.27429525811394, -607.9380763811248, -490.91723632079703, -219.58774438678284, -827.7922618162081, -176.5918250894054, -148.8728891711479, 185.29273706496457, 218.03366053518087, -1069.571508096973, -423.4912884233411, -1.0330137225058351, -525.8078693595045, -407.80099468100804, -735.5846136572503, -654.7268459327829, -250.30872197089113, 358.4526981940348, -441.2834715652103, -836.1829862375849, -560.698289164504, -647.6693629856813, -629.8307680579841, -811.959949737021, -855.3421231385325, -249.5017891933268, 253.09248399826424, -1001.1377152616908, 4.503937365712156, -597.5292856209692, -342.26051487216256, -577.4513344425684, -103.87515121037526, -1162.184376818474, -139.5092733067992, -210.29048840409556, -764.5728899108738, -1208.063536710598, -607.3227104421428, -627.2620661721458, -300.8925141220266, -280.27930331378445, -325.8466208703903, -473.2736489103899, -972.3909928818077, -800.549050194874, -255.8783415529534, -697.6057723429011, -260.5488908267291, -379.5644083007533, -958.7001862800086, -427.4443924452798, -595.0735955818818, -121.80426881613002, 249.17128350311648, 124.3341711240042, -600.8871011175007, -649.5731263909953, -35.87498186212572, -607.1630153598793, -726.4574488641996, -1121.9357658810573, -48.437861413271094, -343.9409656527499, -302.4533299723081, -31.424118832673855, -183.17030221063393, -754.929663172081, 228.40113161463543, 139.2557819790748, -1031.0474285038483, 259.18582610400097, -491.0099369849244, -541.0086710787457, 18.390308687597198, 276.56840196005936, -879.8672294792666, 40.0000000000003, 176.31170565797433, 127.05401360397548, 26.007997979716002, -299.0808492033642, 375.70341259233055, 280.29999999999995, -868.269523615941, -684.9635408569266, 280.5386301152141, -812.3688056489764, -593.842871156427, -298.01892952557324, -623.7637568446399, -180.84735960933932, -497.8966961512025, -1021.5507280985466, -587.3422651801804, -1147.077358352779, -1301.0450556223416, -289.80532164126237, -693.5139482571528, -1279.6503729124347, 90.18778626777912, -1168.8336512883855, -1334.6434248207615, -1062.5135084460833, 107.57405763102209, -1287.2485168615106, -1193.7436397765682, -490.0402743391811, 41.84914404421343, -796.7700189134359, -679.7594456118023, -951.9562715773949, -1173.0833634602775, 181.09972930333592, -669.8929260183131, -809.0317471343722, -1065.9340458292345, -1034.7302521679724, -1604.266800583997, -1440.6188584035492, 258.51766656316323, -1373.391305181807, -895.6211579884788, -133.09595066646744, -1194.1864867461738, -568.4318061781602, -1306.9671357875275, -349.3613141817732, -1268.146075262068, -1208.2511487302772, -1264.3652432280758, -1009.8973073151318, -980.0427720963698, -1293.948741753348, -1132.2059667931949, -1438.4724910051773, -1252.0215349245186, -1086.172036604786, -957.0921935294833, -977.4725504831958, -1347.1012388525135, -1466.2419875865173, -811.8649107544206, -1391.953368539757, -337.5948776521533, -1268.836005075753, -850.014524082227, -1478.6601754054159, -111.57392265130278, -750.2779776612543, -198.39899751066253, -608.7316741292225, -878.396830866205, 167.5065612967733, -510.1662939441267, -874.6295482117968, -848.3463960252484, -900.7125515637906, -719.2286519483218, -312.1253694111769, -894.2300515214957, -264.7495609470833, -1251.891432937354, -996.3184951766791, -1288.4633760096985, -1336.361775828583, -1260.0227462266932, -1308.2937392159076, -1162.0843230162207, -179.9192774528517, -1354.3680533653378, -1098.5317344085336, -1182.6995458223978, -400.7608897918373, -913.7694467990996, -137.2599025836671, -1313.5508144695316, 132.4104871716217, -1255.7996571676806, -1195.5148943868328, -1152.8346953341872, -1294.5951385627195, -1359.6585265176618, 184.77333544546138, -1023.056086525308, -668.5851623842287, -376.8360747804394, -1034.2215235490912, -817.7511833091105, -965.3245910595349, -1067.878970409875, -1043.209814769419, -672.5266489015742, -1072.1441138200203, -853.3104784047267, -1402.4065253282556], "policy_predator_policy_reward": [686.4558942613535, 312.74383792505483, 1059.9589265627405, 1258.9492873253068, 880.1213141879607, 19.361396492486424, 558.4476774206996, 302.574554374833, 254.46831162847417, 979.2277469137528, 255.51673213716055, 127.56697555821557, 66.08318962039358, 1091.6454379428078, 705.4559595622103, 9.84408443626538, 840.0405513613354, 267.0081904602188, 852.4718145969987, 728.2764539216187, 459.16617816911327, 0.7235184092995441, 1001.6078222701616, 484.8971281957761, 953.006564631768, 467.99394333703816, 1084.919619455594, 488.23662048679984, 770.2293044937759, 459.1488210390772, 1045.3302256338618, 59.682392298254655, 513.8931729913884, 473.4795427265192, 91.73019839822818, 1056.5033684745738, 872.6126571196393, 771.545277613548, 487.98095627566744, 208.27165684356547, 796.9691460161304, 1215.063536710598, 1138.7125236068975, 337.1655195045534, 381.2712243157401, 531.9606230969264, 968.9126062369805, 25.8978869728041, 817.9889252004249, 1107.366330847601, 814.3318828399969, 409.43756263827817, 0.9023107683710899, 925.3406372148706, 1047.5601929999928, 538.9400207948579, 169.94739761038613, 764.139725063307, 6.228716496883488, 197.66582887599577, 788.4585382126173, 641.0705177908826, 595.9968743562689, 543.0573144645786, 760.261996448745, 1124.214173097961, 5.184388793118768, 717.9944382729027, 731.8439371940248, 4.094609568439207, 522.5653672449009, 651.3962133592751, 226.280133021367, 62.80325882161985, 135.24735788879974, 987.5110377972962, 1067.5370827150969, 92.79004522041136, 20.309691312402812, 5.831598039940642, 39.91783259907678, 944.0493968801898, 181.44675886972348, 146.08752186832652, 718.3180264947191, 57.88888886335232, 12.29658740766948, 0.0, 749.0352380589379, 898.2956653816374, 1.0755973373173793, 916.8186101403727, 995.7599707043771, 273.511611644584, 149.27212543961366, 828.3658278226497, 841.8820952788783, 861.3690391828177, 636.0567198419633, 1176.1204442971507, 695.5232333170917, 1091.1323921025507, 793.6397329101088, 1287.0587142951256, 0.885942659815168, 1192.7790794758685, 1334.4861819120827, 1086.3953476949087, 1073.6672765407861, 334.51392672080294, 1290.1249434176734, 528.3369264312364, 692.2537144774636, 506.53286655778936, 1212.9765273160158, 796.4297886466277, 1182.4063708133306, 77.15741351808822, 593.8878254141173, 1104.903084963733, 1027.054450492248, 1074.989758884814, 1604.266800583997, 1440.8197016111642, 0.0, 1373.4417720872946, 4.142265687372903, 1150.2834447788816, 1194.2956665992945, 764.3795116523324, 802.7025876306355, 1113.2295099533665, 1570.6813961374496, 969.1155963119196, 1273.465243228076, 1029.75363809305, 1025.0518898224286, 1276.713098256175, 1412.0907786431317, 1365.3016340853317, 1283.4465847737222, 1120.8335705120865, 983.5497364114573, 1092.6616278335134, 1349.4012388525136, 1466.2419875865173, 1378.8437769563275, 1068.924335338203, 823.565050456178, 1179.2298720664924, 859.3022496036598, 1477.887814212607, 344.76743968465115, 776.7884911944548, 5.868378675096686, 1085.4262213798158, 88.12836782512457, 962.9327327541005, 843.0040659409012, 857.8834097468407, 971.7422690222592, 911.3661946124802, 1186.730973105699, 33.90560585179279, 896.248282070415, 598.3230465696741, 1250.137175184871, 1208.1943111913224, 1314.2356149738425, 1320.5873148767716, 1262.705393136078, 1309.4918961255992, 929.3241411630039, 598.7359945765987, 1172.6575210982953, 1416.9840535139074, 1113.773376666058, 855.441138656972, 1160.5695221922185, 83.87423029481434, 1372.546875586466, 64.35867597619253, 1243.2446953271078, 1362.395128182894, 1372.1589613954318, 1257.7201719972888, 1360.6282248236005, 6.506885389279751, 1174.38359864627, 942.133580587891, 482.7531700080627, 1044.7470943769342, 966.9115473541912, 947.4895739346786, 1130.9990588943615, 1046.859010130235, 925.0261842237965, 1163.215345473178, 922.5593943887835, 1401.7318716133664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.857143175659838, "mean_inference_ms": 6.45096964252217, "mean_action_processing_ms": 2.2745278922066663, "mean_env_wait_ms": 16.266557734363122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018127918243408203, "StateBufferConnector_ms": 0.007417798042297363, "ViewRequirementAgentConnector_ms": 0.2365328073501587}, "num_episodes": 13, "episode_return_max": 668.2999999999997, "episode_return_min": 0.20084320761501173, "episode_return_mean": 232.48988566943882, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 513024, "num_agent_steps_trained": 513024, "num_env_steps_sampled": 128256, "num_env_steps_trained": 128256, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 148.4157681162962, "num_env_steps_trained_throughput_per_sec": 148.4157681162962, "timesteps_total": 128256, "num_env_steps_sampled_lifetime": 128256, "num_agent_steps_sampled_lifetime": 513024, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 513024, "timers": {"training_iteration_time_ms": 26643.743, "restore_workers_time_ms": 0.161, "training_step_time_ms": 26643.124, "sample_time_ms": 2836.463, "learn_time_ms": 23780.908, "learn_throughput": 168.539, "synch_weights_time_ms": 21.743}, "counters": {"num_env_steps_sampled": 128256, "num_env_steps_trained": 128256, "num_agent_steps_sampled": 513024, "num_agent_steps_trained": 513024}, "done": false, "training_iteration": 32, "trial_id": "7f713_00000", "date": "2024-08-23_10-01-03", "timestamp": 1724387463, "time_this_iter_s": 27.093219995498657, "time_total_s": 862.4585001468658, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737c1280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 862.4585001468658, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 43.66842105263157, "ram_util_percent": 82.07631578947368}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.68515926214753, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.199148779571372, "policy_loss": -0.010744377766984082, "vf_loss": 8.208051623490752, "vf_explained_var": 0.5577237144979851, "kl": 0.009207572033086782, "entropy": 0.9428629183264636, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 30713.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.016668792124149, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.160071182250977, "policy_loss": -0.007823340350111563, "vf_loss": 8.16644411238413, "vf_explained_var": 0.37349441019946306, "kl": 0.007251981789093445, "entropy": 0.5817053529005202, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 30713.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 132264, "num_env_steps_trained": 132264, "num_agent_steps_sampled": 529056, "num_agent_steps_trained": 529056}, "env_runners": {"episode_reward_max": 668.2999999999997, "episode_reward_min": 0.20084320761501173, "episode_reward_mean": 217.1516097028881, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1604.266800583997, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 375.70341259233055, "predator_policy": 1604.266800583997}, "policy_reward_mean": {"prey_policy": -722.7755593334743, "predator_policy": 831.3513641849188}, "custom_metrics": {}, "hist_stats": {"episode_reward": [228.52171755807075, 378.0984067043365, 346.45285140834164, 39.39625610525704, 241.29326649716182, 332.06002997685096, 195.69022342899802, 152.41521297134312, 270.28533158242055, 286.1296488557566, 200.3556350695616, 217.20925827568144, 577.4, 179.06882849500414, 496.0161915988429, 36.08295480144898, 330.8000000000038, 402.06109795748125, 235.8616152214617, 656.7403054366971, 350.89679328625357, 128.30851987182993, 321.1000000000005, 144.0999999999984, 630.9, 503.1340641344233, 668.2999999999997, 94.09783896770361, 386.0640319439285, 377.40978166696044, 173.02683680828054, 183.8037102119468, 77.75754060615014, 195.80524815603968, 107.53412603564897, 115.01915711507733, 23.72459634014661, 228.50674403110025, 134.67795573316386, 443.86570616602745, 377.6905987734492, 267.5801501744776, 219.86623722516515, 1.379911379854743, 0.20084320761501173, 258.5681334686508, 125.70860181130755, 196.05688532729272, 259.6036476146954, 63.39976845702112, 28.956330777917636, 27.773474228883412, 206.71395493008916, 66.08658375650391, 141.6466202322916, 2.299999999999995, 243.9498330003517, 396.3640397947582, 8.515364328623644, 259.70403056654493, 284.1639284150277, 340.1708310097941, 316.0916335318144, 134.04951604569948, 189.28255759799293, 335.5917161715117, 210.12155826215826, 9.997778012332212, 3.8808038190765988, 186.05653527053073, 136.7417868383303, 385.7540797087853, 193.41440310426452, 255.76522426475012, 154.3252719554891, 182.44929949581208, 192.2499191406796, 424.8759303246241, 116.44266605545852, 131.32534692022438, 66.76928384530245, 343.57076697537644, 68.57426226916672, 231.41234028582537, 366.94582902171226, 74.10482612826623, 214.0999999999969, 105.98396687235888, 355.8122949420211, 172.60500214160416, 455.2835051018787, 8.691233719273008, 49.48136244447405, 209.28178436880282, 1.4729535251892854, 242.94574904693755, 207.86080807768928, 1.0299146853448242, 114.16603409513846, 0.2817747232018015], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-342.26051487216256, -577.4513344425684, -103.87515121037526, -1162.184376818474, -139.5092733067992, -210.29048840409556, -764.5728899108738, -1208.063536710598, -607.3227104421428, -627.2620661721458, -300.8925141220266, -280.27930331378445, -325.8466208703903, -473.2736489103899, -972.3909928818077, -800.549050194874, -255.8783415529534, -697.6057723429011, -260.5488908267291, -379.5644083007533, -958.7001862800086, -427.4443924452798, -595.0735955818818, -121.80426881613002, 249.17128350311648, 124.3341711240042, -600.8871011175007, -649.5731263909953, -35.87498186212572, -607.1630153598793, -726.4574488641996, -1121.9357658810573, -48.437861413271094, -343.9409656527499, -302.4533299723081, -31.424118832673855, -183.17030221063393, -754.929663172081, 228.40113161463543, 139.2557819790748, -1031.0474285038483, 259.18582610400097, -491.0099369849244, -541.0086710787457, 18.390308687597198, 276.56840196005936, -879.8672294792666, 40.0000000000003, 176.31170565797433, 127.05401360397548, 26.007997979716002, -299.0808492033642, 375.70341259233055, 280.29999999999995, -868.269523615941, -684.9635408569266, 280.5386301152141, -812.3688056489764, -593.842871156427, -298.01892952557324, -623.7637568446399, -180.84735960933932, -497.8966961512025, -1021.5507280985466, -587.3422651801804, -1147.077358352779, -1301.0450556223416, -289.80532164126237, -693.5139482571528, -1279.6503729124347, 90.18778626777912, -1168.8336512883855, -1334.6434248207615, -1062.5135084460833, 107.57405763102209, -1287.2485168615106, -1193.7436397765682, -490.0402743391811, 41.84914404421343, -796.7700189134359, -679.7594456118023, -951.9562715773949, -1173.0833634602775, 181.09972930333592, -669.8929260183131, -809.0317471343722, -1065.9340458292345, -1034.7302521679724, -1604.266800583997, -1440.6188584035492, 258.51766656316323, -1373.391305181807, -895.6211579884788, -133.09595066646744, -1194.1864867461738, -568.4318061781602, -1306.9671357875275, -349.3613141817732, -1268.146075262068, -1208.2511487302772, -1264.3652432280758, -1009.8973073151318, -980.0427720963698, -1293.948741753348, -1132.2059667931949, -1438.4724910051773, -1252.0215349245186, -1086.172036604786, -957.0921935294833, -977.4725504831958, -1347.1012388525135, -1466.2419875865173, -811.8649107544206, -1391.953368539757, -337.5948776521533, -1268.836005075753, -850.014524082227, -1478.6601754054159, -111.57392265130278, -750.2779776612543, -198.39899751066253, -608.7316741292225, -878.396830866205, 167.5065612967733, -510.1662939441267, -874.6295482117968, -848.3463960252484, -900.7125515637906, -719.2286519483218, -312.1253694111769, -894.2300515214957, -264.7495609470833, -1251.891432937354, -996.3184951766791, -1288.4633760096985, -1336.361775828583, -1260.0227462266932, -1308.2937392159076, -1162.0843230162207, -179.9192774528517, -1354.3680533653378, -1098.5317344085336, -1182.6995458223978, -400.7608897918373, -913.7694467990996, -137.2599025836671, -1313.5508144695316, 132.4104871716217, -1255.7996571676806, -1195.5148943868328, -1152.8346953341872, -1294.5951385627195, -1359.6585265176618, 184.77333544546138, -1023.056086525308, -668.5851623842287, -376.8360747804394, -1034.2215235490912, -817.7511833091105, -965.3245910595349, -1067.878970409875, -1043.209814769419, -672.5266489015742, -1072.1441138200203, -853.3104784047267, -1402.4065253282556, -493.7371918334678, -583.7470339407499, -265.5573228619532, -1174.1035218410761, -1183.4940214374299, -1406.3421249627047, 155.2721824408259, 39.0713244102931, -965.1105490295781, -1371.3858733562486, -314.55964606839507, -85.83519806533687, -911.9782622390823, -332.5782018233436, 38.99179705481094, -1152.6102805154785, -1208.4160769490427, -1306.0832767587294, -645.1081304345352, -1312.756246199961, -1141.9145745604696, -1362.6230811874204, -1291.5981259390826, -1388.411309227952, -952.4620046947576, -106.22174525680617, -1110.692276054226, -1360.3012647609987, -1339.0141278824055, -1280.7238866819193, -1204.0693001047478, -1132.267547206779, -1083.4938436202012, -1249.5353832231453], "policy_predator_policy_reward": [91.73019839822818, 1056.5033684745738, 872.6126571196393, 771.545277613548, 487.98095627566744, 208.27165684356547, 796.9691460161304, 1215.063536710598, 1138.7125236068975, 337.1655195045534, 381.2712243157401, 531.9606230969264, 968.9126062369805, 25.8978869728041, 817.9889252004249, 1107.366330847601, 814.3318828399969, 409.43756263827817, 0.9023107683710899, 925.3406372148706, 1047.5601929999928, 538.9400207948579, 169.94739761038613, 764.139725063307, 6.228716496883488, 197.66582887599577, 788.4585382126173, 641.0705177908826, 595.9968743562689, 543.0573144645786, 760.261996448745, 1124.214173097961, 5.184388793118768, 717.9944382729027, 731.8439371940248, 4.094609568439207, 522.5653672449009, 651.3962133592751, 226.280133021367, 62.80325882161985, 135.24735788879974, 987.5110377972962, 1067.5370827150969, 92.79004522041136, 20.309691312402812, 5.831598039940642, 39.91783259907678, 944.0493968801898, 181.44675886972348, 146.08752186832652, 718.3180264947191, 57.88888886335232, 12.29658740766948, 0.0, 749.0352380589379, 898.2956653816374, 1.0755973373173793, 916.8186101403727, 995.7599707043771, 273.511611644584, 149.27212543961366, 828.3658278226497, 841.8820952788783, 861.3690391828177, 636.0567198419633, 1176.1204442971507, 695.5232333170917, 1091.1323921025507, 793.6397329101088, 1287.0587142951256, 0.885942659815168, 1192.7790794758685, 1334.4861819120827, 1086.3953476949087, 1073.6672765407861, 334.51392672080294, 1290.1249434176734, 528.3369264312364, 692.2537144774636, 506.53286655778936, 1212.9765273160158, 796.4297886466277, 1182.4063708133306, 77.15741351808822, 593.8878254141173, 1104.903084963733, 1027.054450492248, 1074.989758884814, 1604.266800583997, 1440.8197016111642, 0.0, 1373.4417720872946, 4.142265687372903, 1150.2834447788816, 1194.2956665992945, 764.3795116523324, 802.7025876306355, 1113.2295099533665, 1570.6813961374496, 969.1155963119196, 1273.465243228076, 1029.75363809305, 1025.0518898224286, 1276.713098256175, 1412.0907786431317, 1365.3016340853317, 1283.4465847737222, 1120.8335705120865, 983.5497364114573, 1092.6616278335134, 1349.4012388525136, 1466.2419875865173, 1378.8437769563275, 1068.924335338203, 823.565050456178, 1179.2298720664924, 859.3022496036598, 1477.887814212607, 344.76743968465115, 776.7884911944548, 5.868378675096686, 1085.4262213798158, 88.12836782512457, 962.9327327541005, 843.0040659409012, 857.8834097468407, 971.7422690222592, 911.3661946124802, 1186.730973105699, 33.90560585179279, 896.248282070415, 598.3230465696741, 1250.137175184871, 1208.1943111913224, 1314.2356149738425, 1320.5873148767716, 1262.705393136078, 1309.4918961255992, 929.3241411630039, 598.7359945765987, 1172.6575210982953, 1416.9840535139074, 1113.773376666058, 855.441138656972, 1160.5695221922185, 83.87423029481434, 1372.546875586466, 64.35867597619253, 1243.2446953271078, 1362.395128182894, 1372.1589613954318, 1257.7201719972888, 1360.6282248236005, 6.506885389279751, 1174.38359864627, 942.133580587891, 482.7531700080627, 1044.7470943769342, 966.9115473541912, 947.4895739346786, 1130.9990588943615, 1046.859010130235, 925.0261842237965, 1163.215345473178, 922.5593943887835, 1401.7318716133664, 665.2063799973544, 643.6901860626936, 1140.737859934178, 665.8688137905641, 1388.7489816877128, 1275.191990840688, 1.0971933913484455, 18.65929975753144, 1349.4468242921514, 1093.033564966036, 756.2071390757502, 0.0, 4.139602951821638, 1413.0218632522067, 707.1485086074099, 861.7534799551283, 1208.4160769490427, 1314.7745104780026, 1292.6043982615224, 714.7413408174478, 1372.123376022268, 1341.6960640944255, 1291.8949717795122, 1389.587416912712, 0.0, 1301.6294989985004, 1352.8919570414932, 1325.9623918514203, 1232.4550401364422, 1388.312889113229, 1233.1898514903046, 1217.3130299163597, 1083.893843620201, 1249.4171579463473]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.855321605684047, "mean_inference_ms": 6.574450407790437, "mean_action_processing_ms": 2.3263364967208764, "mean_env_wait_ms": 16.3868928727736, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029452800750732422, "StateBufferConnector_ms": 0.009573101997375488, "ViewRequirementAgentConnector_ms": 0.24554717540740967}, "num_episodes": 17, "episode_return_max": 668.2999999999997, "episode_return_min": 0.20084320761501173, "episode_return_mean": 217.1516097028881, "episodes_this_iter": 17}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 529056, "num_agent_steps_trained": 529056, "num_env_steps_sampled": 132264, "num_env_steps_trained": 132264, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 119.1607370932614, "num_env_steps_trained_throughput_per_sec": 119.1607370932614, "timesteps_total": 132264, "num_env_steps_sampled_lifetime": 132264, "num_agent_steps_sampled_lifetime": 529056, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 529056, "timers": {"training_iteration_time_ms": 27363.742, "restore_workers_time_ms": 0.169, "training_step_time_ms": 27363.129, "sample_time_ms": 3569.198, "learn_time_ms": 23762.179, "learn_throughput": 168.671, "synch_weights_time_ms": 27.183}, "counters": {"num_env_steps_sampled": 132264, "num_env_steps_trained": 132264, "num_agent_steps_sampled": 529056, "num_agent_steps_trained": 529056}, "done": false, "training_iteration": 33, "trial_id": "7f713_00000", "date": "2024-08-23_10-01-37", "timestamp": 1724387497, "time_this_iter_s": 33.67337703704834, "time_total_s": 896.1318771839142, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30f7c7700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 896.1318771839142, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 54.022916666666674, "ram_util_percent": 83.2375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.41632811341967, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.50832959987499, "policy_loss": -0.012347143302085223, "vf_loss": 8.518452535861384, "vf_explained_var": 0.4562233643557029, "kl": 0.011121109169390466, "entropy": 0.9064958795668587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 31658.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.368376123842108, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.483611608434606, "policy_loss": -0.00985060159028286, "vf_loss": 8.491958724127876, "vf_explained_var": 0.26398094400526984, "kl": 0.007517456840575924, "entropy": 0.5364261851739631, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 31658.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 136272, "num_env_steps_trained": 136272, "num_agent_steps_sampled": 545088, "num_agent_steps_trained": 545088}, "env_runners": {"episode_reward_max": 668.2999999999997, "episode_reward_min": 4.440892098500626e-16, "episode_reward_mean": 198.10275304247534, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1604.266800583997, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 375.70341259233055, "predator_policy": 1604.266800583997}, "policy_reward_mean": {"prey_policy": -819.8715906871081, "predator_policy": 918.9229672083462}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.89679328625357, 128.30851987182993, 321.1000000000005, 144.0999999999984, 630.9, 503.1340641344233, 668.2999999999997, 94.09783896770361, 386.0640319439285, 377.40978166696044, 173.02683680828054, 183.8037102119468, 77.75754060615014, 195.80524815603968, 107.53412603564897, 115.01915711507733, 23.72459634014661, 228.50674403110025, 134.67795573316386, 443.86570616602745, 377.6905987734492, 267.5801501744776, 219.86623722516515, 1.379911379854743, 0.20084320761501173, 258.5681334686508, 125.70860181130755, 196.05688532729272, 259.6036476146954, 63.39976845702112, 28.956330777917636, 27.773474228883412, 206.71395493008916, 66.08658375650391, 141.6466202322916, 2.299999999999995, 243.9498330003517, 396.3640397947582, 8.515364328623644, 259.70403056654493, 284.1639284150277, 340.1708310097941, 316.0916335318144, 134.04951604569948, 189.28255759799293, 335.5917161715117, 210.12155826215826, 9.997778012332212, 3.8808038190765988, 186.05653527053073, 136.7417868383303, 385.7540797087853, 193.41440310426452, 255.76522426475012, 154.3252719554891, 182.44929949581208, 192.2499191406796, 424.8759303246241, 116.44266605545852, 131.32534692022438, 66.76928384530245, 343.57076697537644, 68.57426226916672, 231.41234028582537, 366.94582902171226, 74.10482612826623, 214.0999999999969, 105.98396687235888, 355.8122949420211, 172.60500214160416, 455.2835051018787, 8.691233719273008, 49.48136244447405, 209.28178436880282, 1.4729535251892854, 242.94574904693755, 207.86080807768928, 1.0299146853448242, 114.16603409513846, 0.2817747232018015, 4.440892098500626e-16, 223.20024622544082, 561.8621032953702, 1.8579913884724861, 86.06815140976346, 171.86869433708063, 100.34547077793738, 176.46864342159597, 376.52405610613613, 368.9214971258995, 2.0192058749261736, 87.06747473349745, 446.9839977945975, 341.50551570454945, 96.82055475172663, 16.667732746466733, 254.99777907295316, 505.54519769725005, 0.4999999999999927, 77.82885343978054], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1031.0474285038483, 259.18582610400097, -491.0099369849244, -541.0086710787457, 18.390308687597198, 276.56840196005936, -879.8672294792666, 40.0000000000003, 176.31170565797433, 127.05401360397548, 26.007997979716002, -299.0808492033642, 375.70341259233055, 280.29999999999995, -868.269523615941, -684.9635408569266, 280.5386301152141, -812.3688056489764, -593.842871156427, -298.01892952557324, -623.7637568446399, -180.84735960933932, -497.8966961512025, -1021.5507280985466, -587.3422651801804, -1147.077358352779, -1301.0450556223416, -289.80532164126237, -693.5139482571528, -1279.6503729124347, 90.18778626777912, -1168.8336512883855, -1334.6434248207615, -1062.5135084460833, 107.57405763102209, -1287.2485168615106, -1193.7436397765682, -490.0402743391811, 41.84914404421343, -796.7700189134359, -679.7594456118023, -951.9562715773949, -1173.0833634602775, 181.09972930333592, -669.8929260183131, -809.0317471343722, -1065.9340458292345, -1034.7302521679724, -1604.266800583997, -1440.6188584035492, 258.51766656316323, -1373.391305181807, -895.6211579884788, -133.09595066646744, -1194.1864867461738, -568.4318061781602, -1306.9671357875275, -349.3613141817732, -1268.146075262068, -1208.2511487302772, -1264.3652432280758, -1009.8973073151318, -980.0427720963698, -1293.948741753348, -1132.2059667931949, -1438.4724910051773, -1252.0215349245186, -1086.172036604786, -957.0921935294833, -977.4725504831958, -1347.1012388525135, -1466.2419875865173, -811.8649107544206, -1391.953368539757, -337.5948776521533, -1268.836005075753, -850.014524082227, -1478.6601754054159, -111.57392265130278, -750.2779776612543, -198.39899751066253, -608.7316741292225, -878.396830866205, 167.5065612967733, -510.1662939441267, -874.6295482117968, -848.3463960252484, -900.7125515637906, -719.2286519483218, -312.1253694111769, -894.2300515214957, -264.7495609470833, -1251.891432937354, -996.3184951766791, -1288.4633760096985, -1336.361775828583, -1260.0227462266932, -1308.2937392159076, -1162.0843230162207, -179.9192774528517, -1354.3680533653378, -1098.5317344085336, -1182.6995458223978, -400.7608897918373, -913.7694467990996, -137.2599025836671, -1313.5508144695316, 132.4104871716217, -1255.7996571676806, -1195.5148943868328, -1152.8346953341872, -1294.5951385627195, -1359.6585265176618, 184.77333544546138, -1023.056086525308, -668.5851623842287, -376.8360747804394, -1034.2215235490912, -817.7511833091105, -965.3245910595349, -1067.878970409875, -1043.209814769419, -672.5266489015742, -1072.1441138200203, -853.3104784047267, -1402.4065253282556, -493.7371918334678, -583.7470339407499, -265.5573228619532, -1174.1035218410761, -1183.4940214374299, -1406.3421249627047, 155.2721824408259, 39.0713244102931, -965.1105490295781, -1371.3858733562486, -314.55964606839507, -85.83519806533687, -911.9782622390823, -332.5782018233436, 38.99179705481094, -1152.6102805154785, -1208.4160769490427, -1306.0832767587294, -645.1081304345352, -1312.756246199961, -1141.9145745604696, -1362.6230811874204, -1291.5981259390826, -1388.411309227952, -952.4620046947576, -106.22174525680617, -1110.692276054226, -1360.3012647609987, -1339.0141278824055, -1280.7238866819193, -1204.0693001047478, -1132.267547206779, -1083.4938436202012, -1249.5353832231453, -1370.1766573548452, -1344.22842648208, -113.50006043756419, -708.702591013963, 159.0476960190514, -1288.5946182135337, -1415.6184293587296, -1514.907459471273, -1023.8923104190754, -966.6254142216225, -852.1096472048399, -1356.5742089554249, -692.3701397687801, -1176.673493031536, -310.7585596814868, -1414.0745828265808, -988.0369099020268, 272.33349012842467, -411.07628777989163, -827.7240954128065, -1428.8388501488998, -1453.0676230421795, -1124.2559545905276, -1107.3491178367337, -47.595892335147525, -947.532007631226, -523.4402344319883, -218.71609659637988, -1466.5476196942775, -519.5689621550997, -1148.7463393084618, -1518.3318803572338, -947.6907692197715, -688.0715374589587, -452.59525366104805, -739.029762525562, -1412.781041794, -1443.8725093342885, -1222.0644828182942, -922.5772716368814], "policy_predator_policy_reward": [135.24735788879974, 987.5110377972962, 1067.5370827150969, 92.79004522041136, 20.309691312402812, 5.831598039940642, 39.91783259907678, 944.0493968801898, 181.44675886972348, 146.08752186832652, 718.3180264947191, 57.88888886335232, 12.29658740766948, 0.0, 749.0352380589379, 898.2956653816374, 1.0755973373173793, 916.8186101403727, 995.7599707043771, 273.511611644584, 149.27212543961366, 828.3658278226497, 841.8820952788783, 861.3690391828177, 636.0567198419633, 1176.1204442971507, 695.5232333170917, 1091.1323921025507, 793.6397329101088, 1287.0587142951256, 0.885942659815168, 1192.7790794758685, 1334.4861819120827, 1086.3953476949087, 1073.6672765407861, 334.51392672080294, 1290.1249434176734, 528.3369264312364, 692.2537144774636, 506.53286655778936, 1212.9765273160158, 796.4297886466277, 1182.4063708133306, 77.15741351808822, 593.8878254141173, 1104.903084963733, 1027.054450492248, 1074.989758884814, 1604.266800583997, 1440.8197016111642, 0.0, 1373.4417720872946, 4.142265687372903, 1150.2834447788816, 1194.2956665992945, 764.3795116523324, 802.7025876306355, 1113.2295099533665, 1570.6813961374496, 969.1155963119196, 1273.465243228076, 1029.75363809305, 1025.0518898224286, 1276.713098256175, 1412.0907786431317, 1365.3016340853317, 1283.4465847737222, 1120.8335705120865, 983.5497364114573, 1092.6616278335134, 1349.4012388525136, 1466.2419875865173, 1378.8437769563275, 1068.924335338203, 823.565050456178, 1179.2298720664924, 859.3022496036598, 1477.887814212607, 344.76743968465115, 776.7884911944548, 5.868378675096686, 1085.4262213798158, 88.12836782512457, 962.9327327541005, 843.0040659409012, 857.8834097468407, 971.7422690222592, 911.3661946124802, 1186.730973105699, 33.90560585179279, 896.248282070415, 598.3230465696741, 1250.137175184871, 1208.1943111913224, 1314.2356149738425, 1320.5873148767716, 1262.705393136078, 1309.4918961255992, 929.3241411630039, 598.7359945765987, 1172.6575210982953, 1416.9840535139074, 1113.773376666058, 855.441138656972, 1160.5695221922185, 83.87423029481434, 1372.546875586466, 64.35867597619253, 1243.2446953271078, 1362.395128182894, 1372.1589613954318, 1257.7201719972888, 1360.6282248236005, 6.506885389279751, 1174.38359864627, 942.133580587891, 482.7531700080627, 1044.7470943769342, 966.9115473541912, 947.4895739346786, 1130.9990588943615, 1046.859010130235, 925.0261842237965, 1163.215345473178, 922.5593943887835, 1401.7318716133664, 665.2063799973544, 643.6901860626936, 1140.737859934178, 665.8688137905641, 1388.7489816877128, 1275.191990840688, 1.0971933913484455, 18.65929975753144, 1349.4468242921514, 1093.033564966036, 756.2071390757502, 0.0, 4.139602951821638, 1413.0218632522067, 707.1485086074099, 861.7534799551283, 1208.4160769490427, 1314.7745104780026, 1292.6043982615224, 714.7413408174478, 1372.123376022268, 1341.6960640944255, 1291.8949717795122, 1389.587416912712, 0.0, 1301.6294989985004, 1352.8919570414932, 1325.9623918514203, 1232.4550401364422, 1388.312889113229, 1233.1898514903046, 1217.3130299163597, 1083.893843620201, 1249.4171579463473, 1370.1766573548452, 1344.22842648208, 9.479693045655663, 1035.923204631312, 742.4237354683911, 948.985290021462, 1417.1764207472015, 1515.2074594712728, 1149.434629093598, 927.151246956862, 897.6553457408646, 1482.8972047564803, 1356.8700112838676, 612.5190922943863, 507.3713597069759, 1393.930426222696, 934.5621416207158, 157.6653342590226, 741.366726642799, 866.3551536757997, 1430.858056023826, 1453.0676230421795, 1208.223429324027, 1110.4491178367311, 570.4575735089841, 871.6543242519875, 1009.4654473016734, 74.19639943124518, 1469.118442408314, 613.8186941927908, 1165.4596265671867, 1518.2863258449759, 771.5759521112349, 1119.1841336404505, 915.0392818794757, 782.1309320043846, 1413.2810417939995, 1443.8725093342885, 1229.8644828182942, 992.606125076664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.898234674132242, "mean_inference_ms": 6.741359683413948, "mean_action_processing_ms": 2.388269262575901, "mean_env_wait_ms": 16.527890116004567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03317391872406006, "StateBufferConnector_ms": 0.013609051704406738, "ViewRequirementAgentConnector_ms": 0.2780332565307617}, "num_episodes": 20, "episode_return_max": 668.2999999999997, "episode_return_min": 4.440892098500626e-16, "episode_return_mean": 198.10275304247534, "episodes_this_iter": 20}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 545088, "num_agent_steps_trained": 545088, "num_env_steps_sampled": 136272, "num_env_steps_trained": 136272, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 135.19445694996176, "num_env_steps_trained_throughput_per_sec": 135.19445694996176, "timesteps_total": 136272, "num_env_steps_sampled_lifetime": 136272, "num_agent_steps_sampled_lifetime": 545088, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 545088, "timers": {"training_iteration_time_ms": 27650.549, "restore_workers_time_ms": 0.165, "training_step_time_ms": 27649.935, "sample_time_ms": 3785.431, "learn_time_ms": 23833.111, "learn_throughput": 168.169, "synch_weights_time_ms": 26.837}, "counters": {"num_env_steps_sampled": 136272, "num_env_steps_trained": 136272, "num_agent_steps_sampled": 545088, "num_agent_steps_trained": 545088}, "done": false, "training_iteration": 34, "trial_id": "7f713_00000", "date": "2024-08-23_10-02-07", "timestamp": 1724387527, "time_this_iter_s": 29.69925594329834, "time_total_s": 925.8311331272125, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30f796160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 925.8311331272125, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 49.678571428571416, "ram_util_percent": 83.22380952380954}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.0588723482909, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.239698088106024, "policy_loss": -0.010915712084345244, "vf_loss": 8.248427758393465, "vf_explained_var": 0.5053323951347796, "kl": 0.010930135801789306, "entropy": 0.862853023614833, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 32603.0, "diff_num_grad_updates_vs_sampler_policy": 489.4476047904208}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.086039733508276, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.42817848851441, "policy_loss": -0.008148928015202126, "vf_loss": 8.435035076847782, "vf_explained_var": 0.3135897259863596, "kl": 0.006461702473954391, "entropy": 0.49581493407330185, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 32603.0, "diff_num_grad_updates_vs_sampler_policy": 489.4476047904208}}, "num_env_steps_sampled": 140280, "num_env_steps_trained": 140280, "num_agent_steps_sampled": 561120, "num_agent_steps_trained": 561120}, "env_runners": {"episode_reward_max": 561.8621032953702, "episode_reward_min": 4.440892098500626e-16, "episode_reward_mean": 169.60073393696516, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1604.266800583997, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 272.33349012842467, "predator_policy": 1604.266800583997}, "policy_reward_mean": {"prey_policy": -908.086919527173, "predator_policy": 992.8872864956559}, "custom_metrics": {}, "hist_stats": {"episode_reward": [183.8037102119468, 77.75754060615014, 195.80524815603968, 107.53412603564897, 115.01915711507733, 23.72459634014661, 228.50674403110025, 134.67795573316386, 443.86570616602745, 377.6905987734492, 267.5801501744776, 219.86623722516515, 1.379911379854743, 0.20084320761501173, 258.5681334686508, 125.70860181130755, 196.05688532729272, 259.6036476146954, 63.39976845702112, 28.956330777917636, 27.773474228883412, 206.71395493008916, 66.08658375650391, 141.6466202322916, 2.299999999999995, 243.9498330003517, 396.3640397947582, 8.515364328623644, 259.70403056654493, 284.1639284150277, 340.1708310097941, 316.0916335318144, 134.04951604569948, 189.28255759799293, 335.5917161715117, 210.12155826215826, 9.997778012332212, 3.8808038190765988, 186.05653527053073, 136.7417868383303, 385.7540797087853, 193.41440310426452, 255.76522426475012, 154.3252719554891, 182.44929949581208, 192.2499191406796, 424.8759303246241, 116.44266605545852, 131.32534692022438, 66.76928384530245, 343.57076697537644, 68.57426226916672, 231.41234028582537, 366.94582902171226, 74.10482612826623, 214.0999999999969, 105.98396687235888, 355.8122949420211, 172.60500214160416, 455.2835051018787, 8.691233719273008, 49.48136244447405, 209.28178436880282, 1.4729535251892854, 242.94574904693755, 207.86080807768928, 1.0299146853448242, 114.16603409513846, 0.2817747232018015, 4.440892098500626e-16, 223.20024622544082, 561.8621032953702, 1.8579913884724861, 86.06815140976346, 171.86869433708063, 100.34547077793738, 176.46864342159597, 376.52405610613613, 368.9214971258995, 2.0192058749261736, 87.06747473349745, 446.9839977945975, 341.50551570454945, 96.82055475172663, 16.667732746466733, 254.99777907295316, 505.54519769725005, 0.4999999999999927, 77.82885343978054, 0.43391393483142027, 161.24490503450883, 204.66289925637378, 13.264454190000196, 10.68554672924964, 205.44416689395433, 149.41549314185642, 24.33122927774837, 149.18457813150792, 7.368769538327857, 1.1000000000000074], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-497.8966961512025, -1021.5507280985466, -587.3422651801804, -1147.077358352779, -1301.0450556223416, -289.80532164126237, -693.5139482571528, -1279.6503729124347, 90.18778626777912, -1168.8336512883855, -1334.6434248207615, -1062.5135084460833, 107.57405763102209, -1287.2485168615106, -1193.7436397765682, -490.0402743391811, 41.84914404421343, -796.7700189134359, -679.7594456118023, -951.9562715773949, -1173.0833634602775, 181.09972930333592, -669.8929260183131, -809.0317471343722, -1065.9340458292345, -1034.7302521679724, -1604.266800583997, -1440.6188584035492, 258.51766656316323, -1373.391305181807, -895.6211579884788, -133.09595066646744, -1194.1864867461738, -568.4318061781602, -1306.9671357875275, -349.3613141817732, -1268.146075262068, -1208.2511487302772, -1264.3652432280758, -1009.8973073151318, -980.0427720963698, -1293.948741753348, -1132.2059667931949, -1438.4724910051773, -1252.0215349245186, -1086.172036604786, -957.0921935294833, -977.4725504831958, -1347.1012388525135, -1466.2419875865173, -811.8649107544206, -1391.953368539757, -337.5948776521533, -1268.836005075753, -850.014524082227, -1478.6601754054159, -111.57392265130278, -750.2779776612543, -198.39899751066253, -608.7316741292225, -878.396830866205, 167.5065612967733, -510.1662939441267, -874.6295482117968, -848.3463960252484, -900.7125515637906, -719.2286519483218, -312.1253694111769, -894.2300515214957, -264.7495609470833, -1251.891432937354, -996.3184951766791, -1288.4633760096985, -1336.361775828583, -1260.0227462266932, -1308.2937392159076, -1162.0843230162207, -179.9192774528517, -1354.3680533653378, -1098.5317344085336, -1182.6995458223978, -400.7608897918373, -913.7694467990996, -137.2599025836671, -1313.5508144695316, 132.4104871716217, -1255.7996571676806, -1195.5148943868328, -1152.8346953341872, -1294.5951385627195, -1359.6585265176618, 184.77333544546138, -1023.056086525308, -668.5851623842287, -376.8360747804394, -1034.2215235490912, -817.7511833091105, -965.3245910595349, -1067.878970409875, -1043.209814769419, -672.5266489015742, -1072.1441138200203, -853.3104784047267, -1402.4065253282556, -493.7371918334678, -583.7470339407499, -265.5573228619532, -1174.1035218410761, -1183.4940214374299, -1406.3421249627047, 155.2721824408259, 39.0713244102931, -965.1105490295781, -1371.3858733562486, -314.55964606839507, -85.83519806533687, -911.9782622390823, -332.5782018233436, 38.99179705481094, -1152.6102805154785, -1208.4160769490427, -1306.0832767587294, -645.1081304345352, -1312.756246199961, -1141.9145745604696, -1362.6230811874204, -1291.5981259390826, -1388.411309227952, -952.4620046947576, -106.22174525680617, -1110.692276054226, -1360.3012647609987, -1339.0141278824055, -1280.7238866819193, -1204.0693001047478, -1132.267547206779, -1083.4938436202012, -1249.5353832231453, -1370.1766573548452, -1344.22842648208, -113.50006043756419, -708.702591013963, 159.0476960190514, -1288.5946182135337, -1415.6184293587296, -1514.907459471273, -1023.8923104190754, -966.6254142216225, -852.1096472048399, -1356.5742089554249, -692.3701397687801, -1176.673493031536, -310.7585596814868, -1414.0745828265808, -988.0369099020268, 272.33349012842467, -411.07628777989163, -827.7240954128065, -1428.8388501488998, -1453.0676230421795, -1124.2559545905276, -1107.3491178367337, -47.595892335147525, -947.532007631226, -523.4402344319883, -218.71609659637988, -1466.5476196942775, -519.5689621550997, -1148.7463393084618, -1518.3318803572338, -947.6907692197715, -688.0715374589587, -452.59525366104805, -739.029762525562, -1412.781041794, -1443.8725093342885, -1222.0644828182942, -922.5772716368814, -1445.9998320253537, -1341.180606810776, -1243.2576569722007, -511.54217468223646, -854.1265908206578, -671.8699852122982, -1431.752750554914, -1039.1553126335725, -1458.039681998204, -1365.7355443808524, -1248.8910765727555, -742.3475186272833, -33.75021667533252, -1056.5171158894686, -1265.8197791174712, -1138.2422764595315, -868.6513602877816, -87.93190714565281, -1357.75439432509, -1421.9103357739807, -1414.609855776013, -1088.0084010786527], "policy_predator_policy_reward": [841.8820952788783, 861.3690391828177, 636.0567198419633, 1176.1204442971507, 695.5232333170917, 1091.1323921025507, 793.6397329101088, 1287.0587142951256, 0.885942659815168, 1192.7790794758685, 1334.4861819120827, 1086.3953476949087, 1073.6672765407861, 334.51392672080294, 1290.1249434176734, 528.3369264312364, 692.2537144774636, 506.53286655778936, 1212.9765273160158, 796.4297886466277, 1182.4063708133306, 77.15741351808822, 593.8878254141173, 1104.903084963733, 1027.054450492248, 1074.989758884814, 1604.266800583997, 1440.8197016111642, 0.0, 1373.4417720872946, 4.142265687372903, 1150.2834447788816, 1194.2956665992945, 764.3795116523324, 802.7025876306355, 1113.2295099533665, 1570.6813961374496, 969.1155963119196, 1273.465243228076, 1029.75363809305, 1025.0518898224286, 1276.713098256175, 1412.0907786431317, 1365.3016340853317, 1283.4465847737222, 1120.8335705120865, 983.5497364114573, 1092.6616278335134, 1349.4012388525136, 1466.2419875865173, 1378.8437769563275, 1068.924335338203, 823.565050456178, 1179.2298720664924, 859.3022496036598, 1477.887814212607, 344.76743968465115, 776.7884911944548, 5.868378675096686, 1085.4262213798158, 88.12836782512457, 962.9327327541005, 843.0040659409012, 857.8834097468407, 971.7422690222592, 911.3661946124802, 1186.730973105699, 33.90560585179279, 896.248282070415, 598.3230465696741, 1250.137175184871, 1208.1943111913224, 1314.2356149738425, 1320.5873148767716, 1262.705393136078, 1309.4918961255992, 929.3241411630039, 598.7359945765987, 1172.6575210982953, 1416.9840535139074, 1113.773376666058, 855.441138656972, 1160.5695221922185, 83.87423029481434, 1372.546875586466, 64.35867597619253, 1243.2446953271078, 1362.395128182894, 1372.1589613954318, 1257.7201719972888, 1360.6282248236005, 6.506885389279751, 1174.38359864627, 942.133580587891, 482.7531700080627, 1044.7470943769342, 966.9115473541912, 947.4895739346786, 1130.9990588943615, 1046.859010130235, 925.0261842237965, 1163.215345473178, 922.5593943887835, 1401.7318716133664, 665.2063799973544, 643.6901860626936, 1140.737859934178, 665.8688137905641, 1388.7489816877128, 1275.191990840688, 1.0971933913484455, 18.65929975753144, 1349.4468242921514, 1093.033564966036, 756.2071390757502, 0.0, 4.139602951821638, 1413.0218632522067, 707.1485086074099, 861.7534799551283, 1208.4160769490427, 1314.7745104780026, 1292.6043982615224, 714.7413408174478, 1372.123376022268, 1341.6960640944255, 1291.8949717795122, 1389.587416912712, 0.0, 1301.6294989985004, 1352.8919570414932, 1325.9623918514203, 1232.4550401364422, 1388.312889113229, 1233.1898514903046, 1217.3130299163597, 1083.893843620201, 1249.4171579463473, 1370.1766573548452, 1344.22842648208, 9.479693045655663, 1035.923204631312, 742.4237354683911, 948.985290021462, 1417.1764207472015, 1515.2074594712728, 1149.434629093598, 927.151246956862, 897.6553457408646, 1482.8972047564803, 1356.8700112838676, 612.5190922943863, 507.3713597069759, 1393.930426222696, 934.5621416207158, 157.6653342590226, 741.366726642799, 866.3551536757997, 1430.858056023826, 1453.0676230421795, 1208.223429324027, 1110.4491178367311, 570.4575735089841, 871.6543242519875, 1009.4654473016734, 74.19639943124518, 1469.118442408314, 613.8186941927908, 1165.4596265671867, 1518.2863258449759, 771.5759521112349, 1119.1841336404505, 915.0392818794757, 782.1309320043846, 1413.2810417939995, 1443.8725093342885, 1229.8644828182942, 992.606125076664, 1446.9998320253537, 1340.6145207456073, 1150.4905494930185, 765.5541871959309, 857.3337138768732, 873.3257614124585, 1431.829767680028, 1052.342749698459, 1459.2384864161963, 1375.2222866921104, 1173.815936328834, 1022.8668257651589, 640.8451074545227, 598.8377182521357, 1344.1972842289176, 1084.1960006258323, 556.0546476064828, 549.7131979584631, 1364.3855228922587, 1422.64797674514, 1414.609855776013, 1089.1084010786526]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.889746960613506, "mean_inference_ms": 6.8469111784219345, "mean_action_processing_ms": 2.4551718694490763, "mean_env_wait_ms": 16.566636550661674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.033077359199523926, "StateBufferConnector_ms": 0.013610482215881348, "ViewRequirementAgentConnector_ms": 0.261214017868042}, "num_episodes": 11, "episode_return_max": 561.8621032953702, "episode_return_min": 4.440892098500626e-16, "episode_return_mean": 169.60073393696516, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 561120, "num_agent_steps_trained": 561120, "num_env_steps_sampled": 140280, "num_env_steps_trained": 140280, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 152.45888802109505, "num_env_steps_trained_throughput_per_sec": 152.45888802109505, "timesteps_total": 140280, "num_env_steps_sampled_lifetime": 140280, "num_agent_steps_sampled_lifetime": 561120, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 561120, "timers": {"training_iteration_time_ms": 27629.595, "restore_workers_time_ms": 0.165, "training_step_time_ms": 27629.011, "sample_time_ms": 3808.503, "learn_time_ms": 23790.602, "learn_throughput": 168.47, "synch_weights_time_ms": 26.08}, "counters": {"num_env_steps_sampled": 140280, "num_env_steps_trained": 140280, "num_agent_steps_sampled": 561120, "num_agent_steps_trained": 561120}, "done": false, "training_iteration": 35, "trial_id": "7f713_00000", "date": "2024-08-23_10-02-33", "timestamp": 1724387553, "time_this_iter_s": 26.356977939605713, "time_total_s": 952.1881110668182, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737b1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 952.1881110668182, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 37.64054054054054, "ram_util_percent": 82.64864864864866}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.17817893331013, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.453823313637386, "policy_loss": -0.010304712024689824, "vf_loss": 8.462201087689273, "vf_explained_var": 0.5340466028798825, "kl": 0.00963484122018729, "entropy": 0.8407460037362638, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 33548.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.188020818069498, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.415152446302788, "policy_loss": -0.006740243091721028, "vf_loss": 8.420753137901347, "vf_explained_var": 0.3065717789231154, "kl": 0.005697920000446694, "entropy": 0.4620689243866653, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 33548.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 144288, "num_env_steps_trained": 144288, "num_agent_steps_sampled": 577152, "num_agent_steps_trained": 577152}, "env_runners": {"episode_reward_max": 561.8621032953702, "episode_reward_min": 4.440892098500626e-16, "episode_reward_mean": 170.70197633428347, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1604.266800583997, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 272.33349012842467, "predator_policy": 1604.266800583997}, "policy_reward_mean": {"prey_policy": -924.4833144323749, "predator_policy": 1009.8343025995171}, "custom_metrics": {}, "hist_stats": {"episode_reward": [443.86570616602745, 377.6905987734492, 267.5801501744776, 219.86623722516515, 1.379911379854743, 0.20084320761501173, 258.5681334686508, 125.70860181130755, 196.05688532729272, 259.6036476146954, 63.39976845702112, 28.956330777917636, 27.773474228883412, 206.71395493008916, 66.08658375650391, 141.6466202322916, 2.299999999999995, 243.9498330003517, 396.3640397947582, 8.515364328623644, 259.70403056654493, 284.1639284150277, 340.1708310097941, 316.0916335318144, 134.04951604569948, 189.28255759799293, 335.5917161715117, 210.12155826215826, 9.997778012332212, 3.8808038190765988, 186.05653527053073, 136.7417868383303, 385.7540797087853, 193.41440310426452, 255.76522426475012, 154.3252719554891, 182.44929949581208, 192.2499191406796, 424.8759303246241, 116.44266605545852, 131.32534692022438, 66.76928384530245, 343.57076697537644, 68.57426226916672, 231.41234028582537, 366.94582902171226, 74.10482612826623, 214.0999999999969, 105.98396687235888, 355.8122949420211, 172.60500214160416, 455.2835051018787, 8.691233719273008, 49.48136244447405, 209.28178436880282, 1.4729535251892854, 242.94574904693755, 207.86080807768928, 1.0299146853448242, 114.16603409513846, 0.2817747232018015, 4.440892098500626e-16, 223.20024622544082, 561.8621032953702, 1.8579913884724861, 86.06815140976346, 171.86869433708063, 100.34547077793738, 176.46864342159597, 376.52405610613613, 368.9214971258995, 2.0192058749261736, 87.06747473349745, 446.9839977945975, 341.50551570454945, 96.82055475172663, 16.667732746466733, 254.99777907295316, 505.54519769725005, 0.4999999999999927, 77.82885343978054, 0.43391393483142027, 161.24490503450883, 204.66289925637378, 13.264454190000196, 10.68554672924964, 205.44416689395433, 149.41549314185642, 24.33122927774837, 149.18457813150792, 7.368769538327857, 1.1000000000000074, 314.69926549638325, 2.220446049250313e-15, 417.55069760407457, 179.11089541582706, 43.07247702388852, 199.56444069084262, 5.399423223409537, 17.55611850668155], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [41.84914404421343, -796.7700189134359, -679.7594456118023, -951.9562715773949, -1173.0833634602775, 181.09972930333592, -669.8929260183131, -809.0317471343722, -1065.9340458292345, -1034.7302521679724, -1604.266800583997, -1440.6188584035492, 258.51766656316323, -1373.391305181807, -895.6211579884788, -133.09595066646744, -1194.1864867461738, -568.4318061781602, -1306.9671357875275, -349.3613141817732, -1268.146075262068, -1208.2511487302772, -1264.3652432280758, -1009.8973073151318, -980.0427720963698, -1293.948741753348, -1132.2059667931949, -1438.4724910051773, -1252.0215349245186, -1086.172036604786, -957.0921935294833, -977.4725504831958, -1347.1012388525135, -1466.2419875865173, -811.8649107544206, -1391.953368539757, -337.5948776521533, -1268.836005075753, -850.014524082227, -1478.6601754054159, -111.57392265130278, -750.2779776612543, -198.39899751066253, -608.7316741292225, -878.396830866205, 167.5065612967733, -510.1662939441267, -874.6295482117968, -848.3463960252484, -900.7125515637906, -719.2286519483218, -312.1253694111769, -894.2300515214957, -264.7495609470833, -1251.891432937354, -996.3184951766791, -1288.4633760096985, -1336.361775828583, -1260.0227462266932, -1308.2937392159076, -1162.0843230162207, -179.9192774528517, -1354.3680533653378, -1098.5317344085336, -1182.6995458223978, -400.7608897918373, -913.7694467990996, -137.2599025836671, -1313.5508144695316, 132.4104871716217, -1255.7996571676806, -1195.5148943868328, -1152.8346953341872, -1294.5951385627195, -1359.6585265176618, 184.77333544546138, -1023.056086525308, -668.5851623842287, -376.8360747804394, -1034.2215235490912, -817.7511833091105, -965.3245910595349, -1067.878970409875, -1043.209814769419, -672.5266489015742, -1072.1441138200203, -853.3104784047267, -1402.4065253282556, -493.7371918334678, -583.7470339407499, -265.5573228619532, -1174.1035218410761, -1183.4940214374299, -1406.3421249627047, 155.2721824408259, 39.0713244102931, -965.1105490295781, -1371.3858733562486, -314.55964606839507, -85.83519806533687, -911.9782622390823, -332.5782018233436, 38.99179705481094, -1152.6102805154785, -1208.4160769490427, -1306.0832767587294, -645.1081304345352, -1312.756246199961, -1141.9145745604696, -1362.6230811874204, -1291.5981259390826, -1388.411309227952, -952.4620046947576, -106.22174525680617, -1110.692276054226, -1360.3012647609987, -1339.0141278824055, -1280.7238866819193, -1204.0693001047478, -1132.267547206779, -1083.4938436202012, -1249.5353832231453, -1370.1766573548452, -1344.22842648208, -113.50006043756419, -708.702591013963, 159.0476960190514, -1288.5946182135337, -1415.6184293587296, -1514.907459471273, -1023.8923104190754, -966.6254142216225, -852.1096472048399, -1356.5742089554249, -692.3701397687801, -1176.673493031536, -310.7585596814868, -1414.0745828265808, -988.0369099020268, 272.33349012842467, -411.07628777989163, -827.7240954128065, -1428.8388501488998, -1453.0676230421795, -1124.2559545905276, -1107.3491178367337, -47.595892335147525, -947.532007631226, -523.4402344319883, -218.71609659637988, -1466.5476196942775, -519.5689621550997, -1148.7463393084618, -1518.3318803572338, -947.6907692197715, -688.0715374589587, -452.59525366104805, -739.029762525562, -1412.781041794, -1443.8725093342885, -1222.0644828182942, -922.5772716368814, -1445.9998320253537, -1341.180606810776, -1243.2576569722007, -511.54217468223646, -854.1265908206578, -671.8699852122982, -1431.752750554914, -1039.1553126335725, -1458.039681998204, -1365.7355443808524, -1248.8910765727555, -742.3475186272833, -33.75021667533252, -1056.5171158894686, -1265.8197791174712, -1138.2422764595315, -868.6513602877816, -87.93190714565281, -1357.75439432509, -1421.9103357739807, -1414.609855776013, -1088.0084010786527, -217.59540655652663, -1174.0352642300506, -1287.532701350433, -1342.3623278703685, -1314.2215120659966, 39.382221704306495, -960.5307940488512, -1533.720582195017, -619.8343096999083, -1291.417862991163, -1085.8135175060554, -937.6402579722902, -1390.153669273477, -1204.0837423309304, -962.5707043115258, -1154.291468191684], "policy_predator_policy_reward": [692.2537144774636, 506.53286655778936, 1212.9765273160158, 796.4297886466277, 1182.4063708133306, 77.15741351808822, 593.8878254141173, 1104.903084963733, 1027.054450492248, 1074.989758884814, 1604.266800583997, 1440.8197016111642, 0.0, 1373.4417720872946, 4.142265687372903, 1150.2834447788816, 1194.2956665992945, 764.3795116523324, 802.7025876306355, 1113.2295099533665, 1570.6813961374496, 969.1155963119196, 1273.465243228076, 1029.75363809305, 1025.0518898224286, 1276.713098256175, 1412.0907786431317, 1365.3016340853317, 1283.4465847737222, 1120.8335705120865, 983.5497364114573, 1092.6616278335134, 1349.4012388525136, 1466.2419875865173, 1378.8437769563275, 1068.924335338203, 823.565050456178, 1179.2298720664924, 859.3022496036598, 1477.887814212607, 344.76743968465115, 776.7884911944548, 5.868378675096686, 1085.4262213798158, 88.12836782512457, 962.9327327541005, 843.0040659409012, 857.8834097468407, 971.7422690222592, 911.3661946124802, 1186.730973105699, 33.90560585179279, 896.248282070415, 598.3230465696741, 1250.137175184871, 1208.1943111913224, 1314.2356149738425, 1320.5873148767716, 1262.705393136078, 1309.4918961255992, 929.3241411630039, 598.7359945765987, 1172.6575210982953, 1416.9840535139074, 1113.773376666058, 855.441138656972, 1160.5695221922185, 83.87423029481434, 1372.546875586466, 64.35867597619253, 1243.2446953271078, 1362.395128182894, 1372.1589613954318, 1257.7201719972888, 1360.6282248236005, 6.506885389279751, 1174.38359864627, 942.133580587891, 482.7531700080627, 1044.7470943769342, 966.9115473541912, 947.4895739346786, 1130.9990588943615, 1046.859010130235, 925.0261842237965, 1163.215345473178, 922.5593943887835, 1401.7318716133664, 665.2063799973544, 643.6901860626936, 1140.737859934178, 665.8688137905641, 1388.7489816877128, 1275.191990840688, 1.0971933913484455, 18.65929975753144, 1349.4468242921514, 1093.033564966036, 756.2071390757502, 0.0, 4.139602951821638, 1413.0218632522067, 707.1485086074099, 861.7534799551283, 1208.4160769490427, 1314.7745104780026, 1292.6043982615224, 714.7413408174478, 1372.123376022268, 1341.6960640944255, 1291.8949717795122, 1389.587416912712, 0.0, 1301.6294989985004, 1352.8919570414932, 1325.9623918514203, 1232.4550401364422, 1388.312889113229, 1233.1898514903046, 1217.3130299163597, 1083.893843620201, 1249.4171579463473, 1370.1766573548452, 1344.22842648208, 9.479693045655663, 1035.923204631312, 742.4237354683911, 948.985290021462, 1417.1764207472015, 1515.2074594712728, 1149.434629093598, 927.151246956862, 897.6553457408646, 1482.8972047564803, 1356.8700112838676, 612.5190922943863, 507.3713597069759, 1393.930426222696, 934.5621416207158, 157.6653342590226, 741.366726642799, 866.3551536757997, 1430.858056023826, 1453.0676230421795, 1208.223429324027, 1110.4491178367311, 570.4575735089841, 871.6543242519875, 1009.4654473016734, 74.19639943124518, 1469.118442408314, 613.8186941927908, 1165.4596265671867, 1518.2863258449759, 771.5759521112349, 1119.1841336404505, 915.0392818794757, 782.1309320043846, 1413.2810417939995, 1443.8725093342885, 1229.8644828182942, 992.606125076664, 1446.9998320253537, 1340.6145207456073, 1150.4905494930185, 765.5541871959309, 857.3337138768732, 873.3257614124585, 1431.829767680028, 1052.342749698459, 1459.2384864161963, 1375.2222866921104, 1173.815936328834, 1022.8668257651589, 640.8451074545227, 598.8377182521357, 1344.1972842289176, 1084.1960006258323, 556.0546476064828, 549.7131979584631, 1364.3855228922587, 1422.64797674514, 1414.609855776013, 1089.1084010786526, 1129.565396724259, 576.7645395587031, 1287.532701350433, 1342.3623278703685, 785.495460510458, 906.8945274553029, 1510.7048554197645, 1162.657416239931, 662.8201287766784, 1291.5045209382865, 1058.772538457379, 1164.2456777118127, 1390.153669273477, 1209.4831655543396, 978.8268228182075, 1155.591468191684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.967600681807525, "mean_inference_ms": 6.905685684683529, "mean_action_processing_ms": 2.4772596224172596, "mean_env_wait_ms": 16.6670924499605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03301382064819336, "StateBufferConnector_ms": 0.013971090316772461, "ViewRequirementAgentConnector_ms": 0.25459015369415283}, "num_episodes": 8, "episode_return_max": 561.8621032953702, "episode_return_min": 4.440892098500626e-16, "episode_return_mean": 170.70197633428347, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 577152, "num_agent_steps_trained": 577152, "num_env_steps_sampled": 144288, "num_env_steps_trained": 144288, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 150.25988613343222, "num_env_steps_trained_throughput_per_sec": 150.25988613343222, "timesteps_total": 144288, "num_env_steps_sampled_lifetime": 144288, "num_agent_steps_sampled_lifetime": 577152, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 577152, "timers": {"training_iteration_time_ms": 27646.734, "restore_workers_time_ms": 0.034, "training_step_time_ms": 27646.304, "sample_time_ms": 3794.257, "learn_time_ms": 23822.236, "learn_throughput": 168.246, "synch_weights_time_ms": 25.954}, "counters": {"num_env_steps_sampled": 144288, "num_env_steps_trained": 144288, "num_agent_steps_sampled": 577152, "num_agent_steps_trained": 577152}, "done": false, "training_iteration": 36, "trial_id": "7f713_00000", "date": "2024-08-23_10-03-00", "timestamp": 1724387580, "time_this_iter_s": 26.70961880683899, "time_total_s": 978.8977298736572, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17378cc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 978.8977298736572, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 40.043243243243246, "ram_util_percent": 82.93243243243242}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.78423605974389, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.248211562444293, "policy_loss": -0.011154158994378079, "vf_loss": 8.257460317157564, "vf_explained_var": 0.5669897648392531, "kl": 0.009527168797191095, "entropy": 0.8768750096755052, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 34493.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.878027767857546, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.336099982892394, "policy_loss": -0.010842304597867445, "vf_loss": 8.34529323527422, "vf_explained_var": 0.2927804282102635, "kl": 0.008245291380044172, "entropy": 0.47172948591923586, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 34493.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 148296, "num_env_steps_trained": 148296, "num_agent_steps_sampled": 593184, "num_agent_steps_trained": 593184}, "env_runners": {"episode_reward_max": 561.8621032953702, "episode_reward_min": 4.440892098500626e-16, "episode_reward_mean": 166.76159385220518, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1604.266800583997, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 272.33349012842467, "predator_policy": 1604.266800583997}, "policy_reward_mean": {"prey_policy": -932.543367300796, "predator_policy": 1015.9241642268992}, "custom_metrics": {}, "hist_stats": {"episode_reward": [377.6905987734492, 267.5801501744776, 219.86623722516515, 1.379911379854743, 0.20084320761501173, 258.5681334686508, 125.70860181130755, 196.05688532729272, 259.6036476146954, 63.39976845702112, 28.956330777917636, 27.773474228883412, 206.71395493008916, 66.08658375650391, 141.6466202322916, 2.299999999999995, 243.9498330003517, 396.3640397947582, 8.515364328623644, 259.70403056654493, 284.1639284150277, 340.1708310097941, 316.0916335318144, 134.04951604569948, 189.28255759799293, 335.5917161715117, 210.12155826215826, 9.997778012332212, 3.8808038190765988, 186.05653527053073, 136.7417868383303, 385.7540797087853, 193.41440310426452, 255.76522426475012, 154.3252719554891, 182.44929949581208, 192.2499191406796, 424.8759303246241, 116.44266605545852, 131.32534692022438, 66.76928384530245, 343.57076697537644, 68.57426226916672, 231.41234028582537, 366.94582902171226, 74.10482612826623, 214.0999999999969, 105.98396687235888, 355.8122949420211, 172.60500214160416, 455.2835051018787, 8.691233719273008, 49.48136244447405, 209.28178436880282, 1.4729535251892854, 242.94574904693755, 207.86080807768928, 1.0299146853448242, 114.16603409513846, 0.2817747232018015, 4.440892098500626e-16, 223.20024622544082, 561.8621032953702, 1.8579913884724861, 86.06815140976346, 171.86869433708063, 100.34547077793738, 176.46864342159597, 376.52405610613613, 368.9214971258995, 2.0192058749261736, 87.06747473349745, 446.9839977945975, 341.50551570454945, 96.82055475172663, 16.667732746466733, 254.99777907295316, 505.54519769725005, 0.4999999999999927, 77.82885343978054, 0.43391393483142027, 161.24490503450883, 204.66289925637378, 13.264454190000196, 10.68554672924964, 205.44416689395433, 149.41549314185642, 24.33122927774837, 149.18457813150792, 7.368769538327857, 1.1000000000000074, 314.69926549638325, 2.220446049250313e-15, 417.55069760407457, 179.11089541582706, 43.07247702388852, 199.56444069084262, 5.399423223409537, 17.55611850668155, 49.82745795819959], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-679.7594456118023, -951.9562715773949, -1173.0833634602775, 181.09972930333592, -669.8929260183131, -809.0317471343722, -1065.9340458292345, -1034.7302521679724, -1604.266800583997, -1440.6188584035492, 258.51766656316323, -1373.391305181807, -895.6211579884788, -133.09595066646744, -1194.1864867461738, -568.4318061781602, -1306.9671357875275, -349.3613141817732, -1268.146075262068, -1208.2511487302772, -1264.3652432280758, -1009.8973073151318, -980.0427720963698, -1293.948741753348, -1132.2059667931949, -1438.4724910051773, -1252.0215349245186, -1086.172036604786, -957.0921935294833, -977.4725504831958, -1347.1012388525135, -1466.2419875865173, -811.8649107544206, -1391.953368539757, -337.5948776521533, -1268.836005075753, -850.014524082227, -1478.6601754054159, -111.57392265130278, -750.2779776612543, -198.39899751066253, -608.7316741292225, -878.396830866205, 167.5065612967733, -510.1662939441267, -874.6295482117968, -848.3463960252484, -900.7125515637906, -719.2286519483218, -312.1253694111769, -894.2300515214957, -264.7495609470833, -1251.891432937354, -996.3184951766791, -1288.4633760096985, -1336.361775828583, -1260.0227462266932, -1308.2937392159076, -1162.0843230162207, -179.9192774528517, -1354.3680533653378, -1098.5317344085336, -1182.6995458223978, -400.7608897918373, -913.7694467990996, -137.2599025836671, -1313.5508144695316, 132.4104871716217, -1255.7996571676806, -1195.5148943868328, -1152.8346953341872, -1294.5951385627195, -1359.6585265176618, 184.77333544546138, -1023.056086525308, -668.5851623842287, -376.8360747804394, -1034.2215235490912, -817.7511833091105, -965.3245910595349, -1067.878970409875, -1043.209814769419, -672.5266489015742, -1072.1441138200203, -853.3104784047267, -1402.4065253282556, -493.7371918334678, -583.7470339407499, -265.5573228619532, -1174.1035218410761, -1183.4940214374299, -1406.3421249627047, 155.2721824408259, 39.0713244102931, -965.1105490295781, -1371.3858733562486, -314.55964606839507, -85.83519806533687, -911.9782622390823, -332.5782018233436, 38.99179705481094, -1152.6102805154785, -1208.4160769490427, -1306.0832767587294, -645.1081304345352, -1312.756246199961, -1141.9145745604696, -1362.6230811874204, -1291.5981259390826, -1388.411309227952, -952.4620046947576, -106.22174525680617, -1110.692276054226, -1360.3012647609987, -1339.0141278824055, -1280.7238866819193, -1204.0693001047478, -1132.267547206779, -1083.4938436202012, -1249.5353832231453, -1370.1766573548452, -1344.22842648208, -113.50006043756419, -708.702591013963, 159.0476960190514, -1288.5946182135337, -1415.6184293587296, -1514.907459471273, -1023.8923104190754, -966.6254142216225, -852.1096472048399, -1356.5742089554249, -692.3701397687801, -1176.673493031536, -310.7585596814868, -1414.0745828265808, -988.0369099020268, 272.33349012842467, -411.07628777989163, -827.7240954128065, -1428.8388501488998, -1453.0676230421795, -1124.2559545905276, -1107.3491178367337, -47.595892335147525, -947.532007631226, -523.4402344319883, -218.71609659637988, -1466.5476196942775, -519.5689621550997, -1148.7463393084618, -1518.3318803572338, -947.6907692197715, -688.0715374589587, -452.59525366104805, -739.029762525562, -1412.781041794, -1443.8725093342885, -1222.0644828182942, -922.5772716368814, -1445.9998320253537, -1341.180606810776, -1243.2576569722007, -511.54217468223646, -854.1265908206578, -671.8699852122982, -1431.752750554914, -1039.1553126335725, -1458.039681998204, -1365.7355443808524, -1248.8910765727555, -742.3475186272833, -33.75021667533252, -1056.5171158894686, -1265.8197791174712, -1138.2422764595315, -868.6513602877816, -87.93190714565281, -1357.75439432509, -1421.9103357739807, -1414.609855776013, -1088.0084010786527, -217.59540655652663, -1174.0352642300506, -1287.532701350433, -1342.3623278703685, -1314.2215120659966, 39.382221704306495, -960.5307940488512, -1533.720582195017, -619.8343096999083, -1291.417862991163, -1085.8135175060554, -937.6402579722902, -1390.153669273477, -1204.0837423309304, -962.5707043115258, -1154.291468191684, -1240.8074437293737, -1126.1240048240852], "policy_predator_policy_reward": [1212.9765273160158, 796.4297886466277, 1182.4063708133306, 77.15741351808822, 593.8878254141173, 1104.903084963733, 1027.054450492248, 1074.989758884814, 1604.266800583997, 1440.8197016111642, 0.0, 1373.4417720872946, 4.142265687372903, 1150.2834447788816, 1194.2956665992945, 764.3795116523324, 802.7025876306355, 1113.2295099533665, 1570.6813961374496, 969.1155963119196, 1273.465243228076, 1029.75363809305, 1025.0518898224286, 1276.713098256175, 1412.0907786431317, 1365.3016340853317, 1283.4465847737222, 1120.8335705120865, 983.5497364114573, 1092.6616278335134, 1349.4012388525136, 1466.2419875865173, 1378.8437769563275, 1068.924335338203, 823.565050456178, 1179.2298720664924, 859.3022496036598, 1477.887814212607, 344.76743968465115, 776.7884911944548, 5.868378675096686, 1085.4262213798158, 88.12836782512457, 962.9327327541005, 843.0040659409012, 857.8834097468407, 971.7422690222592, 911.3661946124802, 1186.730973105699, 33.90560585179279, 896.248282070415, 598.3230465696741, 1250.137175184871, 1208.1943111913224, 1314.2356149738425, 1320.5873148767716, 1262.705393136078, 1309.4918961255992, 929.3241411630039, 598.7359945765987, 1172.6575210982953, 1416.9840535139074, 1113.773376666058, 855.441138656972, 1160.5695221922185, 83.87423029481434, 1372.546875586466, 64.35867597619253, 1243.2446953271078, 1362.395128182894, 1372.1589613954318, 1257.7201719972888, 1360.6282248236005, 6.506885389279751, 1174.38359864627, 942.133580587891, 482.7531700080627, 1044.7470943769342, 966.9115473541912, 947.4895739346786, 1130.9990588943615, 1046.859010130235, 925.0261842237965, 1163.215345473178, 922.5593943887835, 1401.7318716133664, 665.2063799973544, 643.6901860626936, 1140.737859934178, 665.8688137905641, 1388.7489816877128, 1275.191990840688, 1.0971933913484455, 18.65929975753144, 1349.4468242921514, 1093.033564966036, 756.2071390757502, 0.0, 4.139602951821638, 1413.0218632522067, 707.1485086074099, 861.7534799551283, 1208.4160769490427, 1314.7745104780026, 1292.6043982615224, 714.7413408174478, 1372.123376022268, 1341.6960640944255, 1291.8949717795122, 1389.587416912712, 0.0, 1301.6294989985004, 1352.8919570414932, 1325.9623918514203, 1232.4550401364422, 1388.312889113229, 1233.1898514903046, 1217.3130299163597, 1083.893843620201, 1249.4171579463473, 1370.1766573548452, 1344.22842648208, 9.479693045655663, 1035.923204631312, 742.4237354683911, 948.985290021462, 1417.1764207472015, 1515.2074594712728, 1149.434629093598, 927.151246956862, 897.6553457408646, 1482.8972047564803, 1356.8700112838676, 612.5190922943863, 507.3713597069759, 1393.930426222696, 934.5621416207158, 157.6653342590226, 741.366726642799, 866.3551536757997, 1430.858056023826, 1453.0676230421795, 1208.223429324027, 1110.4491178367311, 570.4575735089841, 871.6543242519875, 1009.4654473016734, 74.19639943124518, 1469.118442408314, 613.8186941927908, 1165.4596265671867, 1518.2863258449759, 771.5759521112349, 1119.1841336404505, 915.0392818794757, 782.1309320043846, 1413.2810417939995, 1443.8725093342885, 1229.8644828182942, 992.606125076664, 1446.9998320253537, 1340.6145207456073, 1150.4905494930185, 765.5541871959309, 857.3337138768732, 873.3257614124585, 1431.829767680028, 1052.342749698459, 1459.2384864161963, 1375.2222866921104, 1173.815936328834, 1022.8668257651589, 640.8451074545227, 598.8377182521357, 1344.1972842289176, 1084.1960006258323, 556.0546476064828, 549.7131979584631, 1364.3855228922587, 1422.64797674514, 1414.609855776013, 1089.1084010786526, 1129.565396724259, 576.7645395587031, 1287.532701350433, 1342.3623278703685, 785.495460510458, 906.8945274553029, 1510.7048554197645, 1162.657416239931, 662.8201287766784, 1291.5045209382865, 1058.772538457379, 1164.2456777118127, 1390.153669273477, 1209.4831655543396, 978.8268228182075, 1155.591468191684, 1237.5358418459416, 1179.2230646657172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.973266623211524, "mean_inference_ms": 6.919047553879909, "mean_action_processing_ms": 2.477231452692787, "mean_env_wait_ms": 16.662253497762887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03304123878479004, "StateBufferConnector_ms": 0.013967037200927734, "ViewRequirementAgentConnector_ms": 0.2545667886734009}, "num_episodes": 1, "episode_return_max": 561.8621032953702, "episode_return_min": 4.440892098500626e-16, "episode_return_mean": 166.76159385220518, "episodes_this_iter": 1}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 593184, "num_agent_steps_trained": 593184, "num_env_steps_sampled": 148296, "num_env_steps_trained": 148296, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 150.89895103285957, "num_env_steps_trained_throughput_per_sec": 150.89895103285957, "timesteps_total": 148296, "num_env_steps_sampled_lifetime": 148296, "num_agent_steps_sampled_lifetime": 593184, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 593184, "timers": {"training_iteration_time_ms": 27647.468, "restore_workers_time_ms": 0.033, "training_step_time_ms": 27647.068, "sample_time_ms": 3807.661, "learn_time_ms": 23809.344, "learn_throughput": 168.337, "synch_weights_time_ms": 26.532}, "counters": {"num_env_steps_sampled": 148296, "num_env_steps_trained": 148296, "num_agent_steps_sampled": 593184, "num_agent_steps_trained": 593184}, "done": false, "training_iteration": 37, "trial_id": "7f713_00000", "date": "2024-08-23_10-03-26", "timestamp": 1724387606, "time_this_iter_s": 26.595625162124634, "time_total_s": 1005.4933550357819, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737bde50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1005.4933550357819, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 38.80263157894736, "ram_util_percent": 83.18684210526315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.01378931923518, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.142860812232607, "policy_loss": -0.011608306483597194, "vf_loss": 8.152669358127332, "vf_explained_var": 0.6589685923208004, "kl": 0.008998842394008996, "entropy": 0.8765755869724132, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 35438.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.25606964656285, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.384260489953258, "policy_loss": -0.010086219140855723, "vf_loss": 8.392815209444239, "vf_explained_var": 0.3635328731208882, "kl": 0.007657428736744261, "entropy": 0.473604756845999, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 35438.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 152304, "num_env_steps_trained": 152304, "num_agent_steps_sampled": 609216, "num_agent_steps_trained": 609216}, "env_runners": {"episode_reward_max": 561.8621032953702, "episode_reward_min": 4.440892098500626e-16, "episode_reward_mean": 165.3977632162291, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1604.266800583997, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 272.33349012842467, "predator_policy": 1604.266800583997}, "policy_reward_mean": {"prey_policy": -936.1115639526473, "predator_policy": 1018.8104455607622}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.379911379854743, 0.20084320761501173, 258.5681334686508, 125.70860181130755, 196.05688532729272, 259.6036476146954, 63.39976845702112, 28.956330777917636, 27.773474228883412, 206.71395493008916, 66.08658375650391, 141.6466202322916, 2.299999999999995, 243.9498330003517, 396.3640397947582, 8.515364328623644, 259.70403056654493, 284.1639284150277, 340.1708310097941, 316.0916335318144, 134.04951604569948, 189.28255759799293, 335.5917161715117, 210.12155826215826, 9.997778012332212, 3.8808038190765988, 186.05653527053073, 136.7417868383303, 385.7540797087853, 193.41440310426452, 255.76522426475012, 154.3252719554891, 182.44929949581208, 192.2499191406796, 424.8759303246241, 116.44266605545852, 131.32534692022438, 66.76928384530245, 343.57076697537644, 68.57426226916672, 231.41234028582537, 366.94582902171226, 74.10482612826623, 214.0999999999969, 105.98396687235888, 355.8122949420211, 172.60500214160416, 455.2835051018787, 8.691233719273008, 49.48136244447405, 209.28178436880282, 1.4729535251892854, 242.94574904693755, 207.86080807768928, 1.0299146853448242, 114.16603409513846, 0.2817747232018015, 4.440892098500626e-16, 223.20024622544082, 561.8621032953702, 1.8579913884724861, 86.06815140976346, 171.86869433708063, 100.34547077793738, 176.46864342159597, 376.52405610613613, 368.9214971258995, 2.0192058749261736, 87.06747473349745, 446.9839977945975, 341.50551570454945, 96.82055475172663, 16.667732746466733, 254.99777907295316, 505.54519769725005, 0.4999999999999927, 77.82885343978054, 0.43391393483142027, 161.24490503450883, 204.66289925637378, 13.264454190000196, 10.68554672924964, 205.44416689395433, 149.41549314185642, 24.33122927774837, 149.18457813150792, 7.368769538327857, 1.1000000000000074, 314.69926549638325, 2.220446049250313e-15, 417.55069760407457, 179.11089541582706, 43.07247702388852, 199.56444069084262, 5.399423223409537, 17.55611850668155, 49.82745795819959, 425.0240163767849, 19.380438845184976, 284.3494673535116], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1065.9340458292345, -1034.7302521679724, -1604.266800583997, -1440.6188584035492, 258.51766656316323, -1373.391305181807, -895.6211579884788, -133.09595066646744, -1194.1864867461738, -568.4318061781602, -1306.9671357875275, -349.3613141817732, -1268.146075262068, -1208.2511487302772, -1264.3652432280758, -1009.8973073151318, -980.0427720963698, -1293.948741753348, -1132.2059667931949, -1438.4724910051773, -1252.0215349245186, -1086.172036604786, -957.0921935294833, -977.4725504831958, -1347.1012388525135, -1466.2419875865173, -811.8649107544206, -1391.953368539757, -337.5948776521533, -1268.836005075753, -850.014524082227, -1478.6601754054159, -111.57392265130278, -750.2779776612543, -198.39899751066253, -608.7316741292225, -878.396830866205, 167.5065612967733, -510.1662939441267, -874.6295482117968, -848.3463960252484, -900.7125515637906, -719.2286519483218, -312.1253694111769, -894.2300515214957, -264.7495609470833, -1251.891432937354, -996.3184951766791, -1288.4633760096985, -1336.361775828583, -1260.0227462266932, -1308.2937392159076, -1162.0843230162207, -179.9192774528517, -1354.3680533653378, -1098.5317344085336, -1182.6995458223978, -400.7608897918373, -913.7694467990996, -137.2599025836671, -1313.5508144695316, 132.4104871716217, -1255.7996571676806, -1195.5148943868328, -1152.8346953341872, -1294.5951385627195, -1359.6585265176618, 184.77333544546138, -1023.056086525308, -668.5851623842287, -376.8360747804394, -1034.2215235490912, -817.7511833091105, -965.3245910595349, -1067.878970409875, -1043.209814769419, -672.5266489015742, -1072.1441138200203, -853.3104784047267, -1402.4065253282556, -493.7371918334678, -583.7470339407499, -265.5573228619532, -1174.1035218410761, -1183.4940214374299, -1406.3421249627047, 155.2721824408259, 39.0713244102931, -965.1105490295781, -1371.3858733562486, -314.55964606839507, -85.83519806533687, -911.9782622390823, -332.5782018233436, 38.99179705481094, -1152.6102805154785, -1208.4160769490427, -1306.0832767587294, -645.1081304345352, -1312.756246199961, -1141.9145745604696, -1362.6230811874204, -1291.5981259390826, -1388.411309227952, -952.4620046947576, -106.22174525680617, -1110.692276054226, -1360.3012647609987, -1339.0141278824055, -1280.7238866819193, -1204.0693001047478, -1132.267547206779, -1083.4938436202012, -1249.5353832231453, -1370.1766573548452, -1344.22842648208, -113.50006043756419, -708.702591013963, 159.0476960190514, -1288.5946182135337, -1415.6184293587296, -1514.907459471273, -1023.8923104190754, -966.6254142216225, -852.1096472048399, -1356.5742089554249, -692.3701397687801, -1176.673493031536, -310.7585596814868, -1414.0745828265808, -988.0369099020268, 272.33349012842467, -411.07628777989163, -827.7240954128065, -1428.8388501488998, -1453.0676230421795, -1124.2559545905276, -1107.3491178367337, -47.595892335147525, -947.532007631226, -523.4402344319883, -218.71609659637988, -1466.5476196942775, -519.5689621550997, -1148.7463393084618, -1518.3318803572338, -947.6907692197715, -688.0715374589587, -452.59525366104805, -739.029762525562, -1412.781041794, -1443.8725093342885, -1222.0644828182942, -922.5772716368814, -1445.9998320253537, -1341.180606810776, -1243.2576569722007, -511.54217468223646, -854.1265908206578, -671.8699852122982, -1431.752750554914, -1039.1553126335725, -1458.039681998204, -1365.7355443808524, -1248.8910765727555, -742.3475186272833, -33.75021667533252, -1056.5171158894686, -1265.8197791174712, -1138.2422764595315, -868.6513602877816, -87.93190714565281, -1357.75439432509, -1421.9103357739807, -1414.609855776013, -1088.0084010786527, -217.59540655652663, -1174.0352642300506, -1287.532701350433, -1342.3623278703685, -1314.2215120659966, 39.382221704306495, -960.5307940488512, -1533.720582195017, -619.8343096999083, -1291.417862991163, -1085.8135175060554, -937.6402579722902, -1390.153669273477, -1204.0837423309304, -962.5707043115258, -1154.291468191684, -1240.8074437293737, -1126.1240048240852, -1082.6399112187773, -89.69432623019179, -1277.7216547661753, -1179.080957447646, -1218.7957251648916, 31.669219958635118], "policy_predator_policy_reward": [1027.054450492248, 1074.989758884814, 1604.266800583997, 1440.8197016111642, 0.0, 1373.4417720872946, 4.142265687372903, 1150.2834447788816, 1194.2956665992945, 764.3795116523324, 802.7025876306355, 1113.2295099533665, 1570.6813961374496, 969.1155963119196, 1273.465243228076, 1029.75363809305, 1025.0518898224286, 1276.713098256175, 1412.0907786431317, 1365.3016340853317, 1283.4465847737222, 1120.8335705120865, 983.5497364114573, 1092.6616278335134, 1349.4012388525136, 1466.2419875865173, 1378.8437769563275, 1068.924335338203, 823.565050456178, 1179.2298720664924, 859.3022496036598, 1477.887814212607, 344.76743968465115, 776.7884911944548, 5.868378675096686, 1085.4262213798158, 88.12836782512457, 962.9327327541005, 843.0040659409012, 857.8834097468407, 971.7422690222592, 911.3661946124802, 1186.730973105699, 33.90560585179279, 896.248282070415, 598.3230465696741, 1250.137175184871, 1208.1943111913224, 1314.2356149738425, 1320.5873148767716, 1262.705393136078, 1309.4918961255992, 929.3241411630039, 598.7359945765987, 1172.6575210982953, 1416.9840535139074, 1113.773376666058, 855.441138656972, 1160.5695221922185, 83.87423029481434, 1372.546875586466, 64.35867597619253, 1243.2446953271078, 1362.395128182894, 1372.1589613954318, 1257.7201719972888, 1360.6282248236005, 6.506885389279751, 1174.38359864627, 942.133580587891, 482.7531700080627, 1044.7470943769342, 966.9115473541912, 947.4895739346786, 1130.9990588943615, 1046.859010130235, 925.0261842237965, 1163.215345473178, 922.5593943887835, 1401.7318716133664, 665.2063799973544, 643.6901860626936, 1140.737859934178, 665.8688137905641, 1388.7489816877128, 1275.191990840688, 1.0971933913484455, 18.65929975753144, 1349.4468242921514, 1093.033564966036, 756.2071390757502, 0.0, 4.139602951821638, 1413.0218632522067, 707.1485086074099, 861.7534799551283, 1208.4160769490427, 1314.7745104780026, 1292.6043982615224, 714.7413408174478, 1372.123376022268, 1341.6960640944255, 1291.8949717795122, 1389.587416912712, 0.0, 1301.6294989985004, 1352.8919570414932, 1325.9623918514203, 1232.4550401364422, 1388.312889113229, 1233.1898514903046, 1217.3130299163597, 1083.893843620201, 1249.4171579463473, 1370.1766573548452, 1344.22842648208, 9.479693045655663, 1035.923204631312, 742.4237354683911, 948.985290021462, 1417.1764207472015, 1515.2074594712728, 1149.434629093598, 927.151246956862, 897.6553457408646, 1482.8972047564803, 1356.8700112838676, 612.5190922943863, 507.3713597069759, 1393.930426222696, 934.5621416207158, 157.6653342590226, 741.366726642799, 866.3551536757997, 1430.858056023826, 1453.0676230421795, 1208.223429324027, 1110.4491178367311, 570.4575735089841, 871.6543242519875, 1009.4654473016734, 74.19639943124518, 1469.118442408314, 613.8186941927908, 1165.4596265671867, 1518.2863258449759, 771.5759521112349, 1119.1841336404505, 915.0392818794757, 782.1309320043846, 1413.2810417939995, 1443.8725093342885, 1229.8644828182942, 992.606125076664, 1446.9998320253537, 1340.6145207456073, 1150.4905494930185, 765.5541871959309, 857.3337138768732, 873.3257614124585, 1431.829767680028, 1052.342749698459, 1459.2384864161963, 1375.2222866921104, 1173.815936328834, 1022.8668257651589, 640.8451074545227, 598.8377182521357, 1344.1972842289176, 1084.1960006258323, 556.0546476064828, 549.7131979584631, 1364.3855228922587, 1422.64797674514, 1414.609855776013, 1089.1084010786526, 1129.565396724259, 576.7645395587031, 1287.532701350433, 1342.3623278703685, 785.495460510458, 906.8945274553029, 1510.7048554197645, 1162.657416239931, 662.8201287766784, 1291.5045209382865, 1058.772538457379, 1164.2456777118127, 1390.153669273477, 1209.4831655543396, 978.8268228182075, 1155.591468191684, 1237.5358418459416, 1179.2230646657172, 916.7325853456791, 680.6256684800761, 1221.054401884132, 1255.1286491748735, 812.7277497781066, 658.7482227816596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.005582749909019, "mean_inference_ms": 6.9407303925108135, "mean_action_processing_ms": 2.48648430886312, "mean_env_wait_ms": 16.6886671508329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021039128303527832, "StateBufferConnector_ms": 0.012202978134155273, "ViewRequirementAgentConnector_ms": 0.26123499870300293}, "num_episodes": 3, "episode_return_max": 561.8621032953702, "episode_return_min": 4.440892098500626e-16, "episode_return_mean": 165.3977632162291, "episodes_this_iter": 3}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 609216, "num_agent_steps_trained": 609216, "num_env_steps_sampled": 152304, "num_env_steps_trained": 152304, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 140.31165414249878, "num_env_steps_trained_throughput_per_sec": 140.31165414249878, "timesteps_total": 152304, "num_env_steps_sampled_lifetime": 152304, "num_agent_steps_sampled_lifetime": 609216, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 609216, "timers": {"training_iteration_time_ms": 27776.238, "restore_workers_time_ms": 0.033, "training_step_time_ms": 27775.838, "sample_time_ms": 3901.036, "learn_time_ms": 23844.681, "learn_throughput": 168.088, "synch_weights_time_ms": 26.213}, "counters": {"num_env_steps_sampled": 152304, "num_env_steps_trained": 152304, "num_agent_steps_sampled": 609216, "num_agent_steps_trained": 609216}, "done": false, "training_iteration": 38, "trial_id": "7f713_00000", "date": "2024-08-23_10-03-55", "timestamp": 1724387635, "time_this_iter_s": 28.625751972198486, "time_total_s": 1034.1191070079803, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17378c040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1034.1191070079803, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 47.3775, "ram_util_percent": 83.33000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.56679985661986, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.116843886097904, "policy_loss": -0.009662336396378658, "vf_loss": 8.12468057359968, "vf_explained_var": 0.6210966509486001, "kl": 0.009128195009928532, "entropy": 0.8938694618366383, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 36383.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.67114337752105, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.444898868742444, "policy_loss": -0.0076099497512495395, "vf_loss": 8.451313261001829, "vf_explained_var": 0.31805765389134644, "kl": 0.005977857934074506, "entropy": 0.46723548435660267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 36383.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 156312, "num_env_steps_trained": 156312, "num_agent_steps_sampled": 625248, "num_agent_steps_trained": 625248}, "env_runners": {"episode_reward_max": 561.8621032953702, "episode_reward_min": 4.440892098500626e-16, "episode_reward_mean": 166.28698303237837, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1545.7408934181967, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 272.33349012842467, "predator_policy": 1546.7408934181967}, "policy_reward_mean": {"prey_policy": -950.4822740103095, "predator_policy": 1033.625765526499}, "custom_metrics": {}, "hist_stats": {"episode_reward": [28.956330777917636, 27.773474228883412, 206.71395493008916, 66.08658375650391, 141.6466202322916, 2.299999999999995, 243.9498330003517, 396.3640397947582, 8.515364328623644, 259.70403056654493, 284.1639284150277, 340.1708310097941, 316.0916335318144, 134.04951604569948, 189.28255759799293, 335.5917161715117, 210.12155826215826, 9.997778012332212, 3.8808038190765988, 186.05653527053073, 136.7417868383303, 385.7540797087853, 193.41440310426452, 255.76522426475012, 154.3252719554891, 182.44929949581208, 192.2499191406796, 424.8759303246241, 116.44266605545852, 131.32534692022438, 66.76928384530245, 343.57076697537644, 68.57426226916672, 231.41234028582537, 366.94582902171226, 74.10482612826623, 214.0999999999969, 105.98396687235888, 355.8122949420211, 172.60500214160416, 455.2835051018787, 8.691233719273008, 49.48136244447405, 209.28178436880282, 1.4729535251892854, 242.94574904693755, 207.86080807768928, 1.0299146853448242, 114.16603409513846, 0.2817747232018015, 4.440892098500626e-16, 223.20024622544082, 561.8621032953702, 1.8579913884724861, 86.06815140976346, 171.86869433708063, 100.34547077793738, 176.46864342159597, 376.52405610613613, 368.9214971258995, 2.0192058749261736, 87.06747473349745, 446.9839977945975, 341.50551570454945, 96.82055475172663, 16.667732746466733, 254.99777907295316, 505.54519769725005, 0.4999999999999927, 77.82885343978054, 0.43391393483142027, 161.24490503450883, 204.66289925637378, 13.264454190000196, 10.68554672924964, 205.44416689395433, 149.41549314185642, 24.33122927774837, 149.18457813150792, 7.368769538327857, 1.1000000000000074, 314.69926549638325, 2.220446049250313e-15, 417.55069760407457, 179.11089541582706, 43.07247702388852, 199.56444069084262, 5.399423223409537, 17.55611850668155, 49.82745795819959, 425.0240163767849, 19.380438845184976, 284.3494673535116, 0.9999999999999967, 8.666480233761053, 1.52122951308676, 431.18478316111106, 550.3672799734084, 0.5999999999999979, 0.4999999999999982], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1264.3652432280758, -1009.8973073151318, -980.0427720963698, -1293.948741753348, -1132.2059667931949, -1438.4724910051773, -1252.0215349245186, -1086.172036604786, -957.0921935294833, -977.4725504831958, -1347.1012388525135, -1466.2419875865173, -811.8649107544206, -1391.953368539757, -337.5948776521533, -1268.836005075753, -850.014524082227, -1478.6601754054159, -111.57392265130278, -750.2779776612543, -198.39899751066253, -608.7316741292225, -878.396830866205, 167.5065612967733, -510.1662939441267, -874.6295482117968, -848.3463960252484, -900.7125515637906, -719.2286519483218, -312.1253694111769, -894.2300515214957, -264.7495609470833, -1251.891432937354, -996.3184951766791, -1288.4633760096985, -1336.361775828583, -1260.0227462266932, -1308.2937392159076, -1162.0843230162207, -179.9192774528517, -1354.3680533653378, -1098.5317344085336, -1182.6995458223978, -400.7608897918373, -913.7694467990996, -137.2599025836671, -1313.5508144695316, 132.4104871716217, -1255.7996571676806, -1195.5148943868328, -1152.8346953341872, -1294.5951385627195, -1359.6585265176618, 184.77333544546138, -1023.056086525308, -668.5851623842287, -376.8360747804394, -1034.2215235490912, -817.7511833091105, -965.3245910595349, -1067.878970409875, -1043.209814769419, -672.5266489015742, -1072.1441138200203, -853.3104784047267, -1402.4065253282556, -493.7371918334678, -583.7470339407499, -265.5573228619532, -1174.1035218410761, -1183.4940214374299, -1406.3421249627047, 155.2721824408259, 39.0713244102931, -965.1105490295781, -1371.3858733562486, -314.55964606839507, -85.83519806533687, -911.9782622390823, -332.5782018233436, 38.99179705481094, -1152.6102805154785, -1208.4160769490427, -1306.0832767587294, -645.1081304345352, -1312.756246199961, -1141.9145745604696, -1362.6230811874204, -1291.5981259390826, -1388.411309227952, -952.4620046947576, -106.22174525680617, -1110.692276054226, -1360.3012647609987, -1339.0141278824055, -1280.7238866819193, -1204.0693001047478, -1132.267547206779, -1083.4938436202012, -1249.5353832231453, -1370.1766573548452, -1344.22842648208, -113.50006043756419, -708.702591013963, 159.0476960190514, -1288.5946182135337, -1415.6184293587296, -1514.907459471273, -1023.8923104190754, -966.6254142216225, -852.1096472048399, -1356.5742089554249, -692.3701397687801, -1176.673493031536, -310.7585596814868, -1414.0745828265808, -988.0369099020268, 272.33349012842467, -411.07628777989163, -827.7240954128065, -1428.8388501488998, -1453.0676230421795, -1124.2559545905276, -1107.3491178367337, -47.595892335147525, -947.532007631226, -523.4402344319883, -218.71609659637988, -1466.5476196942775, -519.5689621550997, -1148.7463393084618, -1518.3318803572338, -947.6907692197715, -688.0715374589587, -452.59525366104805, -739.029762525562, -1412.781041794, -1443.8725093342885, -1222.0644828182942, -922.5772716368814, -1445.9998320253537, -1341.180606810776, -1243.2576569722007, -511.54217468223646, -854.1265908206578, -671.8699852122982, -1431.752750554914, -1039.1553126335725, -1458.039681998204, -1365.7355443808524, -1248.8910765727555, -742.3475186272833, -33.75021667533252, -1056.5171158894686, -1265.8197791174712, -1138.2422764595315, -868.6513602877816, -87.93190714565281, -1357.75439432509, -1421.9103357739807, -1414.609855776013, -1088.0084010786527, -217.59540655652663, -1174.0352642300506, -1287.532701350433, -1342.3623278703685, -1314.2215120659966, 39.382221704306495, -960.5307940488512, -1533.720582195017, -619.8343096999083, -1291.417862991163, -1085.8135175060554, -937.6402579722902, -1390.153669273477, -1204.0837423309304, -962.5707043115258, -1154.291468191684, -1240.8074437293737, -1126.1240048240852, -1082.6399112187773, -89.69432623019179, -1277.7216547661753, -1179.080957447646, -1218.7957251648916, 31.669219958635118, -1480.3547985385767, -1545.7408934181967, -1420.350212581263, -1244.7000654500807, -1319.9596271951377, -1379.339355580666, -1207.6567575210338, -398.24595013163787, -791.3708661382852, 10.445160033115602, -1382.481436231161, -1266.230683093028, -1293.8951084951084, -1338.7460883357176], "policy_predator_policy_reward": [1273.465243228076, 1029.75363809305, 1025.0518898224286, 1276.713098256175, 1412.0907786431317, 1365.3016340853317, 1283.4465847737222, 1120.8335705120865, 983.5497364114573, 1092.6616278335134, 1349.4012388525136, 1466.2419875865173, 1378.8437769563275, 1068.924335338203, 823.565050456178, 1179.2298720664924, 859.3022496036598, 1477.887814212607, 344.76743968465115, 776.7884911944548, 5.868378675096686, 1085.4262213798158, 88.12836782512457, 962.9327327541005, 843.0040659409012, 857.8834097468407, 971.7422690222592, 911.3661946124802, 1186.730973105699, 33.90560585179279, 896.248282070415, 598.3230465696741, 1250.137175184871, 1208.1943111913224, 1314.2356149738425, 1320.5873148767716, 1262.705393136078, 1309.4918961255992, 929.3241411630039, 598.7359945765987, 1172.6575210982953, 1416.9840535139074, 1113.773376666058, 855.441138656972, 1160.5695221922185, 83.87423029481434, 1372.546875586466, 64.35867597619253, 1243.2446953271078, 1362.395128182894, 1372.1589613954318, 1257.7201719972888, 1360.6282248236005, 6.506885389279751, 1174.38359864627, 942.133580587891, 482.7531700080627, 1044.7470943769342, 966.9115473541912, 947.4895739346786, 1130.9990588943615, 1046.859010130235, 925.0261842237965, 1163.215345473178, 922.5593943887835, 1401.7318716133664, 665.2063799973544, 643.6901860626936, 1140.737859934178, 665.8688137905641, 1388.7489816877128, 1275.191990840688, 1.0971933913484455, 18.65929975753144, 1349.4468242921514, 1093.033564966036, 756.2071390757502, 0.0, 4.139602951821638, 1413.0218632522067, 707.1485086074099, 861.7534799551283, 1208.4160769490427, 1314.7745104780026, 1292.6043982615224, 714.7413408174478, 1372.123376022268, 1341.6960640944255, 1291.8949717795122, 1389.587416912712, 0.0, 1301.6294989985004, 1352.8919570414932, 1325.9623918514203, 1232.4550401364422, 1388.312889113229, 1233.1898514903046, 1217.3130299163597, 1083.893843620201, 1249.4171579463473, 1370.1766573548452, 1344.22842648208, 9.479693045655663, 1035.923204631312, 742.4237354683911, 948.985290021462, 1417.1764207472015, 1515.2074594712728, 1149.434629093598, 927.151246956862, 897.6553457408646, 1482.8972047564803, 1356.8700112838676, 612.5190922943863, 507.3713597069759, 1393.930426222696, 934.5621416207158, 157.6653342590226, 741.366726642799, 866.3551536757997, 1430.858056023826, 1453.0676230421795, 1208.223429324027, 1110.4491178367311, 570.4575735089841, 871.6543242519875, 1009.4654473016734, 74.19639943124518, 1469.118442408314, 613.8186941927908, 1165.4596265671867, 1518.2863258449759, 771.5759521112349, 1119.1841336404505, 915.0392818794757, 782.1309320043846, 1413.2810417939995, 1443.8725093342885, 1229.8644828182942, 992.606125076664, 1446.9998320253537, 1340.6145207456073, 1150.4905494930185, 765.5541871959309, 857.3337138768732, 873.3257614124585, 1431.829767680028, 1052.342749698459, 1459.2384864161963, 1375.2222866921104, 1173.815936328834, 1022.8668257651589, 640.8451074545227, 598.8377182521357, 1344.1972842289176, 1084.1960006258323, 556.0546476064828, 549.7131979584631, 1364.3855228922587, 1422.64797674514, 1414.609855776013, 1089.1084010786526, 1129.565396724259, 576.7645395587031, 1287.532701350433, 1342.3623278703685, 785.495460510458, 906.8945274553029, 1510.7048554197645, 1162.657416239931, 662.8201287766784, 1291.5045209382865, 1058.772538457379, 1164.2456777118127, 1390.153669273477, 1209.4831655543396, 978.8268228182075, 1155.591468191684, 1237.5358418459416, 1179.2230646657172, 916.7325853456791, 680.6256684800761, 1221.054401884132, 1255.1286491748735, 812.7277497781066, 658.7482227816596, 1480.3547985385767, 1546.7408934181967, 1420.7502125812628, 1252.9665456838422, 1320.1807061724226, 1380.639506116468, 1147.8381531147331, 889.24933769905, 866.1358224073459, 465.1571636712331, 1382.481436231161, 1266.830683093028, 1294.2951084951083, 1338.8460883357177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.037007487219512, "mean_inference_ms": 7.01082790459155, "mean_action_processing_ms": 2.4949755136675176, "mean_env_wait_ms": 16.719306836031006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020428776741027832, "StateBufferConnector_ms": 0.012167811393737793, "ViewRequirementAgentConnector_ms": 0.27176201343536377}, "num_episodes": 7, "episode_return_max": 561.8621032953702, "episode_return_min": 4.440892098500626e-16, "episode_return_mean": 166.28698303237837, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 625248, "num_agent_steps_trained": 625248, "num_env_steps_sampled": 156312, "num_env_steps_trained": 156312, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 147.7396537766958, "num_env_steps_trained_throughput_per_sec": 147.7396537766958, "timesteps_total": 156312, "num_env_steps_sampled_lifetime": 156312, "num_agent_steps_sampled_lifetime": 625248, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 625248, "timers": {"training_iteration_time_ms": 27887.888, "restore_workers_time_ms": 0.032, "training_step_time_ms": 27887.488, "sample_time_ms": 4013.577, "learn_time_ms": 23843.882, "learn_throughput": 168.093, "synch_weights_time_ms": 26.188}, "counters": {"num_env_steps_sampled": 156312, "num_env_steps_trained": 156312, "num_agent_steps_sampled": 625248, "num_agent_steps_trained": 625248}, "done": false, "training_iteration": 39, "trial_id": "7f713_00000", "date": "2024-08-23_10-04-22", "timestamp": 1724387662, "time_this_iter_s": 27.189444065093994, "time_total_s": 1061.3085510730743, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17378cf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1061.3085510730743, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 40.42307692307693, "ram_util_percent": 83.27948717948718}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.892397016570683, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.951851338179654, "policy_loss": -0.01191985244424176, "vf_loss": 7.961984582931277, "vf_explained_var": 0.6446795230820066, "kl": 0.008933140129397905, "entropy": 0.8623214533720067, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 37328.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.898294951171472, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.317996903071327, "policy_loss": -0.009020506721926193, "vf_loss": 8.325936889143849, "vf_explained_var": 0.33707002805023595, "kl": 0.0054024992904887, "entropy": 0.44602579651055513, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 37328.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 160320, "num_env_steps_trained": 160320, "num_agent_steps_sampled": 641280, "num_agent_steps_trained": 641280}, "env_runners": {"episode_reward_max": 561.8621032953702, "episode_reward_min": 4.440892098500626e-16, "episode_reward_mean": 177.27293679296065, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1545.7408934181967, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 291.1502781557372, "predator_policy": 1546.7408934181967}, "policy_reward_mean": {"prey_policy": -919.3697180382406, "predator_policy": 1008.0061864347211}, "custom_metrics": {}, "hist_stats": {"episode_reward": [340.1708310097941, 316.0916335318144, 134.04951604569948, 189.28255759799293, 335.5917161715117, 210.12155826215826, 9.997778012332212, 3.8808038190765988, 186.05653527053073, 136.7417868383303, 385.7540797087853, 193.41440310426452, 255.76522426475012, 154.3252719554891, 182.44929949581208, 192.2499191406796, 424.8759303246241, 116.44266605545852, 131.32534692022438, 66.76928384530245, 343.57076697537644, 68.57426226916672, 231.41234028582537, 366.94582902171226, 74.10482612826623, 214.0999999999969, 105.98396687235888, 355.8122949420211, 172.60500214160416, 455.2835051018787, 8.691233719273008, 49.48136244447405, 209.28178436880282, 1.4729535251892854, 242.94574904693755, 207.86080807768928, 1.0299146853448242, 114.16603409513846, 0.2817747232018015, 4.440892098500626e-16, 223.20024622544082, 561.8621032953702, 1.8579913884724861, 86.06815140976346, 171.86869433708063, 100.34547077793738, 176.46864342159597, 376.52405610613613, 368.9214971258995, 2.0192058749261736, 87.06747473349745, 446.9839977945975, 341.50551570454945, 96.82055475172663, 16.667732746466733, 254.99777907295316, 505.54519769725005, 0.4999999999999927, 77.82885343978054, 0.43391393483142027, 161.24490503450883, 204.66289925637378, 13.264454190000196, 10.68554672924964, 205.44416689395433, 149.41549314185642, 24.33122927774837, 149.18457813150792, 7.368769538327857, 1.1000000000000074, 314.69926549638325, 2.220446049250313e-15, 417.55069760407457, 179.11089541582706, 43.07247702388852, 199.56444069084262, 5.399423223409537, 17.55611850668155, 49.82745795819959, 425.0240163767849, 19.380438845184976, 284.3494673535116, 0.9999999999999967, 8.666480233761053, 1.52122951308676, 431.18478316111106, 550.3672799734084, 0.5999999999999979, 0.4999999999999982, 524.2912542297894, 523.96839068652, 0.3500302715172303, 266.65190351545084, 307.800934875856, 160.71572091243206, 411.87666379536086, 87.58125036920752, 103.53589567120694, 208.57506117046177, 169.42243059141433], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-878.396830866205, 167.5065612967733, -510.1662939441267, -874.6295482117968, -848.3463960252484, -900.7125515637906, -719.2286519483218, -312.1253694111769, -894.2300515214957, -264.7495609470833, -1251.891432937354, -996.3184951766791, -1288.4633760096985, -1336.361775828583, -1260.0227462266932, -1308.2937392159076, -1162.0843230162207, -179.9192774528517, -1354.3680533653378, -1098.5317344085336, -1182.6995458223978, -400.7608897918373, -913.7694467990996, -137.2599025836671, -1313.5508144695316, 132.4104871716217, -1255.7996571676806, -1195.5148943868328, -1152.8346953341872, -1294.5951385627195, -1359.6585265176618, 184.77333544546138, -1023.056086525308, -668.5851623842287, -376.8360747804394, -1034.2215235490912, -817.7511833091105, -965.3245910595349, -1067.878970409875, -1043.209814769419, -672.5266489015742, -1072.1441138200203, -853.3104784047267, -1402.4065253282556, -493.7371918334678, -583.7470339407499, -265.5573228619532, -1174.1035218410761, -1183.4940214374299, -1406.3421249627047, 155.2721824408259, 39.0713244102931, -965.1105490295781, -1371.3858733562486, -314.55964606839507, -85.83519806533687, -911.9782622390823, -332.5782018233436, 38.99179705481094, -1152.6102805154785, -1208.4160769490427, -1306.0832767587294, -645.1081304345352, -1312.756246199961, -1141.9145745604696, -1362.6230811874204, -1291.5981259390826, -1388.411309227952, -952.4620046947576, -106.22174525680617, -1110.692276054226, -1360.3012647609987, -1339.0141278824055, -1280.7238866819193, -1204.0693001047478, -1132.267547206779, -1083.4938436202012, -1249.5353832231453, -1370.1766573548452, -1344.22842648208, -113.50006043756419, -708.702591013963, 159.0476960190514, -1288.5946182135337, -1415.6184293587296, -1514.907459471273, -1023.8923104190754, -966.6254142216225, -852.1096472048399, -1356.5742089554249, -692.3701397687801, -1176.673493031536, -310.7585596814868, -1414.0745828265808, -988.0369099020268, 272.33349012842467, -411.07628777989163, -827.7240954128065, -1428.8388501488998, -1453.0676230421795, -1124.2559545905276, -1107.3491178367337, -47.595892335147525, -947.532007631226, -523.4402344319883, -218.71609659637988, -1466.5476196942775, -519.5689621550997, -1148.7463393084618, -1518.3318803572338, -947.6907692197715, -688.0715374589587, -452.59525366104805, -739.029762525562, -1412.781041794, -1443.8725093342885, -1222.0644828182942, -922.5772716368814, -1445.9998320253537, -1341.180606810776, -1243.2576569722007, -511.54217468223646, -854.1265908206578, -671.8699852122982, -1431.752750554914, -1039.1553126335725, -1458.039681998204, -1365.7355443808524, -1248.8910765727555, -742.3475186272833, -33.75021667533252, -1056.5171158894686, -1265.8197791174712, -1138.2422764595315, -868.6513602877816, -87.93190714565281, -1357.75439432509, -1421.9103357739807, -1414.609855776013, -1088.0084010786527, -217.59540655652663, -1174.0352642300506, -1287.532701350433, -1342.3623278703685, -1314.2215120659966, 39.382221704306495, -960.5307940488512, -1533.720582195017, -619.8343096999083, -1291.417862991163, -1085.8135175060554, -937.6402579722902, -1390.153669273477, -1204.0837423309304, -962.5707043115258, -1154.291468191684, -1240.8074437293737, -1126.1240048240852, -1082.6399112187773, -89.69432623019179, -1277.7216547661753, -1179.080957447646, -1218.7957251648916, 31.669219958635118, -1480.3547985385767, -1545.7408934181967, -1420.350212581263, -1244.7000654500807, -1319.9596271951377, -1379.339355580666, -1207.6567575210338, -398.24595013163787, -791.3708661382852, 10.445160033115602, -1382.481436231161, -1266.230683093028, -1293.8951084951084, -1338.7460883357176, -1198.8132657794422, 40.0000000000003, 31.32273043566605, -854.3721882430644, -1426.3339145974971, -1189.6486950948977, -1025.7563676457196, -445.5318984992967, 291.1502781557372, -1365.6083691354052, -749.422534307358, -909.2432658572653, -1140.8160550747189, -201.58598135939093, -847.6892813435395, -25.264049214685755, -1203.771569905877, -1179.342278351509, -1327.118119807983, 201.80608002042382, 40.0000000000003, -1304.390557614894], "policy_predator_policy_reward": [88.12836782512457, 962.9327327541005, 843.0040659409012, 857.8834097468407, 971.7422690222592, 911.3661946124802, 1186.730973105699, 33.90560585179279, 896.248282070415, 598.3230465696741, 1250.137175184871, 1208.1943111913224, 1314.2356149738425, 1320.5873148767716, 1262.705393136078, 1309.4918961255992, 929.3241411630039, 598.7359945765987, 1172.6575210982953, 1416.9840535139074, 1113.773376666058, 855.441138656972, 1160.5695221922185, 83.87423029481434, 1372.546875586466, 64.35867597619253, 1243.2446953271078, 1362.395128182894, 1372.1589613954318, 1257.7201719972888, 1360.6282248236005, 6.506885389279751, 1174.38359864627, 942.133580587891, 482.7531700080627, 1044.7470943769342, 966.9115473541912, 947.4895739346786, 1130.9990588943615, 1046.859010130235, 925.0261842237965, 1163.215345473178, 922.5593943887835, 1401.7318716133664, 665.2063799973544, 643.6901860626936, 1140.737859934178, 665.8688137905641, 1388.7489816877128, 1275.191990840688, 1.0971933913484455, 18.65929975753144, 1349.4468242921514, 1093.033564966036, 756.2071390757502, 0.0, 4.139602951821638, 1413.0218632522067, 707.1485086074099, 861.7534799551283, 1208.4160769490427, 1314.7745104780026, 1292.6043982615224, 714.7413408174478, 1372.123376022268, 1341.6960640944255, 1291.8949717795122, 1389.587416912712, 0.0, 1301.6294989985004, 1352.8919570414932, 1325.9623918514203, 1232.4550401364422, 1388.312889113229, 1233.1898514903046, 1217.3130299163597, 1083.893843620201, 1249.4171579463473, 1370.1766573548452, 1344.22842648208, 9.479693045655663, 1035.923204631312, 742.4237354683911, 948.985290021462, 1417.1764207472015, 1515.2074594712728, 1149.434629093598, 927.151246956862, 897.6553457408646, 1482.8972047564803, 1356.8700112838676, 612.5190922943863, 507.3713597069759, 1393.930426222696, 934.5621416207158, 157.6653342590226, 741.366726642799, 866.3551536757997, 1430.858056023826, 1453.0676230421795, 1208.223429324027, 1110.4491178367311, 570.4575735089841, 871.6543242519875, 1009.4654473016734, 74.19639943124518, 1469.118442408314, 613.8186941927908, 1165.4596265671867, 1518.2863258449759, 771.5759521112349, 1119.1841336404505, 915.0392818794757, 782.1309320043846, 1413.2810417939995, 1443.8725093342885, 1229.8644828182942, 992.606125076664, 1446.9998320253537, 1340.6145207456073, 1150.4905494930185, 765.5541871959309, 857.3337138768732, 873.3257614124585, 1431.829767680028, 1052.342749698459, 1459.2384864161963, 1375.2222866921104, 1173.815936328834, 1022.8668257651589, 640.8451074545227, 598.8377182521357, 1344.1972842289176, 1084.1960006258323, 556.0546476064828, 549.7131979584631, 1364.3855228922587, 1422.64797674514, 1414.609855776013, 1089.1084010786526, 1129.565396724259, 576.7645395587031, 1287.532701350433, 1342.3623278703685, 785.495460510458, 906.8945274553029, 1510.7048554197645, 1162.657416239931, 662.8201287766784, 1291.5045209382865, 1058.772538457379, 1164.2456777118127, 1390.153669273477, 1209.4831655543396, 978.8268228182075, 1155.591468191684, 1237.5358418459416, 1179.2230646657172, 916.7325853456791, 680.6256684800761, 1221.054401884132, 1255.1286491748735, 812.7277497781066, 658.7482227816596, 1480.3547985385767, 1546.7408934181967, 1420.7502125812628, 1252.9665456838422, 1320.1807061724226, 1380.639506116468, 1147.8381531147331, 889.24933769905, 866.1358224073459, 465.1571636712331, 1382.481436231161, 1266.830683093028, 1294.2951084951083, 1338.8460883357177, 666.1469557616916, 1016.9575642475401, 668.9706762255157, 678.0471722683975, 1426.3339145974971, 1189.9987253664149, 993.3004155434796, 744.6397541169863, 15.964316576401409, 1366.2947092791228, 378.89170796324476, 1440.4898131138084, 1108.3939708941652, 645.8847293353052, 590.1420223720913, 370.3925585553416, 1376.640334906758, 1110.0094090218329, 1333.1181198079826, 0.7689811500379805, 157.4998292856848, 1276.3131589206232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.12318710701228, "mean_inference_ms": 7.093846413518971, "mean_action_processing_ms": 2.5249547470430067, "mean_env_wait_ms": 16.80036500987568, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02042210102081299, "StateBufferConnector_ms": 0.012201070785522461, "ViewRequirementAgentConnector_ms": 0.3011423349380493}, "num_episodes": 11, "episode_return_max": 561.8621032953702, "episode_return_min": 4.440892098500626e-16, "episode_return_mean": 177.27293679296065, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 641280, "num_agent_steps_trained": 641280, "num_env_steps_sampled": 160320, "num_env_steps_trained": 160320, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 150.27533705074774, "num_env_steps_trained_throughput_per_sec": 150.27533705074774, "timesteps_total": 160320, "num_env_steps_sampled_lifetime": 160320, "num_agent_steps_sampled_lifetime": 641280, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 641280, "timers": {"training_iteration_time_ms": 27864.747, "restore_workers_time_ms": 0.031, "training_step_time_ms": 27864.178, "sample_time_ms": 3945.471, "learn_time_ms": 23888.375, "learn_throughput": 167.78, "synch_weights_time_ms": 26.258}, "counters": {"num_env_steps_sampled": 160320, "num_env_steps_trained": 160320, "num_agent_steps_sampled": 641280, "num_agent_steps_trained": 641280}, "done": false, "training_iteration": 40, "trial_id": "7f713_00000", "date": "2024-08-23_10-04-49", "timestamp": 1724387689, "time_this_iter_s": 26.718003273010254, "time_total_s": 1088.0265543460846, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737c1160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1088.0265543460846, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 40.39729729729731, "ram_util_percent": 82.86216216216216}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.57474300268466, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.050210417893828, "policy_loss": -0.012864044523999963, "vf_loss": 8.06116097566312, "vf_explained_var": 0.583254308675332, "kl": 0.009567490340304123, "entropy": 0.8152950497531386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 38273.0, "diff_num_grad_updates_vs_sampler_policy": 489.68338323353237}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.647227077130918, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.526913164532374, "policy_loss": -0.01000902708619833, "vf_loss": 8.535735161594612, "vf_explained_var": 0.2728022601869371, "kl": 0.005935074899853183, "entropy": 0.4107175271347086, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 38273.0, "diff_num_grad_updates_vs_sampler_policy": 489.68338323353237}}, "num_env_steps_sampled": 164328, "num_env_steps_trained": 164328, "num_agent_steps_sampled": 657312, "num_agent_steps_trained": 657312}, "env_runners": {"episode_reward_max": 612.0295483913046, "episode_reward_min": 4.440892098500626e-16, "episode_reward_mean": 181.994848942627, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1545.7408934181967, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 291.1502781557372, "predator_policy": 1546.7408934181967}, "policy_reward_mean": {"prey_policy": -905.7107584748082, "predator_policy": 996.708182946122}, "custom_metrics": {}, "hist_stats": {"episode_reward": [186.05653527053073, 136.7417868383303, 385.7540797087853, 193.41440310426452, 255.76522426475012, 154.3252719554891, 182.44929949581208, 192.2499191406796, 424.8759303246241, 116.44266605545852, 131.32534692022438, 66.76928384530245, 343.57076697537644, 68.57426226916672, 231.41234028582537, 366.94582902171226, 74.10482612826623, 214.0999999999969, 105.98396687235888, 355.8122949420211, 172.60500214160416, 455.2835051018787, 8.691233719273008, 49.48136244447405, 209.28178436880282, 1.4729535251892854, 242.94574904693755, 207.86080807768928, 1.0299146853448242, 114.16603409513846, 0.2817747232018015, 4.440892098500626e-16, 223.20024622544082, 561.8621032953702, 1.8579913884724861, 86.06815140976346, 171.86869433708063, 100.34547077793738, 176.46864342159597, 376.52405610613613, 368.9214971258995, 2.0192058749261736, 87.06747473349745, 446.9839977945975, 341.50551570454945, 96.82055475172663, 16.667732746466733, 254.99777907295316, 505.54519769725005, 0.4999999999999927, 77.82885343978054, 0.43391393483142027, 161.24490503450883, 204.66289925637378, 13.264454190000196, 10.68554672924964, 205.44416689395433, 149.41549314185642, 24.33122927774837, 149.18457813150792, 7.368769538327857, 1.1000000000000074, 314.69926549638325, 2.220446049250313e-15, 417.55069760407457, 179.11089541582706, 43.07247702388852, 199.56444069084262, 5.399423223409537, 17.55611850668155, 49.82745795819959, 425.0240163767849, 19.380438845184976, 284.3494673535116, 0.9999999999999967, 8.666480233761053, 1.52122951308676, 431.18478316111106, 550.3672799734084, 0.5999999999999979, 0.4999999999999982, 524.2912542297894, 523.96839068652, 0.3500302715172303, 266.65190351545084, 307.800934875856, 160.71572091243206, 411.87666379536086, 87.58125036920752, 103.53589567120694, 208.57506117046177, 169.42243059141433, 194.17361121876237, 377.402240608259, 228.6803436388489, 296.8080135427653, 612.0295483913046, 13.66652520385333, 12.010089131738543, 276.6072376814803], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1162.0843230162207, -179.9192774528517, -1354.3680533653378, -1098.5317344085336, -1182.6995458223978, -400.7608897918373, -913.7694467990996, -137.2599025836671, -1313.5508144695316, 132.4104871716217, -1255.7996571676806, -1195.5148943868328, -1152.8346953341872, -1294.5951385627195, -1359.6585265176618, 184.77333544546138, -1023.056086525308, -668.5851623842287, -376.8360747804394, -1034.2215235490912, -817.7511833091105, -965.3245910595349, -1067.878970409875, -1043.209814769419, -672.5266489015742, -1072.1441138200203, -853.3104784047267, -1402.4065253282556, -493.7371918334678, -583.7470339407499, -265.5573228619532, -1174.1035218410761, -1183.4940214374299, -1406.3421249627047, 155.2721824408259, 39.0713244102931, -965.1105490295781, -1371.3858733562486, -314.55964606839507, -85.83519806533687, -911.9782622390823, -332.5782018233436, 38.99179705481094, -1152.6102805154785, -1208.4160769490427, -1306.0832767587294, -645.1081304345352, -1312.756246199961, -1141.9145745604696, -1362.6230811874204, -1291.5981259390826, -1388.411309227952, -952.4620046947576, -106.22174525680617, -1110.692276054226, -1360.3012647609987, -1339.0141278824055, -1280.7238866819193, -1204.0693001047478, -1132.267547206779, -1083.4938436202012, -1249.5353832231453, -1370.1766573548452, -1344.22842648208, -113.50006043756419, -708.702591013963, 159.0476960190514, -1288.5946182135337, -1415.6184293587296, -1514.907459471273, -1023.8923104190754, -966.6254142216225, -852.1096472048399, -1356.5742089554249, -692.3701397687801, -1176.673493031536, -310.7585596814868, -1414.0745828265808, -988.0369099020268, 272.33349012842467, -411.07628777989163, -827.7240954128065, -1428.8388501488998, -1453.0676230421795, -1124.2559545905276, -1107.3491178367337, -47.595892335147525, -947.532007631226, -523.4402344319883, -218.71609659637988, -1466.5476196942775, -519.5689621550997, -1148.7463393084618, -1518.3318803572338, -947.6907692197715, -688.0715374589587, -452.59525366104805, -739.029762525562, -1412.781041794, -1443.8725093342885, -1222.0644828182942, -922.5772716368814, -1445.9998320253537, -1341.180606810776, -1243.2576569722007, -511.54217468223646, -854.1265908206578, -671.8699852122982, -1431.752750554914, -1039.1553126335725, -1458.039681998204, -1365.7355443808524, -1248.8910765727555, -742.3475186272833, -33.75021667533252, -1056.5171158894686, -1265.8197791174712, -1138.2422764595315, -868.6513602877816, -87.93190714565281, -1357.75439432509, -1421.9103357739807, -1414.609855776013, -1088.0084010786527, -217.59540655652663, -1174.0352642300506, -1287.532701350433, -1342.3623278703685, -1314.2215120659966, 39.382221704306495, -960.5307940488512, -1533.720582195017, -619.8343096999083, -1291.417862991163, -1085.8135175060554, -937.6402579722902, -1390.153669273477, -1204.0837423309304, -962.5707043115258, -1154.291468191684, -1240.8074437293737, -1126.1240048240852, -1082.6399112187773, -89.69432623019179, -1277.7216547661753, -1179.080957447646, -1218.7957251648916, 31.669219958635118, -1480.3547985385767, -1545.7408934181967, -1420.350212581263, -1244.7000654500807, -1319.9596271951377, -1379.339355580666, -1207.6567575210338, -398.24595013163787, -791.3708661382852, 10.445160033115602, -1382.481436231161, -1266.230683093028, -1293.8951084951084, -1338.7460883357176, -1198.8132657794422, 40.0000000000003, 31.32273043566605, -854.3721882430644, -1426.3339145974971, -1189.6486950948977, -1025.7563676457196, -445.5318984992967, 291.1502781557372, -1365.6083691354052, -749.422534307358, -909.2432658572653, -1140.8160550747189, -201.58598135939093, -847.6892813435395, -25.264049214685755, -1203.771569905877, -1179.342278351509, -1327.118119807983, 201.80608002042382, 40.0000000000003, -1304.390557614894, -972.7143094136925, -174.6010433792558, -374.8500210176404, -848.2283082578912, 31.409061599047963, -1353.3889980774848, -990.0200085218129, -467.6873207911829, -820.7178946506284, 29.707428604293714, -794.7602196710975, -1235.1028014886872, -1134.6574372864065, -809.0244757780292, -979.2464277226975, 149.2444300022631], "policy_predator_policy_reward": [929.3241411630039, 598.7359945765987, 1172.6575210982953, 1416.9840535139074, 1113.773376666058, 855.441138656972, 1160.5695221922185, 83.87423029481434, 1372.546875586466, 64.35867597619253, 1243.2446953271078, 1362.395128182894, 1372.1589613954318, 1257.7201719972888, 1360.6282248236005, 6.506885389279751, 1174.38359864627, 942.133580587891, 482.7531700080627, 1044.7470943769342, 966.9115473541912, 947.4895739346786, 1130.9990588943615, 1046.859010130235, 925.0261842237965, 1163.215345473178, 922.5593943887835, 1401.7318716133664, 665.2063799973544, 643.6901860626936, 1140.737859934178, 665.8688137905641, 1388.7489816877128, 1275.191990840688, 1.0971933913484455, 18.65929975753144, 1349.4468242921514, 1093.033564966036, 756.2071390757502, 0.0, 4.139602951821638, 1413.0218632522067, 707.1485086074099, 861.7534799551283, 1208.4160769490427, 1314.7745104780026, 1292.6043982615224, 714.7413408174478, 1372.123376022268, 1341.6960640944255, 1291.8949717795122, 1389.587416912712, 0.0, 1301.6294989985004, 1352.8919570414932, 1325.9623918514203, 1232.4550401364422, 1388.312889113229, 1233.1898514903046, 1217.3130299163597, 1083.893843620201, 1249.4171579463473, 1370.1766573548452, 1344.22842648208, 9.479693045655663, 1035.923204631312, 742.4237354683911, 948.985290021462, 1417.1764207472015, 1515.2074594712728, 1149.434629093598, 927.151246956862, 897.6553457408646, 1482.8972047564803, 1356.8700112838676, 612.5190922943863, 507.3713597069759, 1393.930426222696, 934.5621416207158, 157.6653342590226, 741.366726642799, 866.3551536757997, 1430.858056023826, 1453.0676230421795, 1208.223429324027, 1110.4491178367311, 570.4575735089841, 871.6543242519875, 1009.4654473016734, 74.19639943124518, 1469.118442408314, 613.8186941927908, 1165.4596265671867, 1518.2863258449759, 771.5759521112349, 1119.1841336404505, 915.0392818794757, 782.1309320043846, 1413.2810417939995, 1443.8725093342885, 1229.8644828182942, 992.606125076664, 1446.9998320253537, 1340.6145207456073, 1150.4905494930185, 765.5541871959309, 857.3337138768732, 873.3257614124585, 1431.829767680028, 1052.342749698459, 1459.2384864161963, 1375.2222866921104, 1173.815936328834, 1022.8668257651589, 640.8451074545227, 598.8377182521357, 1344.1972842289176, 1084.1960006258323, 556.0546476064828, 549.7131979584631, 1364.3855228922587, 1422.64797674514, 1414.609855776013, 1089.1084010786526, 1129.565396724259, 576.7645395587031, 1287.532701350433, 1342.3623278703685, 785.495460510458, 906.8945274553029, 1510.7048554197645, 1162.657416239931, 662.8201287766784, 1291.5045209382865, 1058.772538457379, 1164.2456777118127, 1390.153669273477, 1209.4831655543396, 978.8268228182075, 1155.591468191684, 1237.5358418459416, 1179.2230646657172, 916.7325853456791, 680.6256684800761, 1221.054401884132, 1255.1286491748735, 812.7277497781066, 658.7482227816596, 1480.3547985385767, 1546.7408934181967, 1420.7502125812628, 1252.9665456838422, 1320.1807061724226, 1380.639506116468, 1147.8381531147331, 889.24933769905, 866.1358224073459, 465.1571636712331, 1382.481436231161, 1266.830683093028, 1294.2951084951083, 1338.8460883357177, 666.1469557616916, 1016.9575642475401, 668.9706762255157, 678.0471722683975, 1426.3339145974971, 1189.9987253664149, 993.3004155434796, 744.6397541169863, 15.964316576401409, 1366.2947092791228, 378.89170796324476, 1440.4898131138084, 1108.3939708941652, 645.8847293353052, 590.1420223720913, 370.3925585553416, 1376.640334906758, 1110.0094090218329, 1333.1181198079826, 0.7689811500379805, 157.4998292856848, 1276.3131589206232, 604.9819385739548, 736.5070254377541, 1018.0597184328325, 582.4208514509593, 227.36278578571518, 1323.2974943315737, 959.2941695302165, 795.2211733255486, 597.223853337842, 805.8161610997901, 803.437845228149, 1240.091701135489, 1130.005778174471, 825.6862240217039, 479.9929297084121, 626.6163056935037]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.15829060931583, "mean_inference_ms": 7.15868854877581, "mean_action_processing_ms": 2.5530663154442026, "mean_env_wait_ms": 16.84863365995046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020571589469909668, "StateBufferConnector_ms": 0.012303590774536133, "ViewRequirementAgentConnector_ms": 0.3064178228378296}, "num_episodes": 8, "episode_return_max": 612.0295483913046, "episode_return_min": 4.440892098500626e-16, "episode_return_mean": 181.994848942627, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 657312, "num_agent_steps_trained": 657312, "num_env_steps_sampled": 164328, "num_env_steps_trained": 164328, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 151.71936398908372, "num_env_steps_trained_throughput_per_sec": 151.71936398908372, "timesteps_total": 164328, "num_env_steps_sampled_lifetime": 164328, "num_agent_steps_sampled_lifetime": 657312, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 657312, "timers": {"training_iteration_time_ms": 27859.298, "restore_workers_time_ms": 0.03, "training_step_time_ms": 27858.716, "sample_time_ms": 3980.163, "learn_time_ms": 23847.892, "learn_throughput": 168.065, "synch_weights_time_ms": 26.611}, "counters": {"num_env_steps_sampled": 164328, "num_env_steps_trained": 164328, "num_agent_steps_sampled": 657312, "num_agent_steps_trained": 657312}, "done": false, "training_iteration": 41, "trial_id": "7f713_00000", "date": "2024-08-23_10-05-16", "timestamp": 1724387716, "time_this_iter_s": 26.431150197982788, "time_total_s": 1114.4577045440674, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17380c790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1114.4577045440674, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 38.536842105263155, "ram_util_percent": 83.21315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.93346294801702, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.30065311906199, "policy_loss": -0.010653165873218939, "vf_loss": 8.309609202228526, "vf_explained_var": 0.6114552477049449, "kl": 0.008485404022097114, "entropy": 0.7635304047947838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 39218.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.507712707065402, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.550129528651162, "policy_loss": -0.008274173571804547, "vf_loss": 8.557297623851312, "vf_explained_var": 0.21250685402955957, "kl": 0.005530457494031421, "entropy": 0.39252093494253815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 39218.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 168336, "num_env_steps_trained": 168336, "num_agent_steps_sampled": 673344, "num_agent_steps_trained": 673344}, "env_runners": {"episode_reward_max": 713.9838009502766, "episode_reward_min": -5.530627371686129, "episode_reward_mean": 177.697020490272, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1587.3042183503478, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 366.287623821295, "predator_policy": 1587.3042183503478}, "policy_reward_mean": {"prey_policy": -916.6564566842492, "predator_policy": 1005.504966929385}, "custom_metrics": {}, "hist_stats": {"episode_reward": [231.41234028582537, 366.94582902171226, 74.10482612826623, 214.0999999999969, 105.98396687235888, 355.8122949420211, 172.60500214160416, 455.2835051018787, 8.691233719273008, 49.48136244447405, 209.28178436880282, 1.4729535251892854, 242.94574904693755, 207.86080807768928, 1.0299146853448242, 114.16603409513846, 0.2817747232018015, 4.440892098500626e-16, 223.20024622544082, 561.8621032953702, 1.8579913884724861, 86.06815140976346, 171.86869433708063, 100.34547077793738, 176.46864342159597, 376.52405610613613, 368.9214971258995, 2.0192058749261736, 87.06747473349745, 446.9839977945975, 341.50551570454945, 96.82055475172663, 16.667732746466733, 254.99777907295316, 505.54519769725005, 0.4999999999999927, 77.82885343978054, 0.43391393483142027, 161.24490503450883, 204.66289925637378, 13.264454190000196, 10.68554672924964, 205.44416689395433, 149.41549314185642, 24.33122927774837, 149.18457813150792, 7.368769538327857, 1.1000000000000074, 314.69926549638325, 2.220446049250313e-15, 417.55069760407457, 179.11089541582706, 43.07247702388852, 199.56444069084262, 5.399423223409537, 17.55611850668155, 49.82745795819959, 425.0240163767849, 19.380438845184976, 284.3494673535116, 0.9999999999999967, 8.666480233761053, 1.52122951308676, 431.18478316111106, 550.3672799734084, 0.5999999999999979, 0.4999999999999982, 524.2912542297894, 523.96839068652, 0.3500302715172303, 266.65190351545084, 307.800934875856, 160.71572091243206, 411.87666379536086, 87.58125036920752, 103.53589567120694, 208.57506117046177, 169.42243059141433, 194.17361121876237, 377.402240608259, 228.6803436388489, 296.8080135427653, 612.0295483913046, 13.66652520385333, 12.010089131738543, 276.6072376814803, 4.1511469855792775, 451.8650044182909, -5.530627371686129, 27.155933990862927, 23.9243941245792, 6.637878140717891, 156.37223136685924, 360.29462014531316, 9.9768659943549, 389.9130216165581, 713.9838009502766, -1.2434497875801753e-14, 261.6319459361053, 8.155714635487424], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-493.7371918334678, -583.7470339407499, -265.5573228619532, -1174.1035218410761, -1183.4940214374299, -1406.3421249627047, 155.2721824408259, 39.0713244102931, -965.1105490295781, -1371.3858733562486, -314.55964606839507, -85.83519806533687, -911.9782622390823, -332.5782018233436, 38.99179705481094, -1152.6102805154785, -1208.4160769490427, -1306.0832767587294, -645.1081304345352, -1312.756246199961, -1141.9145745604696, -1362.6230811874204, -1291.5981259390826, -1388.411309227952, -952.4620046947576, -106.22174525680617, -1110.692276054226, -1360.3012647609987, -1339.0141278824055, -1280.7238866819193, -1204.0693001047478, -1132.267547206779, -1083.4938436202012, -1249.5353832231453, -1370.1766573548452, -1344.22842648208, -113.50006043756419, -708.702591013963, 159.0476960190514, -1288.5946182135337, -1415.6184293587296, -1514.907459471273, -1023.8923104190754, -966.6254142216225, -852.1096472048399, -1356.5742089554249, -692.3701397687801, -1176.673493031536, -310.7585596814868, -1414.0745828265808, -988.0369099020268, 272.33349012842467, -411.07628777989163, -827.7240954128065, -1428.8388501488998, -1453.0676230421795, -1124.2559545905276, -1107.3491178367337, -47.595892335147525, -947.532007631226, -523.4402344319883, -218.71609659637988, -1466.5476196942775, -519.5689621550997, -1148.7463393084618, -1518.3318803572338, -947.6907692197715, -688.0715374589587, -452.59525366104805, -739.029762525562, -1412.781041794, -1443.8725093342885, -1222.0644828182942, -922.5772716368814, -1445.9998320253537, -1341.180606810776, -1243.2576569722007, -511.54217468223646, -854.1265908206578, -671.8699852122982, -1431.752750554914, -1039.1553126335725, -1458.039681998204, -1365.7355443808524, -1248.8910765727555, -742.3475186272833, -33.75021667533252, -1056.5171158894686, -1265.8197791174712, -1138.2422764595315, -868.6513602877816, -87.93190714565281, -1357.75439432509, -1421.9103357739807, -1414.609855776013, -1088.0084010786527, -217.59540655652663, -1174.0352642300506, -1287.532701350433, -1342.3623278703685, -1314.2215120659966, 39.382221704306495, -960.5307940488512, -1533.720582195017, -619.8343096999083, -1291.417862991163, -1085.8135175060554, -937.6402579722902, -1390.153669273477, -1204.0837423309304, -962.5707043115258, -1154.291468191684, -1240.8074437293737, -1126.1240048240852, -1082.6399112187773, -89.69432623019179, -1277.7216547661753, -1179.080957447646, -1218.7957251648916, 31.669219958635118, -1480.3547985385767, -1545.7408934181967, -1420.350212581263, -1244.7000654500807, -1319.9596271951377, -1379.339355580666, -1207.6567575210338, -398.24595013163787, -791.3708661382852, 10.445160033115602, -1382.481436231161, -1266.230683093028, -1293.8951084951084, -1338.7460883357176, -1198.8132657794422, 40.0000000000003, 31.32273043566605, -854.3721882430644, -1426.3339145974971, -1189.6486950948977, -1025.7563676457196, -445.5318984992967, 291.1502781557372, -1365.6083691354052, -749.422534307358, -909.2432658572653, -1140.8160550747189, -201.58598135939093, -847.6892813435395, -25.264049214685755, -1203.771569905877, -1179.342278351509, -1327.118119807983, 201.80608002042382, 40.0000000000003, -1304.390557614894, -972.7143094136925, -174.6010433792558, -374.8500210176404, -848.2283082578912, 31.409061599047963, -1353.3889980774848, -990.0200085218129, -467.6873207911829, -820.7178946506284, 29.707428604293714, -794.7602196710975, -1235.1028014886872, -1134.6574372864065, -809.0244757780292, -979.2464277226975, 149.2444300022631, -1136.1784558176107, -1448.154974558935, -879.4492308232637, -148.07169251393614, -1528.2887277705279, -1442.7088109713939, -1091.0711323218004, -1347.2609248309316, -590.7160042092909, -1116.289104875807, -1025.3057278637452, -1251.3919487837125, -546.3578941397668, -769.3503052368652, 40.0000000000003, -1234.3781249899462, -1282.5672322379285, -803.5326448803172, -383.00354771286476, -920.0539546580927, -613.5549914687072, 366.287623821295, -1418.5148394912487, -1587.3042183503478, -1414.3154216345872, -773.9718725601745, -1226.4660453080746, -1298.5836880026452], "policy_predator_policy_reward": [665.2063799973544, 643.6901860626936, 1140.737859934178, 665.8688137905641, 1388.7489816877128, 1275.191990840688, 1.0971933913484455, 18.65929975753144, 1349.4468242921514, 1093.033564966036, 756.2071390757502, 0.0, 4.139602951821638, 1413.0218632522067, 707.1485086074099, 861.7534799551283, 1208.4160769490427, 1314.7745104780026, 1292.6043982615224, 714.7413408174478, 1372.123376022268, 1341.6960640944255, 1291.8949717795122, 1389.587416912712, 0.0, 1301.6294989985004, 1352.8919570414932, 1325.9623918514203, 1232.4550401364422, 1388.312889113229, 1233.1898514903046, 1217.3130299163597, 1083.893843620201, 1249.4171579463473, 1370.1766573548452, 1344.22842648208, 9.479693045655663, 1035.923204631312, 742.4237354683911, 948.985290021462, 1417.1764207472015, 1515.2074594712728, 1149.434629093598, 927.151246956862, 897.6553457408646, 1482.8972047564803, 1356.8700112838676, 612.5190922943863, 507.3713597069759, 1393.930426222696, 934.5621416207158, 157.6653342590226, 741.366726642799, 866.3551536757997, 1430.858056023826, 1453.0676230421795, 1208.223429324027, 1110.4491178367311, 570.4575735089841, 871.6543242519875, 1009.4654473016734, 74.19639943124518, 1469.118442408314, 613.8186941927908, 1165.4596265671867, 1518.2863258449759, 771.5759521112349, 1119.1841336404505, 915.0392818794757, 782.1309320043846, 1413.2810417939995, 1443.8725093342885, 1229.8644828182942, 992.606125076664, 1446.9998320253537, 1340.6145207456073, 1150.4905494930185, 765.5541871959309, 857.3337138768732, 873.3257614124585, 1431.829767680028, 1052.342749698459, 1459.2384864161963, 1375.2222866921104, 1173.815936328834, 1022.8668257651589, 640.8451074545227, 598.8377182521357, 1344.1972842289176, 1084.1960006258323, 556.0546476064828, 549.7131979584631, 1364.3855228922587, 1422.64797674514, 1414.609855776013, 1089.1084010786526, 1129.565396724259, 576.7645395587031, 1287.532701350433, 1342.3623278703685, 785.495460510458, 906.8945274553029, 1510.7048554197645, 1162.657416239931, 662.8201287766784, 1291.5045209382865, 1058.772538457379, 1164.2456777118127, 1390.153669273477, 1209.4831655543396, 978.8268228182075, 1155.591468191684, 1237.5358418459416, 1179.2230646657172, 916.7325853456791, 680.6256684800761, 1221.054401884132, 1255.1286491748735, 812.7277497781066, 658.7482227816596, 1480.3547985385767, 1546.7408934181967, 1420.7502125812628, 1252.9665456838422, 1320.1807061724226, 1380.639506116468, 1147.8381531147331, 889.24933769905, 866.1358224073459, 465.1571636712331, 1382.481436231161, 1266.830683093028, 1294.2951084951083, 1338.8460883357177, 666.1469557616916, 1016.9575642475401, 668.9706762255157, 678.0471722683975, 1426.3339145974971, 1189.9987253664149, 993.3004155434796, 744.6397541169863, 15.964316576401409, 1366.2947092791228, 378.89170796324476, 1440.4898131138084, 1108.3939708941652, 645.8847293353052, 590.1420223720913, 370.3925585553416, 1376.640334906758, 1110.0094090218329, 1333.1181198079826, 0.7689811500379805, 157.4998292856848, 1276.3131589206232, 604.9819385739548, 736.5070254377541, 1018.0597184328325, 582.4208514509593, 227.36278578571518, 1323.2974943315737, 959.2941695302165, 795.2211733255486, 597.223853337842, 805.8161610997901, 803.437845228149, 1240.091701135489, 1130.005778174471, 825.6862240217039, 479.9929297084121, 626.6163056935037, 1188.7750599166125, 1399.7095174455108, 859.7671657465304, 619.618762008955, 1469.9362333603158, 1495.5306780099195, 1118.5287183504702, 1346.9592727931242, 611.3403983338704, 1119.5891048758072, 1033.7488051853334, 1249.586749602842, 747.6328136790439, 724.447617064448, 509.2205353172256, 1045.452209818028, 1290.5440982322823, 805.5326448803172, 683.2778072081675, 1009.6927167793425, 500.63210467652164, 460.6190639211707, 1418.5148394912487, 1587.3042183503478, 1042.841485569817, 1407.077754561051, 1234.4660453080746, 1298.7394026381326]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.264835768384339, "mean_inference_ms": 7.263796893965917, "mean_action_processing_ms": 2.5908558335189356, "mean_env_wait_ms": 16.95699763522368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025034785270690918, "StateBufferConnector_ms": 0.012420296669006348, "ViewRequirementAgentConnector_ms": 0.328143835067749}, "num_episodes": 14, "episode_return_max": 713.9838009502766, "episode_return_min": -5.530627371686129, "episode_return_mean": 177.697020490272, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 673344, "num_agent_steps_trained": 673344, "num_env_steps_sampled": 168336, "num_env_steps_trained": 168336, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 154.3311193448075, "num_env_steps_trained_throughput_per_sec": 154.3311193448075, "timesteps_total": 168336, "num_env_steps_sampled_lifetime": 168336, "num_agent_steps_sampled_lifetime": 673344, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 673344, "timers": {"training_iteration_time_ms": 27755.792, "restore_workers_time_ms": 0.032, "training_step_time_ms": 27755.202, "sample_time_ms": 3978.175, "learn_time_ms": 23748.036, "learn_throughput": 168.772, "synch_weights_time_ms": 24.844}, "counters": {"num_env_steps_sampled": 168336, "num_env_steps_trained": 168336, "num_agent_steps_sampled": 673344, "num_agent_steps_trained": 673344}, "done": false, "training_iteration": 42, "trial_id": "7f713_00000", "date": "2024-08-23_10-05-42", "timestamp": 1724387742, "time_this_iter_s": 26.01009488105774, "time_total_s": 1140.4677994251251, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x173753af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1140.4677994251251, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 36.44054054054054, "ram_util_percent": 81.74594594594596}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.38711962813423, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.213757864634196, "policy_loss": -0.01168583320212309, "vf_loss": 8.22373133311196, "vf_explained_var": 0.5838502511145577, "kl": 0.00856176269285026, "entropy": 0.7151630717610556, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 40163.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.237084381164067, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.552777553740002, "policy_loss": -0.00828924685046471, "vf_loss": 8.559925585953646, "vf_explained_var": 0.25654752532010355, "kl": 0.005706050339593458, "entropy": 0.36834337692412117, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 40163.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 172344, "num_env_steps_trained": 172344, "num_agent_steps_sampled": 689376, "num_agent_steps_trained": 689376}, "env_runners": {"episode_reward_max": 713.9838009502766, "episode_reward_min": -5.530627371686129, "episode_reward_mean": 170.48318619815507, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1587.3042183503478, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 366.287623821295, "predator_policy": 1587.3042183503478}, "policy_reward_mean": {"prey_policy": -939.2348891749679, "predator_policy": 1024.4764822740453}, "custom_metrics": {}, "hist_stats": {"episode_reward": [209.28178436880282, 1.4729535251892854, 242.94574904693755, 207.86080807768928, 1.0299146853448242, 114.16603409513846, 0.2817747232018015, 4.440892098500626e-16, 223.20024622544082, 561.8621032953702, 1.8579913884724861, 86.06815140976346, 171.86869433708063, 100.34547077793738, 176.46864342159597, 376.52405610613613, 368.9214971258995, 2.0192058749261736, 87.06747473349745, 446.9839977945975, 341.50551570454945, 96.82055475172663, 16.667732746466733, 254.99777907295316, 505.54519769725005, 0.4999999999999927, 77.82885343978054, 0.43391393483142027, 161.24490503450883, 204.66289925637378, 13.264454190000196, 10.68554672924964, 205.44416689395433, 149.41549314185642, 24.33122927774837, 149.18457813150792, 7.368769538327857, 1.1000000000000074, 314.69926549638325, 2.220446049250313e-15, 417.55069760407457, 179.11089541582706, 43.07247702388852, 199.56444069084262, 5.399423223409537, 17.55611850668155, 49.82745795819959, 425.0240163767849, 19.380438845184976, 284.3494673535116, 0.9999999999999967, 8.666480233761053, 1.52122951308676, 431.18478316111106, 550.3672799734084, 0.5999999999999979, 0.4999999999999982, 524.2912542297894, 523.96839068652, 0.3500302715172303, 266.65190351545084, 307.800934875856, 160.71572091243206, 411.87666379536086, 87.58125036920752, 103.53589567120694, 208.57506117046177, 169.42243059141433, 194.17361121876237, 377.402240608259, 228.6803436388489, 296.8080135427653, 612.0295483913046, 13.66652520385333, 12.010089131738543, 276.6072376814803, 4.1511469855792775, 451.8650044182909, -5.530627371686129, 27.155933990862927, 23.9243941245792, 6.637878140717891, 156.37223136685924, 360.29462014531316, 9.9768659943549, 389.9130216165581, 713.9838009502766, -1.2434497875801753e-14, 261.6319459361053, 8.155714635487424, 504.16427085937653, 108.71538898248808, 132.02785030550274, 298.249932813459, 6.661338147750939e-15, 3.3000000000000025, -4.620968472245875, 67.80535835248924, 30.922188777211026, 172.4729098274312], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1141.9145745604696, -1362.6230811874204, -1291.5981259390826, -1388.411309227952, -952.4620046947576, -106.22174525680617, -1110.692276054226, -1360.3012647609987, -1339.0141278824055, -1280.7238866819193, -1204.0693001047478, -1132.267547206779, -1083.4938436202012, -1249.5353832231453, -1370.1766573548452, -1344.22842648208, -113.50006043756419, -708.702591013963, 159.0476960190514, -1288.5946182135337, -1415.6184293587296, -1514.907459471273, -1023.8923104190754, -966.6254142216225, -852.1096472048399, -1356.5742089554249, -692.3701397687801, -1176.673493031536, -310.7585596814868, -1414.0745828265808, -988.0369099020268, 272.33349012842467, -411.07628777989163, -827.7240954128065, -1428.8388501488998, -1453.0676230421795, -1124.2559545905276, -1107.3491178367337, -47.595892335147525, -947.532007631226, -523.4402344319883, -218.71609659637988, -1466.5476196942775, -519.5689621550997, -1148.7463393084618, -1518.3318803572338, -947.6907692197715, -688.0715374589587, -452.59525366104805, -739.029762525562, -1412.781041794, -1443.8725093342885, -1222.0644828182942, -922.5772716368814, -1445.9998320253537, -1341.180606810776, -1243.2576569722007, -511.54217468223646, -854.1265908206578, -671.8699852122982, -1431.752750554914, -1039.1553126335725, -1458.039681998204, -1365.7355443808524, -1248.8910765727555, -742.3475186272833, -33.75021667533252, -1056.5171158894686, -1265.8197791174712, -1138.2422764595315, -868.6513602877816, -87.93190714565281, -1357.75439432509, -1421.9103357739807, -1414.609855776013, -1088.0084010786527, -217.59540655652663, -1174.0352642300506, -1287.532701350433, -1342.3623278703685, -1314.2215120659966, 39.382221704306495, -960.5307940488512, -1533.720582195017, -619.8343096999083, -1291.417862991163, -1085.8135175060554, -937.6402579722902, -1390.153669273477, -1204.0837423309304, -962.5707043115258, -1154.291468191684, -1240.8074437293737, -1126.1240048240852, -1082.6399112187773, -89.69432623019179, -1277.7216547661753, -1179.080957447646, -1218.7957251648916, 31.669219958635118, -1480.3547985385767, -1545.7408934181967, -1420.350212581263, -1244.7000654500807, -1319.9596271951377, -1379.339355580666, -1207.6567575210338, -398.24595013163787, -791.3708661382852, 10.445160033115602, -1382.481436231161, -1266.230683093028, -1293.8951084951084, -1338.7460883357176, -1198.8132657794422, 40.0000000000003, 31.32273043566605, -854.3721882430644, -1426.3339145974971, -1189.6486950948977, -1025.7563676457196, -445.5318984992967, 291.1502781557372, -1365.6083691354052, -749.422534307358, -909.2432658572653, -1140.8160550747189, -201.58598135939093, -847.6892813435395, -25.264049214685755, -1203.771569905877, -1179.342278351509, -1327.118119807983, 201.80608002042382, 40.0000000000003, -1304.390557614894, -972.7143094136925, -174.6010433792558, -374.8500210176404, -848.2283082578912, 31.409061599047963, -1353.3889980774848, -990.0200085218129, -467.6873207911829, -820.7178946506284, 29.707428604293714, -794.7602196710975, -1235.1028014886872, -1134.6574372864065, -809.0244757780292, -979.2464277226975, 149.2444300022631, -1136.1784558176107, -1448.154974558935, -879.4492308232637, -148.07169251393614, -1528.2887277705279, -1442.7088109713939, -1091.0711323218004, -1347.2609248309316, -590.7160042092909, -1116.289104875807, -1025.3057278637452, -1251.3919487837125, -546.3578941397668, -769.3503052368652, 40.0000000000003, -1234.3781249899462, -1282.5672322379285, -803.5326448803172, -383.00354771286476, -920.0539546580927, -613.5549914687072, 366.287623821295, -1418.5148394912487, -1587.3042183503478, -1414.3154216345872, -773.9718725601745, -1226.4660453080746, -1298.5836880026452, -572.0644776526287, -279.63835338618395, -1182.4902027459793, -491.92890124770724, -414.352923839947, -1407.659270564138, -958.8874592828355, -36.191854500758936, -1339.5344774083137, -1288.448793049668, -1127.8547190986085, -989.0364360725621, -1322.0636152367354, -1375.7070595136922, -1215.665087657283, -1338.1226615812022, -887.2282380564528, -782.7439126332168, -984.8463309245923, -1001.2893781024197], "policy_predator_policy_reward": [1372.123376022268, 1341.6960640944255, 1291.8949717795122, 1389.587416912712, 0.0, 1301.6294989985004, 1352.8919570414932, 1325.9623918514203, 1232.4550401364422, 1388.312889113229, 1233.1898514903046, 1217.3130299163597, 1083.893843620201, 1249.4171579463473, 1370.1766573548452, 1344.22842648208, 9.479693045655663, 1035.923204631312, 742.4237354683911, 948.985290021462, 1417.1764207472015, 1515.2074594712728, 1149.434629093598, 927.151246956862, 897.6553457408646, 1482.8972047564803, 1356.8700112838676, 612.5190922943863, 507.3713597069759, 1393.930426222696, 934.5621416207158, 157.6653342590226, 741.366726642799, 866.3551536757997, 1430.858056023826, 1453.0676230421795, 1208.223429324027, 1110.4491178367311, 570.4575735089841, 871.6543242519875, 1009.4654473016734, 74.19639943124518, 1469.118442408314, 613.8186941927908, 1165.4596265671867, 1518.2863258449759, 771.5759521112349, 1119.1841336404505, 915.0392818794757, 782.1309320043846, 1413.2810417939995, 1443.8725093342885, 1229.8644828182942, 992.606125076664, 1446.9998320253537, 1340.6145207456073, 1150.4905494930185, 765.5541871959309, 857.3337138768732, 873.3257614124585, 1431.829767680028, 1052.342749698459, 1459.2384864161963, 1375.2222866921104, 1173.815936328834, 1022.8668257651589, 640.8451074545227, 598.8377182521357, 1344.1972842289176, 1084.1960006258323, 556.0546476064828, 549.7131979584631, 1364.3855228922587, 1422.64797674514, 1414.609855776013, 1089.1084010786526, 1129.565396724259, 576.7645395587031, 1287.532701350433, 1342.3623278703685, 785.495460510458, 906.8945274553029, 1510.7048554197645, 1162.657416239931, 662.8201287766784, 1291.5045209382865, 1058.772538457379, 1164.2456777118127, 1390.153669273477, 1209.4831655543396, 978.8268228182075, 1155.591468191684, 1237.5358418459416, 1179.2230646657172, 916.7325853456791, 680.6256684800761, 1221.054401884132, 1255.1286491748735, 812.7277497781066, 658.7482227816596, 1480.3547985385767, 1546.7408934181967, 1420.7502125812628, 1252.9665456838422, 1320.1807061724226, 1380.639506116468, 1147.8381531147331, 889.24933769905, 866.1358224073459, 465.1571636712331, 1382.481436231161, 1266.830683093028, 1294.2951084951083, 1338.8460883357177, 666.1469557616916, 1016.9575642475401, 668.9706762255157, 678.0471722683975, 1426.3339145974971, 1189.9987253664149, 993.3004155434796, 744.6397541169863, 15.964316576401409, 1366.2947092791228, 378.89170796324476, 1440.4898131138084, 1108.3939708941652, 645.8847293353052, 590.1420223720913, 370.3925585553416, 1376.640334906758, 1110.0094090218329, 1333.1181198079826, 0.7689811500379805, 157.4998292856848, 1276.3131589206232, 604.9819385739548, 736.5070254377541, 1018.0597184328325, 582.4208514509593, 227.36278578571518, 1323.2974943315737, 959.2941695302165, 795.2211733255486, 597.223853337842, 805.8161610997901, 803.437845228149, 1240.091701135489, 1130.005778174471, 825.6862240217039, 479.9929297084121, 626.6163056935037, 1188.7750599166125, 1399.7095174455108, 859.7671657465304, 619.618762008955, 1469.9362333603158, 1495.5306780099195, 1118.5287183504702, 1346.9592727931242, 611.3403983338704, 1119.5891048758072, 1033.7488051853334, 1249.586749602842, 747.6328136790439, 724.447617064448, 509.2205353172256, 1045.452209818028, 1290.5440982322823, 805.5326448803172, 683.2778072081675, 1009.6927167793425, 500.63210467652164, 460.6190639211707, 1418.5148394912487, 1587.3042183503478, 1042.841485569817, 1407.077754561051, 1234.4660453080746, 1298.7394026381326, 513.290155848229, 842.5769460499596, 1227.7862547936988, 555.3482381824772, 546.3807741454497, 1407.659270564138, 977.1472962831056, 316.18195031394794, 1339.5344774083137, 1288.448793049668, 1127.8547190986085, 992.3364360725622, 1317.2901240967888, 1375.8595821813904, 1215.3105952454725, 1406.2825123455013, 986.9976254545774, 713.8967140123037, 1135.181976761688, 1023.4266420927496]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.242040865456538, "mean_inference_ms": 7.29786041082709, "mean_action_processing_ms": 2.5552611409110204, "mean_env_wait_ms": 16.98344405861533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013795614242553711, "StateBufferConnector_ms": 0.01127159595489502, "ViewRequirementAgentConnector_ms": 0.2993839979171753}, "num_episodes": 10, "episode_return_max": 713.9838009502766, "episode_return_min": -5.530627371686129, "episode_return_mean": 170.48318619815507, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 689376, "num_agent_steps_trained": 689376, "num_env_steps_sampled": 172344, "num_env_steps_trained": 172344, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 148.72388529810743, "num_env_steps_trained_throughput_per_sec": 148.72388529810743, "timesteps_total": 172344, "num_env_steps_sampled_lifetime": 172344, "num_agent_steps_sampled_lifetime": 689376, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 689376, "timers": {"training_iteration_time_ms": 27087.179, "restore_workers_time_ms": 0.024, "training_step_time_ms": 27086.598, "sample_time_ms": 3353.79, "learn_time_ms": 23707.952, "learn_throughput": 169.057, "synch_weights_time_ms": 21.289}, "counters": {"num_env_steps_sampled": 172344, "num_env_steps_trained": 172344, "num_agent_steps_sampled": 689376, "num_agent_steps_trained": 689376}, "done": false, "training_iteration": 43, "trial_id": "7f713_00000", "date": "2024-08-23_10-06-09", "timestamp": 1724387769, "time_this_iter_s": 26.995044231414795, "time_total_s": 1167.46284365654, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737a68b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1167.46284365654, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 39.13157894736842, "ram_util_percent": 82.71578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.80900243375667, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.51372691058608, "policy_loss": -0.011345508369424986, "vf_loss": 8.523371192387172, "vf_explained_var": 0.5199381854168321, "kl": 0.008506183363694363, "entropy": 0.6600683547201611, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 41108.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.702229450871705, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.643342740699728, "policy_loss": -0.008450287024283574, "vf_loss": 8.650520815168107, "vf_explained_var": 0.17091622239067442, "kl": 0.006360971025639662, "entropy": 0.32416023176813885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 41108.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 176352, "num_env_steps_trained": 176352, "num_agent_steps_sampled": 705408, "num_agent_steps_trained": 705408}, "env_runners": {"episode_reward_max": 765.8620038240576, "episode_reward_min": -5.530627371686129, "episode_reward_mean": 185.89389181587634, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1587.3042183503478, "predator_policy": 0.7689811500379805}, "policy_reward_max": {"prey_policy": 366.287623821295, "predator_policy": 1587.3042183503478}, "policy_reward_mean": {"prey_policy": -914.7592971095921, "predator_policy": 1007.7062430175304}, "custom_metrics": {}, "hist_stats": {"episode_reward": [171.86869433708063, 100.34547077793738, 176.46864342159597, 376.52405610613613, 368.9214971258995, 2.0192058749261736, 87.06747473349745, 446.9839977945975, 341.50551570454945, 96.82055475172663, 16.667732746466733, 254.99777907295316, 505.54519769725005, 0.4999999999999927, 77.82885343978054, 0.43391393483142027, 161.24490503450883, 204.66289925637378, 13.264454190000196, 10.68554672924964, 205.44416689395433, 149.41549314185642, 24.33122927774837, 149.18457813150792, 7.368769538327857, 1.1000000000000074, 314.69926549638325, 2.220446049250313e-15, 417.55069760407457, 179.11089541582706, 43.07247702388852, 199.56444069084262, 5.399423223409537, 17.55611850668155, 49.82745795819959, 425.0240163767849, 19.380438845184976, 284.3494673535116, 0.9999999999999967, 8.666480233761053, 1.52122951308676, 431.18478316111106, 550.3672799734084, 0.5999999999999979, 0.4999999999999982, 524.2912542297894, 523.96839068652, 0.3500302715172303, 266.65190351545084, 307.800934875856, 160.71572091243206, 411.87666379536086, 87.58125036920752, 103.53589567120694, 208.57506117046177, 169.42243059141433, 194.17361121876237, 377.402240608259, 228.6803436388489, 296.8080135427653, 612.0295483913046, 13.66652520385333, 12.010089131738543, 276.6072376814803, 4.1511469855792775, 451.8650044182909, -5.530627371686129, 27.155933990862927, 23.9243941245792, 6.637878140717891, 156.37223136685924, 360.29462014531316, 9.9768659943549, 389.9130216165581, 713.9838009502766, -1.2434497875801753e-14, 261.6319459361053, 8.155714635487424, 504.16427085937653, 108.71538898248808, 132.02785030550274, 298.249932813459, 6.661338147750939e-15, 3.3000000000000025, -4.620968472245875, 67.80535835248924, 30.922188777211026, 172.4729098274312, 245.44009733494894, 155.06828745946112, 479.1140041346834, 537.2288343822395, 1.5000000000000013, 221.4283338438391, 0.5786039128317082, 416.6200240493257, 357.01611711291406, 765.8620038240576, 1.4682135629253845, 9.77355299625384], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-852.1096472048399, -1356.5742089554249, -692.3701397687801, -1176.673493031536, -310.7585596814868, -1414.0745828265808, -988.0369099020268, 272.33349012842467, -411.07628777989163, -827.7240954128065, -1428.8388501488998, -1453.0676230421795, -1124.2559545905276, -1107.3491178367337, -47.595892335147525, -947.532007631226, -523.4402344319883, -218.71609659637988, -1466.5476196942775, -519.5689621550997, -1148.7463393084618, -1518.3318803572338, -947.6907692197715, -688.0715374589587, -452.59525366104805, -739.029762525562, -1412.781041794, -1443.8725093342885, -1222.0644828182942, -922.5772716368814, -1445.9998320253537, -1341.180606810776, -1243.2576569722007, -511.54217468223646, -854.1265908206578, -671.8699852122982, -1431.752750554914, -1039.1553126335725, -1458.039681998204, -1365.7355443808524, -1248.8910765727555, -742.3475186272833, -33.75021667533252, -1056.5171158894686, -1265.8197791174712, -1138.2422764595315, -868.6513602877816, -87.93190714565281, -1357.75439432509, -1421.9103357739807, -1414.609855776013, -1088.0084010786527, -217.59540655652663, -1174.0352642300506, -1287.532701350433, -1342.3623278703685, -1314.2215120659966, 39.382221704306495, -960.5307940488512, -1533.720582195017, -619.8343096999083, -1291.417862991163, -1085.8135175060554, -937.6402579722902, -1390.153669273477, -1204.0837423309304, -962.5707043115258, -1154.291468191684, -1240.8074437293737, -1126.1240048240852, -1082.6399112187773, -89.69432623019179, -1277.7216547661753, -1179.080957447646, -1218.7957251648916, 31.669219958635118, -1480.3547985385767, -1545.7408934181967, -1420.350212581263, -1244.7000654500807, -1319.9596271951377, -1379.339355580666, -1207.6567575210338, -398.24595013163787, -791.3708661382852, 10.445160033115602, -1382.481436231161, -1266.230683093028, -1293.8951084951084, -1338.7460883357176, -1198.8132657794422, 40.0000000000003, 31.32273043566605, -854.3721882430644, -1426.3339145974971, -1189.6486950948977, -1025.7563676457196, -445.5318984992967, 291.1502781557372, -1365.6083691354052, -749.422534307358, -909.2432658572653, -1140.8160550747189, -201.58598135939093, -847.6892813435395, -25.264049214685755, -1203.771569905877, -1179.342278351509, -1327.118119807983, 201.80608002042382, 40.0000000000003, -1304.390557614894, -972.7143094136925, -174.6010433792558, -374.8500210176404, -848.2283082578912, 31.409061599047963, -1353.3889980774848, -990.0200085218129, -467.6873207911829, -820.7178946506284, 29.707428604293714, -794.7602196710975, -1235.1028014886872, -1134.6574372864065, -809.0244757780292, -979.2464277226975, 149.2444300022631, -1136.1784558176107, -1448.154974558935, -879.4492308232637, -148.07169251393614, -1528.2887277705279, -1442.7088109713939, -1091.0711323218004, -1347.2609248309316, -590.7160042092909, -1116.289104875807, -1025.3057278637452, -1251.3919487837125, -546.3578941397668, -769.3503052368652, 40.0000000000003, -1234.3781249899462, -1282.5672322379285, -803.5326448803172, -383.00354771286476, -920.0539546580927, -613.5549914687072, 366.287623821295, -1418.5148394912487, -1587.3042183503478, -1414.3154216345872, -773.9718725601745, -1226.4660453080746, -1298.5836880026452, -572.0644776526287, -279.63835338618395, -1182.4902027459793, -491.92890124770724, -414.352923839947, -1407.659270564138, -958.8874592828355, -36.191854500758936, -1339.5344774083137, -1288.448793049668, -1127.8547190986085, -989.0364360725621, -1322.0636152367354, -1375.7070595136922, -1215.665087657283, -1338.1226615812022, -887.2282380564528, -782.7439126332168, -984.8463309245923, -1001.2893781024197, -1415.2056062492004, -204.72667069507452, -1190.2383570017496, -741.2719601851134, -1398.3897047751386, -219.67116607303885, -795.0216439616962, 4.250283951439502, -1008.6113253185033, -1338.2538199074725, -847.5711313797559, -473.4042989927596, -1199.322191843784, -1390.4049496325997, -334.6800372809654, -371.09299372379746, -1439.386273594749, -482.30494279014135, 40.855620435355405, -730.0354623368082, -1154.164497443126, -1466.970147083058, -1196.0067988143535, -1343.7802535833366], "policy_predator_policy_reward": [897.6553457408646, 1482.8972047564803, 1356.8700112838676, 612.5190922943863, 507.3713597069759, 1393.930426222696, 934.5621416207158, 157.6653342590226, 741.366726642799, 866.3551536757997, 1430.858056023826, 1453.0676230421795, 1208.223429324027, 1110.4491178367311, 570.4575735089841, 871.6543242519875, 1009.4654473016734, 74.19639943124518, 1469.118442408314, 613.8186941927908, 1165.4596265671867, 1518.2863258449759, 771.5759521112349, 1119.1841336404505, 915.0392818794757, 782.1309320043846, 1413.2810417939995, 1443.8725093342885, 1229.8644828182942, 992.606125076664, 1446.9998320253537, 1340.6145207456073, 1150.4905494930185, 765.5541871959309, 857.3337138768732, 873.3257614124585, 1431.829767680028, 1052.342749698459, 1459.2384864161963, 1375.2222866921104, 1173.815936328834, 1022.8668257651589, 640.8451074545227, 598.8377182521357, 1344.1972842289176, 1084.1960006258323, 556.0546476064828, 549.7131979584631, 1364.3855228922587, 1422.64797674514, 1414.609855776013, 1089.1084010786526, 1129.565396724259, 576.7645395587031, 1287.532701350433, 1342.3623278703685, 785.495460510458, 906.8945274553029, 1510.7048554197645, 1162.657416239931, 662.8201287766784, 1291.5045209382865, 1058.772538457379, 1164.2456777118127, 1390.153669273477, 1209.4831655543396, 978.8268228182075, 1155.591468191684, 1237.5358418459416, 1179.2230646657172, 916.7325853456791, 680.6256684800761, 1221.054401884132, 1255.1286491748735, 812.7277497781066, 658.7482227816596, 1480.3547985385767, 1546.7408934181967, 1420.7502125812628, 1252.9665456838422, 1320.1807061724226, 1380.639506116468, 1147.8381531147331, 889.24933769905, 866.1358224073459, 465.1571636712331, 1382.481436231161, 1266.830683093028, 1294.2951084951083, 1338.8460883357177, 666.1469557616916, 1016.9575642475401, 668.9706762255157, 678.0471722683975, 1426.3339145974971, 1189.9987253664149, 993.3004155434796, 744.6397541169863, 15.964316576401409, 1366.2947092791228, 378.89170796324476, 1440.4898131138084, 1108.3939708941652, 645.8847293353052, 590.1420223720913, 370.3925585553416, 1376.640334906758, 1110.0094090218329, 1333.1181198079826, 0.7689811500379805, 157.4998292856848, 1276.3131589206232, 604.9819385739548, 736.5070254377541, 1018.0597184328325, 582.4208514509593, 227.36278578571518, 1323.2974943315737, 959.2941695302165, 795.2211733255486, 597.223853337842, 805.8161610997901, 803.437845228149, 1240.091701135489, 1130.005778174471, 825.6862240217039, 479.9929297084121, 626.6163056935037, 1188.7750599166125, 1399.7095174455108, 859.7671657465304, 619.618762008955, 1469.9362333603158, 1495.5306780099195, 1118.5287183504702, 1346.9592727931242, 611.3403983338704, 1119.5891048758072, 1033.7488051853334, 1249.586749602842, 747.6328136790439, 724.447617064448, 509.2205353172256, 1045.452209818028, 1290.5440982322823, 805.5326448803172, 683.2778072081675, 1009.6927167793425, 500.63210467652164, 460.6190639211707, 1418.5148394912487, 1587.3042183503478, 1042.841485569817, 1407.077754561051, 1234.4660453080746, 1298.7394026381326, 513.290155848229, 842.5769460499596, 1227.7862547936988, 555.3482381824772, 546.3807741454497, 1407.659270564138, 977.1472962831056, 316.18195031394794, 1339.5344774083137, 1288.448793049668, 1127.8547190986085, 992.3364360725622, 1317.2901240967888, 1375.8595821813904, 1215.3105952454725, 1406.2825123455013, 986.9976254545774, 713.8967140123037, 1135.181976761688, 1023.4266420927496, 1014.0626783646735, 851.3096959145521, 1228.9398993637863, 857.638705282539, 1253.9381421237943, 843.2367328590725, 563.8953647666319, 764.1048296258616, 1010.1113253185036, 1338.2538199074725, 687.4303050097639, 854.9734592065912, 1199.9007957566157, 1390.4049496325997, 317.9316195095759, 804.4614355445141, 1264.9718460584488, 1013.7354874393609, 821.232961476185, 633.8088842493262, 1155.6327110060513, 1466.970147083058, 1206.029393518979, 1343.5312118749641]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.245871085584813, "mean_inference_ms": 7.276383166880617, "mean_action_processing_ms": 2.549639933069986, "mean_env_wait_ms": 17.047477938951417, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015858888626098633, "StateBufferConnector_ms": 0.010931134223937988, "ViewRequirementAgentConnector_ms": 0.29250621795654297}, "num_episodes": 12, "episode_return_max": 765.8620038240576, "episode_return_min": -5.530627371686129, "episode_return_mean": 185.89389181587634, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 705408, "num_agent_steps_trained": 705408, "num_env_steps_sampled": 176352, "num_env_steps_trained": 176352, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 150.55552291429748, "num_env_steps_trained_throughput_per_sec": 150.55552291429748, "timesteps_total": 176352, "num_env_steps_sampled_lifetime": 176352, "num_agent_steps_sampled_lifetime": 705408, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 705408, "timers": {"training_iteration_time_ms": 26784.695, "restore_workers_time_ms": 0.023, "training_step_time_ms": 26784.121, "sample_time_ms": 3131.059, "learn_time_ms": 23628.19, "learn_throughput": 169.628, "synch_weights_time_ms": 21.255}, "counters": {"num_env_steps_sampled": 176352, "num_env_steps_trained": 176352, "num_agent_steps_sampled": 705408, "num_agent_steps_trained": 705408}, "done": false, "training_iteration": 44, "trial_id": "7f713_00000", "date": "2024-08-23_10-06-35", "timestamp": 1724387795, "time_this_iter_s": 26.672741889953613, "time_total_s": 1194.1355855464935, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17380c940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1194.1355855464935, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 37.770270270270274, "ram_util_percent": 82.44864864864863}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.695232938837123, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.294134630475725, "policy_loss": -0.012307066696624533, "vf_loss": 8.304684421498939, "vf_explained_var": 0.45475959765217294, "kl": 0.008786404442544731, "entropy": 0.631770703212294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 42053.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.39514622940588, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.37568672018707, "policy_loss": -0.0067909207663168665, "vf_loss": 8.381307357202761, "vf_explained_var": 0.24568921239287764, "kl": 0.005851278258438306, "entropy": 0.37314009224926986, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 42053.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 180360, "num_env_steps_trained": 180360, "num_agent_steps_sampled": 721440, "num_agent_steps_trained": 721440}, "env_runners": {"episode_reward_max": 765.8620038240576, "episode_reward_min": -5.530627371686129, "episode_reward_mean": 186.38710535081086, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1655.4937746057963, "predator_policy": 0.7689811500379805}, "policy_reward_max": {"prey_policy": 366.287623821295, "predator_policy": 1655.4937746057963}, "policy_reward_mean": {"prey_policy": -891.2250944584515, "predator_policy": 984.4186471338569}, "custom_metrics": {}, "hist_stats": {"episode_reward": [161.24490503450883, 204.66289925637378, 13.264454190000196, 10.68554672924964, 205.44416689395433, 149.41549314185642, 24.33122927774837, 149.18457813150792, 7.368769538327857, 1.1000000000000074, 314.69926549638325, 2.220446049250313e-15, 417.55069760407457, 179.11089541582706, 43.07247702388852, 199.56444069084262, 5.399423223409537, 17.55611850668155, 49.82745795819959, 425.0240163767849, 19.380438845184976, 284.3494673535116, 0.9999999999999967, 8.666480233761053, 1.52122951308676, 431.18478316111106, 550.3672799734084, 0.5999999999999979, 0.4999999999999982, 524.2912542297894, 523.96839068652, 0.3500302715172303, 266.65190351545084, 307.800934875856, 160.71572091243206, 411.87666379536086, 87.58125036920752, 103.53589567120694, 208.57506117046177, 169.42243059141433, 194.17361121876237, 377.402240608259, 228.6803436388489, 296.8080135427653, 612.0295483913046, 13.66652520385333, 12.010089131738543, 276.6072376814803, 4.1511469855792775, 451.8650044182909, -5.530627371686129, 27.155933990862927, 23.9243941245792, 6.637878140717891, 156.37223136685924, 360.29462014531316, 9.9768659943549, 389.9130216165581, 713.9838009502766, -1.2434497875801753e-14, 261.6319459361053, 8.155714635487424, 504.16427085937653, 108.71538898248808, 132.02785030550274, 298.249932813459, 6.661338147750939e-15, 3.3000000000000025, -4.620968472245875, 67.80535835248924, 30.922188777211026, 172.4729098274312, 245.44009733494894, 155.06828745946112, 479.1140041346834, 537.2288343822395, 1.5000000000000013, 221.4283338438391, 0.5786039128317082, 416.6200240493257, 357.01611711291406, 765.8620038240576, 1.4682135629253845, 9.77355299625384, 317.5081241651277, 109.61676600607112, 378.31437619866125, 0.499999999999994, 86.69870452782637, 213.59958998194958, 764.375274879386, 326.6404549326614, 135.7880214917709, 170.12916889754527, -8.881784197001252e-16, -3.7014428372067227, 90.37612556873927, 3.5, 10.700000000000003, 469.774777200149], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1243.2576569722007, -511.54217468223646, -854.1265908206578, -671.8699852122982, -1431.752750554914, -1039.1553126335725, -1458.039681998204, -1365.7355443808524, -1248.8910765727555, -742.3475186272833, -33.75021667533252, -1056.5171158894686, -1265.8197791174712, -1138.2422764595315, -868.6513602877816, -87.93190714565281, -1357.75439432509, -1421.9103357739807, -1414.609855776013, -1088.0084010786527, -217.59540655652663, -1174.0352642300506, -1287.532701350433, -1342.3623278703685, -1314.2215120659966, 39.382221704306495, -960.5307940488512, -1533.720582195017, -619.8343096999083, -1291.417862991163, -1085.8135175060554, -937.6402579722902, -1390.153669273477, -1204.0837423309304, -962.5707043115258, -1154.291468191684, -1240.8074437293737, -1126.1240048240852, -1082.6399112187773, -89.69432623019179, -1277.7216547661753, -1179.080957447646, -1218.7957251648916, 31.669219958635118, -1480.3547985385767, -1545.7408934181967, -1420.350212581263, -1244.7000654500807, -1319.9596271951377, -1379.339355580666, -1207.6567575210338, -398.24595013163787, -791.3708661382852, 10.445160033115602, -1382.481436231161, -1266.230683093028, -1293.8951084951084, -1338.7460883357176, -1198.8132657794422, 40.0000000000003, 31.32273043566605, -854.3721882430644, -1426.3339145974971, -1189.6486950948977, -1025.7563676457196, -445.5318984992967, 291.1502781557372, -1365.6083691354052, -749.422534307358, -909.2432658572653, -1140.8160550747189, -201.58598135939093, -847.6892813435395, -25.264049214685755, -1203.771569905877, -1179.342278351509, -1327.118119807983, 201.80608002042382, 40.0000000000003, -1304.390557614894, -972.7143094136925, -174.6010433792558, -374.8500210176404, -848.2283082578912, 31.409061599047963, -1353.3889980774848, -990.0200085218129, -467.6873207911829, -820.7178946506284, 29.707428604293714, -794.7602196710975, -1235.1028014886872, -1134.6574372864065, -809.0244757780292, -979.2464277226975, 149.2444300022631, -1136.1784558176107, -1448.154974558935, -879.4492308232637, -148.07169251393614, -1528.2887277705279, -1442.7088109713939, -1091.0711323218004, -1347.2609248309316, -590.7160042092909, -1116.289104875807, -1025.3057278637452, -1251.3919487837125, -546.3578941397668, -769.3503052368652, 40.0000000000003, -1234.3781249899462, -1282.5672322379285, -803.5326448803172, -383.00354771286476, -920.0539546580927, -613.5549914687072, 366.287623821295, -1418.5148394912487, -1587.3042183503478, -1414.3154216345872, -773.9718725601745, -1226.4660453080746, -1298.5836880026452, -572.0644776526287, -279.63835338618395, -1182.4902027459793, -491.92890124770724, -414.352923839947, -1407.659270564138, -958.8874592828355, -36.191854500758936, -1339.5344774083137, -1288.448793049668, -1127.8547190986085, -989.0364360725621, -1322.0636152367354, -1375.7070595136922, -1215.665087657283, -1338.1226615812022, -887.2282380564528, -782.7439126332168, -984.8463309245923, -1001.2893781024197, -1415.2056062492004, -204.72667069507452, -1190.2383570017496, -741.2719601851134, -1398.3897047751386, -219.67116607303885, -795.0216439616962, 4.250283951439502, -1008.6113253185033, -1338.2538199074725, -847.5711313797559, -473.4042989927596, -1199.322191843784, -1390.4049496325997, -334.6800372809654, -371.09299372379746, -1439.386273594749, -482.30494279014135, 40.855620435355405, -730.0354623368082, -1154.164497443126, -1466.970147083058, -1196.0067988143535, -1343.7802535833366, -478.69314931368797, -611.0105634439003, -1117.0826360678047, -579.4532021480247, 359.41193070580744, -985.8524891362164, -1159.410561404252, -1301.504687574272, -528.0919559222797, -44.2687153004847, -98.3656414261861, -765.1794390852821, -938.3010585487674, 283.307053619092, 19.367418726393186, -1178.2566574685181, -1012.5798526335831, -211.58566949959388, -824.8946890356113, -265.8032516283727, -1390.6487444090758, -1134.341848908161, -1465.6350195747295, -1384.0652573209481, -1565.8859319438013, 11.587328108938914, -1241.5093023278257, -1221.223902948603, -1655.4937746057963, -924.0818836857867, -1117.0038677401396, -643.5275276784266], "policy_predator_policy_reward": [1150.4905494930185, 765.5541871959309, 857.3337138768732, 873.3257614124585, 1431.829767680028, 1052.342749698459, 1459.2384864161963, 1375.2222866921104, 1173.815936328834, 1022.8668257651589, 640.8451074545227, 598.8377182521357, 1344.1972842289176, 1084.1960006258323, 556.0546476064828, 549.7131979584631, 1364.3855228922587, 1422.64797674514, 1414.609855776013, 1089.1084010786526, 1129.565396724259, 576.7645395587031, 1287.532701350433, 1342.3623278703685, 785.495460510458, 906.8945274553029, 1510.7048554197645, 1162.657416239931, 662.8201287766784, 1291.5045209382865, 1058.772538457379, 1164.2456777118127, 1390.153669273477, 1209.4831655543396, 978.8268228182075, 1155.591468191684, 1237.5358418459416, 1179.2230646657172, 916.7325853456791, 680.6256684800761, 1221.054401884132, 1255.1286491748735, 812.7277497781066, 658.7482227816596, 1480.3547985385767, 1546.7408934181967, 1420.7502125812628, 1252.9665456838422, 1320.1807061724226, 1380.639506116468, 1147.8381531147331, 889.24933769905, 866.1358224073459, 465.1571636712331, 1382.481436231161, 1266.830683093028, 1294.2951084951083, 1338.8460883357177, 666.1469557616916, 1016.9575642475401, 668.9706762255157, 678.0471722683975, 1426.3339145974971, 1189.9987253664149, 993.3004155434796, 744.6397541169863, 15.964316576401409, 1366.2947092791228, 378.89170796324476, 1440.4898131138084, 1108.3939708941652, 645.8847293353052, 590.1420223720913, 370.3925585553416, 1376.640334906758, 1110.0094090218329, 1333.1181198079826, 0.7689811500379805, 157.4998292856848, 1276.3131589206232, 604.9819385739548, 736.5070254377541, 1018.0597184328325, 582.4208514509593, 227.36278578571518, 1323.2974943315737, 959.2941695302165, 795.2211733255486, 597.223853337842, 805.8161610997901, 803.437845228149, 1240.091701135489, 1130.005778174471, 825.6862240217039, 479.9929297084121, 626.6163056935037, 1188.7750599166125, 1399.7095174455108, 859.7671657465304, 619.618762008955, 1469.9362333603158, 1495.5306780099195, 1118.5287183504702, 1346.9592727931242, 611.3403983338704, 1119.5891048758072, 1033.7488051853334, 1249.586749602842, 747.6328136790439, 724.447617064448, 509.2205353172256, 1045.452209818028, 1290.5440982322823, 805.5326448803172, 683.2778072081675, 1009.6927167793425, 500.63210467652164, 460.6190639211707, 1418.5148394912487, 1587.3042183503478, 1042.841485569817, 1407.077754561051, 1234.4660453080746, 1298.7394026381326, 513.290155848229, 842.5769460499596, 1227.7862547936988, 555.3482381824772, 546.3807741454497, 1407.659270564138, 977.1472962831056, 316.18195031394794, 1339.5344774083137, 1288.448793049668, 1127.8547190986085, 992.3364360725622, 1317.2901240967888, 1375.8595821813904, 1215.3105952454725, 1406.2825123455013, 986.9976254545774, 713.8967140123037, 1135.181976761688, 1023.4266420927496, 1014.0626783646735, 851.3096959145521, 1228.9398993637863, 857.638705282539, 1253.9381421237943, 843.2367328590725, 563.8953647666319, 764.1048296258616, 1010.1113253185036, 1338.2538199074725, 687.4303050097639, 854.9734592065912, 1199.9007957566157, 1390.4049496325997, 317.9316195095759, 804.4614355445141, 1264.9718460584488, 1013.7354874393609, 821.232961476185, 633.8088842493262, 1155.6327110060513, 1466.970147083058, 1206.029393518979, 1343.5312118749641, 796.7779327217963, 610.4339042009194, 842.9211025444065, 963.2315016774976, 11.274862555359297, 993.4800720737112, 1159.410561404252, 1302.004687574272, 64.07602895059469, 594.9833467999982, 303.5062613611553, 773.6384091322625, 762.3727095528748, 656.9965702561838, 345.7204945593554, 1139.8091991154286, 1028.4571433408044, 331.49640028414206, 482.25905952284893, 778.5680500386788, 1390.6487444090758, 1134.341848908161, 1468.04435072012, 1377.95448333835, 1565.8859319438013, 78.78879745980048, 1242.5093023278257, 1223.7239029486032, 1655.4937746057963, 934.7818836857869, 1041.5832341776133, 1188.722938441103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.152639941052632, "mean_inference_ms": 7.260211095620509, "mean_action_processing_ms": 2.520285289445517, "mean_env_wait_ms": 17.02499390685684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01425182819366455, "StateBufferConnector_ms": 0.007031917572021484, "ViewRequirementAgentConnector_ms": 0.2703847885131836}, "num_episodes": 16, "episode_return_max": 765.8620038240576, "episode_return_min": -5.530627371686129, "episode_return_mean": 186.38710535081086, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 721440, "num_agent_steps_trained": 721440, "num_env_steps_sampled": 180360, "num_env_steps_trained": 180360, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 155.12391915603462, "num_env_steps_trained_throughput_per_sec": 155.12391915603462, "timesteps_total": 180360, "num_env_steps_sampled_lifetime": 180360, "num_agent_steps_sampled_lifetime": 721440, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 721440, "timers": {"training_iteration_time_ms": 26739.543, "restore_workers_time_ms": 0.023, "training_step_time_ms": 26738.962, "sample_time_ms": 3094.908, "learn_time_ms": 23619.157, "learn_throughput": 169.693, "synch_weights_time_ms": 21.447}, "counters": {"num_env_steps_sampled": 180360, "num_env_steps_trained": 180360, "num_agent_steps_sampled": 721440, "num_agent_steps_trained": 721440}, "done": false, "training_iteration": 45, "trial_id": "7f713_00000", "date": "2024-08-23_10-07-01", "timestamp": 1724387821, "time_this_iter_s": 25.893419981002808, "time_total_s": 1220.0290055274963, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30f7b41f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1220.0290055274963, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 36.637837837837836, "ram_util_percent": 82.2081081081081}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.596543782097953, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.521275532434856, "policy_loss": -0.010900889731519831, "vf_loss": 8.530519791254921, "vf_explained_var": 0.5069035586856661, "kl": 0.008283216156627214, "entropy": 0.6101357724300768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 42998.0, "diff_num_grad_updates_vs_sampler_policy": 480.95958083832375}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.953508165904452, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.395216673896426, "policy_loss": -0.008010224987156492, "vf_loss": 8.402360194069999, "vf_explained_var": 0.3012672307630065, "kl": 0.004333674966939109, "entropy": 0.35096659302396116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 42998.0, "diff_num_grad_updates_vs_sampler_policy": 480.95958083832375}}, "num_env_steps_sampled": 184368, "num_env_steps_trained": 184368, "num_agent_steps_sampled": 737472, "num_agent_steps_trained": 737472}, "env_runners": {"episode_reward_max": 765.8620038240576, "episode_reward_min": -5.530627371686129, "episode_reward_mean": 186.21587298719126, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1655.4937746057963, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 366.287623821295, "predator_policy": 1655.4937746057963}, "policy_reward_mean": {"prey_policy": -884.5874798881613, "predator_policy": 977.6954163817568}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.1000000000000074, 314.69926549638325, 2.220446049250313e-15, 417.55069760407457, 179.11089541582706, 43.07247702388852, 199.56444069084262, 5.399423223409537, 17.55611850668155, 49.82745795819959, 425.0240163767849, 19.380438845184976, 284.3494673535116, 0.9999999999999967, 8.666480233761053, 1.52122951308676, 431.18478316111106, 550.3672799734084, 0.5999999999999979, 0.4999999999999982, 524.2912542297894, 523.96839068652, 0.3500302715172303, 266.65190351545084, 307.800934875856, 160.71572091243206, 411.87666379536086, 87.58125036920752, 103.53589567120694, 208.57506117046177, 169.42243059141433, 194.17361121876237, 377.402240608259, 228.6803436388489, 296.8080135427653, 612.0295483913046, 13.66652520385333, 12.010089131738543, 276.6072376814803, 4.1511469855792775, 451.8650044182909, -5.530627371686129, 27.155933990862927, 23.9243941245792, 6.637878140717891, 156.37223136685924, 360.29462014531316, 9.9768659943549, 389.9130216165581, 713.9838009502766, -1.2434497875801753e-14, 261.6319459361053, 8.155714635487424, 504.16427085937653, 108.71538898248808, 132.02785030550274, 298.249932813459, 6.661338147750939e-15, 3.3000000000000025, -4.620968472245875, 67.80535835248924, 30.922188777211026, 172.4729098274312, 245.44009733494894, 155.06828745946112, 479.1140041346834, 537.2288343822395, 1.5000000000000013, 221.4283338438391, 0.5786039128317082, 416.6200240493257, 357.01611711291406, 765.8620038240576, 1.4682135629253845, 9.77355299625384, 317.5081241651277, 109.61676600607112, 378.31437619866125, 0.499999999999994, 86.69870452782637, 213.59958998194958, 764.375274879386, 326.6404549326614, 135.7880214917709, 170.12916889754527, -8.881784197001252e-16, -3.7014428372067227, 90.37612556873927, 3.5, 10.700000000000003, 469.774777200149, 236.67908486145464, -1.7319479184152442e-14, 115.77769991961598, 29.693889334569203, 7.100000000000016, 5.100000000000001, 334.9245591843899, 179.26630188720353, -0.06272935566335036], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1414.609855776013, -1088.0084010786527, -217.59540655652663, -1174.0352642300506, -1287.532701350433, -1342.3623278703685, -1314.2215120659966, 39.382221704306495, -960.5307940488512, -1533.720582195017, -619.8343096999083, -1291.417862991163, -1085.8135175060554, -937.6402579722902, -1390.153669273477, -1204.0837423309304, -962.5707043115258, -1154.291468191684, -1240.8074437293737, -1126.1240048240852, -1082.6399112187773, -89.69432623019179, -1277.7216547661753, -1179.080957447646, -1218.7957251648916, 31.669219958635118, -1480.3547985385767, -1545.7408934181967, -1420.350212581263, -1244.7000654500807, -1319.9596271951377, -1379.339355580666, -1207.6567575210338, -398.24595013163787, -791.3708661382852, 10.445160033115602, -1382.481436231161, -1266.230683093028, -1293.8951084951084, -1338.7460883357176, -1198.8132657794422, 40.0000000000003, 31.32273043566605, -854.3721882430644, -1426.3339145974971, -1189.6486950948977, -1025.7563676457196, -445.5318984992967, 291.1502781557372, -1365.6083691354052, -749.422534307358, -909.2432658572653, -1140.8160550747189, -201.58598135939093, -847.6892813435395, -25.264049214685755, -1203.771569905877, -1179.342278351509, -1327.118119807983, 201.80608002042382, 40.0000000000003, -1304.390557614894, -972.7143094136925, -174.6010433792558, -374.8500210176404, -848.2283082578912, 31.409061599047963, -1353.3889980774848, -990.0200085218129, -467.6873207911829, -820.7178946506284, 29.707428604293714, -794.7602196710975, -1235.1028014886872, -1134.6574372864065, -809.0244757780292, -979.2464277226975, 149.2444300022631, -1136.1784558176107, -1448.154974558935, -879.4492308232637, -148.07169251393614, -1528.2887277705279, -1442.7088109713939, -1091.0711323218004, -1347.2609248309316, -590.7160042092909, -1116.289104875807, -1025.3057278637452, -1251.3919487837125, -546.3578941397668, -769.3503052368652, 40.0000000000003, -1234.3781249899462, -1282.5672322379285, -803.5326448803172, -383.00354771286476, -920.0539546580927, -613.5549914687072, 366.287623821295, -1418.5148394912487, -1587.3042183503478, -1414.3154216345872, -773.9718725601745, -1226.4660453080746, -1298.5836880026452, -572.0644776526287, -279.63835338618395, -1182.4902027459793, -491.92890124770724, -414.352923839947, -1407.659270564138, -958.8874592828355, -36.191854500758936, -1339.5344774083137, -1288.448793049668, -1127.8547190986085, -989.0364360725621, -1322.0636152367354, -1375.7070595136922, -1215.665087657283, -1338.1226615812022, -887.2282380564528, -782.7439126332168, -984.8463309245923, -1001.2893781024197, -1415.2056062492004, -204.72667069507452, -1190.2383570017496, -741.2719601851134, -1398.3897047751386, -219.67116607303885, -795.0216439616962, 4.250283951439502, -1008.6113253185033, -1338.2538199074725, -847.5711313797559, -473.4042989927596, -1199.322191843784, -1390.4049496325997, -334.6800372809654, -371.09299372379746, -1439.386273594749, -482.30494279014135, 40.855620435355405, -730.0354623368082, -1154.164497443126, -1466.970147083058, -1196.0067988143535, -1343.7802535833366, -478.69314931368797, -611.0105634439003, -1117.0826360678047, -579.4532021480247, 359.41193070580744, -985.8524891362164, -1159.410561404252, -1301.504687574272, -528.0919559222797, -44.2687153004847, -98.3656414261861, -765.1794390852821, -938.3010585487674, 283.307053619092, 19.367418726393186, -1178.2566574685181, -1012.5798526335831, -211.58566949959388, -824.8946890356113, -265.8032516283727, -1390.6487444090758, -1134.341848908161, -1465.6350195747295, -1384.0652573209481, -1565.8859319438013, 11.587328108938914, -1241.5093023278257, -1221.223902948603, -1655.4937746057963, -924.0818836857867, -1117.0038677401396, -643.5275276784266, -250.0234716276928, -669.1753528432874, -1168.6069338136808, -1616.0278886858657, -819.2013220461964, -1199.476994687043, -227.2555715971255, -844.0163842377652, -1197.8280380895712, -907.5067932720823, -1240.3819802857147, -885.2778338499234, -526.5364648985545, -1365.2349590472352, 94.76504846289771, -987.7169418993052, -1477.2145801683344, -1183.0563014847648], "policy_predator_policy_reward": [1414.609855776013, 1089.1084010786526, 1129.565396724259, 576.7645395587031, 1287.532701350433, 1342.3623278703685, 785.495460510458, 906.8945274553029, 1510.7048554197645, 1162.657416239931, 662.8201287766784, 1291.5045209382865, 1058.772538457379, 1164.2456777118127, 1390.153669273477, 1209.4831655543396, 978.8268228182075, 1155.591468191684, 1237.5358418459416, 1179.2230646657172, 916.7325853456791, 680.6256684800761, 1221.054401884132, 1255.1286491748735, 812.7277497781066, 658.7482227816596, 1480.3547985385767, 1546.7408934181967, 1420.7502125812628, 1252.9665456838422, 1320.1807061724226, 1380.639506116468, 1147.8381531147331, 889.24933769905, 866.1358224073459, 465.1571636712331, 1382.481436231161, 1266.830683093028, 1294.2951084951083, 1338.8460883357177, 666.1469557616916, 1016.9575642475401, 668.9706762255157, 678.0471722683975, 1426.3339145974971, 1189.9987253664149, 993.3004155434796, 744.6397541169863, 15.964316576401409, 1366.2947092791228, 378.89170796324476, 1440.4898131138084, 1108.3939708941652, 645.8847293353052, 590.1420223720913, 370.3925585553416, 1376.640334906758, 1110.0094090218329, 1333.1181198079826, 0.7689811500379805, 157.4998292856848, 1276.3131589206232, 604.9819385739548, 736.5070254377541, 1018.0597184328325, 582.4208514509593, 227.36278578571518, 1323.2974943315737, 959.2941695302165, 795.2211733255486, 597.223853337842, 805.8161610997901, 803.437845228149, 1240.091701135489, 1130.005778174471, 825.6862240217039, 479.9929297084121, 626.6163056935037, 1188.7750599166125, 1399.7095174455108, 859.7671657465304, 619.618762008955, 1469.9362333603158, 1495.5306780099195, 1118.5287183504702, 1346.9592727931242, 611.3403983338704, 1119.5891048758072, 1033.7488051853334, 1249.586749602842, 747.6328136790439, 724.447617064448, 509.2205353172256, 1045.452209818028, 1290.5440982322823, 805.5326448803172, 683.2778072081675, 1009.6927167793425, 500.63210467652164, 460.6190639211707, 1418.5148394912487, 1587.3042183503478, 1042.841485569817, 1407.077754561051, 1234.4660453080746, 1298.7394026381326, 513.290155848229, 842.5769460499596, 1227.7862547936988, 555.3482381824772, 546.3807741454497, 1407.659270564138, 977.1472962831056, 316.18195031394794, 1339.5344774083137, 1288.448793049668, 1127.8547190986085, 992.3364360725622, 1317.2901240967888, 1375.8595821813904, 1215.3105952454725, 1406.2825123455013, 986.9976254545774, 713.8967140123037, 1135.181976761688, 1023.4266420927496, 1014.0626783646735, 851.3096959145521, 1228.9398993637863, 857.638705282539, 1253.9381421237943, 843.2367328590725, 563.8953647666319, 764.1048296258616, 1010.1113253185036, 1338.2538199074725, 687.4303050097639, 854.9734592065912, 1199.9007957566157, 1390.4049496325997, 317.9316195095759, 804.4614355445141, 1264.9718460584488, 1013.7354874393609, 821.232961476185, 633.8088842493262, 1155.6327110060513, 1466.970147083058, 1206.029393518979, 1343.5312118749641, 796.7779327217963, 610.4339042009194, 842.9211025444065, 963.2315016774976, 11.274862555359297, 993.4800720737112, 1159.410561404252, 1302.004687574272, 64.07602895059469, 594.9833467999982, 303.5062613611553, 773.6384091322625, 762.3727095528748, 656.9965702561838, 345.7204945593554, 1139.8091991154286, 1028.4571433408044, 331.49640028414206, 482.25905952284893, 778.5680500386788, 1390.6487444090758, 1134.341848908161, 1468.04435072012, 1377.95448333835, 1565.8859319438013, 78.78879745980048, 1242.5093023278257, 1223.7239029486032, 1655.4937746057963, 934.7818836857869, 1041.5832341776133, 1188.722938441103, 0.0, 1155.877909332437, 1168.6069338136808, 1616.0278886858657, 961.9110258570972, 1172.5449907957575, 250.34946093169359, 850.6163842377653, 1204.2280380895709, 908.2067932720825, 1243.0819802857147, 887.6778338499232, 979.729025454658, 1246.9669576755264, 7.536464442272491, 1064.681730881338, 1477.2145801683344, 1182.9935721291015]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.107188342839304, "mean_inference_ms": 7.224723392692079, "mean_action_processing_ms": 2.5070390594245553, "mean_env_wait_ms": 17.028305995116085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014369606971740723, "StateBufferConnector_ms": 0.0070503950119018555, "ViewRequirementAgentConnector_ms": 0.2724961042404175}, "num_episodes": 9, "episode_return_max": 765.8620038240576, "episode_return_min": -5.530627371686129, "episode_return_mean": 186.21587298719126, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 737472, "num_agent_steps_trained": 737472, "num_env_steps_sampled": 184368, "num_env_steps_trained": 184368, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 152.25312507859672, "num_env_steps_trained_throughput_per_sec": 152.25312507859672, "timesteps_total": 184368, "num_env_steps_sampled_lifetime": 184368, "num_agent_steps_sampled_lifetime": 737472, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 737472, "timers": {"training_iteration_time_ms": 26704.622, "restore_workers_time_ms": 0.023, "training_step_time_ms": 26704.042, "sample_time_ms": 3117.858, "learn_time_ms": 23561.086, "learn_throughput": 170.111, "synch_weights_time_ms": 21.577}, "counters": {"num_env_steps_sampled": 184368, "num_env_steps_trained": 184368, "num_agent_steps_sampled": 737472, "num_agent_steps_trained": 737472}, "done": false, "training_iteration": 46, "trial_id": "7f713_00000", "date": "2024-08-23_10-07-28", "timestamp": 1724387848, "time_this_iter_s": 26.376354932785034, "time_total_s": 1246.4053604602814, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737bdf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1246.4053604602814, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 37.56486486486486, "ram_util_percent": 82.76486486486489}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.11052570418706, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.209451570964994, "policy_loss": -0.007544844774972825, "vf_loss": 8.215685749558544, "vf_explained_var": 0.5105036369707219, "kl": 0.006553176299930013, "entropy": 0.5473078809402607, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 43943.0, "diff_num_grad_updates_vs_sampler_policy": 489.4476047904173}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.000380470639183, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.1671132112937, "policy_loss": -0.008238804223084891, "vf_loss": 8.174786239704758, "vf_explained_var": 0.27681412526539395, "kl": 0.005657596877534633, "entropy": 0.30998903177087267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 43943.0, "diff_num_grad_updates_vs_sampler_policy": 489.4476047904173}}, "num_env_steps_sampled": 188376, "num_env_steps_trained": 188376, "num_agent_steps_sampled": 753504, "num_agent_steps_trained": 753504}, "env_runners": {"episode_reward_max": 921.6626964622534, "episode_reward_min": -5.530627371686129, "episode_reward_mean": 213.68773913968377, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1655.4937746057963, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 366.287623821295, "predator_policy": 1655.4937746057963}, "policy_reward_mean": {"prey_policy": -844.1837518093807, "predator_policy": 951.0276213792225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.9999999999999967, 8.666480233761053, 1.52122951308676, 431.18478316111106, 550.3672799734084, 0.5999999999999979, 0.4999999999999982, 524.2912542297894, 523.96839068652, 0.3500302715172303, 266.65190351545084, 307.800934875856, 160.71572091243206, 411.87666379536086, 87.58125036920752, 103.53589567120694, 208.57506117046177, 169.42243059141433, 194.17361121876237, 377.402240608259, 228.6803436388489, 296.8080135427653, 612.0295483913046, 13.66652520385333, 12.010089131738543, 276.6072376814803, 4.1511469855792775, 451.8650044182909, -5.530627371686129, 27.155933990862927, 23.9243941245792, 6.637878140717891, 156.37223136685924, 360.29462014531316, 9.9768659943549, 389.9130216165581, 713.9838009502766, -1.2434497875801753e-14, 261.6319459361053, 8.155714635487424, 504.16427085937653, 108.71538898248808, 132.02785030550274, 298.249932813459, 6.661338147750939e-15, 3.3000000000000025, -4.620968472245875, 67.80535835248924, 30.922188777211026, 172.4729098274312, 245.44009733494894, 155.06828745946112, 479.1140041346834, 537.2288343822395, 1.5000000000000013, 221.4283338438391, 0.5786039128317082, 416.6200240493257, 357.01611711291406, 765.8620038240576, 1.4682135629253845, 9.77355299625384, 317.5081241651277, 109.61676600607112, 378.31437619866125, 0.499999999999994, 86.69870452782637, 213.59958998194958, 764.375274879386, 326.6404549326614, 135.7880214917709, 170.12916889754527, -8.881784197001252e-16, -3.7014428372067227, 90.37612556873927, 3.5, 10.700000000000003, 469.774777200149, 236.67908486145464, -1.7319479184152442e-14, 115.77769991961598, 29.693889334569203, 7.100000000000016, 5.100000000000001, 334.9245591843899, 179.26630188720353, -0.06272935566335036, 433.67872116209196, 203.44491517503153, 2.207172096107822, 499.3697073692804, 661.1247056623847, -1.3766765505351941e-14, 285.93973592535946, 904.0068095932193, 346.1299487747443, 0.704805308043607, 448.5468150969202, -2.9947188813976062, 921.6626964622534], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1480.3547985385767, -1545.7408934181967, -1420.350212581263, -1244.7000654500807, -1319.9596271951377, -1379.339355580666, -1207.6567575210338, -398.24595013163787, -791.3708661382852, 10.445160033115602, -1382.481436231161, -1266.230683093028, -1293.8951084951084, -1338.7460883357176, -1198.8132657794422, 40.0000000000003, 31.32273043566605, -854.3721882430644, -1426.3339145974971, -1189.6486950948977, -1025.7563676457196, -445.5318984992967, 291.1502781557372, -1365.6083691354052, -749.422534307358, -909.2432658572653, -1140.8160550747189, -201.58598135939093, -847.6892813435395, -25.264049214685755, -1203.771569905877, -1179.342278351509, -1327.118119807983, 201.80608002042382, 40.0000000000003, -1304.390557614894, -972.7143094136925, -174.6010433792558, -374.8500210176404, -848.2283082578912, 31.409061599047963, -1353.3889980774848, -990.0200085218129, -467.6873207911829, -820.7178946506284, 29.707428604293714, -794.7602196710975, -1235.1028014886872, -1134.6574372864065, -809.0244757780292, -979.2464277226975, 149.2444300022631, -1136.1784558176107, -1448.154974558935, -879.4492308232637, -148.07169251393614, -1528.2887277705279, -1442.7088109713939, -1091.0711323218004, -1347.2609248309316, -590.7160042092909, -1116.289104875807, -1025.3057278637452, -1251.3919487837125, -546.3578941397668, -769.3503052368652, 40.0000000000003, -1234.3781249899462, -1282.5672322379285, -803.5326448803172, -383.00354771286476, -920.0539546580927, -613.5549914687072, 366.287623821295, -1418.5148394912487, -1587.3042183503478, -1414.3154216345872, -773.9718725601745, -1226.4660453080746, -1298.5836880026452, -572.0644776526287, -279.63835338618395, -1182.4902027459793, -491.92890124770724, -414.352923839947, -1407.659270564138, -958.8874592828355, -36.191854500758936, -1339.5344774083137, -1288.448793049668, -1127.8547190986085, -989.0364360725621, -1322.0636152367354, -1375.7070595136922, -1215.665087657283, -1338.1226615812022, -887.2282380564528, -782.7439126332168, -984.8463309245923, -1001.2893781024197, -1415.2056062492004, -204.72667069507452, -1190.2383570017496, -741.2719601851134, -1398.3897047751386, -219.67116607303885, -795.0216439616962, 4.250283951439502, -1008.6113253185033, -1338.2538199074725, -847.5711313797559, -473.4042989927596, -1199.322191843784, -1390.4049496325997, -334.6800372809654, -371.09299372379746, -1439.386273594749, -482.30494279014135, 40.855620435355405, -730.0354623368082, -1154.164497443126, -1466.970147083058, -1196.0067988143535, -1343.7802535833366, -478.69314931368797, -611.0105634439003, -1117.0826360678047, -579.4532021480247, 359.41193070580744, -985.8524891362164, -1159.410561404252, -1301.504687574272, -528.0919559222797, -44.2687153004847, -98.3656414261861, -765.1794390852821, -938.3010585487674, 283.307053619092, 19.367418726393186, -1178.2566574685181, -1012.5798526335831, -211.58566949959388, -824.8946890356113, -265.8032516283727, -1390.6487444090758, -1134.341848908161, -1465.6350195747295, -1384.0652573209481, -1565.8859319438013, 11.587328108938914, -1241.5093023278257, -1221.223902948603, -1655.4937746057963, -924.0818836857867, -1117.0038677401396, -643.5275276784266, -250.0234716276928, -669.1753528432874, -1168.6069338136808, -1616.0278886858657, -819.2013220461964, -1199.476994687043, -227.2555715971255, -844.0163842377652, -1197.8280380895712, -907.5067932720823, -1240.3819802857147, -885.2778338499234, -526.5364648985545, -1365.2349590472352, 94.76504846289771, -987.7169418993052, -1477.2145801683344, -1183.0563014847648, -834.3460444408959, -366.3731769160092, -1038.809091934502, -1048.2087209408257, -1267.6361404831775, -859.324832881715, 13.590917477325599, -1280.3149179787288, -363.63362189814893, 319.3461056988621, -1331.182557773519, -1266.1328103165602, -614.7602668979367, -924.948632627507, -795.6367273701144, 351.4597153207905, -931.31454656282, 96.91355452183751, -1249.216178186772, -990.1044938921, 214.88907341702202, -1156.0137793204972, -769.5752695023845, -1423.0881682163952, -822.9160399612996, 295.8473082550141], "policy_predator_policy_reward": [1480.3547985385767, 1546.7408934181967, 1420.7502125812628, 1252.9665456838422, 1320.1807061724226, 1380.639506116468, 1147.8381531147331, 889.24933769905, 866.1358224073459, 465.1571636712331, 1382.481436231161, 1266.830683093028, 1294.2951084951083, 1338.8460883357177, 666.1469557616916, 1016.9575642475401, 668.9706762255157, 678.0471722683975, 1426.3339145974971, 1189.9987253664149, 993.3004155434796, 744.6397541169863, 15.964316576401409, 1366.2947092791228, 378.89170796324476, 1440.4898131138084, 1108.3939708941652, 645.8847293353052, 590.1420223720913, 370.3925585553416, 1376.640334906758, 1110.0094090218329, 1333.1181198079826, 0.7689811500379805, 157.4998292856848, 1276.3131589206232, 604.9819385739548, 736.5070254377541, 1018.0597184328325, 582.4208514509593, 227.36278578571518, 1323.2974943315737, 959.2941695302165, 795.2211733255486, 597.223853337842, 805.8161610997901, 803.437845228149, 1240.091701135489, 1130.005778174471, 825.6862240217039, 479.9929297084121, 626.6163056935037, 1188.7750599166125, 1399.7095174455108, 859.7671657465304, 619.618762008955, 1469.9362333603158, 1495.5306780099195, 1118.5287183504702, 1346.9592727931242, 611.3403983338704, 1119.5891048758072, 1033.7488051853334, 1249.586749602842, 747.6328136790439, 724.447617064448, 509.2205353172256, 1045.452209818028, 1290.5440982322823, 805.5326448803172, 683.2778072081675, 1009.6927167793425, 500.63210467652164, 460.6190639211707, 1418.5148394912487, 1587.3042183503478, 1042.841485569817, 1407.077754561051, 1234.4660453080746, 1298.7394026381326, 513.290155848229, 842.5769460499596, 1227.7862547936988, 555.3482381824772, 546.3807741454497, 1407.659270564138, 977.1472962831056, 316.18195031394794, 1339.5344774083137, 1288.448793049668, 1127.8547190986085, 992.3364360725622, 1317.2901240967888, 1375.8595821813904, 1215.3105952454725, 1406.2825123455013, 986.9976254545774, 713.8967140123037, 1135.181976761688, 1023.4266420927496, 1014.0626783646735, 851.3096959145521, 1228.9398993637863, 857.638705282539, 1253.9381421237943, 843.2367328590725, 563.8953647666319, 764.1048296258616, 1010.1113253185036, 1338.2538199074725, 687.4303050097639, 854.9734592065912, 1199.9007957566157, 1390.4049496325997, 317.9316195095759, 804.4614355445141, 1264.9718460584488, 1013.7354874393609, 821.232961476185, 633.8088842493262, 1155.6327110060513, 1466.970147083058, 1206.029393518979, 1343.5312118749641, 796.7779327217963, 610.4339042009194, 842.9211025444065, 963.2315016774976, 11.274862555359297, 993.4800720737112, 1159.410561404252, 1302.004687574272, 64.07602895059469, 594.9833467999982, 303.5062613611553, 773.6384091322625, 762.3727095528748, 656.9965702561838, 345.7204945593554, 1139.8091991154286, 1028.4571433408044, 331.49640028414206, 482.25905952284893, 778.5680500386788, 1390.6487444090758, 1134.341848908161, 1468.04435072012, 1377.95448333835, 1565.8859319438013, 78.78879745980048, 1242.5093023278257, 1223.7239029486032, 1655.4937746057963, 934.7818836857869, 1041.5832341776133, 1188.722938441103, 0.0, 1155.877909332437, 1168.6069338136808, 1616.0278886858657, 961.9110258570972, 1172.5449907957575, 250.34946093169359, 850.6163842377653, 1204.2280380895709, 908.2067932720825, 1243.0819802857147, 887.6778338499232, 979.729025454658, 1246.9669576755264, 7.536464442272491, 1064.681730881338, 1477.2145801683344, 1182.9935721291015, 693.5194530726916, 940.8784894463007, 1283.8278951947586, 1006.6348328556006, 1281.752578693475, 847.4155667675265, 642.3220428305707, 1123.7716650401132, 247.1197158999678, 458.29250596170044, 1331.182557773519, 1266.1328103165602, 989.4161343157481, 836.232501135062, 746.1818225468089, 602.0019990957311, 886.0601842733, 294.47075654242565, 1186.6928759296923, 1053.3326014572244, 320.0359493100292, 1069.6355716903588, 660.7963026192872, 1528.8724162180943, 779.3919943785345, 669.3394337900016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.069091472177618, "mean_inference_ms": 7.231320177260492, "mean_action_processing_ms": 2.5004429011307376, "mean_env_wait_ms": 17.021685254352562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014406561851501465, "StateBufferConnector_ms": 0.005961060523986816, "ViewRequirementAgentConnector_ms": 0.25977158546447754}, "num_episodes": 13, "episode_return_max": 921.6626964622534, "episode_return_min": -5.530627371686129, "episode_return_mean": 213.68773913968377, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 753504, "num_agent_steps_trained": 753504, "num_env_steps_sampled": 188376, "num_env_steps_trained": 188376, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 146.32253513229327, "num_env_steps_trained_throughput_per_sec": 146.32253513229327, "timesteps_total": 188376, "num_env_steps_sampled_lifetime": 188376, "num_agent_steps_sampled_lifetime": 753504, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 753504, "timers": {"training_iteration_time_ms": 26787.699, "restore_workers_time_ms": 0.023, "training_step_time_ms": 26787.11, "sample_time_ms": 3188.537, "learn_time_ms": 23572.149, "learn_throughput": 170.031, "synch_weights_time_ms": 22.561}, "counters": {"num_env_steps_sampled": 188376, "num_env_steps_trained": 188376, "num_agent_steps_sampled": 753504, "num_agent_steps_trained": 753504}, "done": false, "training_iteration": 47, "trial_id": "7f713_00000", "date": "2024-08-23_10-07-55", "timestamp": 1724387875, "time_this_iter_s": 27.444396018981934, "time_total_s": 1273.8497564792633, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x173753af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1273.8497564792633, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 40.897435897435905, "ram_util_percent": 83.06923076923078}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.329247886163216, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.859184452339455, "policy_loss": -0.010158151400487416, "vf_loss": 7.867919768984356, "vf_explained_var": 0.5774690550471109, "kl": 0.007114132556315295, "entropy": 0.5813554567634744, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 44888.0, "diff_num_grad_updates_vs_sampler_policy": 489.4476047904173}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.478750925467757, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 7.788363038421308, "policy_loss": -0.007951994877180488, "vf_loss": 7.795781271293681, "vf_explained_var": 0.28342811096282233, "kl": 0.005337725905455137, "entropy": 0.35338533981136544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 44888.0, "diff_num_grad_updates_vs_sampler_policy": 489.4476047904173}}, "num_env_steps_sampled": 192384, "num_env_steps_trained": 192384, "num_agent_steps_sampled": 769536, "num_agent_steps_trained": 769536}, "env_runners": {"episode_reward_max": 921.6626964622534, "episode_reward_min": -5.530627371686129, "episode_reward_mean": 206.06937548602735, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1655.4937746057963, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 366.287623821295, "predator_policy": 1655.4937746057963}, "policy_reward_mean": {"prey_policy": -813.3307461722973, "predator_policy": 916.3654339153109}, "custom_metrics": {}, "hist_stats": {"episode_reward": [307.800934875856, 160.71572091243206, 411.87666379536086, 87.58125036920752, 103.53589567120694, 208.57506117046177, 169.42243059141433, 194.17361121876237, 377.402240608259, 228.6803436388489, 296.8080135427653, 612.0295483913046, 13.66652520385333, 12.010089131738543, 276.6072376814803, 4.1511469855792775, 451.8650044182909, -5.530627371686129, 27.155933990862927, 23.9243941245792, 6.637878140717891, 156.37223136685924, 360.29462014531316, 9.9768659943549, 389.9130216165581, 713.9838009502766, -1.2434497875801753e-14, 261.6319459361053, 8.155714635487424, 504.16427085937653, 108.71538898248808, 132.02785030550274, 298.249932813459, 6.661338147750939e-15, 3.3000000000000025, -4.620968472245875, 67.80535835248924, 30.922188777211026, 172.4729098274312, 245.44009733494894, 155.06828745946112, 479.1140041346834, 537.2288343822395, 1.5000000000000013, 221.4283338438391, 0.5786039128317082, 416.6200240493257, 357.01611711291406, 765.8620038240576, 1.4682135629253845, 9.77355299625384, 317.5081241651277, 109.61676600607112, 378.31437619866125, 0.499999999999994, 86.69870452782637, 213.59958998194958, 764.375274879386, 326.6404549326614, 135.7880214917709, 170.12916889754527, -8.881784197001252e-16, -3.7014428372067227, 90.37612556873927, 3.5, 10.700000000000003, 469.774777200149, 236.67908486145464, -1.7319479184152442e-14, 115.77769991961598, 29.693889334569203, 7.100000000000016, 5.100000000000001, 334.9245591843899, 179.26630188720353, -0.06272935566335036, 433.67872116209196, 203.44491517503153, 2.207172096107822, 499.3697073692804, 661.1247056623847, -1.3766765505351941e-14, 285.93973592535946, 904.0068095932193, 346.1299487747443, 0.704805308043607, 448.5468150969202, -2.9947188813976062, 921.6626964622534, 90.36192066532652, 5.626419039907068, 166.39982702440824, 25.899999999999984, 30.80000000000006, 101.69219002123782, 69.80000000000018, 315.67051042059927, -0.09788983233979165, 375.20641338546403, 365.90559549440223], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [291.1502781557372, -1365.6083691354052, -749.422534307358, -909.2432658572653, -1140.8160550747189, -201.58598135939093, -847.6892813435395, -25.264049214685755, -1203.771569905877, -1179.342278351509, -1327.118119807983, 201.80608002042382, 40.0000000000003, -1304.390557614894, -972.7143094136925, -174.6010433792558, -374.8500210176404, -848.2283082578912, 31.409061599047963, -1353.3889980774848, -990.0200085218129, -467.6873207911829, -820.7178946506284, 29.707428604293714, -794.7602196710975, -1235.1028014886872, -1134.6574372864065, -809.0244757780292, -979.2464277226975, 149.2444300022631, -1136.1784558176107, -1448.154974558935, -879.4492308232637, -148.07169251393614, -1528.2887277705279, -1442.7088109713939, -1091.0711323218004, -1347.2609248309316, -590.7160042092909, -1116.289104875807, -1025.3057278637452, -1251.3919487837125, -546.3578941397668, -769.3503052368652, 40.0000000000003, -1234.3781249899462, -1282.5672322379285, -803.5326448803172, -383.00354771286476, -920.0539546580927, -613.5549914687072, 366.287623821295, -1418.5148394912487, -1587.3042183503478, -1414.3154216345872, -773.9718725601745, -1226.4660453080746, -1298.5836880026452, -572.0644776526287, -279.63835338618395, -1182.4902027459793, -491.92890124770724, -414.352923839947, -1407.659270564138, -958.8874592828355, -36.191854500758936, -1339.5344774083137, -1288.448793049668, -1127.8547190986085, -989.0364360725621, -1322.0636152367354, -1375.7070595136922, -1215.665087657283, -1338.1226615812022, -887.2282380564528, -782.7439126332168, -984.8463309245923, -1001.2893781024197, -1415.2056062492004, -204.72667069507452, -1190.2383570017496, -741.2719601851134, -1398.3897047751386, -219.67116607303885, -795.0216439616962, 4.250283951439502, -1008.6113253185033, -1338.2538199074725, -847.5711313797559, -473.4042989927596, -1199.322191843784, -1390.4049496325997, -334.6800372809654, -371.09299372379746, -1439.386273594749, -482.30494279014135, 40.855620435355405, -730.0354623368082, -1154.164497443126, -1466.970147083058, -1196.0067988143535, -1343.7802535833366, -478.69314931368797, -611.0105634439003, -1117.0826360678047, -579.4532021480247, 359.41193070580744, -985.8524891362164, -1159.410561404252, -1301.504687574272, -528.0919559222797, -44.2687153004847, -98.3656414261861, -765.1794390852821, -938.3010585487674, 283.307053619092, 19.367418726393186, -1178.2566574685181, -1012.5798526335831, -211.58566949959388, -824.8946890356113, -265.8032516283727, -1390.6487444090758, -1134.341848908161, -1465.6350195747295, -1384.0652573209481, -1565.8859319438013, 11.587328108938914, -1241.5093023278257, -1221.223902948603, -1655.4937746057963, -924.0818836857867, -1117.0038677401396, -643.5275276784266, -250.0234716276928, -669.1753528432874, -1168.6069338136808, -1616.0278886858657, -819.2013220461964, -1199.476994687043, -227.2555715971255, -844.0163842377652, -1197.8280380895712, -907.5067932720823, -1240.3819802857147, -885.2778338499234, -526.5364648985545, -1365.2349590472352, 94.76504846289771, -987.7169418993052, -1477.2145801683344, -1183.0563014847648, -834.3460444408959, -366.3731769160092, -1038.809091934502, -1048.2087209408257, -1267.6361404831775, -859.324832881715, 13.590917477325599, -1280.3149179787288, -363.63362189814893, 319.3461056988621, -1331.182557773519, -1266.1328103165602, -614.7602668979367, -924.948632627507, -795.6367273701144, 351.4597153207905, -931.31454656282, 96.91355452183751, -1249.216178186772, -990.1044938921, 214.88907341702202, -1156.0137793204972, -769.5752695023845, -1423.0881682163952, -822.9160399612996, 295.8473082550141, -757.2636124276146, -949.6995536875828, -1052.6622198246644, -1057.961209611095, -1217.0392447029383, -516.3767147186295, -901.8814185532349, -1088.7964678888927, -445.3936941624513, -892.9300652509681, 36.702726375569526, -847.340320596769, -916.9401654949393, -161.85103039488553, -968.3276929895604, -110.15776253732294, -1136.9952595464035, -953.7389032951124, -13.186747338408809, -915.4878404298131, -175.13553639723415, -914.6964212113593], "policy_predator_policy_reward": [15.964316576401409, 1366.2947092791228, 378.89170796324476, 1440.4898131138084, 1108.3939708941652, 645.8847293353052, 590.1420223720913, 370.3925585553416, 1376.640334906758, 1110.0094090218329, 1333.1181198079826, 0.7689811500379805, 157.4998292856848, 1276.3131589206232, 604.9819385739548, 736.5070254377541, 1018.0597184328325, 582.4208514509593, 227.36278578571518, 1323.2974943315737, 959.2941695302165, 795.2211733255486, 597.223853337842, 805.8161610997901, 803.437845228149, 1240.091701135489, 1130.005778174471, 825.6862240217039, 479.9929297084121, 626.6163056935037, 1188.7750599166125, 1399.7095174455108, 859.7671657465304, 619.618762008955, 1469.9362333603158, 1495.5306780099195, 1118.5287183504702, 1346.9592727931242, 611.3403983338704, 1119.5891048758072, 1033.7488051853334, 1249.586749602842, 747.6328136790439, 724.447617064448, 509.2205353172256, 1045.452209818028, 1290.5440982322823, 805.5326448803172, 683.2778072081675, 1009.6927167793425, 500.63210467652164, 460.6190639211707, 1418.5148394912487, 1587.3042183503478, 1042.841485569817, 1407.077754561051, 1234.4660453080746, 1298.7394026381326, 513.290155848229, 842.5769460499596, 1227.7862547936988, 555.3482381824772, 546.3807741454497, 1407.659270564138, 977.1472962831056, 316.18195031394794, 1339.5344774083137, 1288.448793049668, 1127.8547190986085, 992.3364360725622, 1317.2901240967888, 1375.8595821813904, 1215.3105952454725, 1406.2825123455013, 986.9976254545774, 713.8967140123037, 1135.181976761688, 1023.4266420927496, 1014.0626783646735, 851.3096959145521, 1228.9398993637863, 857.638705282539, 1253.9381421237943, 843.2367328590725, 563.8953647666319, 764.1048296258616, 1010.1113253185036, 1338.2538199074725, 687.4303050097639, 854.9734592065912, 1199.9007957566157, 1390.4049496325997, 317.9316195095759, 804.4614355445141, 1264.9718460584488, 1013.7354874393609, 821.232961476185, 633.8088842493262, 1155.6327110060513, 1466.970147083058, 1206.029393518979, 1343.5312118749641, 796.7779327217963, 610.4339042009194, 842.9211025444065, 963.2315016774976, 11.274862555359297, 993.4800720737112, 1159.410561404252, 1302.004687574272, 64.07602895059469, 594.9833467999982, 303.5062613611553, 773.6384091322625, 762.3727095528748, 656.9965702561838, 345.7204945593554, 1139.8091991154286, 1028.4571433408044, 331.49640028414206, 482.25905952284893, 778.5680500386788, 1390.6487444090758, 1134.341848908161, 1468.04435072012, 1377.95448333835, 1565.8859319438013, 78.78879745980048, 1242.5093023278257, 1223.7239029486032, 1655.4937746057963, 934.7818836857869, 1041.5832341776133, 1188.722938441103, 0.0, 1155.877909332437, 1168.6069338136808, 1616.0278886858657, 961.9110258570972, 1172.5449907957575, 250.34946093169359, 850.6163842377653, 1204.2280380895709, 908.2067932720825, 1243.0819802857147, 887.6778338499232, 979.729025454658, 1246.9669576755264, 7.536464442272491, 1064.681730881338, 1477.2145801683344, 1182.9935721291015, 693.5194530726916, 940.8784894463007, 1283.8278951947586, 1006.6348328556006, 1281.752578693475, 847.4155667675265, 642.3220428305707, 1123.7716650401132, 247.1197158999678, 458.29250596170044, 1331.182557773519, 1266.1328103165602, 989.4161343157481, 836.232501135062, 746.1818225468089, 602.0019990957311, 886.0601842733, 294.47075654242565, 1186.6928759296923, 1053.3326014572244, 320.0359493100292, 1069.6355716903588, 660.7963026192872, 1528.8724162180943, 779.3919943785345, 669.3394337900016, 842.6255330929417, 954.6995536875828, 1069.017178702215, 1047.2326697734518, 1213.3261100603045, 686.4896763856718, 927.7814185532358, 1088.7964678888927, 475.99369416245173, 893.1300652509681, 403.8608192708115, 508.46896497162334, 931.4401654949419, 217.1510303948854, 809.8299887667243, 584.3259771807552, 1136.9952595464035, 953.6410134627727, 473.5786927020053, 830.3023084516773, 581.6751011957195, 874.0624519072769]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.077355335839727, "mean_inference_ms": 7.225622317643932, "mean_action_processing_ms": 2.5058099961758384, "mean_env_wait_ms": 17.088317500881775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014276981353759766, "StateBufferConnector_ms": 0.006135463714599609, "ViewRequirementAgentConnector_ms": 0.25758469104766846}, "num_episodes": 11, "episode_return_max": 921.6626964622534, "episode_return_min": -5.530627371686129, "episode_return_mean": 206.06937548602735, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 769536, "num_agent_steps_trained": 769536, "num_env_steps_sampled": 192384, "num_env_steps_trained": 192384, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 148.1002701239221, "num_env_steps_trained_throughput_per_sec": 148.1002701239221, "timesteps_total": 192384, "num_env_steps_sampled_lifetime": 192384, "num_agent_steps_sampled_lifetime": 769536, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 769536, "timers": {"training_iteration_time_ms": 26637.473, "restore_workers_time_ms": 0.03, "training_step_time_ms": 26636.913, "sample_time_ms": 3101.353, "learn_time_ms": 23508.023, "learn_throughput": 170.495, "synch_weights_time_ms": 23.195}, "counters": {"num_env_steps_sampled": 192384, "num_env_steps_trained": 192384, "num_agent_steps_sampled": 769536, "num_agent_steps_trained": 769536}, "done": false, "training_iteration": 48, "trial_id": "7f713_00000", "date": "2024-08-23_10-08-22", "timestamp": 1724387902, "time_this_iter_s": 27.115561962127686, "time_total_s": 1300.965318441391, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737c1430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1300.965318441391, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 39.15, "ram_util_percent": 83.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.263722314279548, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 8.211180400848388, "policy_loss": -0.011518885270648059, "vf_loss": 8.220776058378673, "vf_explained_var": 0.43407391845864596, "kl": 0.00961622952892588, "entropy": 0.5701114236677766, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 45833.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.91875640854003, "cur_kl_coeff": 0.1, "cur_lr": 0.00010000000000000003, "total_loss": 8.035854980428383, "policy_loss": -0.007039345796934511, "vf_loss": 8.042425400870187, "vf_explained_var": 0.1669163427655659, "kl": 0.004689469960119043, "entropy": 0.32674580416666765, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 45833.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 196392, "num_env_steps_trained": 196392, "num_agent_steps_sampled": 785568, "num_agent_steps_trained": 785568}, "env_runners": {"episode_reward_max": 921.6626964622534, "episode_reward_min": -5.530627371686129, "episode_reward_mean": 200.23726589056878, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1655.4937746057963, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 366.287623821295, "predator_policy": 1655.4937746057963}, "policy_reward_mean": {"prey_policy": -810.58767545216, "predator_policy": 910.7063083974443}, "custom_metrics": {}, "hist_stats": {"episode_reward": [194.17361121876237, 377.402240608259, 228.6803436388489, 296.8080135427653, 612.0295483913046, 13.66652520385333, 12.010089131738543, 276.6072376814803, 4.1511469855792775, 451.8650044182909, -5.530627371686129, 27.155933990862927, 23.9243941245792, 6.637878140717891, 156.37223136685924, 360.29462014531316, 9.9768659943549, 389.9130216165581, 713.9838009502766, -1.2434497875801753e-14, 261.6319459361053, 8.155714635487424, 504.16427085937653, 108.71538898248808, 132.02785030550274, 298.249932813459, 6.661338147750939e-15, 3.3000000000000025, -4.620968472245875, 67.80535835248924, 30.922188777211026, 172.4729098274312, 245.44009733494894, 155.06828745946112, 479.1140041346834, 537.2288343822395, 1.5000000000000013, 221.4283338438391, 0.5786039128317082, 416.6200240493257, 357.01611711291406, 765.8620038240576, 1.4682135629253845, 9.77355299625384, 317.5081241651277, 109.61676600607112, 378.31437619866125, 0.499999999999994, 86.69870452782637, 213.59958998194958, 764.375274879386, 326.6404549326614, 135.7880214917709, 170.12916889754527, -8.881784197001252e-16, -3.7014428372067227, 90.37612556873927, 3.5, 10.700000000000003, 469.774777200149, 236.67908486145464, -1.7319479184152442e-14, 115.77769991961598, 29.693889334569203, 7.100000000000016, 5.100000000000001, 334.9245591843899, 179.26630188720353, -0.06272935566335036, 433.67872116209196, 203.44491517503153, 2.207172096107822, 499.3697073692804, 661.1247056623847, -1.3766765505351941e-14, 285.93973592535946, 904.0068095932193, 346.1299487747443, 0.704805308043607, 448.5468150969202, -2.9947188813976062, 921.6626964622534, 90.36192066532652, 5.626419039907068, 166.39982702440824, 25.899999999999984, 30.80000000000006, 101.69219002123782, 69.80000000000018, 315.67051042059927, -0.09788983233979165, 375.20641338546403, 365.90559549440223, 411.5111890951681, 59.03322372606168, 54.20000000000004, 30.700000000000014, 56.88143591956542, 252.44599110398076, 1.5251579953050958], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-972.7143094136925, -174.6010433792558, -374.8500210176404, -848.2283082578912, 31.409061599047963, -1353.3889980774848, -990.0200085218129, -467.6873207911829, -820.7178946506284, 29.707428604293714, -794.7602196710975, -1235.1028014886872, -1134.6574372864065, -809.0244757780292, -979.2464277226975, 149.2444300022631, -1136.1784558176107, -1448.154974558935, -879.4492308232637, -148.07169251393614, -1528.2887277705279, -1442.7088109713939, -1091.0711323218004, -1347.2609248309316, -590.7160042092909, -1116.289104875807, -1025.3057278637452, -1251.3919487837125, -546.3578941397668, -769.3503052368652, 40.0000000000003, -1234.3781249899462, -1282.5672322379285, -803.5326448803172, -383.00354771286476, -920.0539546580927, -613.5549914687072, 366.287623821295, -1418.5148394912487, -1587.3042183503478, -1414.3154216345872, -773.9718725601745, -1226.4660453080746, -1298.5836880026452, -572.0644776526287, -279.63835338618395, -1182.4902027459793, -491.92890124770724, -414.352923839947, -1407.659270564138, -958.8874592828355, -36.191854500758936, -1339.5344774083137, -1288.448793049668, -1127.8547190986085, -989.0364360725621, -1322.0636152367354, -1375.7070595136922, -1215.665087657283, -1338.1226615812022, -887.2282380564528, -782.7439126332168, -984.8463309245923, -1001.2893781024197, -1415.2056062492004, -204.72667069507452, -1190.2383570017496, -741.2719601851134, -1398.3897047751386, -219.67116607303885, -795.0216439616962, 4.250283951439502, -1008.6113253185033, -1338.2538199074725, -847.5711313797559, -473.4042989927596, -1199.322191843784, -1390.4049496325997, -334.6800372809654, -371.09299372379746, -1439.386273594749, -482.30494279014135, 40.855620435355405, -730.0354623368082, -1154.164497443126, -1466.970147083058, -1196.0067988143535, -1343.7802535833366, -478.69314931368797, -611.0105634439003, -1117.0826360678047, -579.4532021480247, 359.41193070580744, -985.8524891362164, -1159.410561404252, -1301.504687574272, -528.0919559222797, -44.2687153004847, -98.3656414261861, -765.1794390852821, -938.3010585487674, 283.307053619092, 19.367418726393186, -1178.2566574685181, -1012.5798526335831, -211.58566949959388, -824.8946890356113, -265.8032516283727, -1390.6487444090758, -1134.341848908161, -1465.6350195747295, -1384.0652573209481, -1565.8859319438013, 11.587328108938914, -1241.5093023278257, -1221.223902948603, -1655.4937746057963, -924.0818836857867, -1117.0038677401396, -643.5275276784266, -250.0234716276928, -669.1753528432874, -1168.6069338136808, -1616.0278886858657, -819.2013220461964, -1199.476994687043, -227.2555715971255, -844.0163842377652, -1197.8280380895712, -907.5067932720823, -1240.3819802857147, -885.2778338499234, -526.5364648985545, -1365.2349590472352, 94.76504846289771, -987.7169418993052, -1477.2145801683344, -1183.0563014847648, -834.3460444408959, -366.3731769160092, -1038.809091934502, -1048.2087209408257, -1267.6361404831775, -859.324832881715, 13.590917477325599, -1280.3149179787288, -363.63362189814893, 319.3461056988621, -1331.182557773519, -1266.1328103165602, -614.7602668979367, -924.948632627507, -795.6367273701144, 351.4597153207905, -931.31454656282, 96.91355452183751, -1249.216178186772, -990.1044938921, 214.88907341702202, -1156.0137793204972, -769.5752695023845, -1423.0881682163952, -822.9160399612996, 295.8473082550141, -757.2636124276146, -949.6995536875828, -1052.6622198246644, -1057.961209611095, -1217.0392447029383, -516.3767147186295, -901.8814185532349, -1088.7964678888927, -445.3936941624513, -892.9300652509681, 36.702726375569526, -847.340320596769, -916.9401654949393, -161.85103039488553, -968.3276929895604, -110.15776253732294, -1136.9952595464035, -953.7389032951124, -13.186747338408809, -915.4878404298131, -175.13553639723415, -914.6964212113593, -45.72950995310549, 16.241121713132344, 1.2416049433707066, -472.5536917225556, -1078.6393040649064, -676.2608088075334, -1002.4843179687274, -468.4559537336911, -566.2353135154947, -937.9560005075227, -847.1073461335965, -931.1563055021751, -1204.6982997767955, -958.8874347394094], "policy_predator_policy_reward": [604.9819385739548, 736.5070254377541, 1018.0597184328325, 582.4208514509593, 227.36278578571518, 1323.2974943315737, 959.2941695302165, 795.2211733255486, 597.223853337842, 805.8161610997901, 803.437845228149, 1240.091701135489, 1130.005778174471, 825.6862240217039, 479.9929297084121, 626.6163056935037, 1188.7750599166125, 1399.7095174455108, 859.7671657465304, 619.618762008955, 1469.9362333603158, 1495.5306780099195, 1118.5287183504702, 1346.9592727931242, 611.3403983338704, 1119.5891048758072, 1033.7488051853334, 1249.586749602842, 747.6328136790439, 724.447617064448, 509.2205353172256, 1045.452209818028, 1290.5440982322823, 805.5326448803172, 683.2778072081675, 1009.6927167793425, 500.63210467652164, 460.6190639211707, 1418.5148394912487, 1587.3042183503478, 1042.841485569817, 1407.077754561051, 1234.4660453080746, 1298.7394026381326, 513.290155848229, 842.5769460499596, 1227.7862547936988, 555.3482381824772, 546.3807741454497, 1407.659270564138, 977.1472962831056, 316.18195031394794, 1339.5344774083137, 1288.448793049668, 1127.8547190986085, 992.3364360725622, 1317.2901240967888, 1375.8595821813904, 1215.3105952454725, 1406.2825123455013, 986.9976254545774, 713.8967140123037, 1135.181976761688, 1023.4266420927496, 1014.0626783646735, 851.3096959145521, 1228.9398993637863, 857.638705282539, 1253.9381421237943, 843.2367328590725, 563.8953647666319, 764.1048296258616, 1010.1113253185036, 1338.2538199074725, 687.4303050097639, 854.9734592065912, 1199.9007957566157, 1390.4049496325997, 317.9316195095759, 804.4614355445141, 1264.9718460584488, 1013.7354874393609, 821.232961476185, 633.8088842493262, 1155.6327110060513, 1466.970147083058, 1206.029393518979, 1343.5312118749641, 796.7779327217963, 610.4339042009194, 842.9211025444065, 963.2315016774976, 11.274862555359297, 993.4800720737112, 1159.410561404252, 1302.004687574272, 64.07602895059469, 594.9833467999982, 303.5062613611553, 773.6384091322625, 762.3727095528748, 656.9965702561838, 345.7204945593554, 1139.8091991154286, 1028.4571433408044, 331.49640028414206, 482.25905952284893, 778.5680500386788, 1390.6487444090758, 1134.341848908161, 1468.04435072012, 1377.95448333835, 1565.8859319438013, 78.78879745980048, 1242.5093023278257, 1223.7239029486032, 1655.4937746057963, 934.7818836857869, 1041.5832341776133, 1188.722938441103, 0.0, 1155.877909332437, 1168.6069338136808, 1616.0278886858657, 961.9110258570972, 1172.5449907957575, 250.34946093169359, 850.6163842377653, 1204.2280380895709, 908.2067932720825, 1243.0819802857147, 887.6778338499232, 979.729025454658, 1246.9669576755264, 7.536464442272491, 1064.681730881338, 1477.2145801683344, 1182.9935721291015, 693.5194530726916, 940.8784894463007, 1283.8278951947586, 1006.6348328556006, 1281.752578693475, 847.4155667675265, 642.3220428305707, 1123.7716650401132, 247.1197158999678, 458.29250596170044, 1331.182557773519, 1266.1328103165602, 989.4161343157481, 836.232501135062, 746.1818225468089, 602.0019990957311, 886.0601842733, 294.47075654242565, 1186.6928759296923, 1053.3326014572244, 320.0359493100292, 1069.6355716903588, 660.7963026192872, 1528.8724162180943, 779.3919943785345, 669.3394337900016, 842.6255330929417, 954.6995536875828, 1069.017178702215, 1047.2326697734518, 1213.3261100603045, 686.4896763856718, 927.7814185532358, 1088.7964678888927, 475.99369416245173, 893.1300652509681, 403.8608192708115, 508.46896497162334, 931.4401654949419, 217.1510303948854, 809.8299887667243, 584.3259771807552, 1136.9952595464035, 953.6410134627727, 473.5786927020053, 830.3023084516773, 581.6751011957195, 874.0624519072769, 220.6374107815994, 220.362166553541, 49.248567249215334, 481.0967432560313, 1078.6393040649064, 730.4608088075342, 1026.0843179687274, 475.5559537336914, 555.1073581046672, 1005.9653918379167, 1082.653964242743, 948.0556784970078, 1204.6982997767955, 960.4125927347148]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.03679430212001, "mean_inference_ms": 7.203698809547973, "mean_action_processing_ms": 2.50462544914761, "mean_env_wait_ms": 17.033011900221965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015242218971252441, "StateBufferConnector_ms": 0.008336782455444336, "ViewRequirementAgentConnector_ms": 0.23673474788665771}, "num_episodes": 7, "episode_return_max": 921.6626964622534, "episode_return_min": -5.530627371686129, "episode_return_mean": 200.23726589056878, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 785568, "num_agent_steps_trained": 785568, "num_env_steps_sampled": 196392, "num_env_steps_trained": 196392, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 147.86442697187067, "num_env_steps_trained_throughput_per_sec": 147.86442697187067, "timesteps_total": 196392, "num_env_steps_sampled_lifetime": 196392, "num_agent_steps_sampled_lifetime": 785568, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 785568, "timers": {"training_iteration_time_ms": 26635.181, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26634.625, "sample_time_ms": 3079.032, "learn_time_ms": 23527.456, "learn_throughput": 170.354, "synch_weights_time_ms": 23.113}, "counters": {"num_env_steps_sampled": 196392, "num_env_steps_trained": 196392, "num_agent_steps_sampled": 785568, "num_agent_steps_trained": 785568}, "done": false, "training_iteration": 49, "trial_id": "7f713_00000", "date": "2024-08-23_10-08-50", "timestamp": 1724387930, "time_this_iter_s": 27.181968927383423, "time_total_s": 1328.1472873687744, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30f7b4c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1328.1472873687744, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 39.917948717948725, "ram_util_percent": 82.94102564102563}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.70032846284291, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.6672705791614675, "policy_loss": -0.007289917974254836, "vf_loss": 7.672994119149667, "vf_explained_var": 0.5875638071191374, "kl": 0.007831962508390898, "entropy": 0.605800704382084, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 46778.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.959721071253377, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 7.902159374983853, "policy_loss": -0.008452300175965306, "vf_loss": 7.910294098324246, "vf_explained_var": 0.3213322404831175, "kl": 0.006350855720746848, "entropy": 0.3580664899298754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 46778.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 200400, "num_env_steps_trained": 200400, "num_agent_steps_sampled": 801600, "num_agent_steps_trained": 801600}, "env_runners": {"episode_reward_max": 921.6626964622534, "episode_reward_min": -5.530627371686129, "episode_reward_mean": 189.68455521277517, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1655.4937746057963, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 366.287623821295, "predator_policy": 1655.4937746057963}, "policy_reward_mean": {"prey_policy": -821.6768708100437, "predator_policy": 916.5191484164312}, "custom_metrics": {}, "hist_stats": {"episode_reward": [4.1511469855792775, 451.8650044182909, -5.530627371686129, 27.155933990862927, 23.9243941245792, 6.637878140717891, 156.37223136685924, 360.29462014531316, 9.9768659943549, 389.9130216165581, 713.9838009502766, -1.2434497875801753e-14, 261.6319459361053, 8.155714635487424, 504.16427085937653, 108.71538898248808, 132.02785030550274, 298.249932813459, 6.661338147750939e-15, 3.3000000000000025, -4.620968472245875, 67.80535835248924, 30.922188777211026, 172.4729098274312, 245.44009733494894, 155.06828745946112, 479.1140041346834, 537.2288343822395, 1.5000000000000013, 221.4283338438391, 0.5786039128317082, 416.6200240493257, 357.01611711291406, 765.8620038240576, 1.4682135629253845, 9.77355299625384, 317.5081241651277, 109.61676600607112, 378.31437619866125, 0.499999999999994, 86.69870452782637, 213.59958998194958, 764.375274879386, 326.6404549326614, 135.7880214917709, 170.12916889754527, -8.881784197001252e-16, -3.7014428372067227, 90.37612556873927, 3.5, 10.700000000000003, 469.774777200149, 236.67908486145464, -1.7319479184152442e-14, 115.77769991961598, 29.693889334569203, 7.100000000000016, 5.100000000000001, 334.9245591843899, 179.26630188720353, -0.06272935566335036, 433.67872116209196, 203.44491517503153, 2.207172096107822, 499.3697073692804, 661.1247056623847, -1.3766765505351941e-14, 285.93973592535946, 904.0068095932193, 346.1299487747443, 0.704805308043607, 448.5468150969202, -2.9947188813976062, 921.6626964622534, 90.36192066532652, 5.626419039907068, 166.39982702440824, 25.899999999999984, 30.80000000000006, 101.69219002123782, 69.80000000000018, 315.67051042059927, -0.09788983233979165, 375.20641338546403, 365.90559549440223, 411.5111890951681, 59.03322372606168, 54.20000000000004, 30.700000000000014, 56.88143591956542, 252.44599110398076, 1.5251579953050958, 38.74825673860411, 23.725420336662687, 19.41740177864405, -0.5893378023913964, 470.68349130375196, 16.199999999999953, 385.8213092823769, 2.099999999999995], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1136.1784558176107, -1448.154974558935, -879.4492308232637, -148.07169251393614, -1528.2887277705279, -1442.7088109713939, -1091.0711323218004, -1347.2609248309316, -590.7160042092909, -1116.289104875807, -1025.3057278637452, -1251.3919487837125, -546.3578941397668, -769.3503052368652, 40.0000000000003, -1234.3781249899462, -1282.5672322379285, -803.5326448803172, -383.00354771286476, -920.0539546580927, -613.5549914687072, 366.287623821295, -1418.5148394912487, -1587.3042183503478, -1414.3154216345872, -773.9718725601745, -1226.4660453080746, -1298.5836880026452, -572.0644776526287, -279.63835338618395, -1182.4902027459793, -491.92890124770724, -414.352923839947, -1407.659270564138, -958.8874592828355, -36.191854500758936, -1339.5344774083137, -1288.448793049668, -1127.8547190986085, -989.0364360725621, -1322.0636152367354, -1375.7070595136922, -1215.665087657283, -1338.1226615812022, -887.2282380564528, -782.7439126332168, -984.8463309245923, -1001.2893781024197, -1415.2056062492004, -204.72667069507452, -1190.2383570017496, -741.2719601851134, -1398.3897047751386, -219.67116607303885, -795.0216439616962, 4.250283951439502, -1008.6113253185033, -1338.2538199074725, -847.5711313797559, -473.4042989927596, -1199.322191843784, -1390.4049496325997, -334.6800372809654, -371.09299372379746, -1439.386273594749, -482.30494279014135, 40.855620435355405, -730.0354623368082, -1154.164497443126, -1466.970147083058, -1196.0067988143535, -1343.7802535833366, -478.69314931368797, -611.0105634439003, -1117.0826360678047, -579.4532021480247, 359.41193070580744, -985.8524891362164, -1159.410561404252, -1301.504687574272, -528.0919559222797, -44.2687153004847, -98.3656414261861, -765.1794390852821, -938.3010585487674, 283.307053619092, 19.367418726393186, -1178.2566574685181, -1012.5798526335831, -211.58566949959388, -824.8946890356113, -265.8032516283727, -1390.6487444090758, -1134.341848908161, -1465.6350195747295, -1384.0652573209481, -1565.8859319438013, 11.587328108938914, -1241.5093023278257, -1221.223902948603, -1655.4937746057963, -924.0818836857867, -1117.0038677401396, -643.5275276784266, -250.0234716276928, -669.1753528432874, -1168.6069338136808, -1616.0278886858657, -819.2013220461964, -1199.476994687043, -227.2555715971255, -844.0163842377652, -1197.8280380895712, -907.5067932720823, -1240.3819802857147, -885.2778338499234, -526.5364648985545, -1365.2349590472352, 94.76504846289771, -987.7169418993052, -1477.2145801683344, -1183.0563014847648, -834.3460444408959, -366.3731769160092, -1038.809091934502, -1048.2087209408257, -1267.6361404831775, -859.324832881715, 13.590917477325599, -1280.3149179787288, -363.63362189814893, 319.3461056988621, -1331.182557773519, -1266.1328103165602, -614.7602668979367, -924.948632627507, -795.6367273701144, 351.4597153207905, -931.31454656282, 96.91355452183751, -1249.216178186772, -990.1044938921, 214.88907341702202, -1156.0137793204972, -769.5752695023845, -1423.0881682163952, -822.9160399612996, 295.8473082550141, -757.2636124276146, -949.6995536875828, -1052.6622198246644, -1057.961209611095, -1217.0392447029383, -516.3767147186295, -901.8814185532349, -1088.7964678888927, -445.3936941624513, -892.9300652509681, 36.702726375569526, -847.340320596769, -916.9401654949393, -161.85103039488553, -968.3276929895604, -110.15776253732294, -1136.9952595464035, -953.7389032951124, -13.186747338408809, -915.4878404298131, -175.13553639723415, -914.6964212113593, -45.72950995310549, 16.241121713132344, 1.2416049433707066, -472.5536917225556, -1078.6393040649064, -676.2608088075334, -1002.4843179687274, -468.4559537336911, -566.2353135154947, -937.9560005075227, -847.1073461335965, -931.1563055021751, -1204.6982997767955, -958.8874347394094, -947.2182135197742, -916.3486525607844, -590.6217073955264, -789.3848889999588, -1099.7612063548745, -601.6515154919942, -995.1107707339378, -1087.2350454286232, -464.4696465124514, -151.23261218066585, -1185.244257021136, -770.6851698690383, -321.4416262431321, -1098.0410755995383, -915.1044373939989, -1028.9265921222284], "policy_predator_policy_reward": [1188.7750599166125, 1399.7095174455108, 859.7671657465304, 619.618762008955, 1469.9362333603158, 1495.5306780099195, 1118.5287183504702, 1346.9592727931242, 611.3403983338704, 1119.5891048758072, 1033.7488051853334, 1249.586749602842, 747.6328136790439, 724.447617064448, 509.2205353172256, 1045.452209818028, 1290.5440982322823, 805.5326448803172, 683.2778072081675, 1009.6927167793425, 500.63210467652164, 460.6190639211707, 1418.5148394912487, 1587.3042183503478, 1042.841485569817, 1407.077754561051, 1234.4660453080746, 1298.7394026381326, 513.290155848229, 842.5769460499596, 1227.7862547936988, 555.3482381824772, 546.3807741454497, 1407.659270564138, 977.1472962831056, 316.18195031394794, 1339.5344774083137, 1288.448793049668, 1127.8547190986085, 992.3364360725622, 1317.2901240967888, 1375.8595821813904, 1215.3105952454725, 1406.2825123455013, 986.9976254545774, 713.8967140123037, 1135.181976761688, 1023.4266420927496, 1014.0626783646735, 851.3096959145521, 1228.9398993637863, 857.638705282539, 1253.9381421237943, 843.2367328590725, 563.8953647666319, 764.1048296258616, 1010.1113253185036, 1338.2538199074725, 687.4303050097639, 854.9734592065912, 1199.9007957566157, 1390.4049496325997, 317.9316195095759, 804.4614355445141, 1264.9718460584488, 1013.7354874393609, 821.232961476185, 633.8088842493262, 1155.6327110060513, 1466.970147083058, 1206.029393518979, 1343.5312118749641, 796.7779327217963, 610.4339042009194, 842.9211025444065, 963.2315016774976, 11.274862555359297, 993.4800720737112, 1159.410561404252, 1302.004687574272, 64.07602895059469, 594.9833467999982, 303.5062613611553, 773.6384091322625, 762.3727095528748, 656.9965702561838, 345.7204945593554, 1139.8091991154286, 1028.4571433408044, 331.49640028414206, 482.25905952284893, 778.5680500386788, 1390.6487444090758, 1134.341848908161, 1468.04435072012, 1377.95448333835, 1565.8859319438013, 78.78879745980048, 1242.5093023278257, 1223.7239029486032, 1655.4937746057963, 934.7818836857869, 1041.5832341776133, 1188.722938441103, 0.0, 1155.877909332437, 1168.6069338136808, 1616.0278886858657, 961.9110258570972, 1172.5449907957575, 250.34946093169359, 850.6163842377653, 1204.2280380895709, 908.2067932720825, 1243.0819802857147, 887.6778338499232, 979.729025454658, 1246.9669576755264, 7.536464442272491, 1064.681730881338, 1477.2145801683344, 1182.9935721291015, 693.5194530726916, 940.8784894463007, 1283.8278951947586, 1006.6348328556006, 1281.752578693475, 847.4155667675265, 642.3220428305707, 1123.7716650401132, 247.1197158999678, 458.29250596170044, 1331.182557773519, 1266.1328103165602, 989.4161343157481, 836.232501135062, 746.1818225468089, 602.0019990957311, 886.0601842733, 294.47075654242565, 1186.6928759296923, 1053.3326014572244, 320.0359493100292, 1069.6355716903588, 660.7963026192872, 1528.8724162180943, 779.3919943785345, 669.3394337900016, 842.6255330929417, 954.6995536875828, 1069.017178702215, 1047.2326697734518, 1213.3261100603045, 686.4896763856718, 927.7814185532358, 1088.7964678888927, 475.99369416245173, 893.1300652509681, 403.8608192708115, 508.46896497162334, 931.4401654949419, 217.1510303948854, 809.8299887667243, 584.3259771807552, 1136.9952595464035, 953.6410134627727, 473.5786927020053, 830.3023084516773, 581.6751011957195, 874.0624519072769, 220.6374107815994, 220.362166553541, 49.248567249215334, 481.0967432560313, 1078.6393040649064, 730.4608088075342, 1026.0843179687274, 475.5559537336914, 555.1073581046672, 1005.9653918379167, 1082.653964242743, 948.0556784970078, 1204.6982997767955, 960.4125927347148, 983.5664702583784, 918.7486525607844, 614.3771758247735, 789.3548409073771, 1100.8612063548746, 619.9689172706377, 1234.7883115936306, 846.9681667665445, 448.1614160035638, 638.2243339933044, 1186.8442570211346, 785.2851698690405, 764.9923565887505, 1040.3116545362952, 917.2044373939993, 1028.9265921222284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.019428780233127, "mean_inference_ms": 7.189328038329814, "mean_action_processing_ms": 2.515005635396117, "mean_env_wait_ms": 17.01433619909998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01554417610168457, "StateBufferConnector_ms": 0.00829172134399414, "ViewRequirementAgentConnector_ms": 0.2414616346359253}, "num_episodes": 8, "episode_return_max": 921.6626964622534, "episode_return_min": -5.530627371686129, "episode_return_mean": 189.68455521277517, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 801600, "num_agent_steps_trained": 801600, "num_env_steps_sampled": 200400, "num_env_steps_trained": 200400, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 149.9906086805696, "num_env_steps_trained_throughput_per_sec": 149.9906086805696, "timesteps_total": 200400, "num_env_steps_sampled_lifetime": 200400, "num_agent_steps_sampled_lifetime": 801600, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 801600, "timers": {"training_iteration_time_ms": 26640.25, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26639.78, "sample_time_ms": 3123.001, "learn_time_ms": 23488.799, "learn_throughput": 170.635, "synch_weights_time_ms": 23.185}, "counters": {"num_env_steps_sampled": 200400, "num_env_steps_trained": 200400, "num_agent_steps_sampled": 801600, "num_agent_steps_trained": 801600}, "done": false, "training_iteration": 50, "trial_id": "7f713_00000", "date": "2024-08-23_10-09-16", "timestamp": 1724387956, "time_this_iter_s": 26.772293090820312, "time_total_s": 1354.9195804595947, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737b18b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1354.9195804595947, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 46.656756756756764, "ram_util_percent": 83.0972972972973}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.957883088803165, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.739776704677198, "policy_loss": -0.010937746959059653, "vf_loss": 7.749062127915639, "vf_explained_var": 0.649288533667408, "kl": 0.008261594358122066, "entropy": 0.6272370468687128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 47723.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.433252822028265, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 7.801928572175364, "policy_loss": -0.006304954699235697, "vf_loss": 7.807866911408762, "vf_explained_var": 0.3212651255900267, "kl": 0.007332307621393175, "entropy": 0.36638071138076683, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 47723.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 204408, "num_env_steps_trained": 204408, "num_agent_steps_sampled": 817632, "num_agent_steps_trained": 817632}, "env_runners": {"episode_reward_max": 921.6626964622534, "episode_reward_min": -4.620968472245875, "episode_reward_mean": 197.6450357609812, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1655.4937746057963, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 366.287623821295, "predator_policy": 1655.4937746057963}, "policy_reward_mean": {"prey_policy": -799.9217652870236, "predator_policy": 898.744283167514}, "custom_metrics": {}, "hist_stats": {"episode_reward": [156.37223136685924, 360.29462014531316, 9.9768659943549, 389.9130216165581, 713.9838009502766, -1.2434497875801753e-14, 261.6319459361053, 8.155714635487424, 504.16427085937653, 108.71538898248808, 132.02785030550274, 298.249932813459, 6.661338147750939e-15, 3.3000000000000025, -4.620968472245875, 67.80535835248924, 30.922188777211026, 172.4729098274312, 245.44009733494894, 155.06828745946112, 479.1140041346834, 537.2288343822395, 1.5000000000000013, 221.4283338438391, 0.5786039128317082, 416.6200240493257, 357.01611711291406, 765.8620038240576, 1.4682135629253845, 9.77355299625384, 317.5081241651277, 109.61676600607112, 378.31437619866125, 0.499999999999994, 86.69870452782637, 213.59958998194958, 764.375274879386, 326.6404549326614, 135.7880214917709, 170.12916889754527, -8.881784197001252e-16, -3.7014428372067227, 90.37612556873927, 3.5, 10.700000000000003, 469.774777200149, 236.67908486145464, -1.7319479184152442e-14, 115.77769991961598, 29.693889334569203, 7.100000000000016, 5.100000000000001, 334.9245591843899, 179.26630188720353, -0.06272935566335036, 433.67872116209196, 203.44491517503153, 2.207172096107822, 499.3697073692804, 661.1247056623847, -1.3766765505351941e-14, 285.93973592535946, 904.0068095932193, 346.1299487747443, 0.704805308043607, 448.5468150969202, -2.9947188813976062, 921.6626964622534, 90.36192066532652, 5.626419039907068, 166.39982702440824, 25.899999999999984, 30.80000000000006, 101.69219002123782, 69.80000000000018, 315.67051042059927, -0.09788983233979165, 375.20641338546403, 365.90559549440223, 411.5111890951681, 59.03322372606168, 54.20000000000004, 30.700000000000014, 56.88143591956542, 252.44599110398076, 1.5251579953050958, 38.74825673860411, 23.725420336662687, 19.41740177864405, -0.5893378023913964, 470.68349130375196, 16.199999999999953, 385.8213092823769, 2.099999999999995, 779.1879292271482, 103.40319521915576, 3.9736347688265345, 10.286905403813313, 151.71056205898486, 255.68955843102012], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-546.3578941397668, -769.3503052368652, 40.0000000000003, -1234.3781249899462, -1282.5672322379285, -803.5326448803172, -383.00354771286476, -920.0539546580927, -613.5549914687072, 366.287623821295, -1418.5148394912487, -1587.3042183503478, -1414.3154216345872, -773.9718725601745, -1226.4660453080746, -1298.5836880026452, -572.0644776526287, -279.63835338618395, -1182.4902027459793, -491.92890124770724, -414.352923839947, -1407.659270564138, -958.8874592828355, -36.191854500758936, -1339.5344774083137, -1288.448793049668, -1127.8547190986085, -989.0364360725621, -1322.0636152367354, -1375.7070595136922, -1215.665087657283, -1338.1226615812022, -887.2282380564528, -782.7439126332168, -984.8463309245923, -1001.2893781024197, -1415.2056062492004, -204.72667069507452, -1190.2383570017496, -741.2719601851134, -1398.3897047751386, -219.67116607303885, -795.0216439616962, 4.250283951439502, -1008.6113253185033, -1338.2538199074725, -847.5711313797559, -473.4042989927596, -1199.322191843784, -1390.4049496325997, -334.6800372809654, -371.09299372379746, -1439.386273594749, -482.30494279014135, 40.855620435355405, -730.0354623368082, -1154.164497443126, -1466.970147083058, -1196.0067988143535, -1343.7802535833366, -478.69314931368797, -611.0105634439003, -1117.0826360678047, -579.4532021480247, 359.41193070580744, -985.8524891362164, -1159.410561404252, -1301.504687574272, -528.0919559222797, -44.2687153004847, -98.3656414261861, -765.1794390852821, -938.3010585487674, 283.307053619092, 19.367418726393186, -1178.2566574685181, -1012.5798526335831, -211.58566949959388, -824.8946890356113, -265.8032516283727, -1390.6487444090758, -1134.341848908161, -1465.6350195747295, -1384.0652573209481, -1565.8859319438013, 11.587328108938914, -1241.5093023278257, -1221.223902948603, -1655.4937746057963, -924.0818836857867, -1117.0038677401396, -643.5275276784266, -250.0234716276928, -669.1753528432874, -1168.6069338136808, -1616.0278886858657, -819.2013220461964, -1199.476994687043, -227.2555715971255, -844.0163842377652, -1197.8280380895712, -907.5067932720823, -1240.3819802857147, -885.2778338499234, -526.5364648985545, -1365.2349590472352, 94.76504846289771, -987.7169418993052, -1477.2145801683344, -1183.0563014847648, -834.3460444408959, -366.3731769160092, -1038.809091934502, -1048.2087209408257, -1267.6361404831775, -859.324832881715, 13.590917477325599, -1280.3149179787288, -363.63362189814893, 319.3461056988621, -1331.182557773519, -1266.1328103165602, -614.7602668979367, -924.948632627507, -795.6367273701144, 351.4597153207905, -931.31454656282, 96.91355452183751, -1249.216178186772, -990.1044938921, 214.88907341702202, -1156.0137793204972, -769.5752695023845, -1423.0881682163952, -822.9160399612996, 295.8473082550141, -757.2636124276146, -949.6995536875828, -1052.6622198246644, -1057.961209611095, -1217.0392447029383, -516.3767147186295, -901.8814185532349, -1088.7964678888927, -445.3936941624513, -892.9300652509681, 36.702726375569526, -847.340320596769, -916.9401654949393, -161.85103039488553, -968.3276929895604, -110.15776253732294, -1136.9952595464035, -953.7389032951124, -13.186747338408809, -915.4878404298131, -175.13553639723415, -914.6964212113593, -45.72950995310549, 16.241121713132344, 1.2416049433707066, -472.5536917225556, -1078.6393040649064, -676.2608088075334, -1002.4843179687274, -468.4559537336911, -566.2353135154947, -937.9560005075227, -847.1073461335965, -931.1563055021751, -1204.6982997767955, -958.8874347394094, -947.2182135197742, -916.3486525607844, -590.6217073955264, -789.3848889999588, -1099.7612063548745, -601.6515154919942, -995.1107707339378, -1087.2350454286232, -464.4696465124514, -151.23261218066585, -1185.244257021136, -770.6851698690383, -321.4416262431321, -1098.0410755995383, -915.1044373939989, -1028.9265921222284, -8.475470527248037, -623.0710605905507, -1096.146028271036, -635.0433024884297, -1298.0763123729787, -1194.6707629662762, -585.7917343687759, -502.03206785116043, -265.52512579987297, -1115.5078745913495, -1208.3307354560275, -121.19515545319831], "policy_predator_policy_reward": [747.6328136790439, 724.447617064448, 509.2205353172256, 1045.452209818028, 1290.5440982322823, 805.5326448803172, 683.2778072081675, 1009.6927167793425, 500.63210467652164, 460.6190639211707, 1418.5148394912487, 1587.3042183503478, 1042.841485569817, 1407.077754561051, 1234.4660453080746, 1298.7394026381326, 513.290155848229, 842.5769460499596, 1227.7862547936988, 555.3482381824772, 546.3807741454497, 1407.659270564138, 977.1472962831056, 316.18195031394794, 1339.5344774083137, 1288.448793049668, 1127.8547190986085, 992.3364360725622, 1317.2901240967888, 1375.8595821813904, 1215.3105952454725, 1406.2825123455013, 986.9976254545774, 713.8967140123037, 1135.181976761688, 1023.4266420927496, 1014.0626783646735, 851.3096959145521, 1228.9398993637863, 857.638705282539, 1253.9381421237943, 843.2367328590725, 563.8953647666319, 764.1048296258616, 1010.1113253185036, 1338.2538199074725, 687.4303050097639, 854.9734592065912, 1199.9007957566157, 1390.4049496325997, 317.9316195095759, 804.4614355445141, 1264.9718460584488, 1013.7354874393609, 821.232961476185, 633.8088842493262, 1155.6327110060513, 1466.970147083058, 1206.029393518979, 1343.5312118749641, 796.7779327217963, 610.4339042009194, 842.9211025444065, 963.2315016774976, 11.274862555359297, 993.4800720737112, 1159.410561404252, 1302.004687574272, 64.07602895059469, 594.9833467999982, 303.5062613611553, 773.6384091322625, 762.3727095528748, 656.9965702561838, 345.7204945593554, 1139.8091991154286, 1028.4571433408044, 331.49640028414206, 482.25905952284893, 778.5680500386788, 1390.6487444090758, 1134.341848908161, 1468.04435072012, 1377.95448333835, 1565.8859319438013, 78.78879745980048, 1242.5093023278257, 1223.7239029486032, 1655.4937746057963, 934.7818836857869, 1041.5832341776133, 1188.722938441103, 0.0, 1155.877909332437, 1168.6069338136808, 1616.0278886858657, 961.9110258570972, 1172.5449907957575, 250.34946093169359, 850.6163842377653, 1204.2280380895709, 908.2067932720825, 1243.0819802857147, 887.6778338499232, 979.729025454658, 1246.9669576755264, 7.536464442272491, 1064.681730881338, 1477.2145801683344, 1182.9935721291015, 693.5194530726916, 940.8784894463007, 1283.8278951947586, 1006.6348328556006, 1281.752578693475, 847.4155667675265, 642.3220428305707, 1123.7716650401132, 247.1197158999678, 458.29250596170044, 1331.182557773519, 1266.1328103165602, 989.4161343157481, 836.232501135062, 746.1818225468089, 602.0019990957311, 886.0601842733, 294.47075654242565, 1186.6928759296923, 1053.3326014572244, 320.0359493100292, 1069.6355716903588, 660.7963026192872, 1528.8724162180943, 779.3919943785345, 669.3394337900016, 842.6255330929417, 954.6995536875828, 1069.017178702215, 1047.2326697734518, 1213.3261100603045, 686.4896763856718, 927.7814185532358, 1088.7964678888927, 475.99369416245173, 893.1300652509681, 403.8608192708115, 508.46896497162334, 931.4401654949419, 217.1510303948854, 809.8299887667243, 584.3259771807552, 1136.9952595464035, 953.6410134627727, 473.5786927020053, 830.3023084516773, 581.6751011957195, 874.0624519072769, 220.6374107815994, 220.362166553541, 49.248567249215334, 481.0967432560313, 1078.6393040649064, 730.4608088075342, 1026.0843179687274, 475.5559537336914, 555.1073581046672, 1005.9653918379167, 1082.653964242743, 948.0556784970078, 1204.6982997767955, 960.4125927347148, 983.5664702583784, 918.7486525607844, 614.3771758247735, 789.3548409073771, 1100.8612063548746, 619.9689172706377, 1234.7883115936306, 846.9681667665445, 448.1614160035638, 638.2243339933044, 1186.8442570211346, 785.2851698690405, 764.9923565887505, 1040.3116545362952, 917.2044373939993, 1028.9265921222284, 643.3470054441749, 767.3874549007724, 1094.5652609245078, 740.0272650541131, 1299.5774638546106, 1197.143246253471, 587.131133770448, 510.97957385330244, 417.23568785885834, 1115.5078745913495, 1203.8209043232519, 381.394545016994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.010456566149472, "mean_inference_ms": 7.191661901499849, "mean_action_processing_ms": 2.5177990853433236, "mean_env_wait_ms": 17.01291381909424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016531944274902344, "StateBufferConnector_ms": 0.008915424346923828, "ViewRequirementAgentConnector_ms": 0.23769080638885498}, "num_episodes": 6, "episode_return_max": 921.6626964622534, "episode_return_min": -4.620968472245875, "episode_return_mean": 197.6450357609812, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 817632, "num_agent_steps_trained": 817632, "num_env_steps_sampled": 204408, "num_env_steps_trained": 204408, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 156.20818789067738, "num_env_steps_trained_throughput_per_sec": 156.20818789067738, "timesteps_total": 204408, "num_env_steps_sampled_lifetime": 204408, "num_agent_steps_sampled_lifetime": 817632, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 817632, "timers": {"training_iteration_time_ms": 26564.344, "restore_workers_time_ms": 0.029, "training_step_time_ms": 26563.863, "sample_time_ms": 3048.222, "learn_time_ms": 23487.457, "learn_throughput": 170.644, "synch_weights_time_ms": 23.355}, "counters": {"num_env_steps_sampled": 204408, "num_env_steps_trained": 204408, "num_agent_steps_sampled": 817632, "num_agent_steps_trained": 817632}, "done": false, "training_iteration": 51, "trial_id": "7f713_00000", "date": "2024-08-23_10-09-42", "timestamp": 1724387982, "time_this_iter_s": 25.69558024406433, "time_total_s": 1380.615160703659, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737a6790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1380.615160703659, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 35.95945945945946, "ram_util_percent": 81.57297297297296}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.1379101939933, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.703232673867039, "policy_loss": -0.010127980322897355, "vf_loss": 7.7118849406166685, "vf_explained_var": 0.6753757246587643, "kl": 0.007378589753899231, "entropy": 0.6335448170465137, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 48668.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.650004315250133, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 7.619981216753601, "policy_loss": -0.006778737269563689, "vf_loss": 7.626408000219436, "vf_explained_var": 0.29646324386041634, "kl": 0.007039067800964904, "entropy": 0.3604949148086013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 48668.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 208416, "num_env_steps_trained": 208416, "num_agent_steps_sampled": 833664, "num_agent_steps_trained": 833664}, "env_runners": {"episode_reward_max": 921.6626964622534, "episode_reward_min": -4.620968472245875, "episode_reward_mean": 191.48381253645425, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1655.4937746057963, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 359.41193070580744, "predator_policy": 1655.4937746057963}, "policy_reward_mean": {"prey_policy": -783.0004844839011, "predator_policy": 878.7423907521282}, "custom_metrics": {}, "hist_stats": {"episode_reward": [108.71538898248808, 132.02785030550274, 298.249932813459, 6.661338147750939e-15, 3.3000000000000025, -4.620968472245875, 67.80535835248924, 30.922188777211026, 172.4729098274312, 245.44009733494894, 155.06828745946112, 479.1140041346834, 537.2288343822395, 1.5000000000000013, 221.4283338438391, 0.5786039128317082, 416.6200240493257, 357.01611711291406, 765.8620038240576, 1.4682135629253845, 9.77355299625384, 317.5081241651277, 109.61676600607112, 378.31437619866125, 0.499999999999994, 86.69870452782637, 213.59958998194958, 764.375274879386, 326.6404549326614, 135.7880214917709, 170.12916889754527, -8.881784197001252e-16, -3.7014428372067227, 90.37612556873927, 3.5, 10.700000000000003, 469.774777200149, 236.67908486145464, -1.7319479184152442e-14, 115.77769991961598, 29.693889334569203, 7.100000000000016, 5.100000000000001, 334.9245591843899, 179.26630188720353, -0.06272935566335036, 433.67872116209196, 203.44491517503153, 2.207172096107822, 499.3697073692804, 661.1247056623847, -1.3766765505351941e-14, 285.93973592535946, 904.0068095932193, 346.1299487747443, 0.704805308043607, 448.5468150969202, -2.9947188813976062, 921.6626964622534, 90.36192066532652, 5.626419039907068, 166.39982702440824, 25.899999999999984, 30.80000000000006, 101.69219002123782, 69.80000000000018, 315.67051042059927, -0.09788983233979165, 375.20641338546403, 365.90559549440223, 411.5111890951681, 59.03322372606168, 54.20000000000004, 30.700000000000014, 56.88143591956542, 252.44599110398076, 1.5251579953050958, 38.74825673860411, 23.725420336662687, 19.41740177864405, -0.5893378023913964, 470.68349130375196, 16.199999999999953, 385.8213092823769, 2.099999999999995, 779.1879292271482, 103.40319521915576, 3.9736347688265345, 10.286905403813313, 151.71056205898486, 255.68955843102012, 27.544017224897967, 200.22743986951363, 628.3833419264582, 316.53753057084225, 254.3976427176724, 347.59126781355513, 0.3889089286925047, 3.400000000000003, 9.899999999999995], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1182.4902027459793, -491.92890124770724, -414.352923839947, -1407.659270564138, -958.8874592828355, -36.191854500758936, -1339.5344774083137, -1288.448793049668, -1127.8547190986085, -989.0364360725621, -1322.0636152367354, -1375.7070595136922, -1215.665087657283, -1338.1226615812022, -887.2282380564528, -782.7439126332168, -984.8463309245923, -1001.2893781024197, -1415.2056062492004, -204.72667069507452, -1190.2383570017496, -741.2719601851134, -1398.3897047751386, -219.67116607303885, -795.0216439616962, 4.250283951439502, -1008.6113253185033, -1338.2538199074725, -847.5711313797559, -473.4042989927596, -1199.322191843784, -1390.4049496325997, -334.6800372809654, -371.09299372379746, -1439.386273594749, -482.30494279014135, 40.855620435355405, -730.0354623368082, -1154.164497443126, -1466.970147083058, -1196.0067988143535, -1343.7802535833366, -478.69314931368797, -611.0105634439003, -1117.0826360678047, -579.4532021480247, 359.41193070580744, -985.8524891362164, -1159.410561404252, -1301.504687574272, -528.0919559222797, -44.2687153004847, -98.3656414261861, -765.1794390852821, -938.3010585487674, 283.307053619092, 19.367418726393186, -1178.2566574685181, -1012.5798526335831, -211.58566949959388, -824.8946890356113, -265.8032516283727, -1390.6487444090758, -1134.341848908161, -1465.6350195747295, -1384.0652573209481, -1565.8859319438013, 11.587328108938914, -1241.5093023278257, -1221.223902948603, -1655.4937746057963, -924.0818836857867, -1117.0038677401396, -643.5275276784266, -250.0234716276928, -669.1753528432874, -1168.6069338136808, -1616.0278886858657, -819.2013220461964, -1199.476994687043, -227.2555715971255, -844.0163842377652, -1197.8280380895712, -907.5067932720823, -1240.3819802857147, -885.2778338499234, -526.5364648985545, -1365.2349590472352, 94.76504846289771, -987.7169418993052, -1477.2145801683344, -1183.0563014847648, -834.3460444408959, -366.3731769160092, -1038.809091934502, -1048.2087209408257, -1267.6361404831775, -859.324832881715, 13.590917477325599, -1280.3149179787288, -363.63362189814893, 319.3461056988621, -1331.182557773519, -1266.1328103165602, -614.7602668979367, -924.948632627507, -795.6367273701144, 351.4597153207905, -931.31454656282, 96.91355452183751, -1249.216178186772, -990.1044938921, 214.88907341702202, -1156.0137793204972, -769.5752695023845, -1423.0881682163952, -822.9160399612996, 295.8473082550141, -757.2636124276146, -949.6995536875828, -1052.6622198246644, -1057.961209611095, -1217.0392447029383, -516.3767147186295, -901.8814185532349, -1088.7964678888927, -445.3936941624513, -892.9300652509681, 36.702726375569526, -847.340320596769, -916.9401654949393, -161.85103039488553, -968.3276929895604, -110.15776253732294, -1136.9952595464035, -953.7389032951124, -13.186747338408809, -915.4878404298131, -175.13553639723415, -914.6964212113593, -45.72950995310549, 16.241121713132344, 1.2416049433707066, -472.5536917225556, -1078.6393040649064, -676.2608088075334, -1002.4843179687274, -468.4559537336911, -566.2353135154947, -937.9560005075227, -847.1073461335965, -931.1563055021751, -1204.6982997767955, -958.8874347394094, -947.2182135197742, -916.3486525607844, -590.6217073955264, -789.3848889999588, -1099.7612063548745, -601.6515154919942, -995.1107707339378, -1087.2350454286232, -464.4696465124514, -151.23261218066585, -1185.244257021136, -770.6851698690383, -321.4416262431321, -1098.0410755995383, -915.1044373939989, -1028.9265921222284, -8.475470527248037, -623.0710605905507, -1096.146028271036, -635.0433024884297, -1298.0763123729787, -1194.6707629662762, -585.7917343687759, -502.03206785116043, -265.52512579987297, -1115.5078745913495, -1208.3307354560275, -121.19515545319831, -523.7301704680315, -1227.6634981547231, -975.3950459814926, -326.8896701806332, 246.3634087444001, -561.1245593337758, -626.792334386869, -376.18804158666427, 69.00673678258795, -1011.3793906048594, -252.0858365261478, -9.218751350934786, -1107.9674020641867, -794.9490526061752, -883.251541337408, -1113.913194505549, -1028.0481962225335, -829.8872874815869], "policy_predator_policy_reward": [1227.7862547936988, 555.3482381824772, 546.3807741454497, 1407.659270564138, 977.1472962831056, 316.18195031394794, 1339.5344774083137, 1288.448793049668, 1127.8547190986085, 992.3364360725622, 1317.2901240967888, 1375.8595821813904, 1215.3105952454725, 1406.2825123455013, 986.9976254545774, 713.8967140123037, 1135.181976761688, 1023.4266420927496, 1014.0626783646735, 851.3096959145521, 1228.9398993637863, 857.638705282539, 1253.9381421237943, 843.2367328590725, 563.8953647666319, 764.1048296258616, 1010.1113253185036, 1338.2538199074725, 687.4303050097639, 854.9734592065912, 1199.9007957566157, 1390.4049496325997, 317.9316195095759, 804.4614355445141, 1264.9718460584488, 1013.7354874393609, 821.232961476185, 633.8088842493262, 1155.6327110060513, 1466.970147083058, 1206.029393518979, 1343.5312118749641, 796.7779327217963, 610.4339042009194, 842.9211025444065, 963.2315016774976, 11.274862555359297, 993.4800720737112, 1159.410561404252, 1302.004687574272, 64.07602895059469, 594.9833467999982, 303.5062613611553, 773.6384091322625, 762.3727095528748, 656.9965702561838, 345.7204945593554, 1139.8091991154286, 1028.4571433408044, 331.49640028414206, 482.25905952284893, 778.5680500386788, 1390.6487444090758, 1134.341848908161, 1468.04435072012, 1377.95448333835, 1565.8859319438013, 78.78879745980048, 1242.5093023278257, 1223.7239029486032, 1655.4937746057963, 934.7818836857869, 1041.5832341776133, 1188.722938441103, 0.0, 1155.877909332437, 1168.6069338136808, 1616.0278886858657, 961.9110258570972, 1172.5449907957575, 250.34946093169359, 850.6163842377653, 1204.2280380895709, 908.2067932720825, 1243.0819802857147, 887.6778338499232, 979.729025454658, 1246.9669576755264, 7.536464442272491, 1064.681730881338, 1477.2145801683344, 1182.9935721291015, 693.5194530726916, 940.8784894463007, 1283.8278951947586, 1006.6348328556006, 1281.752578693475, 847.4155667675265, 642.3220428305707, 1123.7716650401132, 247.1197158999678, 458.29250596170044, 1331.182557773519, 1266.1328103165602, 989.4161343157481, 836.232501135062, 746.1818225468089, 602.0019990957311, 886.0601842733, 294.47075654242565, 1186.6928759296923, 1053.3326014572244, 320.0359493100292, 1069.6355716903588, 660.7963026192872, 1528.8724162180943, 779.3919943785345, 669.3394337900016, 842.6255330929417, 954.6995536875828, 1069.017178702215, 1047.2326697734518, 1213.3261100603045, 686.4896763856718, 927.7814185532358, 1088.7964678888927, 475.99369416245173, 893.1300652509681, 403.8608192708115, 508.46896497162334, 931.4401654949419, 217.1510303948854, 809.8299887667243, 584.3259771807552, 1136.9952595464035, 953.6410134627727, 473.5786927020053, 830.3023084516773, 581.6751011957195, 874.0624519072769, 220.6374107815994, 220.362166553541, 49.248567249215334, 481.0967432560313, 1078.6393040649064, 730.4608088075342, 1026.0843179687274, 475.5559537336914, 555.1073581046672, 1005.9653918379167, 1082.653964242743, 948.0556784970078, 1204.6982997767955, 960.4125927347148, 983.5664702583784, 918.7486525607844, 614.3771758247735, 789.3548409073771, 1100.8612063548746, 619.9689172706377, 1234.7883115936306, 846.9681667665445, 448.1614160035638, 638.2243339933044, 1186.8442570211346, 785.2851698690405, 764.9923565887505, 1040.3116545362952, 917.2044373939993, 1028.9265921222284, 643.3470054441749, 767.3874549007724, 1094.5652609245078, 740.0272650541131, 1299.5774638546106, 1197.143246253471, 587.131133770448, 510.97957385330244, 417.23568785885834, 1115.5078745913495, 1203.8209043232519, 381.394545016994, 1212.3661616316451, 566.5715242160076, 975.3423020333214, 527.1698539983179, 503.71203092159135, 439.432461594242, 601.4157172055228, 718.102189338857, 189.47090422612646, 1007.2993923138182, 248.34783911388962, 360.54801657674597, 1108.7674020641864, 794.5379615348677, 886.6515413374078, 1113.913194505549, 1028.0481962225335, 839.7872874815878]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.009842288085856, "mean_inference_ms": 7.210692290236758, "mean_action_processing_ms": 2.503621952761347, "mean_env_wait_ms": 17.03445454159242, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021168112754821777, "StateBufferConnector_ms": 0.008948326110839844, "ViewRequirementAgentConnector_ms": 0.2503770589828491}, "num_episodes": 9, "episode_return_max": 921.6626964622534, "episode_return_min": -4.620968472245875, "episode_return_mean": 191.48381253645425, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 833664, "num_agent_steps_trained": 833664, "num_env_steps_sampled": 208416, "num_env_steps_trained": 208416, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 140.3686673116872, "num_env_steps_trained_throughput_per_sec": 140.3686673116872, "timesteps_total": 208416, "num_env_steps_sampled_lifetime": 208416, "num_agent_steps_sampled_lifetime": 833664, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 833664, "timers": {"training_iteration_time_ms": 26822.667, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26822.202, "sample_time_ms": 3313.542, "learn_time_ms": 23481.172, "learn_throughput": 170.69, "synch_weights_time_ms": 22.557}, "counters": {"num_env_steps_sampled": 208416, "num_env_steps_trained": 208416, "num_agent_steps_sampled": 833664, "num_agent_steps_trained": 833664}, "done": false, "training_iteration": 52, "trial_id": "7f713_00000", "date": "2024-08-23_10-10-11", "timestamp": 1724388011, "time_this_iter_s": 28.616790056228638, "time_total_s": 1409.2319507598877, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x30f7b48b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1409.2319507598877, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 41.88, "ram_util_percent": 83.20750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.32191767061829, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.834472027531376, "policy_loss": -0.01181313234859358, "vf_loss": 7.844701359259388, "vf_explained_var": 0.6058079952285403, "kl": 0.007919068917848918, "entropy": 0.6154921913903857, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 49613.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.370512810207547, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 7.606801247470593, "policy_loss": -0.00697677048771992, "vf_loss": 7.613362290619542, "vf_explained_var": 0.3216242511436422, "kl": 0.00831419902917727, "entropy": 0.35927072366078694, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 49613.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 212424, "num_env_steps_trained": 212424, "num_agent_steps_sampled": 849696, "num_agent_steps_trained": 849696}, "env_runners": {"episode_reward_max": 921.6626964622534, "episode_reward_min": -3.7014428372067227, "episode_reward_mean": 195.3569851295988, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1655.4937746057963, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 359.41193070580744, "predator_policy": 1655.4937746057963}, "policy_reward_mean": {"prey_policy": -753.1688018769402, "predator_policy": 850.8472944417395}, "custom_metrics": {}, "hist_stats": {"episode_reward": [479.1140041346834, 537.2288343822395, 1.5000000000000013, 221.4283338438391, 0.5786039128317082, 416.6200240493257, 357.01611711291406, 765.8620038240576, 1.4682135629253845, 9.77355299625384, 317.5081241651277, 109.61676600607112, 378.31437619866125, 0.499999999999994, 86.69870452782637, 213.59958998194958, 764.375274879386, 326.6404549326614, 135.7880214917709, 170.12916889754527, -8.881784197001252e-16, -3.7014428372067227, 90.37612556873927, 3.5, 10.700000000000003, 469.774777200149, 236.67908486145464, -1.7319479184152442e-14, 115.77769991961598, 29.693889334569203, 7.100000000000016, 5.100000000000001, 334.9245591843899, 179.26630188720353, -0.06272935566335036, 433.67872116209196, 203.44491517503153, 2.207172096107822, 499.3697073692804, 661.1247056623847, -1.3766765505351941e-14, 285.93973592535946, 904.0068095932193, 346.1299487747443, 0.704805308043607, 448.5468150969202, -2.9947188813976062, 921.6626964622534, 90.36192066532652, 5.626419039907068, 166.39982702440824, 25.899999999999984, 30.80000000000006, 101.69219002123782, 69.80000000000018, 315.67051042059927, -0.09788983233979165, 375.20641338546403, 365.90559549440223, 411.5111890951681, 59.03322372606168, 54.20000000000004, 30.700000000000014, 56.88143591956542, 252.44599110398076, 1.5251579953050958, 38.74825673860411, 23.725420336662687, 19.41740177864405, -0.5893378023913964, 470.68349130375196, 16.199999999999953, 385.8213092823769, 2.099999999999995, 779.1879292271482, 103.40319521915576, 3.9736347688265345, 10.286905403813313, 151.71056205898486, 255.68955843102012, 27.544017224897967, 200.22743986951363, 628.3833419264582, 316.53753057084225, 254.3976427176724, 347.59126781355513, 0.3889089286925047, 3.400000000000003, 9.899999999999995, 2.388108441871444, 112.15143811056294, 162.44183777725817, 43.23975292066437, 4.440892098500626e-15, 176.76704814877058, 167.7, 447.46175619601433, 25.600000000000026, 134.40930056033258, 324.53906253973093], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1398.3897047751386, -219.67116607303885, -795.0216439616962, 4.250283951439502, -1008.6113253185033, -1338.2538199074725, -847.5711313797559, -473.4042989927596, -1199.322191843784, -1390.4049496325997, -334.6800372809654, -371.09299372379746, -1439.386273594749, -482.30494279014135, 40.855620435355405, -730.0354623368082, -1154.164497443126, -1466.970147083058, -1196.0067988143535, -1343.7802535833366, -478.69314931368797, -611.0105634439003, -1117.0826360678047, -579.4532021480247, 359.41193070580744, -985.8524891362164, -1159.410561404252, -1301.504687574272, -528.0919559222797, -44.2687153004847, -98.3656414261861, -765.1794390852821, -938.3010585487674, 283.307053619092, 19.367418726393186, -1178.2566574685181, -1012.5798526335831, -211.58566949959388, -824.8946890356113, -265.8032516283727, -1390.6487444090758, -1134.341848908161, -1465.6350195747295, -1384.0652573209481, -1565.8859319438013, 11.587328108938914, -1241.5093023278257, -1221.223902948603, -1655.4937746057963, -924.0818836857867, -1117.0038677401396, -643.5275276784266, -250.0234716276928, -669.1753528432874, -1168.6069338136808, -1616.0278886858657, -819.2013220461964, -1199.476994687043, -227.2555715971255, -844.0163842377652, -1197.8280380895712, -907.5067932720823, -1240.3819802857147, -885.2778338499234, -526.5364648985545, -1365.2349590472352, 94.76504846289771, -987.7169418993052, -1477.2145801683344, -1183.0563014847648, -834.3460444408959, -366.3731769160092, -1038.809091934502, -1048.2087209408257, -1267.6361404831775, -859.324832881715, 13.590917477325599, -1280.3149179787288, -363.63362189814893, 319.3461056988621, -1331.182557773519, -1266.1328103165602, -614.7602668979367, -924.948632627507, -795.6367273701144, 351.4597153207905, -931.31454656282, 96.91355452183751, -1249.216178186772, -990.1044938921, 214.88907341702202, -1156.0137793204972, -769.5752695023845, -1423.0881682163952, -822.9160399612996, 295.8473082550141, -757.2636124276146, -949.6995536875828, -1052.6622198246644, -1057.961209611095, -1217.0392447029383, -516.3767147186295, -901.8814185532349, -1088.7964678888927, -445.3936941624513, -892.9300652509681, 36.702726375569526, -847.340320596769, -916.9401654949393, -161.85103039488553, -968.3276929895604, -110.15776253732294, -1136.9952595464035, -953.7389032951124, -13.186747338408809, -915.4878404298131, -175.13553639723415, -914.6964212113593, -45.72950995310549, 16.241121713132344, 1.2416049433707066, -472.5536917225556, -1078.6393040649064, -676.2608088075334, -1002.4843179687274, -468.4559537336911, -566.2353135154947, -937.9560005075227, -847.1073461335965, -931.1563055021751, -1204.6982997767955, -958.8874347394094, -947.2182135197742, -916.3486525607844, -590.6217073955264, -789.3848889999588, -1099.7612063548745, -601.6515154919942, -995.1107707339378, -1087.2350454286232, -464.4696465124514, -151.23261218066585, -1185.244257021136, -770.6851698690383, -321.4416262431321, -1098.0410755995383, -915.1044373939989, -1028.9265921222284, -8.475470527248037, -623.0710605905507, -1096.146028271036, -635.0433024884297, -1298.0763123729787, -1194.6707629662762, -585.7917343687759, -502.03206785116043, -265.52512579987297, -1115.5078745913495, -1208.3307354560275, -121.19515545319831, -523.7301704680315, -1227.6634981547231, -975.3950459814926, -326.8896701806332, 246.3634087444001, -561.1245593337758, -626.792334386869, -376.18804158666427, 69.00673678258795, -1011.3793906048594, -252.0858365261478, -9.218751350934786, -1107.9674020641867, -794.9490526061752, -883.251541337408, -1113.913194505549, -1028.0481962225335, -829.8872874815869, -693.4323678476638, -1176.5951186068169, -562.2416870531046, -949.4642433253206, -832.4602057607952, -1227.4420222540862, -680.1287504920831, -591.0253591670355, -993.7049218979464, -997.9567830449963, -451.7109021741902, -1025.1486978249682, -998.5636721546159, -338.81199291970427, -24.02539714333277, -661.9933121780227, -537.0613500874421, -971.11769554801, -767.303592199968, -286.076037654005, -160.12015013297696, -802.7731347879786], "policy_predator_policy_reward": [1253.9381421237943, 843.2367328590725, 563.8953647666319, 764.1048296258616, 1010.1113253185036, 1338.2538199074725, 687.4303050097639, 854.9734592065912, 1199.9007957566157, 1390.4049496325997, 317.9316195095759, 804.4614355445141, 1264.9718460584488, 1013.7354874393609, 821.232961476185, 633.8088842493262, 1155.6327110060513, 1466.970147083058, 1206.029393518979, 1343.5312118749641, 796.7779327217963, 610.4339042009194, 842.9211025444065, 963.2315016774976, 11.274862555359297, 993.4800720737112, 1159.410561404252, 1302.004687574272, 64.07602895059469, 594.9833467999982, 303.5062613611553, 773.6384091322625, 762.3727095528748, 656.9965702561838, 345.7204945593554, 1139.8091991154286, 1028.4571433408044, 331.49640028414206, 482.25905952284893, 778.5680500386788, 1390.6487444090758, 1134.341848908161, 1468.04435072012, 1377.95448333835, 1565.8859319438013, 78.78879745980048, 1242.5093023278257, 1223.7239029486032, 1655.4937746057963, 934.7818836857869, 1041.5832341776133, 1188.722938441103, 0.0, 1155.877909332437, 1168.6069338136808, 1616.0278886858657, 961.9110258570972, 1172.5449907957575, 250.34946093169359, 850.6163842377653, 1204.2280380895709, 908.2067932720825, 1243.0819802857147, 887.6778338499232, 979.729025454658, 1246.9669576755264, 7.536464442272491, 1064.681730881338, 1477.2145801683344, 1182.9935721291015, 693.5194530726916, 940.8784894463007, 1283.8278951947586, 1006.6348328556006, 1281.752578693475, 847.4155667675265, 642.3220428305707, 1123.7716650401132, 247.1197158999678, 458.29250596170044, 1331.182557773519, 1266.1328103165602, 989.4161343157481, 836.232501135062, 746.1818225468089, 602.0019990957311, 886.0601842733, 294.47075654242565, 1186.6928759296923, 1053.3326014572244, 320.0359493100292, 1069.6355716903588, 660.7963026192872, 1528.8724162180943, 779.3919943785345, 669.3394337900016, 842.6255330929417, 954.6995536875828, 1069.017178702215, 1047.2326697734518, 1213.3261100603045, 686.4896763856718, 927.7814185532358, 1088.7964678888927, 475.99369416245173, 893.1300652509681, 403.8608192708115, 508.46896497162334, 931.4401654949419, 217.1510303948854, 809.8299887667243, 584.3259771807552, 1136.9952595464035, 953.6410134627727, 473.5786927020053, 830.3023084516773, 581.6751011957195, 874.0624519072769, 220.6374107815994, 220.362166553541, 49.248567249215334, 481.0967432560313, 1078.6393040649064, 730.4608088075342, 1026.0843179687274, 475.5559537336914, 555.1073581046672, 1005.9653918379167, 1082.653964242743, 948.0556784970078, 1204.6982997767955, 960.4125927347148, 983.5664702583784, 918.7486525607844, 614.3771758247735, 789.3548409073771, 1100.8612063548746, 619.9689172706377, 1234.7883115936306, 846.9681667665445, 448.1614160035638, 638.2243339933044, 1186.8442570211346, 785.2851698690405, 764.9923565887505, 1040.3116545362952, 917.2044373939993, 1028.9265921222284, 643.3470054441749, 767.3874549007724, 1094.5652609245078, 740.0272650541131, 1299.5774638546106, 1197.143246253471, 587.131133770448, 510.97957385330244, 417.23568785885834, 1115.5078745913495, 1203.8209043232519, 381.394545016994, 1212.3661616316451, 566.5715242160076, 975.3423020333214, 527.1698539983179, 503.71203092159135, 439.432461594242, 601.4157172055228, 718.102189338857, 189.47090422612646, 1007.2993923138182, 248.34783911388962, 360.54801657674597, 1108.7674020641864, 794.5379615348677, 886.6515413374078, 1113.913194505549, 1028.0481962225335, 839.7872874815878, 695.8204762895352, 1176.5951186068169, 689.2991312320355, 934.5582372569538, 999.2897240245383, 1223.0543417676029, 725.268889559266, 589.1249730205166, 993.7049218979464, 997.9567830449963, 631.2633164991483, 1022.3633316487832, 998.5636721546159, 506.51199291970465, 425.58493913539326, 707.8955263819759, 538.6613500874423, 995.1176955480107, 828.1852721477069, 359.6036582666028, 771.3796162908918, 516.052731169797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.026493306583536, "mean_inference_ms": 7.194753897791548, "mean_action_processing_ms": 2.5300287740528966, "mean_env_wait_ms": 17.052440090702806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020814061164855957, "StateBufferConnector_ms": 0.00891423225402832, "ViewRequirementAgentConnector_ms": 0.20291399955749512}, "num_episodes": 11, "episode_return_max": 921.6626964622534, "episode_return_min": -3.7014428372067227, "episode_return_mean": 195.3569851295988, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 849696, "num_agent_steps_trained": 849696, "num_env_steps_sampled": 212424, "num_env_steps_trained": 212424, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 149.32714444360283, "num_env_steps_trained_throughput_per_sec": 149.32714444360283, "timesteps_total": 212424, "num_env_steps_sampled_lifetime": 212424, "num_agent_steps_sampled_lifetime": 849696, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 849696, "timers": {"training_iteration_time_ms": 26811.782, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26811.29, "sample_time_ms": 3295.695, "learn_time_ms": 23489.828, "learn_throughput": 170.627, "synch_weights_time_ms": 20.658}, "counters": {"num_env_steps_sampled": 212424, "num_env_steps_trained": 212424, "num_agent_steps_sampled": 849696, "num_agent_steps_trained": 849696}, "done": false, "training_iteration": 53, "trial_id": "7f713_00000", "date": "2024-08-23_10-10-38", "timestamp": 1724388038, "time_this_iter_s": 26.89571499824524, "time_total_s": 1436.127665758133, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x173859a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1436.127665758133, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 37.73157894736842, "ram_util_percent": 82.54473684210528}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.107461140395472, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.722271587230541, "policy_loss": -0.009136242105098313, "vf_loss": 7.729688601519065, "vf_explained_var": 0.5355427490340339, "kl": 0.008596058471729515, "entropy": 0.6322669137091864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 50558.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.676540676752726, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 7.597478149555347, "policy_loss": -0.005611791449879843, "vf_loss": 7.602725340828063, "vf_explained_var": 0.2593564924739656, "kl": 0.0072922510885825706, "entropy": 0.3810044256467668, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 50558.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 216432, "num_env_steps_trained": 216432, "num_agent_steps_sampled": 865728, "num_agent_steps_trained": 865728}, "env_runners": {"episode_reward_max": 921.6626964622534, "episode_reward_min": -3.7014428372067227, "episode_reward_mean": 184.386122390507, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1655.4937746057963, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 359.41193070580744, "predator_policy": 1655.4937746057963}, "policy_reward_mean": {"prey_policy": -737.6558991058552, "predator_policy": 829.8489603011087}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1.4682135629253845, 9.77355299625384, 317.5081241651277, 109.61676600607112, 378.31437619866125, 0.499999999999994, 86.69870452782637, 213.59958998194958, 764.375274879386, 326.6404549326614, 135.7880214917709, 170.12916889754527, -8.881784197001252e-16, -3.7014428372067227, 90.37612556873927, 3.5, 10.700000000000003, 469.774777200149, 236.67908486145464, -1.7319479184152442e-14, 115.77769991961598, 29.693889334569203, 7.100000000000016, 5.100000000000001, 334.9245591843899, 179.26630188720353, -0.06272935566335036, 433.67872116209196, 203.44491517503153, 2.207172096107822, 499.3697073692804, 661.1247056623847, -1.3766765505351941e-14, 285.93973592535946, 904.0068095932193, 346.1299487747443, 0.704805308043607, 448.5468150969202, -2.9947188813976062, 921.6626964622534, 90.36192066532652, 5.626419039907068, 166.39982702440824, 25.899999999999984, 30.80000000000006, 101.69219002123782, 69.80000000000018, 315.67051042059927, -0.09788983233979165, 375.20641338546403, 365.90559549440223, 411.5111890951681, 59.03322372606168, 54.20000000000004, 30.700000000000014, 56.88143591956542, 252.44599110398076, 1.5251579953050958, 38.74825673860411, 23.725420336662687, 19.41740177864405, -0.5893378023913964, 470.68349130375196, 16.199999999999953, 385.8213092823769, 2.099999999999995, 779.1879292271482, 103.40319521915576, 3.9736347688265345, 10.286905403813313, 151.71056205898486, 255.68955843102012, 27.544017224897967, 200.22743986951363, 628.3833419264582, 316.53753057084225, 254.3976427176724, 347.59126781355513, 0.3889089286925047, 3.400000000000003, 9.899999999999995, 2.388108441871444, 112.15143811056294, 162.44183777725817, 43.23975292066437, 4.440892098500626e-15, 176.76704814877058, 167.7, 447.46175619601433, 25.600000000000026, 134.40930056033258, 324.53906253973093, 0.7000000000000006, 79.19999999999978, 182.26002028721953, 73.06448014824544, 343.4372893839803, 14.267258479271153, 463.00745871476636, 526.3251403372304], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1154.164497443126, -1466.970147083058, -1196.0067988143535, -1343.7802535833366, -478.69314931368797, -611.0105634439003, -1117.0826360678047, -579.4532021480247, 359.41193070580744, -985.8524891362164, -1159.410561404252, -1301.504687574272, -528.0919559222797, -44.2687153004847, -98.3656414261861, -765.1794390852821, -938.3010585487674, 283.307053619092, 19.367418726393186, -1178.2566574685181, -1012.5798526335831, -211.58566949959388, -824.8946890356113, -265.8032516283727, -1390.6487444090758, -1134.341848908161, -1465.6350195747295, -1384.0652573209481, -1565.8859319438013, 11.587328108938914, -1241.5093023278257, -1221.223902948603, -1655.4937746057963, -924.0818836857867, -1117.0038677401396, -643.5275276784266, -250.0234716276928, -669.1753528432874, -1168.6069338136808, -1616.0278886858657, -819.2013220461964, -1199.476994687043, -227.2555715971255, -844.0163842377652, -1197.8280380895712, -907.5067932720823, -1240.3819802857147, -885.2778338499234, -526.5364648985545, -1365.2349590472352, 94.76504846289771, -987.7169418993052, -1477.2145801683344, -1183.0563014847648, -834.3460444408959, -366.3731769160092, -1038.809091934502, -1048.2087209408257, -1267.6361404831775, -859.324832881715, 13.590917477325599, -1280.3149179787288, -363.63362189814893, 319.3461056988621, -1331.182557773519, -1266.1328103165602, -614.7602668979367, -924.948632627507, -795.6367273701144, 351.4597153207905, -931.31454656282, 96.91355452183751, -1249.216178186772, -990.1044938921, 214.88907341702202, -1156.0137793204972, -769.5752695023845, -1423.0881682163952, -822.9160399612996, 295.8473082550141, -757.2636124276146, -949.6995536875828, -1052.6622198246644, -1057.961209611095, -1217.0392447029383, -516.3767147186295, -901.8814185532349, -1088.7964678888927, -445.3936941624513, -892.9300652509681, 36.702726375569526, -847.340320596769, -916.9401654949393, -161.85103039488553, -968.3276929895604, -110.15776253732294, -1136.9952595464035, -953.7389032951124, -13.186747338408809, -915.4878404298131, -175.13553639723415, -914.6964212113593, -45.72950995310549, 16.241121713132344, 1.2416049433707066, -472.5536917225556, -1078.6393040649064, -676.2608088075334, -1002.4843179687274, -468.4559537336911, -566.2353135154947, -937.9560005075227, -847.1073461335965, -931.1563055021751, -1204.6982997767955, -958.8874347394094, -947.2182135197742, -916.3486525607844, -590.6217073955264, -789.3848889999588, -1099.7612063548745, -601.6515154919942, -995.1107707339378, -1087.2350454286232, -464.4696465124514, -151.23261218066585, -1185.244257021136, -770.6851698690383, -321.4416262431321, -1098.0410755995383, -915.1044373939989, -1028.9265921222284, -8.475470527248037, -623.0710605905507, -1096.146028271036, -635.0433024884297, -1298.0763123729787, -1194.6707629662762, -585.7917343687759, -502.03206785116043, -265.52512579987297, -1115.5078745913495, -1208.3307354560275, -121.19515545319831, -523.7301704680315, -1227.6634981547231, -975.3950459814926, -326.8896701806332, 246.3634087444001, -561.1245593337758, -626.792334386869, -376.18804158666427, 69.00673678258795, -1011.3793906048594, -252.0858365261478, -9.218751350934786, -1107.9674020641867, -794.9490526061752, -883.251541337408, -1113.913194505549, -1028.0481962225335, -829.8872874815869, -693.4323678476638, -1176.5951186068169, -562.2416870531046, -949.4642433253206, -832.4602057607952, -1227.4420222540862, -680.1287504920831, -591.0253591670355, -993.7049218979464, -997.9567830449963, -451.7109021741902, -1025.1486978249682, -998.5636721546159, -338.81199291970427, -24.02539714333277, -661.9933121780227, -537.0613500874421, -971.11769554801, -767.303592199968, -286.076037654005, -160.12015013297696, -802.7731347879786, -1019.209258442265, -636.2295687869242, 39.09539434917427, 31.49800621183561, -1158.4701698177562, -496.87304504719043, -796.9782882616125, -611.2159872353476, -218.5119364680953, -685.9350227382263, -648.3834784567421, -593.7241172563977, 181.82436800307386, -879.1190119837684, -894.265756480664, -493.9656105965258], "policy_predator_policy_reward": [1155.6327110060513, 1466.970147083058, 1206.029393518979, 1343.5312118749641, 796.7779327217963, 610.4339042009194, 842.9211025444065, 963.2315016774976, 11.274862555359297, 993.4800720737112, 1159.410561404252, 1302.004687574272, 64.07602895059469, 594.9833467999982, 303.5062613611553, 773.6384091322625, 762.3727095528748, 656.9965702561838, 345.7204945593554, 1139.8091991154286, 1028.4571433408044, 331.49640028414206, 482.25905952284893, 778.5680500386788, 1390.6487444090758, 1134.341848908161, 1468.04435072012, 1377.95448333835, 1565.8859319438013, 78.78879745980048, 1242.5093023278257, 1223.7239029486032, 1655.4937746057963, 934.7818836857869, 1041.5832341776133, 1188.722938441103, 0.0, 1155.877909332437, 1168.6069338136808, 1616.0278886858657, 961.9110258570972, 1172.5449907957575, 250.34946093169359, 850.6163842377653, 1204.2280380895709, 908.2067932720825, 1243.0819802857147, 887.6778338499232, 979.729025454658, 1246.9669576755264, 7.536464442272491, 1064.681730881338, 1477.2145801683344, 1182.9935721291015, 693.5194530726916, 940.8784894463007, 1283.8278951947586, 1006.6348328556006, 1281.752578693475, 847.4155667675265, 642.3220428305707, 1123.7716650401132, 247.1197158999678, 458.29250596170044, 1331.182557773519, 1266.1328103165602, 989.4161343157481, 836.232501135062, 746.1818225468089, 602.0019990957311, 886.0601842733, 294.47075654242565, 1186.6928759296923, 1053.3326014572244, 320.0359493100292, 1069.6355716903588, 660.7963026192872, 1528.8724162180943, 779.3919943785345, 669.3394337900016, 842.6255330929417, 954.6995536875828, 1069.017178702215, 1047.2326697734518, 1213.3261100603045, 686.4896763856718, 927.7814185532358, 1088.7964678888927, 475.99369416245173, 893.1300652509681, 403.8608192708115, 508.46896497162334, 931.4401654949419, 217.1510303948854, 809.8299887667243, 584.3259771807552, 1136.9952595464035, 953.6410134627727, 473.5786927020053, 830.3023084516773, 581.6751011957195, 874.0624519072769, 220.6374107815994, 220.362166553541, 49.248567249215334, 481.0967432560313, 1078.6393040649064, 730.4608088075342, 1026.0843179687274, 475.5559537336914, 555.1073581046672, 1005.9653918379167, 1082.653964242743, 948.0556784970078, 1204.6982997767955, 960.4125927347148, 983.5664702583784, 918.7486525607844, 614.3771758247735, 789.3548409073771, 1100.8612063548746, 619.9689172706377, 1234.7883115936306, 846.9681667665445, 448.1614160035638, 638.2243339933044, 1186.8442570211346, 785.2851698690405, 764.9923565887505, 1040.3116545362952, 917.2044373939993, 1028.9265921222284, 643.3470054441749, 767.3874549007724, 1094.5652609245078, 740.0272650541131, 1299.5774638546106, 1197.143246253471, 587.131133770448, 510.97957385330244, 417.23568785885834, 1115.5078745913495, 1203.8209043232519, 381.394545016994, 1212.3661616316451, 566.5715242160076, 975.3423020333214, 527.1698539983179, 503.71203092159135, 439.432461594242, 601.4157172055228, 718.102189338857, 189.47090422612646, 1007.2993923138182, 248.34783911388962, 360.54801657674597, 1108.7674020641864, 794.5379615348677, 886.6515413374078, 1113.913194505549, 1028.0481962225335, 839.7872874815878, 695.8204762895352, 1176.5951186068169, 689.2991312320355, 934.5582372569538, 999.2897240245383, 1223.0543417676029, 725.268889559266, 589.1249730205166, 993.7049218979464, 997.9567830449963, 631.2633164991483, 1022.3633316487832, 998.5636721546159, 506.51199291970465, 425.58493913539326, 707.8955263819759, 538.6613500874423, 995.1176955480107, 828.1852721477069, 359.6036582666028, 771.3796162908918, 516.052731169797, 1019.209258442265, 636.9295687869245, 0.8046056508260161, 7.80199378816456, 1158.3276894325252, 679.2755457196427, 883.7143327493363, 597.5444228958753, 742.0616303044861, 505.82261828581755, 646.6087086694611, 609.7661455229497, 693.7407901085608, 466.56131258690044, 815.2474751046897, 1099.3090323097376]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.99905016740548, "mean_inference_ms": 7.190962228462517, "mean_action_processing_ms": 2.5047515992903833, "mean_env_wait_ms": 17.050677945799535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01578652858734131, "StateBufferConnector_ms": 0.008438587188720703, "ViewRequirementAgentConnector_ms": 0.19610464572906494}, "num_episodes": 8, "episode_return_max": 921.6626964622534, "episode_return_min": -3.7014428372067227, "episode_return_mean": 184.386122390507, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 865728, "num_agent_steps_trained": 865728, "num_env_steps_sampled": 216432, "num_env_steps_trained": 216432, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 155.925477530267, "num_env_steps_trained_throughput_per_sec": 155.925477530267, "timesteps_total": 216432, "num_env_steps_sampled_lifetime": 216432, "num_agent_steps_sampled_lifetime": 865728, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 865728, "timers": {"training_iteration_time_ms": 26720.099, "restore_workers_time_ms": 0.028, "training_step_time_ms": 26719.61, "sample_time_ms": 3214.995, "learn_time_ms": 23479.382, "learn_throughput": 170.703, "synch_weights_time_ms": 20.279}, "counters": {"num_env_steps_sampled": 216432, "num_env_steps_trained": 216432, "num_agent_steps_sampled": 865728, "num_agent_steps_trained": 865728}, "done": false, "training_iteration": 54, "trial_id": "7f713_00000", "date": "2024-08-23_10-11-03", "timestamp": 1724388063, "time_this_iter_s": 25.758908987045288, "time_total_s": 1461.8865747451782, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17380c550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1461.8865747451782, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 35.25555555555556, "ram_util_percent": 82.40833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.40032581753201, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.437691681473344, "policy_loss": -0.009587348033501595, "vf_loss": 7.445909316956051, "vf_explained_var": 0.6408103947286252, "kl": 0.006848674662972963, "entropy": 0.6284171710569392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 51503.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.481426892961775, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 7.415959443995561, "policy_loss": -0.007258842731752093, "vf_loss": 7.422889962272039, "vf_explained_var": 0.26436676367250067, "kl": 0.006566518854359707, "entropy": 0.37846243841938243, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 51503.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 220440, "num_env_steps_trained": 220440, "num_agent_steps_sampled": 881760, "num_agent_steps_trained": 881760}, "env_runners": {"episode_reward_max": 921.6626964622534, "episode_reward_min": -3.7014428372067227, "episode_reward_mean": 182.529695476948, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1655.4937746057963, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 351.4597153207905, "predator_policy": 1655.4937746057963}, "policy_reward_mean": {"prey_policy": -734.683435232375, "predator_policy": 825.9482829708493}, "custom_metrics": {}, "hist_stats": {"episode_reward": [135.7880214917709, 170.12916889754527, -8.881784197001252e-16, -3.7014428372067227, 90.37612556873927, 3.5, 10.700000000000003, 469.774777200149, 236.67908486145464, -1.7319479184152442e-14, 115.77769991961598, 29.693889334569203, 7.100000000000016, 5.100000000000001, 334.9245591843899, 179.26630188720353, -0.06272935566335036, 433.67872116209196, 203.44491517503153, 2.207172096107822, 499.3697073692804, 661.1247056623847, -1.3766765505351941e-14, 285.93973592535946, 904.0068095932193, 346.1299487747443, 0.704805308043607, 448.5468150969202, -2.9947188813976062, 921.6626964622534, 90.36192066532652, 5.626419039907068, 166.39982702440824, 25.899999999999984, 30.80000000000006, 101.69219002123782, 69.80000000000018, 315.67051042059927, -0.09788983233979165, 375.20641338546403, 365.90559549440223, 411.5111890951681, 59.03322372606168, 54.20000000000004, 30.700000000000014, 56.88143591956542, 252.44599110398076, 1.5251579953050958, 38.74825673860411, 23.725420336662687, 19.41740177864405, -0.5893378023913964, 470.68349130375196, 16.199999999999953, 385.8213092823769, 2.099999999999995, 779.1879292271482, 103.40319521915576, 3.9736347688265345, 10.286905403813313, 151.71056205898486, 255.68955843102012, 27.544017224897967, 200.22743986951363, 628.3833419264582, 316.53753057084225, 254.3976427176724, 347.59126781355513, 0.3889089286925047, 3.400000000000003, 9.899999999999995, 2.388108441871444, 112.15143811056294, 162.44183777725817, 43.23975292066437, 4.440892098500626e-15, 176.76704814877058, 167.7, 447.46175619601433, 25.600000000000026, 134.40930056033258, 324.53906253973093, 0.7000000000000006, 79.19999999999978, 182.26002028721953, 73.06448014824544, 343.4372893839803, 14.267258479271153, 463.00745871476636, 526.3251403372304, 80.9385960157337, 130.29088803718906, 16.738034375544974, 11.921998274377515, 7.6999999999999975, 288.1796284191438, 6.335375562571603, 631.6450126544537, 718.5732024336153, 130.52963012232647], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1012.5798526335831, -211.58566949959388, -824.8946890356113, -265.8032516283727, -1390.6487444090758, -1134.341848908161, -1465.6350195747295, -1384.0652573209481, -1565.8859319438013, 11.587328108938914, -1241.5093023278257, -1221.223902948603, -1655.4937746057963, -924.0818836857867, -1117.0038677401396, -643.5275276784266, -250.0234716276928, -669.1753528432874, -1168.6069338136808, -1616.0278886858657, -819.2013220461964, -1199.476994687043, -227.2555715971255, -844.0163842377652, -1197.8280380895712, -907.5067932720823, -1240.3819802857147, -885.2778338499234, -526.5364648985545, -1365.2349590472352, 94.76504846289771, -987.7169418993052, -1477.2145801683344, -1183.0563014847648, -834.3460444408959, -366.3731769160092, -1038.809091934502, -1048.2087209408257, -1267.6361404831775, -859.324832881715, 13.590917477325599, -1280.3149179787288, -363.63362189814893, 319.3461056988621, -1331.182557773519, -1266.1328103165602, -614.7602668979367, -924.948632627507, -795.6367273701144, 351.4597153207905, -931.31454656282, 96.91355452183751, -1249.216178186772, -990.1044938921, 214.88907341702202, -1156.0137793204972, -769.5752695023845, -1423.0881682163952, -822.9160399612996, 295.8473082550141, -757.2636124276146, -949.6995536875828, -1052.6622198246644, -1057.961209611095, -1217.0392447029383, -516.3767147186295, -901.8814185532349, -1088.7964678888927, -445.3936941624513, -892.9300652509681, 36.702726375569526, -847.340320596769, -916.9401654949393, -161.85103039488553, -968.3276929895604, -110.15776253732294, -1136.9952595464035, -953.7389032951124, -13.186747338408809, -915.4878404298131, -175.13553639723415, -914.6964212113593, -45.72950995310549, 16.241121713132344, 1.2416049433707066, -472.5536917225556, -1078.6393040649064, -676.2608088075334, -1002.4843179687274, -468.4559537336911, -566.2353135154947, -937.9560005075227, -847.1073461335965, -931.1563055021751, -1204.6982997767955, -958.8874347394094, -947.2182135197742, -916.3486525607844, -590.6217073955264, -789.3848889999588, -1099.7612063548745, -601.6515154919942, -995.1107707339378, -1087.2350454286232, -464.4696465124514, -151.23261218066585, -1185.244257021136, -770.6851698690383, -321.4416262431321, -1098.0410755995383, -915.1044373939989, -1028.9265921222284, -8.475470527248037, -623.0710605905507, -1096.146028271036, -635.0433024884297, -1298.0763123729787, -1194.6707629662762, -585.7917343687759, -502.03206785116043, -265.52512579987297, -1115.5078745913495, -1208.3307354560275, -121.19515545319831, -523.7301704680315, -1227.6634981547231, -975.3950459814926, -326.8896701806332, 246.3634087444001, -561.1245593337758, -626.792334386869, -376.18804158666427, 69.00673678258795, -1011.3793906048594, -252.0858365261478, -9.218751350934786, -1107.9674020641867, -794.9490526061752, -883.251541337408, -1113.913194505549, -1028.0481962225335, -829.8872874815869, -693.4323678476638, -1176.5951186068169, -562.2416870531046, -949.4642433253206, -832.4602057607952, -1227.4420222540862, -680.1287504920831, -591.0253591670355, -993.7049218979464, -997.9567830449963, -451.7109021741902, -1025.1486978249682, -998.5636721546159, -338.81199291970427, -24.02539714333277, -661.9933121780227, -537.0613500874421, -971.11769554801, -767.303592199968, -286.076037654005, -160.12015013297696, -802.7731347879786, -1019.209258442265, -636.2295687869242, 39.09539434917427, 31.49800621183561, -1158.4701698177562, -496.87304504719043, -796.9782882616125, -611.2159872353476, -218.5119364680953, -685.9350227382263, -648.3834784567421, -593.7241172563977, 181.82436800307386, -879.1190119837684, -894.265756480664, -493.9656105965258, -630.6744831632246, -583.8335355113231, -278.2866870396399, -482.363712639765, -626.8527044876017, -976.4249613174738, -783.2300676611325, -1336.2198558857638, -572.8908724677977, -976.3656697958959, -148.39069937331078, -992.5012237297756, -765.1509036953755, -993.3044819232462, -867.6415314632783, 79.07793944749554, -27.942043479627074, -1007.3759292857557, -923.3821582874943, -796.0596942562537], "policy_predator_policy_reward": [1028.4571433408044, 331.49640028414206, 482.25905952284893, 778.5680500386788, 1390.6487444090758, 1134.341848908161, 1468.04435072012, 1377.95448333835, 1565.8859319438013, 78.78879745980048, 1242.5093023278257, 1223.7239029486032, 1655.4937746057963, 934.7818836857869, 1041.5832341776133, 1188.722938441103, 0.0, 1155.877909332437, 1168.6069338136808, 1616.0278886858657, 961.9110258570972, 1172.5449907957575, 250.34946093169359, 850.6163842377653, 1204.2280380895709, 908.2067932720825, 1243.0819802857147, 887.6778338499232, 979.729025454658, 1246.9669576755264, 7.536464442272491, 1064.681730881338, 1477.2145801683344, 1182.9935721291015, 693.5194530726916, 940.8784894463007, 1283.8278951947586, 1006.6348328556006, 1281.752578693475, 847.4155667675265, 642.3220428305707, 1123.7716650401132, 247.1197158999678, 458.29250596170044, 1331.182557773519, 1266.1328103165602, 989.4161343157481, 836.232501135062, 746.1818225468089, 602.0019990957311, 886.0601842733, 294.47075654242565, 1186.6928759296923, 1053.3326014572244, 320.0359493100292, 1069.6355716903588, 660.7963026192872, 1528.8724162180943, 779.3919943785345, 669.3394337900016, 842.6255330929417, 954.6995536875828, 1069.017178702215, 1047.2326697734518, 1213.3261100603045, 686.4896763856718, 927.7814185532358, 1088.7964678888927, 475.99369416245173, 893.1300652509681, 403.8608192708115, 508.46896497162334, 931.4401654949419, 217.1510303948854, 809.8299887667243, 584.3259771807552, 1136.9952595464035, 953.6410134627727, 473.5786927020053, 830.3023084516773, 581.6751011957195, 874.0624519072769, 220.6374107815994, 220.362166553541, 49.248567249215334, 481.0967432560313, 1078.6393040649064, 730.4608088075342, 1026.0843179687274, 475.5559537336914, 555.1073581046672, 1005.9653918379167, 1082.653964242743, 948.0556784970078, 1204.6982997767955, 960.4125927347148, 983.5664702583784, 918.7486525607844, 614.3771758247735, 789.3548409073771, 1100.8612063548746, 619.9689172706377, 1234.7883115936306, 846.9681667665445, 448.1614160035638, 638.2243339933044, 1186.8442570211346, 785.2851698690405, 764.9923565887505, 1040.3116545362952, 917.2044373939993, 1028.9265921222284, 643.3470054441749, 767.3874549007724, 1094.5652609245078, 740.0272650541131, 1299.5774638546106, 1197.143246253471, 587.131133770448, 510.97957385330244, 417.23568785885834, 1115.5078745913495, 1203.8209043232519, 381.394545016994, 1212.3661616316451, 566.5715242160076, 975.3423020333214, 527.1698539983179, 503.71203092159135, 439.432461594242, 601.4157172055228, 718.102189338857, 189.47090422612646, 1007.2993923138182, 248.34783911388962, 360.54801657674597, 1108.7674020641864, 794.5379615348677, 886.6515413374078, 1113.913194505549, 1028.0481962225335, 839.7872874815878, 695.8204762895352, 1176.5951186068169, 689.2991312320355, 934.5582372569538, 999.2897240245383, 1223.0543417676029, 725.268889559266, 589.1249730205166, 993.7049218979464, 997.9567830449963, 631.2633164991483, 1022.3633316487832, 998.5636721546159, 506.51199291970465, 425.58493913539326, 707.8955263819759, 538.6613500874423, 995.1176955480107, 828.1852721477069, 359.6036582666028, 771.3796162908918, 516.052731169797, 1019.209258442265, 636.9295687869245, 0.8046056508260161, 7.80199378816456, 1158.3276894325252, 679.2755457196427, 883.7143327493363, 597.5444228958753, 742.0616303044861, 505.82261828581755, 646.6087086694611, 609.7661455229497, 693.7407901085608, 466.56131258690044, 815.2474751046897, 1099.3090323097376, 681.4130791789598, 614.0335355113243, 402.20578463186826, 488.7355030847274, 642.7907388631488, 977.224961317474, 795.1520659355098, 1336.2198558857638, 574.690872467798, 982.2656697958961, 440.9752176811905, 988.0963338410404, 771.589661258002, 993.2010999231928, 810.4367274089178, 609.7718772613174, 804.276034485624, 949.6151407133755, 906.3479013453987, 943.623581320675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 9.005861340971139, "mean_inference_ms": 7.173516135911497, "mean_action_processing_ms": 2.519955715978489, "mean_env_wait_ms": 17.061446041089564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01575291156768799, "StateBufferConnector_ms": 0.018390417098999023, "ViewRequirementAgentConnector_ms": 0.2190335988998413}, "num_episodes": 10, "episode_return_max": 921.6626964622534, "episode_return_min": -3.7014428372067227, "episode_return_mean": 182.529695476948, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 881760, "num_agent_steps_trained": 881760, "num_env_steps_sampled": 220440, "num_env_steps_trained": 220440, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 152.44940903940216, "num_env_steps_trained_throughput_per_sec": 152.44940903940216, "timesteps_total": 220440, "num_env_steps_sampled_lifetime": 220440, "num_agent_steps_sampled_lifetime": 881760, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 881760, "timers": {"training_iteration_time_ms": 26765.416, "restore_workers_time_ms": 0.029, "training_step_time_ms": 26764.974, "sample_time_ms": 3270.602, "learn_time_ms": 23468.869, "learn_throughput": 170.779, "synch_weights_time_ms": 20.497}, "counters": {"num_env_steps_sampled": 220440, "num_env_steps_trained": 220440, "num_agent_steps_sampled": 881760, "num_agent_steps_trained": 881760}, "done": false, "training_iteration": 55, "trial_id": "7f713_00000", "date": "2024-08-23_10-11-30", "timestamp": 1724388090, "time_this_iter_s": 26.363226890563965, "time_total_s": 1488.2498016357422, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x173753af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1488.2498016357422, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 37.254054054054066, "ram_util_percent": 82.72432432432431}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 44.729207480647574, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.025771564907497, "policy_loss": -0.008388003472130371, "vf_loss": 7.032830186874148, "vf_explained_var": 0.7325443491103157, "kl": 0.006646802447608145, "entropy": 0.6610814359137621, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 52448.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.186161724474065, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 6.994296981670239, "policy_loss": -0.00833670504824825, "vf_loss": 7.002291181856993, "vf_explained_var": 0.40969949052447363, "kl": 0.0068508373193994715, "entropy": 0.4123809538821064, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 52448.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 224448, "num_env_steps_trained": 224448, "num_agent_steps_sampled": 897792, "num_agent_steps_trained": 897792}, "env_runners": {"episode_reward_max": 921.6626964622534, "episode_reward_min": -2.9947188813976062, "episode_reward_mean": 202.05329224002838, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1477.2145801683344, "predator_policy": 0.8046056508260161}, "policy_reward_max": {"prey_policy": 351.4597153207905, "predator_policy": 1528.8724162180943}, "policy_reward_mean": {"prey_policy": -681.6374786253567, "predator_policy": 782.6641247453713}, "custom_metrics": {}, "hist_stats": {"episode_reward": [7.100000000000016, 5.100000000000001, 334.9245591843899, 179.26630188720353, -0.06272935566335036, 433.67872116209196, 203.44491517503153, 2.207172096107822, 499.3697073692804, 661.1247056623847, -1.3766765505351941e-14, 285.93973592535946, 904.0068095932193, 346.1299487747443, 0.704805308043607, 448.5468150969202, -2.9947188813976062, 921.6626964622534, 90.36192066532652, 5.626419039907068, 166.39982702440824, 25.899999999999984, 30.80000000000006, 101.69219002123782, 69.80000000000018, 315.67051042059927, -0.09788983233979165, 375.20641338546403, 365.90559549440223, 411.5111890951681, 59.03322372606168, 54.20000000000004, 30.700000000000014, 56.88143591956542, 252.44599110398076, 1.5251579953050958, 38.74825673860411, 23.725420336662687, 19.41740177864405, -0.5893378023913964, 470.68349130375196, 16.199999999999953, 385.8213092823769, 2.099999999999995, 779.1879292271482, 103.40319521915576, 3.9736347688265345, 10.286905403813313, 151.71056205898486, 255.68955843102012, 27.544017224897967, 200.22743986951363, 628.3833419264582, 316.53753057084225, 254.3976427176724, 347.59126781355513, 0.3889089286925047, 3.400000000000003, 9.899999999999995, 2.388108441871444, 112.15143811056294, 162.44183777725817, 43.23975292066437, 4.440892098500626e-15, 176.76704814877058, 167.7, 447.46175619601433, 25.600000000000026, 134.40930056033258, 324.53906253973093, 0.7000000000000006, 79.19999999999978, 182.26002028721953, 73.06448014824544, 343.4372893839803, 14.267258479271153, 463.00745871476636, 526.3251403372304, 80.9385960157337, 130.29088803718906, 16.738034375544974, 11.921998274377515, 7.6999999999999975, 288.1796284191438, 6.335375562571603, 631.6450126544537, 718.5732024336153, 130.52963012232647, 84.01201729217006, 219.5999999999999, 525.7890880539379, 2.845761523296968, 89.91777661696327, 432.91150066116614, 230.5829193824437, 725.289367953376, 443.136885825138, 239.47502215533177, 8.507095163825237, 209.00956611702665], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1197.8280380895712, -907.5067932720823, -1240.3819802857147, -885.2778338499234, -526.5364648985545, -1365.2349590472352, 94.76504846289771, -987.7169418993052, -1477.2145801683344, -1183.0563014847648, -834.3460444408959, -366.3731769160092, -1038.809091934502, -1048.2087209408257, -1267.6361404831775, -859.324832881715, 13.590917477325599, -1280.3149179787288, -363.63362189814893, 319.3461056988621, -1331.182557773519, -1266.1328103165602, -614.7602668979367, -924.948632627507, -795.6367273701144, 351.4597153207905, -931.31454656282, 96.91355452183751, -1249.216178186772, -990.1044938921, 214.88907341702202, -1156.0137793204972, -769.5752695023845, -1423.0881682163952, -822.9160399612996, 295.8473082550141, -757.2636124276146, -949.6995536875828, -1052.6622198246644, -1057.961209611095, -1217.0392447029383, -516.3767147186295, -901.8814185532349, -1088.7964678888927, -445.3936941624513, -892.9300652509681, 36.702726375569526, -847.340320596769, -916.9401654949393, -161.85103039488553, -968.3276929895604, -110.15776253732294, -1136.9952595464035, -953.7389032951124, -13.186747338408809, -915.4878404298131, -175.13553639723415, -914.6964212113593, -45.72950995310549, 16.241121713132344, 1.2416049433707066, -472.5536917225556, -1078.6393040649064, -676.2608088075334, -1002.4843179687274, -468.4559537336911, -566.2353135154947, -937.9560005075227, -847.1073461335965, -931.1563055021751, -1204.6982997767955, -958.8874347394094, -947.2182135197742, -916.3486525607844, -590.6217073955264, -789.3848889999588, -1099.7612063548745, -601.6515154919942, -995.1107707339378, -1087.2350454286232, -464.4696465124514, -151.23261218066585, -1185.244257021136, -770.6851698690383, -321.4416262431321, -1098.0410755995383, -915.1044373939989, -1028.9265921222284, -8.475470527248037, -623.0710605905507, -1096.146028271036, -635.0433024884297, -1298.0763123729787, -1194.6707629662762, -585.7917343687759, -502.03206785116043, -265.52512579987297, -1115.5078745913495, -1208.3307354560275, -121.19515545319831, -523.7301704680315, -1227.6634981547231, -975.3950459814926, -326.8896701806332, 246.3634087444001, -561.1245593337758, -626.792334386869, -376.18804158666427, 69.00673678258795, -1011.3793906048594, -252.0858365261478, -9.218751350934786, -1107.9674020641867, -794.9490526061752, -883.251541337408, -1113.913194505549, -1028.0481962225335, -829.8872874815869, -693.4323678476638, -1176.5951186068169, -562.2416870531046, -949.4642433253206, -832.4602057607952, -1227.4420222540862, -680.1287504920831, -591.0253591670355, -993.7049218979464, -997.9567830449963, -451.7109021741902, -1025.1486978249682, -998.5636721546159, -338.81199291970427, -24.02539714333277, -661.9933121780227, -537.0613500874421, -971.11769554801, -767.303592199968, -286.076037654005, -160.12015013297696, -802.7731347879786, -1019.209258442265, -636.2295687869242, 39.09539434917427, 31.49800621183561, -1158.4701698177562, -496.87304504719043, -796.9782882616125, -611.2159872353476, -218.5119364680953, -685.9350227382263, -648.3834784567421, -593.7241172563977, 181.82436800307386, -879.1190119837684, -894.265756480664, -493.9656105965258, -630.6744831632246, -583.8335355113231, -278.2866870396399, -482.363712639765, -626.8527044876017, -976.4249613174738, -783.2300676611325, -1336.2198558857638, -572.8908724677977, -976.3656697958959, -148.39069937331078, -992.5012237297756, -765.1509036953755, -993.3044819232462, -867.6415314632783, 79.07793944749554, -27.942043479627074, -1007.3759292857557, -923.3821582874943, -796.0596942562537, -557.0286432086455, -500.49397440184964, -728.8183490695575, 9.673016611699591, 131.50472985374188, 50.76498030291128, -1015.1936389997878, -922.3409841964367, -864.9920610286565, -168.6465131435513, -126.10208899145135, -608.5926430739108, -273.45385427342416, -262.41969458053615, -872.8003995801745, 96.67330579551925, 349.8147832457911, -1270.1832600041232, -636.2028930836923, -517.42873232629, -724.7340570974333, -1131.610058318846, -903.0747301417886, -785.6000342560186], "policy_predator_policy_reward": [1204.2280380895709, 908.2067932720825, 1243.0819802857147, 887.6778338499232, 979.729025454658, 1246.9669576755264, 7.536464442272491, 1064.681730881338, 1477.2145801683344, 1182.9935721291015, 693.5194530726916, 940.8784894463007, 1283.8278951947586, 1006.6348328556006, 1281.752578693475, 847.4155667675265, 642.3220428305707, 1123.7716650401132, 247.1197158999678, 458.29250596170044, 1331.182557773519, 1266.1328103165602, 989.4161343157481, 836.232501135062, 746.1818225468089, 602.0019990957311, 886.0601842733, 294.47075654242565, 1186.6928759296923, 1053.3326014572244, 320.0359493100292, 1069.6355716903588, 660.7963026192872, 1528.8724162180943, 779.3919943785345, 669.3394337900016, 842.6255330929417, 954.6995536875828, 1069.017178702215, 1047.2326697734518, 1213.3261100603045, 686.4896763856718, 927.7814185532358, 1088.7964678888927, 475.99369416245173, 893.1300652509681, 403.8608192708115, 508.46896497162334, 931.4401654949419, 217.1510303948854, 809.8299887667243, 584.3259771807552, 1136.9952595464035, 953.6410134627727, 473.5786927020053, 830.3023084516773, 581.6751011957195, 874.0624519072769, 220.6374107815994, 220.362166553541, 49.248567249215334, 481.0967432560313, 1078.6393040649064, 730.4608088075342, 1026.0843179687274, 475.5559537336914, 555.1073581046672, 1005.9653918379167, 1082.653964242743, 948.0556784970078, 1204.6982997767955, 960.4125927347148, 983.5664702583784, 918.7486525607844, 614.3771758247735, 789.3548409073771, 1100.8612063548746, 619.9689172706377, 1234.7883115936306, 846.9681667665445, 448.1614160035638, 638.2243339933044, 1186.8442570211346, 785.2851698690405, 764.9923565887505, 1040.3116545362952, 917.2044373939993, 1028.9265921222284, 643.3470054441749, 767.3874549007724, 1094.5652609245078, 740.0272650541131, 1299.5774638546106, 1197.143246253471, 587.131133770448, 510.97957385330244, 417.23568785885834, 1115.5078745913495, 1203.8209043232519, 381.394545016994, 1212.3661616316451, 566.5715242160076, 975.3423020333214, 527.1698539983179, 503.71203092159135, 439.432461594242, 601.4157172055228, 718.102189338857, 189.47090422612646, 1007.2993923138182, 248.34783911388962, 360.54801657674597, 1108.7674020641864, 794.5379615348677, 886.6515413374078, 1113.913194505549, 1028.0481962225335, 839.7872874815878, 695.8204762895352, 1176.5951186068169, 689.2991312320355, 934.5582372569538, 999.2897240245383, 1223.0543417676029, 725.268889559266, 589.1249730205166, 993.7049218979464, 997.9567830449963, 631.2633164991483, 1022.3633316487832, 998.5636721546159, 506.51199291970465, 425.58493913539326, 707.8955263819759, 538.6613500874423, 995.1176955480107, 828.1852721477069, 359.6036582666028, 771.3796162908918, 516.052731169797, 1019.209258442265, 636.9295687869245, 0.8046056508260161, 7.80199378816456, 1158.3276894325252, 679.2755457196427, 883.7143327493363, 597.5444228958753, 742.0616303044861, 505.82261828581755, 646.6087086694611, 609.7661455229497, 693.7407901085608, 466.56131258690044, 815.2474751046897, 1099.3090323097376, 681.4130791789598, 614.0335355113243, 402.20578463186826, 488.7355030847274, 642.7907388631488, 977.224961317474, 795.1520659355098, 1336.2198558857638, 574.690872467798, 982.2656697958961, 440.9752176811905, 988.0963338410404, 771.589661258002, 993.2010999231928, 810.4367274089178, 609.7718772613174, 804.276034485624, 949.6151407133755, 906.3479013453987, 943.623581320675, 478.2852451184645, 663.2493897842025, 181.3405591251601, 757.404773332698, 137.03015394274962, 206.4892239545347, 1015.1936389997878, 925.1867457197338, 235.2948494473391, 888.261501341832, 521.7999739828176, 645.8062587437108, 276.51777307913216, 489.9386951572707, 765.5751678026324, 735.8412939353988, 1201.0898569278056, 162.41550565566655, 633.7624565710651, 759.3441909942502, 707.5302214716212, 1157.320989108484, 885.0775105543802, 1012.6068199604529]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.991084528032635, "mean_inference_ms": 7.17753655678208, "mean_action_processing_ms": 2.5137908735897763, "mean_env_wait_ms": 17.06000107106696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015562176704406738, "StateBufferConnector_ms": 0.01797008514404297, "ViewRequirementAgentConnector_ms": 0.21526193618774414}, "num_episodes": 12, "episode_return_max": 921.6626964622534, "episode_return_min": -2.9947188813976062, "episode_return_mean": 202.05329224002838, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 897792, "num_agent_steps_trained": 897792, "num_env_steps_sampled": 224448, "num_env_steps_trained": 224448, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 152.54840330929383, "num_env_steps_trained_throughput_per_sec": 152.54840330929383, "timesteps_total": 224448, "num_env_steps_sampled_lifetime": 224448, "num_agent_steps_sampled_lifetime": 897792, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 897792, "timers": {"training_iteration_time_ms": 26760.32, "restore_workers_time_ms": 0.029, "training_step_time_ms": 26759.879, "sample_time_ms": 3226.544, "learn_time_ms": 23508.072, "learn_throughput": 170.495, "synch_weights_time_ms": 20.393}, "counters": {"num_env_steps_sampled": 224448, "num_env_steps_trained": 224448, "num_agent_steps_sampled": 897792, "num_agent_steps_trained": 897792}, "done": false, "training_iteration": 56, "trial_id": "7f713_00000", "date": "2024-08-23_10-11-56", "timestamp": 1724388116, "time_this_iter_s": 26.321351289749146, "time_total_s": 1514.5711529254913, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x173753c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1514.5711529254913, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 36.32368421052632, "ram_util_percent": 82.91052631578948}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.41702824572407, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.076317821987091, "policy_loss": -0.008881958031431875, "vf_loss": 7.083648464667103, "vf_explained_var": 0.6423725072038237, "kl": 0.007756581040414632, "entropy": 0.6247403163758535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 53393.0, "diff_num_grad_updates_vs_sampler_policy": 489.68338323353237}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.587293692997523, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 7.091482558073821, "policy_loss": -0.010596002148533309, "vf_loss": 7.101628150132598, "vf_explained_var": 0.22593475908198685, "kl": 0.009007900391542723, "entropy": 0.40278784355158526, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 53393.0, "diff_num_grad_updates_vs_sampler_policy": 489.68338323353237}}, "num_env_steps_sampled": 228456, "num_env_steps_trained": 228456, "num_agent_steps_sampled": 913824, "num_agent_steps_trained": 913824}, "env_runners": {"episode_reward_max": 921.6626964622534, "episode_reward_min": -2.9947188813976062, "episode_reward_mean": 197.40827819386, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1423.0881682163952, "predator_policy": 0.8046056508260161}, "policy_reward_max": {"prey_policy": 349.8147832457911, "predator_policy": 1528.8724162180943}, "policy_reward_mean": {"prey_policy": -646.482263279652, "predator_policy": 745.1864023765822}, "custom_metrics": {}, "hist_stats": {"episode_reward": [346.1299487747443, 0.704805308043607, 448.5468150969202, -2.9947188813976062, 921.6626964622534, 90.36192066532652, 5.626419039907068, 166.39982702440824, 25.899999999999984, 30.80000000000006, 101.69219002123782, 69.80000000000018, 315.67051042059927, -0.09788983233979165, 375.20641338546403, 365.90559549440223, 411.5111890951681, 59.03322372606168, 54.20000000000004, 30.700000000000014, 56.88143591956542, 252.44599110398076, 1.5251579953050958, 38.74825673860411, 23.725420336662687, 19.41740177864405, -0.5893378023913964, 470.68349130375196, 16.199999999999953, 385.8213092823769, 2.099999999999995, 779.1879292271482, 103.40319521915576, 3.9736347688265345, 10.286905403813313, 151.71056205898486, 255.68955843102012, 27.544017224897967, 200.22743986951363, 628.3833419264582, 316.53753057084225, 254.3976427176724, 347.59126781355513, 0.3889089286925047, 3.400000000000003, 9.899999999999995, 2.388108441871444, 112.15143811056294, 162.44183777725817, 43.23975292066437, 4.440892098500626e-15, 176.76704814877058, 167.7, 447.46175619601433, 25.600000000000026, 134.40930056033258, 324.53906253973093, 0.7000000000000006, 79.19999999999978, 182.26002028721953, 73.06448014824544, 343.4372893839803, 14.267258479271153, 463.00745871476636, 526.3251403372304, 80.9385960157337, 130.29088803718906, 16.738034375544974, 11.921998274377515, 7.6999999999999975, 288.1796284191438, 6.335375562571603, 631.6450126544537, 718.5732024336153, 130.52963012232647, 84.01201729217006, 219.5999999999999, 525.7890880539379, 2.845761523296968, 89.91777661696327, 432.91150066116614, 230.5829193824437, 725.289367953376, 443.136885825138, 239.47502215533177, 8.507095163825237, 209.00956611702665, 554.4687447559186, 80.80000000000003, 26.261986789985286, 265.90145303995496, 216.46451606205207, 413.09267247015197, 83.55666224361931, 95.26881695626271, 305.118575221252, 467.6778968483049, 369.67747649563717, 22.13366233372909, 151.17603086570693], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-931.31454656282, 96.91355452183751, -1249.216178186772, -990.1044938921, 214.88907341702202, -1156.0137793204972, -769.5752695023845, -1423.0881682163952, -822.9160399612996, 295.8473082550141, -757.2636124276146, -949.6995536875828, -1052.6622198246644, -1057.961209611095, -1217.0392447029383, -516.3767147186295, -901.8814185532349, -1088.7964678888927, -445.3936941624513, -892.9300652509681, 36.702726375569526, -847.340320596769, -916.9401654949393, -161.85103039488553, -968.3276929895604, -110.15776253732294, -1136.9952595464035, -953.7389032951124, -13.186747338408809, -915.4878404298131, -175.13553639723415, -914.6964212113593, -45.72950995310549, 16.241121713132344, 1.2416049433707066, -472.5536917225556, -1078.6393040649064, -676.2608088075334, -1002.4843179687274, -468.4559537336911, -566.2353135154947, -937.9560005075227, -847.1073461335965, -931.1563055021751, -1204.6982997767955, -958.8874347394094, -947.2182135197742, -916.3486525607844, -590.6217073955264, -789.3848889999588, -1099.7612063548745, -601.6515154919942, -995.1107707339378, -1087.2350454286232, -464.4696465124514, -151.23261218066585, -1185.244257021136, -770.6851698690383, -321.4416262431321, -1098.0410755995383, -915.1044373939989, -1028.9265921222284, -8.475470527248037, -623.0710605905507, -1096.146028271036, -635.0433024884297, -1298.0763123729787, -1194.6707629662762, -585.7917343687759, -502.03206785116043, -265.52512579987297, -1115.5078745913495, -1208.3307354560275, -121.19515545319831, -523.7301704680315, -1227.6634981547231, -975.3950459814926, -326.8896701806332, 246.3634087444001, -561.1245593337758, -626.792334386869, -376.18804158666427, 69.00673678258795, -1011.3793906048594, -252.0858365261478, -9.218751350934786, -1107.9674020641867, -794.9490526061752, -883.251541337408, -1113.913194505549, -1028.0481962225335, -829.8872874815869, -693.4323678476638, -1176.5951186068169, -562.2416870531046, -949.4642433253206, -832.4602057607952, -1227.4420222540862, -680.1287504920831, -591.0253591670355, -993.7049218979464, -997.9567830449963, -451.7109021741902, -1025.1486978249682, -998.5636721546159, -338.81199291970427, -24.02539714333277, -661.9933121780227, -537.0613500874421, -971.11769554801, -767.303592199968, -286.076037654005, -160.12015013297696, -802.7731347879786, -1019.209258442265, -636.2295687869242, 39.09539434917427, 31.49800621183561, -1158.4701698177562, -496.87304504719043, -796.9782882616125, -611.2159872353476, -218.5119364680953, -685.9350227382263, -648.3834784567421, -593.7241172563977, 181.82436800307386, -879.1190119837684, -894.265756480664, -493.9656105965258, -630.6744831632246, -583.8335355113231, -278.2866870396399, -482.363712639765, -626.8527044876017, -976.4249613174738, -783.2300676611325, -1336.2198558857638, -572.8908724677977, -976.3656697958959, -148.39069937331078, -992.5012237297756, -765.1509036953755, -993.3044819232462, -867.6415314632783, 79.07793944749554, -27.942043479627074, -1007.3759292857557, -923.3821582874943, -796.0596942562537, -557.0286432086455, -500.49397440184964, -728.8183490695575, 9.673016611699591, 131.50472985374188, 50.76498030291128, -1015.1936389997878, -922.3409841964367, -864.9920610286565, -168.6465131435513, -126.10208899145135, -608.5926430739108, -273.45385427342416, -262.41969458053615, -872.8003995801745, 96.67330579551925, 349.8147832457911, -1270.1832600041232, -636.2028930836923, -517.42873232629, -724.7340570974333, -1131.610058318846, -903.0747301417886, -785.6000342560186, -825.4122207955858, 107.05274328295741, -781.6708555927956, -575.2051189458253, -1061.9377223272127, -688.3149123217623, -787.2661993288162, -525.6107441789111, -847.1346409271307, -602.6773415820021, -115.3325537067169, -527.1563220719528, -184.16835691376198, -789.4807182040281, -984.427277313351, -129.67196392902275, -1162.6927792485365, -92.86569335269712, 234.0592847422447, -577.7645630644543, -130.5471470520003, -136.99497612933658, -1003.8426100541346, -538.9130756000375, -883.1637576864224, -340.71705705299564], "policy_predator_policy_reward": [886.0601842733, 294.47075654242565, 1186.6928759296923, 1053.3326014572244, 320.0359493100292, 1069.6355716903588, 660.7963026192872, 1528.8724162180943, 779.3919943785345, 669.3394337900016, 842.6255330929417, 954.6995536875828, 1069.017178702215, 1047.2326697734518, 1213.3261100603045, 686.4896763856718, 927.7814185532358, 1088.7964678888927, 475.99369416245173, 893.1300652509681, 403.8608192708115, 508.46896497162334, 931.4401654949419, 217.1510303948854, 809.8299887667243, 584.3259771807552, 1136.9952595464035, 953.6410134627727, 473.5786927020053, 830.3023084516773, 581.6751011957195, 874.0624519072769, 220.6374107815994, 220.362166553541, 49.248567249215334, 481.0967432560313, 1078.6393040649064, 730.4608088075342, 1026.0843179687274, 475.5559537336914, 555.1073581046672, 1005.9653918379167, 1082.653964242743, 948.0556784970078, 1204.6982997767955, 960.4125927347148, 983.5664702583784, 918.7486525607844, 614.3771758247735, 789.3548409073771, 1100.8612063548746, 619.9689172706377, 1234.7883115936306, 846.9681667665445, 448.1614160035638, 638.2243339933044, 1186.8442570211346, 785.2851698690405, 764.9923565887505, 1040.3116545362952, 917.2044373939993, 1028.9265921222284, 643.3470054441749, 767.3874549007724, 1094.5652609245078, 740.0272650541131, 1299.5774638546106, 1197.143246253471, 587.131133770448, 510.97957385330244, 417.23568785885834, 1115.5078745913495, 1203.8209043232519, 381.394545016994, 1212.3661616316451, 566.5715242160076, 975.3423020333214, 527.1698539983179, 503.71203092159135, 439.432461594242, 601.4157172055228, 718.102189338857, 189.47090422612646, 1007.2993923138182, 248.34783911388962, 360.54801657674597, 1108.7674020641864, 794.5379615348677, 886.6515413374078, 1113.913194505549, 1028.0481962225335, 839.7872874815878, 695.8204762895352, 1176.5951186068169, 689.2991312320355, 934.5582372569538, 999.2897240245383, 1223.0543417676029, 725.268889559266, 589.1249730205166, 993.7049218979464, 997.9567830449963, 631.2633164991483, 1022.3633316487832, 998.5636721546159, 506.51199291970465, 425.58493913539326, 707.8955263819759, 538.6613500874423, 995.1176955480107, 828.1852721477069, 359.6036582666028, 771.3796162908918, 516.052731169797, 1019.209258442265, 636.9295687869245, 0.8046056508260161, 7.80199378816456, 1158.3276894325252, 679.2755457196427, 883.7143327493363, 597.5444228958753, 742.0616303044861, 505.82261828581755, 646.6087086694611, 609.7661455229497, 693.7407901085608, 466.56131258690044, 815.2474751046897, 1099.3090323097376, 681.4130791789598, 614.0335355113243, 402.20578463186826, 488.7355030847274, 642.7907388631488, 977.224961317474, 795.1520659355098, 1336.2198558857638, 574.690872467798, 982.2656697958961, 440.9752176811905, 988.0963338410404, 771.589661258002, 993.2010999231928, 810.4367274089178, 609.7718772613174, 804.276034485624, 949.6151407133755, 906.3479013453987, 943.623581320675, 478.2852451184645, 663.2493897842025, 181.3405591251601, 757.404773332698, 137.03015394274962, 206.4892239545347, 1015.1936389997878, 925.1867457197338, 235.2948494473391, 888.261501341832, 521.7999739828176, 645.8062587437108, 276.51777307913216, 489.9386951572707, 765.5751678026324, 735.8412939353988, 1201.0898569278056, 162.41550565566655, 633.7624565710651, 759.3441909942502, 707.5302214716212, 1157.320989108484, 885.0775105543802, 1012.6068199604529, 789.9301366243923, 482.89808564415193, 782.9708555927956, 654.7051189458259, 1061.9068461896682, 714.6077752492918, 780.3322284280165, 798.4461681196645, 814.3294896073859, 851.947008963803, 516.335160946659, 539.2463873021627, 808.7972190233814, 248.40851833802782, 548.9047365354207, 660.4633216632167, 1162.6817834122398, 397.99526441024625, 275.766868037551, 535.6163071329642, 276.49889604996713, 360.72070362700833, 1003.8426100541346, 561.0467379337656, 755.7781299144265, 619.2787156907012]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.960501447662944, "mean_inference_ms": 7.154603790621772, "mean_action_processing_ms": 2.505203249075231, "mean_env_wait_ms": 17.067969960831192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016506552696228027, "StateBufferConnector_ms": 0.018260478973388672, "ViewRequirementAgentConnector_ms": 0.22456634044647217}, "num_episodes": 13, "episode_return_max": 921.6626964622534, "episode_return_min": -2.9947188813976062, "episode_return_mean": 197.40827819386, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 913824, "num_agent_steps_trained": 913824, "num_env_steps_sampled": 228456, "num_env_steps_trained": 228456, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 150.88787188801183, "num_env_steps_trained_throughput_per_sec": 150.88787188801183, "timesteps_total": 228456, "num_env_steps_sampled_lifetime": 228456, "num_agent_steps_sampled_lifetime": 913824, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 913824, "timers": {"training_iteration_time_ms": 26677.461, "restore_workers_time_ms": 0.029, "training_step_time_ms": 26677.01, "sample_time_ms": 3188.059, "learn_time_ms": 23466.133, "learn_throughput": 170.799, "synch_weights_time_ms": 18.327}, "counters": {"num_env_steps_sampled": 228456, "num_env_steps_trained": 228456, "num_agent_steps_sampled": 913824, "num_agent_steps_trained": 913824}, "done": false, "training_iteration": 57, "trial_id": "7f713_00000", "date": "2024-08-23_10-12-23", "timestamp": 1724388143, "time_this_iter_s": 26.598042964935303, "time_total_s": 1541.1691958904266, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737a2550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1541.1691958904266, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 37.759459459459464, "ram_util_percent": 82.96756756756757}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.812112407835706, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.916182734978893, "policy_loss": -0.007923792236824594, "vf_loss": 6.9223075336880155, "vf_explained_var": 0.6524007577114004, "kl": 0.008994949580460945, "entropy": 0.6567163825035095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 54338.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.292384130992588, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 6.823439523908827, "policy_loss": -0.00787333432639205, "vf_loss": 6.830923874668343, "vf_explained_var": 0.37826515127111365, "kl": 0.007779772389463331, "entropy": 0.4284084783029304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 54338.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 232464, "num_env_steps_trained": 232464, "num_agent_steps_sampled": 929856, "num_agent_steps_trained": 929856}, "env_runners": {"episode_reward_max": 779.1879292271482, "episode_reward_min": -0.5893378023913964, "episode_reward_mean": 207.76098223865793, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1336.2198558857638, "predator_policy": 0.8046056508260161}, "policy_reward_max": {"prey_policy": 349.8147832457911, "predator_policy": 1336.2198558857638}, "policy_reward_mean": {"prey_policy": -613.0526984291167, "predator_policy": 716.933189548446}, "custom_metrics": {}, "hist_stats": {"episode_reward": [315.67051042059927, -0.09788983233979165, 375.20641338546403, 365.90559549440223, 411.5111890951681, 59.03322372606168, 54.20000000000004, 30.700000000000014, 56.88143591956542, 252.44599110398076, 1.5251579953050958, 38.74825673860411, 23.725420336662687, 19.41740177864405, -0.5893378023913964, 470.68349130375196, 16.199999999999953, 385.8213092823769, 2.099999999999995, 779.1879292271482, 103.40319521915576, 3.9736347688265345, 10.286905403813313, 151.71056205898486, 255.68955843102012, 27.544017224897967, 200.22743986951363, 628.3833419264582, 316.53753057084225, 254.3976427176724, 347.59126781355513, 0.3889089286925047, 3.400000000000003, 9.899999999999995, 2.388108441871444, 112.15143811056294, 162.44183777725817, 43.23975292066437, 4.440892098500626e-15, 176.76704814877058, 167.7, 447.46175619601433, 25.600000000000026, 134.40930056033258, 324.53906253973093, 0.7000000000000006, 79.19999999999978, 182.26002028721953, 73.06448014824544, 343.4372893839803, 14.267258479271153, 463.00745871476636, 526.3251403372304, 80.9385960157337, 130.29088803718906, 16.738034375544974, 11.921998274377515, 7.6999999999999975, 288.1796284191438, 6.335375562571603, 631.6450126544537, 718.5732024336153, 130.52963012232647, 84.01201729217006, 219.5999999999999, 525.7890880539379, 2.845761523296968, 89.91777661696327, 432.91150066116614, 230.5829193824437, 725.289367953376, 443.136885825138, 239.47502215533177, 8.507095163825237, 209.00956611702665, 554.4687447559186, 80.80000000000003, 26.261986789985286, 265.90145303995496, 216.46451606205207, 413.09267247015197, 83.55666224361931, 95.26881695626271, 305.118575221252, 467.6778968483049, 369.67747649563717, 22.13366233372909, 151.17603086570693, 184.13631208779586, 174.09339722611855, 305.0650883357239, 36.30196852633312, 433.84413482525497, 445.8665031035116, 158.60126567922944, 15.512678125181633, 638.4910933161713, 624.1257876631619, 13.699999999999976, 210.16207910275057], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-968.3276929895604, -110.15776253732294, -1136.9952595464035, -953.7389032951124, -13.186747338408809, -915.4878404298131, -175.13553639723415, -914.6964212113593, -45.72950995310549, 16.241121713132344, 1.2416049433707066, -472.5536917225556, -1078.6393040649064, -676.2608088075334, -1002.4843179687274, -468.4559537336911, -566.2353135154947, -937.9560005075227, -847.1073461335965, -931.1563055021751, -1204.6982997767955, -958.8874347394094, -947.2182135197742, -916.3486525607844, -590.6217073955264, -789.3848889999588, -1099.7612063548745, -601.6515154919942, -995.1107707339378, -1087.2350454286232, -464.4696465124514, -151.23261218066585, -1185.244257021136, -770.6851698690383, -321.4416262431321, -1098.0410755995383, -915.1044373939989, -1028.9265921222284, -8.475470527248037, -623.0710605905507, -1096.146028271036, -635.0433024884297, -1298.0763123729787, -1194.6707629662762, -585.7917343687759, -502.03206785116043, -265.52512579987297, -1115.5078745913495, -1208.3307354560275, -121.19515545319831, -523.7301704680315, -1227.6634981547231, -975.3950459814926, -326.8896701806332, 246.3634087444001, -561.1245593337758, -626.792334386869, -376.18804158666427, 69.00673678258795, -1011.3793906048594, -252.0858365261478, -9.218751350934786, -1107.9674020641867, -794.9490526061752, -883.251541337408, -1113.913194505549, -1028.0481962225335, -829.8872874815869, -693.4323678476638, -1176.5951186068169, -562.2416870531046, -949.4642433253206, -832.4602057607952, -1227.4420222540862, -680.1287504920831, -591.0253591670355, -993.7049218979464, -997.9567830449963, -451.7109021741902, -1025.1486978249682, -998.5636721546159, -338.81199291970427, -24.02539714333277, -661.9933121780227, -537.0613500874421, -971.11769554801, -767.303592199968, -286.076037654005, -160.12015013297696, -802.7731347879786, -1019.209258442265, -636.2295687869242, 39.09539434917427, 31.49800621183561, -1158.4701698177562, -496.87304504719043, -796.9782882616125, -611.2159872353476, -218.5119364680953, -685.9350227382263, -648.3834784567421, -593.7241172563977, 181.82436800307386, -879.1190119837684, -894.265756480664, -493.9656105965258, -630.6744831632246, -583.8335355113231, -278.2866870396399, -482.363712639765, -626.8527044876017, -976.4249613174738, -783.2300676611325, -1336.2198558857638, -572.8908724677977, -976.3656697958959, -148.39069937331078, -992.5012237297756, -765.1509036953755, -993.3044819232462, -867.6415314632783, 79.07793944749554, -27.942043479627074, -1007.3759292857557, -923.3821582874943, -796.0596942562537, -557.0286432086455, -500.49397440184964, -728.8183490695575, 9.673016611699591, 131.50472985374188, 50.76498030291128, -1015.1936389997878, -922.3409841964367, -864.9920610286565, -168.6465131435513, -126.10208899145135, -608.5926430739108, -273.45385427342416, -262.41969458053615, -872.8003995801745, 96.67330579551925, 349.8147832457911, -1270.1832600041232, -636.2028930836923, -517.42873232629, -724.7340570974333, -1131.610058318846, -903.0747301417886, -785.6000342560186, -825.4122207955858, 107.05274328295741, -781.6708555927956, -575.2051189458253, -1061.9377223272127, -688.3149123217623, -787.2661993288162, -525.6107441789111, -847.1346409271307, -602.6773415820021, -115.3325537067169, -527.1563220719528, -184.16835691376198, -789.4807182040281, -984.427277313351, -129.67196392902275, -1162.6927792485365, -92.86569335269712, 234.0592847422447, -577.7645630644543, -130.5471470520003, -136.99497612933658, -1003.8426100541346, -538.9130756000375, -883.1637576864224, -340.71705705299564, -875.5887892100457, -277.0203246934043, -133.03402812753455, -600.4014050511693, 163.24087806841322, -647.7735578180564, -78.0991689666381, -933.1101304354227, -744.6166042310094, 43.20948851090053, -177.42133323591224, -258.7304896848203, -549.8290264793297, -427.6486119110022, -534.63025175277, -1042.2390372107168, -741.3850868185883, 196.69921104267684, 188.55506849354586, -589.9128345011579, -777.0792080134868, -872.2697899628124, -510.3336529960354, -638.6798752960656], "policy_predator_policy_reward": [809.8299887667243, 584.3259771807552, 1136.9952595464035, 953.6410134627727, 473.5786927020053, 830.3023084516773, 581.6751011957195, 874.0624519072769, 220.6374107815994, 220.362166553541, 49.248567249215334, 481.0967432560313, 1078.6393040649064, 730.4608088075342, 1026.0843179687274, 475.5559537336914, 555.1073581046672, 1005.9653918379167, 1082.653964242743, 948.0556784970078, 1204.6982997767955, 960.4125927347148, 983.5664702583784, 918.7486525607844, 614.3771758247735, 789.3548409073771, 1100.8612063548746, 619.9689172706377, 1234.7883115936306, 846.9681667665445, 448.1614160035638, 638.2243339933044, 1186.8442570211346, 785.2851698690405, 764.9923565887505, 1040.3116545362952, 917.2044373939993, 1028.9265921222284, 643.3470054441749, 767.3874549007724, 1094.5652609245078, 740.0272650541131, 1299.5774638546106, 1197.143246253471, 587.131133770448, 510.97957385330244, 417.23568785885834, 1115.5078745913495, 1203.8209043232519, 381.394545016994, 1212.3661616316451, 566.5715242160076, 975.3423020333214, 527.1698539983179, 503.71203092159135, 439.432461594242, 601.4157172055228, 718.102189338857, 189.47090422612646, 1007.2993923138182, 248.34783911388962, 360.54801657674597, 1108.7674020641864, 794.5379615348677, 886.6515413374078, 1113.913194505549, 1028.0481962225335, 839.7872874815878, 695.8204762895352, 1176.5951186068169, 689.2991312320355, 934.5582372569538, 999.2897240245383, 1223.0543417676029, 725.268889559266, 589.1249730205166, 993.7049218979464, 997.9567830449963, 631.2633164991483, 1022.3633316487832, 998.5636721546159, 506.51199291970465, 425.58493913539326, 707.8955263819759, 538.6613500874423, 995.1176955480107, 828.1852721477069, 359.6036582666028, 771.3796162908918, 516.052731169797, 1019.209258442265, 636.9295687869245, 0.8046056508260161, 7.80199378816456, 1158.3276894325252, 679.2755457196427, 883.7143327493363, 597.5444228958753, 742.0616303044861, 505.82261828581755, 646.6087086694611, 609.7661455229497, 693.7407901085608, 466.56131258690044, 815.2474751046897, 1099.3090323097376, 681.4130791789598, 614.0335355113243, 402.20578463186826, 488.7355030847274, 642.7907388631488, 977.224961317474, 795.1520659355098, 1336.2198558857638, 574.690872467798, 982.2656697958961, 440.9752176811905, 988.0963338410404, 771.589661258002, 993.2010999231928, 810.4367274089178, 609.7718772613174, 804.276034485624, 949.6151407133755, 906.3479013453987, 943.623581320675, 478.2852451184645, 663.2493897842025, 181.3405591251601, 757.404773332698, 137.03015394274962, 206.4892239545347, 1015.1936389997878, 925.1867457197338, 235.2948494473391, 888.261501341832, 521.7999739828176, 645.8062587437108, 276.51777307913216, 489.9386951572707, 765.5751678026324, 735.8412939353988, 1201.0898569278056, 162.41550565566655, 633.7624565710651, 759.3441909942502, 707.5302214716212, 1157.320989108484, 885.0775105543802, 1012.6068199604529, 789.9301366243923, 482.89808564415193, 782.9708555927956, 654.7051189458259, 1061.9068461896682, 714.6077752492918, 780.3322284280165, 798.4461681196645, 814.3294896073859, 851.947008963803, 516.335160946659, 539.2463873021627, 808.7972190233814, 248.40851833802782, 548.9047365354207, 660.4633216632167, 1162.6817834122398, 397.99526441024625, 275.766868037551, 535.6163071329642, 276.49889604996713, 360.72070362700833, 1003.8426100541346, 561.0467379337656, 755.7781299144265, 619.2787156907012, 908.2008237827187, 428.5446022085282, 295.6284785402563, 611.9003518645668, 215.90612596222107, 573.691642123148, 901.3486350811341, 146.16263284725747, 507.0095264295694, 628.2417241157927, 396.6481788015355, 485.37014722270607, 620.4809276889783, 515.5979763805834, 549.9429298779547, 1042.4390372107168, 685.0941745939666, 498.08279449811306, 581.4115759519092, 444.0719777188654, 783.5792080134883, 879.4697899628125, 652.481634302262, 706.693973092592]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.937756475188253, "mean_inference_ms": 7.167880955753949, "mean_action_processing_ms": 2.471149034414972, "mean_env_wait_ms": 17.05428214379896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016418933868408203, "StateBufferConnector_ms": 0.01828014850616455, "ViewRequirementAgentConnector_ms": 0.2044605016708374}, "num_episodes": 12, "episode_return_max": 779.1879292271482, "episode_return_min": -0.5893378023913964, "episode_return_mean": 207.76098223865793, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 929856, "num_agent_steps_trained": 929856, "num_env_steps_sampled": 232464, "num_env_steps_trained": 232464, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 154.06098876796568, "num_env_steps_trained_throughput_per_sec": 154.06098876796568, "timesteps_total": 232464, "num_env_steps_sampled_lifetime": 232464, "num_agent_steps_sampled_lifetime": 929856, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 929856, "timers": {"training_iteration_time_ms": 26572.747, "restore_workers_time_ms": 0.022, "training_step_time_ms": 26572.263, "sample_time_ms": 3040.751, "learn_time_ms": 23509.951, "learn_throughput": 170.481, "synch_weights_time_ms": 17.711}, "counters": {"num_env_steps_sampled": 232464, "num_env_steps_trained": 232464, "num_agent_steps_sampled": 929856, "num_agent_steps_trained": 929856}, "done": false, "training_iteration": 58, "trial_id": "7f713_00000", "date": "2024-08-23_10-12-49", "timestamp": 1724388169, "time_this_iter_s": 26.07129216194153, "time_total_s": 1567.2404880523682, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x173753d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1567.2404880523682, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 37.01081081081081, "ram_util_percent": 82.4054054054054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.774962414887845, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.927361732059055, "policy_loss": -0.008549994252444734, "vf_loss": 6.934290844044358, "vf_explained_var": 0.6906948824408193, "kl": 0.00810442376640384, "entropy": 0.6726876053860579, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 55283.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.225722536965023, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 7.04122694207247, "policy_loss": -0.010326604807266482, "vf_loss": 7.0511811569254235, "vf_explained_var": 0.39839272385551816, "kl": 0.007447417258782677, "entropy": 0.4169027881332175, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 55283.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 236472, "num_env_steps_trained": 236472, "num_agent_steps_sampled": 945888, "num_agent_steps_trained": 945888}, "env_runners": {"episode_reward_max": 789.0931481062659, "episode_reward_min": -0.5893378023913964, "episode_reward_mean": 224.29184233620583, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1336.2198558857638, "predator_policy": 0.8046056508260161}, "policy_reward_max": {"prey_policy": 349.8147832457911, "predator_policy": 1336.2198558857638}, "policy_reward_mean": {"prey_policy": -589.4078082358491, "predator_policy": 701.5537294039523}, "custom_metrics": {}, "hist_stats": {"episode_reward": [19.41740177864405, -0.5893378023913964, 470.68349130375196, 16.199999999999953, 385.8213092823769, 2.099999999999995, 779.1879292271482, 103.40319521915576, 3.9736347688265345, 10.286905403813313, 151.71056205898486, 255.68955843102012, 27.544017224897967, 200.22743986951363, 628.3833419264582, 316.53753057084225, 254.3976427176724, 347.59126781355513, 0.3889089286925047, 3.400000000000003, 9.899999999999995, 2.388108441871444, 112.15143811056294, 162.44183777725817, 43.23975292066437, 4.440892098500626e-15, 176.76704814877058, 167.7, 447.46175619601433, 25.600000000000026, 134.40930056033258, 324.53906253973093, 0.7000000000000006, 79.19999999999978, 182.26002028721953, 73.06448014824544, 343.4372893839803, 14.267258479271153, 463.00745871476636, 526.3251403372304, 80.9385960157337, 130.29088803718906, 16.738034375544974, 11.921998274377515, 7.6999999999999975, 288.1796284191438, 6.335375562571603, 631.6450126544537, 718.5732024336153, 130.52963012232647, 84.01201729217006, 219.5999999999999, 525.7890880539379, 2.845761523296968, 89.91777661696327, 432.91150066116614, 230.5829193824437, 725.289367953376, 443.136885825138, 239.47502215533177, 8.507095163825237, 209.00956611702665, 554.4687447559186, 80.80000000000003, 26.261986789985286, 265.90145303995496, 216.46451606205207, 413.09267247015197, 83.55666224361931, 95.26881695626271, 305.118575221252, 467.6778968483049, 369.67747649563717, 22.13366233372909, 151.17603086570693, 184.13631208779586, 174.09339722611855, 305.0650883357239, 36.30196852633312, 433.84413482525497, 445.8665031035116, 158.60126567922944, 15.512678125181633, 638.4910933161713, 624.1257876631619, 13.699999999999976, 210.16207910275057, 106.53999446237846, 218.15070109741032, 331.9212949164689, 789.0931481062659, 26.820338852170714, 322.6507622034735, 330.04276110331307, 331.4065896700973, 682.2652215885594, 322.1526207614392, 26.998783415369687, 80.03345702087661, 70.46564094044234], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1099.7612063548745, -601.6515154919942, -995.1107707339378, -1087.2350454286232, -464.4696465124514, -151.23261218066585, -1185.244257021136, -770.6851698690383, -321.4416262431321, -1098.0410755995383, -915.1044373939989, -1028.9265921222284, -8.475470527248037, -623.0710605905507, -1096.146028271036, -635.0433024884297, -1298.0763123729787, -1194.6707629662762, -585.7917343687759, -502.03206785116043, -265.52512579987297, -1115.5078745913495, -1208.3307354560275, -121.19515545319831, -523.7301704680315, -1227.6634981547231, -975.3950459814926, -326.8896701806332, 246.3634087444001, -561.1245593337758, -626.792334386869, -376.18804158666427, 69.00673678258795, -1011.3793906048594, -252.0858365261478, -9.218751350934786, -1107.9674020641867, -794.9490526061752, -883.251541337408, -1113.913194505549, -1028.0481962225335, -829.8872874815869, -693.4323678476638, -1176.5951186068169, -562.2416870531046, -949.4642433253206, -832.4602057607952, -1227.4420222540862, -680.1287504920831, -591.0253591670355, -993.7049218979464, -997.9567830449963, -451.7109021741902, -1025.1486978249682, -998.5636721546159, -338.81199291970427, -24.02539714333277, -661.9933121780227, -537.0613500874421, -971.11769554801, -767.303592199968, -286.076037654005, -160.12015013297696, -802.7731347879786, -1019.209258442265, -636.2295687869242, 39.09539434917427, 31.49800621183561, -1158.4701698177562, -496.87304504719043, -796.9782882616125, -611.2159872353476, -218.5119364680953, -685.9350227382263, -648.3834784567421, -593.7241172563977, 181.82436800307386, -879.1190119837684, -894.265756480664, -493.9656105965258, -630.6744831632246, -583.8335355113231, -278.2866870396399, -482.363712639765, -626.8527044876017, -976.4249613174738, -783.2300676611325, -1336.2198558857638, -572.8908724677977, -976.3656697958959, -148.39069937331078, -992.5012237297756, -765.1509036953755, -993.3044819232462, -867.6415314632783, 79.07793944749554, -27.942043479627074, -1007.3759292857557, -923.3821582874943, -796.0596942562537, -557.0286432086455, -500.49397440184964, -728.8183490695575, 9.673016611699591, 131.50472985374188, 50.76498030291128, -1015.1936389997878, -922.3409841964367, -864.9920610286565, -168.6465131435513, -126.10208899145135, -608.5926430739108, -273.45385427342416, -262.41969458053615, -872.8003995801745, 96.67330579551925, 349.8147832457911, -1270.1832600041232, -636.2028930836923, -517.42873232629, -724.7340570974333, -1131.610058318846, -903.0747301417886, -785.6000342560186, -825.4122207955858, 107.05274328295741, -781.6708555927956, -575.2051189458253, -1061.9377223272127, -688.3149123217623, -787.2661993288162, -525.6107441789111, -847.1346409271307, -602.6773415820021, -115.3325537067169, -527.1563220719528, -184.16835691376198, -789.4807182040281, -984.427277313351, -129.67196392902275, -1162.6927792485365, -92.86569335269712, 234.0592847422447, -577.7645630644543, -130.5471470520003, -136.99497612933658, -1003.8426100541346, -538.9130756000375, -883.1637576864224, -340.71705705299564, -875.5887892100457, -277.0203246934043, -133.03402812753455, -600.4014050511693, 163.24087806841322, -647.7735578180564, -78.0991689666381, -933.1101304354227, -744.6166042310094, 43.20948851090053, -177.42133323591224, -258.7304896848203, -549.8290264793297, -427.6486119110022, -534.63025175277, -1042.2390372107168, -741.3850868185883, 196.69921104267684, 188.55506849354586, -589.9128345011579, -777.0792080134868, -872.2697899628124, -510.3336529960354, -638.6798752960656, -555.2615831747305, -564.0327575299176, -780.3302159446936, -160.28761179077065, -774.6466075968079, 67.787700130723, 28.2711027951154, -1010.4584607430048, -859.3288591256173, -420.0481865981868, -696.3062217615292, -585.5540976907324, -1131.73556818648, -457.16155991248314, -371.9917779708281, -19.956314003293365, -914.7782998836051, -72.0240482557628, -307.66454864207213, 76.45442049782393, -444.3558910690692, -887.3062500339009, -676.6727833386049, -89.77052682553855, -452.1098934363396, -815.7343072464217], "policy_predator_policy_reward": [1100.8612063548746, 619.9689172706377, 1234.7883115936306, 846.9681667665445, 448.1614160035638, 638.2243339933044, 1186.8442570211346, 785.2851698690405, 764.9923565887505, 1040.3116545362952, 917.2044373939993, 1028.9265921222284, 643.3470054441749, 767.3874549007724, 1094.5652609245078, 740.0272650541131, 1299.5774638546106, 1197.143246253471, 587.131133770448, 510.97957385330244, 417.23568785885834, 1115.5078745913495, 1203.8209043232519, 381.394545016994, 1212.3661616316451, 566.5715242160076, 975.3423020333214, 527.1698539983179, 503.71203092159135, 439.432461594242, 601.4157172055228, 718.102189338857, 189.47090422612646, 1007.2993923138182, 248.34783911388962, 360.54801657674597, 1108.7674020641864, 794.5379615348677, 886.6515413374078, 1113.913194505549, 1028.0481962225335, 839.7872874815878, 695.8204762895352, 1176.5951186068169, 689.2991312320355, 934.5582372569538, 999.2897240245383, 1223.0543417676029, 725.268889559266, 589.1249730205166, 993.7049218979464, 997.9567830449963, 631.2633164991483, 1022.3633316487832, 998.5636721546159, 506.51199291970465, 425.58493913539326, 707.8955263819759, 538.6613500874423, 995.1176955480107, 828.1852721477069, 359.6036582666028, 771.3796162908918, 516.052731169797, 1019.209258442265, 636.9295687869245, 0.8046056508260161, 7.80199378816456, 1158.3276894325252, 679.2755457196427, 883.7143327493363, 597.5444228958753, 742.0616303044861, 505.82261828581755, 646.6087086694611, 609.7661455229497, 693.7407901085608, 466.56131258690044, 815.2474751046897, 1099.3090323097376, 681.4130791789598, 614.0335355113243, 402.20578463186826, 488.7355030847274, 642.7907388631488, 977.224961317474, 795.1520659355098, 1336.2198558857638, 574.690872467798, 982.2656697958961, 440.9752176811905, 988.0963338410404, 771.589661258002, 993.2010999231928, 810.4367274089178, 609.7718772613174, 804.276034485624, 949.6151407133755, 906.3479013453987, 943.623581320675, 478.2852451184645, 663.2493897842025, 181.3405591251601, 757.404773332698, 137.03015394274962, 206.4892239545347, 1015.1936389997878, 925.1867457197338, 235.2948494473391, 888.261501341832, 521.7999739828176, 645.8062587437108, 276.51777307913216, 489.9386951572707, 765.5751678026324, 735.8412939353988, 1201.0898569278056, 162.41550565566655, 633.7624565710651, 759.3441909942502, 707.5302214716212, 1157.320989108484, 885.0775105543802, 1012.6068199604529, 789.9301366243923, 482.89808564415193, 782.9708555927956, 654.7051189458259, 1061.9068461896682, 714.6077752492918, 780.3322284280165, 798.4461681196645, 814.3294896073859, 851.947008963803, 516.335160946659, 539.2463873021627, 808.7972190233814, 248.40851833802782, 548.9047365354207, 660.4633216632167, 1162.6817834122398, 397.99526441024625, 275.766868037551, 535.6163071329642, 276.49889604996713, 360.72070362700833, 1003.8426100541346, 561.0467379337656, 755.7781299144265, 619.2787156907012, 908.2008237827187, 428.5446022085282, 295.6284785402563, 611.9003518645668, 215.90612596222107, 573.691642123148, 901.3486350811341, 146.16263284725747, 507.0095264295694, 628.2417241157927, 396.6481788015355, 485.37014722270607, 620.4809276889783, 515.5979763805834, 549.9429298779547, 1042.4390372107168, 685.0941745939666, 498.08279449811306, 581.4115759519092, 444.0719777188654, 783.5792080134883, 879.4697899628125, 652.481634302262, 706.693973092592, 705.5026586914206, 520.3316764756078, 779.1525145912987, 379.61601424157715, 746.650676347858, 292.1295260346944, 867.6503581213137, 903.6301479328378, 942.5026790578704, 363.6947055181044, 701.8271543913446, 902.6839272643922, 1119.0997995996202, 799.840089602661, 170.28689222658804, 553.0677894176303, 808.377460441796, 860.6901092861284, 445.3845437805589, 107.97820512513022, 463.6426876334727, 895.0182368848665, 689.5727833386056, 156.9039838464144, 524.8186502623113, 813.4911913608969]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.927592440429418, "mean_inference_ms": 7.1454391150967105, "mean_action_processing_ms": 2.4877683333348717, "mean_env_wait_ms": 17.074894429075627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015402078628540039, "StateBufferConnector_ms": 0.015892744064331055, "ViewRequirementAgentConnector_ms": 0.20235681533813477}, "num_episodes": 13, "episode_return_max": 789.0931481062659, "episode_return_min": -0.5893378023913964, "episode_return_mean": 224.29184233620583, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 945888, "num_agent_steps_trained": 945888, "num_env_steps_sampled": 236472, "num_env_steps_trained": 236472, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 145.76170598410656, "num_env_steps_trained_throughput_per_sec": 145.76170598410656, "timesteps_total": 236472, "num_env_steps_sampled_lifetime": 236472, "num_agent_steps_sampled_lifetime": 945888, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 945888, "timers": {"training_iteration_time_ms": 26611.849, "restore_workers_time_ms": 0.023, "training_step_time_ms": 26611.363, "sample_time_ms": 3107.543, "learn_time_ms": 23482.878, "learn_throughput": 170.678, "synch_weights_time_ms": 17.605}, "counters": {"num_env_steps_sampled": 236472, "num_env_steps_trained": 236472, "num_agent_steps_sampled": 945888, "num_agent_steps_trained": 945888}, "done": false, "training_iteration": 59, "trial_id": "7f713_00000", "date": "2024-08-23_10-13-16", "timestamp": 1724388196, "time_this_iter_s": 27.5444917678833, "time_total_s": 1594.7849798202515, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737bd160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1594.7849798202515, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 39.31794871794872, "ram_util_percent": 83.23846153846155}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.22083141286537, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.056867690818019, "policy_loss": -0.009891631017148336, "vf_loss": 7.064938211693335, "vf_explained_var": 0.6890946954646439, "kl": 0.00910550945527142, "entropy": 0.6933309505856227, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 56228.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.472600311450858, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 6.850631244094283, "policy_loss": -0.00846780896650026, "vf_loss": 6.858693600710107, "vf_explained_var": 0.3224166367419813, "kl": 0.008109596610148116, "entropy": 0.42956075381349634, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 56228.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 240480, "num_env_steps_trained": 240480, "num_agent_steps_sampled": 961920, "num_agent_steps_trained": 961920}, "env_runners": {"episode_reward_max": 789.0931481062659, "episode_reward_min": 4.440892098500626e-15, "episode_reward_mean": 243.2739612084223, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1336.2198558857638, "predator_policy": 0.8046056508260161}, "policy_reward_max": {"prey_policy": 349.8147832457911, "predator_policy": 1336.2198558857638}, "policy_reward_mean": {"prey_policy": -539.5008243874094, "predator_policy": 661.1378049916208}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.22743986951363, 628.3833419264582, 316.53753057084225, 254.3976427176724, 347.59126781355513, 0.3889089286925047, 3.400000000000003, 9.899999999999995, 2.388108441871444, 112.15143811056294, 162.44183777725817, 43.23975292066437, 4.440892098500626e-15, 176.76704814877058, 167.7, 447.46175619601433, 25.600000000000026, 134.40930056033258, 324.53906253973093, 0.7000000000000006, 79.19999999999978, 182.26002028721953, 73.06448014824544, 343.4372893839803, 14.267258479271153, 463.00745871476636, 526.3251403372304, 80.9385960157337, 130.29088803718906, 16.738034375544974, 11.921998274377515, 7.6999999999999975, 288.1796284191438, 6.335375562571603, 631.6450126544537, 718.5732024336153, 130.52963012232647, 84.01201729217006, 219.5999999999999, 525.7890880539379, 2.845761523296968, 89.91777661696327, 432.91150066116614, 230.5829193824437, 725.289367953376, 443.136885825138, 239.47502215533177, 8.507095163825237, 209.00956611702665, 554.4687447559186, 80.80000000000003, 26.261986789985286, 265.90145303995496, 216.46451606205207, 413.09267247015197, 83.55666224361931, 95.26881695626271, 305.118575221252, 467.6778968483049, 369.67747649563717, 22.13366233372909, 151.17603086570693, 184.13631208779586, 174.09339722611855, 305.0650883357239, 36.30196852633312, 433.84413482525497, 445.8665031035116, 158.60126567922944, 15.512678125181633, 638.4910933161713, 624.1257876631619, 13.699999999999976, 210.16207910275057, 106.53999446237846, 218.15070109741032, 331.9212949164689, 789.0931481062659, 26.820338852170714, 322.6507622034735, 330.04276110331307, 331.4065896700973, 682.2652215885594, 322.1526207614392, 26.998783415369687, 80.03345702087661, 70.46564094044234, 168.61027585053503, 242.53606136231335, 43.221868919216014, 403.3, 775.8212724763523, 429.128520811819, 667.2849683578743, 136.37042042196472, 80.32159985912163, 85.90515171315414, 409.38553865740937, 340.59088164513395, 341.16399404297647], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-975.3950459814926, -326.8896701806332, 246.3634087444001, -561.1245593337758, -626.792334386869, -376.18804158666427, 69.00673678258795, -1011.3793906048594, -252.0858365261478, -9.218751350934786, -1107.9674020641867, -794.9490526061752, -883.251541337408, -1113.913194505549, -1028.0481962225335, -829.8872874815869, -693.4323678476638, -1176.5951186068169, -562.2416870531046, -949.4642433253206, -832.4602057607952, -1227.4420222540862, -680.1287504920831, -591.0253591670355, -993.7049218979464, -997.9567830449963, -451.7109021741902, -1025.1486978249682, -998.5636721546159, -338.81199291970427, -24.02539714333277, -661.9933121780227, -537.0613500874421, -971.11769554801, -767.303592199968, -286.076037654005, -160.12015013297696, -802.7731347879786, -1019.209258442265, -636.2295687869242, 39.09539434917427, 31.49800621183561, -1158.4701698177562, -496.87304504719043, -796.9782882616125, -611.2159872353476, -218.5119364680953, -685.9350227382263, -648.3834784567421, -593.7241172563977, 181.82436800307386, -879.1190119837684, -894.265756480664, -493.9656105965258, -630.6744831632246, -583.8335355113231, -278.2866870396399, -482.363712639765, -626.8527044876017, -976.4249613174738, -783.2300676611325, -1336.2198558857638, -572.8908724677977, -976.3656697958959, -148.39069937331078, -992.5012237297756, -765.1509036953755, -993.3044819232462, -867.6415314632783, 79.07793944749554, -27.942043479627074, -1007.3759292857557, -923.3821582874943, -796.0596942562537, -557.0286432086455, -500.49397440184964, -728.8183490695575, 9.673016611699591, 131.50472985374188, 50.76498030291128, -1015.1936389997878, -922.3409841964367, -864.9920610286565, -168.6465131435513, -126.10208899145135, -608.5926430739108, -273.45385427342416, -262.41969458053615, -872.8003995801745, 96.67330579551925, 349.8147832457911, -1270.1832600041232, -636.2028930836923, -517.42873232629, -724.7340570974333, -1131.610058318846, -903.0747301417886, -785.6000342560186, -825.4122207955858, 107.05274328295741, -781.6708555927956, -575.2051189458253, -1061.9377223272127, -688.3149123217623, -787.2661993288162, -525.6107441789111, -847.1346409271307, -602.6773415820021, -115.3325537067169, -527.1563220719528, -184.16835691376198, -789.4807182040281, -984.427277313351, -129.67196392902275, -1162.6927792485365, -92.86569335269712, 234.0592847422447, -577.7645630644543, -130.5471470520003, -136.99497612933658, -1003.8426100541346, -538.9130756000375, -883.1637576864224, -340.71705705299564, -875.5887892100457, -277.0203246934043, -133.03402812753455, -600.4014050511693, 163.24087806841322, -647.7735578180564, -78.0991689666381, -933.1101304354227, -744.6166042310094, 43.20948851090053, -177.42133323591224, -258.7304896848203, -549.8290264793297, -427.6486119110022, -534.63025175277, -1042.2390372107168, -741.3850868185883, 196.69921104267684, 188.55506849354586, -589.9128345011579, -777.0792080134868, -872.2697899628124, -510.3336529960354, -638.6798752960656, -555.2615831747305, -564.0327575299176, -780.3302159446936, -160.28761179077065, -774.6466075968079, 67.787700130723, 28.2711027951154, -1010.4584607430048, -859.3288591256173, -420.0481865981868, -696.3062217615292, -585.5540976907324, -1131.73556818648, -457.16155991248314, -371.9917779708281, -19.956314003293365, -914.7782998836051, -72.0240482557628, -307.66454864207213, 76.45442049782393, -444.3558910690692, -887.3062500339009, -676.6727833386049, -89.77052682553855, -452.1098934363396, -815.7343072464217, -545.7711463168638, -439.78928013677177, -76.08530407304846, -577.6138067306891, -354.18744750376055, -904.8346481406646, 268.58356144626714, -595.2759337150753, 272.7764581178084, -673.9262717864808, -832.078086063456, -142.175258636786, 276.7760666488728, -906.2427407047837, -50.887860493967004, -856.5020001176629, -476.4942828703811, -644.8236949660887, -582.9130080895723, -667.3660107263709, 269.5331653756915, 33.668262372380596, -333.82530624077094, -209.22579605619882, -841.56079149146, -552.5253237234951], "policy_predator_policy_reward": [975.3423020333214, 527.1698539983179, 503.71203092159135, 439.432461594242, 601.4157172055228, 718.102189338857, 189.47090422612646, 1007.2993923138182, 248.34783911388962, 360.54801657674597, 1108.7674020641864, 794.5379615348677, 886.6515413374078, 1113.913194505549, 1028.0481962225335, 839.7872874815878, 695.8204762895352, 1176.5951186068169, 689.2991312320355, 934.5582372569538, 999.2897240245383, 1223.0543417676029, 725.268889559266, 589.1249730205166, 993.7049218979464, 997.9567830449963, 631.2633164991483, 1022.3633316487832, 998.5636721546159, 506.51199291970465, 425.58493913539326, 707.8955263819759, 538.6613500874423, 995.1176955480107, 828.1852721477069, 359.6036582666028, 771.3796162908918, 516.052731169797, 1019.209258442265, 636.9295687869245, 0.8046056508260161, 7.80199378816456, 1158.3276894325252, 679.2755457196427, 883.7143327493363, 597.5444228958753, 742.0616303044861, 505.82261828581755, 646.6087086694611, 609.7661455229497, 693.7407901085608, 466.56131258690044, 815.2474751046897, 1099.3090323097376, 681.4130791789598, 614.0335355113243, 402.20578463186826, 488.7355030847274, 642.7907388631488, 977.224961317474, 795.1520659355098, 1336.2198558857638, 574.690872467798, 982.2656697958961, 440.9752176811905, 988.0963338410404, 771.589661258002, 993.2010999231928, 810.4367274089178, 609.7718772613174, 804.276034485624, 949.6151407133755, 906.3479013453987, 943.623581320675, 478.2852451184645, 663.2493897842025, 181.3405591251601, 757.404773332698, 137.03015394274962, 206.4892239545347, 1015.1936389997878, 925.1867457197338, 235.2948494473391, 888.261501341832, 521.7999739828176, 645.8062587437108, 276.51777307913216, 489.9386951572707, 765.5751678026324, 735.8412939353988, 1201.0898569278056, 162.41550565566655, 633.7624565710651, 759.3441909942502, 707.5302214716212, 1157.320989108484, 885.0775105543802, 1012.6068199604529, 789.9301366243923, 482.89808564415193, 782.9708555927956, 654.7051189458259, 1061.9068461896682, 714.6077752492918, 780.3322284280165, 798.4461681196645, 814.3294896073859, 851.947008963803, 516.335160946659, 539.2463873021627, 808.7972190233814, 248.40851833802782, 548.9047365354207, 660.4633216632167, 1162.6817834122398, 397.99526441024625, 275.766868037551, 535.6163071329642, 276.49889604996713, 360.72070362700833, 1003.8426100541346, 561.0467379337656, 755.7781299144265, 619.2787156907012, 908.2008237827187, 428.5446022085282, 295.6284785402563, 611.9003518645668, 215.90612596222107, 573.691642123148, 901.3486350811341, 146.16263284725747, 507.0095264295694, 628.2417241157927, 396.6481788015355, 485.37014722270607, 620.4809276889783, 515.5979763805834, 549.9429298779547, 1042.4390372107168, 685.0941745939666, 498.08279449811306, 581.4115759519092, 444.0719777188654, 783.5792080134883, 879.4697899628125, 652.481634302262, 706.693973092592, 705.5026586914206, 520.3316764756078, 779.1525145912987, 379.61601424157715, 746.650676347858, 292.1295260346944, 867.6503581213137, 903.6301479328378, 942.5026790578704, 363.6947055181044, 701.8271543913446, 902.6839272643922, 1119.0997995996202, 799.840089602661, 170.28689222658804, 553.0677894176303, 808.377460441796, 860.6901092861284, 445.3845437805589, 107.97820512513022, 463.6426876334727, 895.0182368848665, 689.5727833386056, 156.9039838464144, 524.8186502623113, 813.4911913608969, 545.7711463168638, 608.3995559873064, 313.1428260174287, 583.0923461486213, 384.9093164229806, 917.3346481406646, 71.93481407894112, 658.0575581898694, 573.8076582577125, 603.1634278873134, 819.2721544634666, 584.1097110485966, 783.4663013002977, 513.2853411134901, 209.07352334388148, 834.6867576897157, 480.16440198265474, 721.4751757129368, 676.8291328578745, 659.3550376712254, 96.90578721999053, 9.278323689344637, 84.90045585345, 798.7415280886579, 833.0658046108721, 902.1843046470594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.915056078278823, "mean_inference_ms": 7.137645090740648, "mean_action_processing_ms": 2.4681647928043002, "mean_env_wait_ms": 17.096495306451928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018472909927368164, "StateBufferConnector_ms": 0.015512347221374512, "ViewRequirementAgentConnector_ms": 0.21585655212402344}, "num_episodes": 13, "episode_return_max": 789.0931481062659, "episode_return_min": 4.440892098500626e-15, "episode_return_mean": 243.2739612084223, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 961920, "num_agent_steps_trained": 961920, "num_env_steps_sampled": 240480, "num_env_steps_trained": 240480, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 151.49577042022307, "num_env_steps_trained_throughput_per_sec": 151.49577042022307, "timesteps_total": 240480, "num_env_steps_sampled_lifetime": 240480, "num_agent_steps_sampled_lifetime": 961920, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 961920, "timers": {"training_iteration_time_ms": 26585.284, "restore_workers_time_ms": 0.024, "training_step_time_ms": 26584.908, "sample_time_ms": 3085.958, "learn_time_ms": 23474.824, "learn_throughput": 170.736, "synch_weights_time_ms": 20.498}, "counters": {"num_env_steps_sampled": 240480, "num_env_steps_trained": 240480, "num_agent_steps_sampled": 961920, "num_agent_steps_trained": 961920}, "done": false, "training_iteration": 60, "trial_id": "7f713_00000", "date": "2024-08-23_10-13-43", "timestamp": 1724388223, "time_this_iter_s": 26.542272090911865, "time_total_s": 1621.3272519111633, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737a24c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1621.3272519111633, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 36.95675675675676, "ram_util_percent": 83.05675675675677}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.389388735836775, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.262957317110092, "policy_loss": -0.010930255934024457, "vf_loss": 7.272146935942311, "vf_explained_var": 0.6583632181561182, "kl": 0.008703300749597253, "entropy": 0.6741135383409167, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 57173.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.43573374596853, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 6.742577717291615, "policy_loss": -0.007126075246189007, "vf_loss": 6.749384806395838, "vf_explained_var": 0.44693708955926237, "kl": 0.006379993694154398, "entropy": 0.4214829389695768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 57173.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 244488, "num_env_steps_trained": 244488, "num_agent_steps_sampled": 977952, "num_agent_steps_trained": 977952}, "env_runners": {"episode_reward_max": 789.0931481062659, "episode_reward_min": -5.921442822897664, "episode_reward_mean": 243.03668566913365, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1336.2198558857638, "predator_policy": 0.8046056508260161}, "policy_reward_max": {"prey_policy": 349.8147832457911, "predator_policy": 1336.2198558857638}, "policy_reward_mean": {"prey_policy": -526.6207800697074, "predator_policy": 648.1391229042746}, "custom_metrics": {}, "hist_stats": {"episode_reward": [2.388108441871444, 112.15143811056294, 162.44183777725817, 43.23975292066437, 4.440892098500626e-15, 176.76704814877058, 167.7, 447.46175619601433, 25.600000000000026, 134.40930056033258, 324.53906253973093, 0.7000000000000006, 79.19999999999978, 182.26002028721953, 73.06448014824544, 343.4372893839803, 14.267258479271153, 463.00745871476636, 526.3251403372304, 80.9385960157337, 130.29088803718906, 16.738034375544974, 11.921998274377515, 7.6999999999999975, 288.1796284191438, 6.335375562571603, 631.6450126544537, 718.5732024336153, 130.52963012232647, 84.01201729217006, 219.5999999999999, 525.7890880539379, 2.845761523296968, 89.91777661696327, 432.91150066116614, 230.5829193824437, 725.289367953376, 443.136885825138, 239.47502215533177, 8.507095163825237, 209.00956611702665, 554.4687447559186, 80.80000000000003, 26.261986789985286, 265.90145303995496, 216.46451606205207, 413.09267247015197, 83.55666224361931, 95.26881695626271, 305.118575221252, 467.6778968483049, 369.67747649563717, 22.13366233372909, 151.17603086570693, 184.13631208779586, 174.09339722611855, 305.0650883357239, 36.30196852633312, 433.84413482525497, 445.8665031035116, 158.60126567922944, 15.512678125181633, 638.4910933161713, 624.1257876631619, 13.699999999999976, 210.16207910275057, 106.53999446237846, 218.15070109741032, 331.9212949164689, 789.0931481062659, 26.820338852170714, 322.6507622034735, 330.04276110331307, 331.4065896700973, 682.2652215885594, 322.1526207614392, 26.998783415369687, 80.03345702087661, 70.46564094044234, 168.61027585053503, 242.53606136231335, 43.221868919216014, 403.3, 775.8212724763523, 429.128520811819, 667.2849683578743, 136.37042042196472, 80.32159985912163, 85.90515171315414, 409.38553865740937, 340.59088164513395, 341.16399404297647, 194.47967196542072, 112.73356942063475, 104.88978480679958, -5.921442822897664, 152.18148039847017, 548.6351562204761, 9.859971988330944, 620.2403859206362], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-693.4323678476638, -1176.5951186068169, -562.2416870531046, -949.4642433253206, -832.4602057607952, -1227.4420222540862, -680.1287504920831, -591.0253591670355, -993.7049218979464, -997.9567830449963, -451.7109021741902, -1025.1486978249682, -998.5636721546159, -338.81199291970427, -24.02539714333277, -661.9933121780227, -537.0613500874421, -971.11769554801, -767.303592199968, -286.076037654005, -160.12015013297696, -802.7731347879786, -1019.209258442265, -636.2295687869242, 39.09539434917427, 31.49800621183561, -1158.4701698177562, -496.87304504719043, -796.9782882616125, -611.2159872353476, -218.5119364680953, -685.9350227382263, -648.3834784567421, -593.7241172563977, 181.82436800307386, -879.1190119837684, -894.265756480664, -493.9656105965258, -630.6744831632246, -583.8335355113231, -278.2866870396399, -482.363712639765, -626.8527044876017, -976.4249613174738, -783.2300676611325, -1336.2198558857638, -572.8908724677977, -976.3656697958959, -148.39069937331078, -992.5012237297756, -765.1509036953755, -993.3044819232462, -867.6415314632783, 79.07793944749554, -27.942043479627074, -1007.3759292857557, -923.3821582874943, -796.0596942562537, -557.0286432086455, -500.49397440184964, -728.8183490695575, 9.673016611699591, 131.50472985374188, 50.76498030291128, -1015.1936389997878, -922.3409841964367, -864.9920610286565, -168.6465131435513, -126.10208899145135, -608.5926430739108, -273.45385427342416, -262.41969458053615, -872.8003995801745, 96.67330579551925, 349.8147832457911, -1270.1832600041232, -636.2028930836923, -517.42873232629, -724.7340570974333, -1131.610058318846, -903.0747301417886, -785.6000342560186, -825.4122207955858, 107.05274328295741, -781.6708555927956, -575.2051189458253, -1061.9377223272127, -688.3149123217623, -787.2661993288162, -525.6107441789111, -847.1346409271307, -602.6773415820021, -115.3325537067169, -527.1563220719528, -184.16835691376198, -789.4807182040281, -984.427277313351, -129.67196392902275, -1162.6927792485365, -92.86569335269712, 234.0592847422447, -577.7645630644543, -130.5471470520003, -136.99497612933658, -1003.8426100541346, -538.9130756000375, -883.1637576864224, -340.71705705299564, -875.5887892100457, -277.0203246934043, -133.03402812753455, -600.4014050511693, 163.24087806841322, -647.7735578180564, -78.0991689666381, -933.1101304354227, -744.6166042310094, 43.20948851090053, -177.42133323591224, -258.7304896848203, -549.8290264793297, -427.6486119110022, -534.63025175277, -1042.2390372107168, -741.3850868185883, 196.69921104267684, 188.55506849354586, -589.9128345011579, -777.0792080134868, -872.2697899628124, -510.3336529960354, -638.6798752960656, -555.2615831747305, -564.0327575299176, -780.3302159446936, -160.28761179077065, -774.6466075968079, 67.787700130723, 28.2711027951154, -1010.4584607430048, -859.3288591256173, -420.0481865981868, -696.3062217615292, -585.5540976907324, -1131.73556818648, -457.16155991248314, -371.9917779708281, -19.956314003293365, -914.7782998836051, -72.0240482557628, -307.66454864207213, 76.45442049782393, -444.3558910690692, -887.3062500339009, -676.6727833386049, -89.77052682553855, -452.1098934363396, -815.7343072464217, -545.7711463168638, -439.78928013677177, -76.08530407304846, -577.6138067306891, -354.18744750376055, -904.8346481406646, 268.58356144626714, -595.2759337150753, 272.7764581178084, -673.9262717864808, -832.078086063456, -142.175258636786, 276.7760666488728, -906.2427407047837, -50.887860493967004, -856.5020001176629, -476.4942828703811, -644.8236949660887, -582.9130080895723, -667.3660107263709, 269.5331653756915, 33.668262372380596, -333.82530624077094, -209.22579605619882, -841.56079149146, -552.5253237234951, 20.953460017813946, -959.4743404007417, -854.5277393843181, -267.05035286579505, -719.3720725450629, -55.42719697651923, -843.8046845138177, -785.1969132748103, -860.597278660995, -34.369319125123205, 215.63999045399646, -70.81192258656446, -592.7391605182967, -538.9256609592419, 65.85547667675698, -725.8635804387259], "policy_predator_policy_reward": [695.8204762895352, 1176.5951186068169, 689.2991312320355, 934.5582372569538, 999.2897240245383, 1223.0543417676029, 725.268889559266, 589.1249730205166, 993.7049218979464, 997.9567830449963, 631.2633164991483, 1022.3633316487832, 998.5636721546159, 506.51199291970465, 425.58493913539326, 707.8955263819759, 538.6613500874423, 995.1176955480107, 828.1852721477069, 359.6036582666028, 771.3796162908918, 516.052731169797, 1019.209258442265, 636.9295687869245, 0.8046056508260161, 7.80199378816456, 1158.3276894325252, 679.2755457196427, 883.7143327493363, 597.5444228958753, 742.0616303044861, 505.82261828581755, 646.6087086694611, 609.7661455229497, 693.7407901085608, 466.56131258690044, 815.2474751046897, 1099.3090323097376, 681.4130791789598, 614.0335355113243, 402.20578463186826, 488.7355030847274, 642.7907388631488, 977.224961317474, 795.1520659355098, 1336.2198558857638, 574.690872467798, 982.2656697958961, 440.9752176811905, 988.0963338410404, 771.589661258002, 993.2010999231928, 810.4367274089178, 609.7718772613174, 804.276034485624, 949.6151407133755, 906.3479013453987, 943.623581320675, 478.2852451184645, 663.2493897842025, 181.3405591251601, 757.404773332698, 137.03015394274962, 206.4892239545347, 1015.1936389997878, 925.1867457197338, 235.2948494473391, 888.261501341832, 521.7999739828176, 645.8062587437108, 276.51777307913216, 489.9386951572707, 765.5751678026324, 735.8412939353988, 1201.0898569278056, 162.41550565566655, 633.7624565710651, 759.3441909942502, 707.5302214716212, 1157.320989108484, 885.0775105543802, 1012.6068199604529, 789.9301366243923, 482.89808564415193, 782.9708555927956, 654.7051189458259, 1061.9068461896682, 714.6077752492918, 780.3322284280165, 798.4461681196645, 814.3294896073859, 851.947008963803, 516.335160946659, 539.2463873021627, 808.7972190233814, 248.40851833802782, 548.9047365354207, 660.4633216632167, 1162.6817834122398, 397.99526441024625, 275.766868037551, 535.6163071329642, 276.49889604996713, 360.72070362700833, 1003.8426100541346, 561.0467379337656, 755.7781299144265, 619.2787156907012, 908.2008237827187, 428.5446022085282, 295.6284785402563, 611.9003518645668, 215.90612596222107, 573.691642123148, 901.3486350811341, 146.16263284725747, 507.0095264295694, 628.2417241157927, 396.6481788015355, 485.37014722270607, 620.4809276889783, 515.5979763805834, 549.9429298779547, 1042.4390372107168, 685.0941745939666, 498.08279449811306, 581.4115759519092, 444.0719777188654, 783.5792080134883, 879.4697899628125, 652.481634302262, 706.693973092592, 705.5026586914206, 520.3316764756078, 779.1525145912987, 379.61601424157715, 746.650676347858, 292.1295260346944, 867.6503581213137, 903.6301479328378, 942.5026790578704, 363.6947055181044, 701.8271543913446, 902.6839272643922, 1119.0997995996202, 799.840089602661, 170.28689222658804, 553.0677894176303, 808.377460441796, 860.6901092861284, 445.3845437805589, 107.97820512513022, 463.6426876334727, 895.0182368848665, 689.5727833386056, 156.9039838464144, 524.8186502623113, 813.4911913608969, 545.7711463168638, 608.3995559873064, 313.1428260174287, 583.0923461486213, 384.9093164229806, 917.3346481406646, 71.93481407894112, 658.0575581898694, 573.8076582577125, 603.1634278873134, 819.2721544634666, 584.1097110485966, 783.4663013002977, 513.2853411134901, 209.07352334388148, 834.6867576897157, 480.16440198265474, 721.4751757129368, 676.8291328578745, 659.3550376712254, 96.90578721999053, 9.278323689344637, 84.90045585345, 798.7415280886579, 833.0658046108721, 902.1843046470594, 211.71641043979284, 921.2841419085562, 750.2393306854108, 484.0723309853358, 725.8575811736558, 153.83147315472712, 870.0584226030754, 753.0217323626547, 195.78672765304088, 851.361350531549, 60.134110876240854, 343.67297747680345, 594.3991325066276, 547.1256609592422, 669.339143371147, 610.909346311458]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.892891676970061, "mean_inference_ms": 7.127178252939461, "mean_action_processing_ms": 2.4697183922312256, "mean_env_wait_ms": 17.069946358702634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009765267372131348, "StateBufferConnector_ms": 0.01550447940826416, "ViewRequirementAgentConnector_ms": 0.2128748893737793}, "num_episodes": 8, "episode_return_max": 789.0931481062659, "episode_return_min": -5.921442822897664, "episode_return_mean": 243.03668566913365, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 977952, "num_agent_steps_trained": 977952, "num_env_steps_sampled": 244488, "num_env_steps_trained": 244488, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 144.62643539782883, "num_env_steps_trained_throughput_per_sec": 144.62643539782883, "timesteps_total": 244488, "num_env_steps_sampled_lifetime": 244488, "num_agent_steps_sampled_lifetime": 977952, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 977952, "timers": {"training_iteration_time_ms": 26790.748, "restore_workers_time_ms": 0.024, "training_step_time_ms": 26790.394, "sample_time_ms": 3281.898, "learn_time_ms": 23484.71, "learn_throughput": 170.664, "synch_weights_time_ms": 19.881}, "counters": {"num_env_steps_sampled": 244488, "num_env_steps_trained": 244488, "num_agent_steps_sampled": 977952, "num_agent_steps_trained": 977952}, "done": false, "training_iteration": 61, "trial_id": "7f713_00000", "date": "2024-08-23_10-14-11", "timestamp": 1724388251, "time_this_iter_s": 27.76305913925171, "time_total_s": 1649.090311050415, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x173805160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1649.090311050415, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 40.5025641025641, "ram_util_percent": 83.10000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.277684342924246, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 7.060235828823513, "policy_loss": -0.007844875970111282, "vf_loss": 7.066638209327819, "vf_explained_var": 0.6591861025366202, "kl": 0.007212478102051786, "entropy": 0.6474812871880001, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 58118.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.230945014196728, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 6.860520127715257, "policy_loss": -0.01070751698697528, "vf_loss": 6.870771307667727, "vf_explained_var": 0.3251103968216629, "kl": 0.009126854723408108, "entropy": 0.39725036860773805, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 58118.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 248496, "num_env_steps_trained": 248496, "num_agent_steps_sampled": 993984, "num_agent_steps_trained": 993984}, "env_runners": {"episode_reward_max": 789.0931481062659, "episode_reward_min": -5.921442822897664, "episode_reward_mean": 254.22544099119622, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1336.2198558857638, "predator_policy": 0.8046056508260161}, "policy_reward_max": {"prey_policy": 396.04603445922703, "predator_policy": 1336.2198558857638}, "policy_reward_mean": {"prey_policy": -494.66001406106164, "predator_policy": 621.7727345566601}, "custom_metrics": {}, "hist_stats": {"episode_reward": [176.76704814877058, 167.7, 447.46175619601433, 25.600000000000026, 134.40930056033258, 324.53906253973093, 0.7000000000000006, 79.19999999999978, 182.26002028721953, 73.06448014824544, 343.4372893839803, 14.267258479271153, 463.00745871476636, 526.3251403372304, 80.9385960157337, 130.29088803718906, 16.738034375544974, 11.921998274377515, 7.6999999999999975, 288.1796284191438, 6.335375562571603, 631.6450126544537, 718.5732024336153, 130.52963012232647, 84.01201729217006, 219.5999999999999, 525.7890880539379, 2.845761523296968, 89.91777661696327, 432.91150066116614, 230.5829193824437, 725.289367953376, 443.136885825138, 239.47502215533177, 8.507095163825237, 209.00956611702665, 554.4687447559186, 80.80000000000003, 26.261986789985286, 265.90145303995496, 216.46451606205207, 413.09267247015197, 83.55666224361931, 95.26881695626271, 305.118575221252, 467.6778968483049, 369.67747649563717, 22.13366233372909, 151.17603086570693, 184.13631208779586, 174.09339722611855, 305.0650883357239, 36.30196852633312, 433.84413482525497, 445.8665031035116, 158.60126567922944, 15.512678125181633, 638.4910933161713, 624.1257876631619, 13.699999999999976, 210.16207910275057, 106.53999446237846, 218.15070109741032, 331.9212949164689, 789.0931481062659, 26.820338852170714, 322.6507622034735, 330.04276110331307, 331.4065896700973, 682.2652215885594, 322.1526207614392, 26.998783415369687, 80.03345702087661, 70.46564094044234, 168.61027585053503, 242.53606136231335, 43.221868919216014, 403.3, 775.8212724763523, 429.128520811819, 667.2849683578743, 136.37042042196472, 80.32159985912163, 85.90515171315414, 409.38553865740937, 340.59088164513395, 341.16399404297647, 194.47967196542072, 112.73356942063475, 104.88978480679958, -5.921442822897664, 152.18148039847017, 548.6351562204761, 9.859971988330944, 620.2403859206362, 276.29999999999944, 559.9161362372164, 74.0, 98.29999999999986, 430.58053321939644], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-451.7109021741902, -1025.1486978249682, -998.5636721546159, -338.81199291970427, -24.02539714333277, -661.9933121780227, -537.0613500874421, -971.11769554801, -767.303592199968, -286.076037654005, -160.12015013297696, -802.7731347879786, -1019.209258442265, -636.2295687869242, 39.09539434917427, 31.49800621183561, -1158.4701698177562, -496.87304504719043, -796.9782882616125, -611.2159872353476, -218.5119364680953, -685.9350227382263, -648.3834784567421, -593.7241172563977, 181.82436800307386, -879.1190119837684, -894.265756480664, -493.9656105965258, -630.6744831632246, -583.8335355113231, -278.2866870396399, -482.363712639765, -626.8527044876017, -976.4249613174738, -783.2300676611325, -1336.2198558857638, -572.8908724677977, -976.3656697958959, -148.39069937331078, -992.5012237297756, -765.1509036953755, -993.3044819232462, -867.6415314632783, 79.07793944749554, -27.942043479627074, -1007.3759292857557, -923.3821582874943, -796.0596942562537, -557.0286432086455, -500.49397440184964, -728.8183490695575, 9.673016611699591, 131.50472985374188, 50.76498030291128, -1015.1936389997878, -922.3409841964367, -864.9920610286565, -168.6465131435513, -126.10208899145135, -608.5926430739108, -273.45385427342416, -262.41969458053615, -872.8003995801745, 96.67330579551925, 349.8147832457911, -1270.1832600041232, -636.2028930836923, -517.42873232629, -724.7340570974333, -1131.610058318846, -903.0747301417886, -785.6000342560186, -825.4122207955858, 107.05274328295741, -781.6708555927956, -575.2051189458253, -1061.9377223272127, -688.3149123217623, -787.2661993288162, -525.6107441789111, -847.1346409271307, -602.6773415820021, -115.3325537067169, -527.1563220719528, -184.16835691376198, -789.4807182040281, -984.427277313351, -129.67196392902275, -1162.6927792485365, -92.86569335269712, 234.0592847422447, -577.7645630644543, -130.5471470520003, -136.99497612933658, -1003.8426100541346, -538.9130756000375, -883.1637576864224, -340.71705705299564, -875.5887892100457, -277.0203246934043, -133.03402812753455, -600.4014050511693, 163.24087806841322, -647.7735578180564, -78.0991689666381, -933.1101304354227, -744.6166042310094, 43.20948851090053, -177.42133323591224, -258.7304896848203, -549.8290264793297, -427.6486119110022, -534.63025175277, -1042.2390372107168, -741.3850868185883, 196.69921104267684, 188.55506849354586, -589.9128345011579, -777.0792080134868, -872.2697899628124, -510.3336529960354, -638.6798752960656, -555.2615831747305, -564.0327575299176, -780.3302159446936, -160.28761179077065, -774.6466075968079, 67.787700130723, 28.2711027951154, -1010.4584607430048, -859.3288591256173, -420.0481865981868, -696.3062217615292, -585.5540976907324, -1131.73556818648, -457.16155991248314, -371.9917779708281, -19.956314003293365, -914.7782998836051, -72.0240482557628, -307.66454864207213, 76.45442049782393, -444.3558910690692, -887.3062500339009, -676.6727833386049, -89.77052682553855, -452.1098934363396, -815.7343072464217, -545.7711463168638, -439.78928013677177, -76.08530407304846, -577.6138067306891, -354.18744750376055, -904.8346481406646, 268.58356144626714, -595.2759337150753, 272.7764581178084, -673.9262717864808, -832.078086063456, -142.175258636786, 276.7760666488728, -906.2427407047837, -50.887860493967004, -856.5020001176629, -476.4942828703811, -644.8236949660887, -582.9130080895723, -667.3660107263709, 269.5331653756915, 33.668262372380596, -333.82530624077094, -209.22579605619882, -841.56079149146, -552.5253237234951, 20.953460017813946, -959.4743404007417, -854.5277393843181, -267.05035286579505, -719.3720725450629, -55.42719697651923, -843.8046845138177, -785.1969132748103, -860.597278660995, -34.369319125123205, 215.63999045399646, -70.81192258656446, -592.7391605182967, -538.9256609592419, 65.85547667675698, -725.8635804387259, -349.10580518929027, 60.37677483556013, -198.72941735577348, 396.04603445922703, -718.8938283474441, -456.91966057178286, -293.56442123878355, -844.2490336721654, 184.69780824168967, -91.95670888195377], "policy_predator_policy_reward": [631.2633164991483, 1022.3633316487832, 998.5636721546159, 506.51199291970465, 425.58493913539326, 707.8955263819759, 538.6613500874423, 995.1176955480107, 828.1852721477069, 359.6036582666028, 771.3796162908918, 516.052731169797, 1019.209258442265, 636.9295687869245, 0.8046056508260161, 7.80199378816456, 1158.3276894325252, 679.2755457196427, 883.7143327493363, 597.5444228958753, 742.0616303044861, 505.82261828581755, 646.6087086694611, 609.7661455229497, 693.7407901085608, 466.56131258690044, 815.2474751046897, 1099.3090323097376, 681.4130791789598, 614.0335355113243, 402.20578463186826, 488.7355030847274, 642.7907388631488, 977.224961317474, 795.1520659355098, 1336.2198558857638, 574.690872467798, 982.2656697958961, 440.9752176811905, 988.0963338410404, 771.589661258002, 993.2010999231928, 810.4367274089178, 609.7718772613174, 804.276034485624, 949.6151407133755, 906.3479013453987, 943.623581320675, 478.2852451184645, 663.2493897842025, 181.3405591251601, 757.404773332698, 137.03015394274962, 206.4892239545347, 1015.1936389997878, 925.1867457197338, 235.2948494473391, 888.261501341832, 521.7999739828176, 645.8062587437108, 276.51777307913216, 489.9386951572707, 765.5751678026324, 735.8412939353988, 1201.0898569278056, 162.41550565566655, 633.7624565710651, 759.3441909942502, 707.5302214716212, 1157.320989108484, 885.0775105543802, 1012.6068199604529, 789.9301366243923, 482.89808564415193, 782.9708555927956, 654.7051189458259, 1061.9068461896682, 714.6077752492918, 780.3322284280165, 798.4461681196645, 814.3294896073859, 851.947008963803, 516.335160946659, 539.2463873021627, 808.7972190233814, 248.40851833802782, 548.9047365354207, 660.4633216632167, 1162.6817834122398, 397.99526441024625, 275.766868037551, 535.6163071329642, 276.49889604996713, 360.72070362700833, 1003.8426100541346, 561.0467379337656, 755.7781299144265, 619.2787156907012, 908.2008237827187, 428.5446022085282, 295.6284785402563, 611.9003518645668, 215.90612596222107, 573.691642123148, 901.3486350811341, 146.16263284725747, 507.0095264295694, 628.2417241157927, 396.6481788015355, 485.37014722270607, 620.4809276889783, 515.5979763805834, 549.9429298779547, 1042.4390372107168, 685.0941745939666, 498.08279449811306, 581.4115759519092, 444.0719777188654, 783.5792080134883, 879.4697899628125, 652.481634302262, 706.693973092592, 705.5026586914206, 520.3316764756078, 779.1525145912987, 379.61601424157715, 746.650676347858, 292.1295260346944, 867.6503581213137, 903.6301479328378, 942.5026790578704, 363.6947055181044, 701.8271543913446, 902.6839272643922, 1119.0997995996202, 799.840089602661, 170.28689222658804, 553.0677894176303, 808.377460441796, 860.6901092861284, 445.3845437805589, 107.97820512513022, 463.6426876334727, 895.0182368848665, 689.5727833386056, 156.9039838464144, 524.8186502623113, 813.4911913608969, 545.7711463168638, 608.3995559873064, 313.1428260174287, 583.0923461486213, 384.9093164229806, 917.3346481406646, 71.93481407894112, 658.0575581898694, 573.8076582577125, 603.1634278873134, 819.2721544634666, 584.1097110485966, 783.4663013002977, 513.2853411134901, 209.07352334388148, 834.6867576897157, 480.16440198265474, 721.4751757129368, 676.8291328578745, 659.3550376712254, 96.90578721999053, 9.278323689344637, 84.90045585345, 798.7415280886579, 833.0658046108721, 902.1843046470594, 211.71641043979284, 921.2841419085562, 750.2393306854108, 484.0723309853358, 725.8575811736558, 153.83147315472712, 870.0584226030754, 753.0217323626547, 195.78672765304088, 851.361350531549, 60.134110876240854, 343.67297747680345, 594.3991325066276, 547.1256609592422, 669.339143371147, 610.909346311458, 370.60580518929515, 194.42322516443966, 157.1930378786385, 205.40648125512016, 718.8938283474441, 530.9196605717833, 384.2644212387844, 851.8490336721655, 60.034358421338005, 277.8050754383235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.895056101514344, "mean_inference_ms": 7.103515921835839, "mean_action_processing_ms": 2.475866500665284, "mean_env_wait_ms": 17.09350213437532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009475469589233398, "StateBufferConnector_ms": 0.01550281047821045, "ViewRequirementAgentConnector_ms": 0.21419334411621094}, "num_episodes": 5, "episode_return_max": 789.0931481062659, "episode_return_min": -5.921442822897664, "episode_return_mean": 254.22544099119622, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 993984, "num_agent_steps_trained": 993984, "num_env_steps_sampled": 248496, "num_env_steps_trained": 248496, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 145.66758893738205, "num_env_steps_trained_throughput_per_sec": 145.66758893738205, "timesteps_total": 248496, "num_env_steps_sampled_lifetime": 248496, "num_agent_steps_sampled_lifetime": 993984, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 993984, "timers": {"training_iteration_time_ms": 26686.879, "restore_workers_time_ms": 0.024, "training_step_time_ms": 26686.454, "sample_time_ms": 3159.309, "learn_time_ms": 23502.318, "learn_throughput": 170.536, "synch_weights_time_ms": 21.09}, "counters": {"num_env_steps_sampled": 248496, "num_env_steps_trained": 248496, "num_agent_steps_sampled": 993984, "num_agent_steps_trained": 993984}, "done": false, "training_iteration": 62, "trial_id": "7f713_00000", "date": "2024-08-23_10-14-38", "timestamp": 1724388278, "time_this_iter_s": 27.56514000892639, "time_total_s": 1676.6554510593414, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737a68b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1676.6554510593414, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 40.54871794871794, "ram_util_percent": 82.16410256410256}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.151479036593564, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.44831877663022, "policy_loss": -0.011445482430866273, "vf_loss": 6.458098413073827, "vf_explained_var": 0.7069091911038393, "kl": 0.008329247424093189, "entropy": 0.6759383049591509, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 59063.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.30084846637867, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 6.732532487092195, "policy_loss": -0.010507894398289776, "vf_loss": 6.7426799103065775, "vf_explained_var": 0.4054365391453738, "kl": 0.007209433837443905, "entropy": 0.3900319595816274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 59063.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 252504, "num_env_steps_trained": 252504, "num_agent_steps_sampled": 1010016, "num_agent_steps_trained": 1010016}, "env_runners": {"episode_reward_max": 836.843703915571, "episode_reward_min": -5.921442822897664, "episode_reward_mean": 262.22332074162364, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1336.2198558857638, "predator_policy": 0.8046056508260161}, "policy_reward_max": {"prey_policy": 396.04603445922703, "predator_policy": 1336.2198558857638}, "policy_reward_mean": {"prey_policy": -476.6429956814079, "predator_policy": 607.7546560522201}, "custom_metrics": {}, "hist_stats": {"episode_reward": [0.7000000000000006, 79.19999999999978, 182.26002028721953, 73.06448014824544, 343.4372893839803, 14.267258479271153, 463.00745871476636, 526.3251403372304, 80.9385960157337, 130.29088803718906, 16.738034375544974, 11.921998274377515, 7.6999999999999975, 288.1796284191438, 6.335375562571603, 631.6450126544537, 718.5732024336153, 130.52963012232647, 84.01201729217006, 219.5999999999999, 525.7890880539379, 2.845761523296968, 89.91777661696327, 432.91150066116614, 230.5829193824437, 725.289367953376, 443.136885825138, 239.47502215533177, 8.507095163825237, 209.00956611702665, 554.4687447559186, 80.80000000000003, 26.261986789985286, 265.90145303995496, 216.46451606205207, 413.09267247015197, 83.55666224361931, 95.26881695626271, 305.118575221252, 467.6778968483049, 369.67747649563717, 22.13366233372909, 151.17603086570693, 184.13631208779586, 174.09339722611855, 305.0650883357239, 36.30196852633312, 433.84413482525497, 445.8665031035116, 158.60126567922944, 15.512678125181633, 638.4910933161713, 624.1257876631619, 13.699999999999976, 210.16207910275057, 106.53999446237846, 218.15070109741032, 331.9212949164689, 789.0931481062659, 26.820338852170714, 322.6507622034735, 330.04276110331307, 331.4065896700973, 682.2652215885594, 322.1526207614392, 26.998783415369687, 80.03345702087661, 70.46564094044234, 168.61027585053503, 242.53606136231335, 43.221868919216014, 403.3, 775.8212724763523, 429.128520811819, 667.2849683578743, 136.37042042196472, 80.32159985912163, 85.90515171315414, 409.38553865740937, 340.59088164513395, 341.16399404297647, 194.47967196542072, 112.73356942063475, 104.88978480679958, -5.921442822897664, 152.18148039847017, 548.6351562204761, 9.859971988330944, 620.2403859206362, 276.29999999999944, 559.9161362372164, 74.0, 98.29999999999986, 430.58053321939644, 310.4097421025087, 224.01874150159725, 423.25951014150763, 836.843703915571, 185.20334055311594, 96.53010427329475], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1019.209258442265, -636.2295687869242, 39.09539434917427, 31.49800621183561, -1158.4701698177562, -496.87304504719043, -796.9782882616125, -611.2159872353476, -218.5119364680953, -685.9350227382263, -648.3834784567421, -593.7241172563977, 181.82436800307386, -879.1190119837684, -894.265756480664, -493.9656105965258, -630.6744831632246, -583.8335355113231, -278.2866870396399, -482.363712639765, -626.8527044876017, -976.4249613174738, -783.2300676611325, -1336.2198558857638, -572.8908724677977, -976.3656697958959, -148.39069937331078, -992.5012237297756, -765.1509036953755, -993.3044819232462, -867.6415314632783, 79.07793944749554, -27.942043479627074, -1007.3759292857557, -923.3821582874943, -796.0596942562537, -557.0286432086455, -500.49397440184964, -728.8183490695575, 9.673016611699591, 131.50472985374188, 50.76498030291128, -1015.1936389997878, -922.3409841964367, -864.9920610286565, -168.6465131435513, -126.10208899145135, -608.5926430739108, -273.45385427342416, -262.41969458053615, -872.8003995801745, 96.67330579551925, 349.8147832457911, -1270.1832600041232, -636.2028930836923, -517.42873232629, -724.7340570974333, -1131.610058318846, -903.0747301417886, -785.6000342560186, -825.4122207955858, 107.05274328295741, -781.6708555927956, -575.2051189458253, -1061.9377223272127, -688.3149123217623, -787.2661993288162, -525.6107441789111, -847.1346409271307, -602.6773415820021, -115.3325537067169, -527.1563220719528, -184.16835691376198, -789.4807182040281, -984.427277313351, -129.67196392902275, -1162.6927792485365, -92.86569335269712, 234.0592847422447, -577.7645630644543, -130.5471470520003, -136.99497612933658, -1003.8426100541346, -538.9130756000375, -883.1637576864224, -340.71705705299564, -875.5887892100457, -277.0203246934043, -133.03402812753455, -600.4014050511693, 163.24087806841322, -647.7735578180564, -78.0991689666381, -933.1101304354227, -744.6166042310094, 43.20948851090053, -177.42133323591224, -258.7304896848203, -549.8290264793297, -427.6486119110022, -534.63025175277, -1042.2390372107168, -741.3850868185883, 196.69921104267684, 188.55506849354586, -589.9128345011579, -777.0792080134868, -872.2697899628124, -510.3336529960354, -638.6798752960656, -555.2615831747305, -564.0327575299176, -780.3302159446936, -160.28761179077065, -774.6466075968079, 67.787700130723, 28.2711027951154, -1010.4584607430048, -859.3288591256173, -420.0481865981868, -696.3062217615292, -585.5540976907324, -1131.73556818648, -457.16155991248314, -371.9917779708281, -19.956314003293365, -914.7782998836051, -72.0240482557628, -307.66454864207213, 76.45442049782393, -444.3558910690692, -887.3062500339009, -676.6727833386049, -89.77052682553855, -452.1098934363396, -815.7343072464217, -545.7711463168638, -439.78928013677177, -76.08530407304846, -577.6138067306891, -354.18744750376055, -904.8346481406646, 268.58356144626714, -595.2759337150753, 272.7764581178084, -673.9262717864808, -832.078086063456, -142.175258636786, 276.7760666488728, -906.2427407047837, -50.887860493967004, -856.5020001176629, -476.4942828703811, -644.8236949660887, -582.9130080895723, -667.3660107263709, 269.5331653756915, 33.668262372380596, -333.82530624077094, -209.22579605619882, -841.56079149146, -552.5253237234951, 20.953460017813946, -959.4743404007417, -854.5277393843181, -267.05035286579505, -719.3720725450629, -55.42719697651923, -843.8046845138177, -785.1969132748103, -860.597278660995, -34.369319125123205, 215.63999045399646, -70.81192258656446, -592.7391605182967, -538.9256609592419, 65.85547667675698, -725.8635804387259, -349.10580518929027, 60.37677483556013, -198.72941735577348, 396.04603445922703, -718.8938283474441, -456.91966057178286, -293.56442123878355, -844.2490336721654, 184.69780824168967, -91.95670888195377, -286.51234260427225, -354.59215491415614, 35.83487654513648, -406.14855988550715, -83.86704178900683, -774.3852709842423, 372.4789705182516, -48.55641064218912, -336.033989108638, -300.7265351844165, -608.0379873835919, -630.7558134418242], "policy_predator_policy_reward": [1019.209258442265, 636.9295687869245, 0.8046056508260161, 7.80199378816456, 1158.3276894325252, 679.2755457196427, 883.7143327493363, 597.5444228958753, 742.0616303044861, 505.82261828581755, 646.6087086694611, 609.7661455229497, 693.7407901085608, 466.56131258690044, 815.2474751046897, 1099.3090323097376, 681.4130791789598, 614.0335355113243, 402.20578463186826, 488.7355030847274, 642.7907388631488, 977.224961317474, 795.1520659355098, 1336.2198558857638, 574.690872467798, 982.2656697958961, 440.9752176811905, 988.0963338410404, 771.589661258002, 993.2010999231928, 810.4367274089178, 609.7718772613174, 804.276034485624, 949.6151407133755, 906.3479013453987, 943.623581320675, 478.2852451184645, 663.2493897842025, 181.3405591251601, 757.404773332698, 137.03015394274962, 206.4892239545347, 1015.1936389997878, 925.1867457197338, 235.2948494473391, 888.261501341832, 521.7999739828176, 645.8062587437108, 276.51777307913216, 489.9386951572707, 765.5751678026324, 735.8412939353988, 1201.0898569278056, 162.41550565566655, 633.7624565710651, 759.3441909942502, 707.5302214716212, 1157.320989108484, 885.0775105543802, 1012.6068199604529, 789.9301366243923, 482.89808564415193, 782.9708555927956, 654.7051189458259, 1061.9068461896682, 714.6077752492918, 780.3322284280165, 798.4461681196645, 814.3294896073859, 851.947008963803, 516.335160946659, 539.2463873021627, 808.7972190233814, 248.40851833802782, 548.9047365354207, 660.4633216632167, 1162.6817834122398, 397.99526441024625, 275.766868037551, 535.6163071329642, 276.49889604996713, 360.72070362700833, 1003.8426100541346, 561.0467379337656, 755.7781299144265, 619.2787156907012, 908.2008237827187, 428.5446022085282, 295.6284785402563, 611.9003518645668, 215.90612596222107, 573.691642123148, 901.3486350811341, 146.16263284725747, 507.0095264295694, 628.2417241157927, 396.6481788015355, 485.37014722270607, 620.4809276889783, 515.5979763805834, 549.9429298779547, 1042.4390372107168, 685.0941745939666, 498.08279449811306, 581.4115759519092, 444.0719777188654, 783.5792080134883, 879.4697899628125, 652.481634302262, 706.693973092592, 705.5026586914206, 520.3316764756078, 779.1525145912987, 379.61601424157715, 746.650676347858, 292.1295260346944, 867.6503581213137, 903.6301479328378, 942.5026790578704, 363.6947055181044, 701.8271543913446, 902.6839272643922, 1119.0997995996202, 799.840089602661, 170.28689222658804, 553.0677894176303, 808.377460441796, 860.6901092861284, 445.3845437805589, 107.97820512513022, 463.6426876334727, 895.0182368848665, 689.5727833386056, 156.9039838464144, 524.8186502623113, 813.4911913608969, 545.7711463168638, 608.3995559873064, 313.1428260174287, 583.0923461486213, 384.9093164229806, 917.3346481406646, 71.93481407894112, 658.0575581898694, 573.8076582577125, 603.1634278873134, 819.2721544634666, 584.1097110485966, 783.4663013002977, 513.2853411134901, 209.07352334388148, 834.6867576897157, 480.16440198265474, 721.4751757129368, 676.8291328578745, 659.3550376712254, 96.90578721999053, 9.278323689344637, 84.90045585345, 798.7415280886579, 833.0658046108721, 902.1843046470594, 211.71641043979284, 921.2841419085562, 750.2393306854108, 484.0723309853358, 725.8575811736558, 153.83147315472712, 870.0584226030754, 753.0217323626547, 195.78672765304088, 851.361350531549, 60.134110876240854, 343.67297747680345, 594.3991325066276, 547.1256609592422, 669.339143371147, 610.909346311458, 370.60580518929515, 194.42322516443966, 157.1930378786385, 205.40648125512016, 718.8938283474441, 530.9196605717833, 384.2644212387844, 851.8490336721655, 60.034358421338005, 277.8050754383235, 590.6834961417333, 360.830743479203, 278.4062594374281, 315.926165404545, 732.421348823894, 549.0904740908596, 245.27899065330735, 267.64215338620096, 403.9360041317003, 418.0278607144736, 640.6311398058472, 694.6927652928674]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.876790296886275, "mean_inference_ms": 7.116843509858893, "mean_action_processing_ms": 2.4661216396302494, "mean_env_wait_ms": 17.072732623723397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009340763092041016, "StateBufferConnector_ms": 0.014695286750793457, "ViewRequirementAgentConnector_ms": 0.20528364181518555}, "num_episodes": 6, "episode_return_max": 836.843703915571, "episode_return_min": -5.921442822897664, "episode_return_mean": 262.22332074162364, "episodes_this_iter": 6}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1010016, "num_agent_steps_trained": 1010016, "num_env_steps_sampled": 252504, "num_env_steps_trained": 252504, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 155.61899229332494, "num_env_steps_trained_throughput_per_sec": 155.61899229332494, "timesteps_total": 252504, "num_env_steps_sampled_lifetime": 252504, "num_agent_steps_sampled_lifetime": 1010016, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1010016, "timers": {"training_iteration_time_ms": 26578.359, "restore_workers_time_ms": 0.025, "training_step_time_ms": 26577.842, "sample_time_ms": 3059.423, "learn_time_ms": 23493.995, "learn_throughput": 170.597, "synch_weights_time_ms": 20.905}, "counters": {"num_env_steps_sampled": 252504, "num_env_steps_trained": 252504, "num_agent_steps_sampled": 1010016, "num_agent_steps_trained": 1010016}, "done": false, "training_iteration": 63, "trial_id": "7f713_00000", "date": "2024-08-23_10-15-04", "timestamp": 1724388304, "time_this_iter_s": 25.807926893234253, "time_total_s": 1702.4633779525757, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17380c940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1702.4633779525757, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 35.62432432432433, "ram_util_percent": 82.03513513513512}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.92196625553111, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.565044022111035, "policy_loss": -0.008637003622278965, "vf_loss": 6.572189368898907, "vf_explained_var": 0.6840826966144421, "kl": 0.007458287387071227, "entropy": 0.6993632442106015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 60008.0, "diff_num_grad_updates_vs_sampler_policy": 489.68338323353237}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.902724405571266, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 6.442500745682489, "policy_loss": -0.004417719322912119, "vf_loss": 6.446454214671301, "vf_explained_var": 0.3995729686721923, "kl": 0.00928486779223753, "entropy": 0.41704667138044166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 60008.0, "diff_num_grad_updates_vs_sampler_policy": 489.68338323353237}}, "num_env_steps_sampled": 256512, "num_env_steps_trained": 256512, "num_agent_steps_sampled": 1026048, "num_agent_steps_trained": 1026048}, "env_runners": {"episode_reward_max": 836.843703915571, "episode_reward_min": -5.921442822897664, "episode_reward_mean": 276.15750132941366, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1336.2198558857638, "predator_policy": 9.278323689344637}, "policy_reward_max": {"prey_policy": 396.04603445922703, "predator_policy": 1336.2198558857638}, "policy_reward_mean": {"prey_policy": -467.80340656668415, "predator_policy": 605.8821572313914}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.9385960157337, 130.29088803718906, 16.738034375544974, 11.921998274377515, 7.6999999999999975, 288.1796284191438, 6.335375562571603, 631.6450126544537, 718.5732024336153, 130.52963012232647, 84.01201729217006, 219.5999999999999, 525.7890880539379, 2.845761523296968, 89.91777661696327, 432.91150066116614, 230.5829193824437, 725.289367953376, 443.136885825138, 239.47502215533177, 8.507095163825237, 209.00956611702665, 554.4687447559186, 80.80000000000003, 26.261986789985286, 265.90145303995496, 216.46451606205207, 413.09267247015197, 83.55666224361931, 95.26881695626271, 305.118575221252, 467.6778968483049, 369.67747649563717, 22.13366233372909, 151.17603086570693, 184.13631208779586, 174.09339722611855, 305.0650883357239, 36.30196852633312, 433.84413482525497, 445.8665031035116, 158.60126567922944, 15.512678125181633, 638.4910933161713, 624.1257876631619, 13.699999999999976, 210.16207910275057, 106.53999446237846, 218.15070109741032, 331.9212949164689, 789.0931481062659, 26.820338852170714, 322.6507622034735, 330.04276110331307, 331.4065896700973, 682.2652215885594, 322.1526207614392, 26.998783415369687, 80.03345702087661, 70.46564094044234, 168.61027585053503, 242.53606136231335, 43.221868919216014, 403.3, 775.8212724763523, 429.128520811819, 667.2849683578743, 136.37042042196472, 80.32159985912163, 85.90515171315414, 409.38553865740937, 340.59088164513395, 341.16399404297647, 194.47967196542072, 112.73356942063475, 104.88978480679958, -5.921442822897664, 152.18148039847017, 548.6351562204761, 9.859971988330944, 620.2403859206362, 276.29999999999944, 559.9161362372164, 74.0, 98.29999999999986, 430.58053321939644, 310.4097421025087, 224.01874150159725, 423.25951014150763, 836.843703915571, 185.20334055311594, 96.53010427329475, 413.0439403211454, 318.42878639055755, 780.5897392145849, 4.1000000000000005, 392.3454307532045, 422.68844080859094, 507.80434566815165, 236.6790229734806], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-630.6744831632246, -583.8335355113231, -278.2866870396399, -482.363712639765, -626.8527044876017, -976.4249613174738, -783.2300676611325, -1336.2198558857638, -572.8908724677977, -976.3656697958959, -148.39069937331078, -992.5012237297756, -765.1509036953755, -993.3044819232462, -867.6415314632783, 79.07793944749554, -27.942043479627074, -1007.3759292857557, -923.3821582874943, -796.0596942562537, -557.0286432086455, -500.49397440184964, -728.8183490695575, 9.673016611699591, 131.50472985374188, 50.76498030291128, -1015.1936389997878, -922.3409841964367, -864.9920610286565, -168.6465131435513, -126.10208899145135, -608.5926430739108, -273.45385427342416, -262.41969458053615, -872.8003995801745, 96.67330579551925, 349.8147832457911, -1270.1832600041232, -636.2028930836923, -517.42873232629, -724.7340570974333, -1131.610058318846, -903.0747301417886, -785.6000342560186, -825.4122207955858, 107.05274328295741, -781.6708555927956, -575.2051189458253, -1061.9377223272127, -688.3149123217623, -787.2661993288162, -525.6107441789111, -847.1346409271307, -602.6773415820021, -115.3325537067169, -527.1563220719528, -184.16835691376198, -789.4807182040281, -984.427277313351, -129.67196392902275, -1162.6927792485365, -92.86569335269712, 234.0592847422447, -577.7645630644543, -130.5471470520003, -136.99497612933658, -1003.8426100541346, -538.9130756000375, -883.1637576864224, -340.71705705299564, -875.5887892100457, -277.0203246934043, -133.03402812753455, -600.4014050511693, 163.24087806841322, -647.7735578180564, -78.0991689666381, -933.1101304354227, -744.6166042310094, 43.20948851090053, -177.42133323591224, -258.7304896848203, -549.8290264793297, -427.6486119110022, -534.63025175277, -1042.2390372107168, -741.3850868185883, 196.69921104267684, 188.55506849354586, -589.9128345011579, -777.0792080134868, -872.2697899628124, -510.3336529960354, -638.6798752960656, -555.2615831747305, -564.0327575299176, -780.3302159446936, -160.28761179077065, -774.6466075968079, 67.787700130723, 28.2711027951154, -1010.4584607430048, -859.3288591256173, -420.0481865981868, -696.3062217615292, -585.5540976907324, -1131.73556818648, -457.16155991248314, -371.9917779708281, -19.956314003293365, -914.7782998836051, -72.0240482557628, -307.66454864207213, 76.45442049782393, -444.3558910690692, -887.3062500339009, -676.6727833386049, -89.77052682553855, -452.1098934363396, -815.7343072464217, -545.7711463168638, -439.78928013677177, -76.08530407304846, -577.6138067306891, -354.18744750376055, -904.8346481406646, 268.58356144626714, -595.2759337150753, 272.7764581178084, -673.9262717864808, -832.078086063456, -142.175258636786, 276.7760666488728, -906.2427407047837, -50.887860493967004, -856.5020001176629, -476.4942828703811, -644.8236949660887, -582.9130080895723, -667.3660107263709, 269.5331653756915, 33.668262372380596, -333.82530624077094, -209.22579605619882, -841.56079149146, -552.5253237234951, 20.953460017813946, -959.4743404007417, -854.5277393843181, -267.05035286579505, -719.3720725450629, -55.42719697651923, -843.8046845138177, -785.1969132748103, -860.597278660995, -34.369319125123205, 215.63999045399646, -70.81192258656446, -592.7391605182967, -538.9256609592419, 65.85547667675698, -725.8635804387259, -349.10580518929027, 60.37677483556013, -198.72941735577348, 396.04603445922703, -718.8938283474441, -456.91966057178286, -293.56442123878355, -844.2490336721654, 184.69780824168967, -91.95670888195377, -286.51234260427225, -354.59215491415614, 35.83487654513648, -406.14855988550715, -83.86704178900683, -774.3852709842423, 372.4789705182516, -48.55641064218912, -336.033989108638, -300.7265351844165, -608.0379873835919, -630.7558134418242, -990.8344477420866, 285.7772142525826, -259.901684580435, -436.4025275043068, 16.465273287316933, -1019.5647607615587, -741.6461343890951, -681.4335061950284, -1194.4244793360224, -111.27293299921251, 19.861260730725505, 48.46493142180796, 227.1459630932314, -802.6827480599204, -900.0817293758287, -572.0153519048565], "policy_predator_policy_reward": [681.4130791789598, 614.0335355113243, 402.20578463186826, 488.7355030847274, 642.7907388631488, 977.224961317474, 795.1520659355098, 1336.2198558857638, 574.690872467798, 982.2656697958961, 440.9752176811905, 988.0963338410404, 771.589661258002, 993.2010999231928, 810.4367274089178, 609.7718772613174, 804.276034485624, 949.6151407133755, 906.3479013453987, 943.623581320675, 478.2852451184645, 663.2493897842025, 181.3405591251601, 757.404773332698, 137.03015394274962, 206.4892239545347, 1015.1936389997878, 925.1867457197338, 235.2948494473391, 888.261501341832, 521.7999739828176, 645.8062587437108, 276.51777307913216, 489.9386951572707, 765.5751678026324, 735.8412939353988, 1201.0898569278056, 162.41550565566655, 633.7624565710651, 759.3441909942502, 707.5302214716212, 1157.320989108484, 885.0775105543802, 1012.6068199604529, 789.9301366243923, 482.89808564415193, 782.9708555927956, 654.7051189458259, 1061.9068461896682, 714.6077752492918, 780.3322284280165, 798.4461681196645, 814.3294896073859, 851.947008963803, 516.335160946659, 539.2463873021627, 808.7972190233814, 248.40851833802782, 548.9047365354207, 660.4633216632167, 1162.6817834122398, 397.99526441024625, 275.766868037551, 535.6163071329642, 276.49889604996713, 360.72070362700833, 1003.8426100541346, 561.0467379337656, 755.7781299144265, 619.2787156907012, 908.2008237827187, 428.5446022085282, 295.6284785402563, 611.9003518645668, 215.90612596222107, 573.691642123148, 901.3486350811341, 146.16263284725747, 507.0095264295694, 628.2417241157927, 396.6481788015355, 485.37014722270607, 620.4809276889783, 515.5979763805834, 549.9429298779547, 1042.4390372107168, 685.0941745939666, 498.08279449811306, 581.4115759519092, 444.0719777188654, 783.5792080134883, 879.4697899628125, 652.481634302262, 706.693973092592, 705.5026586914206, 520.3316764756078, 779.1525145912987, 379.61601424157715, 746.650676347858, 292.1295260346944, 867.6503581213137, 903.6301479328378, 942.5026790578704, 363.6947055181044, 701.8271543913446, 902.6839272643922, 1119.0997995996202, 799.840089602661, 170.28689222658804, 553.0677894176303, 808.377460441796, 860.6901092861284, 445.3845437805589, 107.97820512513022, 463.6426876334727, 895.0182368848665, 689.5727833386056, 156.9039838464144, 524.8186502623113, 813.4911913608969, 545.7711463168638, 608.3995559873064, 313.1428260174287, 583.0923461486213, 384.9093164229806, 917.3346481406646, 71.93481407894112, 658.0575581898694, 573.8076582577125, 603.1634278873134, 819.2721544634666, 584.1097110485966, 783.4663013002977, 513.2853411134901, 209.07352334388148, 834.6867576897157, 480.16440198265474, 721.4751757129368, 676.8291328578745, 659.3550376712254, 96.90578721999053, 9.278323689344637, 84.90045585345, 798.7415280886579, 833.0658046108721, 902.1843046470594, 211.71641043979284, 921.2841419085562, 750.2393306854108, 484.0723309853358, 725.8575811736558, 153.83147315472712, 870.0584226030754, 753.0217323626547, 195.78672765304088, 851.361350531549, 60.134110876240854, 343.67297747680345, 594.3991325066276, 547.1256609592422, 669.339143371147, 610.909346311458, 370.60580518929515, 194.42322516443966, 157.1930378786385, 205.40648125512016, 718.8938283474441, 530.9196605717833, 384.2644212387844, 851.8490336721655, 60.034358421338005, 277.8050754383235, 590.6834961417333, 360.830743479203, 278.4062594374281, 315.926165404545, 732.421348823894, 549.0904740908596, 245.27899065330735, 267.64215338620096, 403.9360041317003, 418.0278607144736, 640.6311398058472, 694.6927652928674, 199.21444060802574, 918.8867332026236, 405.41595752613773, 609.3170409491618, 898.4610918505559, 885.2281348382677, 745.7461343890952, 681.4335061950284, 1143.143150232605, 554.8996928558399, 192.8533192691913, 161.50892938686613, 288.48275907618614, 794.858371558655, 820.6492708045818, 888.1268334495824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.879156226095017, "mean_inference_ms": 7.104497147579389, "mean_action_processing_ms": 2.474217159652791, "mean_env_wait_ms": 17.059965933523262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009490966796875, "StateBufferConnector_ms": 0.014762639999389648, "ViewRequirementAgentConnector_ms": 0.19837772846221924}, "num_episodes": 8, "episode_return_max": 836.843703915571, "episode_return_min": -5.921442822897664, "episode_return_mean": 276.15750132941366, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1026048, "num_agent_steps_trained": 1026048, "num_env_steps_sampled": 256512, "num_env_steps_trained": 256512, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 154.63379242195396, "num_env_steps_trained_throughput_per_sec": 154.63379242195396, "timesteps_total": 256512, "num_env_steps_sampled_lifetime": 256512, "num_agent_steps_sampled_lifetime": 1026048, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1026048, "timers": {"training_iteration_time_ms": 26599.831, "restore_workers_time_ms": 0.025, "training_step_time_ms": 26599.314, "sample_time_ms": 3068.776, "learn_time_ms": 23505.725, "learn_throughput": 170.512, "synch_weights_time_ms": 21.261}, "counters": {"num_env_steps_sampled": 256512, "num_env_steps_trained": 256512, "num_agent_steps_sampled": 1026048, "num_agent_steps_trained": 1026048}, "done": false, "training_iteration": 64, "trial_id": "7f713_00000", "date": "2024-08-23_10-15-30", "timestamp": 1724388330, "time_this_iter_s": 25.965057849884033, "time_total_s": 1728.4284358024597, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737db040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1728.4284358024597, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 35.84166666666667, "ram_util_percent": 82.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.554858089124085, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.620490234112613, "policy_loss": -0.009349113795783114, "vf_loss": 6.628241518817881, "vf_explained_var": 0.6716263606434777, "kl": 0.007989210969763537, "entropy": 0.6635666124089055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 60953.0, "diff_num_grad_updates_vs_sampler_policy": 515.6190119760504}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.882713838607547, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 6.775108656302962, "policy_loss": -0.007562238028612993, "vf_loss": 6.782287335774255, "vf_explained_var": 0.36290227414438964, "kl": 0.007671007247415012, "entropy": 0.3855158959431623, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 60953.0, "diff_num_grad_updates_vs_sampler_policy": 515.6190119760504}}, "num_env_steps_sampled": 260520, "num_env_steps_trained": 260520, "num_agent_steps_sampled": 1042080, "num_agent_steps_trained": 1042080}, "env_runners": {"episode_reward_max": 1119.235347440777, "episode_reward_min": -5.921442822897664, "episode_reward_mean": 295.8686116539614, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1270.1832600041232, "predator_policy": 9.278323689344637}, "policy_reward_max": {"prey_policy": 398.2867614427589, "predator_policy": 1201.0898569278056}, "policy_reward_mean": {"prey_policy": -441.08352759859025, "predator_policy": 589.0178334255712}, "custom_metrics": {}, "hist_stats": {"episode_reward": [84.01201729217006, 219.5999999999999, 525.7890880539379, 2.845761523296968, 89.91777661696327, 432.91150066116614, 230.5829193824437, 725.289367953376, 443.136885825138, 239.47502215533177, 8.507095163825237, 209.00956611702665, 554.4687447559186, 80.80000000000003, 26.261986789985286, 265.90145303995496, 216.46451606205207, 413.09267247015197, 83.55666224361931, 95.26881695626271, 305.118575221252, 467.6778968483049, 369.67747649563717, 22.13366233372909, 151.17603086570693, 184.13631208779586, 174.09339722611855, 305.0650883357239, 36.30196852633312, 433.84413482525497, 445.8665031035116, 158.60126567922944, 15.512678125181633, 638.4910933161713, 624.1257876631619, 13.699999999999976, 210.16207910275057, 106.53999446237846, 218.15070109741032, 331.9212949164689, 789.0931481062659, 26.820338852170714, 322.6507622034735, 330.04276110331307, 331.4065896700973, 682.2652215885594, 322.1526207614392, 26.998783415369687, 80.03345702087661, 70.46564094044234, 168.61027585053503, 242.53606136231335, 43.221868919216014, 403.3, 775.8212724763523, 429.128520811819, 667.2849683578743, 136.37042042196472, 80.32159985912163, 85.90515171315414, 409.38553865740937, 340.59088164513395, 341.16399404297647, 194.47967196542072, 112.73356942063475, 104.88978480679958, -5.921442822897664, 152.18148039847017, 548.6351562204761, 9.859971988330944, 620.2403859206362, 276.29999999999944, 559.9161362372164, 74.0, 98.29999999999986, 430.58053321939644, 310.4097421025087, 224.01874150159725, 423.25951014150763, 836.843703915571, 185.20334055311594, 96.53010427329475, 413.0439403211454, 318.42878639055755, 780.5897392145849, 4.1000000000000005, 392.3454307532045, 422.68844080859094, 507.80434566815165, 236.6790229734806, 677.3665220169079, 55.63861315373332, 289.34656205089436, 351.9590617126036, 355.5926947866068, 84.48827594665026, 512.4546437374773, 1119.235347440777, 23.058906878364336, 524.8227706257195], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-557.0286432086455, -500.49397440184964, -728.8183490695575, 9.673016611699591, 131.50472985374188, 50.76498030291128, -1015.1936389997878, -922.3409841964367, -864.9920610286565, -168.6465131435513, -126.10208899145135, -608.5926430739108, -273.45385427342416, -262.41969458053615, -872.8003995801745, 96.67330579551925, 349.8147832457911, -1270.1832600041232, -636.2028930836923, -517.42873232629, -724.7340570974333, -1131.610058318846, -903.0747301417886, -785.6000342560186, -825.4122207955858, 107.05274328295741, -781.6708555927956, -575.2051189458253, -1061.9377223272127, -688.3149123217623, -787.2661993288162, -525.6107441789111, -847.1346409271307, -602.6773415820021, -115.3325537067169, -527.1563220719528, -184.16835691376198, -789.4807182040281, -984.427277313351, -129.67196392902275, -1162.6927792485365, -92.86569335269712, 234.0592847422447, -577.7645630644543, -130.5471470520003, -136.99497612933658, -1003.8426100541346, -538.9130756000375, -883.1637576864224, -340.71705705299564, -875.5887892100457, -277.0203246934043, -133.03402812753455, -600.4014050511693, 163.24087806841322, -647.7735578180564, -78.0991689666381, -933.1101304354227, -744.6166042310094, 43.20948851090053, -177.42133323591224, -258.7304896848203, -549.8290264793297, -427.6486119110022, -534.63025175277, -1042.2390372107168, -741.3850868185883, 196.69921104267684, 188.55506849354586, -589.9128345011579, -777.0792080134868, -872.2697899628124, -510.3336529960354, -638.6798752960656, -555.2615831747305, -564.0327575299176, -780.3302159446936, -160.28761179077065, -774.6466075968079, 67.787700130723, 28.2711027951154, -1010.4584607430048, -859.3288591256173, -420.0481865981868, -696.3062217615292, -585.5540976907324, -1131.73556818648, -457.16155991248314, -371.9917779708281, -19.956314003293365, -914.7782998836051, -72.0240482557628, -307.66454864207213, 76.45442049782393, -444.3558910690692, -887.3062500339009, -676.6727833386049, -89.77052682553855, -452.1098934363396, -815.7343072464217, -545.7711463168638, -439.78928013677177, -76.08530407304846, -577.6138067306891, -354.18744750376055, -904.8346481406646, 268.58356144626714, -595.2759337150753, 272.7764581178084, -673.9262717864808, -832.078086063456, -142.175258636786, 276.7760666488728, -906.2427407047837, -50.887860493967004, -856.5020001176629, -476.4942828703811, -644.8236949660887, -582.9130080895723, -667.3660107263709, 269.5331653756915, 33.668262372380596, -333.82530624077094, -209.22579605619882, -841.56079149146, -552.5253237234951, 20.953460017813946, -959.4743404007417, -854.5277393843181, -267.05035286579505, -719.3720725450629, -55.42719697651923, -843.8046845138177, -785.1969132748103, -860.597278660995, -34.369319125123205, 215.63999045399646, -70.81192258656446, -592.7391605182967, -538.9256609592419, 65.85547667675698, -725.8635804387259, -349.10580518929027, 60.37677483556013, -198.72941735577348, 396.04603445922703, -718.8938283474441, -456.91966057178286, -293.56442123878355, -844.2490336721654, 184.69780824168967, -91.95670888195377, -286.51234260427225, -354.59215491415614, 35.83487654513648, -406.14855988550715, -83.86704178900683, -774.3852709842423, 372.4789705182516, -48.55641064218912, -336.033989108638, -300.7265351844165, -608.0379873835919, -630.7558134418242, -990.8344477420866, 285.7772142525826, -259.901684580435, -436.4025275043068, 16.465273287316933, -1019.5647607615587, -741.6461343890951, -681.4335061950284, -1194.4244793360224, -111.27293299921251, 19.861260730725505, 48.46493142180796, 227.1459630932314, -802.6827480599204, -900.0817293758287, -572.0153519048565, 235.70704426177636, -887.4893496316207, -803.5843937083124, -91.93460290415015, -736.6112271162959, 193.7092627245433, -174.2981461813335, -115.28466294915381, -37.2871849047044, -241.99742097450664, -1091.3928806686451, -794.601535475644, 137.2465307398382, -970.6513153878504, -889.5874464968086, 398.2867614427589, -927.8049536055787, -798.708529814463, 77.6339009232292, -827.1873326705222], "policy_predator_policy_reward": [478.2852451184645, 663.2493897842025, 181.3405591251601, 757.404773332698, 137.03015394274962, 206.4892239545347, 1015.1936389997878, 925.1867457197338, 235.2948494473391, 888.261501341832, 521.7999739828176, 645.8062587437108, 276.51777307913216, 489.9386951572707, 765.5751678026324, 735.8412939353988, 1201.0898569278056, 162.41550565566655, 633.7624565710651, 759.3441909942502, 707.5302214716212, 1157.320989108484, 885.0775105543802, 1012.6068199604529, 789.9301366243923, 482.89808564415193, 782.9708555927956, 654.7051189458259, 1061.9068461896682, 714.6077752492918, 780.3322284280165, 798.4461681196645, 814.3294896073859, 851.947008963803, 516.335160946659, 539.2463873021627, 808.7972190233814, 248.40851833802782, 548.9047365354207, 660.4633216632167, 1162.6817834122398, 397.99526441024625, 275.766868037551, 535.6163071329642, 276.49889604996713, 360.72070362700833, 1003.8426100541346, 561.0467379337656, 755.7781299144265, 619.2787156907012, 908.2008237827187, 428.5446022085282, 295.6284785402563, 611.9003518645668, 215.90612596222107, 573.691642123148, 901.3486350811341, 146.16263284725747, 507.0095264295694, 628.2417241157927, 396.6481788015355, 485.37014722270607, 620.4809276889783, 515.5979763805834, 549.9429298779547, 1042.4390372107168, 685.0941745939666, 498.08279449811306, 581.4115759519092, 444.0719777188654, 783.5792080134883, 879.4697899628125, 652.481634302262, 706.693973092592, 705.5026586914206, 520.3316764756078, 779.1525145912987, 379.61601424157715, 746.650676347858, 292.1295260346944, 867.6503581213137, 903.6301479328378, 942.5026790578704, 363.6947055181044, 701.8271543913446, 902.6839272643922, 1119.0997995996202, 799.840089602661, 170.28689222658804, 553.0677894176303, 808.377460441796, 860.6901092861284, 445.3845437805589, 107.97820512513022, 463.6426876334727, 895.0182368848665, 689.5727833386056, 156.9039838464144, 524.8186502623113, 813.4911913608969, 545.7711463168638, 608.3995559873064, 313.1428260174287, 583.0923461486213, 384.9093164229806, 917.3346481406646, 71.93481407894112, 658.0575581898694, 573.8076582577125, 603.1634278873134, 819.2721544634666, 584.1097110485966, 783.4663013002977, 513.2853411134901, 209.07352334388148, 834.6867576897157, 480.16440198265474, 721.4751757129368, 676.8291328578745, 659.3550376712254, 96.90578721999053, 9.278323689344637, 84.90045585345, 798.7415280886579, 833.0658046108721, 902.1843046470594, 211.71641043979284, 921.2841419085562, 750.2393306854108, 484.0723309853358, 725.8575811736558, 153.83147315472712, 870.0584226030754, 753.0217323626547, 195.78672765304088, 851.361350531549, 60.134110876240854, 343.67297747680345, 594.3991325066276, 547.1256609592422, 669.339143371147, 610.909346311458, 370.60580518929515, 194.42322516443966, 157.1930378786385, 205.40648125512016, 718.8938283474441, 530.9196605717833, 384.2644212387844, 851.8490336721655, 60.034358421338005, 277.8050754383235, 590.6834961417333, 360.830743479203, 278.4062594374281, 315.926165404545, 732.421348823894, 549.0904740908596, 245.27899065330735, 267.64215338620096, 403.9360041317003, 418.0278607144736, 640.6311398058472, 694.6927652928674, 199.21444060802574, 918.8867332026236, 405.41595752613773, 609.3170409491618, 898.4610918505559, 885.2281348382677, 745.7461343890952, 681.4335061950284, 1143.143150232605, 554.8996928558399, 192.8533192691913, 161.50892938686613, 288.48275907618614, 794.858371558655, 820.6492708045818, 888.1268334495824, 523.2946840283869, 805.8541433583615, 798.383790601853, 152.77381916434086, 737.011227116296, 95.23729932635102, 329.9831355285564, 311.5587353145353, 275.98938385717764, 358.88791680863966, 1085.4415224066254, 885.0411696843146, 471.06016262961725, 874.7992657558749, 819.1281092950095, 791.4079231998184, 561.6609031477772, 1187.9114871506295, 732.5710629155179, 541.8051394574934]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.844753476100648, "mean_inference_ms": 7.102633884964794, "mean_action_processing_ms": 2.456486034954765, "mean_env_wait_ms": 17.067544758430998, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.009694695472717285, "StateBufferConnector_ms": 0.004759669303894043, "ViewRequirementAgentConnector_ms": 0.16953957080841064}, "num_episodes": 10, "episode_return_max": 1119.235347440777, "episode_return_min": -5.921442822897664, "episode_return_mean": 295.8686116539614, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1042080, "num_agent_steps_trained": 1042080, "num_env_steps_sampled": 260520, "num_env_steps_trained": 260520, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 153.04716256736657, "num_env_steps_trained_throughput_per_sec": 153.04716256736657, "timesteps_total": 260520, "num_env_steps_sampled_lifetime": 260520, "num_agent_steps_sampled_lifetime": 1042080, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1042080, "timers": {"training_iteration_time_ms": 26589.564, "restore_workers_time_ms": 0.023, "training_step_time_ms": 26589.044, "sample_time_ms": 3018.687, "learn_time_ms": 23545.669, "learn_throughput": 170.222, "synch_weights_time_ms": 21.215}, "counters": {"num_env_steps_sampled": 260520, "num_env_steps_trained": 260520, "num_agent_steps_sampled": 1042080, "num_agent_steps_trained": 1042080}, "done": false, "training_iteration": 65, "trial_id": "7f713_00000", "date": "2024-08-23_10-15-57", "timestamp": 1724388357, "time_this_iter_s": 26.25605797767639, "time_total_s": 1754.684493780136, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737dbd30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1754.684493780136, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 37.16578947368421, "ram_util_percent": 82.52631578947371}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.52942800042491, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.669254392290872, "policy_loss": -0.009170187438010341, "vf_loss": 6.676888374550633, "vf_explained_var": 0.6409478856772973, "kl": 0.0076810746409353755, "entropy": 0.6966867206588624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 61898.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.032416667635477, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 6.5985185966289865, "policy_loss": -0.009001437155283475, "vf_loss": 6.60717530023484, "vf_explained_var": 0.363397124015465, "kl": 0.006895220966359216, "entropy": 0.38296000995333235, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 61898.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 264528, "num_env_steps_trained": 264528, "num_agent_steps_sampled": 1058112, "num_agent_steps_trained": 1058112}, "env_runners": {"episode_reward_max": 1119.235347440777, "episode_reward_min": -10.713070831310445, "episode_reward_mean": 295.2996653011566, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1270.1832600041232, "predator_policy": 9.278323689344637}, "policy_reward_max": {"prey_policy": 398.2867614427589, "predator_policy": 1201.0898569278056}, "policy_reward_mean": {"prey_policy": -433.3066080460163, "predator_policy": 580.9564406965949}, "custom_metrics": {}, "hist_stats": {"episode_reward": [443.136885825138, 239.47502215533177, 8.507095163825237, 209.00956611702665, 554.4687447559186, 80.80000000000003, 26.261986789985286, 265.90145303995496, 216.46451606205207, 413.09267247015197, 83.55666224361931, 95.26881695626271, 305.118575221252, 467.6778968483049, 369.67747649563717, 22.13366233372909, 151.17603086570693, 184.13631208779586, 174.09339722611855, 305.0650883357239, 36.30196852633312, 433.84413482525497, 445.8665031035116, 158.60126567922944, 15.512678125181633, 638.4910933161713, 624.1257876631619, 13.699999999999976, 210.16207910275057, 106.53999446237846, 218.15070109741032, 331.9212949164689, 789.0931481062659, 26.820338852170714, 322.6507622034735, 330.04276110331307, 331.4065896700973, 682.2652215885594, 322.1526207614392, 26.998783415369687, 80.03345702087661, 70.46564094044234, 168.61027585053503, 242.53606136231335, 43.221868919216014, 403.3, 775.8212724763523, 429.128520811819, 667.2849683578743, 136.37042042196472, 80.32159985912163, 85.90515171315414, 409.38553865740937, 340.59088164513395, 341.16399404297647, 194.47967196542072, 112.73356942063475, 104.88978480679958, -5.921442822897664, 152.18148039847017, 548.6351562204761, 9.859971988330944, 620.2403859206362, 276.29999999999944, 559.9161362372164, 74.0, 98.29999999999986, 430.58053321939644, 310.4097421025087, 224.01874150159725, 423.25951014150763, 836.843703915571, 185.20334055311594, 96.53010427329475, 413.0439403211454, 318.42878639055755, 780.5897392145849, 4.1000000000000005, 392.3454307532045, 422.68844080859094, 507.80434566815165, 236.6790229734806, 677.3665220169079, 55.63861315373332, 289.34656205089436, 351.9590617126036, 355.5926947866068, 84.48827594665026, 512.4546437374773, 1119.235347440777, 23.058906878364336, 524.8227706257195, 140.161284836167, 382.4686392597085, 322.60000000000053, 332.95958131395753, 436.310704159564, 317.231846578829, 333.0348108859511, -10.713070831310445], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [349.8147832457911, -1270.1832600041232, -636.2028930836923, -517.42873232629, -724.7340570974333, -1131.610058318846, -903.0747301417886, -785.6000342560186, -825.4122207955858, 107.05274328295741, -781.6708555927956, -575.2051189458253, -1061.9377223272127, -688.3149123217623, -787.2661993288162, -525.6107441789111, -847.1346409271307, -602.6773415820021, -115.3325537067169, -527.1563220719528, -184.16835691376198, -789.4807182040281, -984.427277313351, -129.67196392902275, -1162.6927792485365, -92.86569335269712, 234.0592847422447, -577.7645630644543, -130.5471470520003, -136.99497612933658, -1003.8426100541346, -538.9130756000375, -883.1637576864224, -340.71705705299564, -875.5887892100457, -277.0203246934043, -133.03402812753455, -600.4014050511693, 163.24087806841322, -647.7735578180564, -78.0991689666381, -933.1101304354227, -744.6166042310094, 43.20948851090053, -177.42133323591224, -258.7304896848203, -549.8290264793297, -427.6486119110022, -534.63025175277, -1042.2390372107168, -741.3850868185883, 196.69921104267684, 188.55506849354586, -589.9128345011579, -777.0792080134868, -872.2697899628124, -510.3336529960354, -638.6798752960656, -555.2615831747305, -564.0327575299176, -780.3302159446936, -160.28761179077065, -774.6466075968079, 67.787700130723, 28.2711027951154, -1010.4584607430048, -859.3288591256173, -420.0481865981868, -696.3062217615292, -585.5540976907324, -1131.73556818648, -457.16155991248314, -371.9917779708281, -19.956314003293365, -914.7782998836051, -72.0240482557628, -307.66454864207213, 76.45442049782393, -444.3558910690692, -887.3062500339009, -676.6727833386049, -89.77052682553855, -452.1098934363396, -815.7343072464217, -545.7711463168638, -439.78928013677177, -76.08530407304846, -577.6138067306891, -354.18744750376055, -904.8346481406646, 268.58356144626714, -595.2759337150753, 272.7764581178084, -673.9262717864808, -832.078086063456, -142.175258636786, 276.7760666488728, -906.2427407047837, -50.887860493967004, -856.5020001176629, -476.4942828703811, -644.8236949660887, -582.9130080895723, -667.3660107263709, 269.5331653756915, 33.668262372380596, -333.82530624077094, -209.22579605619882, -841.56079149146, -552.5253237234951, 20.953460017813946, -959.4743404007417, -854.5277393843181, -267.05035286579505, -719.3720725450629, -55.42719697651923, -843.8046845138177, -785.1969132748103, -860.597278660995, -34.369319125123205, 215.63999045399646, -70.81192258656446, -592.7391605182967, -538.9256609592419, 65.85547667675698, -725.8635804387259, -349.10580518929027, 60.37677483556013, -198.72941735577348, 396.04603445922703, -718.8938283474441, -456.91966057178286, -293.56442123878355, -844.2490336721654, 184.69780824168967, -91.95670888195377, -286.51234260427225, -354.59215491415614, 35.83487654513648, -406.14855988550715, -83.86704178900683, -774.3852709842423, 372.4789705182516, -48.55641064218912, -336.033989108638, -300.7265351844165, -608.0379873835919, -630.7558134418242, -990.8344477420866, 285.7772142525826, -259.901684580435, -436.4025275043068, 16.465273287316933, -1019.5647607615587, -741.6461343890951, -681.4335061950284, -1194.4244793360224, -111.27293299921251, 19.861260730725505, 48.46493142180796, 227.1459630932314, -802.6827480599204, -900.0817293758287, -572.0153519048565, 235.70704426177636, -887.4893496316207, -803.5843937083124, -91.93460290415015, -736.6112271162959, 193.7092627245433, -174.2981461813335, -115.28466294915381, -37.2871849047044, -241.99742097450664, -1091.3928806686451, -794.601535475644, 137.2465307398382, -970.6513153878504, -889.5874464968086, 398.2867614427589, -927.8049536055787, -798.708529814463, 77.6339009232292, -827.1873326705222, -969.0199506893575, -431.0224633927355, -1006.5726884236417, 344.88120780623757, -232.00890390006538, 212.5057278185712, 264.0258750890997, -737.9828845770538, 38.88607935637415, -870.2131234968931, -677.0038387610965, 220.67470644504422, 25.620209238457367, -146.48551560175162, -726.8633314456355, -366.3040069348855], "policy_predator_policy_reward": [1201.0898569278056, 162.41550565566655, 633.7624565710651, 759.3441909942502, 707.5302214716212, 1157.320989108484, 885.0775105543802, 1012.6068199604529, 789.9301366243923, 482.89808564415193, 782.9708555927956, 654.7051189458259, 1061.9068461896682, 714.6077752492918, 780.3322284280165, 798.4461681196645, 814.3294896073859, 851.947008963803, 516.335160946659, 539.2463873021627, 808.7972190233814, 248.40851833802782, 548.9047365354207, 660.4633216632167, 1162.6817834122398, 397.99526441024625, 275.766868037551, 535.6163071329642, 276.49889604996713, 360.72070362700833, 1003.8426100541346, 561.0467379337656, 755.7781299144265, 619.2787156907012, 908.2008237827187, 428.5446022085282, 295.6284785402563, 611.9003518645668, 215.90612596222107, 573.691642123148, 901.3486350811341, 146.16263284725747, 507.0095264295694, 628.2417241157927, 396.6481788015355, 485.37014722270607, 620.4809276889783, 515.5979763805834, 549.9429298779547, 1042.4390372107168, 685.0941745939666, 498.08279449811306, 581.4115759519092, 444.0719777188654, 783.5792080134883, 879.4697899628125, 652.481634302262, 706.693973092592, 705.5026586914206, 520.3316764756078, 779.1525145912987, 379.61601424157715, 746.650676347858, 292.1295260346944, 867.6503581213137, 903.6301479328378, 942.5026790578704, 363.6947055181044, 701.8271543913446, 902.6839272643922, 1119.0997995996202, 799.840089602661, 170.28689222658804, 553.0677894176303, 808.377460441796, 860.6901092861284, 445.3845437805589, 107.97820512513022, 463.6426876334727, 895.0182368848665, 689.5727833386056, 156.9039838464144, 524.8186502623113, 813.4911913608969, 545.7711463168638, 608.3995559873064, 313.1428260174287, 583.0923461486213, 384.9093164229806, 917.3346481406646, 71.93481407894112, 658.0575581898694, 573.8076582577125, 603.1634278873134, 819.2721544634666, 584.1097110485966, 783.4663013002977, 513.2853411134901, 209.07352334388148, 834.6867576897157, 480.16440198265474, 721.4751757129368, 676.8291328578745, 659.3550376712254, 96.90578721999053, 9.278323689344637, 84.90045585345, 798.7415280886579, 833.0658046108721, 902.1843046470594, 211.71641043979284, 921.2841419085562, 750.2393306854108, 484.0723309853358, 725.8575811736558, 153.83147315472712, 870.0584226030754, 753.0217323626547, 195.78672765304088, 851.361350531549, 60.134110876240854, 343.67297747680345, 594.3991325066276, 547.1256609592422, 669.339143371147, 610.909346311458, 370.60580518929515, 194.42322516443966, 157.1930378786385, 205.40648125512016, 718.8938283474441, 530.9196605717833, 384.2644212387844, 851.8490336721655, 60.034358421338005, 277.8050754383235, 590.6834961417333, 360.830743479203, 278.4062594374281, 315.926165404545, 732.421348823894, 549.0904740908596, 245.27899065330735, 267.64215338620096, 403.9360041317003, 418.0278607144736, 640.6311398058472, 694.6927652928674, 199.21444060802574, 918.8867332026236, 405.41595752613773, 609.3170409491618, 898.4610918505559, 885.2281348382677, 745.7461343890952, 681.4335061950284, 1143.143150232605, 554.8996928558399, 192.8533192691913, 161.50892938686613, 288.48275907618614, 794.858371558655, 820.6492708045818, 888.1268334495824, 523.2946840283869, 805.8541433583615, 798.383790601853, 152.77381916434086, 737.011227116296, 95.23729932635102, 329.9831355285564, 311.5587353145353, 275.98938385717764, 358.88791680863966, 1085.4415224066254, 885.0411696843146, 471.06016262961725, 874.7992657558749, 819.1281092950095, 791.4079231998184, 561.6609031477772, 1187.9114871506295, 732.5710629155179, 541.8051394574934, 999.2892498741342, 540.9144490441264, 1008.1726884236421, 35.98743145347093, 253.80890390006414, 88.29427218142874, 62.03370622485793, 744.8828845770538, 446.31840647353414, 821.3193418265439, 682.0038387610966, 91.55714013378464, 353.80632686072386, 100.09379038852151, 730.058129585983, 352.39613796323187]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.868902108058073, "mean_inference_ms": 7.077812982946675, "mean_action_processing_ms": 2.475820471726439, "mean_env_wait_ms": 17.096344911215045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014394044876098633, "StateBufferConnector_ms": 0.008913636207580566, "ViewRequirementAgentConnector_ms": 0.23496747016906738}, "num_episodes": 8, "episode_return_max": 1119.235347440777, "episode_return_min": -10.713070831310445, "episode_return_mean": 295.2996653011566, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1058112, "num_agent_steps_trained": 1058112, "num_env_steps_sampled": 264528, "num_env_steps_trained": 264528, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 125.56149357103826, "num_env_steps_trained_throughput_per_sec": 125.56149357103826, "timesteps_total": 264528, "num_env_steps_sampled_lifetime": 264528, "num_agent_steps_sampled_lifetime": 1058112, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1058112, "timers": {"training_iteration_time_ms": 27154.286, "restore_workers_time_ms": 0.035, "training_step_time_ms": 27153.728, "sample_time_ms": 3571.46, "learn_time_ms": 23557.246, "learn_throughput": 170.139, "synch_weights_time_ms": 21.427}, "counters": {"num_env_steps_sampled": 264528, "num_env_steps_trained": 264528, "num_agent_steps_sampled": 1058112, "num_agent_steps_trained": 1058112}, "done": false, "training_iteration": 66, "trial_id": "7f713_00000", "date": "2024-08-23_10-16-29", "timestamp": 1724388389, "time_this_iter_s": 31.968984127044678, "time_total_s": 1786.6534779071808, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737db430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1786.6534779071808, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 51.26666666666666, "ram_util_percent": 82.88666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.85927221737211, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.475682783883715, "policy_loss": -0.006503423224523585, "vf_loss": 6.480819125402541, "vf_explained_var": 0.5605498717575477, "kl": 0.006835352980516969, "entropy": 0.6919806098181104, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 62843.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.06086442155182, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 6.33359396899188, "policy_loss": -0.008576762297304062, "vf_loss": 6.341821768927196, "vf_explained_var": 0.34500726947078, "kl": 0.0069794907154535095, "entropy": 0.4168132948496985, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 62843.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 268536, "num_env_steps_trained": 268536, "num_agent_steps_sampled": 1074144, "num_agent_steps_trained": 1074144}, "env_runners": {"episode_reward_max": 1119.235347440777, "episode_reward_min": -10.713070831310445, "episode_reward_mean": 304.40263231353345, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1194.4244793360224, "predator_policy": 1.6498100392552788}, "policy_reward_max": {"prey_policy": 398.2867614427589, "predator_policy": 1187.9114871506295}, "policy_reward_mean": {"prey_policy": -395.4812627630508, "predator_policy": 547.6825789198177}, "custom_metrics": {}, "hist_stats": {"episode_reward": [305.118575221252, 467.6778968483049, 369.67747649563717, 22.13366233372909, 151.17603086570693, 184.13631208779586, 174.09339722611855, 305.0650883357239, 36.30196852633312, 433.84413482525497, 445.8665031035116, 158.60126567922944, 15.512678125181633, 638.4910933161713, 624.1257876631619, 13.699999999999976, 210.16207910275057, 106.53999446237846, 218.15070109741032, 331.9212949164689, 789.0931481062659, 26.820338852170714, 322.6507622034735, 330.04276110331307, 331.4065896700973, 682.2652215885594, 322.1526207614392, 26.998783415369687, 80.03345702087661, 70.46564094044234, 168.61027585053503, 242.53606136231335, 43.221868919216014, 403.3, 775.8212724763523, 429.128520811819, 667.2849683578743, 136.37042042196472, 80.32159985912163, 85.90515171315414, 409.38553865740937, 340.59088164513395, 341.16399404297647, 194.47967196542072, 112.73356942063475, 104.88978480679958, -5.921442822897664, 152.18148039847017, 548.6351562204761, 9.859971988330944, 620.2403859206362, 276.29999999999944, 559.9161362372164, 74.0, 98.29999999999986, 430.58053321939644, 310.4097421025087, 224.01874150159725, 423.25951014150763, 836.843703915571, 185.20334055311594, 96.53010427329475, 413.0439403211454, 318.42878639055755, 780.5897392145849, 4.1000000000000005, 392.3454307532045, 422.68844080859094, 507.80434566815165, 236.6790229734806, 677.3665220169079, 55.63861315373332, 289.34656205089436, 351.9590617126036, 355.5926947866068, 84.48827594665026, 512.4546437374773, 1119.235347440777, 23.058906878364336, 524.8227706257195, 140.161284836167, 382.4686392597085, 322.60000000000053, 332.95958131395753, 436.310704159564, 317.231846578829, 333.0348108859511, -10.713070831310445, 39.197449139408754, 690.7972525195311, 244.5656781975838, 414.40000000000276, -9.726413492812313, 135.92745033585217, 376.7979342892283, 331.7639264762355, 395.27025689355764, 261.10173544628793, 666.0448530120727, 0.09999999999999343], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1162.6927792485365, -92.86569335269712, 234.0592847422447, -577.7645630644543, -130.5471470520003, -136.99497612933658, -1003.8426100541346, -538.9130756000375, -883.1637576864224, -340.71705705299564, -875.5887892100457, -277.0203246934043, -133.03402812753455, -600.4014050511693, 163.24087806841322, -647.7735578180564, -78.0991689666381, -933.1101304354227, -744.6166042310094, 43.20948851090053, -177.42133323591224, -258.7304896848203, -549.8290264793297, -427.6486119110022, -534.63025175277, -1042.2390372107168, -741.3850868185883, 196.69921104267684, 188.55506849354586, -589.9128345011579, -777.0792080134868, -872.2697899628124, -510.3336529960354, -638.6798752960656, -555.2615831747305, -564.0327575299176, -780.3302159446936, -160.28761179077065, -774.6466075968079, 67.787700130723, 28.2711027951154, -1010.4584607430048, -859.3288591256173, -420.0481865981868, -696.3062217615292, -585.5540976907324, -1131.73556818648, -457.16155991248314, -371.9917779708281, -19.956314003293365, -914.7782998836051, -72.0240482557628, -307.66454864207213, 76.45442049782393, -444.3558910690692, -887.3062500339009, -676.6727833386049, -89.77052682553855, -452.1098934363396, -815.7343072464217, -545.7711463168638, -439.78928013677177, -76.08530407304846, -577.6138067306891, -354.18744750376055, -904.8346481406646, 268.58356144626714, -595.2759337150753, 272.7764581178084, -673.9262717864808, -832.078086063456, -142.175258636786, 276.7760666488728, -906.2427407047837, -50.887860493967004, -856.5020001176629, -476.4942828703811, -644.8236949660887, -582.9130080895723, -667.3660107263709, 269.5331653756915, 33.668262372380596, -333.82530624077094, -209.22579605619882, -841.56079149146, -552.5253237234951, 20.953460017813946, -959.4743404007417, -854.5277393843181, -267.05035286579505, -719.3720725450629, -55.42719697651923, -843.8046845138177, -785.1969132748103, -860.597278660995, -34.369319125123205, 215.63999045399646, -70.81192258656446, -592.7391605182967, -538.9256609592419, 65.85547667675698, -725.8635804387259, -349.10580518929027, 60.37677483556013, -198.72941735577348, 396.04603445922703, -718.8938283474441, -456.91966057178286, -293.56442123878355, -844.2490336721654, 184.69780824168967, -91.95670888195377, -286.51234260427225, -354.59215491415614, 35.83487654513648, -406.14855988550715, -83.86704178900683, -774.3852709842423, 372.4789705182516, -48.55641064218912, -336.033989108638, -300.7265351844165, -608.0379873835919, -630.7558134418242, -990.8344477420866, 285.7772142525826, -259.901684580435, -436.4025275043068, 16.465273287316933, -1019.5647607615587, -741.6461343890951, -681.4335061950284, -1194.4244793360224, -111.27293299921251, 19.861260730725505, 48.46493142180796, 227.1459630932314, -802.6827480599204, -900.0817293758287, -572.0153519048565, 235.70704426177636, -887.4893496316207, -803.5843937083124, -91.93460290415015, -736.6112271162959, 193.7092627245433, -174.2981461813335, -115.28466294915381, -37.2871849047044, -241.99742097450664, -1091.3928806686451, -794.601535475644, 137.2465307398382, -970.6513153878504, -889.5874464968086, 398.2867614427589, -927.8049536055787, -798.708529814463, 77.6339009232292, -827.1873326705222, -969.0199506893575, -431.0224633927355, -1006.5726884236417, 344.88120780623757, -232.00890390006538, 212.5057278185712, 264.0258750890997, -737.9828845770538, 38.88607935637415, -870.2131234968931, -677.0038387610965, 220.67470644504422, 25.620209238457367, -146.48551560175162, -726.8633314456355, -366.3040069348855, -380.7050791683512, -407.10520750619804, 382.03947838444685, -1028.9955179697838, 216.20788858723415, -302.31131429750275, -86.40945858676172, 377.497861073444, -918.7250444487893, -656.1123130615155, -759.740791084978, -141.11745223330715, 345.53140673822065, -508.5410558887737, 24.23732381460896, 151.83026791009155, -276.5533908872496, 373.03821338573005, -182.23955031486167, -757.3310421688188, 20.24121431321872, -905.1545757552004, -873.078796845969, -1078.8671942341443], "policy_predator_policy_reward": [1162.6817834122398, 397.99526441024625, 275.766868037551, 535.6163071329642, 276.49889604996713, 360.72070362700833, 1003.8426100541346, 561.0467379337656, 755.7781299144265, 619.2787156907012, 908.2008237827187, 428.5446022085282, 295.6284785402563, 611.9003518645668, 215.90612596222107, 573.691642123148, 901.3486350811341, 146.16263284725747, 507.0095264295694, 628.2417241157927, 396.6481788015355, 485.37014722270607, 620.4809276889783, 515.5979763805834, 549.9429298779547, 1042.4390372107168, 685.0941745939666, 498.08279449811306, 581.4115759519092, 444.0719777188654, 783.5792080134883, 879.4697899628125, 652.481634302262, 706.693973092592, 705.5026586914206, 520.3316764756078, 779.1525145912987, 379.61601424157715, 746.650676347858, 292.1295260346944, 867.6503581213137, 903.6301479328378, 942.5026790578704, 363.6947055181044, 701.8271543913446, 902.6839272643922, 1119.0997995996202, 799.840089602661, 170.28689222658804, 553.0677894176303, 808.377460441796, 860.6901092861284, 445.3845437805589, 107.97820512513022, 463.6426876334727, 895.0182368848665, 689.5727833386056, 156.9039838464144, 524.8186502623113, 813.4911913608969, 545.7711463168638, 608.3995559873064, 313.1428260174287, 583.0923461486213, 384.9093164229806, 917.3346481406646, 71.93481407894112, 658.0575581898694, 573.8076582577125, 603.1634278873134, 819.2721544634666, 584.1097110485966, 783.4663013002977, 513.2853411134901, 209.07352334388148, 834.6867576897157, 480.16440198265474, 721.4751757129368, 676.8291328578745, 659.3550376712254, 96.90578721999053, 9.278323689344637, 84.90045585345, 798.7415280886579, 833.0658046108721, 902.1843046470594, 211.71641043979284, 921.2841419085562, 750.2393306854108, 484.0723309853358, 725.8575811736558, 153.83147315472712, 870.0584226030754, 753.0217323626547, 195.78672765304088, 851.361350531549, 60.134110876240854, 343.67297747680345, 594.3991325066276, 547.1256609592422, 669.339143371147, 610.909346311458, 370.60580518929515, 194.42322516443966, 157.1930378786385, 205.40648125512016, 718.8938283474441, 530.9196605717833, 384.2644212387844, 851.8490336721655, 60.034358421338005, 277.8050754383235, 590.6834961417333, 360.830743479203, 278.4062594374281, 315.926165404545, 732.421348823894, 549.0904740908596, 245.27899065330735, 267.64215338620096, 403.9360041317003, 418.0278607144736, 640.6311398058472, 694.6927652928674, 199.21444060802574, 918.8867332026236, 405.41595752613773, 609.3170409491618, 898.4610918505559, 885.2281348382677, 745.7461343890952, 681.4335061950284, 1143.143150232605, 554.8996928558399, 192.8533192691913, 161.50892938686613, 288.48275907618614, 794.858371558655, 820.6492708045818, 888.1268334495824, 523.2946840283869, 805.8541433583615, 798.383790601853, 152.77381916434086, 737.011227116296, 95.23729932635102, 329.9831355285564, 311.5587353145353, 275.98938385717764, 358.88791680863966, 1085.4415224066254, 885.0411696843146, 471.06016262961725, 874.7992657558749, 819.1281092950095, 791.4079231998184, 561.6609031477772, 1187.9114871506295, 732.5710629155179, 541.8051394574934, 999.2892498741342, 540.9144490441264, 1008.1726884236421, 35.98743145347093, 253.80890390006414, 88.29427218142874, 62.03370622485793, 744.8828845770538, 446.31840647353414, 821.3193418265439, 682.0038387610966, 91.55714013378464, 353.80632686072386, 100.09379038852151, 730.058129585983, 352.39613796323187, 423.91057453050286, 403.09716128345843, 378.7097629419177, 959.0435291629501, 329.01929386860235, 1.6498100392552788, 120.00945858676036, 3.30213892655596, 743.9205661286068, 821.1903778888853, 765.556244760422, 271.22944889371354, 26.488361129230746, 513.3192223105508, 50.52230940425091, 105.17402534728232, 295.75339088725394, 3.03204350782511, 500.1153196318202, 700.5570082981476, 863.4348110466218, 687.5234034074343, 873.1787968459689, 1078.8671942341443]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.883841487479557, "mean_inference_ms": 7.113445946341894, "mean_action_processing_ms": 2.464404805400326, "mean_env_wait_ms": 17.111785920089496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01658940315246582, "StateBufferConnector_ms": 0.009134650230407715, "ViewRequirementAgentConnector_ms": 0.23682034015655518}, "num_episodes": 12, "episode_return_max": 1119.235347440777, "episode_return_min": -10.713070831310445, "episode_return_mean": 304.40263231353345, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1074144, "num_agent_steps_trained": 1074144, "num_env_steps_sampled": 268536, "num_env_steps_trained": 268536, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 150.94035511001448, "num_env_steps_trained_throughput_per_sec": 150.94035511001448, "timesteps_total": 268536, "num_env_steps_sampled_lifetime": 268536, "num_agent_steps_sampled_lifetime": 1074144, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1074144, "timers": {"training_iteration_time_ms": 27153.342, "restore_workers_time_ms": 0.036, "training_step_time_ms": 27152.783, "sample_time_ms": 3557.057, "learn_time_ms": 23569.339, "learn_throughput": 170.051, "synch_weights_time_ms": 21.784}, "counters": {"num_env_steps_sampled": 268536, "num_env_steps_trained": 268536, "num_agent_steps_sampled": 1074144, "num_agent_steps_trained": 1074144}, "done": false, "training_iteration": 67, "trial_id": "7f713_00000", "date": "2024-08-23_10-16-55", "timestamp": 1724388415, "time_this_iter_s": 26.60265803337097, "time_total_s": 1813.2561359405518, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x173753ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1813.2561359405518, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 40.86756756756756, "ram_util_percent": 82.78378378378379}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.66749830901938, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.501274021088131, "policy_loss": -0.011047863035842225, "vf_loss": 6.510746443713153, "vf_explained_var": 0.631494526194517, "kl": 0.007877342567025197, "entropy": 0.6957170024119987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 63788.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.331827974067163, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 6.289112111752626, "policy_loss": -0.008908615720078901, "vf_loss": 6.297459990889938, "vf_explained_var": 0.37524459444025837, "kl": 0.011215106870796748, "entropy": 0.40346487930842806, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 63788.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 272544, "num_env_steps_trained": 272544, "num_agent_steps_sampled": 1090176, "num_agent_steps_trained": 1090176}, "env_runners": {"episode_reward_max": 1119.235347440777, "episode_reward_min": -10.713070831310445, "episode_reward_mean": 312.40643362699643, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1194.4244793360224, "predator_policy": 0.8581666148171028}, "policy_reward_max": {"prey_policy": 398.2867614427589, "predator_policy": 1187.9114871506295}, "policy_reward_mean": {"prey_policy": -391.6916585286765, "predator_policy": 547.8948753421749}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.16207910275057, 106.53999446237846, 218.15070109741032, 331.9212949164689, 789.0931481062659, 26.820338852170714, 322.6507622034735, 330.04276110331307, 331.4065896700973, 682.2652215885594, 322.1526207614392, 26.998783415369687, 80.03345702087661, 70.46564094044234, 168.61027585053503, 242.53606136231335, 43.221868919216014, 403.3, 775.8212724763523, 429.128520811819, 667.2849683578743, 136.37042042196472, 80.32159985912163, 85.90515171315414, 409.38553865740937, 340.59088164513395, 341.16399404297647, 194.47967196542072, 112.73356942063475, 104.88978480679958, -5.921442822897664, 152.18148039847017, 548.6351562204761, 9.859971988330944, 620.2403859206362, 276.29999999999944, 559.9161362372164, 74.0, 98.29999999999986, 430.58053321939644, 310.4097421025087, 224.01874150159725, 423.25951014150763, 836.843703915571, 185.20334055311594, 96.53010427329475, 413.0439403211454, 318.42878639055755, 780.5897392145849, 4.1000000000000005, 392.3454307532045, 422.68844080859094, 507.80434566815165, 236.6790229734806, 677.3665220169079, 55.63861315373332, 289.34656205089436, 351.9590617126036, 355.5926947866068, 84.48827594665026, 512.4546437374773, 1119.235347440777, 23.058906878364336, 524.8227706257195, 140.161284836167, 382.4686392597085, 322.60000000000053, 332.95958131395753, 436.310704159564, 317.231846578829, 333.0348108859511, -10.713070831310445, 39.197449139408754, 690.7972525195311, 244.5656781975838, 414.40000000000276, -9.726413492812313, 135.92745033585217, 376.7979342892283, 331.7639264762355, 395.27025689355764, 261.10173544628793, 666.0448530120727, 0.09999999999999343, 373.8127468823409, 845.9623702360972, 430.5692883384079, -0.09643595146559392, 9.499999999999982, 51.53634931674941, 371.39278943260604, 9.699999999999958, 456.4875281334263, 822.2053125483752, 406.6282058697684, 729.5850518385093, 533.2505531398451, 0.7000000000000011, 85.01892768423787, 19.64931453050695], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-510.3336529960354, -638.6798752960656, -555.2615831747305, -564.0327575299176, -780.3302159446936, -160.28761179077065, -774.6466075968079, 67.787700130723, 28.2711027951154, -1010.4584607430048, -859.3288591256173, -420.0481865981868, -696.3062217615292, -585.5540976907324, -1131.73556818648, -457.16155991248314, -371.9917779708281, -19.956314003293365, -914.7782998836051, -72.0240482557628, -307.66454864207213, 76.45442049782393, -444.3558910690692, -887.3062500339009, -676.6727833386049, -89.77052682553855, -452.1098934363396, -815.7343072464217, -545.7711463168638, -439.78928013677177, -76.08530407304846, -577.6138067306891, -354.18744750376055, -904.8346481406646, 268.58356144626714, -595.2759337150753, 272.7764581178084, -673.9262717864808, -832.078086063456, -142.175258636786, 276.7760666488728, -906.2427407047837, -50.887860493967004, -856.5020001176629, -476.4942828703811, -644.8236949660887, -582.9130080895723, -667.3660107263709, 269.5331653756915, 33.668262372380596, -333.82530624077094, -209.22579605619882, -841.56079149146, -552.5253237234951, 20.953460017813946, -959.4743404007417, -854.5277393843181, -267.05035286579505, -719.3720725450629, -55.42719697651923, -843.8046845138177, -785.1969132748103, -860.597278660995, -34.369319125123205, 215.63999045399646, -70.81192258656446, -592.7391605182967, -538.9256609592419, 65.85547667675698, -725.8635804387259, -349.10580518929027, 60.37677483556013, -198.72941735577348, 396.04603445922703, -718.8938283474441, -456.91966057178286, -293.56442123878355, -844.2490336721654, 184.69780824168967, -91.95670888195377, -286.51234260427225, -354.59215491415614, 35.83487654513648, -406.14855988550715, -83.86704178900683, -774.3852709842423, 372.4789705182516, -48.55641064218912, -336.033989108638, -300.7265351844165, -608.0379873835919, -630.7558134418242, -990.8344477420866, 285.7772142525826, -259.901684580435, -436.4025275043068, 16.465273287316933, -1019.5647607615587, -741.6461343890951, -681.4335061950284, -1194.4244793360224, -111.27293299921251, 19.861260730725505, 48.46493142180796, 227.1459630932314, -802.6827480599204, -900.0817293758287, -572.0153519048565, 235.70704426177636, -887.4893496316207, -803.5843937083124, -91.93460290415015, -736.6112271162959, 193.7092627245433, -174.2981461813335, -115.28466294915381, -37.2871849047044, -241.99742097450664, -1091.3928806686451, -794.601535475644, 137.2465307398382, -970.6513153878504, -889.5874464968086, 398.2867614427589, -927.8049536055787, -798.708529814463, 77.6339009232292, -827.1873326705222, -969.0199506893575, -431.0224633927355, -1006.5726884236417, 344.88120780623757, -232.00890390006538, 212.5057278185712, 264.0258750890997, -737.9828845770538, 38.88607935637415, -870.2131234968931, -677.0038387610965, 220.67470644504422, 25.620209238457367, -146.48551560175162, -726.8633314456355, -366.3040069348855, -380.7050791683512, -407.10520750619804, 382.03947838444685, -1028.9955179697838, 216.20788858723415, -302.31131429750275, -86.40945858676172, 377.497861073444, -918.7250444487893, -656.1123130615155, -759.740791084978, -141.11745223330715, 345.53140673822065, -508.5410558887737, 24.23732381460896, 151.83026791009155, -276.5533908872496, 373.03821338573005, -182.23955031486167, -757.3310421688188, 20.24121431321872, -905.1545757552004, -873.078796845969, -1078.8671942341443, -248.0783952046309, 287.0871129212848, 396.1989652825074, -849.584526126946, -533.8179561836018, 79.1838887066448, -964.6666940645965, -777.6686845392378, -856.3070248374429, -795.2136809594163, -367.2238694978381, -562.8477460755076, -350.3549989932483, 217.92735135162692, -969.5753222258834, -576.8992987433171, 37.73506211985314, -887.2295776416584, -789.9672096835546, 229.96388853671675, -38.16046449266969, -351.4285633478248, -878.3403058289208, 244.9245888039508, 38.29739917861605, -567.8717100819312, -632.8717875495524, -729.8688781049196, -397.2388934384494, -984.5698055241546, -707.6699587430751, -258.4694646246646], "policy_predator_policy_reward": [652.481634302262, 706.693973092592, 705.5026586914206, 520.3316764756078, 779.1525145912987, 379.61601424157715, 746.650676347858, 292.1295260346944, 867.6503581213137, 903.6301479328378, 942.5026790578704, 363.6947055181044, 701.8271543913446, 902.6839272643922, 1119.0997995996202, 799.840089602661, 170.28689222658804, 553.0677894176303, 808.377460441796, 860.6901092861284, 445.3845437805589, 107.97820512513022, 463.6426876334727, 895.0182368848665, 689.5727833386056, 156.9039838464144, 524.8186502623113, 813.4911913608969, 545.7711463168638, 608.3995559873064, 313.1428260174287, 583.0923461486213, 384.9093164229806, 917.3346481406646, 71.93481407894112, 658.0575581898694, 573.8076582577125, 603.1634278873134, 819.2721544634666, 584.1097110485966, 783.4663013002977, 513.2853411134901, 209.07352334388148, 834.6867576897157, 480.16440198265474, 721.4751757129368, 676.8291328578745, 659.3550376712254, 96.90578721999053, 9.278323689344637, 84.90045585345, 798.7415280886579, 833.0658046108721, 902.1843046470594, 211.71641043979284, 921.2841419085562, 750.2393306854108, 484.0723309853358, 725.8575811736558, 153.83147315472712, 870.0584226030754, 753.0217323626547, 195.78672765304088, 851.361350531549, 60.134110876240854, 343.67297747680345, 594.3991325066276, 547.1256609592422, 669.339143371147, 610.909346311458, 370.60580518929515, 194.42322516443966, 157.1930378786385, 205.40648125512016, 718.8938283474441, 530.9196605717833, 384.2644212387844, 851.8490336721655, 60.034358421338005, 277.8050754383235, 590.6834961417333, 360.830743479203, 278.4062594374281, 315.926165404545, 732.421348823894, 549.0904740908596, 245.27899065330735, 267.64215338620096, 403.9360041317003, 418.0278607144736, 640.6311398058472, 694.6927652928674, 199.21444060802574, 918.8867332026236, 405.41595752613773, 609.3170409491618, 898.4610918505559, 885.2281348382677, 745.7461343890952, 681.4335061950284, 1143.143150232605, 554.8996928558399, 192.8533192691913, 161.50892938686613, 288.48275907618614, 794.858371558655, 820.6492708045818, 888.1268334495824, 523.2946840283869, 805.8541433583615, 798.383790601853, 152.77381916434086, 737.011227116296, 95.23729932635102, 329.9831355285564, 311.5587353145353, 275.98938385717764, 358.88791680863966, 1085.4415224066254, 885.0411696843146, 471.06016262961725, 874.7992657558749, 819.1281092950095, 791.4079231998184, 561.6609031477772, 1187.9114871506295, 732.5710629155179, 541.8051394574934, 999.2892498741342, 540.9144490441264, 1008.1726884236421, 35.98743145347093, 253.80890390006414, 88.29427218142874, 62.03370622485793, 744.8828845770538, 446.31840647353414, 821.3193418265439, 682.0038387610966, 91.55714013378464, 353.80632686072386, 100.09379038852151, 730.058129585983, 352.39613796323187, 423.91057453050286, 403.09716128345843, 378.7097629419177, 959.0435291629501, 329.01929386860235, 1.6498100392552788, 120.00945858676036, 3.30213892655596, 743.9205661286068, 821.1903778888853, 765.556244760422, 271.22944889371354, 26.488361129230746, 513.3192223105508, 50.52230940425091, 105.17402534728232, 295.75339088725394, 3.03204350782511, 500.1153196318202, 700.5570082981476, 863.4348110466218, 687.5234034074343, 873.1787968459689, 1078.8671942341443, 0.8581666148171028, 333.9458625508686, 605.6561213973133, 693.6918096832225, 604.9627521312584, 280.24060368410557, 964.6666940645965, 777.5722485877722, 865.507024837445, 795.5136809594163, 407.5760761397909, 574.0318887503071, 437.3378891200991, 66.48254795412896, 969.5753222258834, 586.599298743317, 667.7202492033415, 638.2617944518911, 712.8260441131473, 669.3825895820679, 347.9970945071786, 448.22013920308683, 817.8253432120875, 545.1754256513912, 509.93487042980894, 552.8899936133486, 633.1717875495525, 730.2688781049197, 649.9193959529755, 816.9082306938716, 723.2699587430757, 262.518779155177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.89277287108531, "mean_inference_ms": 7.099667413075041, "mean_action_processing_ms": 2.4789200086737084, "mean_env_wait_ms": 17.1146020641386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.031223773956298828, "StateBufferConnector_ms": 0.008888959884643555, "ViewRequirementAgentConnector_ms": 0.24263477325439453}, "num_episodes": 16, "episode_return_max": 1119.235347440777, "episode_return_min": -10.713070831310445, "episode_return_mean": 312.40643362699643, "episodes_this_iter": 16}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1090176, "num_agent_steps_trained": 1090176, "num_env_steps_sampled": 272544, "num_env_steps_trained": 272544, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 150.04488539215933, "num_env_steps_trained_throughput_per_sec": 150.04488539215933, "timesteps_total": 272544, "num_env_steps_sampled_lifetime": 272544, "num_agent_steps_sampled_lifetime": 1090176, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1090176, "timers": {"training_iteration_time_ms": 27222.976, "restore_workers_time_ms": 0.035, "training_step_time_ms": 27222.494, "sample_time_ms": 3650.91, "learn_time_ms": 23544.958, "learn_throughput": 170.228, "synch_weights_time_ms": 22.35}, "counters": {"num_env_steps_sampled": 272544, "num_env_steps_trained": 272544, "num_agent_steps_sampled": 1090176, "num_agent_steps_trained": 1090176}, "done": false, "training_iteration": 68, "trial_id": "7f713_00000", "date": "2024-08-23_10-17-22", "timestamp": 1724388442, "time_this_iter_s": 26.77381992340088, "time_total_s": 1840.0299558639526, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737a2d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1840.0299558639526, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 41.65789473684212, "ram_util_percent": 83.13157894736841}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.280300100770575, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.157285734206911, "policy_loss": -0.008567177134235857, "vf_loss": 6.164292188170095, "vf_explained_var": 0.6521776094007744, "kl": 0.007803588472405281, "entropy": 0.6974709903752362, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 64733.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.786946333526934, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 6.304130082407957, "policy_loss": -0.00876984824377196, "vf_loss": 6.312397525928638, "vf_explained_var": 0.3503457703918376, "kl": 0.010048083975792878, "entropy": 0.3723081943061617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 64733.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 276552, "num_env_steps_trained": 276552, "num_agent_steps_sampled": 1106208, "num_agent_steps_trained": 1106208}, "env_runners": {"episode_reward_max": 1119.235347440777, "episode_reward_min": -10.713070831310445, "episode_reward_mean": 316.4654499746586, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1194.4244793360224, "predator_policy": 0.8581666148171028}, "policy_reward_max": {"prey_policy": 398.2867614427589, "predator_policy": 1228.313508997293}, "policy_reward_mean": {"prey_policy": -378.027680923054, "predator_policy": 536.2604059103835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [242.53606136231335, 43.221868919216014, 403.3, 775.8212724763523, 429.128520811819, 667.2849683578743, 136.37042042196472, 80.32159985912163, 85.90515171315414, 409.38553865740937, 340.59088164513395, 341.16399404297647, 194.47967196542072, 112.73356942063475, 104.88978480679958, -5.921442822897664, 152.18148039847017, 548.6351562204761, 9.859971988330944, 620.2403859206362, 276.29999999999944, 559.9161362372164, 74.0, 98.29999999999986, 430.58053321939644, 310.4097421025087, 224.01874150159725, 423.25951014150763, 836.843703915571, 185.20334055311594, 96.53010427329475, 413.0439403211454, 318.42878639055755, 780.5897392145849, 4.1000000000000005, 392.3454307532045, 422.68844080859094, 507.80434566815165, 236.6790229734806, 677.3665220169079, 55.63861315373332, 289.34656205089436, 351.9590617126036, 355.5926947866068, 84.48827594665026, 512.4546437374773, 1119.235347440777, 23.058906878364336, 524.8227706257195, 140.161284836167, 382.4686392597085, 322.60000000000053, 332.95958131395753, 436.310704159564, 317.231846578829, 333.0348108859511, -10.713070831310445, 39.197449139408754, 690.7972525195311, 244.5656781975838, 414.40000000000276, -9.726413492812313, 135.92745033585217, 376.7979342892283, 331.7639264762355, 395.27025689355764, 261.10173544628793, 666.0448530120727, 0.09999999999999343, 373.8127468823409, 845.9623702360972, 430.5692883384079, -0.09643595146559392, 9.499999999999982, 51.53634931674941, 371.39278943260604, 9.699999999999958, 456.4875281334263, 822.2053125483752, 406.6282058697684, 729.5850518385093, 533.2505531398451, 0.7000000000000011, 85.01892768423787, 19.64931453050695, 5.849618608932921, 474.42368955311963, 66.79036319840934, 507.5340189102278, 442.82896216751783, 351.8814299626243, 49.45165042944981, 298.87452103906736, 684.1028204574494, 223.07940288780546, 334.8599243592064, 666.6188088194621, 168.81465795623947, 130.10183435710405, 18.00360115115754], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-76.08530407304846, -577.6138067306891, -354.18744750376055, -904.8346481406646, 268.58356144626714, -595.2759337150753, 272.7764581178084, -673.9262717864808, -832.078086063456, -142.175258636786, 276.7760666488728, -906.2427407047837, -50.887860493967004, -856.5020001176629, -476.4942828703811, -644.8236949660887, -582.9130080895723, -667.3660107263709, 269.5331653756915, 33.668262372380596, -333.82530624077094, -209.22579605619882, -841.56079149146, -552.5253237234951, 20.953460017813946, -959.4743404007417, -854.5277393843181, -267.05035286579505, -719.3720725450629, -55.42719697651923, -843.8046845138177, -785.1969132748103, -860.597278660995, -34.369319125123205, 215.63999045399646, -70.81192258656446, -592.7391605182967, -538.9256609592419, 65.85547667675698, -725.8635804387259, -349.10580518929027, 60.37677483556013, -198.72941735577348, 396.04603445922703, -718.8938283474441, -456.91966057178286, -293.56442123878355, -844.2490336721654, 184.69780824168967, -91.95670888195377, -286.51234260427225, -354.59215491415614, 35.83487654513648, -406.14855988550715, -83.86704178900683, -774.3852709842423, 372.4789705182516, -48.55641064218912, -336.033989108638, -300.7265351844165, -608.0379873835919, -630.7558134418242, -990.8344477420866, 285.7772142525826, -259.901684580435, -436.4025275043068, 16.465273287316933, -1019.5647607615587, -741.6461343890951, -681.4335061950284, -1194.4244793360224, -111.27293299921251, 19.861260730725505, 48.46493142180796, 227.1459630932314, -802.6827480599204, -900.0817293758287, -572.0153519048565, 235.70704426177636, -887.4893496316207, -803.5843937083124, -91.93460290415015, -736.6112271162959, 193.7092627245433, -174.2981461813335, -115.28466294915381, -37.2871849047044, -241.99742097450664, -1091.3928806686451, -794.601535475644, 137.2465307398382, -970.6513153878504, -889.5874464968086, 398.2867614427589, -927.8049536055787, -798.708529814463, 77.6339009232292, -827.1873326705222, -969.0199506893575, -431.0224633927355, -1006.5726884236417, 344.88120780623757, -232.00890390006538, 212.5057278185712, 264.0258750890997, -737.9828845770538, 38.88607935637415, -870.2131234968931, -677.0038387610965, 220.67470644504422, 25.620209238457367, -146.48551560175162, -726.8633314456355, -366.3040069348855, -380.7050791683512, -407.10520750619804, 382.03947838444685, -1028.9955179697838, 216.20788858723415, -302.31131429750275, -86.40945858676172, 377.497861073444, -918.7250444487893, -656.1123130615155, -759.740791084978, -141.11745223330715, 345.53140673822065, -508.5410558887737, 24.23732381460896, 151.83026791009155, -276.5533908872496, 373.03821338573005, -182.23955031486167, -757.3310421688188, 20.24121431321872, -905.1545757552004, -873.078796845969, -1078.8671942341443, -248.0783952046309, 287.0871129212848, 396.1989652825074, -849.584526126946, -533.8179561836018, 79.1838887066448, -964.6666940645965, -777.6686845392378, -856.3070248374429, -795.2136809594163, -367.2238694978381, -562.8477460755076, -350.3549989932483, 217.92735135162692, -969.5753222258834, -576.8992987433171, 37.73506211985314, -887.2295776416584, -789.9672096835546, 229.96388853671675, -38.16046449266969, -351.4285633478248, -878.3403058289208, 244.9245888039508, 38.29739917861605, -567.8717100819312, -632.8717875495524, -729.8688781049196, -397.2388934384494, -984.5698055241546, -707.6699587430751, -258.4694646246646, -465.28283151580655, -475.11302555981814, -697.7429049118899, -70.8537173009996, -1169.2451173475263, -1048.4055935014253, 203.26006918603258, -518.9339609667602, -91.38282020692752, -653.1500890865457, 157.53445581043536, -427.4782780409443, -609.5505176114608, -48.20270036383444, -828.6912029921094, -171.73725750985759, 213.53903086246078, -858.234708805726, -38.250396789948624, -602.0411261549222, -513.6695912774691, 234.27039901979052, -422.62668622634993, 329.9389543931219, -668.1792349431411, -613.8790230977353, -522.5330497047881, -630.273220114358, -531.6691953584916, -738.198240840975], "policy_predator_policy_reward": [313.1428260174287, 583.0923461486213, 384.9093164229806, 917.3346481406646, 71.93481407894112, 658.0575581898694, 573.8076582577125, 603.1634278873134, 819.2721544634666, 584.1097110485966, 783.4663013002977, 513.2853411134901, 209.07352334388148, 834.6867576897157, 480.16440198265474, 721.4751757129368, 676.8291328578745, 659.3550376712254, 96.90578721999053, 9.278323689344637, 84.90045585345, 798.7415280886579, 833.0658046108721, 902.1843046470594, 211.71641043979284, 921.2841419085562, 750.2393306854108, 484.0723309853358, 725.8575811736558, 153.83147315472712, 870.0584226030754, 753.0217323626547, 195.78672765304088, 851.361350531549, 60.134110876240854, 343.67297747680345, 594.3991325066276, 547.1256609592422, 669.339143371147, 610.909346311458, 370.60580518929515, 194.42322516443966, 157.1930378786385, 205.40648125512016, 718.8938283474441, 530.9196605717833, 384.2644212387844, 851.8490336721655, 60.034358421338005, 277.8050754383235, 590.6834961417333, 360.830743479203, 278.4062594374281, 315.926165404545, 732.421348823894, 549.0904740908596, 245.27899065330735, 267.64215338620096, 403.9360041317003, 418.0278607144736, 640.6311398058472, 694.6927652928674, 199.21444060802574, 918.8867332026236, 405.41595752613773, 609.3170409491618, 898.4610918505559, 885.2281348382677, 745.7461343890952, 681.4335061950284, 1143.143150232605, 554.8996928558399, 192.8533192691913, 161.50892938686613, 288.48275907618614, 794.858371558655, 820.6492708045818, 888.1268334495824, 523.2946840283869, 805.8541433583615, 798.383790601853, 152.77381916434086, 737.011227116296, 95.23729932635102, 329.9831355285564, 311.5587353145353, 275.98938385717764, 358.88791680863966, 1085.4415224066254, 885.0411696843146, 471.06016262961725, 874.7992657558749, 819.1281092950095, 791.4079231998184, 561.6609031477772, 1187.9114871506295, 732.5710629155179, 541.8051394574934, 999.2892498741342, 540.9144490441264, 1008.1726884236421, 35.98743145347093, 253.80890390006414, 88.29427218142874, 62.03370622485793, 744.8828845770538, 446.31840647353414, 821.3193418265439, 682.0038387610966, 91.55714013378464, 353.80632686072386, 100.09379038852151, 730.058129585983, 352.39613796323187, 423.91057453050286, 403.09716128345843, 378.7097629419177, 959.0435291629501, 329.01929386860235, 1.6498100392552788, 120.00945858676036, 3.30213892655596, 743.9205661286068, 821.1903778888853, 765.556244760422, 271.22944889371354, 26.488361129230746, 513.3192223105508, 50.52230940425091, 105.17402534728232, 295.75339088725394, 3.03204350782511, 500.1153196318202, 700.5570082981476, 863.4348110466218, 687.5234034074343, 873.1787968459689, 1078.8671942341443, 0.8581666148171028, 333.9458625508686, 605.6561213973133, 693.6918096832225, 604.9627521312584, 280.24060368410557, 964.6666940645965, 777.5722485877722, 865.507024837445, 795.5136809594163, 407.5760761397909, 574.0318887503071, 437.3378891200991, 66.48254795412896, 969.5753222258834, 586.599298743317, 667.7202492033415, 638.2617944518911, 712.8260441131473, 669.3825895820679, 347.9970945071786, 448.22013920308683, 817.8253432120875, 545.1754256513912, 509.93487042980894, 552.8899936133486, 633.1717875495525, 730.2688781049197, 649.9193959529755, 816.9082306938716, 723.2699587430757, 262.518779155177, 462.2163535366503, 484.02912214790996, 607.3026024196406, 635.7177093463625, 1228.313508997293, 1056.1275650500663, 298.7346502124588, 524.4732604784971, 554.5721892729011, 632.7896821880855, 529.2965808044258, 92.52867138870512, 697.3844045829197, 9.820463821826362, 779.4011703016901, 519.9018112393427, 550.8325155881107, 777.9659828126046, 255.25658276899, 608.1143430636877, 421.219407773863, 193.0397088430221, 300.0355552119779, 459.270985440714, 875.0335808881235, 575.839335108994, 685.4345136619902, 597.4735905142614, 543.0324448679288, 744.8385924826971]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.909967088359473, "mean_inference_ms": 7.134152494371933, "mean_action_processing_ms": 2.46890567846493, "mean_env_wait_ms": 17.14898730046722, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03119683265686035, "StateBufferConnector_ms": 0.008789658546447754, "ViewRequirementAgentConnector_ms": 0.23564088344573975}, "num_episodes": 15, "episode_return_max": 1119.235347440777, "episode_return_min": -10.713070831310445, "episode_return_mean": 316.4654499746586, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1106208, "num_agent_steps_trained": 1106208, "num_env_steps_sampled": 276552, "num_env_steps_trained": 276552, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 149.47287336612564, "num_env_steps_trained_throughput_per_sec": 149.47287336612564, "timesteps_total": 276552, "num_env_steps_sampled_lifetime": 276552, "num_agent_steps_sampled_lifetime": 1106208, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1106208, "timers": {"training_iteration_time_ms": 27154.706, "restore_workers_time_ms": 0.033, "training_step_time_ms": 27154.226, "sample_time_ms": 3553.824, "learn_time_ms": 23572.947, "learn_throughput": 170.025, "synch_weights_time_ms": 22.791}, "counters": {"num_env_steps_sampled": 276552, "num_env_steps_trained": 276552, "num_agent_steps_sampled": 1106208, "num_agent_steps_trained": 1106208}, "done": false, "training_iteration": 69, "trial_id": "7f713_00000", "date": "2024-08-23_10-17-49", "timestamp": 1724388469, "time_this_iter_s": 26.86562418937683, "time_total_s": 1866.8955800533295, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737a2940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1866.8955800533295, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 40.46578947368421, "ram_util_percent": 82.95526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.26512108025727, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.109326852061761, "policy_loss": -0.0068449395642216715, "vf_loss": 6.114493926618465, "vf_explained_var": 0.6919178384952445, "kl": 0.008389405583933232, "entropy": 0.7301692444180685, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 65678.0, "diff_num_grad_updates_vs_sampler_policy": 489.4476047904173}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.04433974916973, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 5.805500640061798, "policy_loss": -0.01181515107921783, "vf_loss": 5.816661247879109, "vf_explained_var": 0.4261997359139579, "kl": 0.013090866073355, "entropy": 0.43262462229640397, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 65678.0, "diff_num_grad_updates_vs_sampler_policy": 489.4476047904173}}, "num_env_steps_sampled": 280560, "num_env_steps_trained": 280560, "num_agent_steps_sampled": 1122240, "num_agent_steps_trained": 1122240}, "env_runners": {"episode_reward_max": 1119.235347440777, "episode_reward_min": -10.713070831310445, "episode_reward_mean": 303.23770043805445, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1194.4244793360224, "predator_policy": 0.8581666148171028}, "policy_reward_max": {"prey_policy": 398.2867614427589, "predator_policy": 1228.313508997293}, "policy_reward_mean": {"prey_policy": -374.7732719031362, "predator_policy": 526.3921221221635}, "custom_metrics": {}, "hist_stats": {"episode_reward": [340.59088164513395, 341.16399404297647, 194.47967196542072, 112.73356942063475, 104.88978480679958, -5.921442822897664, 152.18148039847017, 548.6351562204761, 9.859971988330944, 620.2403859206362, 276.29999999999944, 559.9161362372164, 74.0, 98.29999999999986, 430.58053321939644, 310.4097421025087, 224.01874150159725, 423.25951014150763, 836.843703915571, 185.20334055311594, 96.53010427329475, 413.0439403211454, 318.42878639055755, 780.5897392145849, 4.1000000000000005, 392.3454307532045, 422.68844080859094, 507.80434566815165, 236.6790229734806, 677.3665220169079, 55.63861315373332, 289.34656205089436, 351.9590617126036, 355.5926947866068, 84.48827594665026, 512.4546437374773, 1119.235347440777, 23.058906878364336, 524.8227706257195, 140.161284836167, 382.4686392597085, 322.60000000000053, 332.95958131395753, 436.310704159564, 317.231846578829, 333.0348108859511, -10.713070831310445, 39.197449139408754, 690.7972525195311, 244.5656781975838, 414.40000000000276, -9.726413492812313, 135.92745033585217, 376.7979342892283, 331.7639264762355, 395.27025689355764, 261.10173544628793, 666.0448530120727, 0.09999999999999343, 373.8127468823409, 845.9623702360972, 430.5692883384079, -0.09643595146559392, 9.499999999999982, 51.53634931674941, 371.39278943260604, 9.699999999999958, 456.4875281334263, 822.2053125483752, 406.6282058697684, 729.5850518385093, 533.2505531398451, 0.7000000000000011, 85.01892768423787, 19.64931453050695, 5.849618608932921, 474.42368955311963, 66.79036319840934, 507.5340189102278, 442.82896216751783, 351.8814299626243, 49.45165042944981, 298.87452103906736, 684.1028204574494, 223.07940288780546, 334.8599243592064, 666.6188088194621, 168.81465795623947, 130.10183435710405, 18.00360115115754, 235.0519911124675, 5.875128047147111, 37.63077591214119, 598.8112955836513, 5.338426937583499, 389.03909108547924, 409.4320216565846, 145.49851784255273, 49.90000000000032, 73.92320074120325], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-333.82530624077094, -209.22579605619882, -841.56079149146, -552.5253237234951, 20.953460017813946, -959.4743404007417, -854.5277393843181, -267.05035286579505, -719.3720725450629, -55.42719697651923, -843.8046845138177, -785.1969132748103, -860.597278660995, -34.369319125123205, 215.63999045399646, -70.81192258656446, -592.7391605182967, -538.9256609592419, 65.85547667675698, -725.8635804387259, -349.10580518929027, 60.37677483556013, -198.72941735577348, 396.04603445922703, -718.8938283474441, -456.91966057178286, -293.56442123878355, -844.2490336721654, 184.69780824168967, -91.95670888195377, -286.51234260427225, -354.59215491415614, 35.83487654513648, -406.14855988550715, -83.86704178900683, -774.3852709842423, 372.4789705182516, -48.55641064218912, -336.033989108638, -300.7265351844165, -608.0379873835919, -630.7558134418242, -990.8344477420866, 285.7772142525826, -259.901684580435, -436.4025275043068, 16.465273287316933, -1019.5647607615587, -741.6461343890951, -681.4335061950284, -1194.4244793360224, -111.27293299921251, 19.861260730725505, 48.46493142180796, 227.1459630932314, -802.6827480599204, -900.0817293758287, -572.0153519048565, 235.70704426177636, -887.4893496316207, -803.5843937083124, -91.93460290415015, -736.6112271162959, 193.7092627245433, -174.2981461813335, -115.28466294915381, -37.2871849047044, -241.99742097450664, -1091.3928806686451, -794.601535475644, 137.2465307398382, -970.6513153878504, -889.5874464968086, 398.2867614427589, -927.8049536055787, -798.708529814463, 77.6339009232292, -827.1873326705222, -969.0199506893575, -431.0224633927355, -1006.5726884236417, 344.88120780623757, -232.00890390006538, 212.5057278185712, 264.0258750890997, -737.9828845770538, 38.88607935637415, -870.2131234968931, -677.0038387610965, 220.67470644504422, 25.620209238457367, -146.48551560175162, -726.8633314456355, -366.3040069348855, -380.7050791683512, -407.10520750619804, 382.03947838444685, -1028.9955179697838, 216.20788858723415, -302.31131429750275, -86.40945858676172, 377.497861073444, -918.7250444487893, -656.1123130615155, -759.740791084978, -141.11745223330715, 345.53140673822065, -508.5410558887737, 24.23732381460896, 151.83026791009155, -276.5533908872496, 373.03821338573005, -182.23955031486167, -757.3310421688188, 20.24121431321872, -905.1545757552004, -873.078796845969, -1078.8671942341443, -248.0783952046309, 287.0871129212848, 396.1989652825074, -849.584526126946, -533.8179561836018, 79.1838887066448, -964.6666940645965, -777.6686845392378, -856.3070248374429, -795.2136809594163, -367.2238694978381, -562.8477460755076, -350.3549989932483, 217.92735135162692, -969.5753222258834, -576.8992987433171, 37.73506211985314, -887.2295776416584, -789.9672096835546, 229.96388853671675, -38.16046449266969, -351.4285633478248, -878.3403058289208, 244.9245888039508, 38.29739917861605, -567.8717100819312, -632.8717875495524, -729.8688781049196, -397.2388934384494, -984.5698055241546, -707.6699587430751, -258.4694646246646, -465.28283151580655, -475.11302555981814, -697.7429049118899, -70.8537173009996, -1169.2451173475263, -1048.4055935014253, 203.26006918603258, -518.9339609667602, -91.38282020692752, -653.1500890865457, 157.53445581043536, -427.4782780409443, -609.5505176114608, -48.20270036383444, -828.6912029921094, -171.73725750985759, 213.53903086246078, -858.234708805726, -38.250396789948624, -602.0411261549222, -513.6695912774691, 234.27039901979052, -422.62668622634993, 329.9389543931219, -668.1792349431411, -613.8790230977353, -522.5330497047881, -630.273220114358, -531.6691953584916, -738.198240840975, 6.743194787700455, -576.7162801412844, -878.7672499224803, -1166.9290563649827, -148.69707846382317, -778.6811491377885, -458.2195955573707, -301.85348146941146, -695.9615381984561, -529.9363763195715, 41.31807732560186, 157.73397531548278, 40.0000000000003, 61.402245395699026, -559.3894697859057, -218.2630345651396, 31.92395956244497, -603.0486102328307, 5.38382294034327, 2.770608157575999], "policy_predator_policy_reward": [84.90045585345, 798.7415280886579, 833.0658046108721, 902.1843046470594, 211.71641043979284, 921.2841419085562, 750.2393306854108, 484.0723309853358, 725.8575811736558, 153.83147315472712, 870.0584226030754, 753.0217323626547, 195.78672765304088, 851.361350531549, 60.134110876240854, 343.67297747680345, 594.3991325066276, 547.1256609592422, 669.339143371147, 610.909346311458, 370.60580518929515, 194.42322516443966, 157.1930378786385, 205.40648125512016, 718.8938283474441, 530.9196605717833, 384.2644212387844, 851.8490336721655, 60.034358421338005, 277.8050754383235, 590.6834961417333, 360.830743479203, 278.4062594374281, 315.926165404545, 732.421348823894, 549.0904740908596, 245.27899065330735, 267.64215338620096, 403.9360041317003, 418.0278607144736, 640.6311398058472, 694.6927652928674, 199.21444060802574, 918.8867332026236, 405.41595752613773, 609.3170409491618, 898.4610918505559, 885.2281348382677, 745.7461343890952, 681.4335061950284, 1143.143150232605, 554.8996928558399, 192.8533192691913, 161.50892938686613, 288.48275907618614, 794.858371558655, 820.6492708045818, 888.1268334495824, 523.2946840283869, 805.8541433583615, 798.383790601853, 152.77381916434086, 737.011227116296, 95.23729932635102, 329.9831355285564, 311.5587353145353, 275.98938385717764, 358.88791680863966, 1085.4415224066254, 885.0411696843146, 471.06016262961725, 874.7992657558749, 819.1281092950095, 791.4079231998184, 561.6609031477772, 1187.9114871506295, 732.5710629155179, 541.8051394574934, 999.2892498741342, 540.9144490441264, 1008.1726884236421, 35.98743145347093, 253.80890390006414, 88.29427218142874, 62.03370622485793, 744.8828845770538, 446.31840647353414, 821.3193418265439, 682.0038387610966, 91.55714013378464, 353.80632686072386, 100.09379038852151, 730.058129585983, 352.39613796323187, 423.91057453050286, 403.09716128345843, 378.7097629419177, 959.0435291629501, 329.01929386860235, 1.6498100392552788, 120.00945858676036, 3.30213892655596, 743.9205661286068, 821.1903778888853, 765.556244760422, 271.22944889371354, 26.488361129230746, 513.3192223105508, 50.52230940425091, 105.17402534728232, 295.75339088725394, 3.03204350782511, 500.1153196318202, 700.5570082981476, 863.4348110466218, 687.5234034074343, 873.1787968459689, 1078.8671942341443, 0.8581666148171028, 333.9458625508686, 605.6561213973133, 693.6918096832225, 604.9627521312584, 280.24060368410557, 964.6666940645965, 777.5722485877722, 865.507024837445, 795.5136809594163, 407.5760761397909, 574.0318887503071, 437.3378891200991, 66.48254795412896, 969.5753222258834, 586.599298743317, 667.7202492033415, 638.2617944518911, 712.8260441131473, 669.3825895820679, 347.9970945071786, 448.22013920308683, 817.8253432120875, 545.1754256513912, 509.93487042980894, 552.8899936133486, 633.1717875495525, 730.2688781049197, 649.9193959529755, 816.9082306938716, 723.2699587430757, 262.518779155177, 462.2163535366503, 484.02912214790996, 607.3026024196406, 635.7177093463625, 1228.313508997293, 1056.1275650500663, 298.7346502124588, 524.4732604784971, 554.5721892729011, 632.7896821880855, 529.2965808044258, 92.52867138870512, 697.3844045829197, 9.820463821826362, 779.4011703016901, 519.9018112393427, 550.8325155881107, 777.9659828126046, 255.25658276899, 608.1143430636877, 421.219407773863, 193.0397088430221, 300.0355552119779, 459.270985440714, 875.0335808881235, 575.839335108994, 685.4345136619902, 597.4735905142614, 543.0324448679288, 744.8385924826971, 439.1702310773249, 365.8548453887274, 877.8799622710093, 1173.691472063601, 177.12785437596267, 787.8811491377883, 753.992800078965, 604.891572531467, 697.4615381984564, 533.7748032571549, 176.06144296302242, 13.925595481369868, 128.0885027444407, 179.94127351644295, 540.9143003783378, 382.2367218152664, 14.27604043755521, 606.748610232831, 32.296780789685684, 33.47198885359858]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.925344586669716, "mean_inference_ms": 7.135475056447081, "mean_action_processing_ms": 2.4732051763045138, "mean_env_wait_ms": 17.159705086767666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028208613395690918, "StateBufferConnector_ms": 0.01075279712677002, "ViewRequirementAgentConnector_ms": 0.2524895668029785}, "num_episodes": 10, "episode_return_max": 1119.235347440777, "episode_return_min": -10.713070831310445, "episode_return_mean": 303.23770043805445, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1122240, "num_agent_steps_trained": 1122240, "num_env_steps_sampled": 280560, "num_env_steps_trained": 280560, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 148.50144861780154, "num_env_steps_trained_throughput_per_sec": 148.50144861780154, "timesteps_total": 280560, "num_env_steps_sampled_lifetime": 280560, "num_agent_steps_sampled_lifetime": 1122240, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1122240, "timers": {"training_iteration_time_ms": 27208.051, "restore_workers_time_ms": 0.033, "training_step_time_ms": 27207.512, "sample_time_ms": 3601.876, "learn_time_ms": 23580.526, "learn_throughput": 169.971, "synch_weights_time_ms": 19.856}, "counters": {"num_env_steps_sampled": 280560, "num_env_steps_trained": 280560, "num_agent_steps_sampled": 1122240, "num_agent_steps_trained": 1122240}, "done": false, "training_iteration": 70, "trial_id": "7f713_00000", "date": "2024-08-23_10-18-16", "timestamp": 1724388496, "time_this_iter_s": 27.045804023742676, "time_total_s": 1893.9413840770721, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737a68b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1893.9413840770721, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 43.77894736842106, "ram_util_percent": 83.12368421052629}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 38.29665795507885, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.97280207689477, "policy_loss": -0.009366520029115713, "vf_loss": 5.980339624011328, "vf_explained_var": 0.6574061483933181, "kl": 0.00914493453240505, "entropy": 0.7192062332516624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 66623.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.228398920493152, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 6.08518088305438, "policy_loss": -0.013207240905317049, "vf_loss": 6.097842771035654, "vf_explained_var": 0.337662123183094, "kl": 0.010906992314343967, "entropy": 0.40022761455919376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 66623.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 284568, "num_env_steps_trained": 284568, "num_agent_steps_sampled": 1138272, "num_agent_steps_trained": 1138272}, "env_runners": {"episode_reward_max": 1119.235347440777, "episode_reward_min": -10.713070831310445, "episode_reward_mean": 305.4524622351818, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1194.4244793360224, "predator_policy": 0.8581666148171028}, "policy_reward_max": {"prey_policy": 398.2867614427589, "predator_policy": 1228.313508997293}, "policy_reward_mean": {"prey_policy": -368.6694182482472, "predator_policy": 521.3956493658384}, "custom_metrics": {}, "hist_stats": {"episode_reward": [276.29999999999944, 559.9161362372164, 74.0, 98.29999999999986, 430.58053321939644, 310.4097421025087, 224.01874150159725, 423.25951014150763, 836.843703915571, 185.20334055311594, 96.53010427329475, 413.0439403211454, 318.42878639055755, 780.5897392145849, 4.1000000000000005, 392.3454307532045, 422.68844080859094, 507.80434566815165, 236.6790229734806, 677.3665220169079, 55.63861315373332, 289.34656205089436, 351.9590617126036, 355.5926947866068, 84.48827594665026, 512.4546437374773, 1119.235347440777, 23.058906878364336, 524.8227706257195, 140.161284836167, 382.4686392597085, 322.60000000000053, 332.95958131395753, 436.310704159564, 317.231846578829, 333.0348108859511, -10.713070831310445, 39.197449139408754, 690.7972525195311, 244.5656781975838, 414.40000000000276, -9.726413492812313, 135.92745033585217, 376.7979342892283, 331.7639264762355, 395.27025689355764, 261.10173544628793, 666.0448530120727, 0.09999999999999343, 373.8127468823409, 845.9623702360972, 430.5692883384079, -0.09643595146559392, 9.499999999999982, 51.53634931674941, 371.39278943260604, 9.699999999999958, 456.4875281334263, 822.2053125483752, 406.6282058697684, 729.5850518385093, 533.2505531398451, 0.7000000000000011, 85.01892768423787, 19.64931453050695, 5.849618608932921, 474.42368955311963, 66.79036319840934, 507.5340189102278, 442.82896216751783, 351.8814299626243, 49.45165042944981, 298.87452103906736, 684.1028204574494, 223.07940288780546, 334.8599243592064, 666.6188088194621, 168.81465795623947, 130.10183435710405, 18.00360115115754, 235.0519911124675, 5.875128047147111, 37.63077591214119, 598.8112955836513, 5.338426937583499, 389.03909108547924, 409.4320216565846, 145.49851784255273, 49.90000000000032, 73.92320074120325, 115.64999999999999, 195.07399089524694, 67.46412787409521, 349.22738900835463, 335.19018249551215, 365.4169563106285, 229.97504684133483, 272.32458583751776, 417.014318842934, 292.99303519309075], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-349.10580518929027, 60.37677483556013, -198.72941735577348, 396.04603445922703, -718.8938283474441, -456.91966057178286, -293.56442123878355, -844.2490336721654, 184.69780824168967, -91.95670888195377, -286.51234260427225, -354.59215491415614, 35.83487654513648, -406.14855988550715, -83.86704178900683, -774.3852709842423, 372.4789705182516, -48.55641064218912, -336.033989108638, -300.7265351844165, -608.0379873835919, -630.7558134418242, -990.8344477420866, 285.7772142525826, -259.901684580435, -436.4025275043068, 16.465273287316933, -1019.5647607615587, -741.6461343890951, -681.4335061950284, -1194.4244793360224, -111.27293299921251, 19.861260730725505, 48.46493142180796, 227.1459630932314, -802.6827480599204, -900.0817293758287, -572.0153519048565, 235.70704426177636, -887.4893496316207, -803.5843937083124, -91.93460290415015, -736.6112271162959, 193.7092627245433, -174.2981461813335, -115.28466294915381, -37.2871849047044, -241.99742097450664, -1091.3928806686451, -794.601535475644, 137.2465307398382, -970.6513153878504, -889.5874464968086, 398.2867614427589, -927.8049536055787, -798.708529814463, 77.6339009232292, -827.1873326705222, -969.0199506893575, -431.0224633927355, -1006.5726884236417, 344.88120780623757, -232.00890390006538, 212.5057278185712, 264.0258750890997, -737.9828845770538, 38.88607935637415, -870.2131234968931, -677.0038387610965, 220.67470644504422, 25.620209238457367, -146.48551560175162, -726.8633314456355, -366.3040069348855, -380.7050791683512, -407.10520750619804, 382.03947838444685, -1028.9955179697838, 216.20788858723415, -302.31131429750275, -86.40945858676172, 377.497861073444, -918.7250444487893, -656.1123130615155, -759.740791084978, -141.11745223330715, 345.53140673822065, -508.5410558887737, 24.23732381460896, 151.83026791009155, -276.5533908872496, 373.03821338573005, -182.23955031486167, -757.3310421688188, 20.24121431321872, -905.1545757552004, -873.078796845969, -1078.8671942341443, -248.0783952046309, 287.0871129212848, 396.1989652825074, -849.584526126946, -533.8179561836018, 79.1838887066448, -964.6666940645965, -777.6686845392378, -856.3070248374429, -795.2136809594163, -367.2238694978381, -562.8477460755076, -350.3549989932483, 217.92735135162692, -969.5753222258834, -576.8992987433171, 37.73506211985314, -887.2295776416584, -789.9672096835546, 229.96388853671675, -38.16046449266969, -351.4285633478248, -878.3403058289208, 244.9245888039508, 38.29739917861605, -567.8717100819312, -632.8717875495524, -729.8688781049196, -397.2388934384494, -984.5698055241546, -707.6699587430751, -258.4694646246646, -465.28283151580655, -475.11302555981814, -697.7429049118899, -70.8537173009996, -1169.2451173475263, -1048.4055935014253, 203.26006918603258, -518.9339609667602, -91.38282020692752, -653.1500890865457, 157.53445581043536, -427.4782780409443, -609.5505176114608, -48.20270036383444, -828.6912029921094, -171.73725750985759, 213.53903086246078, -858.234708805726, -38.250396789948624, -602.0411261549222, -513.6695912774691, 234.27039901979052, -422.62668622634993, 329.9389543931219, -668.1792349431411, -613.8790230977353, -522.5330497047881, -630.273220114358, -531.6691953584916, -738.198240840975, 6.743194787700455, -576.7162801412844, -878.7672499224803, -1166.9290563649827, -148.69707846382317, -778.6811491377885, -458.2195955573707, -301.85348146941146, -695.9615381984561, -529.9363763195715, 41.31807732560186, 157.73397531548278, 40.0000000000003, 61.402245395699026, -559.3894697859057, -218.2630345651396, 31.92395956244497, -603.0486102328307, 5.38382294034327, 2.770608157575999, -665.467585466672, -222.7580289863763, -212.97022077204127, -501.02632491556415, -420.6687037662788, -875.6047060400767, 57.12209837211378, -369.2952520374975, -282.5250023167925, -311.33651788813046, -331.5723363767851, 183.4803759829726, -573.4996586034179, -526.9886866074506, -447.8528987337776, -757.456528830662, -675.685021532179, -167.1888644662961, 17.185968949999804, -637.9698876006896], "policy_predator_policy_reward": [370.60580518929515, 194.42322516443966, 157.1930378786385, 205.40648125512016, 718.8938283474441, 530.9196605717833, 384.2644212387844, 851.8490336721655, 60.034358421338005, 277.8050754383235, 590.6834961417333, 360.830743479203, 278.4062594374281, 315.926165404545, 732.421348823894, 549.0904740908596, 245.27899065330735, 267.64215338620096, 403.9360041317003, 418.0278607144736, 640.6311398058472, 694.6927652928674, 199.21444060802574, 918.8867332026236, 405.41595752613773, 609.3170409491618, 898.4610918505559, 885.2281348382677, 745.7461343890952, 681.4335061950284, 1143.143150232605, 554.8996928558399, 192.8533192691913, 161.50892938686613, 288.48275907618614, 794.858371558655, 820.6492708045818, 888.1268334495824, 523.2946840283869, 805.8541433583615, 798.383790601853, 152.77381916434086, 737.011227116296, 95.23729932635102, 329.9831355285564, 311.5587353145353, 275.98938385717764, 358.88791680863966, 1085.4415224066254, 885.0411696843146, 471.06016262961725, 874.7992657558749, 819.1281092950095, 791.4079231998184, 561.6609031477772, 1187.9114871506295, 732.5710629155179, 541.8051394574934, 999.2892498741342, 540.9144490441264, 1008.1726884236421, 35.98743145347093, 253.80890390006414, 88.29427218142874, 62.03370622485793, 744.8828845770538, 446.31840647353414, 821.3193418265439, 682.0038387610966, 91.55714013378464, 353.80632686072386, 100.09379038852151, 730.058129585983, 352.39613796323187, 423.91057453050286, 403.09716128345843, 378.7097629419177, 959.0435291629501, 329.01929386860235, 1.6498100392552788, 120.00945858676036, 3.30213892655596, 743.9205661286068, 821.1903778888853, 765.556244760422, 271.22944889371354, 26.488361129230746, 513.3192223105508, 50.52230940425091, 105.17402534728232, 295.75339088725394, 3.03204350782511, 500.1153196318202, 700.5570082981476, 863.4348110466218, 687.5234034074343, 873.1787968459689, 1078.8671942341443, 0.8581666148171028, 333.9458625508686, 605.6561213973133, 693.6918096832225, 604.9627521312584, 280.24060368410557, 964.6666940645965, 777.5722485877722, 865.507024837445, 795.5136809594163, 407.5760761397909, 574.0318887503071, 437.3378891200991, 66.48254795412896, 969.5753222258834, 586.599298743317, 667.7202492033415, 638.2617944518911, 712.8260441131473, 669.3825895820679, 347.9970945071786, 448.22013920308683, 817.8253432120875, 545.1754256513912, 509.93487042980894, 552.8899936133486, 633.1717875495525, 730.2688781049197, 649.9193959529755, 816.9082306938716, 723.2699587430757, 262.518779155177, 462.2163535366503, 484.02912214790996, 607.3026024196406, 635.7177093463625, 1228.313508997293, 1056.1275650500663, 298.7346502124588, 524.4732604784971, 554.5721892729011, 632.7896821880855, 529.2965808044258, 92.52867138870512, 697.3844045829197, 9.820463821826362, 779.4011703016901, 519.9018112393427, 550.8325155881107, 777.9659828126046, 255.25658276899, 608.1143430636877, 421.219407773863, 193.0397088430221, 300.0355552119779, 459.270985440714, 875.0335808881235, 575.839335108994, 685.4345136619902, 597.4735905142614, 543.0324448679288, 744.8385924826971, 439.1702310773249, 365.8548453887274, 877.8799622710093, 1173.691472063601, 177.12785437596267, 787.8811491377883, 753.992800078965, 604.891572531467, 697.4615381984564, 533.7748032571549, 176.06144296302242, 13.925595481369868, 128.0885027444407, 179.94127351644295, 540.9143003783378, 382.2367218152664, 14.27604043755521, 606.748610232831, 32.296780789685684, 33.47198885359858, 668.1675854666718, 335.70802898637703, 420.91100046215746, 488.15953612069615, 485.18619342722315, 878.5513442532301, 614.0049830073741, 47.39555966636226, 424.1026179531959, 504.94908474724537, 351.12822681729347, 162.38068988715003, 575.1838254266227, 755.2795666255813, 742.8575708635601, 734.7764425383982, 645.7281532785051, 614.1600515628938, 161.79481058562737, 751.9821432581542]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.928036856455218, "mean_inference_ms": 7.123746138138598, "mean_action_processing_ms": 2.483669331911296, "mean_env_wait_ms": 17.171238195133625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028062820434570312, "StateBufferConnector_ms": 0.010625362396240234, "ViewRequirementAgentConnector_ms": 0.22694909572601318}, "num_episodes": 10, "episode_return_max": 1119.235347440777, "episode_return_min": -10.713070831310445, "episode_return_mean": 305.4524622351818, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1138272, "num_agent_steps_trained": 1138272, "num_env_steps_sampled": 284568, "num_env_steps_trained": 284568, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 151.5468167062242, "num_env_steps_trained_throughput_per_sec": 151.5468167062242, "timesteps_total": 284568, "num_env_steps_sampled_lifetime": 284568, "num_agent_steps_sampled_lifetime": 1138272, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1138272, "timers": {"training_iteration_time_ms": 27081.501, "restore_workers_time_ms": 0.032, "training_step_time_ms": 27080.907, "sample_time_ms": 3436.398, "learn_time_ms": 23618.279, "learn_throughput": 169.699, "synch_weights_time_ms": 20.773}, "counters": {"num_env_steps_sampled": 284568, "num_env_steps_trained": 284568, "num_agent_steps_sampled": 1138272, "num_agent_steps_trained": 1138272}, "done": false, "training_iteration": 71, "trial_id": "7f713_00000", "date": "2024-08-23_10-18-43", "timestamp": 1724388523, "time_this_iter_s": 26.495718240737915, "time_total_s": 1920.43710231781, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737db160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1920.43710231781, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 38.90526315789474, "ram_util_percent": 82.08947368421053}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.741235286975034, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 6.00683251739179, "policy_loss": -0.008978175238346455, "vf_loss": 6.014448309701587, "vf_explained_var": 0.6704356703177962, "kl": 0.006811939967702582, "entropy": 0.7096107356132023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 67568.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.781656570030897, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 6.064099679169831, "policy_loss": -0.011562594646223324, "vf_loss": 6.07510415536386, "vf_explained_var": 0.4153262424090552, "kl": 0.011162387531881451, "entropy": 0.40175496686703316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 67568.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 288576, "num_env_steps_trained": 288576, "num_agent_steps_sampled": 1154304, "num_agent_steps_trained": 1154304}, "env_runners": {"episode_reward_max": 1119.235347440777, "episode_reward_min": -10.713070831310445, "episode_reward_mean": 306.29465879718526, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1194.4244793360224, "predator_policy": 0.8581666148171028}, "policy_reward_max": {"prey_policy": 398.2867614427589, "predator_policy": 1228.313508997293}, "policy_reward_mean": {"prey_policy": -373.9104505050516, "predator_policy": 527.0577799036442}, "custom_metrics": {}, "hist_stats": {"episode_reward": [413.0439403211454, 318.42878639055755, 780.5897392145849, 4.1000000000000005, 392.3454307532045, 422.68844080859094, 507.80434566815165, 236.6790229734806, 677.3665220169079, 55.63861315373332, 289.34656205089436, 351.9590617126036, 355.5926947866068, 84.48827594665026, 512.4546437374773, 1119.235347440777, 23.058906878364336, 524.8227706257195, 140.161284836167, 382.4686392597085, 322.60000000000053, 332.95958131395753, 436.310704159564, 317.231846578829, 333.0348108859511, -10.713070831310445, 39.197449139408754, 690.7972525195311, 244.5656781975838, 414.40000000000276, -9.726413492812313, 135.92745033585217, 376.7979342892283, 331.7639264762355, 395.27025689355764, 261.10173544628793, 666.0448530120727, 0.09999999999999343, 373.8127468823409, 845.9623702360972, 430.5692883384079, -0.09643595146559392, 9.499999999999982, 51.53634931674941, 371.39278943260604, 9.699999999999958, 456.4875281334263, 822.2053125483752, 406.6282058697684, 729.5850518385093, 533.2505531398451, 0.7000000000000011, 85.01892768423787, 19.64931453050695, 5.849618608932921, 474.42368955311963, 66.79036319840934, 507.5340189102278, 442.82896216751783, 351.8814299626243, 49.45165042944981, 298.87452103906736, 684.1028204574494, 223.07940288780546, 334.8599243592064, 666.6188088194621, 168.81465795623947, 130.10183435710405, 18.00360115115754, 235.0519911124675, 5.875128047147111, 37.63077591214119, 598.8112955836513, 5.338426937583499, 389.03909108547924, 409.4320216565846, 145.49851784255273, 49.90000000000032, 73.92320074120325, 115.64999999999999, 195.07399089524694, 67.46412787409521, 349.22738900835463, 335.19018249551215, 365.4169563106285, 229.97504684133483, 272.32458583751776, 417.014318842934, 292.99303519309075, 745.0240685385793, 156.0854207205223, 866.5973405503483, 254.92897767614338, 199.48861301563645, 389.91853421316614, 196.33720145268816, 193.76051231139465, 298.05255899459416, 239.9650965577431, 59.423144113742126], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-990.8344477420866, 285.7772142525826, -259.901684580435, -436.4025275043068, 16.465273287316933, -1019.5647607615587, -741.6461343890951, -681.4335061950284, -1194.4244793360224, -111.27293299921251, 19.861260730725505, 48.46493142180796, 227.1459630932314, -802.6827480599204, -900.0817293758287, -572.0153519048565, 235.70704426177636, -887.4893496316207, -803.5843937083124, -91.93460290415015, -736.6112271162959, 193.7092627245433, -174.2981461813335, -115.28466294915381, -37.2871849047044, -241.99742097450664, -1091.3928806686451, -794.601535475644, 137.2465307398382, -970.6513153878504, -889.5874464968086, 398.2867614427589, -927.8049536055787, -798.708529814463, 77.6339009232292, -827.1873326705222, -969.0199506893575, -431.0224633927355, -1006.5726884236417, 344.88120780623757, -232.00890390006538, 212.5057278185712, 264.0258750890997, -737.9828845770538, 38.88607935637415, -870.2131234968931, -677.0038387610965, 220.67470644504422, 25.620209238457367, -146.48551560175162, -726.8633314456355, -366.3040069348855, -380.7050791683512, -407.10520750619804, 382.03947838444685, -1028.9955179697838, 216.20788858723415, -302.31131429750275, -86.40945858676172, 377.497861073444, -918.7250444487893, -656.1123130615155, -759.740791084978, -141.11745223330715, 345.53140673822065, -508.5410558887737, 24.23732381460896, 151.83026791009155, -276.5533908872496, 373.03821338573005, -182.23955031486167, -757.3310421688188, 20.24121431321872, -905.1545757552004, -873.078796845969, -1078.8671942341443, -248.0783952046309, 287.0871129212848, 396.1989652825074, -849.584526126946, -533.8179561836018, 79.1838887066448, -964.6666940645965, -777.6686845392378, -856.3070248374429, -795.2136809594163, -367.2238694978381, -562.8477460755076, -350.3549989932483, 217.92735135162692, -969.5753222258834, -576.8992987433171, 37.73506211985314, -887.2295776416584, -789.9672096835546, 229.96388853671675, -38.16046449266969, -351.4285633478248, -878.3403058289208, 244.9245888039508, 38.29739917861605, -567.8717100819312, -632.8717875495524, -729.8688781049196, -397.2388934384494, -984.5698055241546, -707.6699587430751, -258.4694646246646, -465.28283151580655, -475.11302555981814, -697.7429049118899, -70.8537173009996, -1169.2451173475263, -1048.4055935014253, 203.26006918603258, -518.9339609667602, -91.38282020692752, -653.1500890865457, 157.53445581043536, -427.4782780409443, -609.5505176114608, -48.20270036383444, -828.6912029921094, -171.73725750985759, 213.53903086246078, -858.234708805726, -38.250396789948624, -602.0411261549222, -513.6695912774691, 234.27039901979052, -422.62668622634993, 329.9389543931219, -668.1792349431411, -613.8790230977353, -522.5330497047881, -630.273220114358, -531.6691953584916, -738.198240840975, 6.743194787700455, -576.7162801412844, -878.7672499224803, -1166.9290563649827, -148.69707846382317, -778.6811491377885, -458.2195955573707, -301.85348146941146, -695.9615381984561, -529.9363763195715, 41.31807732560186, 157.73397531548278, 40.0000000000003, 61.402245395699026, -559.3894697859057, -218.2630345651396, 31.92395956244497, -603.0486102328307, 5.38382294034327, 2.770608157575999, -665.467585466672, -222.7580289863763, -212.97022077204127, -501.02632491556415, -420.6687037662788, -875.6047060400767, 57.12209837211378, -369.2952520374975, -282.5250023167925, -311.33651788813046, -331.5723363767851, 183.4803759829726, -573.4996586034179, -526.9886866074506, -447.8528987337776, -757.456528830662, -675.685021532179, -167.1888644662961, 17.185968949999804, -637.9698876006896, 111.28383390689604, 382.49357904183756, -325.5144620515121, 27.126452312314044, -725.3656746207065, 252.05471923436, -105.68002440556819, -867.9021688235149, -762.5894629369045, 39.05015491176629, -671.5119858870012, 93.35672355431677, -577.4532937675497, -483.5346186278564, -225.79093913491448, -153.66581428498537, -599.858468513026, -60.4599790179242, -315.58565408734216, -475.39691435765855, -793.4592630082675, -543.4037073927819], "policy_predator_policy_reward": [199.21444060802574, 918.8867332026236, 405.41595752613773, 609.3170409491618, 898.4610918505559, 885.2281348382677, 745.7461343890952, 681.4335061950284, 1143.143150232605, 554.8996928558399, 192.8533192691913, 161.50892938686613, 288.48275907618614, 794.858371558655, 820.6492708045818, 888.1268334495824, 523.2946840283869, 805.8541433583615, 798.383790601853, 152.77381916434086, 737.011227116296, 95.23729932635102, 329.9831355285564, 311.5587353145353, 275.98938385717764, 358.88791680863966, 1085.4415224066254, 885.0411696843146, 471.06016262961725, 874.7992657558749, 819.1281092950095, 791.4079231998184, 561.6609031477772, 1187.9114871506295, 732.5710629155179, 541.8051394574934, 999.2892498741342, 540.9144490441264, 1008.1726884236421, 35.98743145347093, 253.80890390006414, 88.29427218142874, 62.03370622485793, 744.8828845770538, 446.31840647353414, 821.3193418265439, 682.0038387610966, 91.55714013378464, 353.80632686072386, 100.09379038852151, 730.058129585983, 352.39613796323187, 423.91057453050286, 403.09716128345843, 378.7097629419177, 959.0435291629501, 329.01929386860235, 1.6498100392552788, 120.00945858676036, 3.30213892655596, 743.9205661286068, 821.1903778888853, 765.556244760422, 271.22944889371354, 26.488361129230746, 513.3192223105508, 50.52230940425091, 105.17402534728232, 295.75339088725394, 3.03204350782511, 500.1153196318202, 700.5570082981476, 863.4348110466218, 687.5234034074343, 873.1787968459689, 1078.8671942341443, 0.8581666148171028, 333.9458625508686, 605.6561213973133, 693.6918096832225, 604.9627521312584, 280.24060368410557, 964.6666940645965, 777.5722485877722, 865.507024837445, 795.5136809594163, 407.5760761397909, 574.0318887503071, 437.3378891200991, 66.48254795412896, 969.5753222258834, 586.599298743317, 667.7202492033415, 638.2617944518911, 712.8260441131473, 669.3825895820679, 347.9970945071786, 448.22013920308683, 817.8253432120875, 545.1754256513912, 509.93487042980894, 552.8899936133486, 633.1717875495525, 730.2688781049197, 649.9193959529755, 816.9082306938716, 723.2699587430757, 262.518779155177, 462.2163535366503, 484.02912214790996, 607.3026024196406, 635.7177093463625, 1228.313508997293, 1056.1275650500663, 298.7346502124588, 524.4732604784971, 554.5721892729011, 632.7896821880855, 529.2965808044258, 92.52867138870512, 697.3844045829197, 9.820463821826362, 779.4011703016901, 519.9018112393427, 550.8325155881107, 777.9659828126046, 255.25658276899, 608.1143430636877, 421.219407773863, 193.0397088430221, 300.0355552119779, 459.270985440714, 875.0335808881235, 575.839335108994, 685.4345136619902, 597.4735905142614, 543.0324448679288, 744.8385924826971, 439.1702310773249, 365.8548453887274, 877.8799622710093, 1173.691472063601, 177.12785437596267, 787.8811491377883, 753.992800078965, 604.891572531467, 697.4615381984564, 533.7748032571549, 176.06144296302242, 13.925595481369868, 128.0885027444407, 179.94127351644295, 540.9143003783378, 382.2367218152664, 14.27604043755521, 606.748610232831, 32.296780789685684, 33.47198885359858, 668.1675854666718, 335.70802898637703, 420.91100046215746, 488.15953612069615, 485.18619342722315, 878.5513442532301, 614.0049830073741, 47.39555966636226, 424.1026179531959, 504.94908474724537, 351.12822681729347, 162.38068988715003, 575.1838254266227, 755.2795666255813, 742.8575708635601, 734.7764425383982, 645.7281532785051, 614.1600515628938, 161.79481058562737, 751.9821432581542, 73.61418035365301, 177.6324752361927, 405.79177116771467, 48.681659292010266, 636.3866702694359, 703.5216256672593, 447.9136948565301, 780.5974760486962, 494.71244114028775, 428.3154799004873, 315.6852668946312, 652.3885296512194, 786.5492854689538, 470.77582837913974, 427.4660639113831, 145.75120181991156, 457.2930279292304, 501.0779785963117, 472.31425907887046, 558.6334059238721, 598.8954985011567, 797.3906160136355]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.94782574375501, "mean_inference_ms": 7.127524264353145, "mean_action_processing_ms": 2.4705216690246186, "mean_env_wait_ms": 17.233024318423272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.028422117233276367, "StateBufferConnector_ms": 0.027103424072265625, "ViewRequirementAgentConnector_ms": 0.24257397651672363}, "num_episodes": 11, "episode_return_max": 1119.235347440777, "episode_return_min": -10.713070831310445, "episode_return_mean": 306.29465879718526, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1154304, "num_agent_steps_trained": 1154304, "num_env_steps_sampled": 288576, "num_env_steps_trained": 288576, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 139.89931682080532, "num_env_steps_trained_throughput_per_sec": 139.89931682080532, "timesteps_total": 288576, "num_env_steps_sampled_lifetime": 288576, "num_agent_steps_sampled_lifetime": 1154304, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1154304, "timers": {"training_iteration_time_ms": 27194.949, "restore_workers_time_ms": 0.033, "training_step_time_ms": 27194.426, "sample_time_ms": 3527.577, "learn_time_ms": 23641.225, "learn_throughput": 169.534, "synch_weights_time_ms": 19.959}, "counters": {"num_env_steps_sampled": 288576, "num_env_steps_trained": 288576, "num_agent_steps_sampled": 1154304, "num_agent_steps_trained": 1154304}, "done": false, "training_iteration": 72, "trial_id": "7f713_00000", "date": "2024-08-23_10-19-11", "timestamp": 1724388551, "time_this_iter_s": 28.706653833389282, "time_total_s": 1949.1437561511993, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1738bc310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1949.1437561511993, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 42.8625, "ram_util_percent": 83.2775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.740094736896495, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.858335846189469, "policy_loss": -0.008405857830845489, "vf_loss": 5.865307334112742, "vf_explained_var": 0.5508416201071764, "kl": 0.007171975490858867, "entropy": 0.7254207744169487, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 68513.0, "diff_num_grad_updates_vs_sampler_policy": 480.95958083831647}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.416837224758492, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 5.82811570192771, "policy_loss": -0.01010643762669393, "vf_loss": 5.837642283162112, "vf_explained_var": 0.46182978329835117, "kl": 0.011596687779165607, "entropy": 0.446613811027436, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 68513.0, "diff_num_grad_updates_vs_sampler_policy": 480.95958083831647}}, "num_env_steps_sampled": 292584, "num_env_steps_trained": 292584, "num_agent_steps_sampled": 1170336, "num_agent_steps_trained": 1170336}, "env_runners": {"episode_reward_max": 1119.235347440777, "episode_reward_min": -77.70355536335052, "episode_reward_mean": 296.90564176938955, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1169.2451173475263, "predator_policy": 0.8581666148171028}, "policy_reward_max": {"prey_policy": 398.2867614427589, "predator_policy": 1228.313508997293}, "policy_reward_mean": {"prey_policy": -365.47346974028267, "predator_policy": 513.9262906249776}, "custom_metrics": {}, "hist_stats": {"episode_reward": [422.68844080859094, 507.80434566815165, 236.6790229734806, 677.3665220169079, 55.63861315373332, 289.34656205089436, 351.9590617126036, 355.5926947866068, 84.48827594665026, 512.4546437374773, 1119.235347440777, 23.058906878364336, 524.8227706257195, 140.161284836167, 382.4686392597085, 322.60000000000053, 332.95958131395753, 436.310704159564, 317.231846578829, 333.0348108859511, -10.713070831310445, 39.197449139408754, 690.7972525195311, 244.5656781975838, 414.40000000000276, -9.726413492812313, 135.92745033585217, 376.7979342892283, 331.7639264762355, 395.27025689355764, 261.10173544628793, 666.0448530120727, 0.09999999999999343, 373.8127468823409, 845.9623702360972, 430.5692883384079, -0.09643595146559392, 9.499999999999982, 51.53634931674941, 371.39278943260604, 9.699999999999958, 456.4875281334263, 822.2053125483752, 406.6282058697684, 729.5850518385093, 533.2505531398451, 0.7000000000000011, 85.01892768423787, 19.64931453050695, 5.849618608932921, 474.42368955311963, 66.79036319840934, 507.5340189102278, 442.82896216751783, 351.8814299626243, 49.45165042944981, 298.87452103906736, 684.1028204574494, 223.07940288780546, 334.8599243592064, 666.6188088194621, 168.81465795623947, 130.10183435710405, 18.00360115115754, 235.0519911124675, 5.875128047147111, 37.63077591214119, 598.8112955836513, 5.338426937583499, 389.03909108547924, 409.4320216565846, 145.49851784255273, 49.90000000000032, 73.92320074120325, 115.64999999999999, 195.07399089524694, 67.46412787409521, 349.22738900835463, 335.19018249551215, 365.4169563106285, 229.97504684133483, 272.32458583751776, 417.014318842934, 292.99303519309075, 745.0240685385793, 156.0854207205223, 866.5973405503483, 254.92897767614338, 199.48861301563645, 389.91853421316614, 196.33720145268816, 193.76051231139465, 298.05255899459416, 239.9650965577431, 59.423144113742126, 188.86888966529023, 222.4290697912087, 127.56892285677954, -77.70355536335052, 508.4428669499943], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [19.861260730725505, 48.46493142180796, 227.1459630932314, -802.6827480599204, -900.0817293758287, -572.0153519048565, 235.70704426177636, -887.4893496316207, -803.5843937083124, -91.93460290415015, -736.6112271162959, 193.7092627245433, -174.2981461813335, -115.28466294915381, -37.2871849047044, -241.99742097450664, -1091.3928806686451, -794.601535475644, 137.2465307398382, -970.6513153878504, -889.5874464968086, 398.2867614427589, -927.8049536055787, -798.708529814463, 77.6339009232292, -827.1873326705222, -969.0199506893575, -431.0224633927355, -1006.5726884236417, 344.88120780623757, -232.00890390006538, 212.5057278185712, 264.0258750890997, -737.9828845770538, 38.88607935637415, -870.2131234968931, -677.0038387610965, 220.67470644504422, 25.620209238457367, -146.48551560175162, -726.8633314456355, -366.3040069348855, -380.7050791683512, -407.10520750619804, 382.03947838444685, -1028.9955179697838, 216.20788858723415, -302.31131429750275, -86.40945858676172, 377.497861073444, -918.7250444487893, -656.1123130615155, -759.740791084978, -141.11745223330715, 345.53140673822065, -508.5410558887737, 24.23732381460896, 151.83026791009155, -276.5533908872496, 373.03821338573005, -182.23955031486167, -757.3310421688188, 20.24121431321872, -905.1545757552004, -873.078796845969, -1078.8671942341443, -248.0783952046309, 287.0871129212848, 396.1989652825074, -849.584526126946, -533.8179561836018, 79.1838887066448, -964.6666940645965, -777.6686845392378, -856.3070248374429, -795.2136809594163, -367.2238694978381, -562.8477460755076, -350.3549989932483, 217.92735135162692, -969.5753222258834, -576.8992987433171, 37.73506211985314, -887.2295776416584, -789.9672096835546, 229.96388853671675, -38.16046449266969, -351.4285633478248, -878.3403058289208, 244.9245888039508, 38.29739917861605, -567.8717100819312, -632.8717875495524, -729.8688781049196, -397.2388934384494, -984.5698055241546, -707.6699587430751, -258.4694646246646, -465.28283151580655, -475.11302555981814, -697.7429049118899, -70.8537173009996, -1169.2451173475263, -1048.4055935014253, 203.26006918603258, -518.9339609667602, -91.38282020692752, -653.1500890865457, 157.53445581043536, -427.4782780409443, -609.5505176114608, -48.20270036383444, -828.6912029921094, -171.73725750985759, 213.53903086246078, -858.234708805726, -38.250396789948624, -602.0411261549222, -513.6695912774691, 234.27039901979052, -422.62668622634993, 329.9389543931219, -668.1792349431411, -613.8790230977353, -522.5330497047881, -630.273220114358, -531.6691953584916, -738.198240840975, 6.743194787700455, -576.7162801412844, -878.7672499224803, -1166.9290563649827, -148.69707846382317, -778.6811491377885, -458.2195955573707, -301.85348146941146, -695.9615381984561, -529.9363763195715, 41.31807732560186, 157.73397531548278, 40.0000000000003, 61.402245395699026, -559.3894697859057, -218.2630345651396, 31.92395956244497, -603.0486102328307, 5.38382294034327, 2.770608157575999, -665.467585466672, -222.7580289863763, -212.97022077204127, -501.02632491556415, -420.6687037662788, -875.6047060400767, 57.12209837211378, -369.2952520374975, -282.5250023167925, -311.33651788813046, -331.5723363767851, 183.4803759829726, -573.4996586034179, -526.9886866074506, -447.8528987337776, -757.456528830662, -675.685021532179, -167.1888644662961, 17.185968949999804, -637.9698876006896, 111.28383390689604, 382.49357904183756, -325.5144620515121, 27.126452312314044, -725.3656746207065, 252.05471923436, -105.68002440556819, -867.9021688235149, -762.5894629369045, 39.05015491176629, -671.5119858870012, 93.35672355431677, -577.4532937675497, -483.5346186278564, -225.79093913491448, -153.66581428498537, -599.858468513026, -60.4599790179242, -315.58565408734216, -475.39691435765855, -793.4592630082675, -543.4037073927819, -786.7659272271155, -276.67149493527154, -146.36651826000804, -624.5439554678755, -827.7937360181888, -50.743229195168176, -236.49060705407118, -365.94793185893525, 152.28720471594062, -282.8056377133846], "policy_predator_policy_reward": [192.8533192691913, 161.50892938686613, 288.48275907618614, 794.858371558655, 820.6492708045818, 888.1268334495824, 523.2946840283869, 805.8541433583615, 798.383790601853, 152.77381916434086, 737.011227116296, 95.23729932635102, 329.9831355285564, 311.5587353145353, 275.98938385717764, 358.88791680863966, 1085.4415224066254, 885.0411696843146, 471.06016262961725, 874.7992657558749, 819.1281092950095, 791.4079231998184, 561.6609031477772, 1187.9114871506295, 732.5710629155179, 541.8051394574934, 999.2892498741342, 540.9144490441264, 1008.1726884236421, 35.98743145347093, 253.80890390006414, 88.29427218142874, 62.03370622485793, 744.8828845770538, 446.31840647353414, 821.3193418265439, 682.0038387610966, 91.55714013378464, 353.80632686072386, 100.09379038852151, 730.058129585983, 352.39613796323187, 423.91057453050286, 403.09716128345843, 378.7097629419177, 959.0435291629501, 329.01929386860235, 1.6498100392552788, 120.00945858676036, 3.30213892655596, 743.9205661286068, 821.1903778888853, 765.556244760422, 271.22944889371354, 26.488361129230746, 513.3192223105508, 50.52230940425091, 105.17402534728232, 295.75339088725394, 3.03204350782511, 500.1153196318202, 700.5570082981476, 863.4348110466218, 687.5234034074343, 873.1787968459689, 1078.8671942341443, 0.8581666148171028, 333.9458625508686, 605.6561213973133, 693.6918096832225, 604.9627521312584, 280.24060368410557, 964.6666940645965, 777.5722485877722, 865.507024837445, 795.5136809594163, 407.5760761397909, 574.0318887503071, 437.3378891200991, 66.48254795412896, 969.5753222258834, 586.599298743317, 667.7202492033415, 638.2617944518911, 712.8260441131473, 669.3825895820679, 347.9970945071786, 448.22013920308683, 817.8253432120875, 545.1754256513912, 509.93487042980894, 552.8899936133486, 633.1717875495525, 730.2688781049197, 649.9193959529755, 816.9082306938716, 723.2699587430757, 262.518779155177, 462.2163535366503, 484.02912214790996, 607.3026024196406, 635.7177093463625, 1228.313508997293, 1056.1275650500663, 298.7346502124588, 524.4732604784971, 554.5721892729011, 632.7896821880855, 529.2965808044258, 92.52867138870512, 697.3844045829197, 9.820463821826362, 779.4011703016901, 519.9018112393427, 550.8325155881107, 777.9659828126046, 255.25658276899, 608.1143430636877, 421.219407773863, 193.0397088430221, 300.0355552119779, 459.270985440714, 875.0335808881235, 575.839335108994, 685.4345136619902, 597.4735905142614, 543.0324448679288, 744.8385924826971, 439.1702310773249, 365.8548453887274, 877.8799622710093, 1173.691472063601, 177.12785437596267, 787.8811491377883, 753.992800078965, 604.891572531467, 697.4615381984564, 533.7748032571549, 176.06144296302242, 13.925595481369868, 128.0885027444407, 179.94127351644295, 540.9143003783378, 382.2367218152664, 14.27604043755521, 606.748610232831, 32.296780789685684, 33.47198885359858, 668.1675854666718, 335.70802898637703, 420.91100046215746, 488.15953612069615, 485.18619342722315, 878.5513442532301, 614.0049830073741, 47.39555966636226, 424.1026179531959, 504.94908474724537, 351.12822681729347, 162.38068988715003, 575.1838254266227, 755.2795666255813, 742.8575708635601, 734.7764425383982, 645.7281532785051, 614.1600515628938, 161.79481058562737, 751.9821432581542, 73.61418035365301, 177.6324752361927, 405.79177116771467, 48.681659292010266, 636.3866702694359, 703.5216256672593, 447.9136948565301, 780.5974760486962, 494.71244114028775, 428.3154799004873, 315.6852668946312, 652.3885296512194, 786.5492854689538, 470.77582837913974, 427.4660639113831, 145.75120181991156, 457.2930279292304, 501.0779785963117, 472.31425907887046, 558.6334059238721, 598.8954985011567, 797.3906160136355, 668.736235297711, 583.5700765299682, 445.12188677133537, 548.2176567477601, 869.26718138979, 136.83870668034618, 410.56462203301675, 114.17036151664048, 146.45566223405376, 492.505637713385]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.962399626272699, "mean_inference_ms": 7.140204016218136, "mean_action_processing_ms": 2.4729861393143637, "mean_env_wait_ms": 17.259851792644135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03358423709869385, "StateBufferConnector_ms": 0.02720928192138672, "ViewRequirementAgentConnector_ms": 0.25519001483917236}, "num_episodes": 5, "episode_return_max": 1119.235347440777, "episode_return_min": -77.70355536335052, "episode_return_mean": 296.90564176938955, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1170336, "num_agent_steps_trained": 1170336, "num_env_steps_sampled": 292584, "num_env_steps_trained": 292584, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 148.33503436084035, "num_env_steps_trained_throughput_per_sec": 148.33503436084035, "timesteps_total": 292584, "num_env_steps_sampled_lifetime": 292584, "num_agent_steps_sampled_lifetime": 1170336, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1170336, "timers": {"training_iteration_time_ms": 27321.418, "restore_workers_time_ms": 0.032, "training_step_time_ms": 27321.03, "sample_time_ms": 3596.384, "learn_time_ms": 23698.004, "learn_throughput": 169.128, "synch_weights_time_ms": 20.991}, "counters": {"num_env_steps_sampled": 292584, "num_env_steps_trained": 292584, "num_agent_steps_sampled": 1170336, "num_agent_steps_trained": 1170336}, "done": false, "training_iteration": 73, "trial_id": "7f713_00000", "date": "2024-08-23_10-19-38", "timestamp": 1724388578, "time_this_iter_s": 27.061951875686646, "time_total_s": 1976.205708026886, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1738bc3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 1976.205708026886, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 39.973684210526315, "ram_util_percent": 82.87894736842104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.19064957830641, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.781340092956705, "policy_loss": -0.010215756489535568, "vf_loss": 5.789857700892857, "vf_explained_var": 0.650216721100782, "kl": 0.008490716092406756, "entropy": 0.7691379180660954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 69458.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.205724988917193, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 5.597589417109414, "policy_loss": -0.01447664826280541, "vf_loss": 5.611343035117659, "vf_explained_var": 0.39709171681177047, "kl": 0.014460274210524938, "entropy": 0.439857614828796, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 69458.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 296592, "num_env_steps_trained": 296592, "num_agent_steps_sampled": 1186368, "num_agent_steps_trained": 1186368}, "env_runners": {"episode_reward_max": 1119.235347440777, "episode_reward_min": -77.70355536335052, "episode_reward_mean": 304.74244794880656, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1169.2451173475263, "predator_policy": 0.8581666148171028}, "policy_reward_max": {"prey_policy": 398.2867614427589, "predator_policy": 1228.313508997293}, "policy_reward_mean": {"prey_policy": -351.6712518027179, "predator_policy": 504.04247577712135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1119.235347440777, 23.058906878364336, 524.8227706257195, 140.161284836167, 382.4686392597085, 322.60000000000053, 332.95958131395753, 436.310704159564, 317.231846578829, 333.0348108859511, -10.713070831310445, 39.197449139408754, 690.7972525195311, 244.5656781975838, 414.40000000000276, -9.726413492812313, 135.92745033585217, 376.7979342892283, 331.7639264762355, 395.27025689355764, 261.10173544628793, 666.0448530120727, 0.09999999999999343, 373.8127468823409, 845.9623702360972, 430.5692883384079, -0.09643595146559392, 9.499999999999982, 51.53634931674941, 371.39278943260604, 9.699999999999958, 456.4875281334263, 822.2053125483752, 406.6282058697684, 729.5850518385093, 533.2505531398451, 0.7000000000000011, 85.01892768423787, 19.64931453050695, 5.849618608932921, 474.42368955311963, 66.79036319840934, 507.5340189102278, 442.82896216751783, 351.8814299626243, 49.45165042944981, 298.87452103906736, 684.1028204574494, 223.07940288780546, 334.8599243592064, 666.6188088194621, 168.81465795623947, 130.10183435710405, 18.00360115115754, 235.0519911124675, 5.875128047147111, 37.63077591214119, 598.8112955836513, 5.338426937583499, 389.03909108547924, 409.4320216565846, 145.49851784255273, 49.90000000000032, 73.92320074120325, 115.64999999999999, 195.07399089524694, 67.46412787409521, 349.22738900835463, 335.19018249551215, 365.4169563106285, 229.97504684133483, 272.32458583751776, 417.014318842934, 292.99303519309075, 745.0240685385793, 156.0854207205223, 866.5973405503483, 254.92897767614338, 199.48861301563645, 389.91853421316614, 196.33720145268816, 193.76051231139465, 298.05255899459416, 239.9650965577431, 59.423144113742126, 188.86888966529023, 222.4290697912087, 127.56892285677954, -77.70355536335052, 508.4428669499943, 56.700000000000536, 20.11384750756612, 673.2474998620639, 689.5135044706277, 649.2940689588006, 284.826447992541, 43.70000000000035, 346.57943752516525, 943.9239944800307, 569.7999999999998], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-889.5874464968086, 398.2867614427589, -927.8049536055787, -798.708529814463, 77.6339009232292, -827.1873326705222, -969.0199506893575, -431.0224633927355, -1006.5726884236417, 344.88120780623757, -232.00890390006538, 212.5057278185712, 264.0258750890997, -737.9828845770538, 38.88607935637415, -870.2131234968931, -677.0038387610965, 220.67470644504422, 25.620209238457367, -146.48551560175162, -726.8633314456355, -366.3040069348855, -380.7050791683512, -407.10520750619804, 382.03947838444685, -1028.9955179697838, 216.20788858723415, -302.31131429750275, -86.40945858676172, 377.497861073444, -918.7250444487893, -656.1123130615155, -759.740791084978, -141.11745223330715, 345.53140673822065, -508.5410558887737, 24.23732381460896, 151.83026791009155, -276.5533908872496, 373.03821338573005, -182.23955031486167, -757.3310421688188, 20.24121431321872, -905.1545757552004, -873.078796845969, -1078.8671942341443, -248.0783952046309, 287.0871129212848, 396.1989652825074, -849.584526126946, -533.8179561836018, 79.1838887066448, -964.6666940645965, -777.6686845392378, -856.3070248374429, -795.2136809594163, -367.2238694978381, -562.8477460755076, -350.3549989932483, 217.92735135162692, -969.5753222258834, -576.8992987433171, 37.73506211985314, -887.2295776416584, -789.9672096835546, 229.96388853671675, -38.16046449266969, -351.4285633478248, -878.3403058289208, 244.9245888039508, 38.29739917861605, -567.8717100819312, -632.8717875495524, -729.8688781049196, -397.2388934384494, -984.5698055241546, -707.6699587430751, -258.4694646246646, -465.28283151580655, -475.11302555981814, -697.7429049118899, -70.8537173009996, -1169.2451173475263, -1048.4055935014253, 203.26006918603258, -518.9339609667602, -91.38282020692752, -653.1500890865457, 157.53445581043536, -427.4782780409443, -609.5505176114608, -48.20270036383444, -828.6912029921094, -171.73725750985759, 213.53903086246078, -858.234708805726, -38.250396789948624, -602.0411261549222, -513.6695912774691, 234.27039901979052, -422.62668622634993, 329.9389543931219, -668.1792349431411, -613.8790230977353, -522.5330497047881, -630.273220114358, -531.6691953584916, -738.198240840975, 6.743194787700455, -576.7162801412844, -878.7672499224803, -1166.9290563649827, -148.69707846382317, -778.6811491377885, -458.2195955573707, -301.85348146941146, -695.9615381984561, -529.9363763195715, 41.31807732560186, 157.73397531548278, 40.0000000000003, 61.402245395699026, -559.3894697859057, -218.2630345651396, 31.92395956244497, -603.0486102328307, 5.38382294034327, 2.770608157575999, -665.467585466672, -222.7580289863763, -212.97022077204127, -501.02632491556415, -420.6687037662788, -875.6047060400767, 57.12209837211378, -369.2952520374975, -282.5250023167925, -311.33651788813046, -331.5723363767851, 183.4803759829726, -573.4996586034179, -526.9886866074506, -447.8528987337776, -757.456528830662, -675.685021532179, -167.1888644662961, 17.185968949999804, -637.9698876006896, 111.28383390689604, 382.49357904183756, -325.5144620515121, 27.126452312314044, -725.3656746207065, 252.05471923436, -105.68002440556819, -867.9021688235149, -762.5894629369045, 39.05015491176629, -671.5119858870012, 93.35672355431677, -577.4532937675497, -483.5346186278564, -225.79093913491448, -153.66581428498537, -599.858468513026, -60.4599790179242, -315.58565408734216, -475.39691435765855, -793.4592630082675, -543.4037073927819, -786.7659272271155, -276.67149493527154, -146.36651826000804, -624.5439554678755, -827.7937360181888, -50.743229195168176, -236.49060705407118, -365.94793185893525, 152.28720471594062, -282.8056377133846, -260.8541664419904, -7.525026412163216, -806.2390210975105, -353.9537199452198, 98.13260758602979, 251.4855340448243, -925.282537836928, 40.0000000000003, -547.9924564376264, 377.8007330400583, -668.90956478121, -267.1439217959423, -179.12136347674752, -386.96149845823254, 184.0330154241452, -533.4400020143923, 148.81128196846151, -1005.422108905781, 339.6302617380312, -94.3820149557481], "policy_predator_policy_reward": [819.1281092950095, 791.4079231998184, 561.6609031477772, 1187.9114871506295, 732.5710629155179, 541.8051394574934, 999.2892498741342, 540.9144490441264, 1008.1726884236421, 35.98743145347093, 253.80890390006414, 88.29427218142874, 62.03370622485793, 744.8828845770538, 446.31840647353414, 821.3193418265439, 682.0038387610966, 91.55714013378464, 353.80632686072386, 100.09379038852151, 730.058129585983, 352.39613796323187, 423.91057453050286, 403.09716128345843, 378.7097629419177, 959.0435291629501, 329.01929386860235, 1.6498100392552788, 120.00945858676036, 3.30213892655596, 743.9205661286068, 821.1903778888853, 765.556244760422, 271.22944889371354, 26.488361129230746, 513.3192223105508, 50.52230940425091, 105.17402534728232, 295.75339088725394, 3.03204350782511, 500.1153196318202, 700.5570082981476, 863.4348110466218, 687.5234034074343, 873.1787968459689, 1078.8671942341443, 0.8581666148171028, 333.9458625508686, 605.6561213973133, 693.6918096832225, 604.9627521312584, 280.24060368410557, 964.6666940645965, 777.5722485877722, 865.507024837445, 795.5136809594163, 407.5760761397909, 574.0318887503071, 437.3378891200991, 66.48254795412896, 969.5753222258834, 586.599298743317, 667.7202492033415, 638.2617944518911, 712.8260441131473, 669.3825895820679, 347.9970945071786, 448.22013920308683, 817.8253432120875, 545.1754256513912, 509.93487042980894, 552.8899936133486, 633.1717875495525, 730.2688781049197, 649.9193959529755, 816.9082306938716, 723.2699587430757, 262.518779155177, 462.2163535366503, 484.02912214790996, 607.3026024196406, 635.7177093463625, 1228.313508997293, 1056.1275650500663, 298.7346502124588, 524.4732604784971, 554.5721892729011, 632.7896821880855, 529.2965808044258, 92.52867138870512, 697.3844045829197, 9.820463821826362, 779.4011703016901, 519.9018112393427, 550.8325155881107, 777.9659828126046, 255.25658276899, 608.1143430636877, 421.219407773863, 193.0397088430221, 300.0355552119779, 459.270985440714, 875.0335808881235, 575.839335108994, 685.4345136619902, 597.4735905142614, 543.0324448679288, 744.8385924826971, 439.1702310773249, 365.8548453887274, 877.8799622710093, 1173.691472063601, 177.12785437596267, 787.8811491377883, 753.992800078965, 604.891572531467, 697.4615381984564, 533.7748032571549, 176.06144296302242, 13.925595481369868, 128.0885027444407, 179.94127351644295, 540.9143003783378, 382.2367218152664, 14.27604043755521, 606.748610232831, 32.296780789685684, 33.47198885359858, 668.1675854666718, 335.70802898637703, 420.91100046215746, 488.15953612069615, 485.18619342722315, 878.5513442532301, 614.0049830073741, 47.39555966636226, 424.1026179531959, 504.94908474724537, 351.12822681729347, 162.38068988715003, 575.1838254266227, 755.2795666255813, 742.8575708635601, 734.7764425383982, 645.7281532785051, 614.1600515628938, 161.79481058562737, 751.9821432581542, 73.61418035365301, 177.6324752361927, 405.79177116771467, 48.681659292010266, 636.3866702694359, 703.5216256672593, 447.9136948565301, 780.5974760486962, 494.71244114028775, 428.3154799004873, 315.6852668946312, 652.3885296512194, 786.5492854689538, 470.77582837913974, 427.4660639113831, 145.75120181991156, 457.2930279292304, 501.0779785963117, 472.31425907887046, 558.6334059238721, 598.8954985011567, 797.3906160136355, 668.736235297711, 583.5700765299682, 445.12188677133537, 548.2176567477601, 869.26718138979, 136.83870668034618, 410.56462203301675, 114.17036151664048, 146.45566223405376, 492.505637713385, 281.85416644199506, 43.22502641216357, 815.5516868093966, 364.7549017409048, 151.2190161766291, 172.41034205458084, 894.4080905285238, 680.3879517790278, 322.5766263014833, 496.9091660548855, 675.2801084691422, 545.5998261005517, 404.7614984582366, 205.02136347674605, 408.060688881951, 287.92573523346135, 1001.4532518449807, 799.0815695723691, 11.069738261968789, 313.4820149557488]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.989779910425653, "mean_inference_ms": 7.157912852457341, "mean_action_processing_ms": 2.470343065814941, "mean_env_wait_ms": 17.280730935121703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03752255439758301, "StateBufferConnector_ms": 0.027287006378173828, "ViewRequirementAgentConnector_ms": 0.25689947605133057}, "num_episodes": 10, "episode_return_max": 1119.235347440777, "episode_return_min": -77.70355536335052, "episode_return_mean": 304.74244794880656, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1186368, "num_agent_steps_trained": 1186368, "num_env_steps_sampled": 296592, "num_env_steps_trained": 296592, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 148.0177156670725, "num_env_steps_trained_throughput_per_sec": 148.0177156670725, "timesteps_total": 296592, "num_env_steps_sampled_lifetime": 296592, "num_agent_steps_sampled_lifetime": 1186368, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1186368, "timers": {"training_iteration_time_ms": 27437.271, "restore_workers_time_ms": 0.032, "training_step_time_ms": 27436.884, "sample_time_ms": 3683.857, "learn_time_ms": 23725.696, "learn_throughput": 168.931, "synch_weights_time_ms": 20.799}, "counters": {"num_env_steps_sampled": 296592, "num_env_steps_trained": 296592, "num_agent_steps_sampled": 1186368, "num_agent_steps_trained": 1186368}, "done": false, "training_iteration": 74, "trial_id": "7f713_00000", "date": "2024-08-23_10-20-06", "timestamp": 1724388606, "time_this_iter_s": 27.117531299591064, "time_total_s": 2003.323239326477, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737db1f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2003.323239326477, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 39.67368421052631, "ram_util_percent": 83.22105263157896}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50.23129406379014, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.902883023559732, "policy_loss": -0.007901596136775518, "vf_loss": 5.909421015542651, "vf_explained_var": 0.7032236449932926, "kl": 0.006817854333067776, "entropy": 0.7686364776873714, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 70403.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.32210020766687, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 5.780282567543958, "policy_loss": -0.012538055748378157, "vf_loss": 5.792308034341802, "vf_explained_var": 0.4434704274727554, "kl": 0.010251842257837769, "entropy": 0.4306185542275666, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 70403.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 300600, "num_env_steps_trained": 300600, "num_agent_steps_sampled": 1202400, "num_agent_steps_trained": 1202400}, "env_runners": {"episode_reward_max": 943.9239944800307, "episode_reward_min": -77.70355536335052, "episode_reward_mean": 298.0906963595931, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1169.2451173475263, "predator_policy": 0.8581666148171028}, "policy_reward_max": {"prey_policy": 396.1989652825074, "predator_policy": 1228.313508997293}, "policy_reward_mean": {"prey_policy": -334.46373946610817, "predator_policy": 483.50908764590497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [322.60000000000053, 332.95958131395753, 436.310704159564, 317.231846578829, 333.0348108859511, -10.713070831310445, 39.197449139408754, 690.7972525195311, 244.5656781975838, 414.40000000000276, -9.726413492812313, 135.92745033585217, 376.7979342892283, 331.7639264762355, 395.27025689355764, 261.10173544628793, 666.0448530120727, 0.09999999999999343, 373.8127468823409, 845.9623702360972, 430.5692883384079, -0.09643595146559392, 9.499999999999982, 51.53634931674941, 371.39278943260604, 9.699999999999958, 456.4875281334263, 822.2053125483752, 406.6282058697684, 729.5850518385093, 533.2505531398451, 0.7000000000000011, 85.01892768423787, 19.64931453050695, 5.849618608932921, 474.42368955311963, 66.79036319840934, 507.5340189102278, 442.82896216751783, 351.8814299626243, 49.45165042944981, 298.87452103906736, 684.1028204574494, 223.07940288780546, 334.8599243592064, 666.6188088194621, 168.81465795623947, 130.10183435710405, 18.00360115115754, 235.0519911124675, 5.875128047147111, 37.63077591214119, 598.8112955836513, 5.338426937583499, 389.03909108547924, 409.4320216565846, 145.49851784255273, 49.90000000000032, 73.92320074120325, 115.64999999999999, 195.07399089524694, 67.46412787409521, 349.22738900835463, 335.19018249551215, 365.4169563106285, 229.97504684133483, 272.32458583751776, 417.014318842934, 292.99303519309075, 745.0240685385793, 156.0854207205223, 866.5973405503483, 254.92897767614338, 199.48861301563645, 389.91853421316614, 196.33720145268816, 193.76051231139465, 298.05255899459416, 239.9650965577431, 59.423144113742126, 188.86888966529023, 222.4290697912087, 127.56892285677954, -77.70355536335052, 508.4428669499943, 56.700000000000536, 20.11384750756612, 673.2474998620639, 689.5135044706277, 649.2940689588006, 284.826447992541, 43.70000000000035, 346.57943752516525, 943.9239944800307, 569.7999999999998, 192.49999999999972, -16.009124153016764, 42.600000000000364, 572.1224706490816, 733.3584436233244], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-232.00890390006538, 212.5057278185712, 264.0258750890997, -737.9828845770538, 38.88607935637415, -870.2131234968931, -677.0038387610965, 220.67470644504422, 25.620209238457367, -146.48551560175162, -726.8633314456355, -366.3040069348855, -380.7050791683512, -407.10520750619804, 382.03947838444685, -1028.9955179697838, 216.20788858723415, -302.31131429750275, -86.40945858676172, 377.497861073444, -918.7250444487893, -656.1123130615155, -759.740791084978, -141.11745223330715, 345.53140673822065, -508.5410558887737, 24.23732381460896, 151.83026791009155, -276.5533908872496, 373.03821338573005, -182.23955031486167, -757.3310421688188, 20.24121431321872, -905.1545757552004, -873.078796845969, -1078.8671942341443, -248.0783952046309, 287.0871129212848, 396.1989652825074, -849.584526126946, -533.8179561836018, 79.1838887066448, -964.6666940645965, -777.6686845392378, -856.3070248374429, -795.2136809594163, -367.2238694978381, -562.8477460755076, -350.3549989932483, 217.92735135162692, -969.5753222258834, -576.8992987433171, 37.73506211985314, -887.2295776416584, -789.9672096835546, 229.96388853671675, -38.16046449266969, -351.4285633478248, -878.3403058289208, 244.9245888039508, 38.29739917861605, -567.8717100819312, -632.8717875495524, -729.8688781049196, -397.2388934384494, -984.5698055241546, -707.6699587430751, -258.4694646246646, -465.28283151580655, -475.11302555981814, -697.7429049118899, -70.8537173009996, -1169.2451173475263, -1048.4055935014253, 203.26006918603258, -518.9339609667602, -91.38282020692752, -653.1500890865457, 157.53445581043536, -427.4782780409443, -609.5505176114608, -48.20270036383444, -828.6912029921094, -171.73725750985759, 213.53903086246078, -858.234708805726, -38.250396789948624, -602.0411261549222, -513.6695912774691, 234.27039901979052, -422.62668622634993, 329.9389543931219, -668.1792349431411, -613.8790230977353, -522.5330497047881, -630.273220114358, -531.6691953584916, -738.198240840975, 6.743194787700455, -576.7162801412844, -878.7672499224803, -1166.9290563649827, -148.69707846382317, -778.6811491377885, -458.2195955573707, -301.85348146941146, -695.9615381984561, -529.9363763195715, 41.31807732560186, 157.73397531548278, 40.0000000000003, 61.402245395699026, -559.3894697859057, -218.2630345651396, 31.92395956244497, -603.0486102328307, 5.38382294034327, 2.770608157575999, -665.467585466672, -222.7580289863763, -212.97022077204127, -501.02632491556415, -420.6687037662788, -875.6047060400767, 57.12209837211378, -369.2952520374975, -282.5250023167925, -311.33651788813046, -331.5723363767851, 183.4803759829726, -573.4996586034179, -526.9886866074506, -447.8528987337776, -757.456528830662, -675.685021532179, -167.1888644662961, 17.185968949999804, -637.9698876006896, 111.28383390689604, 382.49357904183756, -325.5144620515121, 27.126452312314044, -725.3656746207065, 252.05471923436, -105.68002440556819, -867.9021688235149, -762.5894629369045, 39.05015491176629, -671.5119858870012, 93.35672355431677, -577.4532937675497, -483.5346186278564, -225.79093913491448, -153.66581428498537, -599.858468513026, -60.4599790179242, -315.58565408734216, -475.39691435765855, -793.4592630082675, -543.4037073927819, -786.7659272271155, -276.67149493527154, -146.36651826000804, -624.5439554678755, -827.7937360181888, -50.743229195168176, -236.49060705407118, -365.94793185893525, 152.28720471594062, -282.8056377133846, -260.8541664419904, -7.525026412163216, -806.2390210975105, -353.9537199452198, 98.13260758602979, 251.4855340448243, -925.282537836928, 40.0000000000003, -547.9924564376264, 377.8007330400583, -668.90956478121, -267.1439217959423, -179.12136347674752, -386.96149845823254, 184.0330154241452, -533.4400020143923, 148.81128196846151, -1005.422108905781, 339.6302617380312, -94.3820149557481, 20.6719671949523, -167.1004286997205, -838.5321141886757, -364.1375630416517, -321.3503998793265, -236.0136489652609, 118.50220977730827, -476.3996128746296, 319.3352520014693, 357.4253110765973], "policy_predator_policy_reward": [253.80890390006414, 88.29427218142874, 62.03370622485793, 744.8828845770538, 446.31840647353414, 821.3193418265439, 682.0038387610966, 91.55714013378464, 353.80632686072386, 100.09379038852151, 730.058129585983, 352.39613796323187, 423.91057453050286, 403.09716128345843, 378.7097629419177, 959.0435291629501, 329.01929386860235, 1.6498100392552788, 120.00945858676036, 3.30213892655596, 743.9205661286068, 821.1903778888853, 765.556244760422, 271.22944889371354, 26.488361129230746, 513.3192223105508, 50.52230940425091, 105.17402534728232, 295.75339088725394, 3.03204350782511, 500.1153196318202, 700.5570082981476, 863.4348110466218, 687.5234034074343, 873.1787968459689, 1078.8671942341443, 0.8581666148171028, 333.9458625508686, 605.6561213973133, 693.6918096832225, 604.9627521312584, 280.24060368410557, 964.6666940645965, 777.5722485877722, 865.507024837445, 795.5136809594163, 407.5760761397909, 574.0318887503071, 437.3378891200991, 66.48254795412896, 969.5753222258834, 586.599298743317, 667.7202492033415, 638.2617944518911, 712.8260441131473, 669.3825895820679, 347.9970945071786, 448.22013920308683, 817.8253432120875, 545.1754256513912, 509.93487042980894, 552.8899936133486, 633.1717875495525, 730.2688781049197, 649.9193959529755, 816.9082306938716, 723.2699587430757, 262.518779155177, 462.2163535366503, 484.02912214790996, 607.3026024196406, 635.7177093463625, 1228.313508997293, 1056.1275650500663, 298.7346502124588, 524.4732604784971, 554.5721892729011, 632.7896821880855, 529.2965808044258, 92.52867138870512, 697.3844045829197, 9.820463821826362, 779.4011703016901, 519.9018112393427, 550.8325155881107, 777.9659828126046, 255.25658276899, 608.1143430636877, 421.219407773863, 193.0397088430221, 300.0355552119779, 459.270985440714, 875.0335808881235, 575.839335108994, 685.4345136619902, 597.4735905142614, 543.0324448679288, 744.8385924826971, 439.1702310773249, 365.8548453887274, 877.8799622710093, 1173.691472063601, 177.12785437596267, 787.8811491377883, 753.992800078965, 604.891572531467, 697.4615381984564, 533.7748032571549, 176.06144296302242, 13.925595481369868, 128.0885027444407, 179.94127351644295, 540.9143003783378, 382.2367218152664, 14.27604043755521, 606.748610232831, 32.296780789685684, 33.47198885359858, 668.1675854666718, 335.70802898637703, 420.91100046215746, 488.15953612069615, 485.18619342722315, 878.5513442532301, 614.0049830073741, 47.39555966636226, 424.1026179531959, 504.94908474724537, 351.12822681729347, 162.38068988715003, 575.1838254266227, 755.2795666255813, 742.8575708635601, 734.7764425383982, 645.7281532785051, 614.1600515628938, 161.79481058562737, 751.9821432581542, 73.61418035365301, 177.6324752361927, 405.79177116771467, 48.681659292010266, 636.3866702694359, 703.5216256672593, 447.9136948565301, 780.5974760486962, 494.71244114028775, 428.3154799004873, 315.6852668946312, 652.3885296512194, 786.5492854689538, 470.77582837913974, 427.4660639113831, 145.75120181991156, 457.2930279292304, 501.0779785963117, 472.31425907887046, 558.6334059238721, 598.8954985011567, 797.3906160136355, 668.736235297711, 583.5700765299682, 445.12188677133537, 548.2176567477601, 869.26718138979, 136.83870668034618, 410.56462203301675, 114.17036151664048, 146.45566223405376, 492.505637713385, 281.85416644199506, 43.22502641216357, 815.5516868093966, 364.7549017409048, 151.2190161766291, 172.41034205458084, 894.4080905285238, 680.3879517790278, 322.5766263014833, 496.9091660548855, 675.2801084691422, 545.5998261005517, 404.7614984582366, 205.02136347674605, 408.060688881951, 287.92573523346135, 1001.4532518449807, 799.0815695723691, 11.069738261968789, 313.4820149557488, 31.328032805047688, 307.60042869972136, 839.7265594707363, 346.9339936065715, 141.43569656931737, 458.5283522752682, 424.36015473985935, 505.65971900654415, 41.980023347400426, 14.617857197857461]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.997388360906523, "mean_inference_ms": 7.164102860421665, "mean_action_processing_ms": 2.474829242564665, "mean_env_wait_ms": 17.28128705889098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.037218451499938965, "StateBufferConnector_ms": 0.027206897735595703, "ViewRequirementAgentConnector_ms": 0.22941696643829346}, "num_episodes": 5, "episode_return_max": 943.9239944800307, "episode_return_min": -77.70355536335052, "episode_return_mean": 298.0906963595931, "episodes_this_iter": 5}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1202400, "num_agent_steps_trained": 1202400, "num_env_steps_sampled": 300600, "num_env_steps_trained": 300600, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 150.2317581226191, "num_env_steps_trained_throughput_per_sec": 150.2317581226191, "timesteps_total": 300600, "num_env_steps_sampled_lifetime": 300600, "num_agent_steps_sampled_lifetime": 1202400, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1202400, "timers": {"training_iteration_time_ms": 27486.347, "restore_workers_time_ms": 0.032, "training_step_time_ms": 27485.58, "sample_time_ms": 3760.994, "learn_time_ms": 23696.763, "learn_throughput": 169.137, "synch_weights_time_ms": 20.905}, "counters": {"num_env_steps_sampled": 300600, "num_env_steps_trained": 300600, "num_agent_steps_sampled": 1202400, "num_agent_steps_trained": 1202400}, "done": false, "training_iteration": 75, "trial_id": "7f713_00000", "date": "2024-08-23_10-20-32", "timestamp": 1724388632, "time_this_iter_s": 26.73243999481201, "time_total_s": 2030.055679321289, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737b11f0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2030.055679321289, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 38.597368421052636, "ram_util_percent": 82.8578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 65.00029580353429, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.703088183125491, "policy_loss": -0.008561462285637698, "vf_loss": 5.710268784073926, "vf_explained_var": 0.65619342686638, "kl": 0.006904174205255769, "entropy": 0.7872925447408484, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 71348.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.134079610986053, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 5.351310148693266, "policy_loss": -0.007785307753229977, "vf_loss": 5.358642884915468, "vf_explained_var": 0.39142908558012945, "kl": 0.009051289528894125, "entropy": 0.45791903522910266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 71348.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 304608, "num_env_steps_trained": 304608, "num_agent_steps_sampled": 1218432, "num_agent_steps_trained": 1218432}, "env_runners": {"episode_reward_max": 943.9239944800307, "episode_reward_min": -77.70355536335052, "episode_reward_mean": 293.8312930196493, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1169.2451173475263, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 396.1989652825074, "predator_policy": 1228.313508997293}, "policy_reward_mean": {"prey_policy": -332.49298892836333, "predator_policy": 479.4086354381882}, "custom_metrics": {}, "hist_stats": {"episode_reward": [690.7972525195311, 244.5656781975838, 414.40000000000276, -9.726413492812313, 135.92745033585217, 376.7979342892283, 331.7639264762355, 395.27025689355764, 261.10173544628793, 666.0448530120727, 0.09999999999999343, 373.8127468823409, 845.9623702360972, 430.5692883384079, -0.09643595146559392, 9.499999999999982, 51.53634931674941, 371.39278943260604, 9.699999999999958, 456.4875281334263, 822.2053125483752, 406.6282058697684, 729.5850518385093, 533.2505531398451, 0.7000000000000011, 85.01892768423787, 19.64931453050695, 5.849618608932921, 474.42368955311963, 66.79036319840934, 507.5340189102278, 442.82896216751783, 351.8814299626243, 49.45165042944981, 298.87452103906736, 684.1028204574494, 223.07940288780546, 334.8599243592064, 666.6188088194621, 168.81465795623947, 130.10183435710405, 18.00360115115754, 235.0519911124675, 5.875128047147111, 37.63077591214119, 598.8112955836513, 5.338426937583499, 389.03909108547924, 409.4320216565846, 145.49851784255273, 49.90000000000032, 73.92320074120325, 115.64999999999999, 195.07399089524694, 67.46412787409521, 349.22738900835463, 335.19018249551215, 365.4169563106285, 229.97504684133483, 272.32458583751776, 417.014318842934, 292.99303519309075, 745.0240685385793, 156.0854207205223, 866.5973405503483, 254.92897767614338, 199.48861301563645, 389.91853421316614, 196.33720145268816, 193.76051231139465, 298.05255899459416, 239.9650965577431, 59.423144113742126, 188.86888966529023, 222.4290697912087, 127.56892285677954, -77.70355536335052, 508.4428669499943, 56.700000000000536, 20.11384750756612, 673.2474998620639, 689.5135044706277, 649.2940689588006, 284.826447992541, 43.70000000000035, 346.57943752516525, 943.9239944800307, 569.7999999999998, 192.49999999999972, -16.009124153016764, 42.600000000000364, 572.1224706490816, 733.3584436233244, 382.41871057679526, 72.60000000000015, 35.20000000000023, 468.61880675629163, -16.03240499052489, 170.10564387557343, 231.7702310338859], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [382.03947838444685, -1028.9955179697838, 216.20788858723415, -302.31131429750275, -86.40945858676172, 377.497861073444, -918.7250444487893, -656.1123130615155, -759.740791084978, -141.11745223330715, 345.53140673822065, -508.5410558887737, 24.23732381460896, 151.83026791009155, -276.5533908872496, 373.03821338573005, -182.23955031486167, -757.3310421688188, 20.24121431321872, -905.1545757552004, -873.078796845969, -1078.8671942341443, -248.0783952046309, 287.0871129212848, 396.1989652825074, -849.584526126946, -533.8179561836018, 79.1838887066448, -964.6666940645965, -777.6686845392378, -856.3070248374429, -795.2136809594163, -367.2238694978381, -562.8477460755076, -350.3549989932483, 217.92735135162692, -969.5753222258834, -576.8992987433171, 37.73506211985314, -887.2295776416584, -789.9672096835546, 229.96388853671675, -38.16046449266969, -351.4285633478248, -878.3403058289208, 244.9245888039508, 38.29739917861605, -567.8717100819312, -632.8717875495524, -729.8688781049196, -397.2388934384494, -984.5698055241546, -707.6699587430751, -258.4694646246646, -465.28283151580655, -475.11302555981814, -697.7429049118899, -70.8537173009996, -1169.2451173475263, -1048.4055935014253, 203.26006918603258, -518.9339609667602, -91.38282020692752, -653.1500890865457, 157.53445581043536, -427.4782780409443, -609.5505176114608, -48.20270036383444, -828.6912029921094, -171.73725750985759, 213.53903086246078, -858.234708805726, -38.250396789948624, -602.0411261549222, -513.6695912774691, 234.27039901979052, -422.62668622634993, 329.9389543931219, -668.1792349431411, -613.8790230977353, -522.5330497047881, -630.273220114358, -531.6691953584916, -738.198240840975, 6.743194787700455, -576.7162801412844, -878.7672499224803, -1166.9290563649827, -148.69707846382317, -778.6811491377885, -458.2195955573707, -301.85348146941146, -695.9615381984561, -529.9363763195715, 41.31807732560186, 157.73397531548278, 40.0000000000003, 61.402245395699026, -559.3894697859057, -218.2630345651396, 31.92395956244497, -603.0486102328307, 5.38382294034327, 2.770608157575999, -665.467585466672, -222.7580289863763, -212.97022077204127, -501.02632491556415, -420.6687037662788, -875.6047060400767, 57.12209837211378, -369.2952520374975, -282.5250023167925, -311.33651788813046, -331.5723363767851, 183.4803759829726, -573.4996586034179, -526.9886866074506, -447.8528987337776, -757.456528830662, -675.685021532179, -167.1888644662961, 17.185968949999804, -637.9698876006896, 111.28383390689604, 382.49357904183756, -325.5144620515121, 27.126452312314044, -725.3656746207065, 252.05471923436, -105.68002440556819, -867.9021688235149, -762.5894629369045, 39.05015491176629, -671.5119858870012, 93.35672355431677, -577.4532937675497, -483.5346186278564, -225.79093913491448, -153.66581428498537, -599.858468513026, -60.4599790179242, -315.58565408734216, -475.39691435765855, -793.4592630082675, -543.4037073927819, -786.7659272271155, -276.67149493527154, -146.36651826000804, -624.5439554678755, -827.7937360181888, -50.743229195168176, -236.49060705407118, -365.94793185893525, 152.28720471594062, -282.8056377133846, -260.8541664419904, -7.525026412163216, -806.2390210975105, -353.9537199452198, 98.13260758602979, 251.4855340448243, -925.282537836928, 40.0000000000003, -547.9924564376264, 377.8007330400583, -668.90956478121, -267.1439217959423, -179.12136347674752, -386.96149845823254, 184.0330154241452, -533.4400020143923, 148.81128196846151, -1005.422108905781, 339.6302617380312, -94.3820149557481, 20.6719671949523, -167.1004286997205, -838.5321141886757, -364.1375630416517, -321.3503998793265, -236.0136489652609, 118.50220977730827, -476.3996128746296, 319.3352520014693, 357.4253110765973, 2.0038938820532906, -528.3765267182981, 40.0000000000003, -54.40515121905665, -574.5143662738963, -20.684874762092633, 278.46906949246215, -321.1728759128181, -702.2353727559672, -560.2832083501786, -610.3258810531843, 43.5693242677242, -75.93987934436512, -304.9133371477981], "policy_predator_policy_reward": [378.7097629419177, 959.0435291629501, 329.01929386860235, 1.6498100392552788, 120.00945858676036, 3.30213892655596, 743.9205661286068, 821.1903778888853, 765.556244760422, 271.22944889371354, 26.488361129230746, 513.3192223105508, 50.52230940425091, 105.17402534728232, 295.75339088725394, 3.03204350782511, 500.1153196318202, 700.5570082981476, 863.4348110466218, 687.5234034074343, 873.1787968459689, 1078.8671942341443, 0.8581666148171028, 333.9458625508686, 605.6561213973133, 693.6918096832225, 604.9627521312584, 280.24060368410557, 964.6666940645965, 777.5722485877722, 865.507024837445, 795.5136809594163, 407.5760761397909, 574.0318887503071, 437.3378891200991, 66.48254795412896, 969.5753222258834, 586.599298743317, 667.7202492033415, 638.2617944518911, 712.8260441131473, 669.3825895820679, 347.9970945071786, 448.22013920308683, 817.8253432120875, 545.1754256513912, 509.93487042980894, 552.8899936133486, 633.1717875495525, 730.2688781049197, 649.9193959529755, 816.9082306938716, 723.2699587430757, 262.518779155177, 462.2163535366503, 484.02912214790996, 607.3026024196406, 635.7177093463625, 1228.313508997293, 1056.1275650500663, 298.7346502124588, 524.4732604784971, 554.5721892729011, 632.7896821880855, 529.2965808044258, 92.52867138870512, 697.3844045829197, 9.820463821826362, 779.4011703016901, 519.9018112393427, 550.8325155881107, 777.9659828126046, 255.25658276899, 608.1143430636877, 421.219407773863, 193.0397088430221, 300.0355552119779, 459.270985440714, 875.0335808881235, 575.839335108994, 685.4345136619902, 597.4735905142614, 543.0324448679288, 744.8385924826971, 439.1702310773249, 365.8548453887274, 877.8799622710093, 1173.691472063601, 177.12785437596267, 787.8811491377883, 753.992800078965, 604.891572531467, 697.4615381984564, 533.7748032571549, 176.06144296302242, 13.925595481369868, 128.0885027444407, 179.94127351644295, 540.9143003783378, 382.2367218152664, 14.27604043755521, 606.748610232831, 32.296780789685684, 33.47198885359858, 668.1675854666718, 335.70802898637703, 420.91100046215746, 488.15953612069615, 485.18619342722315, 878.5513442532301, 614.0049830073741, 47.39555966636226, 424.1026179531959, 504.94908474724537, 351.12822681729347, 162.38068988715003, 575.1838254266227, 755.2795666255813, 742.8575708635601, 734.7764425383982, 645.7281532785051, 614.1600515628938, 161.79481058562737, 751.9821432581542, 73.61418035365301, 177.6324752361927, 405.79177116771467, 48.681659292010266, 636.3866702694359, 703.5216256672593, 447.9136948565301, 780.5974760486962, 494.71244114028775, 428.3154799004873, 315.6852668946312, 652.3885296512194, 786.5492854689538, 470.77582837913974, 427.4660639113831, 145.75120181991156, 457.2930279292304, 501.0779785963117, 472.31425907887046, 558.6334059238721, 598.8954985011567, 797.3906160136355, 668.736235297711, 583.5700765299682, 445.12188677133537, 548.2176567477601, 869.26718138979, 136.83870668034618, 410.56462203301675, 114.17036151664048, 146.45566223405376, 492.505637713385, 281.85416644199506, 43.22502641216357, 815.5516868093966, 364.7549017409048, 151.2190161766291, 172.41034205458084, 894.4080905285238, 680.3879517790278, 322.5766263014833, 496.9091660548855, 675.2801084691422, 545.5998261005517, 404.7614984582366, 205.02136347674605, 408.060688881951, 287.92573523346135, 1001.4532518449807, 799.0815695723691, 11.069738261968789, 313.4820149557488, 31.328032805047688, 307.60042869972136, 839.7265594707363, 346.9339936065715, 141.43569656931737, 458.5283522752682, 424.36015473985935, 505.65971900654415, 41.980023347400426, 14.617857197857461, 379.66883154939524, 529.122511863643, 0.0, 87.00515121905555, 574.5143662738963, 55.88487476209313, 220.28419745339565, 291.03841572325194, 686.6553404062665, 559.8308357093547, 447.23369660324545, 289.6285040577905, 289.56871875304415, 323.0547287730099]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.987916768776108, "mean_inference_ms": 7.178449649151739, "mean_action_processing_ms": 2.4601687746135683, "mean_env_wait_ms": 17.30536420618284, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.03294086456298828, "StateBufferConnector_ms": 0.023217082023620605, "ViewRequirementAgentConnector_ms": 0.19504761695861816}, "num_episodes": 7, "episode_return_max": 943.9239944800307, "episode_return_min": -77.70355536335052, "episode_return_mean": 293.8312930196493, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1218432, "num_agent_steps_trained": 1218432, "num_env_steps_sampled": 304608, "num_env_steps_trained": 304608, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 149.42886993991678, "num_env_steps_trained_throughput_per_sec": 149.42886993991678, "timesteps_total": 304608, "num_env_steps_sampled_lifetime": 304608, "num_agent_steps_sampled_lifetime": 1218432, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1218432, "timers": {"training_iteration_time_ms": 26976.475, "restore_workers_time_ms": 0.02, "training_step_time_ms": 26975.711, "sample_time_ms": 3288.89, "learn_time_ms": 23658.184, "learn_throughput": 169.413, "synch_weights_time_ms": 21.741}, "counters": {"num_env_steps_sampled": 304608, "num_env_steps_trained": 304608, "num_agent_steps_sampled": 1218432, "num_agent_steps_trained": 1218432}, "done": false, "training_iteration": 76, "trial_id": "7f713_00000", "date": "2024-08-23_10-20-59", "timestamp": 1724388659, "time_this_iter_s": 26.88975691795349, "time_total_s": 2056.9454362392426, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17380cdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2056.9454362392426, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 37.96842105263158, "ram_util_percent": 82.55}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 55.3264116650536, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.289627466252242, "policy_loss": -0.013871038361531363, "vf_loss": 5.301686421651689, "vf_explained_var": 0.6542624460957037, "kl": 0.009060326436899168, "entropy": 0.7864404750248742, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 72293.0, "diff_num_grad_updates_vs_sampler_policy": 489.9191616766475}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.23979445008374, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 5.489158603627846, "policy_loss": -0.007762473194845139, "vf_loss": 5.496504300233548, "vf_explained_var": 0.4113738365904995, "kl": 0.008335598900165192, "entropy": 0.4419082687960731, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 72293.0, "diff_num_grad_updates_vs_sampler_policy": 489.9191616766475}}, "num_env_steps_sampled": 308616, "num_env_steps_trained": 308616, "num_agent_steps_sampled": 1234464, "num_agent_steps_trained": 1234464}, "env_runners": {"episode_reward_max": 943.9239944800307, "episode_reward_min": -77.70355536335052, "episode_reward_mean": 296.55042035624973, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1169.2451173475263, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 396.1989652825074, "predator_policy": 1228.313508997293}, "policy_reward_mean": {"prey_policy": -326.9679377461464, "predator_policy": 475.24314792427145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [373.8127468823409, 845.9623702360972, 430.5692883384079, -0.09643595146559392, 9.499999999999982, 51.53634931674941, 371.39278943260604, 9.699999999999958, 456.4875281334263, 822.2053125483752, 406.6282058697684, 729.5850518385093, 533.2505531398451, 0.7000000000000011, 85.01892768423787, 19.64931453050695, 5.849618608932921, 474.42368955311963, 66.79036319840934, 507.5340189102278, 442.82896216751783, 351.8814299626243, 49.45165042944981, 298.87452103906736, 684.1028204574494, 223.07940288780546, 334.8599243592064, 666.6188088194621, 168.81465795623947, 130.10183435710405, 18.00360115115754, 235.0519911124675, 5.875128047147111, 37.63077591214119, 598.8112955836513, 5.338426937583499, 389.03909108547924, 409.4320216565846, 145.49851784255273, 49.90000000000032, 73.92320074120325, 115.64999999999999, 195.07399089524694, 67.46412787409521, 349.22738900835463, 335.19018249551215, 365.4169563106285, 229.97504684133483, 272.32458583751776, 417.014318842934, 292.99303519309075, 745.0240685385793, 156.0854207205223, 866.5973405503483, 254.92897767614338, 199.48861301563645, 389.91853421316614, 196.33720145268816, 193.76051231139465, 298.05255899459416, 239.9650965577431, 59.423144113742126, 188.86888966529023, 222.4290697912087, 127.56892285677954, -77.70355536335052, 508.4428669499943, 56.700000000000536, 20.11384750756612, 673.2474998620639, 689.5135044706277, 649.2940689588006, 284.826447992541, 43.70000000000035, 346.57943752516525, 943.9239944800307, 569.7999999999998, 192.49999999999972, -16.009124153016764, 42.600000000000364, 572.1224706490816, 733.3584436233244, 382.41871057679526, 72.60000000000015, 35.20000000000023, 468.61880675629163, -16.03240499052489, 170.10564387557343, 231.7702310338859, 152.231037458574, 558.9323482590839, 742.6197929298901, 146.47773473200715, 77.0999999999999, 360.20000000000124, 314.2776507011954, 475.6575129322694, 256.63052287327736, 294.1186984825944, 400.7101089686844], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-248.0783952046309, 287.0871129212848, 396.1989652825074, -849.584526126946, -533.8179561836018, 79.1838887066448, -964.6666940645965, -777.6686845392378, -856.3070248374429, -795.2136809594163, -367.2238694978381, -562.8477460755076, -350.3549989932483, 217.92735135162692, -969.5753222258834, -576.8992987433171, 37.73506211985314, -887.2295776416584, -789.9672096835546, 229.96388853671675, -38.16046449266969, -351.4285633478248, -878.3403058289208, 244.9245888039508, 38.29739917861605, -567.8717100819312, -632.8717875495524, -729.8688781049196, -397.2388934384494, -984.5698055241546, -707.6699587430751, -258.4694646246646, -465.28283151580655, -475.11302555981814, -697.7429049118899, -70.8537173009996, -1169.2451173475263, -1048.4055935014253, 203.26006918603258, -518.9339609667602, -91.38282020692752, -653.1500890865457, 157.53445581043536, -427.4782780409443, -609.5505176114608, -48.20270036383444, -828.6912029921094, -171.73725750985759, 213.53903086246078, -858.234708805726, -38.250396789948624, -602.0411261549222, -513.6695912774691, 234.27039901979052, -422.62668622634993, 329.9389543931219, -668.1792349431411, -613.8790230977353, -522.5330497047881, -630.273220114358, -531.6691953584916, -738.198240840975, 6.743194787700455, -576.7162801412844, -878.7672499224803, -1166.9290563649827, -148.69707846382317, -778.6811491377885, -458.2195955573707, -301.85348146941146, -695.9615381984561, -529.9363763195715, 41.31807732560186, 157.73397531548278, 40.0000000000003, 61.402245395699026, -559.3894697859057, -218.2630345651396, 31.92395956244497, -603.0486102328307, 5.38382294034327, 2.770608157575999, -665.467585466672, -222.7580289863763, -212.97022077204127, -501.02632491556415, -420.6687037662788, -875.6047060400767, 57.12209837211378, -369.2952520374975, -282.5250023167925, -311.33651788813046, -331.5723363767851, 183.4803759829726, -573.4996586034179, -526.9886866074506, -447.8528987337776, -757.456528830662, -675.685021532179, -167.1888644662961, 17.185968949999804, -637.9698876006896, 111.28383390689604, 382.49357904183756, -325.5144620515121, 27.126452312314044, -725.3656746207065, 252.05471923436, -105.68002440556819, -867.9021688235149, -762.5894629369045, 39.05015491176629, -671.5119858870012, 93.35672355431677, -577.4532937675497, -483.5346186278564, -225.79093913491448, -153.66581428498537, -599.858468513026, -60.4599790179242, -315.58565408734216, -475.39691435765855, -793.4592630082675, -543.4037073927819, -786.7659272271155, -276.67149493527154, -146.36651826000804, -624.5439554678755, -827.7937360181888, -50.743229195168176, -236.49060705407118, -365.94793185893525, 152.28720471594062, -282.8056377133846, -260.8541664419904, -7.525026412163216, -806.2390210975105, -353.9537199452198, 98.13260758602979, 251.4855340448243, -925.282537836928, 40.0000000000003, -547.9924564376264, 377.8007330400583, -668.90956478121, -267.1439217959423, -179.12136347674752, -386.96149845823254, 184.0330154241452, -533.4400020143923, 148.81128196846151, -1005.422108905781, 339.6302617380312, -94.3820149557481, 20.6719671949523, -167.1004286997205, -838.5321141886757, -364.1375630416517, -321.3503998793265, -236.0136489652609, 118.50220977730827, -476.3996128746296, 319.3352520014693, 357.4253110765973, 2.0038938820532906, -528.3765267182981, 40.0000000000003, -54.40515121905665, -574.5143662738963, -20.684874762092633, 278.46906949246215, -321.1728759128181, -702.2353727559672, -560.2832083501786, -610.3258810531843, 43.5693242677242, -75.93987934436512, -304.9133371477981, -335.248341824529, -296.34413684003687, 215.5173168554183, -722.9094066084508, 91.87121977063705, -813.401687609118, -290.76774501643615, -124.53714992520662, 40.0000000000003, 8.928659428530674, 225.28838445788972, -44.330529784403645, -180.20969217679465, -40.36945728485079, -1103.3588391986352, -84.70511537455153, -369.0556047120206, -188.53793831843424, 88.23030461111904, -643.4363381843782, -385.10225303868833, -527.0652563543412], "policy_predator_policy_reward": [0.8581666148171028, 333.9458625508686, 605.6561213973133, 693.6918096832225, 604.9627521312584, 280.24060368410557, 964.6666940645965, 777.5722485877722, 865.507024837445, 795.5136809594163, 407.5760761397909, 574.0318887503071, 437.3378891200991, 66.48254795412896, 969.5753222258834, 586.599298743317, 667.7202492033415, 638.2617944518911, 712.8260441131473, 669.3825895820679, 347.9970945071786, 448.22013920308683, 817.8253432120875, 545.1754256513912, 509.93487042980894, 552.8899936133486, 633.1717875495525, 730.2688781049197, 649.9193959529755, 816.9082306938716, 723.2699587430757, 262.518779155177, 462.2163535366503, 484.02912214790996, 607.3026024196406, 635.7177093463625, 1228.313508997293, 1056.1275650500663, 298.7346502124588, 524.4732604784971, 554.5721892729011, 632.7896821880855, 529.2965808044258, 92.52867138870512, 697.3844045829197, 9.820463821826362, 779.4011703016901, 519.9018112393427, 550.8325155881107, 777.9659828126046, 255.25658276899, 608.1143430636877, 421.219407773863, 193.0397088430221, 300.0355552119779, 459.270985440714, 875.0335808881235, 575.839335108994, 685.4345136619902, 597.4735905142614, 543.0324448679288, 744.8385924826971, 439.1702310773249, 365.8548453887274, 877.8799622710093, 1173.691472063601, 177.12785437596267, 787.8811491377883, 753.992800078965, 604.891572531467, 697.4615381984564, 533.7748032571549, 176.06144296302242, 13.925595481369868, 128.0885027444407, 179.94127351644295, 540.9143003783378, 382.2367218152664, 14.27604043755521, 606.748610232831, 32.296780789685684, 33.47198885359858, 668.1675854666718, 335.70802898637703, 420.91100046215746, 488.15953612069615, 485.18619342722315, 878.5513442532301, 614.0049830073741, 47.39555966636226, 424.1026179531959, 504.94908474724537, 351.12822681729347, 162.38068988715003, 575.1838254266227, 755.2795666255813, 742.8575708635601, 734.7764425383982, 645.7281532785051, 614.1600515628938, 161.79481058562737, 751.9821432581542, 73.61418035365301, 177.6324752361927, 405.79177116771467, 48.681659292010266, 636.3866702694359, 703.5216256672593, 447.9136948565301, 780.5974760486962, 494.71244114028775, 428.3154799004873, 315.6852668946312, 652.3885296512194, 786.5492854689538, 470.77582837913974, 427.4660639113831, 145.75120181991156, 457.2930279292304, 501.0779785963117, 472.31425907887046, 558.6334059238721, 598.8954985011567, 797.3906160136355, 668.736235297711, 583.5700765299682, 445.12188677133537, 548.2176567477601, 869.26718138979, 136.83870668034618, 410.56462203301675, 114.17036151664048, 146.45566223405376, 492.505637713385, 281.85416644199506, 43.22502641216357, 815.5516868093966, 364.7549017409048, 151.2190161766291, 172.41034205458084, 894.4080905285238, 680.3879517790278, 322.5766263014833, 496.9091660548855, 675.2801084691422, 545.5998261005517, 404.7614984582366, 205.02136347674605, 408.060688881951, 287.92573523346135, 1001.4532518449807, 799.0815695723691, 11.069738261968789, 313.4820149557488, 31.328032805047688, 307.60042869972136, 839.7265594707363, 346.9339936065715, 141.43569656931737, 458.5283522752682, 424.36015473985935, 505.65971900654415, 41.980023347400426, 14.617857197857461, 379.66883154939524, 529.122511863643, 0.0, 87.00515121905555, 574.5143662738963, 55.88487476209313, 220.28419745339565, 291.03841572325194, 686.6553404062665, 559.8308357093547, 447.23369660324545, 289.6285040577905, 289.56871875304415, 323.0547287730099, 460.18287596258176, 323.6406401605622, 415.3097839257938, 651.0146540863211, 862.1989317237418, 601.9513290446276, 303.2668955370474, 258.51573413660685, 0.0, 28.171340571469443, 101.41161554211025, 77.83052978440315, 312.15253985439034, 222.70426030845107, 1043.8998339916275, 619.8216335138306, 516.0216704739156, 298.2023954298164, 203.2883938714749, 646.0363381843782, 713.9459973398306, 598.9316210218814]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.97602548096828, "mean_inference_ms": 7.166057392936129, "mean_action_processing_ms": 2.4603531632961393, "mean_env_wait_ms": 17.306618053816575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.030954480171203613, "StateBufferConnector_ms": 0.02311408519744873, "ViewRequirementAgentConnector_ms": 0.1875600814819336}, "num_episodes": 11, "episode_return_max": 943.9239944800307, "episode_return_min": -77.70355536335052, "episode_return_mean": 296.55042035624973, "episodes_this_iter": 11}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1234464, "num_agent_steps_trained": 1234464, "num_env_steps_sampled": 308616, "num_env_steps_trained": 308616, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 149.99554166939475, "num_env_steps_trained_throughput_per_sec": 149.99554166939475, "timesteps_total": 308616, "num_env_steps_sampled_lifetime": 308616, "num_agent_steps_sampled_lifetime": 1234464, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1234464, "timers": {"training_iteration_time_ms": 26993.202, "restore_workers_time_ms": 0.024, "training_step_time_ms": 26992.493, "sample_time_ms": 3293.369, "learn_time_ms": 23672.449, "learn_throughput": 169.311, "synch_weights_time_ms": 20.875}, "counters": {"num_env_steps_sampled": 308616, "num_env_steps_trained": 308616, "num_agent_steps_sampled": 1234464, "num_agent_steps_trained": 1234464}, "done": false, "training_iteration": 77, "trial_id": "7f713_00000", "date": "2024-08-23_10-21-26", "timestamp": 1724388686, "time_this_iter_s": 26.79938793182373, "time_total_s": 2083.7448241710663, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17382eca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2083.7448241710663, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 38.53421052631579, "ram_util_percent": 82.71842105263157}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 57.09223085004817, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.991182015938733, "policy_loss": -0.00890086675259881, "vf_loss": 4.998641766946783, "vf_explained_var": 0.6511660229592097, "kl": 0.007205636602230173, "entropy": 0.814796965841263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 73238.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.87009152230762, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 5.106239130383446, "policy_loss": -0.010910314769932518, "vf_loss": 5.116670039848045, "vf_explained_var": 0.3700626637569811, "kl": 0.009588092394794027, "entropy": 0.4946468883721286, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 73238.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 312624, "num_env_steps_trained": 312624, "num_agent_steps_sampled": 1250496, "num_agent_steps_trained": 1250496}, "env_runners": {"episode_reward_max": 943.9239944800307, "episode_reward_min": -77.70355536335052, "episode_reward_mean": 301.7766596030689, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1169.2451173475263, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 382.49357904183756, "predator_policy": 1228.313508997293}, "policy_reward_mean": {"prey_policy": -318.1778053285018, "predator_policy": 469.0661351300364}, "custom_metrics": {}, "hist_stats": {"episode_reward": [533.2505531398451, 0.7000000000000011, 85.01892768423787, 19.64931453050695, 5.849618608932921, 474.42368955311963, 66.79036319840934, 507.5340189102278, 442.82896216751783, 351.8814299626243, 49.45165042944981, 298.87452103906736, 684.1028204574494, 223.07940288780546, 334.8599243592064, 666.6188088194621, 168.81465795623947, 130.10183435710405, 18.00360115115754, 235.0519911124675, 5.875128047147111, 37.63077591214119, 598.8112955836513, 5.338426937583499, 389.03909108547924, 409.4320216565846, 145.49851784255273, 49.90000000000032, 73.92320074120325, 115.64999999999999, 195.07399089524694, 67.46412787409521, 349.22738900835463, 335.19018249551215, 365.4169563106285, 229.97504684133483, 272.32458583751776, 417.014318842934, 292.99303519309075, 745.0240685385793, 156.0854207205223, 866.5973405503483, 254.92897767614338, 199.48861301563645, 389.91853421316614, 196.33720145268816, 193.76051231139465, 298.05255899459416, 239.9650965577431, 59.423144113742126, 188.86888966529023, 222.4290697912087, 127.56892285677954, -77.70355536335052, 508.4428669499943, 56.700000000000536, 20.11384750756612, 673.2474998620639, 689.5135044706277, 649.2940689588006, 284.826447992541, 43.70000000000035, 346.57943752516525, 943.9239944800307, 569.7999999999998, 192.49999999999972, -16.009124153016764, 42.600000000000364, 572.1224706490816, 733.3584436233244, 382.41871057679526, 72.60000000000015, 35.20000000000023, 468.61880675629163, -16.03240499052489, 170.10564387557343, 231.7702310338859, 152.231037458574, 558.9323482590839, 742.6197929298901, 146.47773473200715, 77.0999999999999, 360.20000000000124, 314.2776507011954, 475.6575129322694, 256.63052287327736, 294.1186984825944, 400.7101089686844, 566.2156422943103, 273.1143853162937, 381.18556830248707, 866.6204886780537, 61.42570492236197, 335.5073981213847, 59.934354263909775, 383.6661580002408, 276.36145651808863, 482.0832833187516, 817.7919848644717, 526.0007067263783], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [38.29739917861605, -567.8717100819312, -632.8717875495524, -729.8688781049196, -397.2388934384494, -984.5698055241546, -707.6699587430751, -258.4694646246646, -465.28283151580655, -475.11302555981814, -697.7429049118899, -70.8537173009996, -1169.2451173475263, -1048.4055935014253, 203.26006918603258, -518.9339609667602, -91.38282020692752, -653.1500890865457, 157.53445581043536, -427.4782780409443, -609.5505176114608, -48.20270036383444, -828.6912029921094, -171.73725750985759, 213.53903086246078, -858.234708805726, -38.250396789948624, -602.0411261549222, -513.6695912774691, 234.27039901979052, -422.62668622634993, 329.9389543931219, -668.1792349431411, -613.8790230977353, -522.5330497047881, -630.273220114358, -531.6691953584916, -738.198240840975, 6.743194787700455, -576.7162801412844, -878.7672499224803, -1166.9290563649827, -148.69707846382317, -778.6811491377885, -458.2195955573707, -301.85348146941146, -695.9615381984561, -529.9363763195715, 41.31807732560186, 157.73397531548278, 40.0000000000003, 61.402245395699026, -559.3894697859057, -218.2630345651396, 31.92395956244497, -603.0486102328307, 5.38382294034327, 2.770608157575999, -665.467585466672, -222.7580289863763, -212.97022077204127, -501.02632491556415, -420.6687037662788, -875.6047060400767, 57.12209837211378, -369.2952520374975, -282.5250023167925, -311.33651788813046, -331.5723363767851, 183.4803759829726, -573.4996586034179, -526.9886866074506, -447.8528987337776, -757.456528830662, -675.685021532179, -167.1888644662961, 17.185968949999804, -637.9698876006896, 111.28383390689604, 382.49357904183756, -325.5144620515121, 27.126452312314044, -725.3656746207065, 252.05471923436, -105.68002440556819, -867.9021688235149, -762.5894629369045, 39.05015491176629, -671.5119858870012, 93.35672355431677, -577.4532937675497, -483.5346186278564, -225.79093913491448, -153.66581428498537, -599.858468513026, -60.4599790179242, -315.58565408734216, -475.39691435765855, -793.4592630082675, -543.4037073927819, -786.7659272271155, -276.67149493527154, -146.36651826000804, -624.5439554678755, -827.7937360181888, -50.743229195168176, -236.49060705407118, -365.94793185893525, 152.28720471594062, -282.8056377133846, -260.8541664419904, -7.525026412163216, -806.2390210975105, -353.9537199452198, 98.13260758602979, 251.4855340448243, -925.282537836928, 40.0000000000003, -547.9924564376264, 377.8007330400583, -668.90956478121, -267.1439217959423, -179.12136347674752, -386.96149845823254, 184.0330154241452, -533.4400020143923, 148.81128196846151, -1005.422108905781, 339.6302617380312, -94.3820149557481, 20.6719671949523, -167.1004286997205, -838.5321141886757, -364.1375630416517, -321.3503998793265, -236.0136489652609, 118.50220977730827, -476.3996128746296, 319.3352520014693, 357.4253110765973, 2.0038938820532906, -528.3765267182981, 40.0000000000003, -54.40515121905665, -574.5143662738963, -20.684874762092633, 278.46906949246215, -321.1728759128181, -702.2353727559672, -560.2832083501786, -610.3258810531843, 43.5693242677242, -75.93987934436512, -304.9133371477981, -335.248341824529, -296.34413684003687, 215.5173168554183, -722.9094066084508, 91.87121977063705, -813.401687609118, -290.76774501643615, -124.53714992520662, 40.0000000000003, 8.928659428530674, 225.28838445788972, -44.330529784403645, -180.20969217679465, -40.36945728485079, -1103.3588391986352, -84.70511537455153, -369.0556047120206, -188.53793831843424, 88.23030461111904, -643.4363381843782, -385.10225303868833, -527.0652563543412, -650.355823477969, 226.43621797564464, -626.9816350754651, -308.33331768028825, 329.5942871609332, -698.2935511157868, -765.7094686659196, 358.3661972944681, -632.9235997999602, -48.36029818721135, -665.7101009098845, 32.05787757620863, -802.1628125696059, -50.18199326768572, -19.533284974043134, -558.0316985789439, -491.5294268069497, -282.14213229879573, -730.40806266148, -95.62970870873255, 241.37114553354556, -849.0638493916041, -595.2040541624476, 136.41211559718215], "policy_predator_policy_reward": [509.93487042980894, 552.8899936133486, 633.1717875495525, 730.2688781049197, 649.9193959529755, 816.9082306938716, 723.2699587430757, 262.518779155177, 462.2163535366503, 484.02912214790996, 607.3026024196406, 635.7177093463625, 1228.313508997293, 1056.1275650500663, 298.7346502124588, 524.4732604784971, 554.5721892729011, 632.7896821880855, 529.2965808044258, 92.52867138870512, 697.3844045829197, 9.820463821826362, 779.4011703016901, 519.9018112393427, 550.8325155881107, 777.9659828126046, 255.25658276899, 608.1143430636877, 421.219407773863, 193.0397088430221, 300.0355552119779, 459.270985440714, 875.0335808881235, 575.839335108994, 685.4345136619902, 597.4735905142614, 543.0324448679288, 744.8385924826971, 439.1702310773249, 365.8548453887274, 877.8799622710093, 1173.691472063601, 177.12785437596267, 787.8811491377883, 753.992800078965, 604.891572531467, 697.4615381984564, 533.7748032571549, 176.06144296302242, 13.925595481369868, 128.0885027444407, 179.94127351644295, 540.9143003783378, 382.2367218152664, 14.27604043755521, 606.748610232831, 32.296780789685684, 33.47198885359858, 668.1675854666718, 335.70802898637703, 420.91100046215746, 488.15953612069615, 485.18619342722315, 878.5513442532301, 614.0049830073741, 47.39555966636226, 424.1026179531959, 504.94908474724537, 351.12822681729347, 162.38068988715003, 575.1838254266227, 755.2795666255813, 742.8575708635601, 734.7764425383982, 645.7281532785051, 614.1600515628938, 161.79481058562737, 751.9821432581542, 73.61418035365301, 177.6324752361927, 405.79177116771467, 48.681659292010266, 636.3866702694359, 703.5216256672593, 447.9136948565301, 780.5974760486962, 494.71244114028775, 428.3154799004873, 315.6852668946312, 652.3885296512194, 786.5492854689538, 470.77582837913974, 427.4660639113831, 145.75120181991156, 457.2930279292304, 501.0779785963117, 472.31425907887046, 558.6334059238721, 598.8954985011567, 797.3906160136355, 668.736235297711, 583.5700765299682, 445.12188677133537, 548.2176567477601, 869.26718138979, 136.83870668034618, 410.56462203301675, 114.17036151664048, 146.45566223405376, 492.505637713385, 281.85416644199506, 43.22502641216357, 815.5516868093966, 364.7549017409048, 151.2190161766291, 172.41034205458084, 894.4080905285238, 680.3879517790278, 322.5766263014833, 496.9091660548855, 675.2801084691422, 545.5998261005517, 404.7614984582366, 205.02136347674605, 408.060688881951, 287.92573523346135, 1001.4532518449807, 799.0815695723691, 11.069738261968789, 313.4820149557488, 31.328032805047688, 307.60042869972136, 839.7265594707363, 346.9339936065715, 141.43569656931737, 458.5283522752682, 424.36015473985935, 505.65971900654415, 41.980023347400426, 14.617857197857461, 379.66883154939524, 529.122511863643, 0.0, 87.00515121905555, 574.5143662738963, 55.88487476209313, 220.28419745339565, 291.03841572325194, 686.6553404062665, 559.8308357093547, 447.23369660324545, 289.6285040577905, 289.56871875304415, 323.0547287730099, 460.18287596258176, 323.6406401605622, 415.3097839257938, 651.0146540863211, 862.1989317237418, 601.9513290446276, 303.2668955370474, 258.51573413660685, 0.0, 28.171340571469443, 101.41161554211025, 77.83052978440315, 312.15253985439034, 222.70426030845107, 1043.8998339916275, 619.8216335138306, 516.0216704739156, 298.2023954298164, 203.2883938714749, 646.0363381843782, 713.9459973398306, 598.9316210218814, 594.7721791966211, 395.3630686000111, 607.4340646869647, 600.9952733850886, 60.55111349376079, 689.3337187635797, 624.9029703919385, 649.0607896575688, 108.39743466543979, 634.3121682440931, 601.7560413890849, 367.40358006597154, 788.0057765190581, 124.27338358214213, 459.1759770020197, 502.0551645512087, 630.2934920579937, 419.7395235658412, 666.2160079762726, 641.9050467126873, 687.322479629349, 738.1622090931797, 454.1240143884287, 530.6686309032149]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.967589416815503, "mean_inference_ms": 7.153462939910104, "mean_action_processing_ms": 2.4609817477300546, "mean_env_wait_ms": 17.316831264435404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01670682430267334, "StateBufferConnector_ms": 0.02373826503753662, "ViewRequirementAgentConnector_ms": 0.1893218755722046}, "num_episodes": 12, "episode_return_max": 943.9239944800307, "episode_return_min": -77.70355536335052, "episode_return_mean": 301.7766596030689, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1250496, "num_agent_steps_trained": 1250496, "num_env_steps_sampled": 312624, "num_env_steps_trained": 312624, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 150.47406675489896, "num_env_steps_trained_throughput_per_sec": 150.47406675489896, "timesteps_total": 312624, "num_env_steps_sampled_lifetime": 312624, "num_agent_steps_sampled_lifetime": 1250496, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1250496, "timers": {"training_iteration_time_ms": 26985.581, "restore_workers_time_ms": 0.023, "training_step_time_ms": 26984.64, "sample_time_ms": 3238.005, "learn_time_ms": 23720.126, "learn_throughput": 168.97, "synch_weights_time_ms": 20.53}, "counters": {"num_env_steps_sampled": 312624, "num_env_steps_trained": 312624, "num_agent_steps_sampled": 1250496, "num_agent_steps_trained": 1250496}, "done": false, "training_iteration": 78, "trial_id": "7f713_00000", "date": "2024-08-23_10-21-53", "timestamp": 1724388713, "time_this_iter_s": 26.676064014434814, "time_total_s": 2110.420888185501, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737538b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2110.420888185501, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 38.913157894736834, "ram_util_percent": 82.87631578947368}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 67.09580328981713, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.021705923635493, "policy_loss": -0.0105110145011355, "vf_loss": 5.030723505171519, "vf_explained_var": 0.6833984557913725, "kl": 0.007467156692245414, "entropy": 0.8493205367572724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 74183.0, "diff_num_grad_updates_vs_sampler_policy": 489.4476047904173}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.601806293467366, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 4.681657385195374, "policy_loss": -0.013445271249545157, "vf_loss": 4.6945732321058005, "vf_explained_var": 0.41918937062460276, "kl": 0.010588655697684439, "entropy": 0.5554527295329583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 74183.0, "diff_num_grad_updates_vs_sampler_policy": 489.4476047904173}}, "num_env_steps_sampled": 316632, "num_env_steps_trained": 316632, "num_agent_steps_sampled": 1266528, "num_agent_steps_trained": 1266528}, "env_runners": {"episode_reward_max": 943.9239944800307, "episode_reward_min": -77.70355536335052, "episode_reward_mean": 304.6710977088537, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1166.9290563649827, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.773646311491, "predator_policy": 1173.691472063601}, "policy_reward_mean": {"prey_policy": -286.5583986788473, "predator_policy": 438.8939475332743}, "custom_metrics": {}, "hist_stats": {"episode_reward": [666.6188088194621, 168.81465795623947, 130.10183435710405, 18.00360115115754, 235.0519911124675, 5.875128047147111, 37.63077591214119, 598.8112955836513, 5.338426937583499, 389.03909108547924, 409.4320216565846, 145.49851784255273, 49.90000000000032, 73.92320074120325, 115.64999999999999, 195.07399089524694, 67.46412787409521, 349.22738900835463, 335.19018249551215, 365.4169563106285, 229.97504684133483, 272.32458583751776, 417.014318842934, 292.99303519309075, 745.0240685385793, 156.0854207205223, 866.5973405503483, 254.92897767614338, 199.48861301563645, 389.91853421316614, 196.33720145268816, 193.76051231139465, 298.05255899459416, 239.9650965577431, 59.423144113742126, 188.86888966529023, 222.4290697912087, 127.56892285677954, -77.70355536335052, 508.4428669499943, 56.700000000000536, 20.11384750756612, 673.2474998620639, 689.5135044706277, 649.2940689588006, 284.826447992541, 43.70000000000035, 346.57943752516525, 943.9239944800307, 569.7999999999998, 192.49999999999972, -16.009124153016764, 42.600000000000364, 572.1224706490816, 733.3584436233244, 382.41871057679526, 72.60000000000015, 35.20000000000023, 468.61880675629163, -16.03240499052489, 170.10564387557343, 231.7702310338859, 152.231037458574, 558.9323482590839, 742.6197929298901, 146.47773473200715, 77.0999999999999, 360.20000000000124, 314.2776507011954, 475.6575129322694, 256.63052287327736, 294.1186984825944, 400.7101089686844, 566.2156422943103, 273.1143853162937, 381.18556830248707, 866.6204886780537, 61.42570492236197, 335.5073981213847, 59.934354263909775, 383.6661580002408, 276.36145651808863, 482.0832833187516, 817.7919848644717, 526.0007067263783, 105.31176927848367, 608.2968343020013, 430.50461491403985, 70.10000000000029, 355.9144429721273, 269.1593231156196, 7.370019758808223, 497.6104128455491, 285.90206174590077, 370.2734462849014, 311.8345030790993, 269.15046502697817, 50.23351013759192, 35.66007139474958, 700.4175326510401], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-422.62668622634993, 329.9389543931219, -668.1792349431411, -613.8790230977353, -522.5330497047881, -630.273220114358, -531.6691953584916, -738.198240840975, 6.743194787700455, -576.7162801412844, -878.7672499224803, -1166.9290563649827, -148.69707846382317, -778.6811491377885, -458.2195955573707, -301.85348146941146, -695.9615381984561, -529.9363763195715, 41.31807732560186, 157.73397531548278, 40.0000000000003, 61.402245395699026, -559.3894697859057, -218.2630345651396, 31.92395956244497, -603.0486102328307, 5.38382294034327, 2.770608157575999, -665.467585466672, -222.7580289863763, -212.97022077204127, -501.02632491556415, -420.6687037662788, -875.6047060400767, 57.12209837211378, -369.2952520374975, -282.5250023167925, -311.33651788813046, -331.5723363767851, 183.4803759829726, -573.4996586034179, -526.9886866074506, -447.8528987337776, -757.456528830662, -675.685021532179, -167.1888644662961, 17.185968949999804, -637.9698876006896, 111.28383390689604, 382.49357904183756, -325.5144620515121, 27.126452312314044, -725.3656746207065, 252.05471923436, -105.68002440556819, -867.9021688235149, -762.5894629369045, 39.05015491176629, -671.5119858870012, 93.35672355431677, -577.4532937675497, -483.5346186278564, -225.79093913491448, -153.66581428498537, -599.858468513026, -60.4599790179242, -315.58565408734216, -475.39691435765855, -793.4592630082675, -543.4037073927819, -786.7659272271155, -276.67149493527154, -146.36651826000804, -624.5439554678755, -827.7937360181888, -50.743229195168176, -236.49060705407118, -365.94793185893525, 152.28720471594062, -282.8056377133846, -260.8541664419904, -7.525026412163216, -806.2390210975105, -353.9537199452198, 98.13260758602979, 251.4855340448243, -925.282537836928, 40.0000000000003, -547.9924564376264, 377.8007330400583, -668.90956478121, -267.1439217959423, -179.12136347674752, -386.96149845823254, 184.0330154241452, -533.4400020143923, 148.81128196846151, -1005.422108905781, 339.6302617380312, -94.3820149557481, 20.6719671949523, -167.1004286997205, -838.5321141886757, -364.1375630416517, -321.3503998793265, -236.0136489652609, 118.50220977730827, -476.3996128746296, 319.3352520014693, 357.4253110765973, 2.0038938820532906, -528.3765267182981, 40.0000000000003, -54.40515121905665, -574.5143662738963, -20.684874762092633, 278.46906949246215, -321.1728759128181, -702.2353727559672, -560.2832083501786, -610.3258810531843, 43.5693242677242, -75.93987934436512, -304.9133371477981, -335.248341824529, -296.34413684003687, 215.5173168554183, -722.9094066084508, 91.87121977063705, -813.401687609118, -290.76774501643615, -124.53714992520662, 40.0000000000003, 8.928659428530674, 225.28838445788972, -44.330529784403645, -180.20969217679465, -40.36945728485079, -1103.3588391986352, -84.70511537455153, -369.0556047120206, -188.53793831843424, 88.23030461111904, -643.4363381843782, -385.10225303868833, -527.0652563543412, -650.355823477969, 226.43621797564464, -626.9816350754651, -308.33331768028825, 329.5942871609332, -698.2935511157868, -765.7094686659196, 358.3661972944681, -632.9235997999602, -48.36029818721135, -665.7101009098845, 32.05787757620863, -802.1628125696059, -50.18199326768572, -19.533284974043134, -558.0316985789439, -491.5294268069497, -282.14213229879573, -730.40806266148, -95.62970870873255, 241.37114553354556, -849.0638493916041, -595.2040541624476, 136.41211559718215, -238.400356476289, -205.84678057296586, -91.76046427771831, 260.62568272792583, -686.6644489687134, -97.74194410080736, -71.75001741976581, 18.111024725124683, -148.4415799056697, -36.259949698863295, -36.18532575736188, 27.21440392971988, -876.4602220186221, -503.1046380802553, -120.42846398083563, 392.773646311491, -14.859400497851109, -502.00370027608915, 48.818099462718834, -566.9951703861734, -685.2301864445644, 229.65520684202477, -280.0761755175065, -428.4217830717408, -61.86544004076376, -496.77353574729, -815.1705537493575, -40.798699571449085, -555.5717072864103, 187.86882582557962], "policy_predator_policy_reward": [300.0355552119779, 459.270985440714, 875.0335808881235, 575.839335108994, 685.4345136619902, 597.4735905142614, 543.0324448679288, 744.8385924826971, 439.1702310773249, 365.8548453887274, 877.8799622710093, 1173.691472063601, 177.12785437596267, 787.8811491377883, 753.992800078965, 604.891572531467, 697.4615381984564, 533.7748032571549, 176.06144296302242, 13.925595481369868, 128.0885027444407, 179.94127351644295, 540.9143003783378, 382.2367218152664, 14.27604043755521, 606.748610232831, 32.296780789685684, 33.47198885359858, 668.1675854666718, 335.70802898637703, 420.91100046215746, 488.15953612069615, 485.18619342722315, 878.5513442532301, 614.0049830073741, 47.39555966636226, 424.1026179531959, 504.94908474724537, 351.12822681729347, 162.38068988715003, 575.1838254266227, 755.2795666255813, 742.8575708635601, 734.7764425383982, 645.7281532785051, 614.1600515628938, 161.79481058562737, 751.9821432581542, 73.61418035365301, 177.6324752361927, 405.79177116771467, 48.681659292010266, 636.3866702694359, 703.5216256672593, 447.9136948565301, 780.5974760486962, 494.71244114028775, 428.3154799004873, 315.6852668946312, 652.3885296512194, 786.5492854689538, 470.77582837913974, 427.4660639113831, 145.75120181991156, 457.2930279292304, 501.0779785963117, 472.31425907887046, 558.6334059238721, 598.8954985011567, 797.3906160136355, 668.736235297711, 583.5700765299682, 445.12188677133537, 548.2176567477601, 869.26718138979, 136.83870668034618, 410.56462203301675, 114.17036151664048, 146.45566223405376, 492.505637713385, 281.85416644199506, 43.22502641216357, 815.5516868093966, 364.7549017409048, 151.2190161766291, 172.41034205458084, 894.4080905285238, 680.3879517790278, 322.5766263014833, 496.9091660548855, 675.2801084691422, 545.5998261005517, 404.7614984582366, 205.02136347674605, 408.060688881951, 287.92573523346135, 1001.4532518449807, 799.0815695723691, 11.069738261968789, 313.4820149557488, 31.328032805047688, 307.60042869972136, 839.7265594707363, 346.9339936065715, 141.43569656931737, 458.5283522752682, 424.36015473985935, 505.65971900654415, 41.980023347400426, 14.617857197857461, 379.66883154939524, 529.122511863643, 0.0, 87.00515121905555, 574.5143662738963, 55.88487476209313, 220.28419745339565, 291.03841572325194, 686.6553404062665, 559.8308357093547, 447.23369660324545, 289.6285040577905, 289.56871875304415, 323.0547287730099, 460.18287596258176, 323.6406401605622, 415.3097839257938, 651.0146540863211, 862.1989317237418, 601.9513290446276, 303.2668955370474, 258.51573413660685, 0.0, 28.171340571469443, 101.41161554211025, 77.83052978440315, 312.15253985439034, 222.70426030845107, 1043.8998339916275, 619.8216335138306, 516.0216704739156, 298.2023954298164, 203.2883938714749, 646.0363381843782, 713.9459973398306, 598.9316210218814, 594.7721791966211, 395.3630686000111, 607.4340646869647, 600.9952733850886, 60.55111349376079, 689.3337187635797, 624.9029703919385, 649.0607896575688, 108.39743466543979, 634.3121682440931, 601.7560413890849, 367.40358006597154, 788.0057765190581, 124.27338358214213, 459.1759770020197, 502.0551645512087, 630.2934920579937, 419.7395235658412, 666.2160079762726, 641.9050467126873, 687.322479629349, 738.1622090931797, 454.1240143884287, 530.6686309032149, 313.7121257547733, 235.8467805729642, 170.33397618044268, 269.097639671352, 645.0320227781465, 569.8789852054134, 104.15001741976397, 19.588975274875317, 338.9498614814431, 201.66611109521716, 213.45199242402828, 64.67825251923381, 604.844784999611, 782.0900948580772, 73.88554507692744, 151.37968543796006, 90.86512571643878, 711.9000368034011, 594.0270424427373, 294.423474765614, 668.1618532768646, 99.24762940477211, 428.7349104457427, 548.9135131704841, 94.59895017835348, 514.273535747294, 815.1705537493575, 76.45877096619827, 543.2722917513984, 524.8481223604747]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.976693497837719, "mean_inference_ms": 7.141499365634648, "mean_action_processing_ms": 2.465714684981756, "mean_env_wait_ms": 17.350128835291272, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016833066940307617, "StateBufferConnector_ms": 0.02415633201599121, "ViewRequirementAgentConnector_ms": 0.1892918348312378}, "num_episodes": 15, "episode_return_max": 943.9239944800307, "episode_return_min": -77.70355536335052, "episode_return_mean": 304.6710977088537, "episodes_this_iter": 15}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1266528, "num_agent_steps_trained": 1266528, "num_env_steps_sampled": 316632, "num_env_steps_trained": 316632, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 149.34727599055216, "num_env_steps_trained_throughput_per_sec": 149.34727599055216, "timesteps_total": 316632, "num_env_steps_sampled_lifetime": 316632, "num_agent_steps_sampled_lifetime": 1266528, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1266528, "timers": {"training_iteration_time_ms": 26987.836, "restore_workers_time_ms": 0.023, "training_step_time_ms": 26986.895, "sample_time_ms": 3257.758, "learn_time_ms": 23703.352, "learn_throughput": 169.09, "synch_weights_time_ms": 20.311}, "counters": {"num_env_steps_sampled": 316632, "num_env_steps_trained": 316632, "num_agent_steps_sampled": 1266528, "num_agent_steps_trained": 1266528}, "done": false, "training_iteration": 79, "trial_id": "7f713_00000", "date": "2024-08-23_10-22-20", "timestamp": 1724388740, "time_this_iter_s": 26.907088041305542, "time_total_s": 2137.3279762268066, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x173753af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2137.3279762268066, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 37.56578947368421, "ram_util_percent": 83.18947368421054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.170587366598625, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.201309751581262, "policy_loss": -0.006696989270735276, "vf_loss": 5.206644391761255, "vf_explained_var": 0.6710080704361042, "kl": 0.0068116656216304925, "entropy": 0.8051724968133149, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 75128.0, "diff_num_grad_updates_vs_sampler_policy": 489.4476047904173}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.53708231158988, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 4.665542422652876, "policy_loss": -0.010817299080918982, "vf_loss": 4.675677301770165, "vf_explained_var": 0.429718658911488, "kl": 0.013648106730863373, "entropy": 0.5345863777178305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 75128.0, "diff_num_grad_updates_vs_sampler_policy": 489.4476047904173}}, "num_env_steps_sampled": 320640, "num_env_steps_trained": 320640, "num_agent_steps_sampled": 1282560, "num_agent_steps_trained": 1282560}, "env_runners": {"episode_reward_max": 943.9239944800307, "episode_reward_min": -77.70355536335052, "episode_reward_mean": 309.5945561713707, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1103.3588391986352, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.773646311491, "predator_policy": 1043.8998339916275}, "policy_reward_mean": {"prey_policy": -268.03195905959166, "predator_policy": 422.82923714527715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [389.03909108547924, 409.4320216565846, 145.49851784255273, 49.90000000000032, 73.92320074120325, 115.64999999999999, 195.07399089524694, 67.46412787409521, 349.22738900835463, 335.19018249551215, 365.4169563106285, 229.97504684133483, 272.32458583751776, 417.014318842934, 292.99303519309075, 745.0240685385793, 156.0854207205223, 866.5973405503483, 254.92897767614338, 199.48861301563645, 389.91853421316614, 196.33720145268816, 193.76051231139465, 298.05255899459416, 239.9650965577431, 59.423144113742126, 188.86888966529023, 222.4290697912087, 127.56892285677954, -77.70355536335052, 508.4428669499943, 56.700000000000536, 20.11384750756612, 673.2474998620639, 689.5135044706277, 649.2940689588006, 284.826447992541, 43.70000000000035, 346.57943752516525, 943.9239944800307, 569.7999999999998, 192.49999999999972, -16.009124153016764, 42.600000000000364, 572.1224706490816, 733.3584436233244, 382.41871057679526, 72.60000000000015, 35.20000000000023, 468.61880675629163, -16.03240499052489, 170.10564387557343, 231.7702310338859, 152.231037458574, 558.9323482590839, 742.6197929298901, 146.47773473200715, 77.0999999999999, 360.20000000000124, 314.2776507011954, 475.6575129322694, 256.63052287327736, 294.1186984825944, 400.7101089686844, 566.2156422943103, 273.1143853162937, 381.18556830248707, 866.6204886780537, 61.42570492236197, 335.5073981213847, 59.934354263909775, 383.6661580002408, 276.36145651808863, 482.0832833187516, 817.7919848644717, 526.0007067263783, 105.31176927848367, 608.2968343020013, 430.50461491403985, 70.10000000000029, 355.9144429721273, 269.1593231156196, 7.370019758808223, 497.6104128455491, 285.90206174590077, 370.2734462849014, 311.8345030790993, 269.15046502697817, 50.23351013759192, 35.66007139474958, 700.4175326510401, 471.26793750683714, 14.257715545079677, 773.5959388130409, 300.03066486226624, 385.10419877297943, 93.94632914113502, 291.8507395080482, 50.81687777753681, -22.278035798277493], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [41.31807732560186, 157.73397531548278, 40.0000000000003, 61.402245395699026, -559.3894697859057, -218.2630345651396, 31.92395956244497, -603.0486102328307, 5.38382294034327, 2.770608157575999, -665.467585466672, -222.7580289863763, -212.97022077204127, -501.02632491556415, -420.6687037662788, -875.6047060400767, 57.12209837211378, -369.2952520374975, -282.5250023167925, -311.33651788813046, -331.5723363767851, 183.4803759829726, -573.4996586034179, -526.9886866074506, -447.8528987337776, -757.456528830662, -675.685021532179, -167.1888644662961, 17.185968949999804, -637.9698876006896, 111.28383390689604, 382.49357904183756, -325.5144620515121, 27.126452312314044, -725.3656746207065, 252.05471923436, -105.68002440556819, -867.9021688235149, -762.5894629369045, 39.05015491176629, -671.5119858870012, 93.35672355431677, -577.4532937675497, -483.5346186278564, -225.79093913491448, -153.66581428498537, -599.858468513026, -60.4599790179242, -315.58565408734216, -475.39691435765855, -793.4592630082675, -543.4037073927819, -786.7659272271155, -276.67149493527154, -146.36651826000804, -624.5439554678755, -827.7937360181888, -50.743229195168176, -236.49060705407118, -365.94793185893525, 152.28720471594062, -282.8056377133846, -260.8541664419904, -7.525026412163216, -806.2390210975105, -353.9537199452198, 98.13260758602979, 251.4855340448243, -925.282537836928, 40.0000000000003, -547.9924564376264, 377.8007330400583, -668.90956478121, -267.1439217959423, -179.12136347674752, -386.96149845823254, 184.0330154241452, -533.4400020143923, 148.81128196846151, -1005.422108905781, 339.6302617380312, -94.3820149557481, 20.6719671949523, -167.1004286997205, -838.5321141886757, -364.1375630416517, -321.3503998793265, -236.0136489652609, 118.50220977730827, -476.3996128746296, 319.3352520014693, 357.4253110765973, 2.0038938820532906, -528.3765267182981, 40.0000000000003, -54.40515121905665, -574.5143662738963, -20.684874762092633, 278.46906949246215, -321.1728759128181, -702.2353727559672, -560.2832083501786, -610.3258810531843, 43.5693242677242, -75.93987934436512, -304.9133371477981, -335.248341824529, -296.34413684003687, 215.5173168554183, -722.9094066084508, 91.87121977063705, -813.401687609118, -290.76774501643615, -124.53714992520662, 40.0000000000003, 8.928659428530674, 225.28838445788972, -44.330529784403645, -180.20969217679465, -40.36945728485079, -1103.3588391986352, -84.70511537455153, -369.0556047120206, -188.53793831843424, 88.23030461111904, -643.4363381843782, -385.10225303868833, -527.0652563543412, -650.355823477969, 226.43621797564464, -626.9816350754651, -308.33331768028825, 329.5942871609332, -698.2935511157868, -765.7094686659196, 358.3661972944681, -632.9235997999602, -48.36029818721135, -665.7101009098845, 32.05787757620863, -802.1628125696059, -50.18199326768572, -19.533284974043134, -558.0316985789439, -491.5294268069497, -282.14213229879573, -730.40806266148, -95.62970870873255, 241.37114553354556, -849.0638493916041, -595.2040541624476, 136.41211559718215, -238.400356476289, -205.84678057296586, -91.76046427771831, 260.62568272792583, -686.6644489687134, -97.74194410080736, -71.75001741976581, 18.111024725124683, -148.4415799056697, -36.259949698863295, -36.18532575736188, 27.21440392971988, -876.4602220186221, -503.1046380802553, -120.42846398083563, 392.773646311491, -14.859400497851109, -502.00370027608915, 48.818099462718834, -566.9951703861734, -685.2301864445644, 229.65520684202477, -280.0761755175065, -428.4217830717408, -61.86544004076376, -496.77353574729, -815.1705537493575, -40.798699571449085, -555.5717072864103, 187.86882582557962, 387.6711561925985, -65.57646776656361, -439.35644997091686, -729.5945846656964, 359.12608609679467, -764.8281333425876, -234.47069610268792, -644.4797125629702, 114.60238242553064, -414.03897335339667, -466.3284851074173, -517.273350745164, -264.61484548728373, -244.2766335893375, -498.8341105173822, -561.853266363709, -291.2282458808655, -345.7960520880115], "policy_predator_policy_reward": [176.06144296302242, 13.925595481369868, 128.0885027444407, 179.94127351644295, 540.9143003783378, 382.2367218152664, 14.27604043755521, 606.748610232831, 32.296780789685684, 33.47198885359858, 668.1675854666718, 335.70802898637703, 420.91100046215746, 488.15953612069615, 485.18619342722315, 878.5513442532301, 614.0049830073741, 47.39555966636226, 424.1026179531959, 504.94908474724537, 351.12822681729347, 162.38068988715003, 575.1838254266227, 755.2795666255813, 742.8575708635601, 734.7764425383982, 645.7281532785051, 614.1600515628938, 161.79481058562737, 751.9821432581542, 73.61418035365301, 177.6324752361927, 405.79177116771467, 48.681659292010266, 636.3866702694359, 703.5216256672593, 447.9136948565301, 780.5974760486962, 494.71244114028775, 428.3154799004873, 315.6852668946312, 652.3885296512194, 786.5492854689538, 470.77582837913974, 427.4660639113831, 145.75120181991156, 457.2930279292304, 501.0779785963117, 472.31425907887046, 558.6334059238721, 598.8954985011567, 797.3906160136355, 668.736235297711, 583.5700765299682, 445.12188677133537, 548.2176567477601, 869.26718138979, 136.83870668034618, 410.56462203301675, 114.17036151664048, 146.45566223405376, 492.505637713385, 281.85416644199506, 43.22502641216357, 815.5516868093966, 364.7549017409048, 151.2190161766291, 172.41034205458084, 894.4080905285238, 680.3879517790278, 322.5766263014833, 496.9091660548855, 675.2801084691422, 545.5998261005517, 404.7614984582366, 205.02136347674605, 408.060688881951, 287.92573523346135, 1001.4532518449807, 799.0815695723691, 11.069738261968789, 313.4820149557488, 31.328032805047688, 307.60042869972136, 839.7265594707363, 346.9339936065715, 141.43569656931737, 458.5283522752682, 424.36015473985935, 505.65971900654415, 41.980023347400426, 14.617857197857461, 379.66883154939524, 529.122511863643, 0.0, 87.00515121905555, 574.5143662738963, 55.88487476209313, 220.28419745339565, 291.03841572325194, 686.6553404062665, 559.8308357093547, 447.23369660324545, 289.6285040577905, 289.56871875304415, 323.0547287730099, 460.18287596258176, 323.6406401605622, 415.3097839257938, 651.0146540863211, 862.1989317237418, 601.9513290446276, 303.2668955370474, 258.51573413660685, 0.0, 28.171340571469443, 101.41161554211025, 77.83052978440315, 312.15253985439034, 222.70426030845107, 1043.8998339916275, 619.8216335138306, 516.0216704739156, 298.2023954298164, 203.2883938714749, 646.0363381843782, 713.9459973398306, 598.9316210218814, 594.7721791966211, 395.3630686000111, 607.4340646869647, 600.9952733850886, 60.55111349376079, 689.3337187635797, 624.9029703919385, 649.0607896575688, 108.39743466543979, 634.3121682440931, 601.7560413890849, 367.40358006597154, 788.0057765190581, 124.27338358214213, 459.1759770020197, 502.0551645512087, 630.2934920579937, 419.7395235658412, 666.2160079762726, 641.9050467126873, 687.322479629349, 738.1622090931797, 454.1240143884287, 530.6686309032149, 313.7121257547733, 235.8467805729642, 170.33397618044268, 269.097639671352, 645.0320227781465, 569.8789852054134, 104.15001741976397, 19.588975274875317, 338.9498614814431, 201.66611109521716, 213.45199242402828, 64.67825251923381, 604.844784999611, 782.0900948580772, 73.88554507692744, 151.37968543796006, 90.86512571643878, 711.9000368034011, 594.0270424427373, 294.423474765614, 668.1618532768646, 99.24762940477211, 428.7349104457427, 548.9135131704841, 94.59895017835348, 514.273535747294, 815.1705537493575, 76.45877096619827, 543.2722917513984, 524.8481223604747, 92.0129681964195, 57.16028088437719, 452.91416551599684, 730.2945846656966, 644.3340022252008, 534.9639838336309, 587.236661087802, 591.7444124401238, 249.1871651569729, 435.35362454387274, 411.63438196295226, 665.9137830307643, 542.124798256536, 258.6174203281355, 495.3533169906607, 616.1509376679687, 473.53317789510385, 141.21308427549255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.95639147945025, "mean_inference_ms": 7.13820391539261, "mean_action_processing_ms": 2.4513612154638107, "mean_env_wait_ms": 17.344960867072235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016726016998291016, "StateBufferConnector_ms": 0.022075653076171875, "ViewRequirementAgentConnector_ms": 0.16867506504058838}, "num_episodes": 9, "episode_return_max": 943.9239944800307, "episode_return_min": -77.70355536335052, "episode_return_mean": 309.5945561713707, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1282560, "num_agent_steps_trained": 1282560, "num_env_steps_sampled": 320640, "num_env_steps_trained": 320640, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 150.3733738582781, "num_env_steps_trained_throughput_per_sec": 150.3733738582781, "timesteps_total": 320640, "num_env_steps_sampled_lifetime": 320640, "num_agent_steps_sampled_lifetime": 1282560, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1282560, "timers": {"training_iteration_time_ms": 26954.239, "restore_workers_time_ms": 0.023, "training_step_time_ms": 26953.395, "sample_time_ms": 3178.321, "learn_time_ms": 23750.443, "learn_throughput": 168.755, "synch_weights_time_ms": 20.098}, "counters": {"num_env_steps_sampled": 320640, "num_env_steps_trained": 320640, "num_agent_steps_sampled": 1282560, "num_agent_steps_trained": 1282560}, "done": false, "training_iteration": 80, "trial_id": "7f713_00000", "date": "2024-08-23_10-22-46", "timestamp": 1724388766, "time_this_iter_s": 26.67463779449463, "time_total_s": 2164.0026140213013, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17382ec10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2164.0026140213013, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 37.618918918918915, "ram_util_percent": 82.29189189189188}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 59.10401453189749, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.705450369567467, "policy_loss": -0.00969079006441731, "vf_loss": 4.713478080810062, "vf_explained_var": 0.6139295156039889, "kl": 0.008315447726528402, "entropy": 0.8447957085553931, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 76073.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.668092748349306, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 4.389290951168726, "policy_loss": -0.01313886630136973, "vf_loss": 4.4019323800606704, "vf_explained_var": 0.4096680870762578, "kl": 0.009948788095443022, "entropy": 0.5368147385498834, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 76073.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 324648, "num_env_steps_trained": 324648, "num_agent_steps_sampled": 1298592, "num_agent_steps_trained": 1298592}, "env_runners": {"episode_reward_max": 943.9239944800307, "episode_reward_min": -77.70355536335052, "episode_reward_mean": 313.59234501583387, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1103.3588391986352, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.773646311491, "predator_policy": 1043.8998339916275}, "policy_reward_mean": {"prey_policy": -250.01287329185521, "predator_policy": 406.80904579977226}, "custom_metrics": {}, "hist_stats": {"episode_reward": [292.99303519309075, 745.0240685385793, 156.0854207205223, 866.5973405503483, 254.92897767614338, 199.48861301563645, 389.91853421316614, 196.33720145268816, 193.76051231139465, 298.05255899459416, 239.9650965577431, 59.423144113742126, 188.86888966529023, 222.4290697912087, 127.56892285677954, -77.70355536335052, 508.4428669499943, 56.700000000000536, 20.11384750756612, 673.2474998620639, 689.5135044706277, 649.2940689588006, 284.826447992541, 43.70000000000035, 346.57943752516525, 943.9239944800307, 569.7999999999998, 192.49999999999972, -16.009124153016764, 42.600000000000364, 572.1224706490816, 733.3584436233244, 382.41871057679526, 72.60000000000015, 35.20000000000023, 468.61880675629163, -16.03240499052489, 170.10564387557343, 231.7702310338859, 152.231037458574, 558.9323482590839, 742.6197929298901, 146.47773473200715, 77.0999999999999, 360.20000000000124, 314.2776507011954, 475.6575129322694, 256.63052287327736, 294.1186984825944, 400.7101089686844, 566.2156422943103, 273.1143853162937, 381.18556830248707, 866.6204886780537, 61.42570492236197, 335.5073981213847, 59.934354263909775, 383.6661580002408, 276.36145651808863, 482.0832833187516, 817.7919848644717, 526.0007067263783, 105.31176927848367, 608.2968343020013, 430.50461491403985, 70.10000000000029, 355.9144429721273, 269.1593231156196, 7.370019758808223, 497.6104128455491, 285.90206174590077, 370.2734462849014, 311.8345030790993, 269.15046502697817, 50.23351013759192, 35.66007139474958, 700.4175326510401, 471.26793750683714, 14.257715545079677, 773.5959388130409, 300.03066486226624, 385.10419877297943, 93.94632914113502, 291.8507395080482, 50.81687777753681, -22.278035798277493, 328.1538205422438, 344.4000000000009, 458.09288997108223, 66.44118215310073, 423.1223642443287, 517.282033963262, 86.49999999999936, 121.49999999999793, 33.87336555776562, 210.30243704995908, 127.49982833132489, 371.85218351075014, 238.48820855394655, 487.40000000000003], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [17.185968949999804, -637.9698876006896, 111.28383390689604, 382.49357904183756, -325.5144620515121, 27.126452312314044, -725.3656746207065, 252.05471923436, -105.68002440556819, -867.9021688235149, -762.5894629369045, 39.05015491176629, -671.5119858870012, 93.35672355431677, -577.4532937675497, -483.5346186278564, -225.79093913491448, -153.66581428498537, -599.858468513026, -60.4599790179242, -315.58565408734216, -475.39691435765855, -793.4592630082675, -543.4037073927819, -786.7659272271155, -276.67149493527154, -146.36651826000804, -624.5439554678755, -827.7937360181888, -50.743229195168176, -236.49060705407118, -365.94793185893525, 152.28720471594062, -282.8056377133846, -260.8541664419904, -7.525026412163216, -806.2390210975105, -353.9537199452198, 98.13260758602979, 251.4855340448243, -925.282537836928, 40.0000000000003, -547.9924564376264, 377.8007330400583, -668.90956478121, -267.1439217959423, -179.12136347674752, -386.96149845823254, 184.0330154241452, -533.4400020143923, 148.81128196846151, -1005.422108905781, 339.6302617380312, -94.3820149557481, 20.6719671949523, -167.1004286997205, -838.5321141886757, -364.1375630416517, -321.3503998793265, -236.0136489652609, 118.50220977730827, -476.3996128746296, 319.3352520014693, 357.4253110765973, 2.0038938820532906, -528.3765267182981, 40.0000000000003, -54.40515121905665, -574.5143662738963, -20.684874762092633, 278.46906949246215, -321.1728759128181, -702.2353727559672, -560.2832083501786, -610.3258810531843, 43.5693242677242, -75.93987934436512, -304.9133371477981, -335.248341824529, -296.34413684003687, 215.5173168554183, -722.9094066084508, 91.87121977063705, -813.401687609118, -290.76774501643615, -124.53714992520662, 40.0000000000003, 8.928659428530674, 225.28838445788972, -44.330529784403645, -180.20969217679465, -40.36945728485079, -1103.3588391986352, -84.70511537455153, -369.0556047120206, -188.53793831843424, 88.23030461111904, -643.4363381843782, -385.10225303868833, -527.0652563543412, -650.355823477969, 226.43621797564464, -626.9816350754651, -308.33331768028825, 329.5942871609332, -698.2935511157868, -765.7094686659196, 358.3661972944681, -632.9235997999602, -48.36029818721135, -665.7101009098845, 32.05787757620863, -802.1628125696059, -50.18199326768572, -19.533284974043134, -558.0316985789439, -491.5294268069497, -282.14213229879573, -730.40806266148, -95.62970870873255, 241.37114553354556, -849.0638493916041, -595.2040541624476, 136.41211559718215, -238.400356476289, -205.84678057296586, -91.76046427771831, 260.62568272792583, -686.6644489687134, -97.74194410080736, -71.75001741976581, 18.111024725124683, -148.4415799056697, -36.259949698863295, -36.18532575736188, 27.21440392971988, -876.4602220186221, -503.1046380802553, -120.42846398083563, 392.773646311491, -14.859400497851109, -502.00370027608915, 48.818099462718834, -566.9951703861734, -685.2301864445644, 229.65520684202477, -280.0761755175065, -428.4217830717408, -61.86544004076376, -496.77353574729, -815.1705537493575, -40.798699571449085, -555.5717072864103, 187.86882582557962, 387.6711561925985, -65.57646776656361, -439.35644997091686, -729.5945846656964, 359.12608609679467, -764.8281333425876, -234.47069610268792, -644.4797125629702, 114.60238242553064, -414.03897335339667, -466.3284851074173, -517.273350745164, -264.61484548728373, -244.2766335893375, -498.8341105173822, -561.853266363709, -291.2282458808655, -345.7960520880115, 119.26344814135479, -102.19859489475948, -28.512619519500944, 292.52925616992206, -53.94731639874897, -346.73543075033854, -413.60398161052666, -243.17708116292923, -402.5350750514709, 16.198125796241257, -61.6340711501479, -438.00075032108634, 1.1591576857462298, 39.3063536460678, -231.6755632397403, -146.27567304713918, -154.174292433639, -773.7003857065083, -115.52130237898695, -496.2152473291245, -339.0428580094365, -171.2490964796562, -491.08289632332185, 247.80063231154625, -332.554356383938, 33.92347492985262, -256.1007542986593, 310.1117624845863], "policy_predator_policy_reward": [161.79481058562737, 751.9821432581542, 73.61418035365301, 177.6324752361927, 405.79177116771467, 48.681659292010266, 636.3866702694359, 703.5216256672593, 447.9136948565301, 780.5974760486962, 494.71244114028775, 428.3154799004873, 315.6852668946312, 652.3885296512194, 786.5492854689538, 470.77582837913974, 427.4660639113831, 145.75120181991156, 457.2930279292304, 501.0779785963117, 472.31425907887046, 558.6334059238721, 598.8954985011567, 797.3906160136355, 668.736235297711, 583.5700765299682, 445.12188677133537, 548.2176567477601, 869.26718138979, 136.83870668034618, 410.56462203301675, 114.17036151664048, 146.45566223405376, 492.505637713385, 281.85416644199506, 43.22502641216357, 815.5516868093966, 364.7549017409048, 151.2190161766291, 172.41034205458084, 894.4080905285238, 680.3879517790278, 322.5766263014833, 496.9091660548855, 675.2801084691422, 545.5998261005517, 404.7614984582366, 205.02136347674605, 408.060688881951, 287.92573523346135, 1001.4532518449807, 799.0815695723691, 11.069738261968789, 313.4820149557488, 31.328032805047688, 307.60042869972136, 839.7265594707363, 346.9339936065715, 141.43569656931737, 458.5283522752682, 424.36015473985935, 505.65971900654415, 41.980023347400426, 14.617857197857461, 379.66883154939524, 529.122511863643, 0.0, 87.00515121905555, 574.5143662738963, 55.88487476209313, 220.28419745339565, 291.03841572325194, 686.6553404062665, 559.8308357093547, 447.23369660324545, 289.6285040577905, 289.56871875304415, 323.0547287730099, 460.18287596258176, 323.6406401605622, 415.3097839257938, 651.0146540863211, 862.1989317237418, 601.9513290446276, 303.2668955370474, 258.51573413660685, 0.0, 28.171340571469443, 101.41161554211025, 77.83052978440315, 312.15253985439034, 222.70426030845107, 1043.8998339916275, 619.8216335138306, 516.0216704739156, 298.2023954298164, 203.2883938714749, 646.0363381843782, 713.9459973398306, 598.9316210218814, 594.7721791966211, 395.3630686000111, 607.4340646869647, 600.9952733850886, 60.55111349376079, 689.3337187635797, 624.9029703919385, 649.0607896575688, 108.39743466543979, 634.3121682440931, 601.7560413890849, 367.40358006597154, 788.0057765190581, 124.27338358214213, 459.1759770020197, 502.0551645512087, 630.2934920579937, 419.7395235658412, 666.2160079762726, 641.9050467126873, 687.322479629349, 738.1622090931797, 454.1240143884287, 530.6686309032149, 313.7121257547733, 235.8467805729642, 170.33397618044268, 269.097639671352, 645.0320227781465, 569.8789852054134, 104.15001741976397, 19.588975274875317, 338.9498614814431, 201.66611109521716, 213.45199242402828, 64.67825251923381, 604.844784999611, 782.0900948580772, 73.88554507692744, 151.37968543796006, 90.86512571643878, 711.9000368034011, 594.0270424427373, 294.423474765614, 668.1618532768646, 99.24762940477211, 428.7349104457427, 548.9135131704841, 94.59895017835348, 514.273535747294, 815.1705537493575, 76.45877096619827, 543.2722917513984, 524.8481223604747, 92.0129681964195, 57.16028088437719, 452.91416551599684, 730.2945846656966, 644.3340022252008, 534.9639838336309, 587.236661087802, 591.7444124401238, 249.1871651569729, 435.35362454387274, 411.63438196295226, 665.9137830307643, 542.124798256536, 258.6174203281355, 495.3533169906607, 616.1509376679687, 473.53317789510385, 141.21308427549255, 152.01966406040546, 159.06930323524037, 63.01261951950142, 17.37074383007795, 374.64020636983037, 484.13543075033886, 53.29345320160963, 669.9287917249475, 367.19830599332676, 442.26100750623107, 218.3253006596603, 798.5915547748388, 35.54084231425401, 10.493646353932485, 252.37556323973914, 247.07567304713777, 188.0476579914027, 773.7003857065083, 333.65382486839815, 488.3851618896756, 254.41289156028625, 383.3788912601354, 581.9935542173288, 33.14089330519756, 289.5001901444602, 247.61889986357627, 158.99722253634832, 274.3917692777246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.950612898341756, "mean_inference_ms": 7.155654033331604, "mean_action_processing_ms": 2.439470495002967, "mean_env_wait_ms": 17.35841299188055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017514705657958984, "StateBufferConnector_ms": 0.02194058895111084, "ViewRequirementAgentConnector_ms": 0.1644289493560791}, "num_episodes": 14, "episode_return_max": 943.9239944800307, "episode_return_min": -77.70355536335052, "episode_return_mean": 313.59234501583387, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1298592, "num_agent_steps_trained": 1298592, "num_env_steps_sampled": 324648, "num_env_steps_trained": 324648, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 147.44425329512717, "num_env_steps_trained_throughput_per_sec": 147.44425329512717, "timesteps_total": 324648, "num_env_steps_sampled_lifetime": 324648, "num_agent_steps_sampled_lifetime": 1298592, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1298592, "timers": {"training_iteration_time_ms": 27027.853, "restore_workers_time_ms": 0.025, "training_step_time_ms": 27026.848, "sample_time_ms": 3290.0, "learn_time_ms": 23712.776, "learn_throughput": 169.023, "synch_weights_time_ms": 19.976}, "counters": {"num_env_steps_sampled": 324648, "num_env_steps_trained": 324648, "num_agent_steps_sampled": 1298592, "num_agent_steps_trained": 1298592}, "done": false, "training_iteration": 81, "trial_id": "7f713_00000", "date": "2024-08-23_10-23-14", "timestamp": 1724388794, "time_this_iter_s": 27.24583125114441, "time_total_s": 2191.2484452724457, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ad96f790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2191.2484452724457, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 38.78205128205128, "ram_util_percent": 83.2666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 56.062180345525185, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.591165185857702, "policy_loss": -0.0071308608366442575, "vf_loss": 4.597204931198605, "vf_explained_var": 0.609544884906244, "kl": 0.0054556535515027545, "entropy": 0.8804646066256931, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 77018.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.99451601492665, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 3.734842669270026, "policy_loss": -0.01088038291227782, "vf_loss": 3.7453004095289444, "vf_explained_var": 0.39436562086539295, "kl": 0.008452649932433531, "entropy": 0.562991234265938, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 77018.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 328656, "num_env_steps_trained": 328656, "num_agent_steps_sampled": 1314624, "num_agent_steps_trained": 1314624}, "env_runners": {"episode_reward_max": 943.9239944800307, "episode_reward_min": -77.70355536335052, "episode_reward_mean": 308.30690179700844, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1103.3588391986352, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.773646311491, "predator_policy": 1043.8998339916275}, "policy_reward_mean": {"prey_policy": -238.51033518259672, "predator_policy": 392.66378608110097}, "custom_metrics": {}, "hist_stats": {"episode_reward": [193.76051231139465, 298.05255899459416, 239.9650965577431, 59.423144113742126, 188.86888966529023, 222.4290697912087, 127.56892285677954, -77.70355536335052, 508.4428669499943, 56.700000000000536, 20.11384750756612, 673.2474998620639, 689.5135044706277, 649.2940689588006, 284.826447992541, 43.70000000000035, 346.57943752516525, 943.9239944800307, 569.7999999999998, 192.49999999999972, -16.009124153016764, 42.600000000000364, 572.1224706490816, 733.3584436233244, 382.41871057679526, 72.60000000000015, 35.20000000000023, 468.61880675629163, -16.03240499052489, 170.10564387557343, 231.7702310338859, 152.231037458574, 558.9323482590839, 742.6197929298901, 146.47773473200715, 77.0999999999999, 360.20000000000124, 314.2776507011954, 475.6575129322694, 256.63052287327736, 294.1186984825944, 400.7101089686844, 566.2156422943103, 273.1143853162937, 381.18556830248707, 866.6204886780537, 61.42570492236197, 335.5073981213847, 59.934354263909775, 383.6661580002408, 276.36145651808863, 482.0832833187516, 817.7919848644717, 526.0007067263783, 105.31176927848367, 608.2968343020013, 430.50461491403985, 70.10000000000029, 355.9144429721273, 269.1593231156196, 7.370019758808223, 497.6104128455491, 285.90206174590077, 370.2734462849014, 311.8345030790993, 269.15046502697817, 50.23351013759192, 35.66007139474958, 700.4175326510401, 471.26793750683714, 14.257715545079677, 773.5959388130409, 300.03066486226624, 385.10419877297943, 93.94632914113502, 291.8507395080482, 50.81687777753681, -22.278035798277493, 328.1538205422438, 344.4000000000009, 458.09288997108223, 66.44118215310073, 423.1223642443287, 517.282033963262, 86.49999999999936, 121.49999999999793, 33.87336555776562, 210.30243704995908, 127.49982833132489, 371.85218351075014, 238.48820855394655, 487.40000000000003, 346.3522873264919, 100.7102124969067, 338.89502689922426, 631.9229836258655, 60.30000000000059, 542.2889998171888, 403.00074200282677, 149.35861730912762], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-225.79093913491448, -153.66581428498537, -599.858468513026, -60.4599790179242, -315.58565408734216, -475.39691435765855, -793.4592630082675, -543.4037073927819, -786.7659272271155, -276.67149493527154, -146.36651826000804, -624.5439554678755, -827.7937360181888, -50.743229195168176, -236.49060705407118, -365.94793185893525, 152.28720471594062, -282.8056377133846, -260.8541664419904, -7.525026412163216, -806.2390210975105, -353.9537199452198, 98.13260758602979, 251.4855340448243, -925.282537836928, 40.0000000000003, -547.9924564376264, 377.8007330400583, -668.90956478121, -267.1439217959423, -179.12136347674752, -386.96149845823254, 184.0330154241452, -533.4400020143923, 148.81128196846151, -1005.422108905781, 339.6302617380312, -94.3820149557481, 20.6719671949523, -167.1004286997205, -838.5321141886757, -364.1375630416517, -321.3503998793265, -236.0136489652609, 118.50220977730827, -476.3996128746296, 319.3352520014693, 357.4253110765973, 2.0038938820532906, -528.3765267182981, 40.0000000000003, -54.40515121905665, -574.5143662738963, -20.684874762092633, 278.46906949246215, -321.1728759128181, -702.2353727559672, -560.2832083501786, -610.3258810531843, 43.5693242677242, -75.93987934436512, -304.9133371477981, -335.248341824529, -296.34413684003687, 215.5173168554183, -722.9094066084508, 91.87121977063705, -813.401687609118, -290.76774501643615, -124.53714992520662, 40.0000000000003, 8.928659428530674, 225.28838445788972, -44.330529784403645, -180.20969217679465, -40.36945728485079, -1103.3588391986352, -84.70511537455153, -369.0556047120206, -188.53793831843424, 88.23030461111904, -643.4363381843782, -385.10225303868833, -527.0652563543412, -650.355823477969, 226.43621797564464, -626.9816350754651, -308.33331768028825, 329.5942871609332, -698.2935511157868, -765.7094686659196, 358.3661972944681, -632.9235997999602, -48.36029818721135, -665.7101009098845, 32.05787757620863, -802.1628125696059, -50.18199326768572, -19.533284974043134, -558.0316985789439, -491.5294268069497, -282.14213229879573, -730.40806266148, -95.62970870873255, 241.37114553354556, -849.0638493916041, -595.2040541624476, 136.41211559718215, -238.400356476289, -205.84678057296586, -91.76046427771831, 260.62568272792583, -686.6644489687134, -97.74194410080736, -71.75001741976581, 18.111024725124683, -148.4415799056697, -36.259949698863295, -36.18532575736188, 27.21440392971988, -876.4602220186221, -503.1046380802553, -120.42846398083563, 392.773646311491, -14.859400497851109, -502.00370027608915, 48.818099462718834, -566.9951703861734, -685.2301864445644, 229.65520684202477, -280.0761755175065, -428.4217830717408, -61.86544004076376, -496.77353574729, -815.1705537493575, -40.798699571449085, -555.5717072864103, 187.86882582557962, 387.6711561925985, -65.57646776656361, -439.35644997091686, -729.5945846656964, 359.12608609679467, -764.8281333425876, -234.47069610268792, -644.4797125629702, 114.60238242553064, -414.03897335339667, -466.3284851074173, -517.273350745164, -264.61484548728373, -244.2766335893375, -498.8341105173822, -561.853266363709, -291.2282458808655, -345.7960520880115, 119.26344814135479, -102.19859489475948, -28.512619519500944, 292.52925616992206, -53.94731639874897, -346.73543075033854, -413.60398161052666, -243.17708116292923, -402.5350750514709, 16.198125796241257, -61.6340711501479, -438.00075032108634, 1.1591576857462298, 39.3063536460678, -231.6755632397403, -146.27567304713918, -154.174292433639, -773.7003857065083, -115.52130237898695, -496.2152473291245, -339.0428580094365, -171.2490964796562, -491.08289632332185, 247.80063231154625, -332.554356383938, 33.92347492985262, -256.1007542986593, 310.1117624845863, 122.6433253579345, -758.4253764125466, -547.0675053546869, -162.77472355605784, 37.1278728471534, 31.815266627340065, 370.16558642765324, -152.1232678168268, -213.17015335762088, -14.271413101246548, 252.63133198204648, -55.33601549591168, 224.17087496183106, -272.02215931143746, -668.6138593537235, -129.21230940201437], "policy_predator_policy_reward": [427.4660639113831, 145.75120181991156, 457.2930279292304, 501.0779785963117, 472.31425907887046, 558.6334059238721, 598.8954985011567, 797.3906160136355, 668.736235297711, 583.5700765299682, 445.12188677133537, 548.2176567477601, 869.26718138979, 136.83870668034618, 410.56462203301675, 114.17036151664048, 146.45566223405376, 492.505637713385, 281.85416644199506, 43.22502641216357, 815.5516868093966, 364.7549017409048, 151.2190161766291, 172.41034205458084, 894.4080905285238, 680.3879517790278, 322.5766263014833, 496.9091660548855, 675.2801084691422, 545.5998261005517, 404.7614984582366, 205.02136347674605, 408.060688881951, 287.92573523346135, 1001.4532518449807, 799.0815695723691, 11.069738261968789, 313.4820149557488, 31.328032805047688, 307.60042869972136, 839.7265594707363, 346.9339936065715, 141.43569656931737, 458.5283522752682, 424.36015473985935, 505.65971900654415, 41.980023347400426, 14.617857197857461, 379.66883154939524, 529.122511863643, 0.0, 87.00515121905555, 574.5143662738963, 55.88487476209313, 220.28419745339565, 291.03841572325194, 686.6553404062665, 559.8308357093547, 447.23369660324545, 289.6285040577905, 289.56871875304415, 323.0547287730099, 460.18287596258176, 323.6406401605622, 415.3097839257938, 651.0146540863211, 862.1989317237418, 601.9513290446276, 303.2668955370474, 258.51573413660685, 0.0, 28.171340571469443, 101.41161554211025, 77.83052978440315, 312.15253985439034, 222.70426030845107, 1043.8998339916275, 619.8216335138306, 516.0216704739156, 298.2023954298164, 203.2883938714749, 646.0363381843782, 713.9459973398306, 598.9316210218814, 594.7721791966211, 395.3630686000111, 607.4340646869647, 600.9952733850886, 60.55111349376079, 689.3337187635797, 624.9029703919385, 649.0607896575688, 108.39743466543979, 634.3121682440931, 601.7560413890849, 367.40358006597154, 788.0057765190581, 124.27338358214213, 459.1759770020197, 502.0551645512087, 630.2934920579937, 419.7395235658412, 666.2160079762726, 641.9050467126873, 687.322479629349, 738.1622090931797, 454.1240143884287, 530.6686309032149, 313.7121257547733, 235.8467805729642, 170.33397618044268, 269.097639671352, 645.0320227781465, 569.8789852054134, 104.15001741976397, 19.588975274875317, 338.9498614814431, 201.66611109521716, 213.45199242402828, 64.67825251923381, 604.844784999611, 782.0900948580772, 73.88554507692744, 151.37968543796006, 90.86512571643878, 711.9000368034011, 594.0270424427373, 294.423474765614, 668.1618532768646, 99.24762940477211, 428.7349104457427, 548.9135131704841, 94.59895017835348, 514.273535747294, 815.1705537493575, 76.45877096619827, 543.2722917513984, 524.8481223604747, 92.0129681964195, 57.16028088437719, 452.91416551599684, 730.2945846656966, 644.3340022252008, 534.9639838336309, 587.236661087802, 591.7444124401238, 249.1871651569729, 435.35362454387274, 411.63438196295226, 665.9137830307643, 542.124798256536, 258.6174203281355, 495.3533169906607, 616.1509376679687, 473.53317789510385, 141.21308427549255, 152.01966406040546, 159.06930323524037, 63.01261951950142, 17.37074383007795, 374.64020636983037, 484.13543075033886, 53.29345320160963, 669.9287917249475, 367.19830599332676, 442.26100750623107, 218.3253006596603, 798.5915547748388, 35.54084231425401, 10.493646353932485, 252.37556323973914, 247.07567304713777, 188.0476579914027, 773.7003857065083, 333.65382486839815, 488.3851618896756, 254.41289156028625, 383.3788912601354, 581.9935542173288, 33.14089330519756, 289.5001901444602, 247.61889986357627, 158.99722253634832, 274.3917692777246, 224.39408934012647, 757.7402490409775, 569.0949370814368, 241.45750432621523, 28.66715405207034, 241.28473337265987, 329.4448364566239, 84.43582855841518, 238.37015335761944, 49.371413101247015, 0.0, 344.9936833310542, 76.08071006645783, 374.7713162859759, 600.8608369120592, 346.323949152804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.944592222477201, "mean_inference_ms": 7.145110210781874, "mean_action_processing_ms": 2.45324856289674, "mean_env_wait_ms": 17.33982151558892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.017499446868896484, "StateBufferConnector_ms": 0.00832509994506836, "ViewRequirementAgentConnector_ms": 0.17075824737548828}, "num_episodes": 8, "episode_return_max": 943.9239944800307, "episode_return_min": -77.70355536335052, "episode_return_mean": 308.30690179700844, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1314624, "num_agent_steps_trained": 1314624, "num_env_steps_sampled": 328656, "num_env_steps_trained": 328656, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 151.3589114268976, "num_env_steps_trained_throughput_per_sec": 151.3589114268976, "timesteps_total": 328656, "num_env_steps_sampled_lifetime": 328656, "num_agent_steps_sampled_lifetime": 1314624, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1314624, "timers": {"training_iteration_time_ms": 26810.946, "restore_workers_time_ms": 0.025, "training_step_time_ms": 26809.94, "sample_time_ms": 3083.23, "learn_time_ms": 23703.428, "learn_throughput": 169.089, "synch_weights_time_ms": 19.564}, "counters": {"num_env_steps_sampled": 328656, "num_env_steps_trained": 328656, "num_agent_steps_sampled": 1314624, "num_agent_steps_trained": 1314624}, "done": false, "training_iteration": 82, "trial_id": "7f713_00000", "date": "2024-08-23_10-23-40", "timestamp": 1724388820, "time_this_iter_s": 26.546063899993896, "time_total_s": 2217.7945091724396, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1738bc700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2217.7945091724396, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 35.55675675675676, "ram_util_percent": 82.76486486486488}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 59.71936546406418, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.633743330536696, "policy_loss": -0.007414883053023861, "vf_loss": 4.639697480075574, "vf_explained_var": 0.6709057539859146, "kl": 0.007303794290348099, "entropy": 0.8740243562945613, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 77963.0, "diff_num_grad_updates_vs_sampler_policy": 498.17140718562587}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.45956987098411, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 3.8328048733807116, "policy_loss": -0.009473715925332967, "vf_loss": 3.841819115795156, "vf_explained_var": 0.44567962159555424, "kl": 0.009189196618855314, "entropy": 0.5729813263529823, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 77963.0, "diff_num_grad_updates_vs_sampler_policy": 498.17140718562587}}, "num_env_steps_sampled": 332664, "num_env_steps_trained": 332664, "num_agent_steps_sampled": 1330656, "num_agent_steps_trained": 1330656}, "env_runners": {"episode_reward_max": 943.9239944800307, "episode_reward_min": -22.278035798277493, "episode_reward_mean": 321.50399310030025, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1103.3588391986352, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 392.773646311491, "predator_policy": 1043.8998339916275}, "policy_reward_mean": {"prey_policy": -223.87573491893068, "predator_policy": 384.62773146908074}, "custom_metrics": {}, "hist_stats": {"episode_reward": [56.700000000000536, 20.11384750756612, 673.2474998620639, 689.5135044706277, 649.2940689588006, 284.826447992541, 43.70000000000035, 346.57943752516525, 943.9239944800307, 569.7999999999998, 192.49999999999972, -16.009124153016764, 42.600000000000364, 572.1224706490816, 733.3584436233244, 382.41871057679526, 72.60000000000015, 35.20000000000023, 468.61880675629163, -16.03240499052489, 170.10564387557343, 231.7702310338859, 152.231037458574, 558.9323482590839, 742.6197929298901, 146.47773473200715, 77.0999999999999, 360.20000000000124, 314.2776507011954, 475.6575129322694, 256.63052287327736, 294.1186984825944, 400.7101089686844, 566.2156422943103, 273.1143853162937, 381.18556830248707, 866.6204886780537, 61.42570492236197, 335.5073981213847, 59.934354263909775, 383.6661580002408, 276.36145651808863, 482.0832833187516, 817.7919848644717, 526.0007067263783, 105.31176927848367, 608.2968343020013, 430.50461491403985, 70.10000000000029, 355.9144429721273, 269.1593231156196, 7.370019758808223, 497.6104128455491, 285.90206174590077, 370.2734462849014, 311.8345030790993, 269.15046502697817, 50.23351013759192, 35.66007139474958, 700.4175326510401, 471.26793750683714, 14.257715545079677, 773.5959388130409, 300.03066486226624, 385.10419877297943, 93.94632914113502, 291.8507395080482, 50.81687777753681, -22.278035798277493, 328.1538205422438, 344.4000000000009, 458.09288997108223, 66.44118215310073, 423.1223642443287, 517.282033963262, 86.49999999999936, 121.49999999999793, 33.87336555776562, 210.30243704995908, 127.49982833132489, 371.85218351075014, 238.48820855394655, 487.40000000000003, 346.3522873264919, 100.7102124969067, 338.89502689922426, 631.9229836258655, 60.30000000000059, 542.2889998171888, 403.00074200282677, 149.35861730912762, 59.2000000000006, 619.0713159436241, 254.16222265189364, 194.79545514448006, 569.5229490729437, 62.065032701169, 248.78029056945724, 449.5532959061112, 623.3660742168963], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-260.8541664419904, -7.525026412163216, -806.2390210975105, -353.9537199452198, 98.13260758602979, 251.4855340448243, -925.282537836928, 40.0000000000003, -547.9924564376264, 377.8007330400583, -668.90956478121, -267.1439217959423, -179.12136347674752, -386.96149845823254, 184.0330154241452, -533.4400020143923, 148.81128196846151, -1005.422108905781, 339.6302617380312, -94.3820149557481, 20.6719671949523, -167.1004286997205, -838.5321141886757, -364.1375630416517, -321.3503998793265, -236.0136489652609, 118.50220977730827, -476.3996128746296, 319.3352520014693, 357.4253110765973, 2.0038938820532906, -528.3765267182981, 40.0000000000003, -54.40515121905665, -574.5143662738963, -20.684874762092633, 278.46906949246215, -321.1728759128181, -702.2353727559672, -560.2832083501786, -610.3258810531843, 43.5693242677242, -75.93987934436512, -304.9133371477981, -335.248341824529, -296.34413684003687, 215.5173168554183, -722.9094066084508, 91.87121977063705, -813.401687609118, -290.76774501643615, -124.53714992520662, 40.0000000000003, 8.928659428530674, 225.28838445788972, -44.330529784403645, -180.20969217679465, -40.36945728485079, -1103.3588391986352, -84.70511537455153, -369.0556047120206, -188.53793831843424, 88.23030461111904, -643.4363381843782, -385.10225303868833, -527.0652563543412, -650.355823477969, 226.43621797564464, -626.9816350754651, -308.33331768028825, 329.5942871609332, -698.2935511157868, -765.7094686659196, 358.3661972944681, -632.9235997999602, -48.36029818721135, -665.7101009098845, 32.05787757620863, -802.1628125696059, -50.18199326768572, -19.533284974043134, -558.0316985789439, -491.5294268069497, -282.14213229879573, -730.40806266148, -95.62970870873255, 241.37114553354556, -849.0638493916041, -595.2040541624476, 136.41211559718215, -238.400356476289, -205.84678057296586, -91.76046427771831, 260.62568272792583, -686.6644489687134, -97.74194410080736, -71.75001741976581, 18.111024725124683, -148.4415799056697, -36.259949698863295, -36.18532575736188, 27.21440392971988, -876.4602220186221, -503.1046380802553, -120.42846398083563, 392.773646311491, -14.859400497851109, -502.00370027608915, 48.818099462718834, -566.9951703861734, -685.2301864445644, 229.65520684202477, -280.0761755175065, -428.4217830717408, -61.86544004076376, -496.77353574729, -815.1705537493575, -40.798699571449085, -555.5717072864103, 187.86882582557962, 387.6711561925985, -65.57646776656361, -439.35644997091686, -729.5945846656964, 359.12608609679467, -764.8281333425876, -234.47069610268792, -644.4797125629702, 114.60238242553064, -414.03897335339667, -466.3284851074173, -517.273350745164, -264.61484548728373, -244.2766335893375, -498.8341105173822, -561.853266363709, -291.2282458808655, -345.7960520880115, 119.26344814135479, -102.19859489475948, -28.512619519500944, 292.52925616992206, -53.94731639874897, -346.73543075033854, -413.60398161052666, -243.17708116292923, -402.5350750514709, 16.198125796241257, -61.6340711501479, -438.00075032108634, 1.1591576857462298, 39.3063536460678, -231.6755632397403, -146.27567304713918, -154.174292433639, -773.7003857065083, -115.52130237898695, -496.2152473291245, -339.0428580094365, -171.2490964796562, -491.08289632332185, 247.80063231154625, -332.554356383938, 33.92347492985262, -256.1007542986593, 310.1117624845863, 122.6433253579345, -758.4253764125466, -547.0675053546869, -162.77472355605784, 37.1278728471534, 31.815266627340065, 370.16558642765324, -152.1232678168268, -213.17015335762088, -14.271413101246548, 252.63133198204648, -55.33601549591168, 224.17087496183106, -272.02215931143746, -668.6138593537235, -129.21230940201437, -181.87017307819906, -163.99163428697793, -491.7831110827881, 325.2449039020971, -537.8951468650871, -205.4370404149704, -88.33236992676584, -244.45518717709967, -595.4331969436076, 165.99647047697005, -550.3930923493156, -22.81811775767808, -266.04421489175303, -555.1723448110321, -716.4022459927374, 65.67886322707866, 24.585456889817806, 351.97966100428346], "policy_predator_policy_reward": [281.85416644199506, 43.22502641216357, 815.5516868093966, 364.7549017409048, 151.2190161766291, 172.41034205458084, 894.4080905285238, 680.3879517790278, 322.5766263014833, 496.9091660548855, 675.2801084691422, 545.5998261005517, 404.7614984582366, 205.02136347674605, 408.060688881951, 287.92573523346135, 1001.4532518449807, 799.0815695723691, 11.069738261968789, 313.4820149557488, 31.328032805047688, 307.60042869972136, 839.7265594707363, 346.9339936065715, 141.43569656931737, 458.5283522752682, 424.36015473985935, 505.65971900654415, 41.980023347400426, 14.617857197857461, 379.66883154939524, 529.122511863643, 0.0, 87.00515121905555, 574.5143662738963, 55.88487476209313, 220.28419745339565, 291.03841572325194, 686.6553404062665, 559.8308357093547, 447.23369660324545, 289.6285040577905, 289.56871875304415, 323.0547287730099, 460.18287596258176, 323.6406401605622, 415.3097839257938, 651.0146540863211, 862.1989317237418, 601.9513290446276, 303.2668955370474, 258.51573413660685, 0.0, 28.171340571469443, 101.41161554211025, 77.83052978440315, 312.15253985439034, 222.70426030845107, 1043.8998339916275, 619.8216335138306, 516.0216704739156, 298.2023954298164, 203.2883938714749, 646.0363381843782, 713.9459973398306, 598.9316210218814, 594.7721791966211, 395.3630686000111, 607.4340646869647, 600.9952733850886, 60.55111349376079, 689.3337187635797, 624.9029703919385, 649.0607896575688, 108.39743466543979, 634.3121682440931, 601.7560413890849, 367.40358006597154, 788.0057765190581, 124.27338358214213, 459.1759770020197, 502.0551645512087, 630.2934920579937, 419.7395235658412, 666.2160079762726, 641.9050467126873, 687.322479629349, 738.1622090931797, 454.1240143884287, 530.6686309032149, 313.7121257547733, 235.8467805729642, 170.33397618044268, 269.097639671352, 645.0320227781465, 569.8789852054134, 104.15001741976397, 19.588975274875317, 338.9498614814431, 201.66611109521716, 213.45199242402828, 64.67825251923381, 604.844784999611, 782.0900948580772, 73.88554507692744, 151.37968543796006, 90.86512571643878, 711.9000368034011, 594.0270424427373, 294.423474765614, 668.1618532768646, 99.24762940477211, 428.7349104457427, 548.9135131704841, 94.59895017835348, 514.273535747294, 815.1705537493575, 76.45877096619827, 543.2722917513984, 524.8481223604747, 92.0129681964195, 57.16028088437719, 452.91416551599684, 730.2945846656966, 644.3340022252008, 534.9639838336309, 587.236661087802, 591.7444124401238, 249.1871651569729, 435.35362454387274, 411.63438196295226, 665.9137830307643, 542.124798256536, 258.6174203281355, 495.3533169906607, 616.1509376679687, 473.53317789510385, 141.21308427549255, 152.01966406040546, 159.06930323524037, 63.01261951950142, 17.37074383007795, 374.64020636983037, 484.13543075033886, 53.29345320160963, 669.9287917249475, 367.19830599332676, 442.26100750623107, 218.3253006596603, 798.5915547748388, 35.54084231425401, 10.493646353932485, 252.37556323973914, 247.07567304713777, 188.0476579914027, 773.7003857065083, 333.65382486839815, 488.3851618896756, 254.41289156028625, 383.3788912601354, 581.9935542173288, 33.14089330519756, 289.5001901444602, 247.61889986357627, 158.99722253634832, 274.3917692777246, 224.39408934012647, 757.7402490409775, 569.0949370814368, 241.45750432621523, 28.66715405207034, 241.28473337265987, 329.4448364566239, 84.43582855841518, 238.37015335761944, 49.371413101247015, 0.0, 344.9936833310542, 76.08071006645783, 374.7713162859759, 600.8608369120592, 346.323949152804, 206.67017307819765, 198.39163428697674, 515.0532913317405, 270.5562317925736, 520.0600456606435, 477.4343642713107, 260.56982832860876, 267.01318391973797, 364.290645657986, 634.669029881594, 277.5295409102661, 357.7467018978951, 465.1767673691646, 604.8200829030752, 694.1074397300775, 406.16923894168985, 212.47352713846078, 34.327429184334186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.928858580512832, "mean_inference_ms": 7.124706256230114, "mean_action_processing_ms": 2.453974494690568, "mean_env_wait_ms": 17.339065704945586, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012360095977783203, "StateBufferConnector_ms": 0.008022189140319824, "ViewRequirementAgentConnector_ms": 0.1439739465713501}, "num_episodes": 9, "episode_return_max": 943.9239944800307, "episode_return_min": -22.278035798277493, "episode_return_mean": 321.50399310030025, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1330656, "num_agent_steps_trained": 1330656, "num_env_steps_sampled": 332664, "num_env_steps_trained": 332664, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 146.94950079757317, "num_env_steps_trained_throughput_per_sec": 146.94950079757317, "timesteps_total": 332664, "num_env_steps_sampled_lifetime": 332664, "num_agent_steps_sampled_lifetime": 1330656, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1330656, "timers": {"training_iteration_time_ms": 26836.423, "restore_workers_time_ms": 0.025, "training_step_time_ms": 26835.327, "sample_time_ms": 3135.306, "learn_time_ms": 23677.46, "learn_throughput": 169.275, "synch_weights_time_ms": 18.644}, "counters": {"num_env_steps_sampled": 332664, "num_env_steps_trained": 332664, "num_agent_steps_sampled": 1330656, "num_agent_steps_trained": 1330656}, "done": false, "training_iteration": 83, "trial_id": "7f713_00000", "date": "2024-08-23_10-24-08", "timestamp": 1724388848, "time_this_iter_s": 27.326603174209595, "time_total_s": 2245.121112346649, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x173753d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2245.121112346649, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 39.12051282051282, "ram_util_percent": 82.94615384615383}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 51.171961311310056, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.700026545953499, "policy_loss": -0.007950017463462673, "vf_loss": 4.706771171408356, "vf_explained_var": 0.6545223022894885, "kl": 0.0060270310261301575, "entropy": 0.8768017982048963, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 78908.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.089076480159054, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 3.6769903490783045, "policy_loss": -0.011817185017994787, "vf_loss": 3.688280601350088, "vf_explained_var": 0.4779286751040706, "kl": 0.010538849962145958, "entropy": 0.5676998890581585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 78908.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 336672, "num_env_steps_trained": 336672, "num_agent_steps_sampled": 1346688, "num_agent_steps_trained": 1346688}, "env_runners": {"episode_reward_max": 866.6204886780537, "episode_reward_min": -22.278035798277493, "episode_reward_mean": 328.51081155225177, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1103.3588391986352, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1043.8998339916275}, "policy_reward_mean": {"prey_policy": -200.23446857410033, "predator_policy": 364.48987435022616}, "custom_metrics": {}, "hist_stats": {"episode_reward": [572.1224706490816, 733.3584436233244, 382.41871057679526, 72.60000000000015, 35.20000000000023, 468.61880675629163, -16.03240499052489, 170.10564387557343, 231.7702310338859, 152.231037458574, 558.9323482590839, 742.6197929298901, 146.47773473200715, 77.0999999999999, 360.20000000000124, 314.2776507011954, 475.6575129322694, 256.63052287327736, 294.1186984825944, 400.7101089686844, 566.2156422943103, 273.1143853162937, 381.18556830248707, 866.6204886780537, 61.42570492236197, 335.5073981213847, 59.934354263909775, 383.6661580002408, 276.36145651808863, 482.0832833187516, 817.7919848644717, 526.0007067263783, 105.31176927848367, 608.2968343020013, 430.50461491403985, 70.10000000000029, 355.9144429721273, 269.1593231156196, 7.370019758808223, 497.6104128455491, 285.90206174590077, 370.2734462849014, 311.8345030790993, 269.15046502697817, 50.23351013759192, 35.66007139474958, 700.4175326510401, 471.26793750683714, 14.257715545079677, 773.5959388130409, 300.03066486226624, 385.10419877297943, 93.94632914113502, 291.8507395080482, 50.81687777753681, -22.278035798277493, 328.1538205422438, 344.4000000000009, 458.09288997108223, 66.44118215310073, 423.1223642443287, 517.282033963262, 86.49999999999936, 121.49999999999793, 33.87336555776562, 210.30243704995908, 127.49982833132489, 371.85218351075014, 238.48820855394655, 487.40000000000003, 346.3522873264919, 100.7102124969067, 338.89502689922426, 631.9229836258655, 60.30000000000059, 542.2889998171888, 403.00074200282677, 149.35861730912762, 59.2000000000006, 619.0713159436241, 254.16222265189364, 194.79545514448006, 569.5229490729437, 62.065032701169, 248.78029056945724, 449.5532959061112, 623.3660742168963, 359.82760225210114, 340.13928719548164, 354.33017095285135, 260.5811440677934, 365.2358043262199, 842.5037768006654, 186.3517857706521, 580.0154643086721, 427.5270667910678, 62.70000000000062, 432.5000000000026, 233.54294389121048, 752.2164754822106], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [118.50220977730827, -476.3996128746296, 319.3352520014693, 357.4253110765973, 2.0038938820532906, -528.3765267182981, 40.0000000000003, -54.40515121905665, -574.5143662738963, -20.684874762092633, 278.46906949246215, -321.1728759128181, -702.2353727559672, -560.2832083501786, -610.3258810531843, 43.5693242677242, -75.93987934436512, -304.9133371477981, -335.248341824529, -296.34413684003687, 215.5173168554183, -722.9094066084508, 91.87121977063705, -813.401687609118, -290.76774501643615, -124.53714992520662, 40.0000000000003, 8.928659428530674, 225.28838445788972, -44.330529784403645, -180.20969217679465, -40.36945728485079, -1103.3588391986352, -84.70511537455153, -369.0556047120206, -188.53793831843424, 88.23030461111904, -643.4363381843782, -385.10225303868833, -527.0652563543412, -650.355823477969, 226.43621797564464, -626.9816350754651, -308.33331768028825, 329.5942871609332, -698.2935511157868, -765.7094686659196, 358.3661972944681, -632.9235997999602, -48.36029818721135, -665.7101009098845, 32.05787757620863, -802.1628125696059, -50.18199326768572, -19.533284974043134, -558.0316985789439, -491.5294268069497, -282.14213229879573, -730.40806266148, -95.62970870873255, 241.37114553354556, -849.0638493916041, -595.2040541624476, 136.41211559718215, -238.400356476289, -205.84678057296586, -91.76046427771831, 260.62568272792583, -686.6644489687134, -97.74194410080736, -71.75001741976581, 18.111024725124683, -148.4415799056697, -36.259949698863295, -36.18532575736188, 27.21440392971988, -876.4602220186221, -503.1046380802553, -120.42846398083563, 392.773646311491, -14.859400497851109, -502.00370027608915, 48.818099462718834, -566.9951703861734, -685.2301864445644, 229.65520684202477, -280.0761755175065, -428.4217830717408, -61.86544004076376, -496.77353574729, -815.1705537493575, -40.798699571449085, -555.5717072864103, 187.86882582557962, 387.6711561925985, -65.57646776656361, -439.35644997091686, -729.5945846656964, 359.12608609679467, -764.8281333425876, -234.47069610268792, -644.4797125629702, 114.60238242553064, -414.03897335339667, -466.3284851074173, -517.273350745164, -264.61484548728373, -244.2766335893375, -498.8341105173822, -561.853266363709, -291.2282458808655, -345.7960520880115, 119.26344814135479, -102.19859489475948, -28.512619519500944, 292.52925616992206, -53.94731639874897, -346.73543075033854, -413.60398161052666, -243.17708116292923, -402.5350750514709, 16.198125796241257, -61.6340711501479, -438.00075032108634, 1.1591576857462298, 39.3063536460678, -231.6755632397403, -146.27567304713918, -154.174292433639, -773.7003857065083, -115.52130237898695, -496.2152473291245, -339.0428580094365, -171.2490964796562, -491.08289632332185, 247.80063231154625, -332.554356383938, 33.92347492985262, -256.1007542986593, 310.1117624845863, 122.6433253579345, -758.4253764125466, -547.0675053546869, -162.77472355605784, 37.1278728471534, 31.815266627340065, 370.16558642765324, -152.1232678168268, -213.17015335762088, -14.271413101246548, 252.63133198204648, -55.33601549591168, 224.17087496183106, -272.02215931143746, -668.6138593537235, -129.21230940201437, -181.87017307819906, -163.99163428697793, -491.7831110827881, 325.2449039020971, -537.8951468650871, -205.4370404149704, -88.33236992676584, -244.45518717709967, -595.4331969436076, 165.99647047697005, -550.3930923493156, -22.81811775767808, -266.04421489175303, -555.1723448110321, -716.4022459927374, 65.67886322707866, 24.585456889817806, 351.97966100428346, -87.40725857653217, 219.4961625009664, -310.09310418744786, 203.84582348938005, 283.4277148928184, -191.2762089265836, -193.18079481661496, -532.5054705645999, -573.3455924180181, 213.3621831994854, 236.62868974092052, -835.1703916179858, 35.626176845502215, -138.53307140516628, 320.97746338578935, -485.8925997439694, 319.2510877161371, -251.28837502605882, -149.11228047713755, -11.249639146120984, -22.956019854011032, 398.2, -630.4303763664852, 159.2216595052189, -43.181349913665485, 290.0426843926191], "policy_predator_policy_reward": [424.36015473985935, 505.65971900654415, 41.980023347400426, 14.617857197857461, 379.66883154939524, 529.122511863643, 0.0, 87.00515121905555, 574.5143662738963, 55.88487476209313, 220.28419745339565, 291.03841572325194, 686.6553404062665, 559.8308357093547, 447.23369660324545, 289.6285040577905, 289.56871875304415, 323.0547287730099, 460.18287596258176, 323.6406401605622, 415.3097839257938, 651.0146540863211, 862.1989317237418, 601.9513290446276, 303.2668955370474, 258.51573413660685, 0.0, 28.171340571469443, 101.41161554211025, 77.83052978440315, 312.15253985439034, 222.70426030845107, 1043.8998339916275, 619.8216335138306, 516.0216704739156, 298.2023954298164, 203.2883938714749, 646.0363381843782, 713.9459973398306, 598.9316210218814, 594.7721791966211, 395.3630686000111, 607.4340646869647, 600.9952733850886, 60.55111349376079, 689.3337187635797, 624.9029703919385, 649.0607896575688, 108.39743466543979, 634.3121682440931, 601.7560413890849, 367.40358006597154, 788.0057765190581, 124.27338358214213, 459.1759770020197, 502.0551645512087, 630.2934920579937, 419.7395235658412, 666.2160079762726, 641.9050467126873, 687.322479629349, 738.1622090931797, 454.1240143884287, 530.6686309032149, 313.7121257547733, 235.8467805729642, 170.33397618044268, 269.097639671352, 645.0320227781465, 569.8789852054134, 104.15001741976397, 19.588975274875317, 338.9498614814431, 201.66611109521716, 213.45199242402828, 64.67825251923381, 604.844784999611, 782.0900948580772, 73.88554507692744, 151.37968543796006, 90.86512571643878, 711.9000368034011, 594.0270424427373, 294.423474765614, 668.1618532768646, 99.24762940477211, 428.7349104457427, 548.9135131704841, 94.59895017835348, 514.273535747294, 815.1705537493575, 76.45877096619827, 543.2722917513984, 524.8481223604747, 92.0129681964195, 57.16028088437719, 452.91416551599684, 730.2945846656966, 644.3340022252008, 534.9639838336309, 587.236661087802, 591.7444124401238, 249.1871651569729, 435.35362454387274, 411.63438196295226, 665.9137830307643, 542.124798256536, 258.6174203281355, 495.3533169906607, 616.1509376679687, 473.53317789510385, 141.21308427549255, 152.01966406040546, 159.06930323524037, 63.01261951950142, 17.37074383007795, 374.64020636983037, 484.13543075033886, 53.29345320160963, 669.9287917249475, 367.19830599332676, 442.26100750623107, 218.3253006596603, 798.5915547748388, 35.54084231425401, 10.493646353932485, 252.37556323973914, 247.07567304713777, 188.0476579914027, 773.7003857065083, 333.65382486839815, 488.3851618896756, 254.41289156028625, 383.3788912601354, 581.9935542173288, 33.14089330519756, 289.5001901444602, 247.61889986357627, 158.99722253634832, 274.3917692777246, 224.39408934012647, 757.7402490409775, 569.0949370814368, 241.45750432621523, 28.66715405207034, 241.28473337265987, 329.4448364566239, 84.43582855841518, 238.37015335761944, 49.371413101247015, 0.0, 344.9936833310542, 76.08071006645783, 374.7713162859759, 600.8608369120592, 346.323949152804, 206.67017307819765, 198.39163428697674, 515.0532913317405, 270.5562317925736, 520.0600456606435, 477.4343642713107, 260.56982832860876, 267.01318391973797, 364.290645657986, 634.669029881594, 277.5295409102661, 357.7467018978951, 465.1767673691646, 604.8200829030752, 694.1074397300775, 406.16923894168985, 212.47352713846078, 34.327429184334186, 109.79335208844145, 117.94534623922215, 328.393104187452, 117.99346370610039, 74.91249829906583, 187.26616668754806, 439.2906398307161, 546.9767696182942, 171.38103740021603, 553.8381761445372, 807.6338323512093, 633.411646326519, 155.91079586654385, 133.34788446377453, 468.093923624066, 276.8366770427856, 137.72051657463555, 221.84383752635438, 176.312280477136, 46.7496391461214, 57.25601985401151, 0.0, 31.57529559618894, 673.1763651562883, 234.30073700208993, 271.05440400116777]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.929482438955155, "mean_inference_ms": 7.125869318947341, "mean_action_processing_ms": 2.4522771377605834, "mean_env_wait_ms": 17.355365860841186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008187651634216309, "StateBufferConnector_ms": 0.00793302059173584, "ViewRequirementAgentConnector_ms": 0.1545952558517456}, "num_episodes": 13, "episode_return_max": 866.6204886780537, "episode_return_min": -22.278035798277493, "episode_return_mean": 328.51081155225177, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1346688, "num_agent_steps_trained": 1346688, "num_env_steps_sampled": 336672, "num_env_steps_trained": 336672, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 150.52495641333715, "num_env_steps_trained_throughput_per_sec": 150.52495641333715, "timesteps_total": 336672, "num_env_steps_sampled_lifetime": 336672, "num_agent_steps_sampled_lifetime": 1346688, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1346688, "timers": {"training_iteration_time_ms": 26791.321, "restore_workers_time_ms": 0.025, "training_step_time_ms": 26790.223, "sample_time_ms": 3088.572, "learn_time_ms": 23679.521, "learn_throughput": 169.26, "synch_weights_time_ms": 18.995}, "counters": {"num_env_steps_sampled": 336672, "num_env_steps_trained": 336672, "num_agent_steps_sampled": 1346688, "num_agent_steps_trained": 1346688}, "done": false, "training_iteration": 84, "trial_id": "7f713_00000", "date": "2024-08-23_10-24-34", "timestamp": 1724388874, "time_this_iter_s": 26.684292793273926, "time_total_s": 2271.805405139923, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ad96f820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2271.805405139923, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 36.55945945945946, "ram_util_percent": 82.6972972972973}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.26223786697186, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.7299108623827575, "policy_loss": -0.008297437525024175, "vf_loss": 4.7367191334880845, "vf_explained_var": 0.6294133447465442, "kl": 0.007445883885070326, "entropy": 0.861379656842146, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 79853.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.602399010128444, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 4.005296357472738, "policy_loss": -0.010082420188362005, "vf_loss": 4.014844602251809, "vf_explained_var": 0.5205222021335016, "kl": 0.010683533373392291, "entropy": 0.5939197567720261, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 79853.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 340680, "num_env_steps_trained": 340680, "num_agent_steps_sampled": 1362720, "num_agent_steps_trained": 1362720}, "env_runners": {"episode_reward_max": 866.6204886780537, "episode_reward_min": -22.278035798277493, "episode_reward_mean": 333.76482925343703, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1103.3588391986352, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1043.8998339916275}, "policy_reward_mean": {"prey_policy": -192.76238607449602, "predator_policy": 359.6448007012144}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.10564387557343, 231.7702310338859, 152.231037458574, 558.9323482590839, 742.6197929298901, 146.47773473200715, 77.0999999999999, 360.20000000000124, 314.2776507011954, 475.6575129322694, 256.63052287327736, 294.1186984825944, 400.7101089686844, 566.2156422943103, 273.1143853162937, 381.18556830248707, 866.6204886780537, 61.42570492236197, 335.5073981213847, 59.934354263909775, 383.6661580002408, 276.36145651808863, 482.0832833187516, 817.7919848644717, 526.0007067263783, 105.31176927848367, 608.2968343020013, 430.50461491403985, 70.10000000000029, 355.9144429721273, 269.1593231156196, 7.370019758808223, 497.6104128455491, 285.90206174590077, 370.2734462849014, 311.8345030790993, 269.15046502697817, 50.23351013759192, 35.66007139474958, 700.4175326510401, 471.26793750683714, 14.257715545079677, 773.5959388130409, 300.03066486226624, 385.10419877297943, 93.94632914113502, 291.8507395080482, 50.81687777753681, -22.278035798277493, 328.1538205422438, 344.4000000000009, 458.09288997108223, 66.44118215310073, 423.1223642443287, 517.282033963262, 86.49999999999936, 121.49999999999793, 33.87336555776562, 210.30243704995908, 127.49982833132489, 371.85218351075014, 238.48820855394655, 487.40000000000003, 346.3522873264919, 100.7102124969067, 338.89502689922426, 631.9229836258655, 60.30000000000059, 542.2889998171888, 403.00074200282677, 149.35861730912762, 59.2000000000006, 619.0713159436241, 254.16222265189364, 194.79545514448006, 569.5229490729437, 62.065032701169, 248.78029056945724, 449.5532959061112, 623.3660742168963, 359.82760225210114, 340.13928719548164, 354.33017095285135, 260.5811440677934, 365.2358043262199, 842.5037768006654, 186.3517857706521, 580.0154643086721, 427.5270667910678, 62.70000000000062, 432.5000000000026, 233.54294389121048, 752.2164754822106, 513.2366399252302, 340.4341847922202, 310.99122887695853, 365.3395351785799, 342.7824526158173, 708.2100905169827, 192.6936648277091], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-610.3258810531843, 43.5693242677242, -75.93987934436512, -304.9133371477981, -335.248341824529, -296.34413684003687, 215.5173168554183, -722.9094066084508, 91.87121977063705, -813.401687609118, -290.76774501643615, -124.53714992520662, 40.0000000000003, 8.928659428530674, 225.28838445788972, -44.330529784403645, -180.20969217679465, -40.36945728485079, -1103.3588391986352, -84.70511537455153, -369.0556047120206, -188.53793831843424, 88.23030461111904, -643.4363381843782, -385.10225303868833, -527.0652563543412, -650.355823477969, 226.43621797564464, -626.9816350754651, -308.33331768028825, 329.5942871609332, -698.2935511157868, -765.7094686659196, 358.3661972944681, -632.9235997999602, -48.36029818721135, -665.7101009098845, 32.05787757620863, -802.1628125696059, -50.18199326768572, -19.533284974043134, -558.0316985789439, -491.5294268069497, -282.14213229879573, -730.40806266148, -95.62970870873255, 241.37114553354556, -849.0638493916041, -595.2040541624476, 136.41211559718215, -238.400356476289, -205.84678057296586, -91.76046427771831, 260.62568272792583, -686.6644489687134, -97.74194410080736, -71.75001741976581, 18.111024725124683, -148.4415799056697, -36.259949698863295, -36.18532575736188, 27.21440392971988, -876.4602220186221, -503.1046380802553, -120.42846398083563, 392.773646311491, -14.859400497851109, -502.00370027608915, 48.818099462718834, -566.9951703861734, -685.2301864445644, 229.65520684202477, -280.0761755175065, -428.4217830717408, -61.86544004076376, -496.77353574729, -815.1705537493575, -40.798699571449085, -555.5717072864103, 187.86882582557962, 387.6711561925985, -65.57646776656361, -439.35644997091686, -729.5945846656964, 359.12608609679467, -764.8281333425876, -234.47069610268792, -644.4797125629702, 114.60238242553064, -414.03897335339667, -466.3284851074173, -517.273350745164, -264.61484548728373, -244.2766335893375, -498.8341105173822, -561.853266363709, -291.2282458808655, -345.7960520880115, 119.26344814135479, -102.19859489475948, -28.512619519500944, 292.52925616992206, -53.94731639874897, -346.73543075033854, -413.60398161052666, -243.17708116292923, -402.5350750514709, 16.198125796241257, -61.6340711501479, -438.00075032108634, 1.1591576857462298, 39.3063536460678, -231.6755632397403, -146.27567304713918, -154.174292433639, -773.7003857065083, -115.52130237898695, -496.2152473291245, -339.0428580094365, -171.2490964796562, -491.08289632332185, 247.80063231154625, -332.554356383938, 33.92347492985262, -256.1007542986593, 310.1117624845863, 122.6433253579345, -758.4253764125466, -547.0675053546869, -162.77472355605784, 37.1278728471534, 31.815266627340065, 370.16558642765324, -152.1232678168268, -213.17015335762088, -14.271413101246548, 252.63133198204648, -55.33601549591168, 224.17087496183106, -272.02215931143746, -668.6138593537235, -129.21230940201437, -181.87017307819906, -163.99163428697793, -491.7831110827881, 325.2449039020971, -537.8951468650871, -205.4370404149704, -88.33236992676584, -244.45518717709967, -595.4331969436076, 165.99647047697005, -550.3930923493156, -22.81811775767808, -266.04421489175303, -555.1723448110321, -716.4022459927374, 65.67886322707866, 24.585456889817806, 351.97966100428346, -87.40725857653217, 219.4961625009664, -310.09310418744786, 203.84582348938005, 283.4277148928184, -191.2762089265836, -193.18079481661496, -532.5054705645999, -573.3455924180181, 213.3621831994854, 236.62868974092052, -835.1703916179858, 35.626176845502215, -138.53307140516628, 320.97746338578935, -485.8925997439694, 319.2510877161371, -251.28837502605882, -149.11228047713755, -11.249639146120984, -22.956019854011032, 398.2, -630.4303763664852, 159.2216595052189, -43.181349913665485, 290.0426843926191, 26.25228601561143, -92.88122360324996, 126.17010414055815, 9.600563221803132, -36.960327691803435, 100.18944393243322, -436.58664572706414, 227.9336327363271, -454.1368361009552, 7.339940037534234, 343.5404602045953, 247.23903167701005, -0.5285246554273613, -695.0916569035544], "policy_predator_policy_reward": [447.23369660324545, 289.6285040577905, 289.56871875304415, 323.0547287730099, 460.18287596258176, 323.6406401605622, 415.3097839257938, 651.0146540863211, 862.1989317237418, 601.9513290446276, 303.2668955370474, 258.51573413660685, 0.0, 28.171340571469443, 101.41161554211025, 77.83052978440315, 312.15253985439034, 222.70426030845107, 1043.8998339916275, 619.8216335138306, 516.0216704739156, 298.2023954298164, 203.2883938714749, 646.0363381843782, 713.9459973398306, 598.9316210218814, 594.7721791966211, 395.3630686000111, 607.4340646869647, 600.9952733850886, 60.55111349376079, 689.3337187635797, 624.9029703919385, 649.0607896575688, 108.39743466543979, 634.3121682440931, 601.7560413890849, 367.40358006597154, 788.0057765190581, 124.27338358214213, 459.1759770020197, 502.0551645512087, 630.2934920579937, 419.7395235658412, 666.2160079762726, 641.9050467126873, 687.322479629349, 738.1622090931797, 454.1240143884287, 530.6686309032149, 313.7121257547733, 235.8467805729642, 170.33397618044268, 269.097639671352, 645.0320227781465, 569.8789852054134, 104.15001741976397, 19.588975274875317, 338.9498614814431, 201.66611109521716, 213.45199242402828, 64.67825251923381, 604.844784999611, 782.0900948580772, 73.88554507692744, 151.37968543796006, 90.86512571643878, 711.9000368034011, 594.0270424427373, 294.423474765614, 668.1618532768646, 99.24762940477211, 428.7349104457427, 548.9135131704841, 94.59895017835348, 514.273535747294, 815.1705537493575, 76.45877096619827, 543.2722917513984, 524.8481223604747, 92.0129681964195, 57.16028088437719, 452.91416551599684, 730.2945846656966, 644.3340022252008, 534.9639838336309, 587.236661087802, 591.7444124401238, 249.1871651569729, 435.35362454387274, 411.63438196295226, 665.9137830307643, 542.124798256536, 258.6174203281355, 495.3533169906607, 616.1509376679687, 473.53317789510385, 141.21308427549255, 152.01966406040546, 159.06930323524037, 63.01261951950142, 17.37074383007795, 374.64020636983037, 484.13543075033886, 53.29345320160963, 669.9287917249475, 367.19830599332676, 442.26100750623107, 218.3253006596603, 798.5915547748388, 35.54084231425401, 10.493646353932485, 252.37556323973914, 247.07567304713777, 188.0476579914027, 773.7003857065083, 333.65382486839815, 488.3851618896756, 254.41289156028625, 383.3788912601354, 581.9935542173288, 33.14089330519756, 289.5001901444602, 247.61889986357627, 158.99722253634832, 274.3917692777246, 224.39408934012647, 757.7402490409775, 569.0949370814368, 241.45750432621523, 28.66715405207034, 241.28473337265987, 329.4448364566239, 84.43582855841518, 238.37015335761944, 49.371413101247015, 0.0, 344.9936833310542, 76.08071006645783, 374.7713162859759, 600.8608369120592, 346.323949152804, 206.67017307819765, 198.39163428697674, 515.0532913317405, 270.5562317925736, 520.0600456606435, 477.4343642713107, 260.56982832860876, 267.01318391973797, 364.290645657986, 634.669029881594, 277.5295409102661, 357.7467018978951, 465.1767673691646, 604.8200829030752, 694.1074397300775, 406.16923894168985, 212.47352713846078, 34.327429184334186, 109.79335208844145, 117.94534623922215, 328.393104187452, 117.99346370610039, 74.91249829906583, 187.26616668754806, 439.2906398307161, 546.9767696182942, 171.38103740021603, 553.8381761445372, 807.6338323512093, 633.411646326519, 155.91079586654385, 133.34788446377453, 468.093923624066, 276.8366770427856, 137.72051657463555, 221.84383752635438, 176.312280477136, 46.7496391461214, 57.25601985401151, 0.0, 31.57529559618894, 673.1763651562883, 234.30073700208993, 271.05440400116777, 281.59028253262386, 298.27529498024, 158.47512309475465, 46.18839433510336, 120.93218345552731, 126.82992918080106, 100.00719471853068, 473.9853534507871, 350.68750571812325, 438.89184296111785, 92.45676238769532, 24.97383624768189, 200.12652527965977, 688.1873211070321]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.92103521097909, "mean_inference_ms": 7.112371467186947, "mean_action_processing_ms": 2.4434863855035087, "mean_env_wait_ms": 17.35595257176077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016591668128967285, "StateBufferConnector_ms": 0.007942914962768555, "ViewRequirementAgentConnector_ms": 0.1559145450592041}, "num_episodes": 7, "episode_return_max": 866.6204886780537, "episode_return_min": -22.278035798277493, "episode_return_mean": 333.76482925343703, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1362720, "num_agent_steps_trained": 1362720, "num_env_steps_sampled": 340680, "num_env_steps_trained": 340680, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 154.06791858603108, "num_env_steps_trained_throughput_per_sec": 154.06791858603108, "timesteps_total": 340680, "num_env_steps_sampled_lifetime": 340680, "num_agent_steps_sampled_lifetime": 1362720, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1362720, "timers": {"training_iteration_time_ms": 26724.892, "restore_workers_time_ms": 0.025, "training_step_time_ms": 26724.177, "sample_time_ms": 3005.284, "learn_time_ms": 23697.535, "learn_throughput": 169.132, "synch_weights_time_ms": 18.622}, "counters": {"num_env_steps_sampled": 340680, "num_env_steps_trained": 340680, "num_agent_steps_sampled": 1362720, "num_agent_steps_trained": 1362720}, "done": false, "training_iteration": 85, "trial_id": "7f713_00000", "date": "2024-08-23_10-25-01", "timestamp": 1724388901, "time_this_iter_s": 26.06039786338806, "time_total_s": 2297.865803003311, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ad96fe50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2297.865803003311, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 34.53243243243244, "ram_util_percent": 81.98378378378378}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50.95860670912203, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.371413430208882, "policy_loss": -0.009348237976461412, "vf_loss": 4.378708233404412, "vf_explained_var": 0.6668197367557143, "kl": 0.010267120868302684, "entropy": 0.8790098876549454, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 80798.0, "diff_num_grad_updates_vs_sampler_policy": 489.4476047904173}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.128166854570782, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 4.156919488200435, "policy_loss": -0.017202699326579928, "vf_loss": 4.173479593620098, "vf_explained_var": 0.39586585369059646, "kl": 0.012852159877204233, "entropy": 0.5517122070625345, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 80798.0, "diff_num_grad_updates_vs_sampler_policy": 489.4476047904173}}, "num_env_steps_sampled": 344688, "num_env_steps_trained": 344688, "num_agent_steps_sampled": 1378752, "num_agent_steps_trained": 1378752}, "env_runners": {"episode_reward_max": 866.6204886780537, "episode_reward_min": -22.278035798277493, "episode_reward_mean": 336.0771638005249, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1103.3588391986352, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 1043.8998339916275}, "policy_reward_mean": {"prey_policy": -181.08930781530435, "predator_policy": 349.12788971556654}, "custom_metrics": {}, "hist_stats": {"episode_reward": [475.6575129322694, 256.63052287327736, 294.1186984825944, 400.7101089686844, 566.2156422943103, 273.1143853162937, 381.18556830248707, 866.6204886780537, 61.42570492236197, 335.5073981213847, 59.934354263909775, 383.6661580002408, 276.36145651808863, 482.0832833187516, 817.7919848644717, 526.0007067263783, 105.31176927848367, 608.2968343020013, 430.50461491403985, 70.10000000000029, 355.9144429721273, 269.1593231156196, 7.370019758808223, 497.6104128455491, 285.90206174590077, 370.2734462849014, 311.8345030790993, 269.15046502697817, 50.23351013759192, 35.66007139474958, 700.4175326510401, 471.26793750683714, 14.257715545079677, 773.5959388130409, 300.03066486226624, 385.10419877297943, 93.94632914113502, 291.8507395080482, 50.81687777753681, -22.278035798277493, 328.1538205422438, 344.4000000000009, 458.09288997108223, 66.44118215310073, 423.1223642443287, 517.282033963262, 86.49999999999936, 121.49999999999793, 33.87336555776562, 210.30243704995908, 127.49982833132489, 371.85218351075014, 238.48820855394655, 487.40000000000003, 346.3522873264919, 100.7102124969067, 338.89502689922426, 631.9229836258655, 60.30000000000059, 542.2889998171888, 403.00074200282677, 149.35861730912762, 59.2000000000006, 619.0713159436241, 254.16222265189364, 194.79545514448006, 569.5229490729437, 62.065032701169, 248.78029056945724, 449.5532959061112, 623.3660742168963, 359.82760225210114, 340.13928719548164, 354.33017095285135, 260.5811440677934, 365.2358043262199, 842.5037768006654, 186.3517857706521, 580.0154643086721, 427.5270667910678, 62.70000000000062, 432.5000000000026, 233.54294389121048, 752.2164754822106, 513.2366399252302, 340.4341847922202, 310.99122887695853, 365.3395351785799, 342.7824526158173, 708.2100905169827, 192.6936648277091, 95.98771322444011, 347.9181916437499, 724.8536817219274, 599.7381064055685, 50.711903428459564, 75.2, 255.057283638447, 399.000000000002, 436.4810136364009], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-1103.3588391986352, -84.70511537455153, -369.0556047120206, -188.53793831843424, 88.23030461111904, -643.4363381843782, -385.10225303868833, -527.0652563543412, -650.355823477969, 226.43621797564464, -626.9816350754651, -308.33331768028825, 329.5942871609332, -698.2935511157868, -765.7094686659196, 358.3661972944681, -632.9235997999602, -48.36029818721135, -665.7101009098845, 32.05787757620863, -802.1628125696059, -50.18199326768572, -19.533284974043134, -558.0316985789439, -491.5294268069497, -282.14213229879573, -730.40806266148, -95.62970870873255, 241.37114553354556, -849.0638493916041, -595.2040541624476, 136.41211559718215, -238.400356476289, -205.84678057296586, -91.76046427771831, 260.62568272792583, -686.6644489687134, -97.74194410080736, -71.75001741976581, 18.111024725124683, -148.4415799056697, -36.259949698863295, -36.18532575736188, 27.21440392971988, -876.4602220186221, -503.1046380802553, -120.42846398083563, 392.773646311491, -14.859400497851109, -502.00370027608915, 48.818099462718834, -566.9951703861734, -685.2301864445644, 229.65520684202477, -280.0761755175065, -428.4217830717408, -61.86544004076376, -496.77353574729, -815.1705537493575, -40.798699571449085, -555.5717072864103, 187.86882582557962, 387.6711561925985, -65.57646776656361, -439.35644997091686, -729.5945846656964, 359.12608609679467, -764.8281333425876, -234.47069610268792, -644.4797125629702, 114.60238242553064, -414.03897335339667, -466.3284851074173, -517.273350745164, -264.61484548728373, -244.2766335893375, -498.8341105173822, -561.853266363709, -291.2282458808655, -345.7960520880115, 119.26344814135479, -102.19859489475948, -28.512619519500944, 292.52925616992206, -53.94731639874897, -346.73543075033854, -413.60398161052666, -243.17708116292923, -402.5350750514709, 16.198125796241257, -61.6340711501479, -438.00075032108634, 1.1591576857462298, 39.3063536460678, -231.6755632397403, -146.27567304713918, -154.174292433639, -773.7003857065083, -115.52130237898695, -496.2152473291245, -339.0428580094365, -171.2490964796562, -491.08289632332185, 247.80063231154625, -332.554356383938, 33.92347492985262, -256.1007542986593, 310.1117624845863, 122.6433253579345, -758.4253764125466, -547.0675053546869, -162.77472355605784, 37.1278728471534, 31.815266627340065, 370.16558642765324, -152.1232678168268, -213.17015335762088, -14.271413101246548, 252.63133198204648, -55.33601549591168, 224.17087496183106, -272.02215931143746, -668.6138593537235, -129.21230940201437, -181.87017307819906, -163.99163428697793, -491.7831110827881, 325.2449039020971, -537.8951468650871, -205.4370404149704, -88.33236992676584, -244.45518717709967, -595.4331969436076, 165.99647047697005, -550.3930923493156, -22.81811775767808, -266.04421489175303, -555.1723448110321, -716.4022459927374, 65.67886322707866, 24.585456889817806, 351.97966100428346, -87.40725857653217, 219.4961625009664, -310.09310418744786, 203.84582348938005, 283.4277148928184, -191.2762089265836, -193.18079481661496, -532.5054705645999, -573.3455924180181, 213.3621831994854, 236.62868974092052, -835.1703916179858, 35.626176845502215, -138.53307140516628, 320.97746338578935, -485.8925997439694, 319.2510877161371, -251.28837502605882, -149.11228047713755, -11.249639146120984, -22.956019854011032, 398.2, -630.4303763664852, 159.2216595052189, -43.181349913665485, 290.0426843926191, 26.25228601561143, -92.88122360324996, 126.17010414055815, 9.600563221803132, -36.960327691803435, 100.18944393243322, -436.58664572706414, 227.9336327363271, -454.1368361009552, 7.339940037534234, 343.5404602045953, 247.23903167701005, -0.5285246554273613, -695.0916569035544, -331.2851159399556, -242.07537395086547, 312.34768621983494, -407.5237887181003, 366.87852804316185, 251.22201628417122, -158.6474728649444, 297.60794247001013, 3.522656675867729, -333.59599321253927, -29.098365682834554, 33.54022629609827, -797.9242291398702, 17.62115565884935, 12.552740121044463, 305.4843390274429, 178.2539536244069, -358.3875929084156], "policy_predator_policy_reward": [1043.8998339916275, 619.8216335138306, 516.0216704739156, 298.2023954298164, 203.2883938714749, 646.0363381843782, 713.9459973398306, 598.9316210218814, 594.7721791966211, 395.3630686000111, 607.4340646869647, 600.9952733850886, 60.55111349376079, 689.3337187635797, 624.9029703919385, 649.0607896575688, 108.39743466543979, 634.3121682440931, 601.7560413890849, 367.40358006597154, 788.0057765190581, 124.27338358214213, 459.1759770020197, 502.0551645512087, 630.2934920579937, 419.7395235658412, 666.2160079762726, 641.9050467126873, 687.322479629349, 738.1622090931797, 454.1240143884287, 530.6686309032149, 313.7121257547733, 235.8467805729642, 170.33397618044268, 269.097639671352, 645.0320227781465, 569.8789852054134, 104.15001741976397, 19.588975274875317, 338.9498614814431, 201.66611109521716, 213.45199242402828, 64.67825251923381, 604.844784999611, 782.0900948580772, 73.88554507692744, 151.37968543796006, 90.86512571643878, 711.9000368034011, 594.0270424427373, 294.423474765614, 668.1618532768646, 99.24762940477211, 428.7349104457427, 548.9135131704841, 94.59895017835348, 514.273535747294, 815.1705537493575, 76.45877096619827, 543.2722917513984, 524.8481223604747, 92.0129681964195, 57.16028088437719, 452.91416551599684, 730.2945846656966, 644.3340022252008, 534.9639838336309, 587.236661087802, 591.7444124401238, 249.1871651569729, 435.35362454387274, 411.63438196295226, 665.9137830307643, 542.124798256536, 258.6174203281355, 495.3533169906607, 616.1509376679687, 473.53317789510385, 141.21308427549255, 152.01966406040546, 159.06930323524037, 63.01261951950142, 17.37074383007795, 374.64020636983037, 484.13543075033886, 53.29345320160963, 669.9287917249475, 367.19830599332676, 442.26100750623107, 218.3253006596603, 798.5915547748388, 35.54084231425401, 10.493646353932485, 252.37556323973914, 247.07567304713777, 188.0476579914027, 773.7003857065083, 333.65382486839815, 488.3851618896756, 254.41289156028625, 383.3788912601354, 581.9935542173288, 33.14089330519756, 289.5001901444602, 247.61889986357627, 158.99722253634832, 274.3917692777246, 224.39408934012647, 757.7402490409775, 569.0949370814368, 241.45750432621523, 28.66715405207034, 241.28473337265987, 329.4448364566239, 84.43582855841518, 238.37015335761944, 49.371413101247015, 0.0, 344.9936833310542, 76.08071006645783, 374.7713162859759, 600.8608369120592, 346.323949152804, 206.67017307819765, 198.39163428697674, 515.0532913317405, 270.5562317925736, 520.0600456606435, 477.4343642713107, 260.56982832860876, 267.01318391973797, 364.290645657986, 634.669029881594, 277.5295409102661, 357.7467018978951, 465.1767673691646, 604.8200829030752, 694.1074397300775, 406.16923894168985, 212.47352713846078, 34.327429184334186, 109.79335208844145, 117.94534623922215, 328.393104187452, 117.99346370610039, 74.91249829906583, 187.26616668754806, 439.2906398307161, 546.9767696182942, 171.38103740021603, 553.8381761445372, 807.6338323512093, 633.411646326519, 155.91079586654385, 133.34788446377453, 468.093923624066, 276.8366770427856, 137.72051657463555, 221.84383752635438, 176.312280477136, 46.7496391461214, 57.25601985401151, 0.0, 31.57529559618894, 673.1763651562883, 234.30073700208993, 271.05440400116777, 281.59028253262386, 298.27529498024, 158.47512309475465, 46.18839433510336, 120.93218345552731, 126.82992918080106, 100.00719471853068, 473.9853534507871, 350.68750571812325, 438.89184296111785, 92.45676238769532, 24.97383624768189, 200.12652527965977, 688.1873211070321, 390.06403141949147, 279.28417169576926, 15.464489422246553, 427.6298047197685, 30.853329324537555, 75.8998080700567, 303.41383379015855, 157.36380301034455, 27.689246752591593, 353.09599321254234, 64.898365682835, 5.859773703901936, 827.2545954110806, 208.105761708387, 24.84725987895559, 56.11566097255712, 287.0941337879401, 329.5205191324626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.915091536305702, "mean_inference_ms": 7.105118239981299, "mean_action_processing_ms": 2.4397082297168056, "mean_env_wait_ms": 17.361188969414982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016584277153015137, "StateBufferConnector_ms": 0.007953643798828125, "ViewRequirementAgentConnector_ms": 0.2061387300491333}, "num_episodes": 9, "episode_return_max": 866.6204886780537, "episode_return_min": -22.278035798277493, "episode_return_mean": 336.0771638005249, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1378752, "num_agent_steps_trained": 1378752, "num_env_steps_sampled": 344688, "num_env_steps_trained": 344688, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 154.7532109819629, "num_env_steps_trained_throughput_per_sec": 154.7532109819629, "timesteps_total": 344688, "num_env_steps_sampled_lifetime": 344688, "num_agent_steps_sampled_lifetime": 1378752, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1378752, "timers": {"training_iteration_time_ms": 26632.611, "restore_workers_time_ms": 0.025, "training_step_time_ms": 26631.894, "sample_time_ms": 2939.51, "learn_time_ms": 23670.982, "learn_throughput": 169.321, "synch_weights_time_ms": 18.514}, "counters": {"num_env_steps_sampled": 344688, "num_env_steps_trained": 344688, "num_agent_steps_sampled": 1378752, "num_agent_steps_trained": 1378752}, "done": false, "training_iteration": 86, "trial_id": "7f713_00000", "date": "2024-08-23_10-25-27", "timestamp": 1724388927, "time_this_iter_s": 25.941638231277466, "time_total_s": 2323.8074412345886, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737a2c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2323.8074412345886, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 35.98918918918919, "ram_util_percent": 82.35675675675677}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 44.075245051156905, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.387675825502507, "policy_loss": -0.009655791399113479, "vf_loss": 4.395828862669607, "vf_explained_var": 0.6344165425451975, "kl": 0.007513844870553209, "entropy": 0.8744848028061882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 81743.0, "diff_num_grad_updates_vs_sampler_policy": 480.95958083831647}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.78850642966215, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 4.2635199980761005, "policy_loss": -0.008883563802878141, "vf_loss": 4.271861109657893, "vf_explained_var": 0.3782828233860157, "kl": 0.010849350209411962, "entropy": 0.5134492043780271, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 81743.0, "diff_num_grad_updates_vs_sampler_policy": 480.95958083831647}}, "num_env_steps_sampled": 348696, "num_env_steps_trained": 348696, "num_agent_steps_sampled": 1394784, "num_agent_steps_trained": 1394784}, "env_runners": {"episode_reward_max": 842.5037768006654, "episode_reward_min": -22.278035798277493, "episode_reward_mean": 331.4900345787984, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -876.4602220186221, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 827.2545954110806}, "policy_reward_mean": {"prey_policy": -159.09827726280963, "predator_policy": 324.84329455220853}, "custom_metrics": {}, "hist_stats": {"episode_reward": [61.42570492236197, 335.5073981213847, 59.934354263909775, 383.6661580002408, 276.36145651808863, 482.0832833187516, 817.7919848644717, 526.0007067263783, 105.31176927848367, 608.2968343020013, 430.50461491403985, 70.10000000000029, 355.9144429721273, 269.1593231156196, 7.370019758808223, 497.6104128455491, 285.90206174590077, 370.2734462849014, 311.8345030790993, 269.15046502697817, 50.23351013759192, 35.66007139474958, 700.4175326510401, 471.26793750683714, 14.257715545079677, 773.5959388130409, 300.03066486226624, 385.10419877297943, 93.94632914113502, 291.8507395080482, 50.81687777753681, -22.278035798277493, 328.1538205422438, 344.4000000000009, 458.09288997108223, 66.44118215310073, 423.1223642443287, 517.282033963262, 86.49999999999936, 121.49999999999793, 33.87336555776562, 210.30243704995908, 127.49982833132489, 371.85218351075014, 238.48820855394655, 487.40000000000003, 346.3522873264919, 100.7102124969067, 338.89502689922426, 631.9229836258655, 60.30000000000059, 542.2889998171888, 403.00074200282677, 149.35861730912762, 59.2000000000006, 619.0713159436241, 254.16222265189364, 194.79545514448006, 569.5229490729437, 62.065032701169, 248.78029056945724, 449.5532959061112, 623.3660742168963, 359.82760225210114, 340.13928719548164, 354.33017095285135, 260.5811440677934, 365.2358043262199, 842.5037768006654, 186.3517857706521, 580.0154643086721, 427.5270667910678, 62.70000000000062, 432.5000000000026, 233.54294389121048, 752.2164754822106, 513.2366399252302, 340.4341847922202, 310.99122887695853, 365.3395351785799, 342.7824526158173, 708.2100905169827, 192.6936648277091, 95.98771322444011, 347.9181916437499, 724.8536817219274, 599.7381064055685, 50.711903428459564, 75.2, 255.057283638447, 399.000000000002, 436.4810136364009, 422.49741209927754, 595.542783017021, 400.8735425561629, 358.2000659002467, 280.3752792377946, 418.30000000000246, 518.5722633031044, 61.178659561700144], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-632.9235997999602, -48.36029818721135, -665.7101009098845, 32.05787757620863, -802.1628125696059, -50.18199326768572, -19.533284974043134, -558.0316985789439, -491.5294268069497, -282.14213229879573, -730.40806266148, -95.62970870873255, 241.37114553354556, -849.0638493916041, -595.2040541624476, 136.41211559718215, -238.400356476289, -205.84678057296586, -91.76046427771831, 260.62568272792583, -686.6644489687134, -97.74194410080736, -71.75001741976581, 18.111024725124683, -148.4415799056697, -36.259949698863295, -36.18532575736188, 27.21440392971988, -876.4602220186221, -503.1046380802553, -120.42846398083563, 392.773646311491, -14.859400497851109, -502.00370027608915, 48.818099462718834, -566.9951703861734, -685.2301864445644, 229.65520684202477, -280.0761755175065, -428.4217830717408, -61.86544004076376, -496.77353574729, -815.1705537493575, -40.798699571449085, -555.5717072864103, 187.86882582557962, 387.6711561925985, -65.57646776656361, -439.35644997091686, -729.5945846656964, 359.12608609679467, -764.8281333425876, -234.47069610268792, -644.4797125629702, 114.60238242553064, -414.03897335339667, -466.3284851074173, -517.273350745164, -264.61484548728373, -244.2766335893375, -498.8341105173822, -561.853266363709, -291.2282458808655, -345.7960520880115, 119.26344814135479, -102.19859489475948, -28.512619519500944, 292.52925616992206, -53.94731639874897, -346.73543075033854, -413.60398161052666, -243.17708116292923, -402.5350750514709, 16.198125796241257, -61.6340711501479, -438.00075032108634, 1.1591576857462298, 39.3063536460678, -231.6755632397403, -146.27567304713918, -154.174292433639, -773.7003857065083, -115.52130237898695, -496.2152473291245, -339.0428580094365, -171.2490964796562, -491.08289632332185, 247.80063231154625, -332.554356383938, 33.92347492985262, -256.1007542986593, 310.1117624845863, 122.6433253579345, -758.4253764125466, -547.0675053546869, -162.77472355605784, 37.1278728471534, 31.815266627340065, 370.16558642765324, -152.1232678168268, -213.17015335762088, -14.271413101246548, 252.63133198204648, -55.33601549591168, 224.17087496183106, -272.02215931143746, -668.6138593537235, -129.21230940201437, -181.87017307819906, -163.99163428697793, -491.7831110827881, 325.2449039020971, -537.8951468650871, -205.4370404149704, -88.33236992676584, -244.45518717709967, -595.4331969436076, 165.99647047697005, -550.3930923493156, -22.81811775767808, -266.04421489175303, -555.1723448110321, -716.4022459927374, 65.67886322707866, 24.585456889817806, 351.97966100428346, -87.40725857653217, 219.4961625009664, -310.09310418744786, 203.84582348938005, 283.4277148928184, -191.2762089265836, -193.18079481661496, -532.5054705645999, -573.3455924180181, 213.3621831994854, 236.62868974092052, -835.1703916179858, 35.626176845502215, -138.53307140516628, 320.97746338578935, -485.8925997439694, 319.2510877161371, -251.28837502605882, -149.11228047713755, -11.249639146120984, -22.956019854011032, 398.2, -630.4303763664852, 159.2216595052189, -43.181349913665485, 290.0426843926191, 26.25228601561143, -92.88122360324996, 126.17010414055815, 9.600563221803132, -36.960327691803435, 100.18944393243322, -436.58664572706414, 227.9336327363271, -454.1368361009552, 7.339940037534234, 343.5404602045953, 247.23903167701005, -0.5285246554273613, -695.0916569035544, -331.2851159399556, -242.07537395086547, 312.34768621983494, -407.5237887181003, 366.87852804316185, 251.22201628417122, -158.6474728649444, 297.60794247001013, 3.522656675867729, -333.59599321253927, -29.098365682834554, 33.54022629609827, -797.9242291398702, 17.62115565884935, 12.552740121044463, 305.4843390274429, 178.2539536244069, -358.3875929084156, -214.0140102418448, 29.539595713030714, 263.0028524928904, 100.73090129209663, -11.22560824584869, 169.87849383636765, -727.2311517102074, -57.130937962430544, 69.39718094507072, -54.73095163887218, 377.05881022413485, -60.37781560401047, 45.93587368773361, -13.663884737250271, -563.8885430015563, -303.3828287046764], "policy_predator_policy_reward": [108.39743466543979, 634.3121682440931, 601.7560413890849, 367.40358006597154, 788.0057765190581, 124.27338358214213, 459.1759770020197, 502.0551645512087, 630.2934920579937, 419.7395235658412, 666.2160079762726, 641.9050467126873, 687.322479629349, 738.1622090931797, 454.1240143884287, 530.6686309032149, 313.7121257547733, 235.8467805729642, 170.33397618044268, 269.097639671352, 645.0320227781465, 569.8789852054134, 104.15001741976397, 19.588975274875317, 338.9498614814431, 201.66611109521716, 213.45199242402828, 64.67825251923381, 604.844784999611, 782.0900948580772, 73.88554507692744, 151.37968543796006, 90.86512571643878, 711.9000368034011, 594.0270424427373, 294.423474765614, 668.1618532768646, 99.24762940477211, 428.7349104457427, 548.9135131704841, 94.59895017835348, 514.273535747294, 815.1705537493575, 76.45877096619827, 543.2722917513984, 524.8481223604747, 92.0129681964195, 57.16028088437719, 452.91416551599684, 730.2945846656966, 644.3340022252008, 534.9639838336309, 587.236661087802, 591.7444124401238, 249.1871651569729, 435.35362454387274, 411.63438196295226, 665.9137830307643, 542.124798256536, 258.6174203281355, 495.3533169906607, 616.1509376679687, 473.53317789510385, 141.21308427549255, 152.01966406040546, 159.06930323524037, 63.01261951950142, 17.37074383007795, 374.64020636983037, 484.13543075033886, 53.29345320160963, 669.9287917249475, 367.19830599332676, 442.26100750623107, 218.3253006596603, 798.5915547748388, 35.54084231425401, 10.493646353932485, 252.37556323973914, 247.07567304713777, 188.0476579914027, 773.7003857065083, 333.65382486839815, 488.3851618896756, 254.41289156028625, 383.3788912601354, 581.9935542173288, 33.14089330519756, 289.5001901444602, 247.61889986357627, 158.99722253634832, 274.3917692777246, 224.39408934012647, 757.7402490409775, 569.0949370814368, 241.45750432621523, 28.66715405207034, 241.28473337265987, 329.4448364566239, 84.43582855841518, 238.37015335761944, 49.371413101247015, 0.0, 344.9936833310542, 76.08071006645783, 374.7713162859759, 600.8608369120592, 346.323949152804, 206.67017307819765, 198.39163428697674, 515.0532913317405, 270.5562317925736, 520.0600456606435, 477.4343642713107, 260.56982832860876, 267.01318391973797, 364.290645657986, 634.669029881594, 277.5295409102661, 357.7467018978951, 465.1767673691646, 604.8200829030752, 694.1074397300775, 406.16923894168985, 212.47352713846078, 34.327429184334186, 109.79335208844145, 117.94534623922215, 328.393104187452, 117.99346370610039, 74.91249829906583, 187.26616668754806, 439.2906398307161, 546.9767696182942, 171.38103740021603, 553.8381761445372, 807.6338323512093, 633.411646326519, 155.91079586654385, 133.34788446377453, 468.093923624066, 276.8366770427856, 137.72051657463555, 221.84383752635438, 176.312280477136, 46.7496391461214, 57.25601985401151, 0.0, 31.57529559618894, 673.1763651562883, 234.30073700208993, 271.05440400116777, 281.59028253262386, 298.27529498024, 158.47512309475465, 46.18839433510336, 120.93218345552731, 126.82992918080106, 100.00719471853068, 473.9853534507871, 350.68750571812325, 438.89184296111785, 92.45676238769532, 24.97383624768189, 200.12652527965977, 688.1873211070321, 390.06403141949147, 279.28417169576926, 15.464489422246553, 427.6298047197685, 30.853329324537555, 75.8998080700567, 303.41383379015855, 157.36380301034455, 27.689246752591593, 353.09599321254234, 64.898365682835, 5.859773703901936, 827.2545954110806, 208.105761708387, 24.84725987895559, 56.11566097255712, 287.0941337879401, 329.5205191324626, 314.5314543106873, 292.44037231740475, 58.966873756375136, 172.84215547565873, 86.35534373119056, 155.86531323445166, 546.5950528918602, 595.9671026810166, 173.16683982080215, 92.54221011079264, 8.74118977586512, 92.87781560400903, 273.3327752465407, 212.96749910607653, 571.5033402282564, 356.946691039685]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.918710108410913, "mean_inference_ms": 7.106027205900251, "mean_action_processing_ms": 2.436837356156592, "mean_env_wait_ms": 17.37335377772782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016426563262939453, "StateBufferConnector_ms": 0.007727980613708496, "ViewRequirementAgentConnector_ms": 0.2026737928390503}, "num_episodes": 8, "episode_return_max": 842.5037768006654, "episode_return_min": -22.278035798277493, "episode_return_mean": 331.4900345787984, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1394784, "num_agent_steps_trained": 1394784, "num_env_steps_sampled": 348696, "num_env_steps_trained": 348696, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 150.04892997210692, "num_env_steps_trained_throughput_per_sec": 150.04892997210692, "timesteps_total": 348696, "num_env_steps_sampled_lifetime": 348696, "num_agent_steps_sampled_lifetime": 1394784, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1394784, "timers": {"training_iteration_time_ms": 26631.657, "restore_workers_time_ms": 0.023, "training_step_time_ms": 26630.945, "sample_time_ms": 2888.832, "learn_time_ms": 23720.534, "learn_throughput": 168.968, "synch_weights_time_ms": 18.577}, "counters": {"num_env_steps_sampled": 348696, "num_env_steps_trained": 348696, "num_agent_steps_sampled": 1394784, "num_agent_steps_trained": 1394784}, "done": false, "training_iteration": 87, "trial_id": "7f713_00000", "date": "2024-08-23_10-25-53", "timestamp": 1724388953, "time_this_iter_s": 26.764589071273804, "time_total_s": 2350.5720303058624, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737dbee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2350.5720303058624, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 37.097368421052636, "ram_util_percent": 82.42368421052633}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.47791481144214, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.551302693382142, "policy_loss": -0.008837189636237565, "vf_loss": 4.5585991322048125, "vf_explained_var": 0.6616620057474368, "kl": 0.007703665561146206, "entropy": 0.8345035144891688, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 82688.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.654919699007873, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 3.9999545569142336, "policy_loss": -0.012362862193572615, "vf_loss": 4.011879742334759, "vf_explained_var": 0.4727064940033766, "kl": 0.008753469477718075, "entropy": 0.5061785524484341, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 82688.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 352704, "num_env_steps_trained": 352704, "num_agent_steps_sampled": 1410816, "num_agent_steps_trained": 1410816}, "env_runners": {"episode_reward_max": 842.5037768006654, "episode_reward_min": -22.278035798277493, "episode_reward_mean": 329.1553906164208, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -876.4602220186221, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 827.2545954110806}, "policy_reward_mean": {"prey_policy": -138.00267907784, "predator_policy": 302.58037438605015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [105.31176927848367, 608.2968343020013, 430.50461491403985, 70.10000000000029, 355.9144429721273, 269.1593231156196, 7.370019758808223, 497.6104128455491, 285.90206174590077, 370.2734462849014, 311.8345030790993, 269.15046502697817, 50.23351013759192, 35.66007139474958, 700.4175326510401, 471.26793750683714, 14.257715545079677, 773.5959388130409, 300.03066486226624, 385.10419877297943, 93.94632914113502, 291.8507395080482, 50.81687777753681, -22.278035798277493, 328.1538205422438, 344.4000000000009, 458.09288997108223, 66.44118215310073, 423.1223642443287, 517.282033963262, 86.49999999999936, 121.49999999999793, 33.87336555776562, 210.30243704995908, 127.49982833132489, 371.85218351075014, 238.48820855394655, 487.40000000000003, 346.3522873264919, 100.7102124969067, 338.89502689922426, 631.9229836258655, 60.30000000000059, 542.2889998171888, 403.00074200282677, 149.35861730912762, 59.2000000000006, 619.0713159436241, 254.16222265189364, 194.79545514448006, 569.5229490729437, 62.065032701169, 248.78029056945724, 449.5532959061112, 623.3660742168963, 359.82760225210114, 340.13928719548164, 354.33017095285135, 260.5811440677934, 365.2358043262199, 842.5037768006654, 186.3517857706521, 580.0154643086721, 427.5270667910678, 62.70000000000062, 432.5000000000026, 233.54294389121048, 752.2164754822106, 513.2366399252302, 340.4341847922202, 310.99122887695853, 365.3395351785799, 342.7824526158173, 708.2100905169827, 192.6936648277091, 95.98771322444011, 347.9181916437499, 724.8536817219274, 599.7381064055685, 50.711903428459564, 75.2, 255.057283638447, 399.000000000002, 436.4810136364009, 422.49741209927754, 595.542783017021, 400.8735425561629, 358.2000659002467, 280.3752792377946, 418.30000000000246, 518.5722633031044, 61.178659561700144, 381.3872472269089, 399.5480199304558, 668.1, 255.45695172515747, 91.31593444995036, 386.6333050404395, 214.29759665711512, 312.56759546780984], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-238.400356476289, -205.84678057296586, -91.76046427771831, 260.62568272792583, -686.6644489687134, -97.74194410080736, -71.75001741976581, 18.111024725124683, -148.4415799056697, -36.259949698863295, -36.18532575736188, 27.21440392971988, -876.4602220186221, -503.1046380802553, -120.42846398083563, 392.773646311491, -14.859400497851109, -502.00370027608915, 48.818099462718834, -566.9951703861734, -685.2301864445644, 229.65520684202477, -280.0761755175065, -428.4217830717408, -61.86544004076376, -496.77353574729, -815.1705537493575, -40.798699571449085, -555.5717072864103, 187.86882582557962, 387.6711561925985, -65.57646776656361, -439.35644997091686, -729.5945846656964, 359.12608609679467, -764.8281333425876, -234.47069610268792, -644.4797125629702, 114.60238242553064, -414.03897335339667, -466.3284851074173, -517.273350745164, -264.61484548728373, -244.2766335893375, -498.8341105173822, -561.853266363709, -291.2282458808655, -345.7960520880115, 119.26344814135479, -102.19859489475948, -28.512619519500944, 292.52925616992206, -53.94731639874897, -346.73543075033854, -413.60398161052666, -243.17708116292923, -402.5350750514709, 16.198125796241257, -61.6340711501479, -438.00075032108634, 1.1591576857462298, 39.3063536460678, -231.6755632397403, -146.27567304713918, -154.174292433639, -773.7003857065083, -115.52130237898695, -496.2152473291245, -339.0428580094365, -171.2490964796562, -491.08289632332185, 247.80063231154625, -332.554356383938, 33.92347492985262, -256.1007542986593, 310.1117624845863, 122.6433253579345, -758.4253764125466, -547.0675053546869, -162.77472355605784, 37.1278728471534, 31.815266627340065, 370.16558642765324, -152.1232678168268, -213.17015335762088, -14.271413101246548, 252.63133198204648, -55.33601549591168, 224.17087496183106, -272.02215931143746, -668.6138593537235, -129.21230940201437, -181.87017307819906, -163.99163428697793, -491.7831110827881, 325.2449039020971, -537.8951468650871, -205.4370404149704, -88.33236992676584, -244.45518717709967, -595.4331969436076, 165.99647047697005, -550.3930923493156, -22.81811775767808, -266.04421489175303, -555.1723448110321, -716.4022459927374, 65.67886322707866, 24.585456889817806, 351.97966100428346, -87.40725857653217, 219.4961625009664, -310.09310418744786, 203.84582348938005, 283.4277148928184, -191.2762089265836, -193.18079481661496, -532.5054705645999, -573.3455924180181, 213.3621831994854, 236.62868974092052, -835.1703916179858, 35.626176845502215, -138.53307140516628, 320.97746338578935, -485.8925997439694, 319.2510877161371, -251.28837502605882, -149.11228047713755, -11.249639146120984, -22.956019854011032, 398.2, -630.4303763664852, 159.2216595052189, -43.181349913665485, 290.0426843926191, 26.25228601561143, -92.88122360324996, 126.17010414055815, 9.600563221803132, -36.960327691803435, 100.18944393243322, -436.58664572706414, 227.9336327363271, -454.1368361009552, 7.339940037534234, 343.5404602045953, 247.23903167701005, -0.5285246554273613, -695.0916569035544, -331.2851159399556, -242.07537395086547, 312.34768621983494, -407.5237887181003, 366.87852804316185, 251.22201628417122, -158.6474728649444, 297.60794247001013, 3.522656675867729, -333.59599321253927, -29.098365682834554, 33.54022629609827, -797.9242291398702, 17.62115565884935, 12.552740121044463, 305.4843390274429, 178.2539536244069, -358.3875929084156, -214.0140102418448, 29.539595713030714, 263.0028524928904, 100.73090129209663, -11.22560824584869, 169.87849383636765, -727.2311517102074, -57.130937962430544, 69.39718094507072, -54.73095163887218, 377.05881022413485, -60.37781560401047, 45.93587368773361, -13.663884737250271, -563.8885430015563, -303.3828287046764, 264.4146104787877, 31.978674800287827, -196.7902798310463, 187.73480480063483, 181.8501738934856, 351.0018709755116, -315.08210160932606, -604.1922553715534, -653.6937267231076, -125.23478538507487, 289.30316252450194, -222.5501828940875, -37.77118897770393, -295.2809729330478, -43.496866439981034, -4.111183924762079], "policy_predator_policy_reward": [313.7121257547733, 235.8467805729642, 170.33397618044268, 269.097639671352, 645.0320227781465, 569.8789852054134, 104.15001741976397, 19.588975274875317, 338.9498614814431, 201.66611109521716, 213.45199242402828, 64.67825251923381, 604.844784999611, 782.0900948580772, 73.88554507692744, 151.37968543796006, 90.86512571643878, 711.9000368034011, 594.0270424427373, 294.423474765614, 668.1618532768646, 99.24762940477211, 428.7349104457427, 548.9135131704841, 94.59895017835348, 514.273535747294, 815.1705537493575, 76.45877096619827, 543.2722917513984, 524.8481223604747, 92.0129681964195, 57.16028088437719, 452.91416551599684, 730.2945846656966, 644.3340022252008, 534.9639838336309, 587.236661087802, 591.7444124401238, 249.1871651569729, 435.35362454387274, 411.63438196295226, 665.9137830307643, 542.124798256536, 258.6174203281355, 495.3533169906607, 616.1509376679687, 473.53317789510385, 141.21308427549255, 152.01966406040546, 159.06930323524037, 63.01261951950142, 17.37074383007795, 374.64020636983037, 484.13543075033886, 53.29345320160963, 669.9287917249475, 367.19830599332676, 442.26100750623107, 218.3253006596603, 798.5915547748388, 35.54084231425401, 10.493646353932485, 252.37556323973914, 247.07567304713777, 188.0476579914027, 773.7003857065083, 333.65382486839815, 488.3851618896756, 254.41289156028625, 383.3788912601354, 581.9935542173288, 33.14089330519756, 289.5001901444602, 247.61889986357627, 158.99722253634832, 274.3917692777246, 224.39408934012647, 757.7402490409775, 569.0949370814368, 241.45750432621523, 28.66715405207034, 241.28473337265987, 329.4448364566239, 84.43582855841518, 238.37015335761944, 49.371413101247015, 0.0, 344.9936833310542, 76.08071006645783, 374.7713162859759, 600.8608369120592, 346.323949152804, 206.67017307819765, 198.39163428697674, 515.0532913317405, 270.5562317925736, 520.0600456606435, 477.4343642713107, 260.56982832860876, 267.01318391973797, 364.290645657986, 634.669029881594, 277.5295409102661, 357.7467018978951, 465.1767673691646, 604.8200829030752, 694.1074397300775, 406.16923894168985, 212.47352713846078, 34.327429184334186, 109.79335208844145, 117.94534623922215, 328.393104187452, 117.99346370610039, 74.91249829906583, 187.26616668754806, 439.2906398307161, 546.9767696182942, 171.38103740021603, 553.8381761445372, 807.6338323512093, 633.411646326519, 155.91079586654385, 133.34788446377453, 468.093923624066, 276.8366770427856, 137.72051657463555, 221.84383752635438, 176.312280477136, 46.7496391461214, 57.25601985401151, 0.0, 31.57529559618894, 673.1763651562883, 234.30073700208993, 271.05440400116777, 281.59028253262386, 298.27529498024, 158.47512309475465, 46.18839433510336, 120.93218345552731, 126.82992918080106, 100.00719471853068, 473.9853534507871, 350.68750571812325, 438.89184296111785, 92.45676238769532, 24.97383624768189, 200.12652527965977, 688.1873211070321, 390.06403141949147, 279.28417169576926, 15.464489422246553, 427.6298047197685, 30.853329324537555, 75.8998080700567, 303.41383379015855, 157.36380301034455, 27.689246752591593, 353.09599321254234, 64.898365682835, 5.859773703901936, 827.2545954110806, 208.105761708387, 24.84725987895559, 56.11566097255712, 287.0941337879401, 329.5205191324626, 314.5314543106873, 292.44037231740475, 58.966873756375136, 172.84215547565873, 86.35534373119056, 155.86531323445166, 546.5950528918602, 595.9671026810166, 173.16683982080215, 92.54221011079264, 8.74118977586512, 92.87781560400903, 273.3327752465407, 212.96749910607653, 571.5033402282564, 356.946691039685, 54.15558899426528, 30.838372953566537, 200.08197607288182, 208.52151888798159, 123.14982610651424, 12.098129024488365, 470.83867285282264, 703.8926358532213, 716.0939629323668, 154.1504836257647, 77.09182780781582, 242.7884976022058, 171.52202583992255, 375.82773272794424, 256.6133514466706, 103.56229438588328]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.885036702580248, "mean_inference_ms": 7.102741164317236, "mean_action_processing_ms": 2.4257604821932204, "mean_env_wait_ms": 17.342407031147513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015004158020019531, "StateBufferConnector_ms": 0.007058501243591309, "ViewRequirementAgentConnector_ms": 0.19806504249572754}, "num_episodes": 8, "episode_return_max": 842.5037768006654, "episode_return_min": -22.278035798277493, "episode_return_mean": 329.1553906164208, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1410816, "num_agent_steps_trained": 1410816, "num_env_steps_sampled": 352704, "num_env_steps_trained": 352704, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 147.84258942070383, "num_env_steps_trained_throughput_per_sec": 147.84258942070383, "timesteps_total": 352704, "num_env_steps_sampled_lifetime": 352704, "num_agent_steps_sampled_lifetime": 1410816, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1410816, "timers": {"training_iteration_time_ms": 26679.07, "restore_workers_time_ms": 0.023, "training_step_time_ms": 26678.531, "sample_time_ms": 2963.325, "learn_time_ms": 23692.92, "learn_throughput": 169.164, "synch_weights_time_ms": 18.507}, "counters": {"num_env_steps_sampled": 352704, "num_env_steps_trained": 352704, "num_agent_steps_sampled": 1410816, "num_agent_steps_trained": 1410816}, "done": false, "training_iteration": 88, "trial_id": "7f713_00000", "date": "2024-08-23_10-26-21", "timestamp": 1724388981, "time_this_iter_s": 27.146076917648315, "time_total_s": 2377.7181072235107, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1738bc940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2377.7181072235107, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 38.32105263157895, "ram_util_percent": 83.1157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 69.79418678435069, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.525014051810774, "policy_loss": -0.008990365109115682, "vf_loss": 4.532232656428423, "vf_explained_var": 0.6812420016874081, "kl": 0.008858743535413865, "entropy": 0.8266339811067732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 83633.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.717473188026872, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 4.3937917689167, "policy_loss": -0.012693490505110098, "vf_loss": 4.405687528186374, "vf_explained_var": 0.31178626686176925, "kl": 0.015954667220641143, "entropy": 0.452874926379118, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 83633.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 356712, "num_env_steps_trained": 356712, "num_agent_steps_sampled": 1426848, "num_agent_steps_trained": 1426848}, "env_runners": {"episode_reward_max": 842.5037768006654, "episode_reward_min": -22.278035798277493, "episode_reward_mean": 328.9712027347286, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -835.1703916179858, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 827.2545954110806}, "policy_reward_mean": {"prey_policy": -127.44929010887903, "predator_policy": 291.9348914762432}, "custom_metrics": {}, "hist_stats": {"episode_reward": [311.8345030790993, 269.15046502697817, 50.23351013759192, 35.66007139474958, 700.4175326510401, 471.26793750683714, 14.257715545079677, 773.5959388130409, 300.03066486226624, 385.10419877297943, 93.94632914113502, 291.8507395080482, 50.81687777753681, -22.278035798277493, 328.1538205422438, 344.4000000000009, 458.09288997108223, 66.44118215310073, 423.1223642443287, 517.282033963262, 86.49999999999936, 121.49999999999793, 33.87336555776562, 210.30243704995908, 127.49982833132489, 371.85218351075014, 238.48820855394655, 487.40000000000003, 346.3522873264919, 100.7102124969067, 338.89502689922426, 631.9229836258655, 60.30000000000059, 542.2889998171888, 403.00074200282677, 149.35861730912762, 59.2000000000006, 619.0713159436241, 254.16222265189364, 194.79545514448006, 569.5229490729437, 62.065032701169, 248.78029056945724, 449.5532959061112, 623.3660742168963, 359.82760225210114, 340.13928719548164, 354.33017095285135, 260.5811440677934, 365.2358043262199, 842.5037768006654, 186.3517857706521, 580.0154643086721, 427.5270667910678, 62.70000000000062, 432.5000000000026, 233.54294389121048, 752.2164754822106, 513.2366399252302, 340.4341847922202, 310.99122887695853, 365.3395351785799, 342.7824526158173, 708.2100905169827, 192.6936648277091, 95.98771322444011, 347.9181916437499, 724.8536817219274, 599.7381064055685, 50.711903428459564, 75.2, 255.057283638447, 399.000000000002, 436.4810136364009, 422.49741209927754, 595.542783017021, 400.8735425561629, 358.2000659002467, 280.3752792377946, 418.30000000000246, 518.5722633031044, 61.178659561700144, 381.3872472269089, 399.5480199304558, 668.1, 255.45695172515747, 91.31593444995036, 386.6333050404395, 214.29759665711512, 312.56759546780984, 472.87644609619576, 55.00000000000049, 670.1, 271.6143333241116, 422.13620243504624, 364.7000000000013, 78.8286372643206, 298.99999999999994, 91.92421368764181, 255.84430424089663], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-685.2301864445644, 229.65520684202477, -280.0761755175065, -428.4217830717408, -61.86544004076376, -496.77353574729, -815.1705537493575, -40.798699571449085, -555.5717072864103, 187.86882582557962, 387.6711561925985, -65.57646776656361, -439.35644997091686, -729.5945846656964, 359.12608609679467, -764.8281333425876, -234.47069610268792, -644.4797125629702, 114.60238242553064, -414.03897335339667, -466.3284851074173, -517.273350745164, -264.61484548728373, -244.2766335893375, -498.8341105173822, -561.853266363709, -291.2282458808655, -345.7960520880115, 119.26344814135479, -102.19859489475948, -28.512619519500944, 292.52925616992206, -53.94731639874897, -346.73543075033854, -413.60398161052666, -243.17708116292923, -402.5350750514709, 16.198125796241257, -61.6340711501479, -438.00075032108634, 1.1591576857462298, 39.3063536460678, -231.6755632397403, -146.27567304713918, -154.174292433639, -773.7003857065083, -115.52130237898695, -496.2152473291245, -339.0428580094365, -171.2490964796562, -491.08289632332185, 247.80063231154625, -332.554356383938, 33.92347492985262, -256.1007542986593, 310.1117624845863, 122.6433253579345, -758.4253764125466, -547.0675053546869, -162.77472355605784, 37.1278728471534, 31.815266627340065, 370.16558642765324, -152.1232678168268, -213.17015335762088, -14.271413101246548, 252.63133198204648, -55.33601549591168, 224.17087496183106, -272.02215931143746, -668.6138593537235, -129.21230940201437, -181.87017307819906, -163.99163428697793, -491.7831110827881, 325.2449039020971, -537.8951468650871, -205.4370404149704, -88.33236992676584, -244.45518717709967, -595.4331969436076, 165.99647047697005, -550.3930923493156, -22.81811775767808, -266.04421489175303, -555.1723448110321, -716.4022459927374, 65.67886322707866, 24.585456889817806, 351.97966100428346, -87.40725857653217, 219.4961625009664, -310.09310418744786, 203.84582348938005, 283.4277148928184, -191.2762089265836, -193.18079481661496, -532.5054705645999, -573.3455924180181, 213.3621831994854, 236.62868974092052, -835.1703916179858, 35.626176845502215, -138.53307140516628, 320.97746338578935, -485.8925997439694, 319.2510877161371, -251.28837502605882, -149.11228047713755, -11.249639146120984, -22.956019854011032, 398.2, -630.4303763664852, 159.2216595052189, -43.181349913665485, 290.0426843926191, 26.25228601561143, -92.88122360324996, 126.17010414055815, 9.600563221803132, -36.960327691803435, 100.18944393243322, -436.58664572706414, 227.9336327363271, -454.1368361009552, 7.339940037534234, 343.5404602045953, 247.23903167701005, -0.5285246554273613, -695.0916569035544, -331.2851159399556, -242.07537395086547, 312.34768621983494, -407.5237887181003, 366.87852804316185, 251.22201628417122, -158.6474728649444, 297.60794247001013, 3.522656675867729, -333.59599321253927, -29.098365682834554, 33.54022629609827, -797.9242291398702, 17.62115565884935, 12.552740121044463, 305.4843390274429, 178.2539536244069, -358.3875929084156, -214.0140102418448, 29.539595713030714, 263.0028524928904, 100.73090129209663, -11.22560824584869, 169.87849383636765, -727.2311517102074, -57.130937962430544, 69.39718094507072, -54.73095163887218, 377.05881022413485, -60.37781560401047, 45.93587368773361, -13.663884737250271, -563.8885430015563, -303.3828287046764, 264.4146104787877, 31.978674800287827, -196.7902798310463, 187.73480480063483, 181.8501738934856, 351.0018709755116, -315.08210160932606, -604.1922553715534, -653.6937267231076, -125.23478538507487, 289.30316252450194, -222.5501828940875, -37.77118897770393, -295.2809729330478, -43.496866439981034, -4.111183924762079, 0.31071725688823587, -280.6094985697084, -376.37699264481614, 4.47165510800151, 300.3837236257168, 231.16944779017177, -827.431164042529, -102.16949251783313, 388.23620243504377, -34.93995706934853, -96.31489162516624, 278.2010799513029, -53.28439234917475, -269.6888647792298, -18.184280750266055, 74.41084801612811, -89.25347698879969, 33.78273403719841, 177.83134094385608, -679.2265492962449], "policy_predator_policy_reward": [668.1618532768646, 99.24762940477211, 428.7349104457427, 548.9135131704841, 94.59895017835348, 514.273535747294, 815.1705537493575, 76.45877096619827, 543.2722917513984, 524.8481223604747, 92.0129681964195, 57.16028088437719, 452.91416551599684, 730.2945846656966, 644.3340022252008, 534.9639838336309, 587.236661087802, 591.7444124401238, 249.1871651569729, 435.35362454387274, 411.63438196295226, 665.9137830307643, 542.124798256536, 258.6174203281355, 495.3533169906607, 616.1509376679687, 473.53317789510385, 141.21308427549255, 152.01966406040546, 159.06930323524037, 63.01261951950142, 17.37074383007795, 374.64020636983037, 484.13543075033886, 53.29345320160963, 669.9287917249475, 367.19830599332676, 442.26100750623107, 218.3253006596603, 798.5915547748388, 35.54084231425401, 10.493646353932485, 252.37556323973914, 247.07567304713777, 188.0476579914027, 773.7003857065083, 333.65382486839815, 488.3851618896756, 254.41289156028625, 383.3788912601354, 581.9935542173288, 33.14089330519756, 289.5001901444602, 247.61889986357627, 158.99722253634832, 274.3917692777246, 224.39408934012647, 757.7402490409775, 569.0949370814368, 241.45750432621523, 28.66715405207034, 241.28473337265987, 329.4448364566239, 84.43582855841518, 238.37015335761944, 49.371413101247015, 0.0, 344.9936833310542, 76.08071006645783, 374.7713162859759, 600.8608369120592, 346.323949152804, 206.67017307819765, 198.39163428697674, 515.0532913317405, 270.5562317925736, 520.0600456606435, 477.4343642713107, 260.56982832860876, 267.01318391973797, 364.290645657986, 634.669029881594, 277.5295409102661, 357.7467018978951, 465.1767673691646, 604.8200829030752, 694.1074397300775, 406.16923894168985, 212.47352713846078, 34.327429184334186, 109.79335208844145, 117.94534623922215, 328.393104187452, 117.99346370610039, 74.91249829906583, 187.26616668754806, 439.2906398307161, 546.9767696182942, 171.38103740021603, 553.8381761445372, 807.6338323512093, 633.411646326519, 155.91079586654385, 133.34788446377453, 468.093923624066, 276.8366770427856, 137.72051657463555, 221.84383752635438, 176.312280477136, 46.7496391461214, 57.25601985401151, 0.0, 31.57529559618894, 673.1763651562883, 234.30073700208993, 271.05440400116777, 281.59028253262386, 298.27529498024, 158.47512309475465, 46.18839433510336, 120.93218345552731, 126.82992918080106, 100.00719471853068, 473.9853534507871, 350.68750571812325, 438.89184296111785, 92.45676238769532, 24.97383624768189, 200.12652527965977, 688.1873211070321, 390.06403141949147, 279.28417169576926, 15.464489422246553, 427.6298047197685, 30.853329324537555, 75.8998080700567, 303.41383379015855, 157.36380301034455, 27.689246752591593, 353.09599321254234, 64.898365682835, 5.859773703901936, 827.2545954110806, 208.105761708387, 24.84725987895559, 56.11566097255712, 287.0941337879401, 329.5205191324626, 314.5314543106873, 292.44037231740475, 58.966873756375136, 172.84215547565873, 86.35534373119056, 155.86531323445166, 546.5950528918602, 595.9671026810166, 173.16683982080215, 92.54221011079264, 8.74118977586512, 92.87781560400903, 273.3327752465407, 212.96749910607653, 571.5033402282564, 356.946691039685, 54.15558899426528, 30.838372953566537, 200.08197607288182, 208.52151888798159, 123.14982610651424, 12.098129024488365, 470.83867285282264, 703.8926358532213, 716.0939629323668, 154.1504836257647, 77.09182780781582, 242.7884976022058, 171.52202583992255, 375.82773272794424, 256.6133514466706, 103.56229438588328, 377.98788432568324, 375.18734308332796, 394.2769926448202, 32.62834489199869, 47.516276374283336, 91.0305522098281, 703.5118524784984, 497.7031374059754, 0.0, 68.8399570693487, 130.51489162516458, 52.29892004869715, 319.0246642139009, 82.77723017882715, 54.58428075026657, 188.1891519838718, 28.192472333287512, 119.20248430595515, 74.58361184667046, 682.6559007466159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.864092207346692, "mean_inference_ms": 7.06580323257024, "mean_action_processing_ms": 2.4182447222565604, "mean_env_wait_ms": 17.35586987684797, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018845438957214355, "StateBufferConnector_ms": 0.010382771492004395, "ViewRequirementAgentConnector_ms": 0.21495163440704346}, "num_episodes": 10, "episode_return_max": 842.5037768006654, "episode_return_min": -22.278035798277493, "episode_return_mean": 328.9712027347286, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1426848, "num_agent_steps_trained": 1426848, "num_env_steps_sampled": 356712, "num_env_steps_trained": 356712, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 139.74621547848923, "num_env_steps_trained_throughput_per_sec": 139.74621547848923, "timesteps_total": 356712, "num_env_steps_sampled_lifetime": 356712, "num_agent_steps_sampled_lifetime": 1426848, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1426848, "timers": {"training_iteration_time_ms": 26863.449, "restore_workers_time_ms": 0.024, "training_step_time_ms": 26862.908, "sample_time_ms": 3033.283, "learn_time_ms": 23806.602, "learn_throughput": 168.357, "synch_weights_time_ms": 18.801}, "counters": {"num_env_steps_sampled": 356712, "num_env_steps_trained": 356712, "num_agent_steps_sampled": 1426848, "num_agent_steps_trained": 1426848}, "done": false, "training_iteration": 89, "trial_id": "7f713_00000", "date": "2024-08-23_10-26-49", "timestamp": 1724389009, "time_this_iter_s": 28.74208402633667, "time_total_s": 2406.4601912498474, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17386baf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2406.4601912498474, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 44.08048780487805, "ram_util_percent": 82.71219512195121}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.67703838827749, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 4.720070317434886, "policy_loss": -0.00909361091390666, "vf_loss": 4.728023572195144, "vf_explained_var": 0.6287246974687728, "kl": 0.005701759130516577, "entropy": 0.8025885813450687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 84578.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.442430153094904, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 4.594671260742914, "policy_loss": -0.013351527915493875, "vf_loss": 4.607347932442155, "vf_explained_var": 0.4135061059048567, "kl": 0.01349727810069761, "entropy": 0.4297447113763718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 84578.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 360720, "num_env_steps_trained": 360720, "num_agent_steps_sampled": 1442880, "num_agent_steps_trained": 1442880}, "env_runners": {"episode_reward_max": 842.5037768006654, "episode_reward_min": -22.278035798277493, "episode_reward_mean": 334.36569407901806, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -835.1703916179858, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 827.2545954110806}, "policy_reward_mean": {"prey_policy": -101.34592352257239, "predator_policy": 268.52877056208126}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.81687777753681, -22.278035798277493, 328.1538205422438, 344.4000000000009, 458.09288997108223, 66.44118215310073, 423.1223642443287, 517.282033963262, 86.49999999999936, 121.49999999999793, 33.87336555776562, 210.30243704995908, 127.49982833132489, 371.85218351075014, 238.48820855394655, 487.40000000000003, 346.3522873264919, 100.7102124969067, 338.89502689922426, 631.9229836258655, 60.30000000000059, 542.2889998171888, 403.00074200282677, 149.35861730912762, 59.2000000000006, 619.0713159436241, 254.16222265189364, 194.79545514448006, 569.5229490729437, 62.065032701169, 248.78029056945724, 449.5532959061112, 623.3660742168963, 359.82760225210114, 340.13928719548164, 354.33017095285135, 260.5811440677934, 365.2358043262199, 842.5037768006654, 186.3517857706521, 580.0154643086721, 427.5270667910678, 62.70000000000062, 432.5000000000026, 233.54294389121048, 752.2164754822106, 513.2366399252302, 340.4341847922202, 310.99122887695853, 365.3395351785799, 342.7824526158173, 708.2100905169827, 192.6936648277091, 95.98771322444011, 347.9181916437499, 724.8536817219274, 599.7381064055685, 50.711903428459564, 75.2, 255.057283638447, 399.000000000002, 436.4810136364009, 422.49741209927754, 595.542783017021, 400.8735425561629, 358.2000659002467, 280.3752792377946, 418.30000000000246, 518.5722633031044, 61.178659561700144, 381.3872472269089, 399.5480199304558, 668.1, 255.45695172515747, 91.31593444995036, 386.6333050404395, 214.29759665711512, 312.56759546780984, 472.87644609619576, 55.00000000000049, 670.1, 271.6143333241116, 422.13620243504624, 364.7000000000013, 78.8286372643206, 298.99999999999994, 91.92421368764181, 255.84430424089663, 358.6000000000013, 360.0392165750034, 748.7692516311904, 210.20123920301356, 305.04751084793907, 264.84191598411326, 420.4000000000025, 79.50000000000017, 379.3989157753646, 411.5000000000023, 394.04233460173765, 304.4583562494206], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-498.8341105173822, -561.853266363709, -291.2282458808655, -345.7960520880115, 119.26344814135479, -102.19859489475948, -28.512619519500944, 292.52925616992206, -53.94731639874897, -346.73543075033854, -413.60398161052666, -243.17708116292923, -402.5350750514709, 16.198125796241257, -61.6340711501479, -438.00075032108634, 1.1591576857462298, 39.3063536460678, -231.6755632397403, -146.27567304713918, -154.174292433639, -773.7003857065083, -115.52130237898695, -496.2152473291245, -339.0428580094365, -171.2490964796562, -491.08289632332185, 247.80063231154625, -332.554356383938, 33.92347492985262, -256.1007542986593, 310.1117624845863, 122.6433253579345, -758.4253764125466, -547.0675053546869, -162.77472355605784, 37.1278728471534, 31.815266627340065, 370.16558642765324, -152.1232678168268, -213.17015335762088, -14.271413101246548, 252.63133198204648, -55.33601549591168, 224.17087496183106, -272.02215931143746, -668.6138593537235, -129.21230940201437, -181.87017307819906, -163.99163428697793, -491.7831110827881, 325.2449039020971, -537.8951468650871, -205.4370404149704, -88.33236992676584, -244.45518717709967, -595.4331969436076, 165.99647047697005, -550.3930923493156, -22.81811775767808, -266.04421489175303, -555.1723448110321, -716.4022459927374, 65.67886322707866, 24.585456889817806, 351.97966100428346, -87.40725857653217, 219.4961625009664, -310.09310418744786, 203.84582348938005, 283.4277148928184, -191.2762089265836, -193.18079481661496, -532.5054705645999, -573.3455924180181, 213.3621831994854, 236.62868974092052, -835.1703916179858, 35.626176845502215, -138.53307140516628, 320.97746338578935, -485.8925997439694, 319.2510877161371, -251.28837502605882, -149.11228047713755, -11.249639146120984, -22.956019854011032, 398.2, -630.4303763664852, 159.2216595052189, -43.181349913665485, 290.0426843926191, 26.25228601561143, -92.88122360324996, 126.17010414055815, 9.600563221803132, -36.960327691803435, 100.18944393243322, -436.58664572706414, 227.9336327363271, -454.1368361009552, 7.339940037534234, 343.5404602045953, 247.23903167701005, -0.5285246554273613, -695.0916569035544, -331.2851159399556, -242.07537395086547, 312.34768621983494, -407.5237887181003, 366.87852804316185, 251.22201628417122, -158.6474728649444, 297.60794247001013, 3.522656675867729, -333.59599321253927, -29.098365682834554, 33.54022629609827, -797.9242291398702, 17.62115565884935, 12.552740121044463, 305.4843390274429, 178.2539536244069, -358.3875929084156, -214.0140102418448, 29.539595713030714, 263.0028524928904, 100.73090129209663, -11.22560824584869, 169.87849383636765, -727.2311517102074, -57.130937962430544, 69.39718094507072, -54.73095163887218, 377.05881022413485, -60.37781560401047, 45.93587368773361, -13.663884737250271, -563.8885430015563, -303.3828287046764, 264.4146104787877, 31.978674800287827, -196.7902798310463, 187.73480480063483, 181.8501738934856, 351.0018709755116, -315.08210160932606, -604.1922553715534, -653.6937267231076, -125.23478538507487, 289.30316252450194, -222.5501828940875, -37.77118897770393, -295.2809729330478, -43.496866439981034, -4.111183924762079, 0.31071725688823587, -280.6094985697084, -376.37699264481614, 4.47165510800151, 300.3837236257168, 231.16944779017177, -827.431164042529, -102.16949251783313, 388.23620243504377, -34.93995706934853, -96.31489162516624, 278.2010799513029, -53.28439234917475, -269.6888647792298, -18.184280750266055, 74.41084801612811, -89.25347698879969, 33.78273403719841, 177.83134094385608, -679.2265492962449, 285.3839867070403, -172.36796557114948, 43.44683060942923, -89.43775750040572, -259.31716269172506, 376.0579520302023, -49.525420963023045, -762.3946521349659, 160.58257307577492, -367.7459037565374, 140.5955878765444, -454.89400277712116, 381.1, 32.438686600489476, -33.20054851856679, -467.09270456081777, -571.2819963023204, 265.2343014714023, 32.54637045806415, 356.42207534918793, 256.3285386017303, 33.33031218006205, -472.1554862609876, -313.2030534015554], "policy_predator_policy_reward": [495.3533169906607, 616.1509376679687, 473.53317789510385, 141.21308427549255, 152.01966406040546, 159.06930323524037, 63.01261951950142, 17.37074383007795, 374.64020636983037, 484.13543075033886, 53.29345320160963, 669.9287917249475, 367.19830599332676, 442.26100750623107, 218.3253006596603, 798.5915547748388, 35.54084231425401, 10.493646353932485, 252.37556323973914, 247.07567304713777, 188.0476579914027, 773.7003857065083, 333.65382486839815, 488.3851618896756, 254.41289156028625, 383.3788912601354, 581.9935542173288, 33.14089330519756, 289.5001901444602, 247.61889986357627, 158.99722253634832, 274.3917692777246, 224.39408934012647, 757.7402490409775, 569.0949370814368, 241.45750432621523, 28.66715405207034, 241.28473337265987, 329.4448364566239, 84.43582855841518, 238.37015335761944, 49.371413101247015, 0.0, 344.9936833310542, 76.08071006645783, 374.7713162859759, 600.8608369120592, 346.323949152804, 206.67017307819765, 198.39163428697674, 515.0532913317405, 270.5562317925736, 520.0600456606435, 477.4343642713107, 260.56982832860876, 267.01318391973797, 364.290645657986, 634.669029881594, 277.5295409102661, 357.7467018978951, 465.1767673691646, 604.8200829030752, 694.1074397300775, 406.16923894168985, 212.47352713846078, 34.327429184334186, 109.79335208844145, 117.94534623922215, 328.393104187452, 117.99346370610039, 74.91249829906583, 187.26616668754806, 439.2906398307161, 546.9767696182942, 171.38103740021603, 553.8381761445372, 807.6338323512093, 633.411646326519, 155.91079586654385, 133.34788446377453, 468.093923624066, 276.8366770427856, 137.72051657463555, 221.84383752635438, 176.312280477136, 46.7496391461214, 57.25601985401151, 0.0, 31.57529559618894, 673.1763651562883, 234.30073700208993, 271.05440400116777, 281.59028253262386, 298.27529498024, 158.47512309475465, 46.18839433510336, 120.93218345552731, 126.82992918080106, 100.00719471853068, 473.9853534507871, 350.68750571812325, 438.89184296111785, 92.45676238769532, 24.97383624768189, 200.12652527965977, 688.1873211070321, 390.06403141949147, 279.28417169576926, 15.464489422246553, 427.6298047197685, 30.853329324537555, 75.8998080700567, 303.41383379015855, 157.36380301034455, 27.689246752591593, 353.09599321254234, 64.898365682835, 5.859773703901936, 827.2545954110806, 208.105761708387, 24.84725987895559, 56.11566097255712, 287.0941337879401, 329.5205191324626, 314.5314543106873, 292.44037231740475, 58.966873756375136, 172.84215547565873, 86.35534373119056, 155.86531323445166, 546.5950528918602, 595.9671026810166, 173.16683982080215, 92.54221011079264, 8.74118977586512, 92.87781560400903, 273.3327752465407, 212.96749910607653, 571.5033402282564, 356.946691039685, 54.15558899426528, 30.838372953566537, 200.08197607288182, 208.52151888798159, 123.14982610651424, 12.098129024488365, 470.83867285282264, 703.8926358532213, 716.0939629323668, 154.1504836257647, 77.09182780781582, 242.7884976022058, 171.52202583992255, 375.82773272794424, 256.6133514466706, 103.56229438588328, 377.98788432568324, 375.18734308332796, 394.2769926448202, 32.62834489199869, 47.516276374283336, 91.0305522098281, 703.5118524784984, 497.7031374059754, 0.0, 68.8399570693487, 130.51489162516458, 52.29892004869715, 319.0246642139009, 82.77723017882715, 54.58428075026657, 188.1891519838718, 28.192472333287512, 119.20248430595515, 74.58361184667046, 682.6559007466159, 48.41601329295974, 197.16796557114807, 8.078552763778719, 397.9515907022005, 350.98253097784476, 281.0459313148687, 400.36423441571293, 621.7570778852886, 127.52561148621635, 384.6852300424883, 83.39953616229585, 495.7407947223955, 0.0, 6.861313399510711, 67.40054851856705, 512.3927045608178, 139.7206991094585, 545.7259114968231, 6.853629541936035, 15.677924650812063, 52.77957031038073, 51.603913509562744, 283.5549916315797, 806.261904280386]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.854781137509287, "mean_inference_ms": 7.090419055509296, "mean_action_processing_ms": 2.4122769203681353, "mean_env_wait_ms": 17.343850619083256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0189054012298584, "StateBufferConnector_ms": 0.011499285697937012, "ViewRequirementAgentConnector_ms": 0.2234511375427246}, "num_episodes": 12, "episode_return_max": 842.5037768006654, "episode_return_min": -22.278035798277493, "episode_return_mean": 334.36569407901806, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1442880, "num_agent_steps_trained": 1442880, "num_env_steps_sampled": 360720, "num_env_steps_trained": 360720, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 139.1330331243272, "num_env_steps_trained_throughput_per_sec": 139.1330331243272, "timesteps_total": 360720, "num_env_steps_sampled_lifetime": 360720, "num_agent_steps_sampled_lifetime": 1442880, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1442880, "timers": {"training_iteration_time_ms": 27078.778, "restore_workers_time_ms": 0.023, "training_step_time_ms": 27078.109, "sample_time_ms": 3238.504, "learn_time_ms": 23815.891, "learn_throughput": 168.291, "synch_weights_time_ms": 18.997}, "counters": {"num_env_steps_sampled": 360720, "num_env_steps_trained": 360720, "num_agent_steps_sampled": 1442880, "num_agent_steps_trained": 1442880}, "done": false, "training_iteration": 90, "trial_id": "7f713_00000", "date": "2024-08-23_10-27-18", "timestamp": 1724389038, "time_this_iter_s": 28.847414016723633, "time_total_s": 2435.307605266571, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737dbb80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2435.307605266571, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 47.487804878048784, "ram_util_percent": 81.07317073170732}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 67.21791347977977, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.0546086644369455, "policy_loss": -0.006175853072717372, "vf_loss": 5.059552649089269, "vf_explained_var": 0.5890824483815955, "kl": 0.006159422182719465, "entropy": 0.779818043191597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 85523.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.77227137807816, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 4.8674772991705195, "policy_loss": -0.010867085739250772, "vf_loss": 4.877850547669426, "vf_explained_var": 0.3084921203593098, "kl": 0.009876534212183543, "entropy": 0.413265801989843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 85523.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 364728, "num_env_steps_trained": 364728, "num_agent_steps_sampled": 1458912, "num_agent_steps_trained": 1458912}, "env_runners": {"episode_reward_max": 842.5037768006654, "episode_reward_min": 23.700000000000063, "episode_reward_mean": 336.1083406476033, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -835.1703916179858, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 827.2545954110806}, "policy_reward_mean": {"prey_policy": -93.72345933086063, "predator_policy": 261.77762965466223}, "custom_metrics": {}, "hist_stats": {"episode_reward": [86.49999999999936, 121.49999999999793, 33.87336555776562, 210.30243704995908, 127.49982833132489, 371.85218351075014, 238.48820855394655, 487.40000000000003, 346.3522873264919, 100.7102124969067, 338.89502689922426, 631.9229836258655, 60.30000000000059, 542.2889998171888, 403.00074200282677, 149.35861730912762, 59.2000000000006, 619.0713159436241, 254.16222265189364, 194.79545514448006, 569.5229490729437, 62.065032701169, 248.78029056945724, 449.5532959061112, 623.3660742168963, 359.82760225210114, 340.13928719548164, 354.33017095285135, 260.5811440677934, 365.2358043262199, 842.5037768006654, 186.3517857706521, 580.0154643086721, 427.5270667910678, 62.70000000000062, 432.5000000000026, 233.54294389121048, 752.2164754822106, 513.2366399252302, 340.4341847922202, 310.99122887695853, 365.3395351785799, 342.7824526158173, 708.2100905169827, 192.6936648277091, 95.98771322444011, 347.9181916437499, 724.8536817219274, 599.7381064055685, 50.711903428459564, 75.2, 255.057283638447, 399.000000000002, 436.4810136364009, 422.49741209927754, 595.542783017021, 400.8735425561629, 358.2000659002467, 280.3752792377946, 418.30000000000246, 518.5722633031044, 61.178659561700144, 381.3872472269089, 399.5480199304558, 668.1, 255.45695172515747, 91.31593444995036, 386.6333050404395, 214.29759665711512, 312.56759546780984, 472.87644609619576, 55.00000000000049, 670.1, 271.6143333241116, 422.13620243504624, 364.7000000000013, 78.8286372643206, 298.99999999999994, 91.92421368764181, 255.84430424089663, 358.6000000000013, 360.0392165750034, 748.7692516311904, 210.20123920301356, 305.04751084793907, 264.84191598411326, 420.4000000000025, 79.50000000000017, 379.3989157753646, 411.5000000000023, 394.04233460173765, 304.4583562494206, 729.5246313685401, 443.9616238527655, 538.8874242576004, 47.70000000000041, 335.2837383409214, 23.700000000000063, 166.1813719633956, 55.056999928592866], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [1.1591576857462298, 39.3063536460678, -231.6755632397403, -146.27567304713918, -154.174292433639, -773.7003857065083, -115.52130237898695, -496.2152473291245, -339.0428580094365, -171.2490964796562, -491.08289632332185, 247.80063231154625, -332.554356383938, 33.92347492985262, -256.1007542986593, 310.1117624845863, 122.6433253579345, -758.4253764125466, -547.0675053546869, -162.77472355605784, 37.1278728471534, 31.815266627340065, 370.16558642765324, -152.1232678168268, -213.17015335762088, -14.271413101246548, 252.63133198204648, -55.33601549591168, 224.17087496183106, -272.02215931143746, -668.6138593537235, -129.21230940201437, -181.87017307819906, -163.99163428697793, -491.7831110827881, 325.2449039020971, -537.8951468650871, -205.4370404149704, -88.33236992676584, -244.45518717709967, -595.4331969436076, 165.99647047697005, -550.3930923493156, -22.81811775767808, -266.04421489175303, -555.1723448110321, -716.4022459927374, 65.67886322707866, 24.585456889817806, 351.97966100428346, -87.40725857653217, 219.4961625009664, -310.09310418744786, 203.84582348938005, 283.4277148928184, -191.2762089265836, -193.18079481661496, -532.5054705645999, -573.3455924180181, 213.3621831994854, 236.62868974092052, -835.1703916179858, 35.626176845502215, -138.53307140516628, 320.97746338578935, -485.8925997439694, 319.2510877161371, -251.28837502605882, -149.11228047713755, -11.249639146120984, -22.956019854011032, 398.2, -630.4303763664852, 159.2216595052189, -43.181349913665485, 290.0426843926191, 26.25228601561143, -92.88122360324996, 126.17010414055815, 9.600563221803132, -36.960327691803435, 100.18944393243322, -436.58664572706414, 227.9336327363271, -454.1368361009552, 7.339940037534234, 343.5404602045953, 247.23903167701005, -0.5285246554273613, -695.0916569035544, -331.2851159399556, -242.07537395086547, 312.34768621983494, -407.5237887181003, 366.87852804316185, 251.22201628417122, -158.6474728649444, 297.60794247001013, 3.522656675867729, -333.59599321253927, -29.098365682834554, 33.54022629609827, -797.9242291398702, 17.62115565884935, 12.552740121044463, 305.4843390274429, 178.2539536244069, -358.3875929084156, -214.0140102418448, 29.539595713030714, 263.0028524928904, 100.73090129209663, -11.22560824584869, 169.87849383636765, -727.2311517102074, -57.130937962430544, 69.39718094507072, -54.73095163887218, 377.05881022413485, -60.37781560401047, 45.93587368773361, -13.663884737250271, -563.8885430015563, -303.3828287046764, 264.4146104787877, 31.978674800287827, -196.7902798310463, 187.73480480063483, 181.8501738934856, 351.0018709755116, -315.08210160932606, -604.1922553715534, -653.6937267231076, -125.23478538507487, 289.30316252450194, -222.5501828940875, -37.77118897770393, -295.2809729330478, -43.496866439981034, -4.111183924762079, 0.31071725688823587, -280.6094985697084, -376.37699264481614, 4.47165510800151, 300.3837236257168, 231.16944779017177, -827.431164042529, -102.16949251783313, 388.23620243504377, -34.93995706934853, -96.31489162516624, 278.2010799513029, -53.28439234917475, -269.6888647792298, -18.184280750266055, 74.41084801612811, -89.25347698879969, 33.78273403719841, 177.83134094385608, -679.2265492962449, 285.3839867070403, -172.36796557114948, 43.44683060942923, -89.43775750040572, -259.31716269172506, 376.0579520302023, -49.525420963023045, -762.3946521349659, 160.58257307577492, -367.7459037565374, 140.5955878765444, -454.89400277712116, 381.1, 32.438686600489476, -33.20054851856679, -467.09270456081777, -571.2819963023204, 265.2343014714023, 32.54637045806415, 356.42207534918793, 256.3285386017303, 33.33031218006205, -472.1554862609876, -313.2030534015554, 325.5363126282745, 129.04057908753103, -451.281525057918, 227.1455440164121, 174.97499500636258, -551.08668903136, -254.4062939455331, -134.59559195784865, 197.23060652780345, 22.84281383458671, -364.2563414539481, -508.03790637949993, 22.42651534158678, -370.808020532488, -47.489686322290694, -252.80823902128083], "policy_predator_policy_reward": [35.54084231425401, 10.493646353932485, 252.37556323973914, 247.07567304713777, 188.0476579914027, 773.7003857065083, 333.65382486839815, 488.3851618896756, 254.41289156028625, 383.3788912601354, 581.9935542173288, 33.14089330519756, 289.5001901444602, 247.61889986357627, 158.99722253634832, 274.3917692777246, 224.39408934012647, 757.7402490409775, 569.0949370814368, 241.45750432621523, 28.66715405207034, 241.28473337265987, 329.4448364566239, 84.43582855841518, 238.37015335761944, 49.371413101247015, 0.0, 344.9936833310542, 76.08071006645783, 374.7713162859759, 600.8608369120592, 346.323949152804, 206.67017307819765, 198.39163428697674, 515.0532913317405, 270.5562317925736, 520.0600456606435, 477.4343642713107, 260.56982832860876, 267.01318391973797, 364.290645657986, 634.669029881594, 277.5295409102661, 357.7467018978951, 465.1767673691646, 604.8200829030752, 694.1074397300775, 406.16923894168985, 212.47352713846078, 34.327429184334186, 109.79335208844145, 117.94534623922215, 328.393104187452, 117.99346370610039, 74.91249829906583, 187.26616668754806, 439.2906398307161, 546.9767696182942, 171.38103740021603, 553.8381761445372, 807.6338323512093, 633.411646326519, 155.91079586654385, 133.34788446377453, 468.093923624066, 276.8366770427856, 137.72051657463555, 221.84383752635438, 176.312280477136, 46.7496391461214, 57.25601985401151, 0.0, 31.57529559618894, 673.1763651562883, 234.30073700208993, 271.05440400116777, 281.59028253262386, 298.27529498024, 158.47512309475465, 46.18839433510336, 120.93218345552731, 126.82992918080106, 100.00719471853068, 473.9853534507871, 350.68750571812325, 438.89184296111785, 92.45676238769532, 24.97383624768189, 200.12652527965977, 688.1873211070321, 390.06403141949147, 279.28417169576926, 15.464489422246553, 427.6298047197685, 30.853329324537555, 75.8998080700567, 303.41383379015855, 157.36380301034455, 27.689246752591593, 353.09599321254234, 64.898365682835, 5.859773703901936, 827.2545954110806, 208.105761708387, 24.84725987895559, 56.11566097255712, 287.0941337879401, 329.5205191324626, 314.5314543106873, 292.44037231740475, 58.966873756375136, 172.84215547565873, 86.35534373119056, 155.86531323445166, 546.5950528918602, 595.9671026810166, 173.16683982080215, 92.54221011079264, 8.74118977586512, 92.87781560400903, 273.3327752465407, 212.96749910607653, 571.5033402282564, 356.946691039685, 54.15558899426528, 30.838372953566537, 200.08197607288182, 208.52151888798159, 123.14982610651424, 12.098129024488365, 470.83867285282264, 703.8926358532213, 716.0939629323668, 154.1504836257647, 77.09182780781582, 242.7884976022058, 171.52202583992255, 375.82773272794424, 256.6133514466706, 103.56229438588328, 377.98788432568324, 375.18734308332796, 394.2769926448202, 32.62834489199869, 47.516276374283336, 91.0305522098281, 703.5118524784984, 497.7031374059754, 0.0, 68.8399570693487, 130.51489162516458, 52.29892004869715, 319.0246642139009, 82.77723017882715, 54.58428075026657, 188.1891519838718, 28.192472333287512, 119.20248430595515, 74.58361184667046, 682.6559007466159, 48.41601329295974, 197.16796557114807, 8.078552763778719, 397.9515907022005, 350.98253097784476, 281.0459313148687, 400.36423441571293, 621.7570778852886, 127.52561148621635, 384.6852300424883, 83.39953616229585, 495.7407947223955, 0.0, 6.861313399510711, 67.40054851856705, 512.3927045608178, 139.7206991094585, 545.7259114968231, 6.853629541936035, 15.677924650812063, 52.77957031038073, 51.603913509562744, 283.5549916315797, 806.261904280386, 151.25706865825734, 123.69067099447729, 525.8556481093624, 142.24195678490906, 449.4154493546013, 465.58366892799705, 276.1062939455375, 160.5955919578472, 103.06939347219642, 12.140924506333976, 375.85634145394994, 520.1379063795002, 176.5647743189375, 337.9981028353636, 347.0401963505564, 8.31472892160783]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.868689243363711, "mean_inference_ms": 7.0830071709097595, "mean_action_processing_ms": 2.4180355012349457, "mean_env_wait_ms": 17.37103108640445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.016529560089111328, "StateBufferConnector_ms": 0.011528968811035156, "ViewRequirementAgentConnector_ms": 0.2188807725906372}, "num_episodes": 8, "episode_return_max": 842.5037768006654, "episode_return_min": 23.700000000000063, "episode_return_mean": 336.1083406476033, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1458912, "num_agent_steps_trained": 1458912, "num_env_steps_sampled": 364728, "num_env_steps_trained": 364728, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 152.554156643905, "num_env_steps_trained_throughput_per_sec": 152.554156643905, "timesteps_total": 364728, "num_env_steps_sampled_lifetime": 364728, "num_agent_steps_sampled_lifetime": 1458912, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1458912, "timers": {"training_iteration_time_ms": 26987.7, "restore_workers_time_ms": 0.022, "training_step_time_ms": 26987.097, "sample_time_ms": 3085.478, "learn_time_ms": 23877.606, "learn_throughput": 167.856, "synch_weights_time_ms": 18.991}, "counters": {"num_env_steps_sampled": 364728, "num_env_steps_trained": 364728, "num_agent_steps_sampled": 1458912, "num_agent_steps_trained": 1458912}, "done": false, "training_iteration": 91, "trial_id": "7f713_00000", "date": "2024-08-23_10-27-45", "timestamp": 1724389065, "time_this_iter_s": 26.316650867462158, "time_total_s": 2461.624256134033, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ad96f3a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2461.624256134033, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 39.02432432432432, "ram_util_percent": 79.02432432432433}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 57.344595481478976, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.33490064459503, "policy_loss": -0.008438674799072995, "vf_loss": 5.341767021966359, "vf_explained_var": 0.6331964999910384, "kl": 0.007861620060380095, "entropy": 0.7942077964071244, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 86468.0, "diff_num_grad_updates_vs_sampler_policy": 498.17140718562587}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.663423700433558, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 4.852773913378438, "policy_loss": -0.009206693356477277, "vf_loss": 4.861492362350383, "vf_explained_var": 0.3508734621698894, "kl": 0.00976496233836447, "entropy": 0.41651854168170344, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 86468.0, "diff_num_grad_updates_vs_sampler_policy": 498.17140718562587}}, "num_env_steps_sampled": 368736, "num_env_steps_trained": 368736, "num_agent_steps_sampled": 1474944, "num_agent_steps_trained": 1474944}, "env_runners": {"episode_reward_max": 842.5037768006654, "episode_reward_min": 23.700000000000063, "episode_reward_mean": 333.43028311481146, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -835.1703916179858, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 827.2545954110806}, "policy_reward_mean": {"prey_policy": -97.7510773510993, "predator_policy": 264.4662189085049}, "custom_metrics": {}, "hist_stats": {"episode_reward": [403.00074200282677, 149.35861730912762, 59.2000000000006, 619.0713159436241, 254.16222265189364, 194.79545514448006, 569.5229490729437, 62.065032701169, 248.78029056945724, 449.5532959061112, 623.3660742168963, 359.82760225210114, 340.13928719548164, 354.33017095285135, 260.5811440677934, 365.2358043262199, 842.5037768006654, 186.3517857706521, 580.0154643086721, 427.5270667910678, 62.70000000000062, 432.5000000000026, 233.54294389121048, 752.2164754822106, 513.2366399252302, 340.4341847922202, 310.99122887695853, 365.3395351785799, 342.7824526158173, 708.2100905169827, 192.6936648277091, 95.98771322444011, 347.9181916437499, 724.8536817219274, 599.7381064055685, 50.711903428459564, 75.2, 255.057283638447, 399.000000000002, 436.4810136364009, 422.49741209927754, 595.542783017021, 400.8735425561629, 358.2000659002467, 280.3752792377946, 418.30000000000246, 518.5722633031044, 61.178659561700144, 381.3872472269089, 399.5480199304558, 668.1, 255.45695172515747, 91.31593444995036, 386.6333050404395, 214.29759665711512, 312.56759546780984, 472.87644609619576, 55.00000000000049, 670.1, 271.6143333241116, 422.13620243504624, 364.7000000000013, 78.8286372643206, 298.99999999999994, 91.92421368764181, 255.84430424089663, 358.6000000000013, 360.0392165750034, 748.7692516311904, 210.20123920301356, 305.04751084793907, 264.84191598411326, 420.4000000000025, 79.50000000000017, 379.3989157753646, 411.5000000000023, 394.04233460173765, 304.4583562494206, 729.5246313685401, 443.9616238527655, 538.8874242576004, 47.70000000000041, 335.2837383409214, 23.700000000000063, 166.1813719633956, 55.056999928592866, 369.04061251469915, 49.44874610268181, 151.2999999999999, 134.24488390889545, 78.79362394896532, 51.35036584999923, 596.4216757620896, 81.77611812479674, 214.99424019868346, 373.93783238730276, 415.94261418363686, 38.9000000000003, 640.5471292801486, 233.38193762832404], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [224.17087496183106, -272.02215931143746, -668.6138593537235, -129.21230940201437, -181.87017307819906, -163.99163428697793, -491.7831110827881, 325.2449039020971, -537.8951468650871, -205.4370404149704, -88.33236992676584, -244.45518717709967, -595.4331969436076, 165.99647047697005, -550.3930923493156, -22.81811775767808, -266.04421489175303, -555.1723448110321, -716.4022459927374, 65.67886322707866, 24.585456889817806, 351.97966100428346, -87.40725857653217, 219.4961625009664, -310.09310418744786, 203.84582348938005, 283.4277148928184, -191.2762089265836, -193.18079481661496, -532.5054705645999, -573.3455924180181, 213.3621831994854, 236.62868974092052, -835.1703916179858, 35.626176845502215, -138.53307140516628, 320.97746338578935, -485.8925997439694, 319.2510877161371, -251.28837502605882, -149.11228047713755, -11.249639146120984, -22.956019854011032, 398.2, -630.4303763664852, 159.2216595052189, -43.181349913665485, 290.0426843926191, 26.25228601561143, -92.88122360324996, 126.17010414055815, 9.600563221803132, -36.960327691803435, 100.18944393243322, -436.58664572706414, 227.9336327363271, -454.1368361009552, 7.339940037534234, 343.5404602045953, 247.23903167701005, -0.5285246554273613, -695.0916569035544, -331.2851159399556, -242.07537395086547, 312.34768621983494, -407.5237887181003, 366.87852804316185, 251.22201628417122, -158.6474728649444, 297.60794247001013, 3.522656675867729, -333.59599321253927, -29.098365682834554, 33.54022629609827, -797.9242291398702, 17.62115565884935, 12.552740121044463, 305.4843390274429, 178.2539536244069, -358.3875929084156, -214.0140102418448, 29.539595713030714, 263.0028524928904, 100.73090129209663, -11.22560824584869, 169.87849383636765, -727.2311517102074, -57.130937962430544, 69.39718094507072, -54.73095163887218, 377.05881022413485, -60.37781560401047, 45.93587368773361, -13.663884737250271, -563.8885430015563, -303.3828287046764, 264.4146104787877, 31.978674800287827, -196.7902798310463, 187.73480480063483, 181.8501738934856, 351.0018709755116, -315.08210160932606, -604.1922553715534, -653.6937267231076, -125.23478538507487, 289.30316252450194, -222.5501828940875, -37.77118897770393, -295.2809729330478, -43.496866439981034, -4.111183924762079, 0.31071725688823587, -280.6094985697084, -376.37699264481614, 4.47165510800151, 300.3837236257168, 231.16944779017177, -827.431164042529, -102.16949251783313, 388.23620243504377, -34.93995706934853, -96.31489162516624, 278.2010799513029, -53.28439234917475, -269.6888647792298, -18.184280750266055, 74.41084801612811, -89.25347698879969, 33.78273403719841, 177.83134094385608, -679.2265492962449, 285.3839867070403, -172.36796557114948, 43.44683060942923, -89.43775750040572, -259.31716269172506, 376.0579520302023, -49.525420963023045, -762.3946521349659, 160.58257307577492, -367.7459037565374, 140.5955878765444, -454.89400277712116, 381.1, 32.438686600489476, -33.20054851856679, -467.09270456081777, -571.2819963023204, 265.2343014714023, 32.54637045806415, 356.42207534918793, 256.3285386017303, 33.33031218006205, -472.1554862609876, -313.2030534015554, 325.5363126282745, 129.04057908753103, -451.281525057918, 227.1455440164121, 174.97499500636258, -551.08668903136, -254.4062939455331, -134.59559195784865, 197.23060652780345, 22.84281383458671, -364.2563414539481, -508.03790637949993, 22.42651534158678, -370.808020532488, -47.489686322290694, -252.80823902128083, 258.06846430031567, -147.53850961221278, -87.4095786830135, -711.831412027964, -463.40534500282797, -323.6488050300519, -23.0737936193256, -556.4610883458009, -28.78635646689878, -609.1968144654854, -619.9854578179386, -126.19503422900435, 370.72012351974195, -193.05406176005363, -28.536969550920496, -270.1917356068597, -307.68428907966637, 58.01898834282487, -396.4962730161112, -190.80807804531594, 26.264849382610198, 205.66183730490542, -15.45874599950781, -508.0674569173962, 241.06054130601444, 228.0586875601521, -175.7291079865533, -373.8942989265103], "policy_predator_policy_reward": [76.08071006645783, 374.7713162859759, 600.8608369120592, 346.323949152804, 206.67017307819765, 198.39163428697674, 515.0532913317405, 270.5562317925736, 520.0600456606435, 477.4343642713107, 260.56982832860876, 267.01318391973797, 364.290645657986, 634.669029881594, 277.5295409102661, 357.7467018978951, 465.1767673691646, 604.8200829030752, 694.1074397300775, 406.16923894168985, 212.47352713846078, 34.327429184334186, 109.79335208844145, 117.94534623922215, 328.393104187452, 117.99346370610039, 74.91249829906583, 187.26616668754806, 439.2906398307161, 546.9767696182942, 171.38103740021603, 553.8381761445372, 807.6338323512093, 633.411646326519, 155.91079586654385, 133.34788446377453, 468.093923624066, 276.8366770427856, 137.72051657463555, 221.84383752635438, 176.312280477136, 46.7496391461214, 57.25601985401151, 0.0, 31.57529559618894, 673.1763651562883, 234.30073700208993, 271.05440400116777, 281.59028253262386, 298.27529498024, 158.47512309475465, 46.18839433510336, 120.93218345552731, 126.82992918080106, 100.00719471853068, 473.9853534507871, 350.68750571812325, 438.89184296111785, 92.45676238769532, 24.97383624768189, 200.12652527965977, 688.1873211070321, 390.06403141949147, 279.28417169576926, 15.464489422246553, 427.6298047197685, 30.853329324537555, 75.8998080700567, 303.41383379015855, 157.36380301034455, 27.689246752591593, 353.09599321254234, 64.898365682835, 5.859773703901936, 827.2545954110806, 208.105761708387, 24.84725987895559, 56.11566097255712, 287.0941337879401, 329.5205191324626, 314.5314543106873, 292.44037231740475, 58.966873756375136, 172.84215547565873, 86.35534373119056, 155.86531323445166, 546.5950528918602, 595.9671026810166, 173.16683982080215, 92.54221011079264, 8.74118977586512, 92.87781560400903, 273.3327752465407, 212.96749910607653, 571.5033402282564, 356.946691039685, 54.15558899426528, 30.838372953566537, 200.08197607288182, 208.52151888798159, 123.14982610651424, 12.098129024488365, 470.83867285282264, 703.8926358532213, 716.0939629323668, 154.1504836257647, 77.09182780781582, 242.7884976022058, 171.52202583992255, 375.82773272794424, 256.6133514466706, 103.56229438588328, 377.98788432568324, 375.18734308332796, 394.2769926448202, 32.62834489199869, 47.516276374283336, 91.0305522098281, 703.5118524784984, 497.7031374059754, 0.0, 68.8399570693487, 130.51489162516458, 52.29892004869715, 319.0246642139009, 82.77723017882715, 54.58428075026657, 188.1891519838718, 28.192472333287512, 119.20248430595515, 74.58361184667046, 682.6559007466159, 48.41601329295974, 197.16796557114807, 8.078552763778719, 397.9515907022005, 350.98253097784476, 281.0459313148687, 400.36423441571293, 621.7570778852886, 127.52561148621635, 384.6852300424883, 83.39953616229585, 495.7407947223955, 0.0, 6.861313399510711, 67.40054851856705, 512.3927045608178, 139.7206991094585, 545.7259114968231, 6.853629541936035, 15.677924650812063, 52.77957031038073, 51.603913509562744, 283.5549916315797, 806.261904280386, 151.25706865825734, 123.69067099447729, 525.8556481093624, 142.24195678490906, 449.4154493546013, 465.58366892799705, 276.1062939455375, 160.5955919578472, 103.06939347219642, 12.140924506333976, 375.85634145394994, 520.1379063795002, 176.5647743189375, 337.9981028353636, 347.0401963505564, 8.31472892160783, 78.47214821438209, 180.03850961221093, 124.85832478569324, 723.8314120279637, 479.4053450028284, 458.94880503005214, 146.99791560717128, 566.7818502668515, 90.68556069882546, 626.0912341825234, 592.5298149746075, 205.0010429223323, 117.84143504852044, 300.9141789538806, 98.16567709003206, 282.33914619255137, 328.2462109607746, 136.41332997475766, 804.3415033499832, 156.90068009874526, 92.28350702531189, 91.73242047080718, 50.07486252302509, 512.3513403938802, 84.81013151895351, 86.61776889502839, 337.5528640819294, 445.4524804594584]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.83749104969435, "mean_inference_ms": 7.074859733981948, "mean_action_processing_ms": 2.404639702577936, "mean_env_wait_ms": 17.350611821841348, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025734305381774902, "StateBufferConnector_ms": 0.009319186210632324, "ViewRequirementAgentConnector_ms": 0.24377131462097168}, "num_episodes": 14, "episode_return_max": 842.5037768006654, "episode_return_min": 23.700000000000063, "episode_return_mean": 333.43028311481146, "episodes_this_iter": 14}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1474944, "num_agent_steps_trained": 1474944, "num_env_steps_sampled": 368736, "num_env_steps_trained": 368736, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 151.3233550971233, "num_env_steps_trained_throughput_per_sec": 151.3233550971233, "timesteps_total": 368736, "num_env_steps_sampled_lifetime": 368736, "num_agent_steps_sampled_lifetime": 1474944, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1474944, "timers": {"training_iteration_time_ms": 26988.322, "restore_workers_time_ms": 0.022, "training_step_time_ms": 26987.692, "sample_time_ms": 3070.076, "learn_time_ms": 23893.236, "learn_throughput": 167.746, "synch_weights_time_ms": 19.259}, "counters": {"num_env_steps_sampled": 368736, "num_env_steps_trained": 368736, "num_agent_steps_sampled": 1474944, "num_agent_steps_trained": 1474944}, "done": false, "training_iteration": 92, "trial_id": "7f713_00000", "date": "2024-08-23_10-28-11", "timestamp": 1724389091, "time_this_iter_s": 26.501756191253662, "time_total_s": 2488.126012325287, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ad96fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2488.126012325287, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 38.14473684210525, "ram_util_percent": 80.1394736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 60.410189493875656, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.2990539336330675, "policy_loss": -0.009926883535824282, "vf_loss": 5.307189199659559, "vf_explained_var": 0.6070034605485422, "kl": 0.008958039584288757, "entropy": 0.7798199774096252, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 87413.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.589313687470856, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 4.767311498097011, "policy_loss": -0.014369972884191801, "vf_loss": 4.781112806633036, "vf_explained_var": 0.4362140761481391, "kl": 0.011373083420570881, "entropy": 0.43214845692039167, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 87413.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 372744, "num_env_steps_trained": 372744, "num_agent_steps_sampled": 1490976, "num_agent_steps_trained": 1490976}, "env_runners": {"episode_reward_max": 842.5037768006654, "episode_reward_min": 23.700000000000063, "episode_reward_mean": 343.97099772105054, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -835.1703916179858, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 827.2545954110806}, "policy_reward_mean": {"prey_policy": -82.60342682873885, "predator_policy": 254.588925689264}, "custom_metrics": {}, "hist_stats": {"episode_reward": [449.5532959061112, 623.3660742168963, 359.82760225210114, 340.13928719548164, 354.33017095285135, 260.5811440677934, 365.2358043262199, 842.5037768006654, 186.3517857706521, 580.0154643086721, 427.5270667910678, 62.70000000000062, 432.5000000000026, 233.54294389121048, 752.2164754822106, 513.2366399252302, 340.4341847922202, 310.99122887695853, 365.3395351785799, 342.7824526158173, 708.2100905169827, 192.6936648277091, 95.98771322444011, 347.9181916437499, 724.8536817219274, 599.7381064055685, 50.711903428459564, 75.2, 255.057283638447, 399.000000000002, 436.4810136364009, 422.49741209927754, 595.542783017021, 400.8735425561629, 358.2000659002467, 280.3752792377946, 418.30000000000246, 518.5722633031044, 61.178659561700144, 381.3872472269089, 399.5480199304558, 668.1, 255.45695172515747, 91.31593444995036, 386.6333050404395, 214.29759665711512, 312.56759546780984, 472.87644609619576, 55.00000000000049, 670.1, 271.6143333241116, 422.13620243504624, 364.7000000000013, 78.8286372643206, 298.99999999999994, 91.92421368764181, 255.84430424089663, 358.6000000000013, 360.0392165750034, 748.7692516311904, 210.20123920301356, 305.04751084793907, 264.84191598411326, 420.4000000000025, 79.50000000000017, 379.3989157753646, 411.5000000000023, 394.04233460173765, 304.4583562494206, 729.5246313685401, 443.9616238527655, 538.8874242576004, 47.70000000000041, 335.2837383409214, 23.700000000000063, 166.1813719633956, 55.056999928592866, 369.04061251469915, 49.44874610268181, 151.2999999999999, 134.24488390889545, 78.79362394896532, 51.35036584999923, 596.4216757620896, 81.77611812479674, 214.99424019868346, 373.93783238730276, 415.94261418363686, 38.9000000000003, 640.5471292801486, 233.38193762832404, 290.3163754129023, 623.3449723176748, 81.99657194883962, 388.52672525318656, 442.06666864384863, 511.2817510296461, 427.9195629808058, 265.5304580060335, 583.0450004264899], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-716.4022459927374, 65.67886322707866, 24.585456889817806, 351.97966100428346, -87.40725857653217, 219.4961625009664, -310.09310418744786, 203.84582348938005, 283.4277148928184, -191.2762089265836, -193.18079481661496, -532.5054705645999, -573.3455924180181, 213.3621831994854, 236.62868974092052, -835.1703916179858, 35.626176845502215, -138.53307140516628, 320.97746338578935, -485.8925997439694, 319.2510877161371, -251.28837502605882, -149.11228047713755, -11.249639146120984, -22.956019854011032, 398.2, -630.4303763664852, 159.2216595052189, -43.181349913665485, 290.0426843926191, 26.25228601561143, -92.88122360324996, 126.17010414055815, 9.600563221803132, -36.960327691803435, 100.18944393243322, -436.58664572706414, 227.9336327363271, -454.1368361009552, 7.339940037534234, 343.5404602045953, 247.23903167701005, -0.5285246554273613, -695.0916569035544, -331.2851159399556, -242.07537395086547, 312.34768621983494, -407.5237887181003, 366.87852804316185, 251.22201628417122, -158.6474728649444, 297.60794247001013, 3.522656675867729, -333.59599321253927, -29.098365682834554, 33.54022629609827, -797.9242291398702, 17.62115565884935, 12.552740121044463, 305.4843390274429, 178.2539536244069, -358.3875929084156, -214.0140102418448, 29.539595713030714, 263.0028524928904, 100.73090129209663, -11.22560824584869, 169.87849383636765, -727.2311517102074, -57.130937962430544, 69.39718094507072, -54.73095163887218, 377.05881022413485, -60.37781560401047, 45.93587368773361, -13.663884737250271, -563.8885430015563, -303.3828287046764, 264.4146104787877, 31.978674800287827, -196.7902798310463, 187.73480480063483, 181.8501738934856, 351.0018709755116, -315.08210160932606, -604.1922553715534, -653.6937267231076, -125.23478538507487, 289.30316252450194, -222.5501828940875, -37.77118897770393, -295.2809729330478, -43.496866439981034, -4.111183924762079, 0.31071725688823587, -280.6094985697084, -376.37699264481614, 4.47165510800151, 300.3837236257168, 231.16944779017177, -827.431164042529, -102.16949251783313, 388.23620243504377, -34.93995706934853, -96.31489162516624, 278.2010799513029, -53.28439234917475, -269.6888647792298, -18.184280750266055, 74.41084801612811, -89.25347698879969, 33.78273403719841, 177.83134094385608, -679.2265492962449, 285.3839867070403, -172.36796557114948, 43.44683060942923, -89.43775750040572, -259.31716269172506, 376.0579520302023, -49.525420963023045, -762.3946521349659, 160.58257307577492, -367.7459037565374, 140.5955878765444, -454.89400277712116, 381.1, 32.438686600489476, -33.20054851856679, -467.09270456081777, -571.2819963023204, 265.2343014714023, 32.54637045806415, 356.42207534918793, 256.3285386017303, 33.33031218006205, -472.1554862609876, -313.2030534015554, 325.5363126282745, 129.04057908753103, -451.281525057918, 227.1455440164121, 174.97499500636258, -551.08668903136, -254.4062939455331, -134.59559195784865, 197.23060652780345, 22.84281383458671, -364.2563414539481, -508.03790637949993, 22.42651534158678, -370.808020532488, -47.489686322290694, -252.80823902128083, 258.06846430031567, -147.53850961221278, -87.4095786830135, -711.831412027964, -463.40534500282797, -323.6488050300519, -23.0737936193256, -556.4610883458009, -28.78635646689878, -609.1968144654854, -619.9854578179386, -126.19503422900435, 370.72012351974195, -193.05406176005363, -28.536969550920496, -270.1917356068597, -307.68428907966637, 58.01898834282487, -396.4962730161112, -190.80807804531594, 26.264849382610198, 205.66183730490542, -15.45874599950781, -508.0674569173962, 241.06054130601444, 228.0586875601521, -175.7291079865533, -373.8942989265103, -111.82552512875074, 187.80706811829398, -15.70362769683473, 120.56286778206467, -408.22391024809644, -138.55820701757187, 37.86022985309584, 259.9860846640472, 395.5, -14.69597722895124, -582.4932679486889, 92.51042278226399, -307.2738271858617, 178.60045873983788, 52.92500237993298, -185.89157330355346, -69.33894768959806, -720.2788747110861], "policy_predator_policy_reward": [694.1074397300775, 406.16923894168985, 212.47352713846078, 34.327429184334186, 109.79335208844145, 117.94534623922215, 328.393104187452, 117.99346370610039, 74.91249829906583, 187.26616668754806, 439.2906398307161, 546.9767696182942, 171.38103740021603, 553.8381761445372, 807.6338323512093, 633.411646326519, 155.91079586654385, 133.34788446377453, 468.093923624066, 276.8366770427856, 137.72051657463555, 221.84383752635438, 176.312280477136, 46.7496391461214, 57.25601985401151, 0.0, 31.57529559618894, 673.1763651562883, 234.30073700208993, 271.05440400116777, 281.59028253262386, 298.27529498024, 158.47512309475465, 46.18839433510336, 120.93218345552731, 126.82992918080106, 100.00719471853068, 473.9853534507871, 350.68750571812325, 438.89184296111785, 92.45676238769532, 24.97383624768189, 200.12652527965977, 688.1873211070321, 390.06403141949147, 279.28417169576926, 15.464489422246553, 427.6298047197685, 30.853329324537555, 75.8998080700567, 303.41383379015855, 157.36380301034455, 27.689246752591593, 353.09599321254234, 64.898365682835, 5.859773703901936, 827.2545954110806, 208.105761708387, 24.84725987895559, 56.11566097255712, 287.0941337879401, 329.5205191324626, 314.5314543106873, 292.44037231740475, 58.966873756375136, 172.84215547565873, 86.35534373119056, 155.86531323445166, 546.5950528918602, 595.9671026810166, 173.16683982080215, 92.54221011079264, 8.74118977586512, 92.87781560400903, 273.3327752465407, 212.96749910607653, 571.5033402282564, 356.946691039685, 54.15558899426528, 30.838372953566537, 200.08197607288182, 208.52151888798159, 123.14982610651424, 12.098129024488365, 470.83867285282264, 703.8926358532213, 716.0939629323668, 154.1504836257647, 77.09182780781582, 242.7884976022058, 171.52202583992255, 375.82773272794424, 256.6133514466706, 103.56229438588328, 377.98788432568324, 375.18734308332796, 394.2769926448202, 32.62834489199869, 47.516276374283336, 91.0305522098281, 703.5118524784984, 497.7031374059754, 0.0, 68.8399570693487, 130.51489162516458, 52.29892004869715, 319.0246642139009, 82.77723017882715, 54.58428075026657, 188.1891519838718, 28.192472333287512, 119.20248430595515, 74.58361184667046, 682.6559007466159, 48.41601329295974, 197.16796557114807, 8.078552763778719, 397.9515907022005, 350.98253097784476, 281.0459313148687, 400.36423441571293, 621.7570778852886, 127.52561148621635, 384.6852300424883, 83.39953616229585, 495.7407947223955, 0.0, 6.861313399510711, 67.40054851856705, 512.3927045608178, 139.7206991094585, 545.7259114968231, 6.853629541936035, 15.677924650812063, 52.77957031038073, 51.603913509562744, 283.5549916315797, 806.261904280386, 151.25706865825734, 123.69067099447729, 525.8556481093624, 142.24195678490906, 449.4154493546013, 465.58366892799705, 276.1062939455375, 160.5955919578472, 103.06939347219642, 12.140924506333976, 375.85634145394994, 520.1379063795002, 176.5647743189375, 337.9981028353636, 347.0401963505564, 8.31472892160783, 78.47214821438209, 180.03850961221093, 124.85832478569324, 723.8314120279637, 479.4053450028284, 458.94880503005214, 146.99791560717128, 566.7818502668515, 90.68556069882546, 626.0912341825234, 592.5298149746075, 205.0010429223323, 117.84143504852044, 300.9141789538806, 98.16567709003206, 282.33914619255137, 328.2462109607746, 136.41332997475766, 804.3415033499832, 156.90068009874526, 92.28350702531189, 91.73242047080718, 50.07486252302509, 512.3513403938802, 84.81013151895351, 86.61776889502839, 337.5528640819294, 445.4524804594584, 190.13341693916948, 24.20141548418787, 286.89000434785027, 231.595727884595, 128.07646996211767, 500.7022192523909, 56.08379057927144, 34.5966201567703, 50.99597722895173, 10.266668643845719, 590.7863915729355, 410.4782046231365, 323.44091034754206, 233.1520210792896, 172.2262641440825, 226.2707647855706, 669.7695852871143, 702.8932375400628]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.826000485909953, "mean_inference_ms": 7.0851942926929645, "mean_action_processing_ms": 2.3909042238839113, "mean_env_wait_ms": 17.342367252444735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025437235832214355, "StateBufferConnector_ms": 0.00918567180633545, "ViewRequirementAgentConnector_ms": 0.24266588687896729}, "num_episodes": 9, "episode_return_max": 842.5037768006654, "episode_return_min": 23.700000000000063, "episode_return_mean": 343.97099772105054, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1490976, "num_agent_steps_trained": 1490976, "num_env_steps_sampled": 372744, "num_env_steps_trained": 372744, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 154.0729454945421, "num_env_steps_trained_throughput_per_sec": 154.0729454945421, "timesteps_total": 372744, "num_env_steps_sampled_lifetime": 372744, "num_agent_steps_sampled_lifetime": 1490976, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1490976, "timers": {"training_iteration_time_ms": 26862.223, "restore_workers_time_ms": 0.022, "training_step_time_ms": 26861.574, "sample_time_ms": 2926.546, "learn_time_ms": 23910.264, "learn_throughput": 167.627, "synch_weights_time_ms": 19.547}, "counters": {"num_env_steps_sampled": 372744, "num_env_steps_trained": 372744, "num_agent_steps_sampled": 1490976, "num_agent_steps_trained": 1490976}, "done": false, "training_iteration": 93, "trial_id": "7f713_00000", "date": "2024-08-23_10-28-37", "timestamp": 1724389117, "time_this_iter_s": 26.067077159881592, "time_total_s": 2514.1930894851685, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x3ad9c1790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2514.1930894851685, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 35.770270270270274, "ram_util_percent": 79.97837837837838}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 63.262630104640174, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.608435083823229, "policy_loss": -0.009641654578545105, "vf_loss": 5.61627489322077, "vf_explained_var": 0.6154993206104904, "kl": 0.009009148499302606, "entropy": 0.7619549794171853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 88358.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.01835288900547, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 4.811108445112037, "policy_loss": -0.016543076448290357, "vf_loss": 4.827039398213543, "vf_explained_var": 0.4267626667148853, "kl": 0.01224234057072964, "entropy": 0.4072998401349184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 88358.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 376752, "num_env_steps_trained": 376752, "num_agent_steps_sampled": 1507008, "num_agent_steps_trained": 1507008}, "env_runners": {"episode_reward_max": 752.2164754822106, "episode_reward_min": 23.700000000000063, "episode_reward_mean": 322.18558830857654, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -827.431164042529, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 398.2, "predator_policy": 827.2545954110806}, "policy_reward_mean": {"prey_policy": -95.0755554916399, "predator_policy": 256.1683496459281}, "custom_metrics": {}, "hist_stats": {"episode_reward": [427.5270667910678, 62.70000000000062, 432.5000000000026, 233.54294389121048, 752.2164754822106, 513.2366399252302, 340.4341847922202, 310.99122887695853, 365.3395351785799, 342.7824526158173, 708.2100905169827, 192.6936648277091, 95.98771322444011, 347.9181916437499, 724.8536817219274, 599.7381064055685, 50.711903428459564, 75.2, 255.057283638447, 399.000000000002, 436.4810136364009, 422.49741209927754, 595.542783017021, 400.8735425561629, 358.2000659002467, 280.3752792377946, 418.30000000000246, 518.5722633031044, 61.178659561700144, 381.3872472269089, 399.5480199304558, 668.1, 255.45695172515747, 91.31593444995036, 386.6333050404395, 214.29759665711512, 312.56759546780984, 472.87644609619576, 55.00000000000049, 670.1, 271.6143333241116, 422.13620243504624, 364.7000000000013, 78.8286372643206, 298.99999999999994, 91.92421368764181, 255.84430424089663, 358.6000000000013, 360.0392165750034, 748.7692516311904, 210.20123920301356, 305.04751084793907, 264.84191598411326, 420.4000000000025, 79.50000000000017, 379.3989157753646, 411.5000000000023, 394.04233460173765, 304.4583562494206, 729.5246313685401, 443.9616238527655, 538.8874242576004, 47.70000000000041, 335.2837383409214, 23.700000000000063, 166.1813719633956, 55.056999928592866, 369.04061251469915, 49.44874610268181, 151.2999999999999, 134.24488390889545, 78.79362394896532, 51.35036584999923, 596.4216757620896, 81.77611812479674, 214.99424019868346, 373.93783238730276, 415.94261418363686, 38.9000000000003, 640.5471292801486, 233.38193762832404, 290.3163754129023, 623.3449723176748, 81.99657194883962, 388.52672525318656, 442.06666864384863, 511.2817510296461, 427.9195629808058, 265.5304580060335, 583.0450004264899, 198.51021773532472, 196.39726085230035, 376.51379997305514, 255.3931963225517, 392.532668812982, 106.72126552298654, 97.42078847033463, 162.99614711437866, 317.1753061792633, 79.70281356687771], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [319.2510877161371, -251.28837502605882, -149.11228047713755, -11.249639146120984, -22.956019854011032, 398.2, -630.4303763664852, 159.2216595052189, -43.181349913665485, 290.0426843926191, 26.25228601561143, -92.88122360324996, 126.17010414055815, 9.600563221803132, -36.960327691803435, 100.18944393243322, -436.58664572706414, 227.9336327363271, -454.1368361009552, 7.339940037534234, 343.5404602045953, 247.23903167701005, -0.5285246554273613, -695.0916569035544, -331.2851159399556, -242.07537395086547, 312.34768621983494, -407.5237887181003, 366.87852804316185, 251.22201628417122, -158.6474728649444, 297.60794247001013, 3.522656675867729, -333.59599321253927, -29.098365682834554, 33.54022629609827, -797.9242291398702, 17.62115565884935, 12.552740121044463, 305.4843390274429, 178.2539536244069, -358.3875929084156, -214.0140102418448, 29.539595713030714, 263.0028524928904, 100.73090129209663, -11.22560824584869, 169.87849383636765, -727.2311517102074, -57.130937962430544, 69.39718094507072, -54.73095163887218, 377.05881022413485, -60.37781560401047, 45.93587368773361, -13.663884737250271, -563.8885430015563, -303.3828287046764, 264.4146104787877, 31.978674800287827, -196.7902798310463, 187.73480480063483, 181.8501738934856, 351.0018709755116, -315.08210160932606, -604.1922553715534, -653.6937267231076, -125.23478538507487, 289.30316252450194, -222.5501828940875, -37.77118897770393, -295.2809729330478, -43.496866439981034, -4.111183924762079, 0.31071725688823587, -280.6094985697084, -376.37699264481614, 4.47165510800151, 300.3837236257168, 231.16944779017177, -827.431164042529, -102.16949251783313, 388.23620243504377, -34.93995706934853, -96.31489162516624, 278.2010799513029, -53.28439234917475, -269.6888647792298, -18.184280750266055, 74.41084801612811, -89.25347698879969, 33.78273403719841, 177.83134094385608, -679.2265492962449, 285.3839867070403, -172.36796557114948, 43.44683060942923, -89.43775750040572, -259.31716269172506, 376.0579520302023, -49.525420963023045, -762.3946521349659, 160.58257307577492, -367.7459037565374, 140.5955878765444, -454.89400277712116, 381.1, 32.438686600489476, -33.20054851856679, -467.09270456081777, -571.2819963023204, 265.2343014714023, 32.54637045806415, 356.42207534918793, 256.3285386017303, 33.33031218006205, -472.1554862609876, -313.2030534015554, 325.5363126282745, 129.04057908753103, -451.281525057918, 227.1455440164121, 174.97499500636258, -551.08668903136, -254.4062939455331, -134.59559195784865, 197.23060652780345, 22.84281383458671, -364.2563414539481, -508.03790637949993, 22.42651534158678, -370.808020532488, -47.489686322290694, -252.80823902128083, 258.06846430031567, -147.53850961221278, -87.4095786830135, -711.831412027964, -463.40534500282797, -323.6488050300519, -23.0737936193256, -556.4610883458009, -28.78635646689878, -609.1968144654854, -619.9854578179386, -126.19503422900435, 370.72012351974195, -193.05406176005363, -28.536969550920496, -270.1917356068597, -307.68428907966637, 58.01898834282487, -396.4962730161112, -190.80807804531594, 26.264849382610198, 205.66183730490542, -15.45874599950781, -508.0674569173962, 241.06054130601444, 228.0586875601521, -175.7291079865533, -373.8942989265103, -111.82552512875074, 187.80706811829398, -15.70362769683473, 120.56286778206467, -408.22391024809644, -138.55820701757187, 37.86022985309584, 259.9860846640472, 395.5, -14.69597722895124, -582.4932679486889, 92.51042278226399, -307.2738271858617, 178.60045873983788, 52.92500237993298, -185.89157330355346, -69.33894768959806, -720.2788747110861, -320.6937451878256, -306.9145552958188, -190.8447016606458, -118.7856936319289, -365.3436333660893, 354.297448102932, -213.23711595150905, -66.29559613089359, 186.1467225502996, -181.11402269637628, -260.12129863309315, -599.3016966014251, -21.449340914339096, -433.9755627468316, -709.0307811223447, -3.732171217841288, 91.77249412050574, -659.8267620811864, -47.80262717803734, -736.3716360113747], "policy_predator_policy_reward": [137.72051657463555, 221.84383752635438, 176.312280477136, 46.7496391461214, 57.25601985401151, 0.0, 31.57529559618894, 673.1763651562883, 234.30073700208993, 271.05440400116777, 281.59028253262386, 298.27529498024, 158.47512309475465, 46.18839433510336, 120.93218345552731, 126.82992918080106, 100.00719471853068, 473.9853534507871, 350.68750571812325, 438.89184296111785, 92.45676238769532, 24.97383624768189, 200.12652527965977, 688.1873211070321, 390.06403141949147, 279.28417169576926, 15.464489422246553, 427.6298047197685, 30.853329324537555, 75.8998080700567, 303.41383379015855, 157.36380301034455, 27.689246752591593, 353.09599321254234, 64.898365682835, 5.859773703901936, 827.2545954110806, 208.105761708387, 24.84725987895559, 56.11566097255712, 287.0941337879401, 329.5205191324626, 314.5314543106873, 292.44037231740475, 58.966873756375136, 172.84215547565873, 86.35534373119056, 155.86531323445166, 546.5950528918602, 595.9671026810166, 173.16683982080215, 92.54221011079264, 8.74118977586512, 92.87781560400903, 273.3327752465407, 212.96749910607653, 571.5033402282564, 356.946691039685, 54.15558899426528, 30.838372953566537, 200.08197607288182, 208.52151888798159, 123.14982610651424, 12.098129024488365, 470.83867285282264, 703.8926358532213, 716.0939629323668, 154.1504836257647, 77.09182780781582, 242.7884976022058, 171.52202583992255, 375.82773272794424, 256.6133514466706, 103.56229438588328, 377.98788432568324, 375.18734308332796, 394.2769926448202, 32.62834489199869, 47.516276374283336, 91.0305522098281, 703.5118524784984, 497.7031374059754, 0.0, 68.8399570693487, 130.51489162516458, 52.29892004869715, 319.0246642139009, 82.77723017882715, 54.58428075026657, 188.1891519838718, 28.192472333287512, 119.20248430595515, 74.58361184667046, 682.6559007466159, 48.41601329295974, 197.16796557114807, 8.078552763778719, 397.9515907022005, 350.98253097784476, 281.0459313148687, 400.36423441571293, 621.7570778852886, 127.52561148621635, 384.6852300424883, 83.39953616229585, 495.7407947223955, 0.0, 6.861313399510711, 67.40054851856705, 512.3927045608178, 139.7206991094585, 545.7259114968231, 6.853629541936035, 15.677924650812063, 52.77957031038073, 51.603913509562744, 283.5549916315797, 806.261904280386, 151.25706865825734, 123.69067099447729, 525.8556481093624, 142.24195678490906, 449.4154493546013, 465.58366892799705, 276.1062939455375, 160.5955919578472, 103.06939347219642, 12.140924506333976, 375.85634145394994, 520.1379063795002, 176.5647743189375, 337.9981028353636, 347.0401963505564, 8.31472892160783, 78.47214821438209, 180.03850961221093, 124.85832478569324, 723.8314120279637, 479.4053450028284, 458.94880503005214, 146.99791560717128, 566.7818502668515, 90.68556069882546, 626.0912341825234, 592.5298149746075, 205.0010429223323, 117.84143504852044, 300.9141789538806, 98.16567709003206, 282.33914619255137, 328.2462109607746, 136.41332997475766, 804.3415033499832, 156.90068009874526, 92.28350702531189, 91.73242047080718, 50.07486252302509, 512.3513403938802, 84.81013151895351, 86.61776889502839, 337.5528640819294, 445.4524804594584, 190.13341693916948, 24.20141548418787, 286.89000434785027, 231.595727884595, 128.07646996211767, 500.7022192523909, 56.08379057927144, 34.5966201567703, 50.99597722895173, 10.266668643845719, 590.7863915729355, 410.4782046231365, 323.44091034754206, 233.1520210792896, 172.2262641440825, 226.2707647855706, 669.7695852871143, 702.8932375400628, 487.1375561890685, 338.98096202990183, 360.4628565646913, 145.56479958018318, 382.0436333660931, 5.5163518701210945, 240.8872686614396, 294.0386397435153, 187.2343972235491, 200.26557173550586, 363.521298633094, 602.6229621244125, 110.1414199515101, 442.7042721799998, 725.6176769127596, 150.14142254180544, 669.0671847064996, 216.16238943344263, 131.39640788216647, 732.480668874123]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.821495811566196, "mean_inference_ms": 7.061822510100111, "mean_action_processing_ms": 2.393187352470792, "mean_env_wait_ms": 17.34501987173179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.025751233100891113, "StateBufferConnector_ms": 0.009218692779541016, "ViewRequirementAgentConnector_ms": 0.24712300300598145}, "num_episodes": 10, "episode_return_max": 752.2164754822106, "episode_return_min": 23.700000000000063, "episode_return_mean": 322.18558830857654, "episodes_this_iter": 10}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1507008, "num_agent_steps_trained": 1507008, "num_env_steps_sampled": 376752, "num_env_steps_trained": 376752, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 151.4614898294712, "num_env_steps_trained_throughput_per_sec": 151.4614898294712, "timesteps_total": 376752, "num_env_steps_sampled_lifetime": 376752, "num_agent_steps_sampled_lifetime": 1507008, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1507008, "timers": {"training_iteration_time_ms": 26845.758, "restore_workers_time_ms": 0.022, "training_step_time_ms": 26845.112, "sample_time_ms": 2871.379, "learn_time_ms": 23949.058, "learn_throughput": 167.355, "synch_weights_time_ms": 19.526}, "counters": {"num_env_steps_sampled": 376752, "num_env_steps_trained": 376752, "num_agent_steps_sampled": 1507008, "num_agent_steps_trained": 1507008}, "done": false, "training_iteration": 94, "trial_id": "7f713_00000", "date": "2024-08-23_10-29-04", "timestamp": 1724389144, "time_this_iter_s": 26.51273226737976, "time_total_s": 2540.705821752548, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1738bc940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2540.705821752548, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 36.55526315789473, "ram_util_percent": 79.74210526315788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 57.179237013014536, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.28945150577202, "policy_loss": -0.0078359808629901, "vf_loss": 5.295754031781797, "vf_explained_var": 0.6268894003181861, "kl": 0.0076673119567906255, "entropy": 0.7651250503050587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 89303.0, "diff_num_grad_updates_vs_sampler_policy": 489.68338323353964}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.802311935374345, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 4.908113509132749, "policy_loss": -0.011988172602529327, "vf_loss": 4.919601743688029, "vf_explained_var": 0.27962821539116917, "kl": 0.009998547356999505, "entropy": 0.40543637837051716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 89303.0, "diff_num_grad_updates_vs_sampler_policy": 489.68338323353964}}, "num_env_steps_sampled": 380760, "num_env_steps_trained": 380760, "num_agent_steps_sampled": 1523040, "num_agent_steps_trained": 1523040}, "env_runners": {"episode_reward_max": 748.7692516311904, "episode_reward_min": 13.78733493169347, "episode_reward_mean": 309.8586073608278, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -827.431164042529, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 395.5, "predator_policy": 827.2545954110806}, "policy_reward_mean": {"prey_policy": -117.32516320139861, "predator_policy": 272.2544668818124}, "custom_metrics": {}, "hist_stats": {"episode_reward": [95.98771322444011, 347.9181916437499, 724.8536817219274, 599.7381064055685, 50.711903428459564, 75.2, 255.057283638447, 399.000000000002, 436.4810136364009, 422.49741209927754, 595.542783017021, 400.8735425561629, 358.2000659002467, 280.3752792377946, 418.30000000000246, 518.5722633031044, 61.178659561700144, 381.3872472269089, 399.5480199304558, 668.1, 255.45695172515747, 91.31593444995036, 386.6333050404395, 214.29759665711512, 312.56759546780984, 472.87644609619576, 55.00000000000049, 670.1, 271.6143333241116, 422.13620243504624, 364.7000000000013, 78.8286372643206, 298.99999999999994, 91.92421368764181, 255.84430424089663, 358.6000000000013, 360.0392165750034, 748.7692516311904, 210.20123920301356, 305.04751084793907, 264.84191598411326, 420.4000000000025, 79.50000000000017, 379.3989157753646, 411.5000000000023, 394.04233460173765, 304.4583562494206, 729.5246313685401, 443.9616238527655, 538.8874242576004, 47.70000000000041, 335.2837383409214, 23.700000000000063, 166.1813719633956, 55.056999928592866, 369.04061251469915, 49.44874610268181, 151.2999999999999, 134.24488390889545, 78.79362394896532, 51.35036584999923, 596.4216757620896, 81.77611812479674, 214.99424019868346, 373.93783238730276, 415.94261418363686, 38.9000000000003, 640.5471292801486, 233.38193762832404, 290.3163754129023, 623.3449723176748, 81.99657194883962, 388.52672525318656, 442.06666864384863, 511.2817510296461, 427.9195629808058, 265.5304580060335, 583.0450004264899, 198.51021773532472, 196.39726085230035, 376.51379997305514, 255.3931963225517, 392.532668812982, 106.72126552298654, 97.42078847033463, 162.99614711437866, 317.1753061792633, 79.70281356687771, 410.27640329159885, 37.100000000000186, 90.2381918349871, 421.13469079515016, 225.89787461251302, 386.3788659456347, 425.5179255718409, 623.6091761423522, 485.19999999999993, 270.9357249973432, 13.78733493169347, 59.400000000000574], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-331.2851159399556, -242.07537395086547, 312.34768621983494, -407.5237887181003, 366.87852804316185, 251.22201628417122, -158.6474728649444, 297.60794247001013, 3.522656675867729, -333.59599321253927, -29.098365682834554, 33.54022629609827, -797.9242291398702, 17.62115565884935, 12.552740121044463, 305.4843390274429, 178.2539536244069, -358.3875929084156, -214.0140102418448, 29.539595713030714, 263.0028524928904, 100.73090129209663, -11.22560824584869, 169.87849383636765, -727.2311517102074, -57.130937962430544, 69.39718094507072, -54.73095163887218, 377.05881022413485, -60.37781560401047, 45.93587368773361, -13.663884737250271, -563.8885430015563, -303.3828287046764, 264.4146104787877, 31.978674800287827, -196.7902798310463, 187.73480480063483, 181.8501738934856, 351.0018709755116, -315.08210160932606, -604.1922553715534, -653.6937267231076, -125.23478538507487, 289.30316252450194, -222.5501828940875, -37.77118897770393, -295.2809729330478, -43.496866439981034, -4.111183924762079, 0.31071725688823587, -280.6094985697084, -376.37699264481614, 4.47165510800151, 300.3837236257168, 231.16944779017177, -827.431164042529, -102.16949251783313, 388.23620243504377, -34.93995706934853, -96.31489162516624, 278.2010799513029, -53.28439234917475, -269.6888647792298, -18.184280750266055, 74.41084801612811, -89.25347698879969, 33.78273403719841, 177.83134094385608, -679.2265492962449, 285.3839867070403, -172.36796557114948, 43.44683060942923, -89.43775750040572, -259.31716269172506, 376.0579520302023, -49.525420963023045, -762.3946521349659, 160.58257307577492, -367.7459037565374, 140.5955878765444, -454.89400277712116, 381.1, 32.438686600489476, -33.20054851856679, -467.09270456081777, -571.2819963023204, 265.2343014714023, 32.54637045806415, 356.42207534918793, 256.3285386017303, 33.33031218006205, -472.1554862609876, -313.2030534015554, 325.5363126282745, 129.04057908753103, -451.281525057918, 227.1455440164121, 174.97499500636258, -551.08668903136, -254.4062939455331, -134.59559195784865, 197.23060652780345, 22.84281383458671, -364.2563414539481, -508.03790637949993, 22.42651534158678, -370.808020532488, -47.489686322290694, -252.80823902128083, 258.06846430031567, -147.53850961221278, -87.4095786830135, -711.831412027964, -463.40534500282797, -323.6488050300519, -23.0737936193256, -556.4610883458009, -28.78635646689878, -609.1968144654854, -619.9854578179386, -126.19503422900435, 370.72012351974195, -193.05406176005363, -28.536969550920496, -270.1917356068597, -307.68428907966637, 58.01898834282487, -396.4962730161112, -190.80807804531594, 26.264849382610198, 205.66183730490542, -15.45874599950781, -508.0674569173962, 241.06054130601444, 228.0586875601521, -175.7291079865533, -373.8942989265103, -111.82552512875074, 187.80706811829398, -15.70362769683473, 120.56286778206467, -408.22391024809644, -138.55820701757187, 37.86022985309584, 259.9860846640472, 395.5, -14.69597722895124, -582.4932679486889, 92.51042278226399, -307.2738271858617, 178.60045873983788, 52.92500237993298, -185.89157330355346, -69.33894768959806, -720.2788747110861, -320.6937451878256, -306.9145552958188, -190.8447016606458, -118.7856936319289, -365.3436333660893, 354.297448102932, -213.23711595150905, -66.29559613089359, 186.1467225502996, -181.11402269637628, -260.12129863309315, -599.3016966014251, -21.449340914339096, -433.9755627468316, -709.0307811223447, -3.732171217841288, 91.77249412050574, -659.8267620811864, -47.80262717803734, -736.3716360113747, -76.22490199817707, -635.3231758028415, -614.2960372059855, -93.48894924793171, 34.550611662733026, -483.50696008024494, -724.5904065097367, 129.26780184826123, -354.6179420380256, -263.49708940826144, -513.688646856601, 251.21636510219406, -655.8305712425829, -93.052706550574, 197.52272462320406, 208.07268734681577, 339.3748967755138, -155.73726853135992, 9.189726966229273, -446.76684552363696, -619.7101796971048, -186.5735983367049, -152.72964801950084, -118.90379111310949], "policy_predator_policy_reward": [390.06403141949147, 279.28417169576926, 15.464489422246553, 427.6298047197685, 30.853329324537555, 75.8998080700567, 303.41383379015855, 157.36380301034455, 27.689246752591593, 353.09599321254234, 64.898365682835, 5.859773703901936, 827.2545954110806, 208.105761708387, 24.84725987895559, 56.11566097255712, 287.0941337879401, 329.5205191324626, 314.5314543106873, 292.44037231740475, 58.966873756375136, 172.84215547565873, 86.35534373119056, 155.86531323445166, 546.5950528918602, 595.9671026810166, 173.16683982080215, 92.54221011079264, 8.74118977586512, 92.87781560400903, 273.3327752465407, 212.96749910607653, 571.5033402282564, 356.946691039685, 54.15558899426528, 30.838372953566537, 200.08197607288182, 208.52151888798159, 123.14982610651424, 12.098129024488365, 470.83867285282264, 703.8926358532213, 716.0939629323668, 154.1504836257647, 77.09182780781582, 242.7884976022058, 171.52202583992255, 375.82773272794424, 256.6133514466706, 103.56229438588328, 377.98788432568324, 375.18734308332796, 394.2769926448202, 32.62834489199869, 47.516276374283336, 91.0305522098281, 703.5118524784984, 497.7031374059754, 0.0, 68.8399570693487, 130.51489162516458, 52.29892004869715, 319.0246642139009, 82.77723017882715, 54.58428075026657, 188.1891519838718, 28.192472333287512, 119.20248430595515, 74.58361184667046, 682.6559007466159, 48.41601329295974, 197.16796557114807, 8.078552763778719, 397.9515907022005, 350.98253097784476, 281.0459313148687, 400.36423441571293, 621.7570778852886, 127.52561148621635, 384.6852300424883, 83.39953616229585, 495.7407947223955, 0.0, 6.861313399510711, 67.40054851856705, 512.3927045608178, 139.7206991094585, 545.7259114968231, 6.853629541936035, 15.677924650812063, 52.77957031038073, 51.603913509562744, 283.5549916315797, 806.261904280386, 151.25706865825734, 123.69067099447729, 525.8556481093624, 142.24195678490906, 449.4154493546013, 465.58366892799705, 276.1062939455375, 160.5955919578472, 103.06939347219642, 12.140924506333976, 375.85634145394994, 520.1379063795002, 176.5647743189375, 337.9981028353636, 347.0401963505564, 8.31472892160783, 78.47214821438209, 180.03850961221093, 124.85832478569324, 723.8314120279637, 479.4053450028284, 458.94880503005214, 146.99791560717128, 566.7818502668515, 90.68556069882546, 626.0912341825234, 592.5298149746075, 205.0010429223323, 117.84143504852044, 300.9141789538806, 98.16567709003206, 282.33914619255137, 328.2462109607746, 136.41332997475766, 804.3415033499832, 156.90068009874526, 92.28350702531189, 91.73242047080718, 50.07486252302509, 512.3513403938802, 84.81013151895351, 86.61776889502839, 337.5528640819294, 445.4524804594584, 190.13341693916948, 24.20141548418787, 286.89000434785027, 231.595727884595, 128.07646996211767, 500.7022192523909, 56.08379057927144, 34.5966201567703, 50.99597722895173, 10.266668643845719, 590.7863915729355, 410.4782046231365, 323.44091034754206, 233.1520210792896, 172.2262641440825, 226.2707647855706, 669.7695852871143, 702.8932375400628, 487.1375561890685, 338.98096202990183, 360.4628565646913, 145.56479958018318, 382.0436333660931, 5.5163518701210945, 240.8872686614396, 294.0386397435153, 187.2343972235491, 200.26557173550586, 363.521298633094, 602.6229621244125, 110.1414199515101, 442.7042721799998, 725.6176769127596, 150.14142254180544, 669.0671847064996, 216.16238943344263, 131.39640788216647, 732.480668874123, 536.4615847701194, 585.3628963224897, 614.8960372059856, 129.98894924792987, 43.18758017225559, 496.0069600802463, 550.2152459017437, 466.24204955487676, 529.4173309683952, 314.59557509040525, 526.3975657292967, 122.45358197074489, 565.6469463610276, 608.7542570039648, 114.16261255375157, 103.85115161858067, 31.32510322448627, 270.2372685313599, 249.745998031114, 458.7668455236397, 115.26809804605273, 704.8030149194527, 180.32964801949927, 150.70379111310768]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.810699190220594, "mean_inference_ms": 7.06014772030511, "mean_action_processing_ms": 2.3972689130274984, "mean_env_wait_ms": 17.33595007508771, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01793813705444336, "StateBufferConnector_ms": 0.009163379669189453, "ViewRequirementAgentConnector_ms": 0.23709893226623535}, "num_episodes": 12, "episode_return_max": 748.7692516311904, "episode_return_min": 13.78733493169347, "episode_return_mean": 309.8586073608278, "episodes_this_iter": 12}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1523040, "num_agent_steps_trained": 1523040, "num_env_steps_sampled": 380760, "num_env_steps_trained": 380760, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 151.7125986448814, "num_env_steps_trained_throughput_per_sec": 151.7125986448814, "timesteps_total": 380760, "num_env_steps_sampled_lifetime": 380760, "num_agent_steps_sampled_lifetime": 1523040, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1523040, "timers": {"training_iteration_time_ms": 26886.146, "restore_workers_time_ms": 0.023, "training_step_time_ms": 26885.521, "sample_time_ms": 2884.841, "learn_time_ms": 23972.023, "learn_throughput": 167.195, "synch_weights_time_ms": 23.392}, "counters": {"num_env_steps_sampled": 380760, "num_env_steps_trained": 380760, "num_agent_steps_sampled": 1523040, "num_agent_steps_trained": 1523040}, "done": false, "training_iteration": 95, "trial_id": "7f713_00000", "date": "2024-08-23_10-29-30", "timestamp": 1724389170, "time_this_iter_s": 26.4443142414093, "time_total_s": 2567.1501359939575, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17386b4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2567.1501359939575, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 38.4945945945946, "ram_util_percent": 80.1162162162162}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 67.66842041318378, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.564716935536218, "policy_loss": -0.008192975830690808, "vf_loss": 5.571440328870501, "vf_explained_var": 0.6824113386017936, "kl": 0.007347909376153318, "entropy": 0.7893472777472602, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 90248.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.17617775296408, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 5.153619919630586, "policy_loss": -0.010420815064694989, "vf_loss": 5.163624038898125, "vf_explained_var": 0.29915966653319265, "kl": 0.008334090530616109, "entropy": 0.3862457344140956, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 90248.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 384768, "num_env_steps_trained": 384768, "num_agent_steps_sampled": 1539072, "num_agent_steps_trained": 1539072}, "env_runners": {"episode_reward_max": 748.7692516311904, "episode_reward_min": 4.079390533664585, "episode_reward_mean": 298.3479656787756, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -827.431164042529, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 806.261904280386}, "policy_reward_mean": {"prey_policy": -129.2788764503471, "predator_policy": 278.4528592897348}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.3752792377946, 418.30000000000246, 518.5722633031044, 61.178659561700144, 381.3872472269089, 399.5480199304558, 668.1, 255.45695172515747, 91.31593444995036, 386.6333050404395, 214.29759665711512, 312.56759546780984, 472.87644609619576, 55.00000000000049, 670.1, 271.6143333241116, 422.13620243504624, 364.7000000000013, 78.8286372643206, 298.99999999999994, 91.92421368764181, 255.84430424089663, 358.6000000000013, 360.0392165750034, 748.7692516311904, 210.20123920301356, 305.04751084793907, 264.84191598411326, 420.4000000000025, 79.50000000000017, 379.3989157753646, 411.5000000000023, 394.04233460173765, 304.4583562494206, 729.5246313685401, 443.9616238527655, 538.8874242576004, 47.70000000000041, 335.2837383409214, 23.700000000000063, 166.1813719633956, 55.056999928592866, 369.04061251469915, 49.44874610268181, 151.2999999999999, 134.24488390889545, 78.79362394896532, 51.35036584999923, 596.4216757620896, 81.77611812479674, 214.99424019868346, 373.93783238730276, 415.94261418363686, 38.9000000000003, 640.5471292801486, 233.38193762832404, 290.3163754129023, 623.3449723176748, 81.99657194883962, 388.52672525318656, 442.06666864384863, 511.2817510296461, 427.9195629808058, 265.5304580060335, 583.0450004264899, 198.51021773532472, 196.39726085230035, 376.51379997305514, 255.3931963225517, 392.532668812982, 106.72126552298654, 97.42078847033463, 162.99614711437866, 317.1753061792633, 79.70281356687771, 410.27640329159885, 37.100000000000186, 90.2381918349871, 421.13469079515016, 225.89787461251302, 386.3788659456347, 425.5179255718409, 623.6091761423522, 485.19999999999993, 270.9357249973432, 13.78733493169347, 59.400000000000574, 732.8597309430419, 143.39018801313756, 182.49999999999955, 75.21823688517027, 293.7815197031959, 44.41400789522243, 336.0999999999999, 73.84650894229081, 593.566346448567, 438.3000000000028, 279.4104424962534, 4.079390533664585, 413.5311572059359], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [69.39718094507072, -54.73095163887218, 377.05881022413485, -60.37781560401047, 45.93587368773361, -13.663884737250271, -563.8885430015563, -303.3828287046764, 264.4146104787877, 31.978674800287827, -196.7902798310463, 187.73480480063483, 181.8501738934856, 351.0018709755116, -315.08210160932606, -604.1922553715534, -653.6937267231076, -125.23478538507487, 289.30316252450194, -222.5501828940875, -37.77118897770393, -295.2809729330478, -43.496866439981034, -4.111183924762079, 0.31071725688823587, -280.6094985697084, -376.37699264481614, 4.47165510800151, 300.3837236257168, 231.16944779017177, -827.431164042529, -102.16949251783313, 388.23620243504377, -34.93995706934853, -96.31489162516624, 278.2010799513029, -53.28439234917475, -269.6888647792298, -18.184280750266055, 74.41084801612811, -89.25347698879969, 33.78273403719841, 177.83134094385608, -679.2265492962449, 285.3839867070403, -172.36796557114948, 43.44683060942923, -89.43775750040572, -259.31716269172506, 376.0579520302023, -49.525420963023045, -762.3946521349659, 160.58257307577492, -367.7459037565374, 140.5955878765444, -454.89400277712116, 381.1, 32.438686600489476, -33.20054851856679, -467.09270456081777, -571.2819963023204, 265.2343014714023, 32.54637045806415, 356.42207534918793, 256.3285386017303, 33.33031218006205, -472.1554862609876, -313.2030534015554, 325.5363126282745, 129.04057908753103, -451.281525057918, 227.1455440164121, 174.97499500636258, -551.08668903136, -254.4062939455331, -134.59559195784865, 197.23060652780345, 22.84281383458671, -364.2563414539481, -508.03790637949993, 22.42651534158678, -370.808020532488, -47.489686322290694, -252.80823902128083, 258.06846430031567, -147.53850961221278, -87.4095786830135, -711.831412027964, -463.40534500282797, -323.6488050300519, -23.0737936193256, -556.4610883458009, -28.78635646689878, -609.1968144654854, -619.9854578179386, -126.19503422900435, 370.72012351974195, -193.05406176005363, -28.536969550920496, -270.1917356068597, -307.68428907966637, 58.01898834282487, -396.4962730161112, -190.80807804531594, 26.264849382610198, 205.66183730490542, -15.45874599950781, -508.0674569173962, 241.06054130601444, 228.0586875601521, -175.7291079865533, -373.8942989265103, -111.82552512875074, 187.80706811829398, -15.70362769683473, 120.56286778206467, -408.22391024809644, -138.55820701757187, 37.86022985309584, 259.9860846640472, 395.5, -14.69597722895124, -582.4932679486889, 92.51042278226399, -307.2738271858617, 178.60045873983788, 52.92500237993298, -185.89157330355346, -69.33894768959806, -720.2788747110861, -320.6937451878256, -306.9145552958188, -190.8447016606458, -118.7856936319289, -365.3436333660893, 354.297448102932, -213.23711595150905, -66.29559613089359, 186.1467225502996, -181.11402269637628, -260.12129863309315, -599.3016966014251, -21.449340914339096, -433.9755627468316, -709.0307811223447, -3.732171217841288, 91.77249412050574, -659.8267620811864, -47.80262717803734, -736.3716360113747, -76.22490199817707, -635.3231758028415, -614.2960372059855, -93.48894924793171, 34.550611662733026, -483.50696008024494, -724.5904065097367, 129.26780184826123, -354.6179420380256, -263.49708940826144, -513.688646856601, 251.21636510219406, -655.8305712425829, -93.052706550574, 197.52272462320406, 208.07268734681577, 339.3748967755138, -155.73726853135992, 9.189726966229273, -446.76684552363696, -619.7101796971048, -186.5735983367049, -152.72964801950084, -118.90379111310949, -467.30678599906867, 383.356953906848, -226.9937831870472, -118.23056773234754, -225.85928037359548, 28.941977340709816, -574.5015674134943, -333.8073733626637, -184.52880359760076, 105.38965363553822, -416.44285971914746, -128.33422672125855, -311.2014285060216, -129.16431137904846, -509.391491634672, -16.746641760792734, -200.86493561871833, 279.26380851862456, 400.0, 23.278780610319068, 4.515082076451872, -398.40488795378917, -493.17790415438236, -72.41518652557086, 236.5655706447316, -370.63899370628536], "policy_predator_policy_reward": [173.16683982080215, 92.54221011079264, 8.74118977586512, 92.87781560400903, 273.3327752465407, 212.96749910607653, 571.5033402282564, 356.946691039685, 54.15558899426528, 30.838372953566537, 200.08197607288182, 208.52151888798159, 123.14982610651424, 12.098129024488365, 470.83867285282264, 703.8926358532213, 716.0939629323668, 154.1504836257647, 77.09182780781582, 242.7884976022058, 171.52202583992255, 375.82773272794424, 256.6133514466706, 103.56229438588328, 377.98788432568324, 375.18734308332796, 394.2769926448202, 32.62834489199869, 47.516276374283336, 91.0305522098281, 703.5118524784984, 497.7031374059754, 0.0, 68.8399570693487, 130.51489162516458, 52.29892004869715, 319.0246642139009, 82.77723017882715, 54.58428075026657, 188.1891519838718, 28.192472333287512, 119.20248430595515, 74.58361184667046, 682.6559007466159, 48.41601329295974, 197.16796557114807, 8.078552763778719, 397.9515907022005, 350.98253097784476, 281.0459313148687, 400.36423441571293, 621.7570778852886, 127.52561148621635, 384.6852300424883, 83.39953616229585, 495.7407947223955, 0.0, 6.861313399510711, 67.40054851856705, 512.3927045608178, 139.7206991094585, 545.7259114968231, 6.853629541936035, 15.677924650812063, 52.77957031038073, 51.603913509562744, 283.5549916315797, 806.261904280386, 151.25706865825734, 123.69067099447729, 525.8556481093624, 142.24195678490906, 449.4154493546013, 465.58366892799705, 276.1062939455375, 160.5955919578472, 103.06939347219642, 12.140924506333976, 375.85634145394994, 520.1379063795002, 176.5647743189375, 337.9981028353636, 347.0401963505564, 8.31472892160783, 78.47214821438209, 180.03850961221093, 124.85832478569324, 723.8314120279637, 479.4053450028284, 458.94880503005214, 146.99791560717128, 566.7818502668515, 90.68556069882546, 626.0912341825234, 592.5298149746075, 205.0010429223323, 117.84143504852044, 300.9141789538806, 98.16567709003206, 282.33914619255137, 328.2462109607746, 136.41332997475766, 804.3415033499832, 156.90068009874526, 92.28350702531189, 91.73242047080718, 50.07486252302509, 512.3513403938802, 84.81013151895351, 86.61776889502839, 337.5528640819294, 445.4524804594584, 190.13341693916948, 24.20141548418787, 286.89000434785027, 231.595727884595, 128.07646996211767, 500.7022192523909, 56.08379057927144, 34.5966201567703, 50.99597722895173, 10.266668643845719, 590.7863915729355, 410.4782046231365, 323.44091034754206, 233.1520210792896, 172.2262641440825, 226.2707647855706, 669.7695852871143, 702.8932375400628, 487.1375561890685, 338.98096202990183, 360.4628565646913, 145.56479958018318, 382.0436333660931, 5.5163518701210945, 240.8872686614396, 294.0386397435153, 187.2343972235491, 200.26557173550586, 363.521298633094, 602.6229621244125, 110.1414199515101, 442.7042721799998, 725.6176769127596, 150.14142254180544, 669.0671847064996, 216.16238943344263, 131.39640788216647, 732.480668874123, 536.4615847701194, 585.3628963224897, 614.8960372059856, 129.98894924792987, 43.18758017225559, 496.0069600802463, 550.2152459017437, 466.24204955487676, 529.4173309683952, 314.59557509040525, 526.3975657292967, 122.45358197074489, 565.6469463610276, 608.7542570039648, 114.16261255375157, 103.85115161858067, 31.32510322448627, 270.2372685313599, 249.745998031114, 458.7668455236397, 115.26809804605273, 704.8030149194527, 180.32964801949927, 150.70379111310768, 378.1718067227287, 438.63775631253054, 147.1305677323459, 341.4839712001853, 369.259280373596, 10.15802265929031, 556.3081022985484, 427.21907536278684, 223.61905876131544, 149.3016109039414, 431.58914428279684, 157.6019500528304, 339.76832552135335, 436.6974143637165, 537.8198447183308, 62.16479761942569, 405.5649356187187, 109.60253792994253, 0.0, 15.021219389680963, 286.1119149339641, 387.1883334396258, 24.352484796514112, 545.3199964171038, 173.95716899701304, 373.6474112704774]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.801226733424459, "mean_inference_ms": 7.048647042499908, "mean_action_processing_ms": 2.394540573248323, "mean_env_wait_ms": 17.335587881580906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024302005767822266, "StateBufferConnector_ms": 0.009784460067749023, "ViewRequirementAgentConnector_ms": 0.19341230392456055}, "num_episodes": 13, "episode_return_max": 748.7692516311904, "episode_return_min": 4.079390533664585, "episode_return_mean": 298.3479656787756, "episodes_this_iter": 13}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1539072, "num_agent_steps_trained": 1539072, "num_env_steps_sampled": 384768, "num_env_steps_trained": 384768, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 151.6242705220291, "num_env_steps_trained_throughput_per_sec": 151.6242705220291, "timesteps_total": 384768, "num_env_steps_sampled_lifetime": 384768, "num_agent_steps_sampled_lifetime": 1539072, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1539072, "timers": {"training_iteration_time_ms": 26939.591, "restore_workers_time_ms": 0.023, "training_step_time_ms": 26939.001, "sample_time_ms": 2849.463, "learn_time_ms": 24061.964, "learn_throughput": 166.57, "synch_weights_time_ms": 22.594}, "counters": {"num_env_steps_sampled": 384768, "num_env_steps_trained": 384768, "num_agent_steps_sampled": 1539072, "num_agent_steps_trained": 1539072}, "done": false, "training_iteration": 96, "trial_id": "7f713_00000", "date": "2024-08-23_10-29-57", "timestamp": 1724389197, "time_this_iter_s": 26.4756019115448, "time_total_s": 2593.6257379055023, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737a2700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2593.6257379055023, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 36.834210526315786, "ram_util_percent": 79.73684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 62.19508303738145, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.536298396599986, "policy_loss": -0.009652440294761349, "vf_loss": 5.544115925844384, "vf_explained_var": 0.6766429545387389, "kl": 0.009174517972552509, "entropy": 0.7791838596106837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 91193.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.980010521601116, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 4.95131786664327, "policy_loss": -0.015022879240236112, "vf_loss": 4.965752145726845, "vf_explained_var": 0.2785894519437558, "kl": 0.011771956424194353, "entropy": 0.3703430865807508, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 91193.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 388776, "num_env_steps_trained": 388776, "num_agent_steps_sampled": 1555104, "num_agent_steps_trained": 1555104}, "env_runners": {"episode_reward_max": 748.7692516311904, "episode_reward_min": 4.079390533664585, "episode_reward_mean": 289.2865162563856, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -827.431164042529, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 806.261904280386}, "policy_reward_mean": {"prey_policy": -133.77940720064035, "predator_policy": 278.4226653288331}, "custom_metrics": {}, "hist_stats": {"episode_reward": [91.31593444995036, 386.6333050404395, 214.29759665711512, 312.56759546780984, 472.87644609619576, 55.00000000000049, 670.1, 271.6143333241116, 422.13620243504624, 364.7000000000013, 78.8286372643206, 298.99999999999994, 91.92421368764181, 255.84430424089663, 358.6000000000013, 360.0392165750034, 748.7692516311904, 210.20123920301356, 305.04751084793907, 264.84191598411326, 420.4000000000025, 79.50000000000017, 379.3989157753646, 411.5000000000023, 394.04233460173765, 304.4583562494206, 729.5246313685401, 443.9616238527655, 538.8874242576004, 47.70000000000041, 335.2837383409214, 23.700000000000063, 166.1813719633956, 55.056999928592866, 369.04061251469915, 49.44874610268181, 151.2999999999999, 134.24488390889545, 78.79362394896532, 51.35036584999923, 596.4216757620896, 81.77611812479674, 214.99424019868346, 373.93783238730276, 415.94261418363686, 38.9000000000003, 640.5471292801486, 233.38193762832404, 290.3163754129023, 623.3449723176748, 81.99657194883962, 388.52672525318656, 442.06666864384863, 511.2817510296461, 427.9195629808058, 265.5304580060335, 583.0450004264899, 198.51021773532472, 196.39726085230035, 376.51379997305514, 255.3931963225517, 392.532668812982, 106.72126552298654, 97.42078847033463, 162.99614711437866, 317.1753061792633, 79.70281356687771, 410.27640329159885, 37.100000000000186, 90.2381918349871, 421.13469079515016, 225.89787461251302, 386.3788659456347, 425.5179255718409, 623.6091761423522, 485.19999999999993, 270.9357249973432, 13.78733493169347, 59.400000000000574, 732.8597309430419, 143.39018801313756, 182.49999999999955, 75.21823688517027, 293.7815197031959, 44.41400789522243, 336.0999999999999, 73.84650894229081, 593.566346448567, 438.3000000000028, 279.4104424962534, 4.079390533664585, 413.5311572059359, 403.90000000000214, 310.2818188547113, 483.040206295397, 79.19999999999978, 162.5233962361732, 42.385383132816735, 430.8305515174454, 164.6121227095757], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-653.6937267231076, -125.23478538507487, 289.30316252450194, -222.5501828940875, -37.77118897770393, -295.2809729330478, -43.496866439981034, -4.111183924762079, 0.31071725688823587, -280.6094985697084, -376.37699264481614, 4.47165510800151, 300.3837236257168, 231.16944779017177, -827.431164042529, -102.16949251783313, 388.23620243504377, -34.93995706934853, -96.31489162516624, 278.2010799513029, -53.28439234917475, -269.6888647792298, -18.184280750266055, 74.41084801612811, -89.25347698879969, 33.78273403719841, 177.83134094385608, -679.2265492962449, 285.3839867070403, -172.36796557114948, 43.44683060942923, -89.43775750040572, -259.31716269172506, 376.0579520302023, -49.525420963023045, -762.3946521349659, 160.58257307577492, -367.7459037565374, 140.5955878765444, -454.89400277712116, 381.1, 32.438686600489476, -33.20054851856679, -467.09270456081777, -571.2819963023204, 265.2343014714023, 32.54637045806415, 356.42207534918793, 256.3285386017303, 33.33031218006205, -472.1554862609876, -313.2030534015554, 325.5363126282745, 129.04057908753103, -451.281525057918, 227.1455440164121, 174.97499500636258, -551.08668903136, -254.4062939455331, -134.59559195784865, 197.23060652780345, 22.84281383458671, -364.2563414539481, -508.03790637949993, 22.42651534158678, -370.808020532488, -47.489686322290694, -252.80823902128083, 258.06846430031567, -147.53850961221278, -87.4095786830135, -711.831412027964, -463.40534500282797, -323.6488050300519, -23.0737936193256, -556.4610883458009, -28.78635646689878, -609.1968144654854, -619.9854578179386, -126.19503422900435, 370.72012351974195, -193.05406176005363, -28.536969550920496, -270.1917356068597, -307.68428907966637, 58.01898834282487, -396.4962730161112, -190.80807804531594, 26.264849382610198, 205.66183730490542, -15.45874599950781, -508.0674569173962, 241.06054130601444, 228.0586875601521, -175.7291079865533, -373.8942989265103, -111.82552512875074, 187.80706811829398, -15.70362769683473, 120.56286778206467, -408.22391024809644, -138.55820701757187, 37.86022985309584, 259.9860846640472, 395.5, -14.69597722895124, -582.4932679486889, 92.51042278226399, -307.2738271858617, 178.60045873983788, 52.92500237993298, -185.89157330355346, -69.33894768959806, -720.2788747110861, -320.6937451878256, -306.9145552958188, -190.8447016606458, -118.7856936319289, -365.3436333660893, 354.297448102932, -213.23711595150905, -66.29559613089359, 186.1467225502996, -181.11402269637628, -260.12129863309315, -599.3016966014251, -21.449340914339096, -433.9755627468316, -709.0307811223447, -3.732171217841288, 91.77249412050574, -659.8267620811864, -47.80262717803734, -736.3716360113747, -76.22490199817707, -635.3231758028415, -614.2960372059855, -93.48894924793171, 34.550611662733026, -483.50696008024494, -724.5904065097367, 129.26780184826123, -354.6179420380256, -263.49708940826144, -513.688646856601, 251.21636510219406, -655.8305712425829, -93.052706550574, 197.52272462320406, 208.07268734681577, 339.3748967755138, -155.73726853135992, 9.189726966229273, -446.76684552363696, -619.7101796971048, -186.5735983367049, -152.72964801950084, -118.90379111310949, -467.30678599906867, 383.356953906848, -226.9937831870472, -118.23056773234754, -225.85928037359548, 28.941977340709816, -574.5015674134943, -333.8073733626637, -184.52880359760076, 105.38965363553822, -416.44285971914746, -128.33422672125855, -311.2014285060216, -129.16431137904846, -509.391491634672, -16.746641760792734, -200.86493561871833, 279.26380851862456, 400.0, 23.278780610319068, 4.515082076451872, -398.40488795378917, -493.17790415438236, -72.41518652557086, 236.5655706447316, -370.63899370628536, 358.33950146130564, -52.70673946743954, -23.856930101836465, -104.0851552768678, 390.1712227128368, -29.796508382548375, 35.25105200472776, 36.39236378496922, -7.052669898690315, -354.69329020348147, -598.3303631832259, -408.4113226633433, 141.9977773115786, -175.56436568381946, -295.9995779002267, -414.4978052652376], "policy_predator_policy_reward": [716.0939629323668, 154.1504836257647, 77.09182780781582, 242.7884976022058, 171.52202583992255, 375.82773272794424, 256.6133514466706, 103.56229438588328, 377.98788432568324, 375.18734308332796, 394.2769926448202, 32.62834489199869, 47.516276374283336, 91.0305522098281, 703.5118524784984, 497.7031374059754, 0.0, 68.8399570693487, 130.51489162516458, 52.29892004869715, 319.0246642139009, 82.77723017882715, 54.58428075026657, 188.1891519838718, 28.192472333287512, 119.20248430595515, 74.58361184667046, 682.6559007466159, 48.41601329295974, 197.16796557114807, 8.078552763778719, 397.9515907022005, 350.98253097784476, 281.0459313148687, 400.36423441571293, 621.7570778852886, 127.52561148621635, 384.6852300424883, 83.39953616229585, 495.7407947223955, 0.0, 6.861313399510711, 67.40054851856705, 512.3927045608178, 139.7206991094585, 545.7259114968231, 6.853629541936035, 15.677924650812063, 52.77957031038073, 51.603913509562744, 283.5549916315797, 806.261904280386, 151.25706865825734, 123.69067099447729, 525.8556481093624, 142.24195678490906, 449.4154493546013, 465.58366892799705, 276.1062939455375, 160.5955919578472, 103.06939347219642, 12.140924506333976, 375.85634145394994, 520.1379063795002, 176.5647743189375, 337.9981028353636, 347.0401963505564, 8.31472892160783, 78.47214821438209, 180.03850961221093, 124.85832478569324, 723.8314120279637, 479.4053450028284, 458.94880503005214, 146.99791560717128, 566.7818502668515, 90.68556069882546, 626.0912341825234, 592.5298149746075, 205.0010429223323, 117.84143504852044, 300.9141789538806, 98.16567709003206, 282.33914619255137, 328.2462109607746, 136.41332997475766, 804.3415033499832, 156.90068009874526, 92.28350702531189, 91.73242047080718, 50.07486252302509, 512.3513403938802, 84.81013151895351, 86.61776889502839, 337.5528640819294, 445.4524804594584, 190.13341693916948, 24.20141548418787, 286.89000434785027, 231.595727884595, 128.07646996211767, 500.7022192523909, 56.08379057927144, 34.5966201567703, 50.99597722895173, 10.266668643845719, 590.7863915729355, 410.4782046231365, 323.44091034754206, 233.1520210792896, 172.2262641440825, 226.2707647855706, 669.7695852871143, 702.8932375400628, 487.1375561890685, 338.98096202990183, 360.4628565646913, 145.56479958018318, 382.0436333660931, 5.5163518701210945, 240.8872686614396, 294.0386397435153, 187.2343972235491, 200.26557173550586, 363.521298633094, 602.6229621244125, 110.1414199515101, 442.7042721799998, 725.6176769127596, 150.14142254180544, 669.0671847064996, 216.16238943344263, 131.39640788216647, 732.480668874123, 536.4615847701194, 585.3628963224897, 614.8960372059856, 129.98894924792987, 43.18758017225559, 496.0069600802463, 550.2152459017437, 466.24204955487676, 529.4173309683952, 314.59557509040525, 526.3975657292967, 122.45358197074489, 565.6469463610276, 608.7542570039648, 114.16261255375157, 103.85115161858067, 31.32510322448627, 270.2372685313599, 249.745998031114, 458.7668455236397, 115.26809804605273, 704.8030149194527, 180.32964801949927, 150.70379111310768, 378.1718067227287, 438.63775631253054, 147.1305677323459, 341.4839712001853, 369.259280373596, 10.15802265929031, 556.3081022985484, 427.21907536278684, 223.61905876131544, 149.3016109039414, 431.58914428279684, 157.6019500528304, 339.76832552135335, 436.6974143637165, 537.8198447183308, 62.16479761942569, 405.5649356187187, 109.60253792994253, 0.0, 15.021219389680963, 286.1119149339641, 387.1883334396258, 24.352484796514112, 545.3199964171038, 173.95716899701304, 373.6474112704774, 12.26049853869437, 86.00673946743845, 369.4304943587228, 68.79340987469304, 61.40760031854993, 61.25789164655519, 4.248947995272475, 3.307636215031028, 153.4503530189137, 370.8190033194366, 626.2372350140653, 422.8898339653239, 113.93277420586656, 350.46436568382035, 293.51357480628945, 581.5959310687533]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.795575368250711, "mean_inference_ms": 7.053500577745699, "mean_action_processing_ms": 2.3828893609315114, "mean_env_wait_ms": 17.338550601909326, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024178028106689453, "StateBufferConnector_ms": 0.009758353233337402, "ViewRequirementAgentConnector_ms": 0.19592487812042236}, "num_episodes": 8, "episode_return_max": 748.7692516311904, "episode_return_min": 4.079390533664585, "episode_return_mean": 289.2865162563856, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1555104, "num_agent_steps_trained": 1555104, "num_env_steps_sampled": 388776, "num_env_steps_trained": 388776, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 155.5668535450081, "num_env_steps_trained_throughput_per_sec": 155.5668535450081, "timesteps_total": 388776, "num_env_steps_sampled_lifetime": 388776, "num_agent_steps_sampled_lifetime": 1555104, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1555104, "timers": {"training_iteration_time_ms": 26844.845, "restore_workers_time_ms": 0.022, "training_step_time_ms": 26844.251, "sample_time_ms": 2823.119, "learn_time_ms": 23990.283, "learn_throughput": 167.068, "synch_weights_time_ms": 25.273}, "counters": {"num_env_steps_sampled": 388776, "num_env_steps_trained": 388776, "num_agent_steps_sampled": 1555104, "num_agent_steps_trained": 1555104}, "done": false, "training_iteration": 97, "trial_id": "7f713_00000", "date": "2024-08-23_10-30-23", "timestamp": 1724389223, "time_this_iter_s": 25.811163187026978, "time_total_s": 2619.4369010925293, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1737a2670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2619.4369010925293, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 36.5, "ram_util_percent": 80.3783783783784}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 81.85632137848587, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.463049686270416, "policy_loss": -0.006736821808886749, "vf_loss": 5.468353966808824, "vf_explained_var": 0.6528679959988468, "kl": 0.00716279431876958, "entropy": 0.8198866615219722, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 92138.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.64919362572766, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 4.7664268917507595, "policy_loss": -0.012865584466523841, "vf_loss": 4.778690383547828, "vf_explained_var": 0.46185819654868393, "kl": 0.012041867354628507, "entropy": 0.4050262494692727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 92138.0, "diff_num_grad_updates_vs_sampler_policy": 472.0}}, "num_env_steps_sampled": 392784, "num_env_steps_trained": 392784, "num_agent_steps_sampled": 1571136, "num_agent_steps_trained": 1571136}, "env_runners": {"episode_reward_max": 822.5101237644278, "episode_reward_min": 4.079390533664585, "episode_reward_mean": 297.8994392555158, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1015.4457063847198, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 948.8651693117733}, "policy_reward_mean": {"prey_policy": -141.2890558165887, "predator_policy": 290.2387754443466}, "custom_metrics": {}, "hist_stats": {"episode_reward": [364.7000000000013, 78.8286372643206, 298.99999999999994, 91.92421368764181, 255.84430424089663, 358.6000000000013, 360.0392165750034, 748.7692516311904, 210.20123920301356, 305.04751084793907, 264.84191598411326, 420.4000000000025, 79.50000000000017, 379.3989157753646, 411.5000000000023, 394.04233460173765, 304.4583562494206, 729.5246313685401, 443.9616238527655, 538.8874242576004, 47.70000000000041, 335.2837383409214, 23.700000000000063, 166.1813719633956, 55.056999928592866, 369.04061251469915, 49.44874610268181, 151.2999999999999, 134.24488390889545, 78.79362394896532, 51.35036584999923, 596.4216757620896, 81.77611812479674, 214.99424019868346, 373.93783238730276, 415.94261418363686, 38.9000000000003, 640.5471292801486, 233.38193762832404, 290.3163754129023, 623.3449723176748, 81.99657194883962, 388.52672525318656, 442.06666864384863, 511.2817510296461, 427.9195629808058, 265.5304580060335, 583.0450004264899, 198.51021773532472, 196.39726085230035, 376.51379997305514, 255.3931963225517, 392.532668812982, 106.72126552298654, 97.42078847033463, 162.99614711437866, 317.1753061792633, 79.70281356687771, 410.27640329159885, 37.100000000000186, 90.2381918349871, 421.13469079515016, 225.89787461251302, 386.3788659456347, 425.5179255718409, 623.6091761423522, 485.19999999999993, 270.9357249973432, 13.78733493169347, 59.400000000000574, 732.8597309430419, 143.39018801313756, 182.49999999999955, 75.21823688517027, 293.7815197031959, 44.41400789522243, 336.0999999999999, 73.84650894229081, 593.566346448567, 438.3000000000028, 279.4104424962534, 4.079390533664585, 413.5311572059359, 403.90000000000214, 310.2818188547113, 483.040206295397, 79.19999999999978, 162.5233962361732, 42.385383132816735, 430.8305515174454, 164.6121227095757, 719.3, 200.42250777610835, 261.6217778170477, 270.6531054477504, 507.7819564789738, 325.64353169001106, 166.60063580033935, 822.5101237644278, 483.30007460903687], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-96.31489162516624, 278.2010799513029, -53.28439234917475, -269.6888647792298, -18.184280750266055, 74.41084801612811, -89.25347698879969, 33.78273403719841, 177.83134094385608, -679.2265492962449, 285.3839867070403, -172.36796557114948, 43.44683060942923, -89.43775750040572, -259.31716269172506, 376.0579520302023, -49.525420963023045, -762.3946521349659, 160.58257307577492, -367.7459037565374, 140.5955878765444, -454.89400277712116, 381.1, 32.438686600489476, -33.20054851856679, -467.09270456081777, -571.2819963023204, 265.2343014714023, 32.54637045806415, 356.42207534918793, 256.3285386017303, 33.33031218006205, -472.1554862609876, -313.2030534015554, 325.5363126282745, 129.04057908753103, -451.281525057918, 227.1455440164121, 174.97499500636258, -551.08668903136, -254.4062939455331, -134.59559195784865, 197.23060652780345, 22.84281383458671, -364.2563414539481, -508.03790637949993, 22.42651534158678, -370.808020532488, -47.489686322290694, -252.80823902128083, 258.06846430031567, -147.53850961221278, -87.4095786830135, -711.831412027964, -463.40534500282797, -323.6488050300519, -23.0737936193256, -556.4610883458009, -28.78635646689878, -609.1968144654854, -619.9854578179386, -126.19503422900435, 370.72012351974195, -193.05406176005363, -28.536969550920496, -270.1917356068597, -307.68428907966637, 58.01898834282487, -396.4962730161112, -190.80807804531594, 26.264849382610198, 205.66183730490542, -15.45874599950781, -508.0674569173962, 241.06054130601444, 228.0586875601521, -175.7291079865533, -373.8942989265103, -111.82552512875074, 187.80706811829398, -15.70362769683473, 120.56286778206467, -408.22391024809644, -138.55820701757187, 37.86022985309584, 259.9860846640472, 395.5, -14.69597722895124, -582.4932679486889, 92.51042278226399, -307.2738271858617, 178.60045873983788, 52.92500237993298, -185.89157330355346, -69.33894768959806, -720.2788747110861, -320.6937451878256, -306.9145552958188, -190.8447016606458, -118.7856936319289, -365.3436333660893, 354.297448102932, -213.23711595150905, -66.29559613089359, 186.1467225502996, -181.11402269637628, -260.12129863309315, -599.3016966014251, -21.449340914339096, -433.9755627468316, -709.0307811223447, -3.732171217841288, 91.77249412050574, -659.8267620811864, -47.80262717803734, -736.3716360113747, -76.22490199817707, -635.3231758028415, -614.2960372059855, -93.48894924793171, 34.550611662733026, -483.50696008024494, -724.5904065097367, 129.26780184826123, -354.6179420380256, -263.49708940826144, -513.688646856601, 251.21636510219406, -655.8305712425829, -93.052706550574, 197.52272462320406, 208.07268734681577, 339.3748967755138, -155.73726853135992, 9.189726966229273, -446.76684552363696, -619.7101796971048, -186.5735983367049, -152.72964801950084, -118.90379111310949, -467.30678599906867, 383.356953906848, -226.9937831870472, -118.23056773234754, -225.85928037359548, 28.941977340709816, -574.5015674134943, -333.8073733626637, -184.52880359760076, 105.38965363553822, -416.44285971914746, -128.33422672125855, -311.2014285060216, -129.16431137904846, -509.391491634672, -16.746641760792734, -200.86493561871833, 279.26380851862456, 400.0, 23.278780610319068, 4.515082076451872, -398.40488795378917, -493.17790415438236, -72.41518652557086, 236.5655706447316, -370.63899370628536, 358.33950146130564, -52.70673946743954, -23.856930101836465, -104.0851552768678, 390.1712227128368, -29.796508382548375, 35.25105200472776, 36.39236378496922, -7.052669898690315, -354.69329020348147, -598.3303631832259, -408.4113226633433, 141.9977773115786, -175.56436568381946, -295.9995779002267, -414.4978052652376, 196.96508384947802, 400.0, -281.4616629237924, -770.4674699441384, -129.9236203845415, -282.56771088247893, -268.0781996975724, -24.900752487762873, 152.00299369127862, -646.5135817404957, -102.84227766354303, -83.31112941146853, 73.78919908135394, -617.4946162410861, -1015.4457063847198, 240.57790826781292, -0.053802566243445316, -131.9954811334211], "policy_predator_policy_reward": [130.51489162516458, 52.29892004869715, 319.0246642139009, 82.77723017882715, 54.58428075026657, 188.1891519838718, 28.192472333287512, 119.20248430595515, 74.58361184667046, 682.6559007466159, 48.41601329295974, 197.16796557114807, 8.078552763778719, 397.9515907022005, 350.98253097784476, 281.0459313148687, 400.36423441571293, 621.7570778852886, 127.52561148621635, 384.6852300424883, 83.39953616229585, 495.7407947223955, 0.0, 6.861313399510711, 67.40054851856705, 512.3927045608178, 139.7206991094585, 545.7259114968231, 6.853629541936035, 15.677924650812063, 52.77957031038073, 51.603913509562744, 283.5549916315797, 806.261904280386, 151.25706865825734, 123.69067099447729, 525.8556481093624, 142.24195678490906, 449.4154493546013, 465.58366892799705, 276.1062939455375, 160.5955919578472, 103.06939347219642, 12.140924506333976, 375.85634145394994, 520.1379063795002, 176.5647743189375, 337.9981028353636, 347.0401963505564, 8.31472892160783, 78.47214821438209, 180.03850961221093, 124.85832478569324, 723.8314120279637, 479.4053450028284, 458.94880503005214, 146.99791560717128, 566.7818502668515, 90.68556069882546, 626.0912341825234, 592.5298149746075, 205.0010429223323, 117.84143504852044, 300.9141789538806, 98.16567709003206, 282.33914619255137, 328.2462109607746, 136.41332997475766, 804.3415033499832, 156.90068009874526, 92.28350702531189, 91.73242047080718, 50.07486252302509, 512.3513403938802, 84.81013151895351, 86.61776889502839, 337.5528640819294, 445.4524804594584, 190.13341693916948, 24.20141548418787, 286.89000434785027, 231.595727884595, 128.07646996211767, 500.7022192523909, 56.08379057927144, 34.5966201567703, 50.99597722895173, 10.266668643845719, 590.7863915729355, 410.4782046231365, 323.44091034754206, 233.1520210792896, 172.2262641440825, 226.2707647855706, 669.7695852871143, 702.8932375400628, 487.1375561890685, 338.98096202990183, 360.4628565646913, 145.56479958018318, 382.0436333660931, 5.5163518701210945, 240.8872686614396, 294.0386397435153, 187.2343972235491, 200.26557173550586, 363.521298633094, 602.6229621244125, 110.1414199515101, 442.7042721799998, 725.6176769127596, 150.14142254180544, 669.0671847064996, 216.16238943344263, 131.39640788216647, 732.480668874123, 536.4615847701194, 585.3628963224897, 614.8960372059856, 129.98894924792987, 43.18758017225559, 496.0069600802463, 550.2152459017437, 466.24204955487676, 529.4173309683952, 314.59557509040525, 526.3975657292967, 122.45358197074489, 565.6469463610276, 608.7542570039648, 114.16261255375157, 103.85115161858067, 31.32510322448627, 270.2372685313599, 249.745998031114, 458.7668455236397, 115.26809804605273, 704.8030149194527, 180.32964801949927, 150.70379111310768, 378.1718067227287, 438.63775631253054, 147.1305677323459, 341.4839712001853, 369.259280373596, 10.15802265929031, 556.3081022985484, 427.21907536278684, 223.61905876131544, 149.3016109039414, 431.58914428279684, 157.6019500528304, 339.76832552135335, 436.6974143637165, 537.8198447183308, 62.16479761942569, 405.5649356187187, 109.60253792994253, 0.0, 15.021219389680963, 286.1119149339641, 387.1883334396258, 24.352484796514112, 545.3199964171038, 173.95716899701304, 373.6474112704774, 12.26049853869437, 86.00673946743845, 369.4304943587228, 68.79340987469304, 61.40760031854993, 61.25789164655519, 4.248947995272475, 3.307636215031028, 153.4503530189137, 370.8190033194366, 626.2372350140653, 422.8898339653239, 113.93277420586656, 350.46436568382035, 293.51357480628945, 581.5959310687533, 120.58223133612267, 1.7526848143992413, 460.5268831006975, 791.8247575433453, 299.57576523423904, 374.53734384983073, 356.9032479086938, 206.72880972439188, 380.6203020577172, 621.6722424704732, 40.68561664039131, 471.11132212462957, 174.25174257082736, 536.0543103892461, 948.8651693117733, 648.5127525695534, 330.6877989528734, 284.6615593558245]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.784659377784012, "mean_inference_ms": 7.040730753860666, "mean_action_processing_ms": 2.386940960881349, "mean_env_wait_ms": 17.332323298366827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020436406135559082, "StateBufferConnector_ms": 0.009858131408691406, "ViewRequirementAgentConnector_ms": 0.18376576900482178}, "num_episodes": 9, "episode_return_max": 822.5101237644278, "episode_return_min": 4.079390533664585, "episode_return_mean": 297.8994392555158, "episodes_this_iter": 9}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1571136, "num_agent_steps_trained": 1571136, "num_env_steps_sampled": 392784, "num_env_steps_trained": 392784, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 152.655299825605, "num_env_steps_trained_throughput_per_sec": 152.655299825605, "timesteps_total": 392784, "num_env_steps_sampled_lifetime": 392784, "num_agent_steps_sampled_lifetime": 1571136, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1571136, "timers": {"training_iteration_time_ms": 26759.374, "restore_workers_time_ms": 0.023, "training_step_time_ms": 26758.758, "sample_time_ms": 2710.778, "learn_time_ms": 24018.462, "learn_throughput": 166.872, "synch_weights_time_ms": 24.993}, "counters": {"num_env_steps_sampled": 392784, "num_env_steps_trained": 392784, "num_agent_steps_sampled": 1571136, "num_agent_steps_trained": 1571136}, "done": false, "training_iteration": 98, "trial_id": "7f713_00000", "date": "2024-08-23_10-30-49", "timestamp": 1724389249, "time_this_iter_s": 26.333620071411133, "time_total_s": 2645.7705211639404, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17386b160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2645.7705211639404, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 38.53513513513513, "ram_util_percent": 79.71891891891892}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 57.346021134008176, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.238388090032749, "policy_loss": -0.011072306032600522, "vf_loss": 5.247424587370857, "vf_explained_var": 0.6493840310308668, "kl": 0.010179019859307028, "entropy": 0.8515704653250478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 93083.0, "diff_num_grad_updates_vs_sampler_policy": 489.68338323353964}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.524629826268193, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 4.618336572596636, "policy_loss": -0.012283056901974811, "vf_loss": 4.630102529223003, "vf_explained_var": 0.2993218879851084, "kl": 0.01034234655508525, "entropy": 0.4045779243032768, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 93083.0, "diff_num_grad_updates_vs_sampler_policy": 489.68338323353964}}, "num_env_steps_sampled": 396792, "num_env_steps_trained": 396792, "num_agent_steps_sampled": 1587168, "num_agent_steps_trained": 1587168}, "env_runners": {"episode_reward_max": 822.5101237644278, "episode_reward_min": 4.079390533664585, "episode_reward_mean": 309.2154547745851, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1015.4457063847198, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 948.8651693117733}, "policy_reward_mean": {"prey_policy": -149.93556987760255, "predator_policy": 304.543297264895}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.20123920301356, 305.04751084793907, 264.84191598411326, 420.4000000000025, 79.50000000000017, 379.3989157753646, 411.5000000000023, 394.04233460173765, 304.4583562494206, 729.5246313685401, 443.9616238527655, 538.8874242576004, 47.70000000000041, 335.2837383409214, 23.700000000000063, 166.1813719633956, 55.056999928592866, 369.04061251469915, 49.44874610268181, 151.2999999999999, 134.24488390889545, 78.79362394896532, 51.35036584999923, 596.4216757620896, 81.77611812479674, 214.99424019868346, 373.93783238730276, 415.94261418363686, 38.9000000000003, 640.5471292801486, 233.38193762832404, 290.3163754129023, 623.3449723176748, 81.99657194883962, 388.52672525318656, 442.06666864384863, 511.2817510296461, 427.9195629808058, 265.5304580060335, 583.0450004264899, 198.51021773532472, 196.39726085230035, 376.51379997305514, 255.3931963225517, 392.532668812982, 106.72126552298654, 97.42078847033463, 162.99614711437866, 317.1753061792633, 79.70281356687771, 410.27640329159885, 37.100000000000186, 90.2381918349871, 421.13469079515016, 225.89787461251302, 386.3788659456347, 425.5179255718409, 623.6091761423522, 485.19999999999993, 270.9357249973432, 13.78733493169347, 59.400000000000574, 732.8597309430419, 143.39018801313756, 182.49999999999955, 75.21823688517027, 293.7815197031959, 44.41400789522243, 336.0999999999999, 73.84650894229081, 593.566346448567, 438.3000000000028, 279.4104424962534, 4.079390533664585, 413.5311572059359, 403.90000000000214, 310.2818188547113, 483.040206295397, 79.19999999999978, 162.5233962361732, 42.385383132816735, 430.8305515174454, 164.6121227095757, 719.3, 200.42250777610835, 261.6217778170477, 270.6531054477504, 507.7819564789738, 325.64353169001106, 166.60063580033935, 822.5101237644278, 483.30007460903687, 415.36869636093445, 517.4984744305266, 617.5628670649866, 364.1852448320856, 329.3386780180999, 358.42464661466886, 534.9602593652918, 551.9683086193855], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [-49.525420963023045, -762.3946521349659, 160.58257307577492, -367.7459037565374, 140.5955878765444, -454.89400277712116, 381.1, 32.438686600489476, -33.20054851856679, -467.09270456081777, -571.2819963023204, 265.2343014714023, 32.54637045806415, 356.42207534918793, 256.3285386017303, 33.33031218006205, -472.1554862609876, -313.2030534015554, 325.5363126282745, 129.04057908753103, -451.281525057918, 227.1455440164121, 174.97499500636258, -551.08668903136, -254.4062939455331, -134.59559195784865, 197.23060652780345, 22.84281383458671, -364.2563414539481, -508.03790637949993, 22.42651534158678, -370.808020532488, -47.489686322290694, -252.80823902128083, 258.06846430031567, -147.53850961221278, -87.4095786830135, -711.831412027964, -463.40534500282797, -323.6488050300519, -23.0737936193256, -556.4610883458009, -28.78635646689878, -609.1968144654854, -619.9854578179386, -126.19503422900435, 370.72012351974195, -193.05406176005363, -28.536969550920496, -270.1917356068597, -307.68428907966637, 58.01898834282487, -396.4962730161112, -190.80807804531594, 26.264849382610198, 205.66183730490542, -15.45874599950781, -508.0674569173962, 241.06054130601444, 228.0586875601521, -175.7291079865533, -373.8942989265103, -111.82552512875074, 187.80706811829398, -15.70362769683473, 120.56286778206467, -408.22391024809644, -138.55820701757187, 37.86022985309584, 259.9860846640472, 395.5, -14.69597722895124, -582.4932679486889, 92.51042278226399, -307.2738271858617, 178.60045873983788, 52.92500237993298, -185.89157330355346, -69.33894768959806, -720.2788747110861, -320.6937451878256, -306.9145552958188, -190.8447016606458, -118.7856936319289, -365.3436333660893, 354.297448102932, -213.23711595150905, -66.29559613089359, 186.1467225502996, -181.11402269637628, -260.12129863309315, -599.3016966014251, -21.449340914339096, -433.9755627468316, -709.0307811223447, -3.732171217841288, 91.77249412050574, -659.8267620811864, -47.80262717803734, -736.3716360113747, -76.22490199817707, -635.3231758028415, -614.2960372059855, -93.48894924793171, 34.550611662733026, -483.50696008024494, -724.5904065097367, 129.26780184826123, -354.6179420380256, -263.49708940826144, -513.688646856601, 251.21636510219406, -655.8305712425829, -93.052706550574, 197.52272462320406, 208.07268734681577, 339.3748967755138, -155.73726853135992, 9.189726966229273, -446.76684552363696, -619.7101796971048, -186.5735983367049, -152.72964801950084, -118.90379111310949, -467.30678599906867, 383.356953906848, -226.9937831870472, -118.23056773234754, -225.85928037359548, 28.941977340709816, -574.5015674134943, -333.8073733626637, -184.52880359760076, 105.38965363553822, -416.44285971914746, -128.33422672125855, -311.2014285060216, -129.16431137904846, -509.391491634672, -16.746641760792734, -200.86493561871833, 279.26380851862456, 400.0, 23.278780610319068, 4.515082076451872, -398.40488795378917, -493.17790415438236, -72.41518652557086, 236.5655706447316, -370.63899370628536, 358.33950146130564, -52.70673946743954, -23.856930101836465, -104.0851552768678, 390.1712227128368, -29.796508382548375, 35.25105200472776, 36.39236378496922, -7.052669898690315, -354.69329020348147, -598.3303631832259, -408.4113226633433, 141.9977773115786, -175.56436568381946, -295.9995779002267, -414.4978052652376, 196.96508384947802, 400.0, -281.4616629237924, -770.4674699441384, -129.9236203845415, -282.56771088247893, -268.0781996975724, -24.900752487762873, 152.00299369127862, -646.5135817404957, -102.84227766354303, -83.31112941146853, 73.78919908135394, -617.4946162410861, -1015.4457063847198, 240.57790826781292, -0.053802566243445316, -131.9954811334211, 24.065380432687814, -815.2488790612335, -486.105923088721, 194.34032877013613, 4.751032120578628, 232.63213565789079, 283.3875756030012, -529.6265426191052, -327.7838146711927, -31.524794858838817, -128.90954707197437, -726.2630318631739, 202.4134925172282, -449.50703652403945, 198.93246711408966, 167.18377608289424], "policy_predator_policy_reward": [400.36423441571293, 621.7570778852886, 127.52561148621635, 384.6852300424883, 83.39953616229585, 495.7407947223955, 0.0, 6.861313399510711, 67.40054851856705, 512.3927045608178, 139.7206991094585, 545.7259114968231, 6.853629541936035, 15.677924650812063, 52.77957031038073, 51.603913509562744, 283.5549916315797, 806.261904280386, 151.25706865825734, 123.69067099447729, 525.8556481093624, 142.24195678490906, 449.4154493546013, 465.58366892799705, 276.1062939455375, 160.5955919578472, 103.06939347219642, 12.140924506333976, 375.85634145394994, 520.1379063795002, 176.5647743189375, 337.9981028353636, 347.0401963505564, 8.31472892160783, 78.47214821438209, 180.03850961221093, 124.85832478569324, 723.8314120279637, 479.4053450028284, 458.94880503005214, 146.99791560717128, 566.7818502668515, 90.68556069882546, 626.0912341825234, 592.5298149746075, 205.0010429223323, 117.84143504852044, 300.9141789538806, 98.16567709003206, 282.33914619255137, 328.2462109607746, 136.41332997475766, 804.3415033499832, 156.90068009874526, 92.28350702531189, 91.73242047080718, 50.07486252302509, 512.3513403938802, 84.81013151895351, 86.61776889502839, 337.5528640819294, 445.4524804594584, 190.13341693916948, 24.20141548418787, 286.89000434785027, 231.595727884595, 128.07646996211767, 500.7022192523909, 56.08379057927144, 34.5966201567703, 50.99597722895173, 10.266668643845719, 590.7863915729355, 410.4782046231365, 323.44091034754206, 233.1520210792896, 172.2262641440825, 226.2707647855706, 669.7695852871143, 702.8932375400628, 487.1375561890685, 338.98096202990183, 360.4628565646913, 145.56479958018318, 382.0436333660931, 5.5163518701210945, 240.8872686614396, 294.0386397435153, 187.2343972235491, 200.26557173550586, 363.521298633094, 602.6229621244125, 110.1414199515101, 442.7042721799998, 725.6176769127596, 150.14142254180544, 669.0671847064996, 216.16238943344263, 131.39640788216647, 732.480668874123, 536.4615847701194, 585.3628963224897, 614.8960372059856, 129.98894924792987, 43.18758017225559, 496.0069600802463, 550.2152459017437, 466.24204955487676, 529.4173309683952, 314.59557509040525, 526.3975657292967, 122.45358197074489, 565.6469463610276, 608.7542570039648, 114.16261255375157, 103.85115161858067, 31.32510322448627, 270.2372685313599, 249.745998031114, 458.7668455236397, 115.26809804605273, 704.8030149194527, 180.32964801949927, 150.70379111310768, 378.1718067227287, 438.63775631253054, 147.1305677323459, 341.4839712001853, 369.259280373596, 10.15802265929031, 556.3081022985484, 427.21907536278684, 223.61905876131544, 149.3016109039414, 431.58914428279684, 157.6019500528304, 339.76832552135335, 436.6974143637165, 537.8198447183308, 62.16479761942569, 405.5649356187187, 109.60253792994253, 0.0, 15.021219389680963, 286.1119149339641, 387.1883334396258, 24.352484796514112, 545.3199964171038, 173.95716899701304, 373.6474112704774, 12.26049853869437, 86.00673946743845, 369.4304943587228, 68.79340987469304, 61.40760031854993, 61.25789164655519, 4.248947995272475, 3.307636215031028, 153.4503530189137, 370.8190033194366, 626.2372350140653, 422.8898339653239, 113.93277420586656, 350.46436568382035, 293.51357480628945, 581.5959310687533, 120.58223133612267, 1.7526848143992413, 460.5268831006975, 791.8247575433453, 299.57576523423904, 374.53734384983073, 356.9032479086938, 206.72880972439188, 380.6203020577172, 621.6722424704732, 40.68561664039131, 471.11132212462957, 174.25174257082736, 536.0543103892461, 948.8651693117733, 648.5127525695534, 330.6877989528734, 284.6615593558245, 433.9771295264432, 772.5750654630328, 314.2363535266608, 495.02771522245047, 239.23096172176932, 140.9487375647478, 528.6387988545941, 81.7854129935954, 506.25119411460383, 182.39609343352828, 523.3030876792059, 690.2941378706081, 530.4100640502917, 251.6437393218131, 0.0, 185.85206542240152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.77944191638385, "mean_inference_ms": 7.041610781141242, "mean_action_processing_ms": 2.3848698663097756, "mean_env_wait_ms": 17.330096273367932, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02028024196624756, "StateBufferConnector_ms": 0.01074683666229248, "ViewRequirementAgentConnector_ms": 0.18067145347595215}, "num_episodes": 8, "episode_return_max": 822.5101237644278, "episode_return_min": 4.079390533664585, "episode_return_mean": 309.2154547745851, "episodes_this_iter": 8}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1587168, "num_agent_steps_trained": 1587168, "num_env_steps_sampled": 396792, "num_env_steps_trained": 396792, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 150.40460009057324, "num_env_steps_trained_throughput_per_sec": 150.40460009057324, "timesteps_total": 396792, "num_env_steps_sampled_lifetime": 396792, "num_agent_steps_sampled_lifetime": 1587168, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1587168, "timers": {"training_iteration_time_ms": 26556.131, "restore_workers_time_ms": 0.025, "training_step_time_ms": 26555.51, "sample_time_ms": 2551.14, "learn_time_ms": 23975.072, "learn_throughput": 167.174, "synch_weights_time_ms": 24.743}, "counters": {"num_env_steps_sampled": 396792, "num_env_steps_trained": 396792, "num_agent_steps_sampled": 1587168, "num_agent_steps_trained": 1587168}, "done": false, "training_iteration": 99, "trial_id": "7f713_00000", "date": "2024-08-23_10-31-16", "timestamp": 1724389276, "time_this_iter_s": 26.689311027526855, "time_total_s": 2672.4598321914673, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x17382e700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2672.4598321914673, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 45.7078947368421, "ram_util_percent": 80.06052631578949}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"prey_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 65.57081992739722, "cur_kl_coeff": 0.2, "cur_lr": 0.00010000000000000003, "total_loss": 5.067909087832012, "policy_loss": -0.009487809554708225, "vf_loss": 5.075382376221753, "vf_explained_var": 0.6372058784520185, "kl": 0.010072670898907793, "entropy": 0.8125468918886134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 94028.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}, "predator_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.782759659378616, "cur_kl_coeff": 0.05, "cur_lr": 0.00010000000000000003, "total_loss": 4.637398367331772, "policy_loss": -0.015041775210814737, "vf_loss": 4.6519245685092985, "vf_explained_var": 0.42470681528565746, "kl": 0.010311523478763997, "entropy": 0.3832209296012051, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.23809523809524, "num_grad_updates_lifetime": 94028.0, "diff_num_grad_updates_vs_sampler_policy": 480.7238023952086}}, "num_env_steps_sampled": 400800, "num_env_steps_trained": 400800, "num_agent_steps_sampled": 1603200, "num_agent_steps_trained": 1603200}, "env_runners": {"episode_reward_max": 822.5101237644278, "episode_reward_min": 4.079390533664585, "episode_reward_mean": 313.3337306986702, "episode_len_mean": 400.0, "episode_media": {}, "episodes_timesteps_total": 40000, "policy_reward_min": {"prey_policy": -1015.4457063847198, "predator_policy": 0.0}, "policy_reward_max": {"prey_policy": 400.0, "predator_policy": 948.8651693117733}, "policy_reward_mean": {"prey_policy": -146.0880762637742, "predator_policy": 302.7549416131093}, "custom_metrics": {}, "hist_stats": {"episode_reward": [394.04233460173765, 304.4583562494206, 729.5246313685401, 443.9616238527655, 538.8874242576004, 47.70000000000041, 335.2837383409214, 23.700000000000063, 166.1813719633956, 55.056999928592866, 369.04061251469915, 49.44874610268181, 151.2999999999999, 134.24488390889545, 78.79362394896532, 51.35036584999923, 596.4216757620896, 81.77611812479674, 214.99424019868346, 373.93783238730276, 415.94261418363686, 38.9000000000003, 640.5471292801486, 233.38193762832404, 290.3163754129023, 623.3449723176748, 81.99657194883962, 388.52672525318656, 442.06666864384863, 511.2817510296461, 427.9195629808058, 265.5304580060335, 583.0450004264899, 198.51021773532472, 196.39726085230035, 376.51379997305514, 255.3931963225517, 392.532668812982, 106.72126552298654, 97.42078847033463, 162.99614711437866, 317.1753061792633, 79.70281356687771, 410.27640329159885, 37.100000000000186, 90.2381918349871, 421.13469079515016, 225.89787461251302, 386.3788659456347, 425.5179255718409, 623.6091761423522, 485.19999999999993, 270.9357249973432, 13.78733493169347, 59.400000000000574, 732.8597309430419, 143.39018801313756, 182.49999999999955, 75.21823688517027, 293.7815197031959, 44.41400789522243, 336.0999999999999, 73.84650894229081, 593.566346448567, 438.3000000000028, 279.4104424962534, 4.079390533664585, 413.5311572059359, 403.90000000000214, 310.2818188547113, 483.040206295397, 79.19999999999978, 162.5233962361732, 42.385383132816735, 430.8305515174454, 164.6121227095757, 719.3, 200.42250777610835, 261.6217778170477, 270.6531054477504, 507.7819564789738, 325.64353169001106, 166.60063580033935, 822.5101237644278, 483.30007460903687, 415.36869636093445, 517.4984744305266, 617.5628670649866, 364.1852448320856, 329.3386780180999, 358.42464661466886, 534.9602593652918, 551.9683086193855, 620.5641754647205, 269.77705580750614, 135.83135921141982, 491.9, 70.10000000000029, 188.69999999999942, 705.8445837352981], "episode_lengths": [400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400, 400], "policy_prey_policy_reward": [256.3285386017303, 33.33031218006205, -472.1554862609876, -313.2030534015554, 325.5363126282745, 129.04057908753103, -451.281525057918, 227.1455440164121, 174.97499500636258, -551.08668903136, -254.4062939455331, -134.59559195784865, 197.23060652780345, 22.84281383458671, -364.2563414539481, -508.03790637949993, 22.42651534158678, -370.808020532488, -47.489686322290694, -252.80823902128083, 258.06846430031567, -147.53850961221278, -87.4095786830135, -711.831412027964, -463.40534500282797, -323.6488050300519, -23.0737936193256, -556.4610883458009, -28.78635646689878, -609.1968144654854, -619.9854578179386, -126.19503422900435, 370.72012351974195, -193.05406176005363, -28.536969550920496, -270.1917356068597, -307.68428907966637, 58.01898834282487, -396.4962730161112, -190.80807804531594, 26.264849382610198, 205.66183730490542, -15.45874599950781, -508.0674569173962, 241.06054130601444, 228.0586875601521, -175.7291079865533, -373.8942989265103, -111.82552512875074, 187.80706811829398, -15.70362769683473, 120.56286778206467, -408.22391024809644, -138.55820701757187, 37.86022985309584, 259.9860846640472, 395.5, -14.69597722895124, -582.4932679486889, 92.51042278226399, -307.2738271858617, 178.60045873983788, 52.92500237993298, -185.89157330355346, -69.33894768959806, -720.2788747110861, -320.6937451878256, -306.9145552958188, -190.8447016606458, -118.7856936319289, -365.3436333660893, 354.297448102932, -213.23711595150905, -66.29559613089359, 186.1467225502996, -181.11402269637628, -260.12129863309315, -599.3016966014251, -21.449340914339096, -433.9755627468316, -709.0307811223447, -3.732171217841288, 91.77249412050574, -659.8267620811864, -47.80262717803734, -736.3716360113747, -76.22490199817707, -635.3231758028415, -614.2960372059855, -93.48894924793171, 34.550611662733026, -483.50696008024494, -724.5904065097367, 129.26780184826123, -354.6179420380256, -263.49708940826144, -513.688646856601, 251.21636510219406, -655.8305712425829, -93.052706550574, 197.52272462320406, 208.07268734681577, 339.3748967755138, -155.73726853135992, 9.189726966229273, -446.76684552363696, -619.7101796971048, -186.5735983367049, -152.72964801950084, -118.90379111310949, -467.30678599906867, 383.356953906848, -226.9937831870472, -118.23056773234754, -225.85928037359548, 28.941977340709816, -574.5015674134943, -333.8073733626637, -184.52880359760076, 105.38965363553822, -416.44285971914746, -128.33422672125855, -311.2014285060216, -129.16431137904846, -509.391491634672, -16.746641760792734, -200.86493561871833, 279.26380851862456, 400.0, 23.278780610319068, 4.515082076451872, -398.40488795378917, -493.17790415438236, -72.41518652557086, 236.5655706447316, -370.63899370628536, 358.33950146130564, -52.70673946743954, -23.856930101836465, -104.0851552768678, 390.1712227128368, -29.796508382548375, 35.25105200472776, 36.39236378496922, -7.052669898690315, -354.69329020348147, -598.3303631832259, -408.4113226633433, 141.9977773115786, -175.56436568381946, -295.9995779002267, -414.4978052652376, 196.96508384947802, 400.0, -281.4616629237924, -770.4674699441384, -129.9236203845415, -282.56771088247893, -268.0781996975724, -24.900752487762873, 152.00299369127862, -646.5135817404957, -102.84227766354303, -83.31112941146853, 73.78919908135394, -617.4946162410861, -1015.4457063847198, 240.57790826781292, -0.053802566243445316, -131.9954811334211, 24.065380432687814, -815.2488790612335, -486.105923088721, 194.34032877013613, 4.751032120578628, 232.63213565789079, 283.3875756030012, -529.6265426191052, -327.7838146711927, -31.524794858838817, -128.90954707197437, -726.2630318631739, 202.4134925172282, -449.50703652403945, 198.93246711408966, 167.18377608289424, -152.87119239930973, 268.985774070231, -395.66057141916906, -263.2579451363251, -146.54435705803624, -268.07837419558354, 101.84624248503917, 23.13702765053452, 40.0000000000003, -107.37827059362559, -156.49344472531703, -96.04995332800623, 383.09944862144994, 201.5487046118918], "policy_predator_policy_reward": [52.77957031038073, 51.603913509562744, 283.5549916315797, 806.261904280386, 151.25706865825734, 123.69067099447729, 525.8556481093624, 142.24195678490906, 449.4154493546013, 465.58366892799705, 276.1062939455375, 160.5955919578472, 103.06939347219642, 12.140924506333976, 375.85634145394994, 520.1379063795002, 176.5647743189375, 337.9981028353636, 347.0401963505564, 8.31472892160783, 78.47214821438209, 180.03850961221093, 124.85832478569324, 723.8314120279637, 479.4053450028284, 458.94880503005214, 146.99791560717128, 566.7818502668515, 90.68556069882546, 626.0912341825234, 592.5298149746075, 205.0010429223323, 117.84143504852044, 300.9141789538806, 98.16567709003206, 282.33914619255137, 328.2462109607746, 136.41332997475766, 804.3415033499832, 156.90068009874526, 92.28350702531189, 91.73242047080718, 50.07486252302509, 512.3513403938802, 84.81013151895351, 86.61776889502839, 337.5528640819294, 445.4524804594584, 190.13341693916948, 24.20141548418787, 286.89000434785027, 231.595727884595, 128.07646996211767, 500.7022192523909, 56.08379057927144, 34.5966201567703, 50.99597722895173, 10.266668643845719, 590.7863915729355, 410.4782046231365, 323.44091034754206, 233.1520210792896, 172.2262641440825, 226.2707647855706, 669.7695852871143, 702.8932375400628, 487.1375561890685, 338.98096202990183, 360.4628565646913, 145.56479958018318, 382.0436333660931, 5.5163518701210945, 240.8872686614396, 294.0386397435153, 187.2343972235491, 200.26557173550586, 363.521298633094, 602.6229621244125, 110.1414199515101, 442.7042721799998, 725.6176769127596, 150.14142254180544, 669.0671847064996, 216.16238943344263, 131.39640788216647, 732.480668874123, 536.4615847701194, 585.3628963224897, 614.8960372059856, 129.98894924792987, 43.18758017225559, 496.0069600802463, 550.2152459017437, 466.24204955487676, 529.4173309683952, 314.59557509040525, 526.3975657292967, 122.45358197074489, 565.6469463610276, 608.7542570039648, 114.16261255375157, 103.85115161858067, 31.32510322448627, 270.2372685313599, 249.745998031114, 458.7668455236397, 115.26809804605273, 704.8030149194527, 180.32964801949927, 150.70379111310768, 378.1718067227287, 438.63775631253054, 147.1305677323459, 341.4839712001853, 369.259280373596, 10.15802265929031, 556.3081022985484, 427.21907536278684, 223.61905876131544, 149.3016109039414, 431.58914428279684, 157.6019500528304, 339.76832552135335, 436.6974143637165, 537.8198447183308, 62.16479761942569, 405.5649356187187, 109.60253792994253, 0.0, 15.021219389680963, 286.1119149339641, 387.1883334396258, 24.352484796514112, 545.3199964171038, 173.95716899701304, 373.6474112704774, 12.26049853869437, 86.00673946743845, 369.4304943587228, 68.79340987469304, 61.40760031854993, 61.25789164655519, 4.248947995272475, 3.307636215031028, 153.4503530189137, 370.8190033194366, 626.2372350140653, 422.8898339653239, 113.93277420586656, 350.46436568382035, 293.51357480628945, 581.5959310687533, 120.58223133612267, 1.7526848143992413, 460.5268831006975, 791.8247575433453, 299.57576523423904, 374.53734384983073, 356.9032479086938, 206.72880972439188, 380.6203020577172, 621.6722424704732, 40.68561664039131, 471.11132212462957, 174.25174257082736, 536.0543103892461, 948.8651693117733, 648.5127525695534, 330.6877989528734, 284.6615593558245, 433.9771295264432, 772.5750654630328, 314.2363535266608, 495.02771522245047, 239.23096172176932, 140.9487375647478, 528.6387988545941, 81.7854129935954, 506.25119411460383, 182.39609343352828, 523.3030876792059, 690.2941378706081, 530.4100640502917, 251.6437393218131, 0.0, 185.85206542240152, 293.76579138596486, 210.68380240783458, 265.02021879362155, 663.675353569379, 205.64443277126784, 344.8096576937707, 168.4537575149607, 198.4629723494654, 0.0, 137.47827059362388, 316.8934447253177, 124.34995332800464, 12.982182919030862, 108.21424758292544]}, "sampler_perf": {"mean_raw_obs_processing_ms": 8.749477981209951, "mean_inference_ms": 7.014702651538628, "mean_action_processing_ms": 2.3721528333756656, "mean_env_wait_ms": 17.306686033439334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021106719970703125, "StateBufferConnector_ms": 0.010558605194091797, "ViewRequirementAgentConnector_ms": 0.17910289764404297}, "num_episodes": 7, "episode_return_max": 822.5101237644278, "episode_return_min": 4.079390533664585, "episode_return_mean": 313.3337306986702, "episodes_this_iter": 7}, "num_healthy_workers": 9, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1603200, "num_agent_steps_trained": 1603200, "num_env_steps_sampled": 400800, "num_env_steps_trained": 400800, "num_env_steps_sampled_this_iter": 4008, "num_env_steps_trained_this_iter": 4008, "num_env_steps_sampled_throughput_per_sec": 152.47115188907227, "num_env_steps_trained_throughput_per_sec": 152.47115188907227, "timesteps_total": 400800, "num_env_steps_sampled_lifetime": 400800, "num_agent_steps_sampled_lifetime": 1603200, "num_steps_trained_this_iter": 4008, "agent_timesteps_total": 1603200, "timers": {"training_iteration_time_ms": 26304.129, "restore_workers_time_ms": 0.026, "training_step_time_ms": 26303.637, "sample_time_ms": 2312.575, "learn_time_ms": 23961.937, "learn_throughput": 167.265, "synch_weights_time_ms": 24.91}, "counters": {"num_env_steps_sampled": 400800, "num_env_steps_trained": 400800, "num_agent_steps_sampled": 1603200, "num_agent_steps_trained": 1603200}, "done": true, "training_iteration": 100, "trial_id": "7f713_00000", "date": "2024-08-23_10-31-42", "timestamp": 1724389302, "time_this_iter_s": 26.34116291999817, "time_total_s": 2698.8009951114655, "pid": 3627, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "num_cpus_for_main_process": 1, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "custom_tag_v0", "env_config": {"prey_count": 2, "prey_speed": 1.0, "prey_view_size": 10, "prey_size": 1, "prey_color": [0, 255, 0], "prey_kill_reward": -10, "prey_alive_reward": 0.1, "prey_reward_sqr_reward": 1, "predator_count": 2, "predator_speed": 1.0, "predator_view_size": 10, "predator_size": 1, "predator_color": [255, 0, 0], "predator_kill_reward": 10, "map_size": 40, "max_steps": 400, "screen_size": 600, "render_mode": "None", "fps": 60}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": true, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_env_runners": 9, "num_envs_per_env_runner": 12, "num_cpus_per_env_runner": 1, "num_gpus_per_env_runner": 0, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": true, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "num_learners": 0, "num_gpus_per_learner": 0, "num_cpus_per_learner": 1, "local_gpu_idx": 0, "gamma": 0.99, "lr": 0.0001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": 16000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "custom_cnn", "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "learner_config_dict": {}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function get_policy_mapping_fn at 0x1738bc310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_read_method": "read_parquet", "input_read_method_kwargs": {}, "input_read_schema": {}, "map_batches_kwargs": {}, "iter_batches_kwargs": {}, "prelearner_class": null, "prelearner_module_synch_period": 10, "dataset_num_iters_per_learner": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "always_attach_evaluation_results": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 15, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "policies": {"prey_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}], "predator_policy": [null, "Box(0, 1, (10, 10, 3), uint8)", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch"}, "time_since_restore": 2698.8009951114655, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 37.62432432432432, "ram_util_percent": 80.85135135135138}}
