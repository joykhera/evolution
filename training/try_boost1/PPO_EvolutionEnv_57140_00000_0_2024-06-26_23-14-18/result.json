{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4852984377703728, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.885324550601748, "policy_loss": -0.011896886784435548, "vf_loss": 2.8953859634800585, "vf_explained_var": 0.0017347362475654189, "kl": 0.009177367898016646, "entropy": 1.6002870603618276, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 4695.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": 30.0, "episode_reward_min": -915.0, "episode_reward_mean": -385.55555555555554, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 3618, "policy_reward_min": {"policy_0": -420.0}, "policy_reward_max": {"policy_0": 20.0}, "policy_reward_mean": {"policy_0": -38.55555555555556}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-430.0, -120.0, -310.0, -745.0, 30.0, -220.0, -140.0, -150.0, -395.0, -455.0, -915.0, -285.0, -655.0, -535.0, -515.0, -230.0, -590.0, -280.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-25.0, 0.0, 0.0, -130.0, -125.0, 0.0, -25.0, 0.0, -125.0, 0.0, -105.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 5.0, -40.0, 0.0, 0.0, 10.0, -5.0, 10.0, 0.0, -335.0, 0.0, 10.0, 0.0, 0.0, 0.0, -45.0, -395.0, 10.0, -185.0, 20.0, 0.0, -60.0, 10.0, -100.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, -55.0, 0.0, 0.0, -165.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -150.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, -150.0, 0.0, -25.0, 0.0, 0.0, 10.0, -5.0, 0.0, 0.0, -60.0, -75.0, -300.0, 10.0, 10.0, 0.0, 10.0, 10.0, -145.0, 0.0, -15.0, 0.0, -35.0, -85.0, 0.0, 0.0, 0.0, -175.0, 0.0, -290.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, -225.0, -420.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -55.0, 20.0, -250.0, 0.0, 0.0, 10.0, 10.0, 0.0, -350.0, 0.0, -345.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, -85.0, 0.0, -235.0, 10.0, 0.0, -235.0, 0.0, 0.0, 0.0, 0.0, 0.0, -65.0, -315.0, 0.0, -135.0, 0.0, 0.0, 10.0, 0.0, 0.0, -260.0, 0.0, 0.0, 0.0, 20.0, 0.0, -100.0, 0.0, 10.0, -360.0, 0.0, 0.0, -50.0, -90.0, 0.0, 0.0, 0.0, 0.0, -125.0, 0.0, -110.0, 10.0, 10.0, -65.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.6003928194306405, "mean_inference_ms": 3.7138531873188563, "mean_action_processing_ms": 0.9450384850864348, "mean_env_wait_ms": 2.998630796153915, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.23411247465345594, "StateBufferConnector_ms": 0.06764729817708333, "ViewRequirementAgentConnector_ms": 1.9819140434265137}, "num_episodes": 18, "episode_return_max": 30.0, "episode_return_min": -915.0, "episode_return_mean": -385.55555555555554}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 26.72581317608063, "num_env_steps_trained_throughput_per_sec": 26.72581317608063, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 149668.047, "restore_workers_time_ms": 0.015, "training_step_time_ms": 149667.997, "sample_time_ms": 6616.142, "learn_time_ms": 143032.965, "learn_throughput": 27.966, "synch_weights_time_ms": 13.511}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 1, "trial_id": "57140_00000", "date": "2024-06-26_23-17-02", "timestamp": 1719458222, "time_this_iter_s": 149.708429813385, "time_total_s": 149.708429813385, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3b4e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 149.708429813385, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 46.39014084507041, "ram_util_percent": 81.11549295774647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7525473664648616, "cur_kl_coeff": 0.2, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0216403496960482, "policy_loss": -0.007481670978377921, "vf_loss": 1.028259147968663, "vf_explained_var": 0.007585929611874338, "kl": 0.004314364827220855, "entropy": 1.5946248665023535, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 14085.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 50.0, "episode_reward_min": -915.0, "episode_reward_mean": -226.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 7236, "policy_reward_min": {"policy_0": -420.0}, "policy_reward_max": {"policy_0": 30.0}, "policy_reward_mean": {"policy_0": -22.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-430.0, -120.0, -310.0, -745.0, 30.0, -220.0, -140.0, -150.0, -395.0, -455.0, -915.0, -285.0, -655.0, -535.0, -515.0, -230.0, -590.0, -280.0, -165.0, 10.0, -75.0, 30.0, 50.0, -70.0, -35.0, 20.0, -100.0, -30.0, 5.0, -5.0, -280.0, -45.0, -130.0, 40.0, -375.0, -50.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-25.0, 0.0, 0.0, -130.0, -125.0, 0.0, -25.0, 0.0, -125.0, 0.0, -105.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 5.0, -40.0, 0.0, 0.0, 10.0, -5.0, 10.0, 0.0, -335.0, 0.0, 10.0, 0.0, 0.0, 0.0, -45.0, -395.0, 10.0, -185.0, 20.0, 0.0, -60.0, 10.0, -100.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, -55.0, 0.0, 0.0, -165.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -150.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, -150.0, 0.0, -25.0, 0.0, 0.0, 10.0, -5.0, 0.0, 0.0, -60.0, -75.0, -300.0, 10.0, 10.0, 0.0, 10.0, 10.0, -145.0, 0.0, -15.0, 0.0, -35.0, -85.0, 0.0, 0.0, 0.0, -175.0, 0.0, -290.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, -225.0, -420.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -55.0, 20.0, -250.0, 0.0, 0.0, 10.0, 10.0, 0.0, -350.0, 0.0, -345.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, -85.0, 0.0, -235.0, 10.0, 0.0, -235.0, 0.0, 0.0, 0.0, 0.0, 0.0, -65.0, -315.0, 0.0, -135.0, 0.0, 0.0, 10.0, 0.0, 0.0, -260.0, 0.0, 0.0, 0.0, 20.0, 0.0, -100.0, 0.0, 10.0, -360.0, 0.0, 0.0, -50.0, -90.0, 0.0, 0.0, 0.0, 0.0, -125.0, 0.0, -110.0, 10.0, 10.0, -65.0, 0.0, 0.0, -130.0, -75.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -95.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, -100.0, 0.0, 10.0, 0.0, 0.0, 0.0, -45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, -110.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -30.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, -35.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -45.0, 0.0, 0.0, 0.0, -245.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 5.0, 20.0, -110.0, 10.0, 0.0, 0.0, -110.0, 10.0, -40.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, -30.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, -115.0, -25.0, -80.0, -5.0, -130.0, 20.0, -60.0, 10.0, 0.0, 10.0, 0.0, -50.0, 0.0, -30.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3978831739509188, "mean_inference_ms": 3.423414918704436, "mean_action_processing_ms": 0.8758613994095632, "mean_env_wait_ms": 2.799633674525573, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.17173422707451713, "StateBufferConnector_ms": 0.05429387092590332, "ViewRequirementAgentConnector_ms": 1.468980312347412}, "num_episodes": 18, "episode_return_max": 50.0, "episode_return_min": -915.0, "episode_return_mean": -226.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 27.310645646377587, "num_env_steps_trained_throughput_per_sec": 27.310645646377587, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 148065.545, "restore_workers_time_ms": 0.016, "training_step_time_ms": 148065.475, "sample_time_ms": 5783.209, "learn_time_ms": 142264.497, "learn_throughput": 28.117, "synch_weights_time_ms": 11.989}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 2, "trial_id": "57140_00000", "date": "2024-06-26_23-19-29", "timestamp": 1719458369, "time_this_iter_s": 146.50280499458313, "time_total_s": 296.21123480796814, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af38fee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 296.21123480796814, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 44.01346153846154, "ram_util_percent": 80.96009615384615}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6070641567627082, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.8048272452859706, "policy_loss": -0.003810777085514876, "vf_loss": 0.8077177860826666, "vf_explained_var": 0.007571974133277219, "kl": 0.009202357650375453, "entropy": 1.5820110589678422, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 23475.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "env_runners": {"episode_reward_max": 60.0, "episode_reward_min": -915.0, "episode_reward_mean": -141.94444444444446, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 10854, "policy_reward_min": {"policy_0": -420.0}, "policy_reward_max": {"policy_0": 30.0}, "policy_reward_mean": {"policy_0": -14.194444444444445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-430.0, -120.0, -310.0, -745.0, 30.0, -220.0, -140.0, -150.0, -395.0, -455.0, -915.0, -285.0, -655.0, -535.0, -515.0, -230.0, -590.0, -280.0, -165.0, 10.0, -75.0, 30.0, 50.0, -70.0, -35.0, 20.0, -100.0, -30.0, 5.0, -5.0, -280.0, -45.0, -130.0, 40.0, -375.0, -50.0, 30.0, 50.0, -10.0, 30.0, 40.0, 20.0, 40.0, 20.0, 60.0, 30.0, 20.0, 30.0, -105.0, 40.0, 25.0, 40.0, 60.0, 60.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-25.0, 0.0, 0.0, -130.0, -125.0, 0.0, -25.0, 0.0, -125.0, 0.0, -105.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 5.0, -40.0, 0.0, 0.0, 10.0, -5.0, 10.0, 0.0, -335.0, 0.0, 10.0, 0.0, 0.0, 0.0, -45.0, -395.0, 10.0, -185.0, 20.0, 0.0, -60.0, 10.0, -100.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, -55.0, 0.0, 0.0, -165.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -150.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, -150.0, 0.0, -25.0, 0.0, 0.0, 10.0, -5.0, 0.0, 0.0, -60.0, -75.0, -300.0, 10.0, 10.0, 0.0, 10.0, 10.0, -145.0, 0.0, -15.0, 0.0, -35.0, -85.0, 0.0, 0.0, 0.0, -175.0, 0.0, -290.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, -225.0, -420.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -55.0, 20.0, -250.0, 0.0, 0.0, 10.0, 10.0, 0.0, -350.0, 0.0, -345.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, -85.0, 0.0, -235.0, 10.0, 0.0, -235.0, 0.0, 0.0, 0.0, 0.0, 0.0, -65.0, -315.0, 0.0, -135.0, 0.0, 0.0, 10.0, 0.0, 0.0, -260.0, 0.0, 0.0, 0.0, 20.0, 0.0, -100.0, 0.0, 10.0, -360.0, 0.0, 0.0, -50.0, -90.0, 0.0, 0.0, 0.0, 0.0, -125.0, 0.0, -110.0, 10.0, 10.0, -65.0, 0.0, 0.0, -130.0, -75.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -95.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, -100.0, 0.0, 10.0, 0.0, 0.0, 0.0, -45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, -110.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -30.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, -35.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -45.0, 0.0, 0.0, 0.0, -245.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 5.0, 20.0, -110.0, 10.0, 0.0, 0.0, -110.0, 10.0, -40.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, -30.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, -115.0, -25.0, -80.0, -5.0, -130.0, 20.0, -60.0, 10.0, 0.0, 10.0, 0.0, -50.0, 0.0, -30.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, -50.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 10.0, 0.0, -95.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 30.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.3153086538019085, "mean_inference_ms": 3.291944873956896, "mean_action_processing_ms": 0.8403031030925949, "mean_env_wait_ms": 2.7035013206584115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1730834996258771, "StateBufferConnector_ms": 0.042513123265019166, "ViewRequirementAgentConnector_ms": 1.3551279350563332}, "num_episodes": 18, "episode_return_max": 60.0, "episode_return_min": -915.0, "episode_return_mean": -141.94444444444446}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 27.03704205308361, "num_env_steps_trained_throughput_per_sec": 27.03704205308361, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 148025.428, "restore_workers_time_ms": 0.016, "training_step_time_ms": 148025.363, "sample_time_ms": 5496.526, "learn_time_ms": 142509.233, "learn_throughput": 28.068, "synch_weights_time_ms": 12.56}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "training_iteration": 3, "trial_id": "57140_00000", "date": "2024-06-26_23-21-57", "timestamp": 1719458517, "time_this_iter_s": 147.9812068939209, "time_total_s": 444.19244170188904, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3b5d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 444.19244170188904, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 44.7755980861244, "ram_util_percent": 80.36746411483254}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9028026799043527, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.2897930427195545, "policy_loss": -0.003278352793740531, "vf_loss": 1.2920450554194605, "vf_explained_var": 0.01097213100320615, "kl": 0.01026340198671306, "entropy": 1.5552267619976983, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 32865.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "env_runners": {"episode_reward_max": 70.0, "episode_reward_min": -915.0, "episode_reward_mean": -99.65277777777777, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 14472, "policy_reward_min": {"policy_0": -420.0}, "policy_reward_max": {"policy_0": 30.0}, "policy_reward_mean": {"policy_0": -9.965277777777779}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-430.0, -120.0, -310.0, -745.0, 30.0, -220.0, -140.0, -150.0, -395.0, -455.0, -915.0, -285.0, -655.0, -535.0, -515.0, -230.0, -590.0, -280.0, -165.0, 10.0, -75.0, 30.0, 50.0, -70.0, -35.0, 20.0, -100.0, -30.0, 5.0, -5.0, -280.0, -45.0, -130.0, 40.0, -375.0, -50.0, 30.0, 50.0, -10.0, 30.0, 40.0, 20.0, 40.0, 20.0, 60.0, 30.0, 20.0, 30.0, -105.0, 40.0, 25.0, 40.0, 60.0, 60.0, 20.0, 60.0, -10.0, 30.0, 40.0, 60.0, 20.0, 60.0, 20.0, 20.0, 0.0, 30.0, 5.0, 70.0, 20.0, 20.0, 15.0, 10.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-25.0, 0.0, 0.0, -130.0, -125.0, 0.0, -25.0, 0.0, -125.0, 0.0, -105.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 5.0, -40.0, 0.0, 0.0, 10.0, -5.0, 10.0, 0.0, -335.0, 0.0, 10.0, 0.0, 0.0, 0.0, -45.0, -395.0, 10.0, -185.0, 20.0, 0.0, -60.0, 10.0, -100.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, -55.0, 0.0, 0.0, -165.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -150.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, -150.0, 0.0, -25.0, 0.0, 0.0, 10.0, -5.0, 0.0, 0.0, -60.0, -75.0, -300.0, 10.0, 10.0, 0.0, 10.0, 10.0, -145.0, 0.0, -15.0, 0.0, -35.0, -85.0, 0.0, 0.0, 0.0, -175.0, 0.0, -290.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, -225.0, -420.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -55.0, 20.0, -250.0, 0.0, 0.0, 10.0, 10.0, 0.0, -350.0, 0.0, -345.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, -85.0, 0.0, -235.0, 10.0, 0.0, -235.0, 0.0, 0.0, 0.0, 0.0, 0.0, -65.0, -315.0, 0.0, -135.0, 0.0, 0.0, 10.0, 0.0, 0.0, -260.0, 0.0, 0.0, 0.0, 20.0, 0.0, -100.0, 0.0, 10.0, -360.0, 0.0, 0.0, -50.0, -90.0, 0.0, 0.0, 0.0, 0.0, -125.0, 0.0, -110.0, 10.0, 10.0, -65.0, 0.0, 0.0, -130.0, -75.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -95.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, -100.0, 0.0, 10.0, 0.0, 0.0, 0.0, -45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, -110.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -30.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, -35.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -45.0, 0.0, 0.0, 0.0, -245.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 5.0, 20.0, -110.0, 10.0, 0.0, 0.0, -110.0, 10.0, -40.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, -30.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, -115.0, -25.0, -80.0, -5.0, -130.0, 20.0, -60.0, 10.0, 0.0, 10.0, 0.0, -50.0, 0.0, -30.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, -50.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 10.0, 0.0, -95.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 30.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -15.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.220074171265869, "mean_inference_ms": 3.170739301291722, "mean_action_processing_ms": 0.8093407232119146, "mean_env_wait_ms": 2.6119311446269204, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.16556051042344835, "StateBufferConnector_ms": 0.035492910279168025, "ViewRequirementAgentConnector_ms": 1.1842485931184557}, "num_episodes": 18, "episode_return_max": 70.0, "episode_return_min": -915.0, "episode_return_mean": -99.65277777777777}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 27.138715299360292, "num_env_steps_trained_throughput_per_sec": 27.138715299360292, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 147866.803, "restore_workers_time_ms": 0.016, "training_step_time_ms": 147866.741, "sample_time_ms": 5110.164, "learn_time_ms": 142737.176, "learn_throughput": 28.024, "synch_weights_time_ms": 12.028}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "training_iteration": 4, "trial_id": "57140_00000", "date": "2024-06-26_23-24-24", "timestamp": 1719458664, "time_this_iter_s": 147.41240096092224, "time_total_s": 591.6048426628113, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3e6040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 591.6048426628113, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 45.97548076923077, "ram_util_percent": 80.43653846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6370804141123836, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0281089394110334, "policy_loss": -0.0038670286296691283, "vf_loss": 1.0311858878745692, "vf_explained_var": 0.005496463125633101, "kl": 0.00790081239935159, "entropy": 1.5373414660795048, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 42255.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "env_runners": {"episode_reward_max": 80.0, "episode_reward_min": -915.0, "episode_reward_mean": -62.77777777777778, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 19899, "policy_reward_min": {"policy_0": -420.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": -6.277777777777778}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-430.0, -120.0, -310.0, -745.0, 30.0, -220.0, -140.0, -150.0, -395.0, -455.0, -915.0, -285.0, -655.0, -535.0, -515.0, -230.0, -590.0, -280.0, -165.0, 10.0, -75.0, 30.0, 50.0, -70.0, -35.0, 20.0, -100.0, -30.0, 5.0, -5.0, -280.0, -45.0, -130.0, 40.0, -375.0, -50.0, 30.0, 50.0, -10.0, 30.0, 40.0, 20.0, 40.0, 20.0, 60.0, 30.0, 20.0, 30.0, -105.0, 40.0, 25.0, 40.0, 60.0, 60.0, 20.0, 60.0, -10.0, 30.0, 40.0, 60.0, 20.0, 60.0, 20.0, 20.0, 0.0, 30.0, 5.0, 70.0, 20.0, 20.0, 15.0, 10.0, 60.0, 50.0, 25.0, 30.0, 20.0, 50.0, 80.0, 20.0, 40.0, 40.0, 30.0, 10.0, 40.0, 20.0, 50.0, 10.0, 30.0, 20.0, 45.0, 80.0, 70.0, -5.0, 80.0, 10.0, 10.0, 50.0, -5.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-25.0, 0.0, 0.0, -130.0, -125.0, 0.0, -25.0, 0.0, -125.0, 0.0, -105.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 5.0, -40.0, 0.0, 0.0, 10.0, -5.0, 10.0, 0.0, -335.0, 0.0, 10.0, 0.0, 0.0, 0.0, -45.0, -395.0, 10.0, -185.0, 20.0, 0.0, -60.0, 10.0, -100.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, -55.0, 0.0, 0.0, -165.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -150.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, -150.0, 0.0, -25.0, 0.0, 0.0, 10.0, -5.0, 0.0, 0.0, -60.0, -75.0, -300.0, 10.0, 10.0, 0.0, 10.0, 10.0, -145.0, 0.0, -15.0, 0.0, -35.0, -85.0, 0.0, 0.0, 0.0, -175.0, 0.0, -290.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, -225.0, -420.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -55.0, 20.0, -250.0, 0.0, 0.0, 10.0, 10.0, 0.0, -350.0, 0.0, -345.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, -85.0, 0.0, -235.0, 10.0, 0.0, -235.0, 0.0, 0.0, 0.0, 0.0, 0.0, -65.0, -315.0, 0.0, -135.0, 0.0, 0.0, 10.0, 0.0, 0.0, -260.0, 0.0, 0.0, 0.0, 20.0, 0.0, -100.0, 0.0, 10.0, -360.0, 0.0, 0.0, -50.0, -90.0, 0.0, 0.0, 0.0, 0.0, -125.0, 0.0, -110.0, 10.0, 10.0, -65.0, 0.0, 0.0, -130.0, -75.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -95.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, -100.0, 0.0, 10.0, 0.0, 0.0, 0.0, -45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, -110.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -30.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, -35.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -45.0, 0.0, 0.0, 0.0, -245.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 5.0, 20.0, -110.0, 10.0, 0.0, 0.0, -110.0, 10.0, -40.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, -30.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, -115.0, -25.0, -80.0, -5.0, -130.0, 20.0, -60.0, 10.0, 0.0, 10.0, 0.0, -50.0, 0.0, -30.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, -50.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 10.0, 0.0, -95.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 30.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -15.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -5.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -30.0, 0.0, 10.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, -15.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -25.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 3.1219620678809217, "mean_inference_ms": 3.0676185824050224, "mean_action_processing_ms": 0.7807019773386182, "mean_env_wait_ms": 2.5279873675372433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.14412258610580908, "StateBufferConnector_ms": 0.03167547360815183, "ViewRequirementAgentConnector_ms": 1.0201215744018555}, "num_episodes": 27, "episode_return_max": 80.0, "episode_return_min": -915.0, "episode_return_mean": -62.77777777777778}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 27.239966257492473, "num_env_steps_trained_throughput_per_sec": 27.239966257492473, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 147662.058, "restore_workers_time_ms": 0.016, "training_step_time_ms": 147661.997, "sample_time_ms": 5017.82, "learn_time_ms": 142624.93, "learn_throughput": 28.046, "synch_weights_time_ms": 11.756}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "training_iteration": 5, "trial_id": "57140_00000", "date": "2024-06-26_23-26-51", "timestamp": 1719458811, "time_this_iter_s": 146.85243821144104, "time_total_s": 738.4572808742523, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3b53a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 738.4572808742523, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 44.38173076923077, "ram_util_percent": 79.95961538461538}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9208985460547212, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.7631980298045344, "policy_loss": -0.004220130368477057, "vf_loss": 1.7667503987384428, "vf_explained_var": -0.00017020181218148293, "kl": 0.006677596988909613, "entropy": 1.5058327291466305, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 51645.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "env_runners": {"episode_reward_max": 110.0, "episode_reward_min": -375.0, "episode_reward_mean": 14.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -245.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": 1.445}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-280.0, -165.0, 10.0, -75.0, 30.0, 50.0, -70.0, -35.0, 20.0, -100.0, -30.0, 5.0, -5.0, -280.0, -45.0, -130.0, 40.0, -375.0, -50.0, 30.0, 50.0, -10.0, 30.0, 40.0, 20.0, 40.0, 20.0, 60.0, 30.0, 20.0, 30.0, -105.0, 40.0, 25.0, 40.0, 60.0, 60.0, 20.0, 60.0, -10.0, 30.0, 40.0, 60.0, 20.0, 60.0, 20.0, 20.0, 0.0, 30.0, 5.0, 70.0, 20.0, 20.0, 15.0, 10.0, 60.0, 50.0, 25.0, 30.0, 20.0, 50.0, 80.0, 20.0, 40.0, 40.0, 30.0, 10.0, 40.0, 20.0, 50.0, 10.0, 30.0, 20.0, 45.0, 80.0, 70.0, -5.0, 80.0, 10.0, 10.0, 50.0, -5.0, 40.0, 40.0, 60.0, 50.0, 25.0, 30.0, 60.0, 100.0, 40.0, 110.0, -5.0, 60.0, 85.0, 60.0, 50.0, 60.0, 85.0, 50.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, -125.0, 0.0, -110.0, 10.0, 10.0, -65.0, 0.0, 0.0, -130.0, -75.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -95.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, -100.0, 0.0, 10.0, 0.0, 0.0, 0.0, -45.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, -110.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -10.0, 0.0, -30.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, -35.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -45.0, 0.0, 0.0, 0.0, -245.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 5.0, 20.0, -110.0, 10.0, 0.0, 0.0, -110.0, 10.0, -40.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, -30.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, -115.0, -25.0, -80.0, -5.0, -130.0, 20.0, -60.0, 10.0, 0.0, 10.0, 0.0, -50.0, 0.0, -30.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, -50.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 10.0, 0.0, -95.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 30.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -15.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -5.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -30.0, 0.0, 10.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, -15.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -25.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 30.0, -20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -15.0, 40.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, -5.0, 0.0, 0.0, 0.0, 20.0, 20.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.9754763932498576, "mean_inference_ms": 2.897426607811533, "mean_action_processing_ms": 0.7377634860689031, "mean_env_wait_ms": 2.402937516093472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.12029838562011719, "StateBufferConnector_ms": 0.022586584091186523, "ViewRequirementAgentConnector_ms": 0.8063874244689941}, "num_episodes": 18, "episode_return_max": 110.0, "episode_return_min": -375.0, "episode_return_mean": 14.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 26.440709336298042, "num_env_steps_trained_throughput_per_sec": 26.440709336298042, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 148265.362, "restore_workers_time_ms": 0.016, "training_step_time_ms": 148265.303, "sample_time_ms": 4838.176, "learn_time_ms": 143407.967, "learn_throughput": 27.892, "synch_weights_time_ms": 11.898}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "training_iteration": 6, "trial_id": "57140_00000", "date": "2024-06-26_23-29-22", "timestamp": 1719458962, "time_this_iter_s": 151.338317155838, "time_total_s": 889.7955980300903, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af38fca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 889.7955980300903, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 44.87009345794392, "ram_util_percent": 80.48271028037385}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4897398334182996, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.9450492349359048, "policy_loss": -0.005844474344958647, "vf_loss": 1.9499806099869827, "vf_explained_var": 0.0007529038209884692, "kl": 0.009130969053871766, "entropy": 1.4827781275184517, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 61035.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "env_runners": {"episode_reward_max": 120.0, "episode_reward_min": -105.0, "episode_reward_mean": 41.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -95.0}, "policy_reward_max": {"policy_0": 40.0}, "policy_reward_mean": {"policy_0": 4.185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-50.0, 30.0, 50.0, -10.0, 30.0, 40.0, 20.0, 40.0, 20.0, 60.0, 30.0, 20.0, 30.0, -105.0, 40.0, 25.0, 40.0, 60.0, 60.0, 20.0, 60.0, -10.0, 30.0, 40.0, 60.0, 20.0, 60.0, 20.0, 20.0, 0.0, 30.0, 5.0, 70.0, 20.0, 20.0, 15.0, 10.0, 60.0, 50.0, 25.0, 30.0, 20.0, 50.0, 80.0, 20.0, 40.0, 40.0, 30.0, 10.0, 40.0, 20.0, 50.0, 10.0, 30.0, 20.0, 45.0, 80.0, 70.0, -5.0, 80.0, 10.0, 10.0, 50.0, -5.0, 40.0, 40.0, 60.0, 50.0, 25.0, 30.0, 60.0, 100.0, 40.0, 110.0, -5.0, 60.0, 85.0, 60.0, 50.0, 60.0, 85.0, 50.0, 90.0, 60.0, 50.0, 90.0, 40.0, 40.0, 120.0, 100.0, -5.0, 95.0, 90.0, 110.0, 40.0, 60.0, 100.0, 75.0, 100.0, 50.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, -50.0, 0.0, -30.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, -50.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, -20.0, 10.0, 0.0, -95.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, -15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 30.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -15.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -5.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -30.0, 0.0, 10.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, -15.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -25.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 30.0, -20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -15.0, 40.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, -5.0, 0.0, 0.0, 0.0, 20.0, 20.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 40.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 30.0, -45.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.0, 20.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 40.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 30.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 20.0, 30.0, 0.0, 0.0, -5.0, 0.0, 30.0, 0.0, 10.0, 0.0, 10.0, 20.0, 30.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.871933781665557, "mean_inference_ms": 2.828258205182723, "mean_action_processing_ms": 0.7161469283716673, "mean_env_wait_ms": 2.324579634788017, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.1188356876373291, "StateBufferConnector_ms": 0.017608165740966797, "ViewRequirementAgentConnector_ms": 0.7488563060760498}, "num_episodes": 18, "episode_return_max": 120.0, "episode_return_min": -105.0, "episode_return_mean": 41.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 26.907195151325876, "num_env_steps_trained_throughput_per_sec": 26.907195151325876, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 148321.615, "restore_workers_time_ms": 0.016, "training_step_time_ms": 148321.558, "sample_time_ms": 4723.017, "learn_time_ms": 143578.743, "learn_throughput": 27.859, "synch_weights_time_ms": 12.178}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "training_iteration": 7, "trial_id": "57140_00000", "date": "2024-06-26_23-31-51", "timestamp": 1719459111, "time_this_iter_s": 148.6721339225769, "time_total_s": 1038.4677319526672, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3f5940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1038.4677319526672, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 42.937619047619044, "ram_util_percent": 79.9747619047619}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5165704404425444, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.5638313421680015, "policy_loss": -0.004911465880895456, "vf_loss": 2.5680084677169117, "vf_explained_var": 0.00677758926908556, "kl": 0.007343402371146445, "entropy": 1.4775830284855997, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 70425.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "env_runners": {"episode_reward_max": 190.0, "episode_reward_min": -10.0, "episode_reward_mean": 55.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -45.0}, "policy_reward_max": {"policy_0": 50.0}, "policy_reward_mean": {"policy_0": 5.59}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 20.0, 60.0, -10.0, 30.0, 40.0, 60.0, 20.0, 60.0, 20.0, 20.0, 0.0, 30.0, 5.0, 70.0, 20.0, 20.0, 15.0, 10.0, 60.0, 50.0, 25.0, 30.0, 20.0, 50.0, 80.0, 20.0, 40.0, 40.0, 30.0, 10.0, 40.0, 20.0, 50.0, 10.0, 30.0, 20.0, 45.0, 80.0, 70.0, -5.0, 80.0, 10.0, 10.0, 50.0, -5.0, 40.0, 40.0, 60.0, 50.0, 25.0, 30.0, 60.0, 100.0, 40.0, 110.0, -5.0, 60.0, 85.0, 60.0, 50.0, 60.0, 85.0, 50.0, 90.0, 60.0, 50.0, 90.0, 40.0, 40.0, 120.0, 100.0, -5.0, 95.0, 90.0, 110.0, 40.0, 60.0, 100.0, 75.0, 100.0, 50.0, 90.0, 145.0, 65.0, 110.0, 140.0, 80.0, 50.0, 40.0, 100.0, 190.0, 90.0, 85.0, 70.0, 120.0, 130.0, 90.0, 90.0, 90.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, -20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, -15.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 15.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -5.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -30.0, 0.0, 10.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, -15.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -25.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 30.0, -20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -15.0, 40.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, -5.0, 0.0, 0.0, 0.0, 20.0, 20.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 40.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 30.0, -45.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.0, 20.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 40.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 30.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 20.0, 30.0, 0.0, 0.0, -5.0, 0.0, 30.0, 0.0, 10.0, 0.0, 10.0, 20.0, 30.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 5.0, 50.0, 30.0, 0.0, 0.0, 10.0, 20.0, 10.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -5.0, 0.0, 0.0, 10.0, 0.0, 10.0, 40.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 30.0, 0.0, 20.0, 20.0, 0.0, 10.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 30.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 30.0, 10.0, 40.0, 20.0, 10.0, 10.0, 30.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 5.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 30.0, 20.0, 40.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 30.0, 0.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.7676165760545826, "mean_inference_ms": 2.7831112406298475, "mean_action_processing_ms": 0.7014576519012721, "mean_env_wait_ms": 2.265235079842036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09985017776489258, "StateBufferConnector_ms": 0.016287565231323242, "ViewRequirementAgentConnector_ms": 0.6326432228088379}, "num_episodes": 18, "episode_return_max": 190.0, "episode_return_min": -10.0, "episode_return_mean": 55.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 26.962042439202992, "num_env_steps_trained_throughput_per_sec": 26.962042439202992, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 148326.004, "restore_workers_time_ms": 0.016, "training_step_time_ms": 148325.947, "sample_time_ms": 4665.362, "learn_time_ms": 143639.668, "learn_throughput": 27.847, "synch_weights_time_ms": 12.922}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "training_iteration": 8, "trial_id": "57140_00000", "date": "2024-06-26_23-34-19", "timestamp": 1719459259, "time_this_iter_s": 148.37741422653198, "time_total_s": 1186.8451461791992, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af315b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1186.8451461791992, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 42.76142857142858, "ram_util_percent": 80.37999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.519522869983674, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.606425651942833, "policy_loss": -0.00451820274248136, "vf_loss": 2.6101512920615266, "vf_explained_var": 0.002252082721874737, "kl": 0.007925619075921892, "entropy": 1.4455108763183901, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 79815.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "env_runners": {"episode_reward_max": 340.0, "episode_reward_min": -5.0, "episode_reward_mean": 75.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -50.0}, "policy_reward_max": {"policy_0": 250.0}, "policy_reward_mean": {"policy_0": 7.535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [10.0, 60.0, 50.0, 25.0, 30.0, 20.0, 50.0, 80.0, 20.0, 40.0, 40.0, 30.0, 10.0, 40.0, 20.0, 50.0, 10.0, 30.0, 20.0, 45.0, 80.0, 70.0, -5.0, 80.0, 10.0, 10.0, 50.0, -5.0, 40.0, 40.0, 60.0, 50.0, 25.0, 30.0, 60.0, 100.0, 40.0, 110.0, -5.0, 60.0, 85.0, 60.0, 50.0, 60.0, 85.0, 50.0, 90.0, 60.0, 50.0, 90.0, 40.0, 40.0, 120.0, 100.0, -5.0, 95.0, 90.0, 110.0, 40.0, 60.0, 100.0, 75.0, 100.0, 50.0, 90.0, 145.0, 65.0, 110.0, 140.0, 80.0, 50.0, 40.0, 100.0, 190.0, 90.0, 85.0, 70.0, 120.0, 130.0, 90.0, 90.0, 90.0, 150.0, 190.0, 90.0, 180.0, 60.0, 80.0, 100.0, 150.0, 50.0, 200.0, 340.0, 135.0, 55.0, 160.0, 80.0, 200.0, 75.0, 190.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, -5.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, -30.0, 0.0, 10.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, -15.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, -25.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, -5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 30.0, -20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -15.0, 40.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, -5.0, 0.0, 0.0, 0.0, 20.0, 20.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 40.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 30.0, -45.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.0, 20.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 40.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 30.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 20.0, 30.0, 0.0, 0.0, -5.0, 0.0, 30.0, 0.0, 10.0, 0.0, 10.0, 20.0, 30.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 5.0, 50.0, 30.0, 0.0, 0.0, 10.0, 20.0, 10.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -5.0, 0.0, 0.0, 10.0, 0.0, 10.0, 40.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 30.0, 0.0, 20.0, 20.0, 0.0, 10.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 30.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 30.0, 10.0, 40.0, 20.0, 10.0, 10.0, 30.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 5.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 30.0, 20.0, 40.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 30.0, 0.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 30.0, 10.0, 50.0, 0.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 0.0, 20.0, 60.0, 10.0, 10.0, 0.0, 0.0, 30.0, 30.0, 30.0, 30.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 40.0, 0.0, 0.0, 40.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 50.0, 0.0, 0.0, 50.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 160.0, 20.0, -50.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 250.0, 50.0, 20.0, -30.0, 20.0, 20.0, 10.0, 50.0, 10.0, 0.0, 10.0, 20.0, -5.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 70.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 50.0, 40.0, 10.0, 10.0, 0.0, 40.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 5.0, 0.0, 10.0, 30.0, 0.0, 40.0, 0.0, 40.0, 0.0, 40.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.69384467429691, "mean_inference_ms": 2.779007232592378, "mean_action_processing_ms": 0.6956011633886807, "mean_env_wait_ms": 2.2339516853362578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.09805750846862793, "StateBufferConnector_ms": 0.017195701599121094, "ViewRequirementAgentConnector_ms": 0.6550371646881104}, "num_episodes": 18, "episode_return_max": 340.0, "episode_return_min": -5.0, "episode_return_mean": 75.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 32.08845016821853, "num_env_steps_trained_throughput_per_sec": 32.08845016821853, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 145695.944, "restore_workers_time_ms": 0.019, "training_step_time_ms": 145695.88, "sample_time_ms": 4616.358, "learn_time_ms": 141058.76, "learn_throughput": 28.357, "synch_weights_time_ms": 12.812}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "training_iteration": 9, "trial_id": "57140_00000", "date": "2024-06-26_23-36-24", "timestamp": 1719459384, "time_this_iter_s": 124.66853976249695, "time_total_s": 1311.5136859416962, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3f55e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1311.5136859416962, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 27.68068181818182, "ram_util_percent": 79.92159090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5851502012076597, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.711990754063518, "policy_loss": -0.006004794411975156, "vf_loss": 2.717274353209649, "vf_explained_var": 0.005736984866368758, "kl": 0.007211946254191117, "entropy": 1.4503783476365386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 89205.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "env_runners": {"episode_reward_max": 340.0, "episode_reward_min": -5.0, "episode_reward_mean": 97.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 250.0}, "policy_reward_mean": {"policy_0": 9.74}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-5.0, 40.0, 40.0, 60.0, 50.0, 25.0, 30.0, 60.0, 100.0, 40.0, 110.0, -5.0, 60.0, 85.0, 60.0, 50.0, 60.0, 85.0, 50.0, 90.0, 60.0, 50.0, 90.0, 40.0, 40.0, 120.0, 100.0, -5.0, 95.0, 90.0, 110.0, 40.0, 60.0, 100.0, 75.0, 100.0, 50.0, 90.0, 145.0, 65.0, 110.0, 140.0, 80.0, 50.0, 40.0, 100.0, 190.0, 90.0, 85.0, 70.0, 120.0, 130.0, 90.0, 90.0, 90.0, 150.0, 190.0, 90.0, 180.0, 60.0, 80.0, 100.0, 150.0, 50.0, 200.0, 340.0, 135.0, 55.0, 160.0, 80.0, 200.0, 75.0, 190.0, 120.0, 5.0, 70.0, 180.0, 90.0, 100.0, 110.0, 60.0, 145.0, 110.0, 90.0, 160.0, 280.0, 90.0, 180.0, 70.0, 180.0, 120.0, 80.0, 180.0, 120.0, 50.0, 150.0, 110.0, 60.0, 110.0, 160.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-5.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 30.0, -20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 5.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -5.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, -15.0, 40.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, -5.0, 0.0, 0.0, 0.0, 20.0, 20.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 40.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 30.0, -45.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.0, 20.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 40.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 30.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 20.0, 30.0, 0.0, 0.0, -5.0, 0.0, 30.0, 0.0, 10.0, 0.0, 10.0, 20.0, 30.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 5.0, 50.0, 30.0, 0.0, 0.0, 10.0, 20.0, 10.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -5.0, 0.0, 0.0, 10.0, 0.0, 10.0, 40.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 30.0, 0.0, 20.0, 20.0, 0.0, 10.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 30.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 30.0, 10.0, 40.0, 20.0, 10.0, 10.0, 30.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 5.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 30.0, 20.0, 40.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 30.0, 0.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 30.0, 10.0, 50.0, 0.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 0.0, 20.0, 60.0, 10.0, 10.0, 0.0, 0.0, 30.0, 30.0, 30.0, 30.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 40.0, 0.0, 0.0, 40.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 50.0, 0.0, 0.0, 50.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 160.0, 20.0, -50.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 250.0, 50.0, 20.0, -30.0, 20.0, 20.0, 10.0, 50.0, 10.0, 0.0, 10.0, 20.0, -5.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 70.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 50.0, 40.0, 10.0, 10.0, 0.0, 40.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 5.0, 0.0, 10.0, 30.0, 0.0, 40.0, 0.0, 40.0, 0.0, 40.0, 30.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 30.0, 20.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 20.0, 10.0, -85.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 70.0, 0.0, 0.0, 20.0, 0.0, 30.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 60.0, 20.0, 10.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 30.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 20.0, 40.0, 0.0, 20.0, 10.0, 5.0, 10.0, 0.0, 20.0, 10.0, 30.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, -50.0, 0.0, 250.0, 0.0, 10.0, 20.0, 30.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 30.0, 30.0, 0.0, 0.0, 30.0, 0.0, 10.0, -10.0, 20.0, 60.0, 20.0, 30.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 10.0, 40.0, 50.0, 10.0, 30.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 40.0, 20.0, 20.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 40.0, 30.0, 0.0, 10.0, 20.0, 50.0, 30.0, 20.0, 0.0, 10.0, 10.0, 40.0, 0.0, 20.0, 20.0, -10.0, 0.0, 0.0, 0.0, 20.0, 30.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 30.0, 0.0, 60.0, 0.0, -20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 60.0, 10.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 20.0, 40.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 30.0, 30.0, 10.0, 0.0, 50.0, 0.0, 10.0, 10.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.5737406116867994, "mean_inference_ms": 2.7467034404820354, "mean_action_processing_ms": 0.6824012083608273, "mean_env_wait_ms": 2.1733572994996226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.08595609664916992, "StateBufferConnector_ms": 0.01381993293762207, "ViewRequirementAgentConnector_ms": 0.6051323413848877}, "num_episodes": 27, "episode_return_max": 340.0, "episode_return_min": -5.0, "episode_return_mean": 97.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.40325246776515, "num_env_steps_trained_throughput_per_sec": 36.40325246776515, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 142114.38, "restore_workers_time_ms": 0.018, "training_step_time_ms": 142114.318, "sample_time_ms": 4398.904, "learn_time_ms": 137694.808, "learn_throughput": 29.05, "synch_weights_time_ms": 12.678}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "training_iteration": 10, "trial_id": "57140_00000", "date": "2024-06-26_23-38-14", "timestamp": 1719459494, "time_this_iter_s": 109.89217066764832, "time_total_s": 1421.4058566093445, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3f5ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1421.4058566093445, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 16.486451612903227, "ram_util_percent": 79.43806451612903}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5346740748935614, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.2164757291856794, "policy_loss": -0.007814751734785514, "vf_loss": 3.2232893284009543, "vf_explained_var": 0.0026032387004238855, "kl": 0.01001154789044699, "entropy": 1.4150925353820079, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 98595.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "env_runners": {"episode_reward_max": 340.0, "episode_reward_min": -5.0, "episode_reward_mean": 113.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 250.0}, "policy_reward_mean": {"policy_0": 11.39}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.0, 90.0, 60.0, 50.0, 90.0, 40.0, 40.0, 120.0, 100.0, -5.0, 95.0, 90.0, 110.0, 40.0, 60.0, 100.0, 75.0, 100.0, 50.0, 90.0, 145.0, 65.0, 110.0, 140.0, 80.0, 50.0, 40.0, 100.0, 190.0, 90.0, 85.0, 70.0, 120.0, 130.0, 90.0, 90.0, 90.0, 150.0, 190.0, 90.0, 180.0, 60.0, 80.0, 100.0, 150.0, 50.0, 200.0, 340.0, 135.0, 55.0, 160.0, 80.0, 200.0, 75.0, 190.0, 120.0, 5.0, 70.0, 180.0, 90.0, 100.0, 110.0, 60.0, 145.0, 110.0, 90.0, 160.0, 280.0, 90.0, 180.0, 70.0, 180.0, 120.0, 80.0, 180.0, 120.0, 50.0, 150.0, 110.0, 60.0, 110.0, 160.0, 110.0, 150.0, 120.0, 150.0, 150.0, 220.0, 125.0, 170.0, 120.0, 180.0, 180.0, 140.0, 90.0, 200.0, 50.0, 140.0, 100.0, 200.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 30.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 40.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 30.0, -45.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 25.0, 20.0, 20.0, 0.0, 20.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 40.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, 30.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 30.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 20.0, 30.0, 0.0, 0.0, -5.0, 0.0, 30.0, 0.0, 10.0, 0.0, 10.0, 20.0, 30.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 5.0, 50.0, 30.0, 0.0, 0.0, 10.0, 20.0, 10.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -5.0, 0.0, 0.0, 10.0, 0.0, 10.0, 40.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 30.0, 0.0, 20.0, 20.0, 0.0, 10.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 30.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 30.0, 10.0, 40.0, 20.0, 10.0, 10.0, 30.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 5.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 30.0, 20.0, 40.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 30.0, 0.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 30.0, 10.0, 50.0, 0.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 0.0, 20.0, 60.0, 10.0, 10.0, 0.0, 0.0, 30.0, 30.0, 30.0, 30.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 40.0, 0.0, 0.0, 40.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 50.0, 0.0, 0.0, 50.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 160.0, 20.0, -50.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 250.0, 50.0, 20.0, -30.0, 20.0, 20.0, 10.0, 50.0, 10.0, 0.0, 10.0, 20.0, -5.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 70.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 50.0, 40.0, 10.0, 10.0, 0.0, 40.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 5.0, 0.0, 10.0, 30.0, 0.0, 40.0, 0.0, 40.0, 0.0, 40.0, 30.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 30.0, 20.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 20.0, 10.0, -85.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 70.0, 0.0, 0.0, 20.0, 0.0, 30.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 60.0, 20.0, 10.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 30.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 20.0, 40.0, 0.0, 20.0, 10.0, 5.0, 10.0, 0.0, 20.0, 10.0, 30.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, -50.0, 0.0, 250.0, 0.0, 10.0, 20.0, 30.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 30.0, 30.0, 0.0, 0.0, 30.0, 0.0, 10.0, -10.0, 20.0, 60.0, 20.0, 30.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 10.0, 40.0, 50.0, 10.0, 30.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 40.0, 20.0, 20.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 40.0, 30.0, 0.0, 10.0, 20.0, 50.0, 30.0, 20.0, 0.0, 10.0, 10.0, 40.0, 0.0, 20.0, 20.0, -10.0, 0.0, 0.0, 0.0, 20.0, 30.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 30.0, 0.0, 60.0, 0.0, -20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 60.0, 10.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 20.0, 40.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 30.0, 30.0, 10.0, 0.0, 50.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 0.0, 30.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 40.0, 30.0, 10.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 20.0, 0.0, 30.0, 0.0, 20.0, 50.0, 0.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 10.0, 30.0, 20.0, 0.0, 0.0, 20.0, 60.0, 0.0, 0.0, 30.0, 30.0, 40.0, 40.0, -5.0, 10.0, 10.0, 20.0, 10.0, 10.0, 30.0, 0.0, 10.0, 30.0, 10.0, 40.0, 10.0, 30.0, 20.0, 30.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 20.0, 0.0, 40.0, 0.0, 20.0, 0.0, 30.0, 20.0, 0.0, 20.0, 50.0, 30.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 30.0, 20.0, 10.0, 70.0, 30.0, 30.0, 0.0, 0.0, 30.0, 10.0, 20.0, 40.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 20.0, 30.0, 60.0, 30.0, 0.0, 0.0, 10.0, 10.0, 40.0, 10.0, 10.0, 20.0, 10.0, -80.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 30.0, 40.0, 0.0, 10.0, 20.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 30.0, 0.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 30.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.497427507361897, "mean_inference_ms": 2.714558736239496, "mean_action_processing_ms": 0.6704422167252717, "mean_env_wait_ms": 2.1297556545851974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.07997798919677734, "StateBufferConnector_ms": 0.012182950973510742, "ViewRequirementAgentConnector_ms": 0.5354502201080322}, "num_episodes": 18, "episode_return_max": 340.0, "episode_return_min": -5.0, "episode_return_mean": 113.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.483025754166434, "num_env_steps_trained_throughput_per_sec": 36.483025754166434, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 138111.58, "restore_workers_time_ms": 0.018, "training_step_time_ms": 138111.518, "sample_time_ms": 3987.303, "learn_time_ms": 134103.696, "learn_throughput": 29.828, "synch_weights_time_ms": 12.333}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "training_iteration": 11, "trial_id": "57140_00000", "date": "2024-06-26_23-40-04", "timestamp": 1719459604, "time_this_iter_s": 109.65285301208496, "time_total_s": 1531.0587096214294, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af38fdc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1531.0587096214294, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 15.885806451612904, "ram_util_percent": 79.31806451612903}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3777378592342615, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.12462147937669, "policy_loss": -0.006213166036036092, "vf_loss": 3.1298689873200765, "vf_explained_var": 0.0010701906566802687, "kl": 0.009656582053496855, "entropy": 1.3902395669263772, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 107985.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "env_runners": {"episode_reward_max": 340.0, "episode_reward_min": 5.0, "episode_reward_mean": 132.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 250.0}, "policy_reward_mean": {"policy_0": 13.23}, "custom_metrics": {}, "hist_stats": {"episode_reward": [50.0, 90.0, 145.0, 65.0, 110.0, 140.0, 80.0, 50.0, 40.0, 100.0, 190.0, 90.0, 85.0, 70.0, 120.0, 130.0, 90.0, 90.0, 90.0, 150.0, 190.0, 90.0, 180.0, 60.0, 80.0, 100.0, 150.0, 50.0, 200.0, 340.0, 135.0, 55.0, 160.0, 80.0, 200.0, 75.0, 190.0, 120.0, 5.0, 70.0, 180.0, 90.0, 100.0, 110.0, 60.0, 145.0, 110.0, 90.0, 160.0, 280.0, 90.0, 180.0, 70.0, 180.0, 120.0, 80.0, 180.0, 120.0, 50.0, 150.0, 110.0, 60.0, 110.0, 160.0, 110.0, 150.0, 120.0, 150.0, 150.0, 220.0, 125.0, 170.0, 120.0, 180.0, 180.0, 140.0, 90.0, 200.0, 50.0, 140.0, 100.0, 200.0, 70.0, 250.0, 180.0, 225.0, 140.0, 110.0, 170.0, 160.0, 140.0, 340.0, 270.0, 160.0, 95.0, 190.0, 150.0, 135.0, 120.0, 240.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 20.0, 5.0, 50.0, 30.0, 0.0, 0.0, 10.0, 20.0, 10.0, 50.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, -5.0, 0.0, 0.0, 10.0, 0.0, 10.0, 40.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 30.0, 0.0, 20.0, 20.0, 0.0, 10.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 30.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 30.0, 20.0, 10.0, 10.0, 10.0, 20.0, 20.0, 30.0, 10.0, 40.0, 20.0, 10.0, 10.0, 30.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 20.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 5.0, 0.0, 20.0, 0.0, 20.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 20.0, 30.0, 20.0, 40.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 30.0, 0.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 30.0, 10.0, 50.0, 0.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 0.0, 20.0, 60.0, 10.0, 10.0, 0.0, 0.0, 30.0, 30.0, 30.0, 30.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 40.0, 0.0, 0.0, 40.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 50.0, 0.0, 0.0, 50.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 160.0, 20.0, -50.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 250.0, 50.0, 20.0, -30.0, 20.0, 20.0, 10.0, 50.0, 10.0, 0.0, 10.0, 20.0, -5.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 70.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 50.0, 40.0, 10.0, 10.0, 0.0, 40.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 5.0, 0.0, 10.0, 30.0, 0.0, 40.0, 0.0, 40.0, 0.0, 40.0, 30.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 30.0, 20.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 20.0, 10.0, -85.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 70.0, 0.0, 0.0, 20.0, 0.0, 30.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 60.0, 20.0, 10.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 30.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 20.0, 40.0, 0.0, 20.0, 10.0, 5.0, 10.0, 0.0, 20.0, 10.0, 30.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, -50.0, 0.0, 250.0, 0.0, 10.0, 20.0, 30.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 30.0, 30.0, 0.0, 0.0, 30.0, 0.0, 10.0, -10.0, 20.0, 60.0, 20.0, 30.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 10.0, 40.0, 50.0, 10.0, 30.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 40.0, 20.0, 20.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 40.0, 30.0, 0.0, 10.0, 20.0, 50.0, 30.0, 20.0, 0.0, 10.0, 10.0, 40.0, 0.0, 20.0, 20.0, -10.0, 0.0, 0.0, 0.0, 20.0, 30.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 30.0, 0.0, 60.0, 0.0, -20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 60.0, 10.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 20.0, 40.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 30.0, 30.0, 10.0, 0.0, 50.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 0.0, 30.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 40.0, 30.0, 10.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 20.0, 0.0, 30.0, 0.0, 20.0, 50.0, 0.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 10.0, 30.0, 20.0, 0.0, 0.0, 20.0, 60.0, 0.0, 0.0, 30.0, 30.0, 40.0, 40.0, -5.0, 10.0, 10.0, 20.0, 10.0, 10.0, 30.0, 0.0, 10.0, 30.0, 10.0, 40.0, 10.0, 30.0, 20.0, 30.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 20.0, 0.0, 40.0, 0.0, 20.0, 0.0, 30.0, 20.0, 0.0, 20.0, 50.0, 30.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 30.0, 20.0, 10.0, 70.0, 30.0, 30.0, 0.0, 0.0, 30.0, 10.0, 20.0, 40.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 20.0, 30.0, 60.0, 30.0, 0.0, 0.0, 10.0, 10.0, 40.0, 10.0, 10.0, 20.0, 10.0, -80.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 30.0, 40.0, 0.0, 10.0, 20.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 30.0, 0.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 30.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 0.0, 80.0, 10.0, 50.0, 30.0, 20.0, 10.0, 10.0, 10.0, 30.0, 0.0, 20.0, 30.0, 40.0, 20.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 70.0, 0.0, 40.0, 20.0, 10.0, 0.0, 20.0, 10.0, 60.0, -5.0, 60.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 0.0, 20.0, 10.0, 50.0, 0.0, 10.0, 0.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 60.0, 30.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 30.0, 30.0, 20.0, 20.0, 0.0, 30.0, 30.0, 0.0, 150.0, 30.0, 30.0, 40.0, 10.0, 20.0, 0.0, 10.0, 0.0, 160.0, 10.0, 10.0, 10.0, 20.0, 10.0, 40.0, 0.0, 0.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 0.0, 40.0, 10.0, 0.0, 20.0, 5.0, 0.0, 0.0, 0.0, 20.0, 40.0, 0.0, 0.0, 50.0, 0.0, 20.0, 40.0, 10.0, 40.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 20.0, 30.0, 20.0, 0.0, 20.0, 30.0, 0.0, 30.0, 10.0, -5.0, 20.0, 0.0, 10.0, 10.0, 20.0, 40.0, 0.0, 40.0, 10.0, 10.0, 0.0, 30.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 60.0, 40.0, 0.0, 10.0, 50.0, 10.0, 0.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4236260907394973, "mean_inference_ms": 2.6620279666564897, "mean_action_processing_ms": 0.6555890968033167, "mean_env_wait_ms": 2.080945307444036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06894898414611816, "StateBufferConnector_ms": 0.011468648910522461, "ViewRequirementAgentConnector_ms": 0.48814821243286133}, "num_episodes": 18, "episode_return_max": 340.0, "episode_return_min": 5.0, "episode_return_mean": 132.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.515391003239756, "num_env_steps_trained_throughput_per_sec": 36.515391003239756, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 134419.562, "restore_workers_time_ms": 0.017, "training_step_time_ms": 134419.504, "sample_time_ms": 3729.458, "learn_time_ms": 130669.435, "learn_throughput": 30.612, "synch_weights_time_ms": 12.241}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "training_iteration": 12, "trial_id": "57140_00000", "date": "2024-06-26_23-41-53", "timestamp": 1719459713, "time_this_iter_s": 109.55690503120422, "time_total_s": 1640.6156146526337, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3f5700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1640.6156146526337, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 15.736129032258065, "ram_util_percent": 79.19741935483871}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5776435704276965, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3408398523625222, "policy_loss": -0.007396889956969533, "vf_loss": 3.347455339436841, "vf_explained_var": 0.0022189328020500044, "kl": 0.007814050495809315, "entropy": 1.3681780417506306, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 117375.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "env_runners": {"episode_reward_max": 460.0, "episode_reward_min": -55.0, "episode_reward_mean": 154.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -205.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 15.46}, "custom_metrics": {}, "hist_stats": {"episode_reward": [90.0, 150.0, 190.0, 90.0, 180.0, 60.0, 80.0, 100.0, 150.0, 50.0, 200.0, 340.0, 135.0, 55.0, 160.0, 80.0, 200.0, 75.0, 190.0, 120.0, 5.0, 70.0, 180.0, 90.0, 100.0, 110.0, 60.0, 145.0, 110.0, 90.0, 160.0, 280.0, 90.0, 180.0, 70.0, 180.0, 120.0, 80.0, 180.0, 120.0, 50.0, 150.0, 110.0, 60.0, 110.0, 160.0, 110.0, 150.0, 120.0, 150.0, 150.0, 220.0, 125.0, 170.0, 120.0, 180.0, 180.0, 140.0, 90.0, 200.0, 50.0, 140.0, 100.0, 200.0, 70.0, 250.0, 180.0, 225.0, 140.0, 110.0, 170.0, 160.0, 140.0, 340.0, 270.0, 160.0, 95.0, 190.0, 150.0, 135.0, 120.0, 240.0, 110.0, 110.0, 100.0, 190.0, 460.0, 280.0, 290.0, 150.0, 240.0, -55.0, 375.0, 150.0, 270.0, 440.0, 220.0, 295.0, 140.0, 200.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 20.0, 30.0, 10.0, 50.0, 0.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 0.0, 20.0, 60.0, 10.0, 10.0, 0.0, 0.0, 30.0, 30.0, 30.0, 30.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 20.0, 20.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 40.0, 0.0, 0.0, 40.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 50.0, 0.0, 0.0, 50.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 160.0, 20.0, -50.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 250.0, 50.0, 20.0, -30.0, 20.0, 20.0, 10.0, 50.0, 10.0, 0.0, 10.0, 20.0, -5.0, 0.0, 0.0, 0.0, -5.0, 0.0, 0.0, 0.0, 30.0, 10.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 70.0, 0.0, 10.0, 0.0, 0.0, 20.0, 20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 50.0, 40.0, 10.0, 10.0, 0.0, 40.0, 10.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 0.0, 5.0, 0.0, 10.0, 30.0, 0.0, 40.0, 0.0, 40.0, 0.0, 40.0, 30.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 30.0, 20.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 20.0, 10.0, -85.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 70.0, 0.0, 0.0, 20.0, 0.0, 30.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 60.0, 20.0, 10.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 30.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 20.0, 40.0, 0.0, 20.0, 10.0, 5.0, 10.0, 0.0, 20.0, 10.0, 30.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, -50.0, 0.0, 250.0, 0.0, 10.0, 20.0, 30.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 30.0, 30.0, 0.0, 0.0, 30.0, 0.0, 10.0, -10.0, 20.0, 60.0, 20.0, 30.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 10.0, 40.0, 50.0, 10.0, 30.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 40.0, 20.0, 20.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 40.0, 30.0, 0.0, 10.0, 20.0, 50.0, 30.0, 20.0, 0.0, 10.0, 10.0, 40.0, 0.0, 20.0, 20.0, -10.0, 0.0, 0.0, 0.0, 20.0, 30.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 30.0, 0.0, 60.0, 0.0, -20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 60.0, 10.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 20.0, 40.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 30.0, 30.0, 10.0, 0.0, 50.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 0.0, 30.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 40.0, 30.0, 10.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 20.0, 0.0, 30.0, 0.0, 20.0, 50.0, 0.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 10.0, 30.0, 20.0, 0.0, 0.0, 20.0, 60.0, 0.0, 0.0, 30.0, 30.0, 40.0, 40.0, -5.0, 10.0, 10.0, 20.0, 10.0, 10.0, 30.0, 0.0, 10.0, 30.0, 10.0, 40.0, 10.0, 30.0, 20.0, 30.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 20.0, 0.0, 40.0, 0.0, 20.0, 0.0, 30.0, 20.0, 0.0, 20.0, 50.0, 30.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 30.0, 20.0, 10.0, 70.0, 30.0, 30.0, 0.0, 0.0, 30.0, 10.0, 20.0, 40.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 20.0, 30.0, 60.0, 30.0, 0.0, 0.0, 10.0, 10.0, 40.0, 10.0, 10.0, 20.0, 10.0, -80.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 30.0, 40.0, 0.0, 10.0, 20.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 30.0, 0.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 30.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 0.0, 80.0, 10.0, 50.0, 30.0, 20.0, 10.0, 10.0, 10.0, 30.0, 0.0, 20.0, 30.0, 40.0, 20.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 70.0, 0.0, 40.0, 20.0, 10.0, 0.0, 20.0, 10.0, 60.0, -5.0, 60.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 0.0, 20.0, 10.0, 50.0, 0.0, 10.0, 0.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 60.0, 30.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 30.0, 30.0, 20.0, 20.0, 0.0, 30.0, 30.0, 0.0, 150.0, 30.0, 30.0, 40.0, 10.0, 20.0, 0.0, 10.0, 0.0, 160.0, 10.0, 10.0, 10.0, 20.0, 10.0, 40.0, 0.0, 0.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 0.0, 40.0, 10.0, 0.0, 20.0, 5.0, 0.0, 0.0, 0.0, 20.0, 40.0, 0.0, 0.0, 50.0, 0.0, 20.0, 40.0, 10.0, 40.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 20.0, 30.0, 20.0, 0.0, 20.0, 30.0, 0.0, 30.0, 10.0, -5.0, 20.0, 0.0, 10.0, 10.0, 20.0, 40.0, 0.0, 40.0, 10.0, 10.0, 0.0, 30.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 60.0, 40.0, 0.0, 10.0, 50.0, 10.0, 0.0, 60.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 40.0, 10.0, 10.0, 20.0, 0.0, 0.0, 40.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 40.0, 10.0, 20.0, 0.0, 50.0, 0.0, 10.0, 0.0, 10.0, 20.0, 50.0, 40.0, 10.0, 10.0, 20.0, 20.0, 0.0, 20.0, 40.0, 280.0, 30.0, 20.0, 20.0, -30.0, 30.0, 0.0, 180.0, 10.0, 30.0, 20.0, 0.0, 30.0, 10.0, 10.0, 60.0, 30.0, 20.0, 10.0, 90.0, 10.0, 10.0, 10.0, 40.0, 10.0, 20.0, 30.0, 20.0, 10.0, 10.0, 0.0, 40.0, 10.0, 0.0, 40.0, 10.0, 10.0, 20.0, 60.0, 30.0, 10.0, 30.0, 0.0, 30.0, 10.0, 10.0, 40.0, 0.0, 20.0, 0.0, 20.0, 0.0, 50.0, -205.0, 10.0, 10.0, 10.0, 0.0, 30.0, 15.0, 50.0, 0.0, 90.0, 160.0, 0.0, 20.0, 10.0, 20.0, 0.0, 30.0, 30.0, 10.0, 10.0, 20.0, 20.0, 50.0, 40.0, 10.0, 10.0, 0.0, 80.0, 20.0, 0.0, 40.0, 50.0, 10.0, 250.0, 10.0, 30.0, 0.0, 10.0, 30.0, 20.0, 30.0, 0.0, 70.0, 0.0, 20.0, 20.0, 20.0, 30.0, 0.0, 40.0, 20.0, 150.0, 20.0, 0.0, 0.0, -15.0, 10.0, 80.0, 10.0, 10.0, 30.0, 0.0, 10.0, 10.0, 60.0, 10.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 30.0, 30.0, 10.0, 40.0, 0.0, 0.0, 10.0, 50.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.3504162718882244, "mean_inference_ms": 2.5935797754217016, "mean_action_processing_ms": 0.6381033633972317, "mean_env_wait_ms": 2.0264339109375538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06553816795349121, "StateBufferConnector_ms": 0.010958433151245117, "ViewRequirementAgentConnector_ms": 0.4588968753814697}, "num_episodes": 18, "episode_return_max": 460.0, "episode_return_min": -55.0, "episode_return_mean": 154.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.69984659477878, "num_env_steps_trained_throughput_per_sec": 36.69984659477878, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 130524.272, "restore_workers_time_ms": 0.017, "training_step_time_ms": 130524.215, "sample_time_ms": 3478.624, "learn_time_ms": 127025.442, "learn_throughput": 31.49, "synch_weights_time_ms": 11.863}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "training_iteration": 13, "trial_id": "57140_00000", "date": "2024-06-26_23-43-42", "timestamp": 1719459822, "time_this_iter_s": 109.00418210029602, "time_total_s": 1749.6197967529297, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3f5c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1749.6197967529297, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 15.27012987012987, "ram_util_percent": 79.22467532467535}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5476545549714908, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.438458685321422, "policy_loss": -0.004797152995753783, "vf_loss": 3.442495675640492, "vf_explained_var": 0.0015933151824024919, "kl": 0.007601634484783297, "entropy": 1.3582603604141008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 126765.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "env_runners": {"episode_reward_max": 460.0, "episode_reward_min": -55.0, "episode_reward_mean": 174.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -205.0}, "policy_reward_max": {"policy_0": 280.0}, "policy_reward_mean": {"policy_0": 17.41}, "custom_metrics": {}, "hist_stats": {"episode_reward": [190.0, 120.0, 5.0, 70.0, 180.0, 90.0, 100.0, 110.0, 60.0, 145.0, 110.0, 90.0, 160.0, 280.0, 90.0, 180.0, 70.0, 180.0, 120.0, 80.0, 180.0, 120.0, 50.0, 150.0, 110.0, 60.0, 110.0, 160.0, 110.0, 150.0, 120.0, 150.0, 150.0, 220.0, 125.0, 170.0, 120.0, 180.0, 180.0, 140.0, 90.0, 200.0, 50.0, 140.0, 100.0, 200.0, 70.0, 250.0, 180.0, 225.0, 140.0, 110.0, 170.0, 160.0, 140.0, 340.0, 270.0, 160.0, 95.0, 190.0, 150.0, 135.0, 120.0, 240.0, 110.0, 110.0, 100.0, 190.0, 460.0, 280.0, 290.0, 150.0, 240.0, -55.0, 375.0, 150.0, 270.0, 440.0, 220.0, 295.0, 140.0, 200.0, 310.0, 160.0, 220.0, 340.0, 200.0, 110.0, 310.0, 300.0, 135.0, 260.0, 320.0, 220.0, 340.0, 170.0, 110.0, 170.0, 330.0, 330.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 10.0, 30.0, 0.0, 40.0, 0.0, 40.0, 0.0, 40.0, 30.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 30.0, 20.0, 20.0, 10.0, 0.0, 30.0, 10.0, 10.0, 20.0, 10.0, -85.0, 0.0, 0.0, 10.0, 0.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 20.0, 20.0, 70.0, 0.0, 0.0, 20.0, 0.0, 30.0, 20.0, 10.0, 10.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 60.0, 20.0, 10.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, 30.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 30.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 20.0, 40.0, 0.0, 20.0, 10.0, 5.0, 10.0, 0.0, 20.0, 10.0, 30.0, 10.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 10.0, 30.0, 0.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, -50.0, 0.0, 250.0, 0.0, 10.0, 20.0, 30.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 30.0, 30.0, 0.0, 0.0, 30.0, 0.0, 10.0, -10.0, 20.0, 60.0, 20.0, 30.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 10.0, 40.0, 50.0, 10.0, 30.0, 0.0, 0.0, 10.0, 10.0, 20.0, 10.0, 0.0, 10.0, 10.0, 10.0, 40.0, 20.0, 20.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 0.0, 40.0, 30.0, 0.0, 10.0, 20.0, 50.0, 30.0, 20.0, 0.0, 10.0, 10.0, 40.0, 0.0, 20.0, 20.0, -10.0, 0.0, 0.0, 0.0, 20.0, 30.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 10.0, 30.0, 0.0, 60.0, 0.0, -20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 60.0, 10.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 20.0, 40.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 30.0, 30.0, 10.0, 0.0, 50.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 0.0, 30.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 40.0, 30.0, 10.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 20.0, 0.0, 30.0, 0.0, 20.0, 50.0, 0.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 10.0, 30.0, 20.0, 0.0, 0.0, 20.0, 60.0, 0.0, 0.0, 30.0, 30.0, 40.0, 40.0, -5.0, 10.0, 10.0, 20.0, 10.0, 10.0, 30.0, 0.0, 10.0, 30.0, 10.0, 40.0, 10.0, 30.0, 20.0, 30.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 20.0, 0.0, 40.0, 0.0, 20.0, 0.0, 30.0, 20.0, 0.0, 20.0, 50.0, 30.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 30.0, 20.0, 10.0, 70.0, 30.0, 30.0, 0.0, 0.0, 30.0, 10.0, 20.0, 40.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 20.0, 30.0, 60.0, 30.0, 0.0, 0.0, 10.0, 10.0, 40.0, 10.0, 10.0, 20.0, 10.0, -80.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 30.0, 40.0, 0.0, 10.0, 20.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 30.0, 0.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 30.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 0.0, 80.0, 10.0, 50.0, 30.0, 20.0, 10.0, 10.0, 10.0, 30.0, 0.0, 20.0, 30.0, 40.0, 20.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 70.0, 0.0, 40.0, 20.0, 10.0, 0.0, 20.0, 10.0, 60.0, -5.0, 60.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 0.0, 20.0, 10.0, 50.0, 0.0, 10.0, 0.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 60.0, 30.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 30.0, 30.0, 20.0, 20.0, 0.0, 30.0, 30.0, 0.0, 150.0, 30.0, 30.0, 40.0, 10.0, 20.0, 0.0, 10.0, 0.0, 160.0, 10.0, 10.0, 10.0, 20.0, 10.0, 40.0, 0.0, 0.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 0.0, 40.0, 10.0, 0.0, 20.0, 5.0, 0.0, 0.0, 0.0, 20.0, 40.0, 0.0, 0.0, 50.0, 0.0, 20.0, 40.0, 10.0, 40.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 20.0, 30.0, 20.0, 0.0, 20.0, 30.0, 0.0, 30.0, 10.0, -5.0, 20.0, 0.0, 10.0, 10.0, 20.0, 40.0, 0.0, 40.0, 10.0, 10.0, 0.0, 30.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 60.0, 40.0, 0.0, 10.0, 50.0, 10.0, 0.0, 60.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 40.0, 10.0, 10.0, 20.0, 0.0, 0.0, 40.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 40.0, 10.0, 20.0, 0.0, 50.0, 0.0, 10.0, 0.0, 10.0, 20.0, 50.0, 40.0, 10.0, 10.0, 20.0, 20.0, 0.0, 20.0, 40.0, 280.0, 30.0, 20.0, 20.0, -30.0, 30.0, 0.0, 180.0, 10.0, 30.0, 20.0, 0.0, 30.0, 10.0, 10.0, 60.0, 30.0, 20.0, 10.0, 90.0, 10.0, 10.0, 10.0, 40.0, 10.0, 20.0, 30.0, 20.0, 10.0, 10.0, 0.0, 40.0, 10.0, 0.0, 40.0, 10.0, 10.0, 20.0, 60.0, 30.0, 10.0, 30.0, 0.0, 30.0, 10.0, 10.0, 40.0, 0.0, 20.0, 0.0, 20.0, 0.0, 50.0, -205.0, 10.0, 10.0, 10.0, 0.0, 30.0, 15.0, 50.0, 0.0, 90.0, 160.0, 0.0, 20.0, 10.0, 20.0, 0.0, 30.0, 30.0, 10.0, 10.0, 20.0, 20.0, 50.0, 40.0, 10.0, 10.0, 0.0, 80.0, 20.0, 0.0, 40.0, 50.0, 10.0, 250.0, 10.0, 30.0, 0.0, 10.0, 30.0, 20.0, 30.0, 0.0, 70.0, 0.0, 20.0, 20.0, 20.0, 30.0, 0.0, 40.0, 20.0, 150.0, 20.0, 0.0, 0.0, -15.0, 10.0, 80.0, 10.0, 10.0, 30.0, 0.0, 10.0, 10.0, 60.0, 10.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 30.0, 30.0, 10.0, 40.0, 0.0, 0.0, 10.0, 50.0, 30.0, 30.0, 20.0, 0.0, 0.0, 160.0, 30.0, 0.0, 20.0, 30.0, 20.0, 20.0, 40.0, 10.0, 0.0, 0.0, 0.0, 30.0, 50.0, 0.0, 10.0, 10.0, 0.0, 40.0, 20.0, 60.0, 10.0, 0.0, 30.0, 30.0, 20.0, 10.0, 40.0, -100.0, 10.0, 20.0, 0.0, 190.0, 70.0, 30.0, 70.0, 20.0, 20.0, 0.0, 10.0, 20.0, 30.0, 0.0, 50.0, 40.0, 10.0, 30.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 40.0, 10.0, 0.0, 40.0, 10.0, 0.0, 10.0, 10.0, 160.0, 30.0, 80.0, 30.0, 20.0, 0.0, 50.0, 40.0, 20.0, 0.0, 30.0, 30.0, 0.0, 10.0, 25.0, 20.0, 50.0, 0.0, 20.0, 10.0, 0.0, 0.0, 30.0, 10.0, 30.0, 30.0, 10.0, 0.0, 30.0, 0.0, 30.0, 90.0, 0.0, 90.0, 20.0, 160.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 50.0, 0.0, 10.0, 30.0, 0.0, 40.0, 30.0, 0.0, 30.0, 30.0, 60.0, 10.0, 10.0, -30.0, 20.0, 50.0, 0.0, 40.0, 150.0, 0.0, 10.0, 0.0, 20.0, 40.0, 0.0, 20.0, 10.0, 40.0, 30.0, 30.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 50.0, 80.0, 30.0, 0.0, 0.0, 0.0, 40.0, 150.0, 10.0, 10.0, 0.0, 30.0, 10.0, 40.0, 30.0, 10.0, 30.0, 20.0, 0.0, 10.0, 10.0, 40.0, 30.0, 20.0, 10.0, 160.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.2738812260703627, "mean_inference_ms": 2.5114456418102096, "mean_action_processing_ms": 0.6184710316065395, "mean_env_wait_ms": 1.9660603353849735, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05870366096496582, "StateBufferConnector_ms": 0.010026931762695312, "ViewRequirementAgentConnector_ms": 0.38729381561279297}, "num_episodes": 18, "episode_return_max": 460.0, "episode_return_min": -55.0, "episode_return_mean": 174.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.40542713411299, "num_env_steps_trained_throughput_per_sec": 36.40542713411299, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 126772.553, "restore_workers_time_ms": 0.016, "training_step_time_ms": 126772.498, "sample_time_ms": 3335.58, "learn_time_ms": 123416.629, "learn_throughput": 32.411, "synch_weights_time_ms": 11.849}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "training_iteration": 14, "trial_id": "57140_00000", "date": "2024-06-26_23-45-32", "timestamp": 1719459932, "time_this_iter_s": 109.88580012321472, "time_total_s": 1859.5055968761444, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3e7790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1859.5055968761444, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 15.46602564102564, "ram_util_percent": 79.09038461538461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7242454519287085, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.202295873289545, "policy_loss": -0.006048396930541879, "vf_loss": 4.2074314190810735, "vf_explained_var": 0.0021791258368629236, "kl": 0.009128484866960307, "entropy": 1.3091044648259846, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 136155.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "env_runners": {"episode_reward_max": 590.0, "episode_reward_min": -55.0, "episode_reward_mean": 222.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -205.0}, "policy_reward_max": {"policy_0": 380.0}, "policy_reward_mean": {"policy_0": 22.22}, "custom_metrics": {}, "hist_stats": {"episode_reward": [160.0, 110.0, 150.0, 120.0, 150.0, 150.0, 220.0, 125.0, 170.0, 120.0, 180.0, 180.0, 140.0, 90.0, 200.0, 50.0, 140.0, 100.0, 200.0, 70.0, 250.0, 180.0, 225.0, 140.0, 110.0, 170.0, 160.0, 140.0, 340.0, 270.0, 160.0, 95.0, 190.0, 150.0, 135.0, 120.0, 240.0, 110.0, 110.0, 100.0, 190.0, 460.0, 280.0, 290.0, 150.0, 240.0, -55.0, 375.0, 150.0, 270.0, 440.0, 220.0, 295.0, 140.0, 200.0, 310.0, 160.0, 220.0, 340.0, 200.0, 110.0, 310.0, 300.0, 135.0, 260.0, 320.0, 220.0, 340.0, 170.0, 110.0, 170.0, 330.0, 330.0, 175.0, 580.0, 180.0, 340.0, 210.0, 190.0, 140.0, 210.0, 520.0, 140.0, 280.0, 380.0, 330.0, 350.0, 590.0, 220.0, 240.0, 140.0, 495.0, 370.0, 270.0, 110.0, 150.0, 390.0, 200.0, 520.0, 300.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 30.0, 30.0, 10.0, 0.0, 50.0, 0.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 0.0, 30.0, 20.0, 0.0, 10.0, 0.0, 0.0, 20.0, 40.0, 30.0, 10.0, 10.0, 0.0, 10.0, 30.0, 0.0, 10.0, 10.0, 10.0, 30.0, 20.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 20.0, 0.0, 30.0, 0.0, 20.0, 50.0, 0.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 10.0, 30.0, 20.0, 0.0, 0.0, 20.0, 60.0, 0.0, 0.0, 30.0, 30.0, 40.0, 40.0, -5.0, 10.0, 10.0, 20.0, 10.0, 10.0, 30.0, 0.0, 10.0, 30.0, 10.0, 40.0, 10.0, 30.0, 20.0, 30.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 0.0, 20.0, 0.0, 40.0, 0.0, 20.0, 0.0, 30.0, 20.0, 0.0, 20.0, 50.0, 30.0, 10.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 30.0, 20.0, 10.0, 70.0, 30.0, 30.0, 0.0, 0.0, 30.0, 10.0, 20.0, 40.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 40.0, 0.0, 0.0, 0.0, 20.0, 30.0, 60.0, 30.0, 0.0, 0.0, 10.0, 10.0, 40.0, 10.0, 10.0, 20.0, 10.0, -80.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 30.0, 40.0, 0.0, 10.0, 20.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 30.0, 0.0, 20.0, 10.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 30.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 0.0, 80.0, 10.0, 50.0, 30.0, 20.0, 10.0, 10.0, 10.0, 30.0, 0.0, 20.0, 30.0, 40.0, 20.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 70.0, 0.0, 40.0, 20.0, 10.0, 0.0, 20.0, 10.0, 60.0, -5.0, 60.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 0.0, 20.0, 10.0, 50.0, 0.0, 10.0, 0.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 60.0, 30.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 30.0, 30.0, 20.0, 20.0, 0.0, 30.0, 30.0, 0.0, 150.0, 30.0, 30.0, 40.0, 10.0, 20.0, 0.0, 10.0, 0.0, 160.0, 10.0, 10.0, 10.0, 20.0, 10.0, 40.0, 0.0, 0.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 0.0, 40.0, 10.0, 0.0, 20.0, 5.0, 0.0, 0.0, 0.0, 20.0, 40.0, 0.0, 0.0, 50.0, 0.0, 20.0, 40.0, 10.0, 40.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 20.0, 30.0, 20.0, 0.0, 20.0, 30.0, 0.0, 30.0, 10.0, -5.0, 20.0, 0.0, 10.0, 10.0, 20.0, 40.0, 0.0, 40.0, 10.0, 10.0, 0.0, 30.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 60.0, 40.0, 0.0, 10.0, 50.0, 10.0, 0.0, 60.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 40.0, 10.0, 10.0, 20.0, 0.0, 0.0, 40.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 40.0, 10.0, 20.0, 0.0, 50.0, 0.0, 10.0, 0.0, 10.0, 20.0, 50.0, 40.0, 10.0, 10.0, 20.0, 20.0, 0.0, 20.0, 40.0, 280.0, 30.0, 20.0, 20.0, -30.0, 30.0, 0.0, 180.0, 10.0, 30.0, 20.0, 0.0, 30.0, 10.0, 10.0, 60.0, 30.0, 20.0, 10.0, 90.0, 10.0, 10.0, 10.0, 40.0, 10.0, 20.0, 30.0, 20.0, 10.0, 10.0, 0.0, 40.0, 10.0, 0.0, 40.0, 10.0, 10.0, 20.0, 60.0, 30.0, 10.0, 30.0, 0.0, 30.0, 10.0, 10.0, 40.0, 0.0, 20.0, 0.0, 20.0, 0.0, 50.0, -205.0, 10.0, 10.0, 10.0, 0.0, 30.0, 15.0, 50.0, 0.0, 90.0, 160.0, 0.0, 20.0, 10.0, 20.0, 0.0, 30.0, 30.0, 10.0, 10.0, 20.0, 20.0, 50.0, 40.0, 10.0, 10.0, 0.0, 80.0, 20.0, 0.0, 40.0, 50.0, 10.0, 250.0, 10.0, 30.0, 0.0, 10.0, 30.0, 20.0, 30.0, 0.0, 70.0, 0.0, 20.0, 20.0, 20.0, 30.0, 0.0, 40.0, 20.0, 150.0, 20.0, 0.0, 0.0, -15.0, 10.0, 80.0, 10.0, 10.0, 30.0, 0.0, 10.0, 10.0, 60.0, 10.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 30.0, 30.0, 10.0, 40.0, 0.0, 0.0, 10.0, 50.0, 30.0, 30.0, 20.0, 0.0, 0.0, 160.0, 30.0, 0.0, 20.0, 30.0, 20.0, 20.0, 40.0, 10.0, 0.0, 0.0, 0.0, 30.0, 50.0, 0.0, 10.0, 10.0, 0.0, 40.0, 20.0, 60.0, 10.0, 0.0, 30.0, 30.0, 20.0, 10.0, 40.0, -100.0, 10.0, 20.0, 0.0, 190.0, 70.0, 30.0, 70.0, 20.0, 20.0, 0.0, 10.0, 20.0, 30.0, 0.0, 50.0, 40.0, 10.0, 30.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 40.0, 10.0, 0.0, 40.0, 10.0, 0.0, 10.0, 10.0, 160.0, 30.0, 80.0, 30.0, 20.0, 0.0, 50.0, 40.0, 20.0, 0.0, 30.0, 30.0, 0.0, 10.0, 25.0, 20.0, 50.0, 0.0, 20.0, 10.0, 0.0, 0.0, 30.0, 10.0, 30.0, 30.0, 10.0, 0.0, 30.0, 0.0, 30.0, 90.0, 0.0, 90.0, 20.0, 160.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 50.0, 0.0, 10.0, 30.0, 0.0, 40.0, 30.0, 0.0, 30.0, 30.0, 60.0, 10.0, 10.0, -30.0, 20.0, 50.0, 0.0, 40.0, 150.0, 0.0, 10.0, 0.0, 20.0, 40.0, 0.0, 20.0, 10.0, 40.0, 30.0, 30.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 50.0, 80.0, 30.0, 0.0, 0.0, 0.0, 40.0, 150.0, 10.0, 10.0, 0.0, 30.0, 10.0, 40.0, 30.0, 10.0, 30.0, 20.0, 0.0, 10.0, 10.0, 40.0, 30.0, 20.0, 10.0, 160.0, 0.0, 50.0, 30.0, 10.0, 0.0, 30.0, 0.0, -5.0, 20.0, 40.0, 30.0, 0.0, 120.0, 30.0, 40.0, 160.0, 30.0, -50.0, 180.0, 40.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 40.0, 20.0, 10.0, 0.0, 30.0, -40.0, 250.0, 60.0, -40.0, 0.0, 30.0, 0.0, 30.0, 20.0, 0.0, 20.0, 50.0, 0.0, 20.0, 40.0, 40.0, 20.0, 20.0, 0.0, 10.0, 40.0, 20.0, 10.0, 50.0, 30.0, 10.0, 0.0, 0.0, 20.0, 10.0, 20.0, 30.0, 0.0, 0.0, 40.0, 10.0, 0.0, 30.0, 0.0, 10.0, 80.0, 10.0, 10.0, 10.0, 30.0, 30.0, 20.0, 10.0, 0.0, 50.0, 0.0, 40.0, 0.0, 20.0, 30.0, 50.0, 30.0, 280.0, 20.0, 0.0, 20.0, 20.0, 50.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 20.0, 30.0, 20.0, 20.0, 70.0, 60.0, 10.0, 30.0, 20.0, 80.0, 30.0, 50.0, -50.0, 160.0, 0.0, 0.0, 30.0, 50.0, 30.0, 50.0, 20.0, 40.0, 40.0, 30.0, 70.0, 30.0, 0.0, 40.0, 10.0, 10.0, 180.0, 60.0, 10.0, 20.0, 0.0, 20.0, 0.0, 20.0, 30.0, 10.0, 380.0, 20.0, 20.0, 90.0, 0.0, 10.0, 10.0, 20.0, 30.0, 30.0, 40.0, 10.0, 10.0, 10.0, 0.0, 20.0, 60.0, 30.0, 10.0, 0.0, 0.0, 50.0, 20.0, 30.0, 50.0, 20.0, 30.0, 20.0, 20.0, 0.0, 20.0, 30.0, 20.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 30.0, 20.0, -40.0, 15.0, 0.0, 60.0, 0.0, 350.0, 50.0, 10.0, 10.0, 50.0, 0.0, 10.0, 20.0, 40.0, 40.0, 40.0, 10.0, 150.0, 20.0, 40.0, 0.0, 30.0, 30.0, 0.0, 0.0, 30.0, 100.0, 20.0, 20.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 40.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 30.0, 30.0, 50.0, 10.0, 0.0, 10.0, 30.0, 10.0, 250.0, 30.0, 0.0, 0.0, 20.0, 20.0, 10.0, 40.0, 0.0, 20.0, 10.0, 60.0, 0.0, 20.0, 60.0, 30.0, -30.0, 20.0, 20.0, 30.0, 360.0, 10.0, 0.0, 20.0, 0.0, 160.0, 20.0, 70.0, 20.0, -20.0, 0.0, 10.0, 20.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1747767088716454, "mean_inference_ms": 2.404019225801635, "mean_action_processing_ms": 0.5937245023904475, "mean_env_wait_ms": 1.8886549708603046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05850815773010254, "StateBufferConnector_ms": 0.009782791137695312, "ViewRequirementAgentConnector_ms": 0.3746645450592041}, "num_episodes": 27, "episode_return_max": 590.0, "episode_return_min": -55.0, "episode_return_mean": 222.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.50222796922873, "num_env_steps_trained_throughput_per_sec": 36.50222796922873, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 123046.482, "restore_workers_time_ms": 0.016, "training_step_time_ms": 123046.427, "sample_time_ms": 3109.908, "learn_time_ms": 119916.144, "learn_throughput": 33.357, "synch_weights_time_ms": 11.924}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "training_iteration": 15, "trial_id": "57140_00000", "date": "2024-06-26_23-47-22", "timestamp": 1719460042, "time_this_iter_s": 109.5943820476532, "time_total_s": 1969.0999789237976, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3e6d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 1969.0999789237976, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 15.50709677419355, "ram_util_percent": 79.10193548387099}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7185095086043127, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.5522188428618784, "policy_loss": -0.006943252533205603, "vf_loss": 3.5581458959589622, "vf_explained_var": 0.0031148627416267434, "kl": 0.010161931712499704, "entropy": 1.3079423946059676, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 145545.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "env_runners": {"episode_reward_max": 740.0, "episode_reward_min": -55.0, "episode_reward_mean": 244.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -205.0}, "policy_reward_max": {"policy_0": 380.0}, "policy_reward_mean": {"policy_0": 24.42}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 70.0, 250.0, 180.0, 225.0, 140.0, 110.0, 170.0, 160.0, 140.0, 340.0, 270.0, 160.0, 95.0, 190.0, 150.0, 135.0, 120.0, 240.0, 110.0, 110.0, 100.0, 190.0, 460.0, 280.0, 290.0, 150.0, 240.0, -55.0, 375.0, 150.0, 270.0, 440.0, 220.0, 295.0, 140.0, 200.0, 310.0, 160.0, 220.0, 340.0, 200.0, 110.0, 310.0, 300.0, 135.0, 260.0, 320.0, 220.0, 340.0, 170.0, 110.0, 170.0, 330.0, 330.0, 175.0, 580.0, 180.0, 340.0, 210.0, 190.0, 140.0, 210.0, 520.0, 140.0, 280.0, 380.0, 330.0, 350.0, 590.0, 220.0, 240.0, 140.0, 495.0, 370.0, 270.0, 110.0, 150.0, 390.0, 200.0, 520.0, 300.0, 390.0, 300.0, 160.0, 170.0, 270.0, 240.0, 350.0, 220.0, 225.0, 150.0, 350.0, 70.0, 140.0, 280.0, 210.0, 320.0, 740.0, 170.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 30.0, 30.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 30.0, 10.0, 10.0, 0.0, 0.0, 80.0, 10.0, 50.0, 30.0, 20.0, 10.0, 10.0, 10.0, 30.0, 0.0, 20.0, 30.0, 40.0, 20.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 70.0, 0.0, 40.0, 20.0, 10.0, 0.0, 20.0, 10.0, 60.0, -5.0, 60.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 0.0, 20.0, 10.0, 50.0, 0.0, 10.0, 0.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 60.0, 30.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 30.0, 30.0, 20.0, 20.0, 0.0, 30.0, 30.0, 0.0, 150.0, 30.0, 30.0, 40.0, 10.0, 20.0, 0.0, 10.0, 0.0, 160.0, 10.0, 10.0, 10.0, 20.0, 10.0, 40.0, 0.0, 0.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 0.0, 40.0, 10.0, 0.0, 20.0, 5.0, 0.0, 0.0, 0.0, 20.0, 40.0, 0.0, 0.0, 50.0, 0.0, 20.0, 40.0, 10.0, 40.0, 20.0, 0.0, 10.0, 20.0, 0.0, 10.0, 20.0, 30.0, 20.0, 0.0, 20.0, 30.0, 0.0, 30.0, 10.0, -5.0, 20.0, 0.0, 10.0, 10.0, 20.0, 40.0, 0.0, 40.0, 10.0, 10.0, 0.0, 30.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 60.0, 40.0, 0.0, 10.0, 50.0, 10.0, 0.0, 60.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 40.0, 10.0, 10.0, 20.0, 0.0, 0.0, 40.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 40.0, 10.0, 20.0, 0.0, 50.0, 0.0, 10.0, 0.0, 10.0, 20.0, 50.0, 40.0, 10.0, 10.0, 20.0, 20.0, 0.0, 20.0, 40.0, 280.0, 30.0, 20.0, 20.0, -30.0, 30.0, 0.0, 180.0, 10.0, 30.0, 20.0, 0.0, 30.0, 10.0, 10.0, 60.0, 30.0, 20.0, 10.0, 90.0, 10.0, 10.0, 10.0, 40.0, 10.0, 20.0, 30.0, 20.0, 10.0, 10.0, 0.0, 40.0, 10.0, 0.0, 40.0, 10.0, 10.0, 20.0, 60.0, 30.0, 10.0, 30.0, 0.0, 30.0, 10.0, 10.0, 40.0, 0.0, 20.0, 0.0, 20.0, 0.0, 50.0, -205.0, 10.0, 10.0, 10.0, 0.0, 30.0, 15.0, 50.0, 0.0, 90.0, 160.0, 0.0, 20.0, 10.0, 20.0, 0.0, 30.0, 30.0, 10.0, 10.0, 20.0, 20.0, 50.0, 40.0, 10.0, 10.0, 0.0, 80.0, 20.0, 0.0, 40.0, 50.0, 10.0, 250.0, 10.0, 30.0, 0.0, 10.0, 30.0, 20.0, 30.0, 0.0, 70.0, 0.0, 20.0, 20.0, 20.0, 30.0, 0.0, 40.0, 20.0, 150.0, 20.0, 0.0, 0.0, -15.0, 10.0, 80.0, 10.0, 10.0, 30.0, 0.0, 10.0, 10.0, 60.0, 10.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 30.0, 30.0, 10.0, 40.0, 0.0, 0.0, 10.0, 50.0, 30.0, 30.0, 20.0, 0.0, 0.0, 160.0, 30.0, 0.0, 20.0, 30.0, 20.0, 20.0, 40.0, 10.0, 0.0, 0.0, 0.0, 30.0, 50.0, 0.0, 10.0, 10.0, 0.0, 40.0, 20.0, 60.0, 10.0, 0.0, 30.0, 30.0, 20.0, 10.0, 40.0, -100.0, 10.0, 20.0, 0.0, 190.0, 70.0, 30.0, 70.0, 20.0, 20.0, 0.0, 10.0, 20.0, 30.0, 0.0, 50.0, 40.0, 10.0, 30.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 40.0, 10.0, 0.0, 40.0, 10.0, 0.0, 10.0, 10.0, 160.0, 30.0, 80.0, 30.0, 20.0, 0.0, 50.0, 40.0, 20.0, 0.0, 30.0, 30.0, 0.0, 10.0, 25.0, 20.0, 50.0, 0.0, 20.0, 10.0, 0.0, 0.0, 30.0, 10.0, 30.0, 30.0, 10.0, 0.0, 30.0, 0.0, 30.0, 90.0, 0.0, 90.0, 20.0, 160.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 50.0, 0.0, 10.0, 30.0, 0.0, 40.0, 30.0, 0.0, 30.0, 30.0, 60.0, 10.0, 10.0, -30.0, 20.0, 50.0, 0.0, 40.0, 150.0, 0.0, 10.0, 0.0, 20.0, 40.0, 0.0, 20.0, 10.0, 40.0, 30.0, 30.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 50.0, 80.0, 30.0, 0.0, 0.0, 0.0, 40.0, 150.0, 10.0, 10.0, 0.0, 30.0, 10.0, 40.0, 30.0, 10.0, 30.0, 20.0, 0.0, 10.0, 10.0, 40.0, 30.0, 20.0, 10.0, 160.0, 0.0, 50.0, 30.0, 10.0, 0.0, 30.0, 0.0, -5.0, 20.0, 40.0, 30.0, 0.0, 120.0, 30.0, 40.0, 160.0, 30.0, -50.0, 180.0, 40.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 40.0, 20.0, 10.0, 0.0, 30.0, -40.0, 250.0, 60.0, -40.0, 0.0, 30.0, 0.0, 30.0, 20.0, 0.0, 20.0, 50.0, 0.0, 20.0, 40.0, 40.0, 20.0, 20.0, 0.0, 10.0, 40.0, 20.0, 10.0, 50.0, 30.0, 10.0, 0.0, 0.0, 20.0, 10.0, 20.0, 30.0, 0.0, 0.0, 40.0, 10.0, 0.0, 30.0, 0.0, 10.0, 80.0, 10.0, 10.0, 10.0, 30.0, 30.0, 20.0, 10.0, 0.0, 50.0, 0.0, 40.0, 0.0, 20.0, 30.0, 50.0, 30.0, 280.0, 20.0, 0.0, 20.0, 20.0, 50.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 20.0, 30.0, 20.0, 20.0, 70.0, 60.0, 10.0, 30.0, 20.0, 80.0, 30.0, 50.0, -50.0, 160.0, 0.0, 0.0, 30.0, 50.0, 30.0, 50.0, 20.0, 40.0, 40.0, 30.0, 70.0, 30.0, 0.0, 40.0, 10.0, 10.0, 180.0, 60.0, 10.0, 20.0, 0.0, 20.0, 0.0, 20.0, 30.0, 10.0, 380.0, 20.0, 20.0, 90.0, 0.0, 10.0, 10.0, 20.0, 30.0, 30.0, 40.0, 10.0, 10.0, 10.0, 0.0, 20.0, 60.0, 30.0, 10.0, 0.0, 0.0, 50.0, 20.0, 30.0, 50.0, 20.0, 30.0, 20.0, 20.0, 0.0, 20.0, 30.0, 20.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 30.0, 20.0, -40.0, 15.0, 0.0, 60.0, 0.0, 350.0, 50.0, 10.0, 10.0, 50.0, 0.0, 10.0, 20.0, 40.0, 40.0, 40.0, 10.0, 150.0, 20.0, 40.0, 0.0, 30.0, 30.0, 0.0, 0.0, 30.0, 100.0, 20.0, 20.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 40.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 30.0, 30.0, 50.0, 10.0, 0.0, 10.0, 30.0, 10.0, 250.0, 30.0, 0.0, 0.0, 20.0, 20.0, 10.0, 40.0, 0.0, 20.0, 10.0, 60.0, 0.0, 20.0, 60.0, 30.0, -30.0, 20.0, 20.0, 30.0, 360.0, 10.0, 0.0, 20.0, 0.0, 160.0, 20.0, 70.0, 20.0, -20.0, 0.0, 10.0, 20.0, 20.0, 0.0, 30.0, 30.0, 170.0, 70.0, 20.0, 0.0, 30.0, 10.0, 30.0, 0.0, 0.0, 0.0, 10.0, 40.0, 10.0, 170.0, 0.0, 50.0, 20.0, 10.0, 0.0, 10.0, 50.0, 0.0, 50.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 40.0, 10.0, 40.0, 0.0, 20.0, 30.0, 0.0, 50.0, 20.0, 20.0, 10.0, 30.0, 30.0, 20.0, 50.0, 30.0, 10.0, 10.0, 40.0, 20.0, 60.0, 60.0, 30.0, 20.0, 20.0, -40.0, 20.0, 20.0, 20.0, -30.0, 210.0, 30.0, 20.0, 0.0, 0.0, 20.0, 60.0, 40.0, 20.0, 20.0, 10.0, 20.0, 20.0, 50.0, 10.0, 30.0, 0.0, 20.0, 70.0, 0.0, -5.0, 40.0, 10.0, 0.0, 30.0, 50.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 30.0, 40.0, 10.0, 20.0, 10.0, 0.0, 40.0, 0.0, 10.0, -40.0, 0.0, 60.0, 260.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 40.0, 10.0, 0.0, 0.0, 20.0, 30.0, 0.0, 20.0, 30.0, 0.0, 20.0, 10.0, 10.0, 0.0, 50.0, 0.0, 40.0, 20.0, 30.0, 20.0, 10.0, 40.0, 70.0, 0.0, 40.0, 0.0, 0.0, 20.0, 10.0, 0.0, 30.0, 30.0, 70.0, 10.0, 50.0, 10.0, 30.0, 30.0, 40.0, 20.0, 10.0, 40.0, 200.0, -110.0, 170.0, 0.0, 170.0, 180.0, 20.0, 0.0, 30.0, 40.0, 100.0, 30.0, 10.0, 10.0, 0.0, 50.0, 20.0, 20.0, 10.0, 50.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.1173986007031633, "mean_inference_ms": 2.3428267539497916, "mean_action_processing_ms": 0.5795493356886944, "mean_env_wait_ms": 1.8443534120483023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058362483978271484, "StateBufferConnector_ms": 0.009779214859008789, "ViewRequirementAgentConnector_ms": 0.36519837379455566}, "num_episodes": 18, "episode_return_max": 740.0, "episode_return_min": -55.0, "episode_return_mean": 244.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.49907375954707, "num_env_steps_trained_throughput_per_sec": 36.49907375954707, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 118877.478, "restore_workers_time_ms": 0.015, "training_step_time_ms": 118877.42, "sample_time_ms": 2957.309, "learn_time_ms": 115899.61, "learn_throughput": 34.513, "synch_weights_time_ms": 11.708}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "training_iteration": 16, "trial_id": "57140_00000", "date": "2024-06-26_23-49-11", "timestamp": 1719460151, "time_this_iter_s": 109.60281801223755, "time_total_s": 2078.702796936035, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3f6c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2078.702796936035, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 16.07741935483871, "ram_util_percent": 78.98967741935485}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5512208895593151, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.3683623563240386, "policy_loss": -0.006011910325263878, "vf_loss": 3.373504928163827, "vf_explained_var": 0.0004903921938805789, "kl": 0.008693362438230419, "entropy": 1.3071003469669273, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 154935.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "env_runners": {"episode_reward_max": 740.0, "episode_reward_min": -55.0, "episode_reward_mean": 255.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -205.0}, "policy_reward_max": {"policy_0": 380.0}, "policy_reward_mean": {"policy_0": 25.575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [240.0, 110.0, 110.0, 100.0, 190.0, 460.0, 280.0, 290.0, 150.0, 240.0, -55.0, 375.0, 150.0, 270.0, 440.0, 220.0, 295.0, 140.0, 200.0, 310.0, 160.0, 220.0, 340.0, 200.0, 110.0, 310.0, 300.0, 135.0, 260.0, 320.0, 220.0, 340.0, 170.0, 110.0, 170.0, 330.0, 330.0, 175.0, 580.0, 180.0, 340.0, 210.0, 190.0, 140.0, 210.0, 520.0, 140.0, 280.0, 380.0, 330.0, 350.0, 590.0, 220.0, 240.0, 140.0, 495.0, 370.0, 270.0, 110.0, 150.0, 390.0, 200.0, 520.0, 300.0, 390.0, 300.0, 160.0, 170.0, 270.0, 240.0, 350.0, 220.0, 225.0, 150.0, 350.0, 70.0, 140.0, 280.0, 210.0, 320.0, 740.0, 170.0, 280.0, -20.0, 600.0, 200.0, 330.0, 130.0, 200.0, 410.0, 150.0, 380.0, 135.0, 140.0, 260.0, 140.0, 175.0, 180.0, 370.0, 200.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 10.0, 60.0, 40.0, 0.0, 10.0, 50.0, 10.0, 0.0, 60.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 40.0, 10.0, 10.0, 20.0, 0.0, 0.0, 40.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 0.0, 40.0, 10.0, 20.0, 0.0, 50.0, 0.0, 10.0, 0.0, 10.0, 20.0, 50.0, 40.0, 10.0, 10.0, 20.0, 20.0, 0.0, 20.0, 40.0, 280.0, 30.0, 20.0, 20.0, -30.0, 30.0, 0.0, 180.0, 10.0, 30.0, 20.0, 0.0, 30.0, 10.0, 10.0, 60.0, 30.0, 20.0, 10.0, 90.0, 10.0, 10.0, 10.0, 40.0, 10.0, 20.0, 30.0, 20.0, 10.0, 10.0, 0.0, 40.0, 10.0, 0.0, 40.0, 10.0, 10.0, 20.0, 60.0, 30.0, 10.0, 30.0, 0.0, 30.0, 10.0, 10.0, 40.0, 0.0, 20.0, 0.0, 20.0, 0.0, 50.0, -205.0, 10.0, 10.0, 10.0, 0.0, 30.0, 15.0, 50.0, 0.0, 90.0, 160.0, 0.0, 20.0, 10.0, 20.0, 0.0, 30.0, 30.0, 10.0, 10.0, 20.0, 20.0, 50.0, 40.0, 10.0, 10.0, 0.0, 80.0, 20.0, 0.0, 40.0, 50.0, 10.0, 250.0, 10.0, 30.0, 0.0, 10.0, 30.0, 20.0, 30.0, 0.0, 70.0, 0.0, 20.0, 20.0, 20.0, 30.0, 0.0, 40.0, 20.0, 150.0, 20.0, 0.0, 0.0, -15.0, 10.0, 80.0, 10.0, 10.0, 30.0, 0.0, 10.0, 10.0, 60.0, 10.0, 0.0, 0.0, 30.0, 20.0, 0.0, 0.0, 30.0, 30.0, 10.0, 40.0, 0.0, 0.0, 10.0, 50.0, 30.0, 30.0, 20.0, 0.0, 0.0, 160.0, 30.0, 0.0, 20.0, 30.0, 20.0, 20.0, 40.0, 10.0, 0.0, 0.0, 0.0, 30.0, 50.0, 0.0, 10.0, 10.0, 0.0, 40.0, 20.0, 60.0, 10.0, 0.0, 30.0, 30.0, 20.0, 10.0, 40.0, -100.0, 10.0, 20.0, 0.0, 190.0, 70.0, 30.0, 70.0, 20.0, 20.0, 0.0, 10.0, 20.0, 30.0, 0.0, 50.0, 40.0, 10.0, 30.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 40.0, 10.0, 0.0, 40.0, 10.0, 0.0, 10.0, 10.0, 160.0, 30.0, 80.0, 30.0, 20.0, 0.0, 50.0, 40.0, 20.0, 0.0, 30.0, 30.0, 0.0, 10.0, 25.0, 20.0, 50.0, 0.0, 20.0, 10.0, 0.0, 0.0, 30.0, 10.0, 30.0, 30.0, 10.0, 0.0, 30.0, 0.0, 30.0, 90.0, 0.0, 90.0, 20.0, 160.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 50.0, 0.0, 10.0, 30.0, 0.0, 40.0, 30.0, 0.0, 30.0, 30.0, 60.0, 10.0, 10.0, -30.0, 20.0, 50.0, 0.0, 40.0, 150.0, 0.0, 10.0, 0.0, 20.0, 40.0, 0.0, 20.0, 10.0, 40.0, 30.0, 30.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 50.0, 80.0, 30.0, 0.0, 0.0, 0.0, 40.0, 150.0, 10.0, 10.0, 0.0, 30.0, 10.0, 40.0, 30.0, 10.0, 30.0, 20.0, 0.0, 10.0, 10.0, 40.0, 30.0, 20.0, 10.0, 160.0, 0.0, 50.0, 30.0, 10.0, 0.0, 30.0, 0.0, -5.0, 20.0, 40.0, 30.0, 0.0, 120.0, 30.0, 40.0, 160.0, 30.0, -50.0, 180.0, 40.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 40.0, 20.0, 10.0, 0.0, 30.0, -40.0, 250.0, 60.0, -40.0, 0.0, 30.0, 0.0, 30.0, 20.0, 0.0, 20.0, 50.0, 0.0, 20.0, 40.0, 40.0, 20.0, 20.0, 0.0, 10.0, 40.0, 20.0, 10.0, 50.0, 30.0, 10.0, 0.0, 0.0, 20.0, 10.0, 20.0, 30.0, 0.0, 0.0, 40.0, 10.0, 0.0, 30.0, 0.0, 10.0, 80.0, 10.0, 10.0, 10.0, 30.0, 30.0, 20.0, 10.0, 0.0, 50.0, 0.0, 40.0, 0.0, 20.0, 30.0, 50.0, 30.0, 280.0, 20.0, 0.0, 20.0, 20.0, 50.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 20.0, 30.0, 20.0, 20.0, 70.0, 60.0, 10.0, 30.0, 20.0, 80.0, 30.0, 50.0, -50.0, 160.0, 0.0, 0.0, 30.0, 50.0, 30.0, 50.0, 20.0, 40.0, 40.0, 30.0, 70.0, 30.0, 0.0, 40.0, 10.0, 10.0, 180.0, 60.0, 10.0, 20.0, 0.0, 20.0, 0.0, 20.0, 30.0, 10.0, 380.0, 20.0, 20.0, 90.0, 0.0, 10.0, 10.0, 20.0, 30.0, 30.0, 40.0, 10.0, 10.0, 10.0, 0.0, 20.0, 60.0, 30.0, 10.0, 0.0, 0.0, 50.0, 20.0, 30.0, 50.0, 20.0, 30.0, 20.0, 20.0, 0.0, 20.0, 30.0, 20.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 30.0, 20.0, -40.0, 15.0, 0.0, 60.0, 0.0, 350.0, 50.0, 10.0, 10.0, 50.0, 0.0, 10.0, 20.0, 40.0, 40.0, 40.0, 10.0, 150.0, 20.0, 40.0, 0.0, 30.0, 30.0, 0.0, 0.0, 30.0, 100.0, 20.0, 20.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 40.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 30.0, 30.0, 50.0, 10.0, 0.0, 10.0, 30.0, 10.0, 250.0, 30.0, 0.0, 0.0, 20.0, 20.0, 10.0, 40.0, 0.0, 20.0, 10.0, 60.0, 0.0, 20.0, 60.0, 30.0, -30.0, 20.0, 20.0, 30.0, 360.0, 10.0, 0.0, 20.0, 0.0, 160.0, 20.0, 70.0, 20.0, -20.0, 0.0, 10.0, 20.0, 20.0, 0.0, 30.0, 30.0, 170.0, 70.0, 20.0, 0.0, 30.0, 10.0, 30.0, 0.0, 0.0, 0.0, 10.0, 40.0, 10.0, 170.0, 0.0, 50.0, 20.0, 10.0, 0.0, 10.0, 50.0, 0.0, 50.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 40.0, 10.0, 40.0, 0.0, 20.0, 30.0, 0.0, 50.0, 20.0, 20.0, 10.0, 30.0, 30.0, 20.0, 50.0, 30.0, 10.0, 10.0, 40.0, 20.0, 60.0, 60.0, 30.0, 20.0, 20.0, -40.0, 20.0, 20.0, 20.0, -30.0, 210.0, 30.0, 20.0, 0.0, 0.0, 20.0, 60.0, 40.0, 20.0, 20.0, 10.0, 20.0, 20.0, 50.0, 10.0, 30.0, 0.0, 20.0, 70.0, 0.0, -5.0, 40.0, 10.0, 0.0, 30.0, 50.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 30.0, 40.0, 10.0, 20.0, 10.0, 0.0, 40.0, 0.0, 10.0, -40.0, 0.0, 60.0, 260.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 40.0, 10.0, 0.0, 0.0, 20.0, 30.0, 0.0, 20.0, 30.0, 0.0, 20.0, 10.0, 10.0, 0.0, 50.0, 0.0, 40.0, 20.0, 30.0, 20.0, 10.0, 40.0, 70.0, 0.0, 40.0, 0.0, 0.0, 20.0, 10.0, 0.0, 30.0, 30.0, 70.0, 10.0, 50.0, 10.0, 30.0, 30.0, 40.0, 20.0, 10.0, 40.0, 200.0, -110.0, 170.0, 0.0, 170.0, 180.0, 20.0, 0.0, 30.0, 40.0, 100.0, 30.0, 10.0, 10.0, 0.0, 50.0, 20.0, 20.0, 10.0, 50.0, 0.0, 0.0, 10.0, 40.0, 10.0, 40.0, 40.0, 30.0, 30.0, 40.0, 20.0, 20.0, 40.0, -175.0, 0.0, 0.0, 40.0, 0.0, 50.0, 0.0, 15.0, 10.0, 50.0, 170.0, 60.0, 40.0, 10.0, 20.0, 30.0, 180.0, 0.0, 40.0, 30.0, 60.0, 10.0, 10.0, 10.0, 0.0, 20.0, 40.0, 10.0, 10.0, 10.0, -40.0, 10.0, 0.0, 40.0, 0.0, 40.0, 10.0, 10.0, 250.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 40.0, 0.0, 20.0, 10.0, 0.0, 30.0, 50.0, 10.0, 0.0, 10.0, 50.0, 30.0, 0.0, 20.0, 20.0, 260.0, 10.0, -100.0, 30.0, 100.0, -20.0, 40.0, 70.0, 0.0, 10.0, 20.0, 50.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, -40.0, 20.0, 0.0, 10.0, 270.0, 10.0, 20.0, 20.0, 50.0, 20.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 20.0, 25.0, 30.0, 0.0, 10.0, 0.0, 0.0, 60.0, 0.0, 10.0, 20.0, 10.0, 0.0, 30.0, 80.0, 20.0, 30.0, 50.0, 10.0, 80.0, -10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 30.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 40.0, 40.0, 10.0, 0.0, 20.0, -5.0, 50.0, 10.0, 10.0, 20.0, 20.0, 10.0, 40.0, 10.0, 60.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 20.0, 40.0, 100.0, 30.0, 20.0, 50.0, 30.0, 40.0, 40.0, 0.0, 30.0, 50.0, 0.0, 20.0, 20.0, 10.0, 20.0, 50.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.068868533636728, "mean_inference_ms": 2.2900435794654634, "mean_action_processing_ms": 0.5674549911481818, "mean_env_wait_ms": 1.806218375801307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05821394920349121, "StateBufferConnector_ms": 0.00977325439453125, "ViewRequirementAgentConnector_ms": 0.3726506233215332}, "num_episodes": 18, "episode_return_max": 740.0, "episode_return_min": -55.0, "episode_return_mean": 255.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.30301533589529, "num_env_steps_trained_throughput_per_sec": 36.30301533589529, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 115029.935, "restore_workers_time_ms": 0.015, "training_step_time_ms": 115029.876, "sample_time_ms": 2798.269, "learn_time_ms": 112211.528, "learn_throughput": 35.647, "synch_weights_time_ms": 11.488}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "training_iteration": 17, "trial_id": "57140_00000", "date": "2024-06-26_23-51-02", "timestamp": 1719460262, "time_this_iter_s": 110.1982638835907, "time_total_s": 2188.901060819626, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3e75e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2188.901060819626, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 16.65741935483871, "ram_util_percent": 79.49548387096773}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8290232975420733, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8699396546783285, "policy_loss": -0.006001586018698498, "vf_loss": 3.8751048747216044, "vf_explained_var": 0.0001230902819079967, "kl": 0.00836366327492779, "entropy": 1.2577645753646176, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 164325.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "env_runners": {"episode_reward_max": 740.0, "episode_reward_min": -20.0, "episode_reward_mean": 271.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -175.0}, "policy_reward_max": {"policy_0": 380.0}, "policy_reward_mean": {"policy_0": 27.175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 310.0, 160.0, 220.0, 340.0, 200.0, 110.0, 310.0, 300.0, 135.0, 260.0, 320.0, 220.0, 340.0, 170.0, 110.0, 170.0, 330.0, 330.0, 175.0, 580.0, 180.0, 340.0, 210.0, 190.0, 140.0, 210.0, 520.0, 140.0, 280.0, 380.0, 330.0, 350.0, 590.0, 220.0, 240.0, 140.0, 495.0, 370.0, 270.0, 110.0, 150.0, 390.0, 200.0, 520.0, 300.0, 390.0, 300.0, 160.0, 170.0, 270.0, 240.0, 350.0, 220.0, 225.0, 150.0, 350.0, 70.0, 140.0, 280.0, 210.0, 320.0, 740.0, 170.0, 280.0, -20.0, 600.0, 200.0, 330.0, 130.0, 200.0, 410.0, 150.0, 380.0, 135.0, 140.0, 260.0, 140.0, 175.0, 180.0, 370.0, 200.0, 440.0, 300.0, 100.0, 130.0, 320.0, 710.0, 480.0, 285.0, 195.0, 200.0, 240.0, 420.0, 210.0, 235.0, 210.0, 150.0, 680.0, 300.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 30.0, 30.0, 10.0, 40.0, 0.0, 0.0, 10.0, 50.0, 30.0, 30.0, 20.0, 0.0, 0.0, 160.0, 30.0, 0.0, 20.0, 30.0, 20.0, 20.0, 40.0, 10.0, 0.0, 0.0, 0.0, 30.0, 50.0, 0.0, 10.0, 10.0, 0.0, 40.0, 20.0, 60.0, 10.0, 0.0, 30.0, 30.0, 20.0, 10.0, 40.0, -100.0, 10.0, 20.0, 0.0, 190.0, 70.0, 30.0, 70.0, 20.0, 20.0, 0.0, 10.0, 20.0, 30.0, 0.0, 50.0, 40.0, 10.0, 30.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 10.0, 20.0, 0.0, 40.0, 10.0, 0.0, 40.0, 10.0, 0.0, 10.0, 10.0, 160.0, 30.0, 80.0, 30.0, 20.0, 0.0, 50.0, 40.0, 20.0, 0.0, 30.0, 30.0, 0.0, 10.0, 25.0, 20.0, 50.0, 0.0, 20.0, 10.0, 0.0, 0.0, 30.0, 10.0, 30.0, 30.0, 10.0, 0.0, 30.0, 0.0, 30.0, 90.0, 0.0, 90.0, 20.0, 160.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 50.0, 0.0, 10.0, 30.0, 0.0, 40.0, 30.0, 0.0, 30.0, 30.0, 60.0, 10.0, 10.0, -30.0, 20.0, 50.0, 0.0, 40.0, 150.0, 0.0, 10.0, 0.0, 20.0, 40.0, 0.0, 20.0, 10.0, 40.0, 30.0, 30.0, 0.0, 10.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 50.0, 80.0, 30.0, 0.0, 0.0, 0.0, 40.0, 150.0, 10.0, 10.0, 0.0, 30.0, 10.0, 40.0, 30.0, 10.0, 30.0, 20.0, 0.0, 10.0, 10.0, 40.0, 30.0, 20.0, 10.0, 160.0, 0.0, 50.0, 30.0, 10.0, 0.0, 30.0, 0.0, -5.0, 20.0, 40.0, 30.0, 0.0, 120.0, 30.0, 40.0, 160.0, 30.0, -50.0, 180.0, 40.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 40.0, 20.0, 10.0, 0.0, 30.0, -40.0, 250.0, 60.0, -40.0, 0.0, 30.0, 0.0, 30.0, 20.0, 0.0, 20.0, 50.0, 0.0, 20.0, 40.0, 40.0, 20.0, 20.0, 0.0, 10.0, 40.0, 20.0, 10.0, 50.0, 30.0, 10.0, 0.0, 0.0, 20.0, 10.0, 20.0, 30.0, 0.0, 0.0, 40.0, 10.0, 0.0, 30.0, 0.0, 10.0, 80.0, 10.0, 10.0, 10.0, 30.0, 30.0, 20.0, 10.0, 0.0, 50.0, 0.0, 40.0, 0.0, 20.0, 30.0, 50.0, 30.0, 280.0, 20.0, 0.0, 20.0, 20.0, 50.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 20.0, 30.0, 20.0, 20.0, 70.0, 60.0, 10.0, 30.0, 20.0, 80.0, 30.0, 50.0, -50.0, 160.0, 0.0, 0.0, 30.0, 50.0, 30.0, 50.0, 20.0, 40.0, 40.0, 30.0, 70.0, 30.0, 0.0, 40.0, 10.0, 10.0, 180.0, 60.0, 10.0, 20.0, 0.0, 20.0, 0.0, 20.0, 30.0, 10.0, 380.0, 20.0, 20.0, 90.0, 0.0, 10.0, 10.0, 20.0, 30.0, 30.0, 40.0, 10.0, 10.0, 10.0, 0.0, 20.0, 60.0, 30.0, 10.0, 0.0, 0.0, 50.0, 20.0, 30.0, 50.0, 20.0, 30.0, 20.0, 20.0, 0.0, 20.0, 30.0, 20.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 30.0, 20.0, -40.0, 15.0, 0.0, 60.0, 0.0, 350.0, 50.0, 10.0, 10.0, 50.0, 0.0, 10.0, 20.0, 40.0, 40.0, 40.0, 10.0, 150.0, 20.0, 40.0, 0.0, 30.0, 30.0, 0.0, 0.0, 30.0, 100.0, 20.0, 20.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 40.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 30.0, 30.0, 50.0, 10.0, 0.0, 10.0, 30.0, 10.0, 250.0, 30.0, 0.0, 0.0, 20.0, 20.0, 10.0, 40.0, 0.0, 20.0, 10.0, 60.0, 0.0, 20.0, 60.0, 30.0, -30.0, 20.0, 20.0, 30.0, 360.0, 10.0, 0.0, 20.0, 0.0, 160.0, 20.0, 70.0, 20.0, -20.0, 0.0, 10.0, 20.0, 20.0, 0.0, 30.0, 30.0, 170.0, 70.0, 20.0, 0.0, 30.0, 10.0, 30.0, 0.0, 0.0, 0.0, 10.0, 40.0, 10.0, 170.0, 0.0, 50.0, 20.0, 10.0, 0.0, 10.0, 50.0, 0.0, 50.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 40.0, 10.0, 40.0, 0.0, 20.0, 30.0, 0.0, 50.0, 20.0, 20.0, 10.0, 30.0, 30.0, 20.0, 50.0, 30.0, 10.0, 10.0, 40.0, 20.0, 60.0, 60.0, 30.0, 20.0, 20.0, -40.0, 20.0, 20.0, 20.0, -30.0, 210.0, 30.0, 20.0, 0.0, 0.0, 20.0, 60.0, 40.0, 20.0, 20.0, 10.0, 20.0, 20.0, 50.0, 10.0, 30.0, 0.0, 20.0, 70.0, 0.0, -5.0, 40.0, 10.0, 0.0, 30.0, 50.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 30.0, 40.0, 10.0, 20.0, 10.0, 0.0, 40.0, 0.0, 10.0, -40.0, 0.0, 60.0, 260.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 40.0, 10.0, 0.0, 0.0, 20.0, 30.0, 0.0, 20.0, 30.0, 0.0, 20.0, 10.0, 10.0, 0.0, 50.0, 0.0, 40.0, 20.0, 30.0, 20.0, 10.0, 40.0, 70.0, 0.0, 40.0, 0.0, 0.0, 20.0, 10.0, 0.0, 30.0, 30.0, 70.0, 10.0, 50.0, 10.0, 30.0, 30.0, 40.0, 20.0, 10.0, 40.0, 200.0, -110.0, 170.0, 0.0, 170.0, 180.0, 20.0, 0.0, 30.0, 40.0, 100.0, 30.0, 10.0, 10.0, 0.0, 50.0, 20.0, 20.0, 10.0, 50.0, 0.0, 0.0, 10.0, 40.0, 10.0, 40.0, 40.0, 30.0, 30.0, 40.0, 20.0, 20.0, 40.0, -175.0, 0.0, 0.0, 40.0, 0.0, 50.0, 0.0, 15.0, 10.0, 50.0, 170.0, 60.0, 40.0, 10.0, 20.0, 30.0, 180.0, 0.0, 40.0, 30.0, 60.0, 10.0, 10.0, 10.0, 0.0, 20.0, 40.0, 10.0, 10.0, 10.0, -40.0, 10.0, 0.0, 40.0, 0.0, 40.0, 10.0, 10.0, 250.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 40.0, 0.0, 20.0, 10.0, 0.0, 30.0, 50.0, 10.0, 0.0, 10.0, 50.0, 30.0, 0.0, 20.0, 20.0, 260.0, 10.0, -100.0, 30.0, 100.0, -20.0, 40.0, 70.0, 0.0, 10.0, 20.0, 50.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, -40.0, 20.0, 0.0, 10.0, 270.0, 10.0, 20.0, 20.0, 50.0, 20.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 20.0, 25.0, 30.0, 0.0, 10.0, 0.0, 0.0, 60.0, 0.0, 10.0, 20.0, 10.0, 0.0, 30.0, 80.0, 20.0, 30.0, 50.0, 10.0, 80.0, -10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 30.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 40.0, 40.0, 10.0, 0.0, 20.0, -5.0, 50.0, 10.0, 10.0, 20.0, 20.0, 10.0, 40.0, 10.0, 60.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 20.0, 40.0, 100.0, 30.0, 20.0, 50.0, 30.0, 40.0, 40.0, 0.0, 30.0, 50.0, 0.0, 20.0, 20.0, 10.0, 20.0, 50.0, 0.0, 0.0, 50.0, 30.0, 30.0, 0.0, 60.0, 30.0, 180.0, 10.0, 20.0, 30.0, 10.0, 110.0, 0.0, 0.0, 10.0, 90.0, 50.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 20.0, 20.0, 0.0, 10.0, 30.0, 10.0, 0.0, 10.0, 30.0, 20.0, 10.0, 0.0, 10.0, 10.0, 30.0, 10.0, 0.0, 0.0, 100.0, 10.0, 10.0, 80.0, 60.0, 20.0, 20.0, 20.0, 80.0, 250.0, 10.0, 190.0, 60.0, 30.0, 0.0, 50.0, 150.0, 40.0, 40.0, 50.0, 30.0, 0.0, 100.0, 10.0, 30.0, 30.0, 20.0, 40.0, 0.0, 10.0, 0.0, 250.0, 0.0, 5.0, 10.0, -50.0, 10.0, 40.0, 40.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 5.0, 20.0, 0.0, 50.0, 30.0, 20.0, 0.0, 30.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 10.0, 40.0, 30.0, 40.0, 30.0, 20.0, 0.0, 100.0, 30.0, 0.0, 40.0, 0.0, 160.0, 30.0, 20.0, 20.0, 20.0, 90.0, 20.0, 0.0, 0.0, 50.0, 10.0, 20.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 10.0, 20.0, 30.0, 80.0, 20.0, 30.0, 5.0, 20.0, 0.0, 30.0, 20.0, 20.0, 20.0, 10.0, 50.0, 10.0, 30.0, 30.0, 0.0, 10.0, 40.0, 10.0, 10.0, 10.0, 0.0, 20.0, 20.0, 60.0, 10.0, 40.0, 80.0, 50.0, 180.0, 10.0, 0.0, 180.0, 70.0, 50.0, 150.0, 20.0, 0.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.026267770451632, "mean_inference_ms": 2.2437227969983575, "mean_action_processing_ms": 0.5567953845107634, "mean_env_wait_ms": 1.7726040615034904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05786943435668945, "StateBufferConnector_ms": 0.009753227233886719, "ViewRequirementAgentConnector_ms": 0.3706979751586914}, "num_episodes": 18, "episode_return_max": 740.0, "episode_return_min": -20.0, "episode_return_mean": 271.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.36754448382531, "num_env_steps_trained_throughput_per_sec": 36.36754448382531, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 111193.081, "restore_workers_time_ms": 0.015, "training_step_time_ms": 111193.024, "sample_time_ms": 2601.449, "learn_time_ms": 108572.513, "learn_throughput": 36.842, "synch_weights_time_ms": 10.765}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "training_iteration": 18, "trial_id": "57140_00000", "date": "2024-06-26_23-52-52", "timestamp": 1719460372, "time_this_iter_s": 110.00097894668579, "time_total_s": 2298.9020397663116, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3e7af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2298.9020397663116, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 16.330128205128204, "ram_util_percent": 79.15192307692307}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6363957380334408, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.251749017431586, "policy_loss": -0.006496958067086233, "vf_loss": 3.257436039018682, "vf_explained_var": -2.367396197253015e-05, "kl": 0.008099362431004687, "entropy": 1.250576756455012, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 173715.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "env_runners": {"episode_reward_max": 740.0, "episode_reward_min": -20.0, "episode_reward_mean": 285.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -175.0}, "policy_reward_max": {"policy_0": 380.0}, "policy_reward_mean": {"policy_0": 28.535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [340.0, 210.0, 190.0, 140.0, 210.0, 520.0, 140.0, 280.0, 380.0, 330.0, 350.0, 590.0, 220.0, 240.0, 140.0, 495.0, 370.0, 270.0, 110.0, 150.0, 390.0, 200.0, 520.0, 300.0, 390.0, 300.0, 160.0, 170.0, 270.0, 240.0, 350.0, 220.0, 225.0, 150.0, 350.0, 70.0, 140.0, 280.0, 210.0, 320.0, 740.0, 170.0, 280.0, -20.0, 600.0, 200.0, 330.0, 130.0, 200.0, 410.0, 150.0, 380.0, 135.0, 140.0, 260.0, 140.0, 175.0, 180.0, 370.0, 200.0, 440.0, 300.0, 100.0, 130.0, 320.0, 710.0, 480.0, 285.0, 195.0, 200.0, 240.0, 420.0, 210.0, 235.0, 210.0, 150.0, 680.0, 300.0, 620.0, 130.0, 210.0, 300.0, 290.0, 310.0, 170.0, 130.0, 450.0, 460.0, 210.0, 150.0, 370.0, 260.0, 310.0, 420.0, 280.0, 390.0, 190.0, 180.0, 540.0, 460.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, -40.0, 250.0, 60.0, -40.0, 0.0, 30.0, 0.0, 30.0, 20.0, 0.0, 20.0, 50.0, 0.0, 20.0, 40.0, 40.0, 20.0, 20.0, 0.0, 10.0, 40.0, 20.0, 10.0, 50.0, 30.0, 10.0, 0.0, 0.0, 20.0, 10.0, 20.0, 30.0, 0.0, 0.0, 40.0, 10.0, 0.0, 30.0, 0.0, 10.0, 80.0, 10.0, 10.0, 10.0, 30.0, 30.0, 20.0, 10.0, 0.0, 50.0, 0.0, 40.0, 0.0, 20.0, 30.0, 50.0, 30.0, 280.0, 20.0, 0.0, 20.0, 20.0, 50.0, 10.0, 0.0, 20.0, 0.0, 10.0, 10.0, 0.0, 20.0, 30.0, 20.0, 20.0, 70.0, 60.0, 10.0, 30.0, 20.0, 80.0, 30.0, 50.0, -50.0, 160.0, 0.0, 0.0, 30.0, 50.0, 30.0, 50.0, 20.0, 40.0, 40.0, 30.0, 70.0, 30.0, 0.0, 40.0, 10.0, 10.0, 180.0, 60.0, 10.0, 20.0, 0.0, 20.0, 0.0, 20.0, 30.0, 10.0, 380.0, 20.0, 20.0, 90.0, 0.0, 10.0, 10.0, 20.0, 30.0, 30.0, 40.0, 10.0, 10.0, 10.0, 0.0, 20.0, 60.0, 30.0, 10.0, 0.0, 0.0, 50.0, 20.0, 30.0, 50.0, 20.0, 30.0, 20.0, 20.0, 0.0, 20.0, 30.0, 20.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 30.0, 20.0, -40.0, 15.0, 0.0, 60.0, 0.0, 350.0, 50.0, 10.0, 10.0, 50.0, 0.0, 10.0, 20.0, 40.0, 40.0, 40.0, 10.0, 150.0, 20.0, 40.0, 0.0, 30.0, 30.0, 0.0, 0.0, 30.0, 100.0, 20.0, 20.0, 0.0, 20.0, 20.0, 10.0, 0.0, 0.0, 10.0, 20.0, 10.0, 40.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 30.0, 30.0, 50.0, 10.0, 0.0, 10.0, 30.0, 10.0, 250.0, 30.0, 0.0, 0.0, 20.0, 20.0, 10.0, 40.0, 0.0, 20.0, 10.0, 60.0, 0.0, 20.0, 60.0, 30.0, -30.0, 20.0, 20.0, 30.0, 360.0, 10.0, 0.0, 20.0, 0.0, 160.0, 20.0, 70.0, 20.0, -20.0, 0.0, 10.0, 20.0, 20.0, 0.0, 30.0, 30.0, 170.0, 70.0, 20.0, 0.0, 30.0, 10.0, 30.0, 0.0, 0.0, 0.0, 10.0, 40.0, 10.0, 170.0, 0.0, 50.0, 20.0, 10.0, 0.0, 10.0, 50.0, 0.0, 50.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 40.0, 10.0, 40.0, 0.0, 20.0, 30.0, 0.0, 50.0, 20.0, 20.0, 10.0, 30.0, 30.0, 20.0, 50.0, 30.0, 10.0, 10.0, 40.0, 20.0, 60.0, 60.0, 30.0, 20.0, 20.0, -40.0, 20.0, 20.0, 20.0, -30.0, 210.0, 30.0, 20.0, 0.0, 0.0, 20.0, 60.0, 40.0, 20.0, 20.0, 10.0, 20.0, 20.0, 50.0, 10.0, 30.0, 0.0, 20.0, 70.0, 0.0, -5.0, 40.0, 10.0, 0.0, 30.0, 50.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 30.0, 40.0, 10.0, 20.0, 10.0, 0.0, 40.0, 0.0, 10.0, -40.0, 0.0, 60.0, 260.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 40.0, 10.0, 0.0, 0.0, 20.0, 30.0, 0.0, 20.0, 30.0, 0.0, 20.0, 10.0, 10.0, 0.0, 50.0, 0.0, 40.0, 20.0, 30.0, 20.0, 10.0, 40.0, 70.0, 0.0, 40.0, 0.0, 0.0, 20.0, 10.0, 0.0, 30.0, 30.0, 70.0, 10.0, 50.0, 10.0, 30.0, 30.0, 40.0, 20.0, 10.0, 40.0, 200.0, -110.0, 170.0, 0.0, 170.0, 180.0, 20.0, 0.0, 30.0, 40.0, 100.0, 30.0, 10.0, 10.0, 0.0, 50.0, 20.0, 20.0, 10.0, 50.0, 0.0, 0.0, 10.0, 40.0, 10.0, 40.0, 40.0, 30.0, 30.0, 40.0, 20.0, 20.0, 40.0, -175.0, 0.0, 0.0, 40.0, 0.0, 50.0, 0.0, 15.0, 10.0, 50.0, 170.0, 60.0, 40.0, 10.0, 20.0, 30.0, 180.0, 0.0, 40.0, 30.0, 60.0, 10.0, 10.0, 10.0, 0.0, 20.0, 40.0, 10.0, 10.0, 10.0, -40.0, 10.0, 0.0, 40.0, 0.0, 40.0, 10.0, 10.0, 250.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 40.0, 0.0, 20.0, 10.0, 0.0, 30.0, 50.0, 10.0, 0.0, 10.0, 50.0, 30.0, 0.0, 20.0, 20.0, 260.0, 10.0, -100.0, 30.0, 100.0, -20.0, 40.0, 70.0, 0.0, 10.0, 20.0, 50.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, -40.0, 20.0, 0.0, 10.0, 270.0, 10.0, 20.0, 20.0, 50.0, 20.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 20.0, 25.0, 30.0, 0.0, 10.0, 0.0, 0.0, 60.0, 0.0, 10.0, 20.0, 10.0, 0.0, 30.0, 80.0, 20.0, 30.0, 50.0, 10.0, 80.0, -10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 30.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 40.0, 40.0, 10.0, 0.0, 20.0, -5.0, 50.0, 10.0, 10.0, 20.0, 20.0, 10.0, 40.0, 10.0, 60.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 20.0, 40.0, 100.0, 30.0, 20.0, 50.0, 30.0, 40.0, 40.0, 0.0, 30.0, 50.0, 0.0, 20.0, 20.0, 10.0, 20.0, 50.0, 0.0, 0.0, 50.0, 30.0, 30.0, 0.0, 60.0, 30.0, 180.0, 10.0, 20.0, 30.0, 10.0, 110.0, 0.0, 0.0, 10.0, 90.0, 50.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 20.0, 20.0, 0.0, 10.0, 30.0, 10.0, 0.0, 10.0, 30.0, 20.0, 10.0, 0.0, 10.0, 10.0, 30.0, 10.0, 0.0, 0.0, 100.0, 10.0, 10.0, 80.0, 60.0, 20.0, 20.0, 20.0, 80.0, 250.0, 10.0, 190.0, 60.0, 30.0, 0.0, 50.0, 150.0, 40.0, 40.0, 50.0, 30.0, 0.0, 100.0, 10.0, 30.0, 30.0, 20.0, 40.0, 0.0, 10.0, 0.0, 250.0, 0.0, 5.0, 10.0, -50.0, 10.0, 40.0, 40.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 5.0, 20.0, 0.0, 50.0, 30.0, 20.0, 0.0, 30.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 10.0, 40.0, 30.0, 40.0, 30.0, 20.0, 0.0, 100.0, 30.0, 0.0, 40.0, 0.0, 160.0, 30.0, 20.0, 20.0, 20.0, 90.0, 20.0, 0.0, 0.0, 50.0, 10.0, 20.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 10.0, 20.0, 30.0, 80.0, 20.0, 30.0, 5.0, 20.0, 0.0, 30.0, 20.0, 20.0, 20.0, 10.0, 50.0, 10.0, 30.0, 30.0, 0.0, 10.0, 40.0, 10.0, 10.0, 10.0, 0.0, 20.0, 20.0, 60.0, 10.0, 40.0, 80.0, 50.0, 180.0, 10.0, 0.0, 180.0, 70.0, 50.0, 150.0, 20.0, 0.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 250.0, 10.0, 20.0, 280.0, 20.0, 10.0, 10.0, 30.0, -40.0, 30.0, 40.0, 10.0, 0.0, 20.0, 10.0, 20.0, 20.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 20.0, 0.0, 0.0, 40.0, 20.0, 70.0, 0.0, 20.0, 60.0, 60.0, 20.0, 20.0, -70.0, 160.0, 10.0, 40.0, -20.0, 20.0, 10.0, 60.0, 30.0, 60.0, 40.0, 0.0, 30.0, 20.0, 20.0, 30.0, 20.0, 0.0, 160.0, 40.0, 50.0, 0.0, 0.0, 0.0, 10.0, 20.0, 50.0, 0.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 10.0, 30.0, 0.0, 10.0, 40.0, 10.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 30.0, 200.0, 0.0, 30.0, 160.0, 0.0, 20.0, 50.0, 200.0, 40.0, 70.0, 10.0, -50.0, 60.0, 30.0, 30.0, 30.0, 10.0, 0.0, 20.0, 60.0, 20.0, 50.0, 0.0, 0.0, 20.0, 10.0, 30.0, 10.0, 0.0, 60.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 160.0, 20.0, 20.0, 40.0, 60.0, 0.0, 40.0, 20.0, 10.0, 10.0, 70.0, 40.0, 10.0, 20.0, 10.0, 20.0, 50.0, 20.0, 40.0, 10.0, 10.0, 20.0, 0.0, 40.0, 70.0, 30.0, 80.0, 10.0, 0.0, 20.0, 180.0, 20.0, 0.0, 20.0, 80.0, 20.0, 40.0, 40.0, 40.0, 20.0, 0.0, 40.0, 30.0, 40.0, 50.0, 0.0, 10.0, 50.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 150.0, 60.0, 40.0, 60.0, 10.0, 20.0, 30.0, 60.0, 20.0, 20.0, 0.0, 0.0, 30.0, 0.0, 20.0, 0.0, 60.0, 20.0, 0.0, 20.0, 0.0, 40.0, 0.0, 20.0, 80.0, 160.0, 20.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 150.0, 20.0, 30.0, 30.0, 20.0, 90.0, 10.0, 170.0, 20.0, 40.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9870171271193573, "mean_inference_ms": 2.207524907584059, "mean_action_processing_ms": 0.5487154742241486, "mean_env_wait_ms": 1.7412805023700104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055605411529541016, "StateBufferConnector_ms": 0.00913381576538086, "ViewRequirementAgentConnector_ms": 0.36641979217529297}, "num_episodes": 22, "episode_return_max": 740.0, "episode_return_min": -20.0, "episode_return_mean": 285.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.58122615726033, "num_env_steps_trained_throughput_per_sec": 36.58122615726033, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 760000, "timers": {"training_iteration_time_ms": 109662.107, "restore_workers_time_ms": 0.012, "training_step_time_ms": 109662.057, "sample_time_ms": 2419.406, "learn_time_ms": 107223.67, "learn_throughput": 37.305, "synch_weights_time_ms": 10.638}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 760000, "num_agent_steps_trained": 760000}, "done": false, "training_iteration": 19, "trial_id": "57140_00000", "date": "2024-06-26_23-54-41", "timestamp": 1719460481, "time_this_iter_s": 109.35826468467712, "time_total_s": 2408.2603044509888, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3f5670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2408.2603044509888, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 15.92258064516129, "ram_util_percent": 79.31032258064516}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.615748721891191, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.659276679656503, "policy_loss": -0.00611324060063103, "vf_loss": 3.6645624418482106, "vf_explained_var": -6.39951457611669e-05, "kl": 0.008274754818783044, "entropy": 1.2028469303291573, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 183105.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "env_runners": {"episode_reward_max": 880.0, "episode_reward_min": -20.0, "episode_reward_mean": 295.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -175.0}, "policy_reward_max": {"policy_0": 460.0}, "policy_reward_mean": {"policy_0": 29.59}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 390.0, 300.0, 160.0, 170.0, 270.0, 240.0, 350.0, 220.0, 225.0, 150.0, 350.0, 70.0, 140.0, 280.0, 210.0, 320.0, 740.0, 170.0, 280.0, -20.0, 600.0, 200.0, 330.0, 130.0, 200.0, 410.0, 150.0, 380.0, 135.0, 140.0, 260.0, 140.0, 175.0, 180.0, 370.0, 200.0, 440.0, 300.0, 100.0, 130.0, 320.0, 710.0, 480.0, 285.0, 195.0, 200.0, 240.0, 420.0, 210.0, 235.0, 210.0, 150.0, 680.0, 300.0, 620.0, 130.0, 210.0, 300.0, 290.0, 310.0, 170.0, 130.0, 450.0, 460.0, 210.0, 150.0, 370.0, 260.0, 310.0, 420.0, 280.0, 390.0, 190.0, 180.0, 540.0, 460.0, 130.0, 450.0, 360.0, 230.0, 380.0, 540.0, 470.0, 300.0, 250.0, 210.0, 365.0, 490.0, 780.0, 220.0, 880.0, 190.0, 270.0, 170.0, 485.0, 260.0, 230.0, 60.0, 120.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 160.0, 20.0, 70.0, 20.0, -20.0, 0.0, 10.0, 20.0, 20.0, 0.0, 30.0, 30.0, 170.0, 70.0, 20.0, 0.0, 30.0, 10.0, 30.0, 0.0, 0.0, 0.0, 10.0, 40.0, 10.0, 170.0, 0.0, 50.0, 20.0, 10.0, 0.0, 10.0, 50.0, 0.0, 50.0, 10.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 40.0, 10.0, 40.0, 0.0, 20.0, 30.0, 0.0, 50.0, 20.0, 20.0, 10.0, 30.0, 30.0, 20.0, 50.0, 30.0, 10.0, 10.0, 40.0, 20.0, 60.0, 60.0, 30.0, 20.0, 20.0, -40.0, 20.0, 20.0, 20.0, -30.0, 210.0, 30.0, 20.0, 0.0, 0.0, 20.0, 60.0, 40.0, 20.0, 20.0, 10.0, 20.0, 20.0, 50.0, 10.0, 30.0, 0.0, 20.0, 70.0, 0.0, -5.0, 40.0, 10.0, 0.0, 30.0, 50.0, 10.0, 10.0, 10.0, 0.0, 0.0, 20.0, 30.0, 40.0, 10.0, 20.0, 10.0, 0.0, 40.0, 0.0, 10.0, -40.0, 0.0, 60.0, 260.0, 10.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 10.0, 40.0, 10.0, 0.0, 0.0, 20.0, 30.0, 0.0, 20.0, 30.0, 0.0, 20.0, 10.0, 10.0, 0.0, 50.0, 0.0, 40.0, 20.0, 30.0, 20.0, 10.0, 40.0, 70.0, 0.0, 40.0, 0.0, 0.0, 20.0, 10.0, 0.0, 30.0, 30.0, 70.0, 10.0, 50.0, 10.0, 30.0, 30.0, 40.0, 20.0, 10.0, 40.0, 200.0, -110.0, 170.0, 0.0, 170.0, 180.0, 20.0, 0.0, 30.0, 40.0, 100.0, 30.0, 10.0, 10.0, 0.0, 50.0, 20.0, 20.0, 10.0, 50.0, 0.0, 0.0, 10.0, 40.0, 10.0, 40.0, 40.0, 30.0, 30.0, 40.0, 20.0, 20.0, 40.0, -175.0, 0.0, 0.0, 40.0, 0.0, 50.0, 0.0, 15.0, 10.0, 50.0, 170.0, 60.0, 40.0, 10.0, 20.0, 30.0, 180.0, 0.0, 40.0, 30.0, 60.0, 10.0, 10.0, 10.0, 0.0, 20.0, 40.0, 10.0, 10.0, 10.0, -40.0, 10.0, 0.0, 40.0, 0.0, 40.0, 10.0, 10.0, 250.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 40.0, 0.0, 20.0, 10.0, 0.0, 30.0, 50.0, 10.0, 0.0, 10.0, 50.0, 30.0, 0.0, 20.0, 20.0, 260.0, 10.0, -100.0, 30.0, 100.0, -20.0, 40.0, 70.0, 0.0, 10.0, 20.0, 50.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, -40.0, 20.0, 0.0, 10.0, 270.0, 10.0, 20.0, 20.0, 50.0, 20.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 20.0, 25.0, 30.0, 0.0, 10.0, 0.0, 0.0, 60.0, 0.0, 10.0, 20.0, 10.0, 0.0, 30.0, 80.0, 20.0, 30.0, 50.0, 10.0, 80.0, -10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 30.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 40.0, 40.0, 10.0, 0.0, 20.0, -5.0, 50.0, 10.0, 10.0, 20.0, 20.0, 10.0, 40.0, 10.0, 60.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 20.0, 40.0, 100.0, 30.0, 20.0, 50.0, 30.0, 40.0, 40.0, 0.0, 30.0, 50.0, 0.0, 20.0, 20.0, 10.0, 20.0, 50.0, 0.0, 0.0, 50.0, 30.0, 30.0, 0.0, 60.0, 30.0, 180.0, 10.0, 20.0, 30.0, 10.0, 110.0, 0.0, 0.0, 10.0, 90.0, 50.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 20.0, 20.0, 0.0, 10.0, 30.0, 10.0, 0.0, 10.0, 30.0, 20.0, 10.0, 0.0, 10.0, 10.0, 30.0, 10.0, 0.0, 0.0, 100.0, 10.0, 10.0, 80.0, 60.0, 20.0, 20.0, 20.0, 80.0, 250.0, 10.0, 190.0, 60.0, 30.0, 0.0, 50.0, 150.0, 40.0, 40.0, 50.0, 30.0, 0.0, 100.0, 10.0, 30.0, 30.0, 20.0, 40.0, 0.0, 10.0, 0.0, 250.0, 0.0, 5.0, 10.0, -50.0, 10.0, 40.0, 40.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 5.0, 20.0, 0.0, 50.0, 30.0, 20.0, 0.0, 30.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 10.0, 40.0, 30.0, 40.0, 30.0, 20.0, 0.0, 100.0, 30.0, 0.0, 40.0, 0.0, 160.0, 30.0, 20.0, 20.0, 20.0, 90.0, 20.0, 0.0, 0.0, 50.0, 10.0, 20.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 10.0, 20.0, 30.0, 80.0, 20.0, 30.0, 5.0, 20.0, 0.0, 30.0, 20.0, 20.0, 20.0, 10.0, 50.0, 10.0, 30.0, 30.0, 0.0, 10.0, 40.0, 10.0, 10.0, 10.0, 0.0, 20.0, 20.0, 60.0, 10.0, 40.0, 80.0, 50.0, 180.0, 10.0, 0.0, 180.0, 70.0, 50.0, 150.0, 20.0, 0.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 250.0, 10.0, 20.0, 280.0, 20.0, 10.0, 10.0, 30.0, -40.0, 30.0, 40.0, 10.0, 0.0, 20.0, 10.0, 20.0, 20.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 20.0, 0.0, 0.0, 40.0, 20.0, 70.0, 0.0, 20.0, 60.0, 60.0, 20.0, 20.0, -70.0, 160.0, 10.0, 40.0, -20.0, 20.0, 10.0, 60.0, 30.0, 60.0, 40.0, 0.0, 30.0, 20.0, 20.0, 30.0, 20.0, 0.0, 160.0, 40.0, 50.0, 0.0, 0.0, 0.0, 10.0, 20.0, 50.0, 0.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 10.0, 30.0, 0.0, 10.0, 40.0, 10.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 30.0, 200.0, 0.0, 30.0, 160.0, 0.0, 20.0, 50.0, 200.0, 40.0, 70.0, 10.0, -50.0, 60.0, 30.0, 30.0, 30.0, 10.0, 0.0, 20.0, 60.0, 20.0, 50.0, 0.0, 0.0, 20.0, 10.0, 30.0, 10.0, 0.0, 60.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 160.0, 20.0, 20.0, 40.0, 60.0, 0.0, 40.0, 20.0, 10.0, 10.0, 70.0, 40.0, 10.0, 20.0, 10.0, 20.0, 50.0, 20.0, 40.0, 10.0, 10.0, 20.0, 0.0, 40.0, 70.0, 30.0, 80.0, 10.0, 0.0, 20.0, 180.0, 20.0, 0.0, 20.0, 80.0, 20.0, 40.0, 40.0, 40.0, 20.0, 0.0, 40.0, 30.0, 40.0, 50.0, 0.0, 10.0, 50.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 150.0, 60.0, 40.0, 60.0, 10.0, 20.0, 30.0, 60.0, 20.0, 20.0, 0.0, 0.0, 30.0, 0.0, 20.0, 0.0, 60.0, 20.0, 0.0, 20.0, 0.0, 40.0, 0.0, 20.0, 80.0, 160.0, 20.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 150.0, 20.0, 30.0, 30.0, 20.0, 90.0, 10.0, 170.0, 20.0, 40.0, 30.0, 30.0, 20.0, 30.0, 30.0, -10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 180.0, 30.0, 50.0, 10.0, 40.0, 60.0, 40.0, 10.0, 20.0, 30.0, 40.0, 100.0, 20.0, 20.0, 0.0, 50.0, 40.0, 30.0, 30.0, 10.0, 40.0, 40.0, 0.0, 20.0, 20.0, 30.0, 40.0, 10.0, 20.0, 10.0, 40.0, 40.0, 20.0, 0.0, 10.0, 100.0, 20.0, 30.0, 110.0, 40.0, 170.0, 20.0, 20.0, 50.0, 0.0, 40.0, 50.0, 150.0, 0.0, 30.0, 10.0, 20.0, 30.0, 290.0, 60.0, 0.0, 10.0, 20.0, 0.0, 0.0, 70.0, 50.0, 60.0, 0.0, 10.0, 60.0, 10.0, 10.0, 30.0, 50.0, 50.0, 0.0, 20.0, 40.0, 30.0, 10.0, 30.0, 10.0, 10.0, 30.0, 30.0, -50.0, 30.0, 0.0, 160.0, 30.0, 0.0, -40.0, 20.0, 160.0, 0.0, 40.0, 0.0, 5.0, 40.0, 30.0, 60.0, 0.0, 30.0, 40.0, 20.0, 30.0, 20.0, 40.0, 30.0, 40.0, 50.0, 170.0, 50.0, 170.0, 160.0, 0.0, 30.0, 40.0, 270.0, 40.0, 50.0, 10.0, 10.0, 30.0, 0.0, 20.0, 30.0, 20.0, 30.0, 0.0, 40.0, 20.0, 30.0, 60.0, 30.0, 20.0, 10.0, 60.0, 60.0, 460.0, 80.0, 70.0, 30.0, 60.0, 30.0, 20.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 20.0, 30.0, 30.0, 40.0, 10.0, 20.0, 0.0, 30.0, 60.0, 30.0, 20.0, 20.0, 30.0, 20.0, 0.0, 10.0, 10.0, 30.0, 50.0, 0.0, 0.0, 20.0, -65.0, 60.0, 190.0, 20.0, 150.0, 30.0, 20.0, 0.0, 60.0, 20.0, 20.0, 10.0, 20.0, 30.0, 70.0, 10.0, 10.0, 0.0, 70.0, 0.0, 0.0, 60.0, 20.0, 10.0, 90.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 70.0, 40.0, -100.0, 10.0, 40.0, 0.0, 30.0, 0.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.940664548009106, "mean_inference_ms": 2.152992536902738, "mean_action_processing_ms": 0.5355780658471627, "mean_env_wait_ms": 1.7055090102236756, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05466294288635254, "StateBufferConnector_ms": 0.00967264175415039, "ViewRequirementAgentConnector_ms": 0.3671834468841553}, "num_episodes": 23, "episode_return_max": 880.0, "episode_return_min": -20.0, "episode_return_mean": 295.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.35441052662999, "num_env_steps_trained_throughput_per_sec": 36.35441052662999, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 800000, "timers": {"training_iteration_time_ms": 109676.87, "restore_workers_time_ms": 0.012, "training_step_time_ms": 109676.819, "sample_time_ms": 2433.884, "learn_time_ms": 107223.824, "learn_throughput": 37.305, "synch_weights_time_ms": 10.851}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 800000, "num_agent_steps_trained": 800000}, "done": false, "training_iteration": 20, "trial_id": "57140_00000", "date": "2024-06-26_23-56-31", "timestamp": 1719460591, "time_this_iter_s": 110.03688502311707, "time_total_s": 2518.297189474106, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3ea160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2518.297189474106, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 16.70387096774194, "ram_util_percent": 78.78645161290322}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6892570087672296, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.336329391995431, "policy_loss": -0.008649383006960597, "vf_loss": 4.3439711356442325, "vf_explained_var": 0.00145798550881009, "kl": 0.010076372223568568, "entropy": 1.1841305673185882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 192495.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "env_runners": {"episode_reward_max": 880.0, "episode_reward_min": -20.0, "episode_reward_mean": 310.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -175.0}, "policy_reward_max": {"policy_0": 460.0}, "policy_reward_mean": {"policy_0": 31.09}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.0, 280.0, -20.0, 600.0, 200.0, 330.0, 130.0, 200.0, 410.0, 150.0, 380.0, 135.0, 140.0, 260.0, 140.0, 175.0, 180.0, 370.0, 200.0, 440.0, 300.0, 100.0, 130.0, 320.0, 710.0, 480.0, 285.0, 195.0, 200.0, 240.0, 420.0, 210.0, 235.0, 210.0, 150.0, 680.0, 300.0, 620.0, 130.0, 210.0, 300.0, 290.0, 310.0, 170.0, 130.0, 450.0, 460.0, 210.0, 150.0, 370.0, 260.0, 310.0, 420.0, 280.0, 390.0, 190.0, 180.0, 540.0, 460.0, 130.0, 450.0, 360.0, 230.0, 380.0, 540.0, 470.0, 300.0, 250.0, 210.0, 365.0, 490.0, 780.0, 220.0, 880.0, 190.0, 270.0, 170.0, 485.0, 260.0, 230.0, 60.0, 120.0, 360.0, 460.0, 250.0, 370.0, 130.0, 580.0, 220.0, 350.0, 530.0, 220.0, 520.0, 320.0, 270.0, 480.0, 490.0, 145.0, 310.0, 380.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 10.0, 0.0, 50.0, 20.0, 20.0, 10.0, 50.0, 0.0, 0.0, 10.0, 40.0, 10.0, 40.0, 40.0, 30.0, 30.0, 40.0, 20.0, 20.0, 40.0, -175.0, 0.0, 0.0, 40.0, 0.0, 50.0, 0.0, 15.0, 10.0, 50.0, 170.0, 60.0, 40.0, 10.0, 20.0, 30.0, 180.0, 0.0, 40.0, 30.0, 60.0, 10.0, 10.0, 10.0, 0.0, 20.0, 40.0, 10.0, 10.0, 10.0, -40.0, 10.0, 0.0, 40.0, 0.0, 40.0, 10.0, 10.0, 250.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 40.0, 0.0, 20.0, 10.0, 0.0, 30.0, 50.0, 10.0, 0.0, 10.0, 50.0, 30.0, 0.0, 20.0, 20.0, 260.0, 10.0, -100.0, 30.0, 100.0, -20.0, 40.0, 70.0, 0.0, 10.0, 20.0, 50.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 20.0, -40.0, 20.0, 0.0, 10.0, 270.0, 10.0, 20.0, 20.0, 50.0, 20.0, 0.0, 20.0, 30.0, 0.0, 0.0, 10.0, 20.0, 25.0, 30.0, 0.0, 10.0, 0.0, 0.0, 60.0, 0.0, 10.0, 20.0, 10.0, 0.0, 30.0, 80.0, 20.0, 30.0, 50.0, 10.0, 80.0, -10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 30.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 40.0, 40.0, 10.0, 0.0, 20.0, -5.0, 50.0, 10.0, 10.0, 20.0, 20.0, 10.0, 40.0, 10.0, 60.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 20.0, 40.0, 100.0, 30.0, 20.0, 50.0, 30.0, 40.0, 40.0, 0.0, 30.0, 50.0, 0.0, 20.0, 20.0, 10.0, 20.0, 50.0, 0.0, 0.0, 50.0, 30.0, 30.0, 0.0, 60.0, 30.0, 180.0, 10.0, 20.0, 30.0, 10.0, 110.0, 0.0, 0.0, 10.0, 90.0, 50.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 20.0, 20.0, 0.0, 10.0, 30.0, 10.0, 0.0, 10.0, 30.0, 20.0, 10.0, 0.0, 10.0, 10.0, 30.0, 10.0, 0.0, 0.0, 100.0, 10.0, 10.0, 80.0, 60.0, 20.0, 20.0, 20.0, 80.0, 250.0, 10.0, 190.0, 60.0, 30.0, 0.0, 50.0, 150.0, 40.0, 40.0, 50.0, 30.0, 0.0, 100.0, 10.0, 30.0, 30.0, 20.0, 40.0, 0.0, 10.0, 0.0, 250.0, 0.0, 5.0, 10.0, -50.0, 10.0, 40.0, 40.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 5.0, 20.0, 0.0, 50.0, 30.0, 20.0, 0.0, 30.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 10.0, 40.0, 30.0, 40.0, 30.0, 20.0, 0.0, 100.0, 30.0, 0.0, 40.0, 0.0, 160.0, 30.0, 20.0, 20.0, 20.0, 90.0, 20.0, 0.0, 0.0, 50.0, 10.0, 20.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 10.0, 20.0, 30.0, 80.0, 20.0, 30.0, 5.0, 20.0, 0.0, 30.0, 20.0, 20.0, 20.0, 10.0, 50.0, 10.0, 30.0, 30.0, 0.0, 10.0, 40.0, 10.0, 10.0, 10.0, 0.0, 20.0, 20.0, 60.0, 10.0, 40.0, 80.0, 50.0, 180.0, 10.0, 0.0, 180.0, 70.0, 50.0, 150.0, 20.0, 0.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 250.0, 10.0, 20.0, 280.0, 20.0, 10.0, 10.0, 30.0, -40.0, 30.0, 40.0, 10.0, 0.0, 20.0, 10.0, 20.0, 20.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 20.0, 0.0, 0.0, 40.0, 20.0, 70.0, 0.0, 20.0, 60.0, 60.0, 20.0, 20.0, -70.0, 160.0, 10.0, 40.0, -20.0, 20.0, 10.0, 60.0, 30.0, 60.0, 40.0, 0.0, 30.0, 20.0, 20.0, 30.0, 20.0, 0.0, 160.0, 40.0, 50.0, 0.0, 0.0, 0.0, 10.0, 20.0, 50.0, 0.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 10.0, 30.0, 0.0, 10.0, 40.0, 10.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 30.0, 200.0, 0.0, 30.0, 160.0, 0.0, 20.0, 50.0, 200.0, 40.0, 70.0, 10.0, -50.0, 60.0, 30.0, 30.0, 30.0, 10.0, 0.0, 20.0, 60.0, 20.0, 50.0, 0.0, 0.0, 20.0, 10.0, 30.0, 10.0, 0.0, 60.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 160.0, 20.0, 20.0, 40.0, 60.0, 0.0, 40.0, 20.0, 10.0, 10.0, 70.0, 40.0, 10.0, 20.0, 10.0, 20.0, 50.0, 20.0, 40.0, 10.0, 10.0, 20.0, 0.0, 40.0, 70.0, 30.0, 80.0, 10.0, 0.0, 20.0, 180.0, 20.0, 0.0, 20.0, 80.0, 20.0, 40.0, 40.0, 40.0, 20.0, 0.0, 40.0, 30.0, 40.0, 50.0, 0.0, 10.0, 50.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 150.0, 60.0, 40.0, 60.0, 10.0, 20.0, 30.0, 60.0, 20.0, 20.0, 0.0, 0.0, 30.0, 0.0, 20.0, 0.0, 60.0, 20.0, 0.0, 20.0, 0.0, 40.0, 0.0, 20.0, 80.0, 160.0, 20.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 150.0, 20.0, 30.0, 30.0, 20.0, 90.0, 10.0, 170.0, 20.0, 40.0, 30.0, 30.0, 20.0, 30.0, 30.0, -10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 180.0, 30.0, 50.0, 10.0, 40.0, 60.0, 40.0, 10.0, 20.0, 30.0, 40.0, 100.0, 20.0, 20.0, 0.0, 50.0, 40.0, 30.0, 30.0, 10.0, 40.0, 40.0, 0.0, 20.0, 20.0, 30.0, 40.0, 10.0, 20.0, 10.0, 40.0, 40.0, 20.0, 0.0, 10.0, 100.0, 20.0, 30.0, 110.0, 40.0, 170.0, 20.0, 20.0, 50.0, 0.0, 40.0, 50.0, 150.0, 0.0, 30.0, 10.0, 20.0, 30.0, 290.0, 60.0, 0.0, 10.0, 20.0, 0.0, 0.0, 70.0, 50.0, 60.0, 0.0, 10.0, 60.0, 10.0, 10.0, 30.0, 50.0, 50.0, 0.0, 20.0, 40.0, 30.0, 10.0, 30.0, 10.0, 10.0, 30.0, 30.0, -50.0, 30.0, 0.0, 160.0, 30.0, 0.0, -40.0, 20.0, 160.0, 0.0, 40.0, 0.0, 5.0, 40.0, 30.0, 60.0, 0.0, 30.0, 40.0, 20.0, 30.0, 20.0, 40.0, 30.0, 40.0, 50.0, 170.0, 50.0, 170.0, 160.0, 0.0, 30.0, 40.0, 270.0, 40.0, 50.0, 10.0, 10.0, 30.0, 0.0, 20.0, 30.0, 20.0, 30.0, 0.0, 40.0, 20.0, 30.0, 60.0, 30.0, 20.0, 10.0, 60.0, 60.0, 460.0, 80.0, 70.0, 30.0, 60.0, 30.0, 20.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 20.0, 30.0, 30.0, 40.0, 10.0, 20.0, 0.0, 30.0, 60.0, 30.0, 20.0, 20.0, 30.0, 20.0, 0.0, 10.0, 10.0, 30.0, 50.0, 0.0, 0.0, 20.0, -65.0, 60.0, 190.0, 20.0, 150.0, 30.0, 20.0, 0.0, 60.0, 20.0, 20.0, 10.0, 20.0, 30.0, 70.0, 10.0, 10.0, 0.0, 70.0, 0.0, 0.0, 60.0, 20.0, 10.0, 90.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 70.0, 40.0, -100.0, 10.0, 40.0, 0.0, 30.0, 0.0, 20.0, 0.0, 30.0, 40.0, 10.0, 30.0, 30.0, 70.0, 30.0, 80.0, 40.0, 30.0, 110.0, 20.0, 50.0, 10.0, 30.0, 110.0, 20.0, 70.0, 10.0, 40.0, 20.0, 0.0, 20.0, 70.0, 10.0, 20.0, 30.0, 10.0, 30.0, 10.0, 90.0, 10.0, 90.0, 20.0, 40.0, 40.0, 30.0, 30.0, 10.0, 20.0, 0.0, 0.0, 40.0, 20.0, 0.0, 10.0, 30.0, 10.0, 0.0, 50.0, 50.0, 60.0, 30.0, 10.0, 170.0, 10.0, 40.0, 160.0, 0.0, 0.0, 10.0, 20.0, 0.0, 30.0, 20.0, 80.0, 40.0, 0.0, 20.0, 20.0, 140.0, 0.0, 80.0, 20.0, 0.0, 20.0, 0.0, 30.0, 40.0, 10.0, 20.0, 100.0, 0.0, 30.0, 10.0, 80.0, 60.0, 170.0, 50.0, 20.0, 40.0, 10.0, 0.0, 60.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 190.0, 40.0, 60.0, 20.0, 30.0, 40.0, 40.0, 70.0, 10.0, 60.0, 40.0, 60.0, 30.0, 20.0, 10.0, 30.0, 10.0, 0.0, 60.0, 60.0, 10.0, 40.0, 80.0, 0.0, 10.0, 10.0, 30.0, 20.0, 10.0, 20.0, 10.0, 30.0, 10.0, 100.0, 20.0, 50.0, 20.0, 190.0, 30.0, 50.0, 70.0, 0.0, 30.0, 90.0, 20.0, -90.0, 50.0, 10.0, 260.0, 30.0, 30.0, 40.0, 0.0, 90.0, -145.0, 30.0, 40.0, 20.0, 10.0, 100.0, 30.0, 40.0, 0.0, 20.0, 60.0, 0.0, 30.0, 10.0, 20.0, 150.0, 0.0, 30.0, 0.0, 30.0, 50.0, 30.0, 10.0, 0.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.9114871722593794, "mean_inference_ms": 2.1213248756440586, "mean_action_processing_ms": 0.5282525633825396, "mean_env_wait_ms": 1.6827503694148027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0546107292175293, "StateBufferConnector_ms": 0.01012873649597168, "ViewRequirementAgentConnector_ms": 0.3755929470062256}, "num_episodes": 18, "episode_return_max": 880.0, "episode_return_min": -20.0, "episode_return_mean": 310.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.205675655709264, "num_env_steps_trained_throughput_per_sec": 36.205675655709264, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 840000, "timers": {"training_iteration_time_ms": 109760.858, "restore_workers_time_ms": 0.012, "training_step_time_ms": 109760.808, "sample_time_ms": 2415.666, "learn_time_ms": 107325.753, "learn_throughput": 37.27, "synch_weights_time_ms": 11.126}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 840000, "num_agent_steps_trained": 840000}, "done": false, "training_iteration": 21, "trial_id": "57140_00000", "date": "2024-06-26_23-58-22", "timestamp": 1719460702, "time_this_iter_s": 110.4917619228363, "time_total_s": 2628.788951396942, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3ea4c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2628.788951396942, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 15.634394904458595, "ram_util_percent": 78.58343949044585}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.778052877910094, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.310459881621047, "policy_loss": -0.005203856478834027, "vf_loss": 4.314779840059047, "vf_explained_var": 0.0014880788529388947, "kl": 0.008839033069142658, "entropy": 1.1561378442949126, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 201885.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "env_runners": {"episode_reward_max": 890.0, "episode_reward_min": 60.0, "episode_reward_mean": 337.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -145.0}, "policy_reward_max": {"policy_0": 460.0}, "policy_reward_mean": {"policy_0": 33.785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 440.0, 300.0, 100.0, 130.0, 320.0, 710.0, 480.0, 285.0, 195.0, 200.0, 240.0, 420.0, 210.0, 235.0, 210.0, 150.0, 680.0, 300.0, 620.0, 130.0, 210.0, 300.0, 290.0, 310.0, 170.0, 130.0, 450.0, 460.0, 210.0, 150.0, 370.0, 260.0, 310.0, 420.0, 280.0, 390.0, 190.0, 180.0, 540.0, 460.0, 130.0, 450.0, 360.0, 230.0, 380.0, 540.0, 470.0, 300.0, 250.0, 210.0, 365.0, 490.0, 780.0, 220.0, 880.0, 190.0, 270.0, 170.0, 485.0, 260.0, 230.0, 60.0, 120.0, 360.0, 460.0, 250.0, 370.0, 130.0, 580.0, 220.0, 350.0, 530.0, 220.0, 520.0, 320.0, 270.0, 480.0, 490.0, 145.0, 310.0, 380.0, 220.0, 590.0, 400.0, 490.0, 290.0, 375.0, 690.0, 180.0, 890.0, 260.0, 240.0, 250.0, 400.0, 240.0, 400.0, 130.0, 190.0, 690.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 50.0, 0.0, 20.0, 20.0, 10.0, 20.0, 50.0, 0.0, 0.0, 50.0, 30.0, 30.0, 0.0, 60.0, 30.0, 180.0, 10.0, 20.0, 30.0, 10.0, 110.0, 0.0, 0.0, 10.0, 90.0, 50.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 20.0, 0.0, 20.0, 20.0, 0.0, 10.0, 30.0, 10.0, 0.0, 10.0, 30.0, 20.0, 10.0, 0.0, 10.0, 10.0, 30.0, 10.0, 0.0, 0.0, 100.0, 10.0, 10.0, 80.0, 60.0, 20.0, 20.0, 20.0, 80.0, 250.0, 10.0, 190.0, 60.0, 30.0, 0.0, 50.0, 150.0, 40.0, 40.0, 50.0, 30.0, 0.0, 100.0, 10.0, 30.0, 30.0, 20.0, 40.0, 0.0, 10.0, 0.0, 250.0, 0.0, 5.0, 10.0, -50.0, 10.0, 40.0, 40.0, 10.0, 20.0, 20.0, 20.0, 20.0, 10.0, 5.0, 20.0, 0.0, 50.0, 30.0, 20.0, 0.0, 30.0, 10.0, 20.0, 20.0, 30.0, 20.0, 20.0, 10.0, 40.0, 30.0, 40.0, 30.0, 20.0, 0.0, 100.0, 30.0, 0.0, 40.0, 0.0, 160.0, 30.0, 20.0, 20.0, 20.0, 90.0, 20.0, 0.0, 0.0, 50.0, 10.0, 20.0, 10.0, 10.0, 0.0, 30.0, 0.0, 10.0, 10.0, 20.0, 30.0, 80.0, 20.0, 30.0, 5.0, 20.0, 0.0, 30.0, 20.0, 20.0, 20.0, 10.0, 50.0, 10.0, 30.0, 30.0, 0.0, 10.0, 40.0, 10.0, 10.0, 10.0, 0.0, 20.0, 20.0, 60.0, 10.0, 40.0, 80.0, 50.0, 180.0, 10.0, 0.0, 180.0, 70.0, 50.0, 150.0, 20.0, 0.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 250.0, 10.0, 20.0, 280.0, 20.0, 10.0, 10.0, 30.0, -40.0, 30.0, 40.0, 10.0, 0.0, 20.0, 10.0, 20.0, 20.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 20.0, 0.0, 0.0, 40.0, 20.0, 70.0, 0.0, 20.0, 60.0, 60.0, 20.0, 20.0, -70.0, 160.0, 10.0, 40.0, -20.0, 20.0, 10.0, 60.0, 30.0, 60.0, 40.0, 0.0, 30.0, 20.0, 20.0, 30.0, 20.0, 0.0, 160.0, 40.0, 50.0, 0.0, 0.0, 0.0, 10.0, 20.0, 50.0, 0.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 10.0, 30.0, 0.0, 10.0, 40.0, 10.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 30.0, 200.0, 0.0, 30.0, 160.0, 0.0, 20.0, 50.0, 200.0, 40.0, 70.0, 10.0, -50.0, 60.0, 30.0, 30.0, 30.0, 10.0, 0.0, 20.0, 60.0, 20.0, 50.0, 0.0, 0.0, 20.0, 10.0, 30.0, 10.0, 0.0, 60.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 160.0, 20.0, 20.0, 40.0, 60.0, 0.0, 40.0, 20.0, 10.0, 10.0, 70.0, 40.0, 10.0, 20.0, 10.0, 20.0, 50.0, 20.0, 40.0, 10.0, 10.0, 20.0, 0.0, 40.0, 70.0, 30.0, 80.0, 10.0, 0.0, 20.0, 180.0, 20.0, 0.0, 20.0, 80.0, 20.0, 40.0, 40.0, 40.0, 20.0, 0.0, 40.0, 30.0, 40.0, 50.0, 0.0, 10.0, 50.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 150.0, 60.0, 40.0, 60.0, 10.0, 20.0, 30.0, 60.0, 20.0, 20.0, 0.0, 0.0, 30.0, 0.0, 20.0, 0.0, 60.0, 20.0, 0.0, 20.0, 0.0, 40.0, 0.0, 20.0, 80.0, 160.0, 20.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 150.0, 20.0, 30.0, 30.0, 20.0, 90.0, 10.0, 170.0, 20.0, 40.0, 30.0, 30.0, 20.0, 30.0, 30.0, -10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 180.0, 30.0, 50.0, 10.0, 40.0, 60.0, 40.0, 10.0, 20.0, 30.0, 40.0, 100.0, 20.0, 20.0, 0.0, 50.0, 40.0, 30.0, 30.0, 10.0, 40.0, 40.0, 0.0, 20.0, 20.0, 30.0, 40.0, 10.0, 20.0, 10.0, 40.0, 40.0, 20.0, 0.0, 10.0, 100.0, 20.0, 30.0, 110.0, 40.0, 170.0, 20.0, 20.0, 50.0, 0.0, 40.0, 50.0, 150.0, 0.0, 30.0, 10.0, 20.0, 30.0, 290.0, 60.0, 0.0, 10.0, 20.0, 0.0, 0.0, 70.0, 50.0, 60.0, 0.0, 10.0, 60.0, 10.0, 10.0, 30.0, 50.0, 50.0, 0.0, 20.0, 40.0, 30.0, 10.0, 30.0, 10.0, 10.0, 30.0, 30.0, -50.0, 30.0, 0.0, 160.0, 30.0, 0.0, -40.0, 20.0, 160.0, 0.0, 40.0, 0.0, 5.0, 40.0, 30.0, 60.0, 0.0, 30.0, 40.0, 20.0, 30.0, 20.0, 40.0, 30.0, 40.0, 50.0, 170.0, 50.0, 170.0, 160.0, 0.0, 30.0, 40.0, 270.0, 40.0, 50.0, 10.0, 10.0, 30.0, 0.0, 20.0, 30.0, 20.0, 30.0, 0.0, 40.0, 20.0, 30.0, 60.0, 30.0, 20.0, 10.0, 60.0, 60.0, 460.0, 80.0, 70.0, 30.0, 60.0, 30.0, 20.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 20.0, 30.0, 30.0, 40.0, 10.0, 20.0, 0.0, 30.0, 60.0, 30.0, 20.0, 20.0, 30.0, 20.0, 0.0, 10.0, 10.0, 30.0, 50.0, 0.0, 0.0, 20.0, -65.0, 60.0, 190.0, 20.0, 150.0, 30.0, 20.0, 0.0, 60.0, 20.0, 20.0, 10.0, 20.0, 30.0, 70.0, 10.0, 10.0, 0.0, 70.0, 0.0, 0.0, 60.0, 20.0, 10.0, 90.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 70.0, 40.0, -100.0, 10.0, 40.0, 0.0, 30.0, 0.0, 20.0, 0.0, 30.0, 40.0, 10.0, 30.0, 30.0, 70.0, 30.0, 80.0, 40.0, 30.0, 110.0, 20.0, 50.0, 10.0, 30.0, 110.0, 20.0, 70.0, 10.0, 40.0, 20.0, 0.0, 20.0, 70.0, 10.0, 20.0, 30.0, 10.0, 30.0, 10.0, 90.0, 10.0, 90.0, 20.0, 40.0, 40.0, 30.0, 30.0, 10.0, 20.0, 0.0, 0.0, 40.0, 20.0, 0.0, 10.0, 30.0, 10.0, 0.0, 50.0, 50.0, 60.0, 30.0, 10.0, 170.0, 10.0, 40.0, 160.0, 0.0, 0.0, 10.0, 20.0, 0.0, 30.0, 20.0, 80.0, 40.0, 0.0, 20.0, 20.0, 140.0, 0.0, 80.0, 20.0, 0.0, 20.0, 0.0, 30.0, 40.0, 10.0, 20.0, 100.0, 0.0, 30.0, 10.0, 80.0, 60.0, 170.0, 50.0, 20.0, 40.0, 10.0, 0.0, 60.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 190.0, 40.0, 60.0, 20.0, 30.0, 40.0, 40.0, 70.0, 10.0, 60.0, 40.0, 60.0, 30.0, 20.0, 10.0, 30.0, 10.0, 0.0, 60.0, 60.0, 10.0, 40.0, 80.0, 0.0, 10.0, 10.0, 30.0, 20.0, 10.0, 20.0, 10.0, 30.0, 10.0, 100.0, 20.0, 50.0, 20.0, 190.0, 30.0, 50.0, 70.0, 0.0, 30.0, 90.0, 20.0, -90.0, 50.0, 10.0, 260.0, 30.0, 30.0, 40.0, 0.0, 90.0, -145.0, 30.0, 40.0, 20.0, 10.0, 100.0, 30.0, 40.0, 0.0, 20.0, 60.0, 0.0, 30.0, 10.0, 20.0, 150.0, 0.0, 30.0, 0.0, 30.0, 50.0, 30.0, 10.0, 0.0, 80.0, 30.0, 0.0, 10.0, 0.0, 20.0, 20.0, 90.0, 40.0, 10.0, 0.0, 50.0, 150.0, 20.0, 30.0, 30.0, 70.0, 20.0, 30.0, 80.0, 110.0, 30.0, 30.0, 10.0, 30.0, 30.0, 60.0, 30.0, 150.0, 20.0, 10.0, 150.0, 10.0, 40.0, 10.0, 210.0, 10.0, 0.0, 30.0, 20.0, 10.0, 50.0, 60.0, 40.0, 10.0, 50.0, 40.0, 0.0, 0.0, 20.0, 20.0, 30.0, 160.0, 30.0, 10.0, 10.0, 170.0, -95.0, 10.0, 40.0, 10.0, 30.0, 20.0, 160.0, 70.0, 200.0, 80.0, 40.0, 20.0, 20.0, 50.0, 40.0, 30.0, 0.0, 40.0, 10.0, 0.0, 10.0, 0.0, 40.0, 10.0, 10.0, 280.0, -40.0, 10.0, 50.0, 30.0, 50.0, 210.0, 20.0, 270.0, 20.0, 40.0, 0.0, 0.0, 10.0, 80.0, 30.0, 60.0, 0.0, 20.0, 80.0, 10.0, 10.0, 50.0, 0.0, 10.0, 40.0, 20.0, -50.0, 70.0, 20.0, 0.0, 0.0, 30.0, 30.0, 10.0, 40.0, 0.0, 40.0, 80.0, 20.0, 70.0, 40.0, 40.0, 30.0, 20.0, 100.0, 20.0, 40.0, 20.0, 50.0, 80.0, 0.0, 20.0, 10.0, 0.0, 40.0, 20.0, 20.0, 0.0, 0.0, 30.0, 60.0, 0.0, 90.0, 10.0, 60.0, 30.0, 60.0, 60.0, 0.0, 0.0, 30.0, 50.0, 30.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 50.0, 10.0, 50.0, 30.0, 20.0, 170.0, 40.0, 10.0, 280.0, 0.0, 40.0, 20.0, 40.0, 90.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8848388257062476, "mean_inference_ms": 2.0925200103248147, "mean_action_processing_ms": 0.5216685081746484, "mean_env_wait_ms": 1.6622413568693457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05533099174499512, "StateBufferConnector_ms": 0.0102691650390625, "ViewRequirementAgentConnector_ms": 0.3753316402435303}, "num_episodes": 18, "episode_return_max": 890.0, "episode_return_min": 60.0, "episode_return_mean": 337.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.081741889742545, "num_env_steps_trained_throughput_per_sec": 36.081741889742545, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 880000, "timers": {"training_iteration_time_ms": 109892.513, "restore_workers_time_ms": 0.012, "training_step_time_ms": 109892.461, "sample_time_ms": 2411.479, "learn_time_ms": 107461.399, "learn_throughput": 37.223, "synch_weights_time_ms": 11.333}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 880000, "num_agent_steps_trained": 880000}, "done": false, "training_iteration": 22, "trial_id": "57140_00000", "date": "2024-06-27_00-00-12", "timestamp": 1719460812, "time_this_iter_s": 110.87322616577148, "time_total_s": 2739.6621775627136, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af43a550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2739.6621775627136, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 16.49871794871795, "ram_util_percent": 79.05320512820512}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8062937758791562, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.66219437195978, "policy_loss": -0.005958516500616015, "vf_loss": 4.667180349016849, "vf_explained_var": 0.0013993516580238384, "kl": 0.009725407078235352, "entropy": 1.1201445327653163, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 211275.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "env_runners": {"episode_reward_max": 1140.0, "episode_reward_min": 60.0, "episode_reward_mean": 375.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -145.0}, "policy_reward_max": {"policy_0": 530.0}, "policy_reward_mean": {"policy_0": 37.575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [300.0, 620.0, 130.0, 210.0, 300.0, 290.0, 310.0, 170.0, 130.0, 450.0, 460.0, 210.0, 150.0, 370.0, 260.0, 310.0, 420.0, 280.0, 390.0, 190.0, 180.0, 540.0, 460.0, 130.0, 450.0, 360.0, 230.0, 380.0, 540.0, 470.0, 300.0, 250.0, 210.0, 365.0, 490.0, 780.0, 220.0, 880.0, 190.0, 270.0, 170.0, 485.0, 260.0, 230.0, 60.0, 120.0, 360.0, 460.0, 250.0, 370.0, 130.0, 580.0, 220.0, 350.0, 530.0, 220.0, 520.0, 320.0, 270.0, 480.0, 490.0, 145.0, 310.0, 380.0, 220.0, 590.0, 400.0, 490.0, 290.0, 375.0, 690.0, 180.0, 890.0, 260.0, 240.0, 250.0, 400.0, 240.0, 400.0, 130.0, 190.0, 690.0, 640.0, 680.0, 140.0, 520.0, 340.0, 820.0, 370.0, 520.0, 520.0, 230.0, 730.0, 260.0, 300.0, 1140.0, 455.0, 770.0, 460.0, 400.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 150.0, 20.0, 0.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 250.0, 10.0, 20.0, 280.0, 20.0, 10.0, 10.0, 30.0, -40.0, 30.0, 40.0, 10.0, 0.0, 20.0, 10.0, 20.0, 20.0, 10.0, 0.0, 0.0, 30.0, 10.0, 20.0, 20.0, 0.0, 0.0, 40.0, 20.0, 70.0, 0.0, 20.0, 60.0, 60.0, 20.0, 20.0, -70.0, 160.0, 10.0, 40.0, -20.0, 20.0, 10.0, 60.0, 30.0, 60.0, 40.0, 0.0, 30.0, 20.0, 20.0, 30.0, 20.0, 0.0, 160.0, 40.0, 50.0, 0.0, 0.0, 0.0, 10.0, 20.0, 50.0, 0.0, 10.0, 20.0, 20.0, 10.0, 10.0, 20.0, 10.0, 30.0, 0.0, 10.0, 40.0, 10.0, 0.0, 0.0, 0.0, 0.0, 40.0, 0.0, 10.0, 0.0, 20.0, 30.0, 200.0, 0.0, 30.0, 160.0, 0.0, 20.0, 50.0, 200.0, 40.0, 70.0, 10.0, -50.0, 60.0, 30.0, 30.0, 30.0, 10.0, 0.0, 20.0, 60.0, 20.0, 50.0, 0.0, 0.0, 20.0, 10.0, 30.0, 10.0, 0.0, 60.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 160.0, 20.0, 20.0, 40.0, 60.0, 0.0, 40.0, 20.0, 10.0, 10.0, 70.0, 40.0, 10.0, 20.0, 10.0, 20.0, 50.0, 20.0, 40.0, 10.0, 10.0, 20.0, 0.0, 40.0, 70.0, 30.0, 80.0, 10.0, 0.0, 20.0, 180.0, 20.0, 0.0, 20.0, 80.0, 20.0, 40.0, 40.0, 40.0, 20.0, 0.0, 40.0, 30.0, 40.0, 50.0, 0.0, 10.0, 50.0, 0.0, 20.0, 30.0, 10.0, 10.0, 10.0, 150.0, 60.0, 40.0, 60.0, 10.0, 20.0, 30.0, 60.0, 20.0, 20.0, 0.0, 0.0, 30.0, 0.0, 20.0, 0.0, 60.0, 20.0, 0.0, 20.0, 0.0, 40.0, 0.0, 20.0, 80.0, 160.0, 20.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 150.0, 20.0, 30.0, 30.0, 20.0, 90.0, 10.0, 170.0, 20.0, 40.0, 30.0, 30.0, 20.0, 30.0, 30.0, -10.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 180.0, 30.0, 50.0, 10.0, 40.0, 60.0, 40.0, 10.0, 20.0, 30.0, 40.0, 100.0, 20.0, 20.0, 0.0, 50.0, 40.0, 30.0, 30.0, 10.0, 40.0, 40.0, 0.0, 20.0, 20.0, 30.0, 40.0, 10.0, 20.0, 10.0, 40.0, 40.0, 20.0, 0.0, 10.0, 100.0, 20.0, 30.0, 110.0, 40.0, 170.0, 20.0, 20.0, 50.0, 0.0, 40.0, 50.0, 150.0, 0.0, 30.0, 10.0, 20.0, 30.0, 290.0, 60.0, 0.0, 10.0, 20.0, 0.0, 0.0, 70.0, 50.0, 60.0, 0.0, 10.0, 60.0, 10.0, 10.0, 30.0, 50.0, 50.0, 0.0, 20.0, 40.0, 30.0, 10.0, 30.0, 10.0, 10.0, 30.0, 30.0, -50.0, 30.0, 0.0, 160.0, 30.0, 0.0, -40.0, 20.0, 160.0, 0.0, 40.0, 0.0, 5.0, 40.0, 30.0, 60.0, 0.0, 30.0, 40.0, 20.0, 30.0, 20.0, 40.0, 30.0, 40.0, 50.0, 170.0, 50.0, 170.0, 160.0, 0.0, 30.0, 40.0, 270.0, 40.0, 50.0, 10.0, 10.0, 30.0, 0.0, 20.0, 30.0, 20.0, 30.0, 0.0, 40.0, 20.0, 30.0, 60.0, 30.0, 20.0, 10.0, 60.0, 60.0, 460.0, 80.0, 70.0, 30.0, 60.0, 30.0, 20.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 20.0, 30.0, 30.0, 40.0, 10.0, 20.0, 0.0, 30.0, 60.0, 30.0, 20.0, 20.0, 30.0, 20.0, 0.0, 10.0, 10.0, 30.0, 50.0, 0.0, 0.0, 20.0, -65.0, 60.0, 190.0, 20.0, 150.0, 30.0, 20.0, 0.0, 60.0, 20.0, 20.0, 10.0, 20.0, 30.0, 70.0, 10.0, 10.0, 0.0, 70.0, 0.0, 0.0, 60.0, 20.0, 10.0, 90.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 70.0, 40.0, -100.0, 10.0, 40.0, 0.0, 30.0, 0.0, 20.0, 0.0, 30.0, 40.0, 10.0, 30.0, 30.0, 70.0, 30.0, 80.0, 40.0, 30.0, 110.0, 20.0, 50.0, 10.0, 30.0, 110.0, 20.0, 70.0, 10.0, 40.0, 20.0, 0.0, 20.0, 70.0, 10.0, 20.0, 30.0, 10.0, 30.0, 10.0, 90.0, 10.0, 90.0, 20.0, 40.0, 40.0, 30.0, 30.0, 10.0, 20.0, 0.0, 0.0, 40.0, 20.0, 0.0, 10.0, 30.0, 10.0, 0.0, 50.0, 50.0, 60.0, 30.0, 10.0, 170.0, 10.0, 40.0, 160.0, 0.0, 0.0, 10.0, 20.0, 0.0, 30.0, 20.0, 80.0, 40.0, 0.0, 20.0, 20.0, 140.0, 0.0, 80.0, 20.0, 0.0, 20.0, 0.0, 30.0, 40.0, 10.0, 20.0, 100.0, 0.0, 30.0, 10.0, 80.0, 60.0, 170.0, 50.0, 20.0, 40.0, 10.0, 0.0, 60.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 190.0, 40.0, 60.0, 20.0, 30.0, 40.0, 40.0, 70.0, 10.0, 60.0, 40.0, 60.0, 30.0, 20.0, 10.0, 30.0, 10.0, 0.0, 60.0, 60.0, 10.0, 40.0, 80.0, 0.0, 10.0, 10.0, 30.0, 20.0, 10.0, 20.0, 10.0, 30.0, 10.0, 100.0, 20.0, 50.0, 20.0, 190.0, 30.0, 50.0, 70.0, 0.0, 30.0, 90.0, 20.0, -90.0, 50.0, 10.0, 260.0, 30.0, 30.0, 40.0, 0.0, 90.0, -145.0, 30.0, 40.0, 20.0, 10.0, 100.0, 30.0, 40.0, 0.0, 20.0, 60.0, 0.0, 30.0, 10.0, 20.0, 150.0, 0.0, 30.0, 0.0, 30.0, 50.0, 30.0, 10.0, 0.0, 80.0, 30.0, 0.0, 10.0, 0.0, 20.0, 20.0, 90.0, 40.0, 10.0, 0.0, 50.0, 150.0, 20.0, 30.0, 30.0, 70.0, 20.0, 30.0, 80.0, 110.0, 30.0, 30.0, 10.0, 30.0, 30.0, 60.0, 30.0, 150.0, 20.0, 10.0, 150.0, 10.0, 40.0, 10.0, 210.0, 10.0, 0.0, 30.0, 20.0, 10.0, 50.0, 60.0, 40.0, 10.0, 50.0, 40.0, 0.0, 0.0, 20.0, 20.0, 30.0, 160.0, 30.0, 10.0, 10.0, 170.0, -95.0, 10.0, 40.0, 10.0, 30.0, 20.0, 160.0, 70.0, 200.0, 80.0, 40.0, 20.0, 20.0, 50.0, 40.0, 30.0, 0.0, 40.0, 10.0, 0.0, 10.0, 0.0, 40.0, 10.0, 10.0, 280.0, -40.0, 10.0, 50.0, 30.0, 50.0, 210.0, 20.0, 270.0, 20.0, 40.0, 0.0, 0.0, 10.0, 80.0, 30.0, 60.0, 0.0, 20.0, 80.0, 10.0, 10.0, 50.0, 0.0, 10.0, 40.0, 20.0, -50.0, 70.0, 20.0, 0.0, 0.0, 30.0, 30.0, 10.0, 40.0, 0.0, 40.0, 80.0, 20.0, 70.0, 40.0, 40.0, 30.0, 20.0, 100.0, 20.0, 40.0, 20.0, 50.0, 80.0, 0.0, 20.0, 10.0, 0.0, 40.0, 20.0, 20.0, 0.0, 0.0, 30.0, 60.0, 0.0, 90.0, 10.0, 60.0, 30.0, 60.0, 60.0, 0.0, 0.0, 30.0, 50.0, 30.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 50.0, 10.0, 50.0, 30.0, 20.0, 170.0, 40.0, 10.0, 280.0, 0.0, 40.0, 20.0, 40.0, 90.0, 0.0, 70.0, 100.0, 60.0, 10.0, 0.0, 310.0, 10.0, 0.0, 10.0, 70.0, 150.0, 250.0, 60.0, 40.0, 110.0, 20.0, -40.0, 20.0, 20.0, 50.0, 0.0, 10.0, 0.0, 0.0, 30.0, 20.0, 10.0, 40.0, 0.0, 30.0, 200.0, 30.0, 180.0, 20.0, 30.0, 20.0, 80.0, -50.0, 10.0, 0.0, 20.0, 30.0, 70.0, 40.0, 30.0, 20.0, 20.0, 70.0, 0.0, 40.0, 270.0, 90.0, -40.0, 40.0, 50.0, 20.0, 0.0, 0.0, 60.0, 330.0, 10.0, 60.0, 30.0, 70.0, 0.0, 40.0, 30.0, 60.0, 40.0, 30.0, 20.0, 20.0, 30.0, 20.0, 10.0, 60.0, 70.0, 50.0, 180.0, 60.0, 20.0, -20.0, 150.0, 50.0, 20.0, 20.0, 20.0, 150.0, 80.0, 30.0, 30.0, 0.0, 30.0, 20.0, 30.0, 20.0, 40.0, 10.0, 30.0, 20.0, -20.0, 90.0, 0.0, 250.0, -10.0, 40.0, 0.0, 30.0, 100.0, 250.0, 50.0, 50.0, 0.0, 30.0, 30.0, 10.0, 10.0, 40.0, 20.0, 20.0, 50.0, 10.0, 30.0, 40.0, 20.0, 20.0, 40.0, 50.0, 10.0, 30.0, 210.0, 90.0, 530.0, 90.0, 40.0, 50.0, 70.0, 50.0, -50.0, 60.0, 80.0, 90.0, 30.0, 0.0, 50.0, 15.0, 100.0, 70.0, 10.0, 10.0, 60.0, 460.0, 60.0, 10.0, -80.0, 10.0, -20.0, 60.0, 170.0, 40.0, 210.0, 40.0, 50.0, 20.0, 0.0, 10.0, 0.0, 40.0, 50.0, 40.0, 40.0, 40.0, 10.0, 30.0, 20.0, 70.0, 90.0, 30.0, 10.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.860771357954903, "mean_inference_ms": 2.0674270648406154, "mean_action_processing_ms": 0.5157866564952456, "mean_env_wait_ms": 1.6440592153224578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05520915985107422, "StateBufferConnector_ms": 0.010292768478393555, "ViewRequirementAgentConnector_ms": 0.3799598217010498}, "num_episodes": 18, "episode_return_max": 1140.0, "episode_return_min": 60.0, "episode_return_mean": 375.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.29778819656299, "num_env_steps_trained_throughput_per_sec": 36.29778819656299, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 920000, "timers": {"training_iteration_time_ms": 110013.24, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110013.188, "sample_time_ms": 2415.555, "learn_time_ms": 107577.656, "learn_throughput": 37.182, "synch_weights_time_ms": 11.548}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 920000, "num_agent_steps_trained": 920000}, "done": false, "training_iteration": 23, "trial_id": "57140_00000", "date": "2024-06-27_00-02-03", "timestamp": 1719460923, "time_this_iter_s": 110.20980501174927, "time_total_s": 2849.871982574463, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3e63a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2849.871982574463, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 15.560256410256411, "ram_util_percent": 79.82948717948717}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0665712259067135, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.385535287095335, "policy_loss": -0.005865221982053159, "vf_loss": 5.390581461669792, "vf_explained_var": 0.0022958928784623314, "kl": 0.008190412865723702, "entropy": 1.0642946959303592, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 220665.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "env_runners": {"episode_reward_max": 1140.0, "episode_reward_min": 60.0, "episode_reward_mean": 427.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -145.0}, "policy_reward_max": {"policy_0": 530.0}, "policy_reward_mean": {"policy_0": 42.72}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.0, 540.0, 470.0, 300.0, 250.0, 210.0, 365.0, 490.0, 780.0, 220.0, 880.0, 190.0, 270.0, 170.0, 485.0, 260.0, 230.0, 60.0, 120.0, 360.0, 460.0, 250.0, 370.0, 130.0, 580.0, 220.0, 350.0, 530.0, 220.0, 520.0, 320.0, 270.0, 480.0, 490.0, 145.0, 310.0, 380.0, 220.0, 590.0, 400.0, 490.0, 290.0, 375.0, 690.0, 180.0, 890.0, 260.0, 240.0, 250.0, 400.0, 240.0, 400.0, 130.0, 190.0, 690.0, 640.0, 680.0, 140.0, 520.0, 340.0, 820.0, 370.0, 520.0, 520.0, 230.0, 730.0, 260.0, 300.0, 1140.0, 455.0, 770.0, 460.0, 400.0, 670.0, 750.0, 250.0, 670.0, 540.0, 620.0, 150.0, 540.0, 655.0, 450.0, 760.0, 340.0, 250.0, 710.0, 650.0, 430.0, 420.0, 340.0, 410.0, 290.0, 490.0, 270.0, 850.0, 220.0, 350.0, 300.0, 1070.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 40.0, 40.0, 20.0, 0.0, 10.0, 100.0, 20.0, 30.0, 110.0, 40.0, 170.0, 20.0, 20.0, 50.0, 0.0, 40.0, 50.0, 150.0, 0.0, 30.0, 10.0, 20.0, 30.0, 290.0, 60.0, 0.0, 10.0, 20.0, 0.0, 0.0, 70.0, 50.0, 60.0, 0.0, 10.0, 60.0, 10.0, 10.0, 30.0, 50.0, 50.0, 0.0, 20.0, 40.0, 30.0, 10.0, 30.0, 10.0, 10.0, 30.0, 30.0, -50.0, 30.0, 0.0, 160.0, 30.0, 0.0, -40.0, 20.0, 160.0, 0.0, 40.0, 0.0, 5.0, 40.0, 30.0, 60.0, 0.0, 30.0, 40.0, 20.0, 30.0, 20.0, 40.0, 30.0, 40.0, 50.0, 170.0, 50.0, 170.0, 160.0, 0.0, 30.0, 40.0, 270.0, 40.0, 50.0, 10.0, 10.0, 30.0, 0.0, 20.0, 30.0, 20.0, 30.0, 0.0, 40.0, 20.0, 30.0, 60.0, 30.0, 20.0, 10.0, 60.0, 60.0, 460.0, 80.0, 70.0, 30.0, 60.0, 30.0, 20.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 20.0, 30.0, 30.0, 40.0, 10.0, 20.0, 0.0, 30.0, 60.0, 30.0, 20.0, 20.0, 30.0, 20.0, 0.0, 10.0, 10.0, 30.0, 50.0, 0.0, 0.0, 20.0, -65.0, 60.0, 190.0, 20.0, 150.0, 30.0, 20.0, 0.0, 60.0, 20.0, 20.0, 10.0, 20.0, 30.0, 70.0, 10.0, 10.0, 0.0, 70.0, 0.0, 0.0, 60.0, 20.0, 10.0, 90.0, 20.0, 10.0, 10.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 10.0, 70.0, 40.0, -100.0, 10.0, 40.0, 0.0, 30.0, 0.0, 20.0, 0.0, 30.0, 40.0, 10.0, 30.0, 30.0, 70.0, 30.0, 80.0, 40.0, 30.0, 110.0, 20.0, 50.0, 10.0, 30.0, 110.0, 20.0, 70.0, 10.0, 40.0, 20.0, 0.0, 20.0, 70.0, 10.0, 20.0, 30.0, 10.0, 30.0, 10.0, 90.0, 10.0, 90.0, 20.0, 40.0, 40.0, 30.0, 30.0, 10.0, 20.0, 0.0, 0.0, 40.0, 20.0, 0.0, 10.0, 30.0, 10.0, 0.0, 50.0, 50.0, 60.0, 30.0, 10.0, 170.0, 10.0, 40.0, 160.0, 0.0, 0.0, 10.0, 20.0, 0.0, 30.0, 20.0, 80.0, 40.0, 0.0, 20.0, 20.0, 140.0, 0.0, 80.0, 20.0, 0.0, 20.0, 0.0, 30.0, 40.0, 10.0, 20.0, 100.0, 0.0, 30.0, 10.0, 80.0, 60.0, 170.0, 50.0, 20.0, 40.0, 10.0, 0.0, 60.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 190.0, 40.0, 60.0, 20.0, 30.0, 40.0, 40.0, 70.0, 10.0, 60.0, 40.0, 60.0, 30.0, 20.0, 10.0, 30.0, 10.0, 0.0, 60.0, 60.0, 10.0, 40.0, 80.0, 0.0, 10.0, 10.0, 30.0, 20.0, 10.0, 20.0, 10.0, 30.0, 10.0, 100.0, 20.0, 50.0, 20.0, 190.0, 30.0, 50.0, 70.0, 0.0, 30.0, 90.0, 20.0, -90.0, 50.0, 10.0, 260.0, 30.0, 30.0, 40.0, 0.0, 90.0, -145.0, 30.0, 40.0, 20.0, 10.0, 100.0, 30.0, 40.0, 0.0, 20.0, 60.0, 0.0, 30.0, 10.0, 20.0, 150.0, 0.0, 30.0, 0.0, 30.0, 50.0, 30.0, 10.0, 0.0, 80.0, 30.0, 0.0, 10.0, 0.0, 20.0, 20.0, 90.0, 40.0, 10.0, 0.0, 50.0, 150.0, 20.0, 30.0, 30.0, 70.0, 20.0, 30.0, 80.0, 110.0, 30.0, 30.0, 10.0, 30.0, 30.0, 60.0, 30.0, 150.0, 20.0, 10.0, 150.0, 10.0, 40.0, 10.0, 210.0, 10.0, 0.0, 30.0, 20.0, 10.0, 50.0, 60.0, 40.0, 10.0, 50.0, 40.0, 0.0, 0.0, 20.0, 20.0, 30.0, 160.0, 30.0, 10.0, 10.0, 170.0, -95.0, 10.0, 40.0, 10.0, 30.0, 20.0, 160.0, 70.0, 200.0, 80.0, 40.0, 20.0, 20.0, 50.0, 40.0, 30.0, 0.0, 40.0, 10.0, 0.0, 10.0, 0.0, 40.0, 10.0, 10.0, 280.0, -40.0, 10.0, 50.0, 30.0, 50.0, 210.0, 20.0, 270.0, 20.0, 40.0, 0.0, 0.0, 10.0, 80.0, 30.0, 60.0, 0.0, 20.0, 80.0, 10.0, 10.0, 50.0, 0.0, 10.0, 40.0, 20.0, -50.0, 70.0, 20.0, 0.0, 0.0, 30.0, 30.0, 10.0, 40.0, 0.0, 40.0, 80.0, 20.0, 70.0, 40.0, 40.0, 30.0, 20.0, 100.0, 20.0, 40.0, 20.0, 50.0, 80.0, 0.0, 20.0, 10.0, 0.0, 40.0, 20.0, 20.0, 0.0, 0.0, 30.0, 60.0, 0.0, 90.0, 10.0, 60.0, 30.0, 60.0, 60.0, 0.0, 0.0, 30.0, 50.0, 30.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 50.0, 10.0, 50.0, 30.0, 20.0, 170.0, 40.0, 10.0, 280.0, 0.0, 40.0, 20.0, 40.0, 90.0, 0.0, 70.0, 100.0, 60.0, 10.0, 0.0, 310.0, 10.0, 0.0, 10.0, 70.0, 150.0, 250.0, 60.0, 40.0, 110.0, 20.0, -40.0, 20.0, 20.0, 50.0, 0.0, 10.0, 0.0, 0.0, 30.0, 20.0, 10.0, 40.0, 0.0, 30.0, 200.0, 30.0, 180.0, 20.0, 30.0, 20.0, 80.0, -50.0, 10.0, 0.0, 20.0, 30.0, 70.0, 40.0, 30.0, 20.0, 20.0, 70.0, 0.0, 40.0, 270.0, 90.0, -40.0, 40.0, 50.0, 20.0, 0.0, 0.0, 60.0, 330.0, 10.0, 60.0, 30.0, 70.0, 0.0, 40.0, 30.0, 60.0, 40.0, 30.0, 20.0, 20.0, 30.0, 20.0, 10.0, 60.0, 70.0, 50.0, 180.0, 60.0, 20.0, -20.0, 150.0, 50.0, 20.0, 20.0, 20.0, 150.0, 80.0, 30.0, 30.0, 0.0, 30.0, 20.0, 30.0, 20.0, 40.0, 10.0, 30.0, 20.0, -20.0, 90.0, 0.0, 250.0, -10.0, 40.0, 0.0, 30.0, 100.0, 250.0, 50.0, 50.0, 0.0, 30.0, 30.0, 10.0, 10.0, 40.0, 20.0, 20.0, 50.0, 10.0, 30.0, 40.0, 20.0, 20.0, 40.0, 50.0, 10.0, 30.0, 210.0, 90.0, 530.0, 90.0, 40.0, 50.0, 70.0, 50.0, -50.0, 60.0, 80.0, 90.0, 30.0, 0.0, 50.0, 15.0, 100.0, 70.0, 10.0, 10.0, 60.0, 460.0, 60.0, 10.0, -80.0, 10.0, -20.0, 60.0, 170.0, 40.0, 210.0, 40.0, 50.0, 20.0, 0.0, 10.0, 0.0, 40.0, 50.0, 40.0, 40.0, 40.0, 10.0, 30.0, 20.0, 70.0, 90.0, 30.0, 10.0, 60.0, 20.0, 50.0, 40.0, 40.0, 10.0, 70.0, 50.0, 180.0, 150.0, 60.0, 10.0, 90.0, 60.0, 30.0, 270.0, 30.0, 60.0, 40.0, 120.0, 40.0, 20.0, 30.0, 30.0, 20.0, 0.0, 30.0, 40.0, 40.0, 30.0, 10.0, 30.0, 170.0, 60.0, 60.0, 40.0, 160.0, 0.0, 80.0, 40.0, 30.0, 270.0, 10.0, 30.0, 20.0, 60.0, 0.0, 50.0, 0.0, 60.0, 40.0, 30.0, 40.0, 180.0, 10.0, 40.0, 80.0, 40.0, 40.0, 100.0, 60.0, 30.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 30.0, 0.0, 20.0, 110.0, 0.0, 0.0, 30.0, 160.0, 0.0, 20.0, 50.0, 20.0, 150.0, 20.0, 60.0, 350.0, 30.0, 170.0, -10.0, -50.0, 120.0, -65.0, 30.0, 40.0, 30.0, 0.0, 50.0, 40.0, 20.0, 190.0, 0.0, 0.0, 80.0, 130.0, 0.0, 150.0, 20.0, 70.0, 40.0, 270.0, 0.0, 40.0, 40.0, 10.0, 40.0, 20.0, 40.0, 30.0, 10.0, 20.0, 70.0, 10.0, 90.0, 30.0, 20.0, 30.0, 0.0, 60.0, 10.0, 20.0, 10.0, 40.0, 30.0, 30.0, 300.0, 140.0, -120.0, 20.0, 180.0, 20.0, 20.0, 80.0, 40.0, 20.0, 70.0, 170.0, 50.0, 70.0, 50.0, 60.0, 50.0, 30.0, 80.0, 160.0, 60.0, 50.0, 20.0, 10.0, 60.0, 0.0, 40.0, 20.0, 10.0, 40.0, 40.0, 40.0, 30.0, 70.0, 40.0, 10.0, 100.0, 20.0, 30.0, 160.0, 80.0, 0.0, 70.0, 30.0, 0.0, 40.0, 0.0, -40.0, 0.0, 60.0, 60.0, 10.0, 40.0, 40.0, 90.0, 40.0, 20.0, 20.0, 30.0, 50.0, 30.0, 20.0, 10.0, 60.0, 10.0, 10.0, 0.0, 30.0, 70.0, 20.0, 30.0, 0.0, 40.0, 0.0, 70.0, 10.0, 270.0, 10.0, 40.0, 40.0, 0.0, 10.0, 0.0, 70.0, 40.0, 0.0, 10.0, 40.0, 60.0, 50.0, 20.0, 150.0, 260.0, 20.0, 20.0, 260.0, 60.0, -30.0, 40.0, 0.0, 0.0, 20.0, 10.0, 40.0, 20.0, 50.0, 40.0, 20.0, 20.0, 50.0, 150.0, 20.0, 0.0, 10.0, 50.0, 10.0, 40.0, 10.0, 10.0, 40.0, 80.0, 30.0, 40.0, 0.0, 30.0, 40.0, 40.0, 0.0, 0.0, 10.0, 80.0, 30.0, 120.0, 20.0, 180.0, 40.0, 180.0, 40.0, 370.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8349548584091457, "mean_inference_ms": 2.031948826422307, "mean_action_processing_ms": 0.5159167686170142, "mean_env_wait_ms": 1.6201999915225536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0628056526184082, "StateBufferConnector_ms": 0.011073112487792969, "ViewRequirementAgentConnector_ms": 0.4059145450592041}, "num_episodes": 27, "episode_return_max": 1140.0, "episode_return_min": 60.0, "episode_return_mean": 427.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 35.94070966788573, "num_env_steps_trained_throughput_per_sec": 35.94070966788573, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 960000, "timers": {"training_iteration_time_ms": 110155.308, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110155.255, "sample_time_ms": 2443.356, "learn_time_ms": 107691.853, "learn_throughput": 37.143, "synch_weights_time_ms": 11.734}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 960000, "num_agent_steps_trained": 960000}, "done": false, "training_iteration": 24, "trial_id": "57140_00000", "date": "2024-06-27_00-03-54", "timestamp": 1719461034, "time_this_iter_s": 111.30726599693298, "time_total_s": 2961.179248571396, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3f6820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 2961.179248571396, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 16.022784810126584, "ram_util_percent": 78.77088607594936}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9463718738101414, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.389457565273086, "policy_loss": -0.005187150291603602, "vf_loss": 4.393878680905595, "vf_explained_var": 0.0017524308289963598, "kl": 0.007660370871717153, "entropy": 1.0645269717842627, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 230055.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "env_runners": {"episode_reward_max": 1190.0, "episode_reward_min": 80.0, "episode_reward_mean": 450.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -145.0}, "policy_reward_max": {"policy_0": 530.0}, "policy_reward_mean": {"policy_0": 45.07}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 360.0, 460.0, 250.0, 370.0, 130.0, 580.0, 220.0, 350.0, 530.0, 220.0, 520.0, 320.0, 270.0, 480.0, 490.0, 145.0, 310.0, 380.0, 220.0, 590.0, 400.0, 490.0, 290.0, 375.0, 690.0, 180.0, 890.0, 260.0, 240.0, 250.0, 400.0, 240.0, 400.0, 130.0, 190.0, 690.0, 640.0, 680.0, 140.0, 520.0, 340.0, 820.0, 370.0, 520.0, 520.0, 230.0, 730.0, 260.0, 300.0, 1140.0, 455.0, 770.0, 460.0, 400.0, 670.0, 750.0, 250.0, 670.0, 540.0, 620.0, 150.0, 540.0, 655.0, 450.0, 760.0, 340.0, 250.0, 710.0, 650.0, 430.0, 420.0, 340.0, 410.0, 290.0, 490.0, 270.0, 850.0, 220.0, 350.0, 300.0, 1070.0, 310.0, 380.0, 900.0, 1190.0, 350.0, 290.0, 830.0, 650.0, 430.0, 270.0, 440.0, 480.0, 430.0, 150.0, 720.0, 640.0, 360.0, 80.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 70.0, 40.0, -100.0, 10.0, 40.0, 0.0, 30.0, 0.0, 20.0, 0.0, 30.0, 40.0, 10.0, 30.0, 30.0, 70.0, 30.0, 80.0, 40.0, 30.0, 110.0, 20.0, 50.0, 10.0, 30.0, 110.0, 20.0, 70.0, 10.0, 40.0, 20.0, 0.0, 20.0, 70.0, 10.0, 20.0, 30.0, 10.0, 30.0, 10.0, 90.0, 10.0, 90.0, 20.0, 40.0, 40.0, 30.0, 30.0, 10.0, 20.0, 0.0, 0.0, 40.0, 20.0, 0.0, 10.0, 30.0, 10.0, 0.0, 50.0, 50.0, 60.0, 30.0, 10.0, 170.0, 10.0, 40.0, 160.0, 0.0, 0.0, 10.0, 20.0, 0.0, 30.0, 20.0, 80.0, 40.0, 0.0, 20.0, 20.0, 140.0, 0.0, 80.0, 20.0, 0.0, 20.0, 0.0, 30.0, 40.0, 10.0, 20.0, 100.0, 0.0, 30.0, 10.0, 80.0, 60.0, 170.0, 50.0, 20.0, 40.0, 10.0, 0.0, 60.0, 20.0, 10.0, 20.0, 20.0, 20.0, 20.0, 190.0, 40.0, 60.0, 20.0, 30.0, 40.0, 40.0, 70.0, 10.0, 60.0, 40.0, 60.0, 30.0, 20.0, 10.0, 30.0, 10.0, 0.0, 60.0, 60.0, 10.0, 40.0, 80.0, 0.0, 10.0, 10.0, 30.0, 20.0, 10.0, 20.0, 10.0, 30.0, 10.0, 100.0, 20.0, 50.0, 20.0, 190.0, 30.0, 50.0, 70.0, 0.0, 30.0, 90.0, 20.0, -90.0, 50.0, 10.0, 260.0, 30.0, 30.0, 40.0, 0.0, 90.0, -145.0, 30.0, 40.0, 20.0, 10.0, 100.0, 30.0, 40.0, 0.0, 20.0, 60.0, 0.0, 30.0, 10.0, 20.0, 150.0, 0.0, 30.0, 0.0, 30.0, 50.0, 30.0, 10.0, 0.0, 80.0, 30.0, 0.0, 10.0, 0.0, 20.0, 20.0, 90.0, 40.0, 10.0, 0.0, 50.0, 150.0, 20.0, 30.0, 30.0, 70.0, 20.0, 30.0, 80.0, 110.0, 30.0, 30.0, 10.0, 30.0, 30.0, 60.0, 30.0, 150.0, 20.0, 10.0, 150.0, 10.0, 40.0, 10.0, 210.0, 10.0, 0.0, 30.0, 20.0, 10.0, 50.0, 60.0, 40.0, 10.0, 50.0, 40.0, 0.0, 0.0, 20.0, 20.0, 30.0, 160.0, 30.0, 10.0, 10.0, 170.0, -95.0, 10.0, 40.0, 10.0, 30.0, 20.0, 160.0, 70.0, 200.0, 80.0, 40.0, 20.0, 20.0, 50.0, 40.0, 30.0, 0.0, 40.0, 10.0, 0.0, 10.0, 0.0, 40.0, 10.0, 10.0, 280.0, -40.0, 10.0, 50.0, 30.0, 50.0, 210.0, 20.0, 270.0, 20.0, 40.0, 0.0, 0.0, 10.0, 80.0, 30.0, 60.0, 0.0, 20.0, 80.0, 10.0, 10.0, 50.0, 0.0, 10.0, 40.0, 20.0, -50.0, 70.0, 20.0, 0.0, 0.0, 30.0, 30.0, 10.0, 40.0, 0.0, 40.0, 80.0, 20.0, 70.0, 40.0, 40.0, 30.0, 20.0, 100.0, 20.0, 40.0, 20.0, 50.0, 80.0, 0.0, 20.0, 10.0, 0.0, 40.0, 20.0, 20.0, 0.0, 0.0, 30.0, 60.0, 0.0, 90.0, 10.0, 60.0, 30.0, 60.0, 60.0, 0.0, 0.0, 30.0, 50.0, 30.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 50.0, 10.0, 50.0, 30.0, 20.0, 170.0, 40.0, 10.0, 280.0, 0.0, 40.0, 20.0, 40.0, 90.0, 0.0, 70.0, 100.0, 60.0, 10.0, 0.0, 310.0, 10.0, 0.0, 10.0, 70.0, 150.0, 250.0, 60.0, 40.0, 110.0, 20.0, -40.0, 20.0, 20.0, 50.0, 0.0, 10.0, 0.0, 0.0, 30.0, 20.0, 10.0, 40.0, 0.0, 30.0, 200.0, 30.0, 180.0, 20.0, 30.0, 20.0, 80.0, -50.0, 10.0, 0.0, 20.0, 30.0, 70.0, 40.0, 30.0, 20.0, 20.0, 70.0, 0.0, 40.0, 270.0, 90.0, -40.0, 40.0, 50.0, 20.0, 0.0, 0.0, 60.0, 330.0, 10.0, 60.0, 30.0, 70.0, 0.0, 40.0, 30.0, 60.0, 40.0, 30.0, 20.0, 20.0, 30.0, 20.0, 10.0, 60.0, 70.0, 50.0, 180.0, 60.0, 20.0, -20.0, 150.0, 50.0, 20.0, 20.0, 20.0, 150.0, 80.0, 30.0, 30.0, 0.0, 30.0, 20.0, 30.0, 20.0, 40.0, 10.0, 30.0, 20.0, -20.0, 90.0, 0.0, 250.0, -10.0, 40.0, 0.0, 30.0, 100.0, 250.0, 50.0, 50.0, 0.0, 30.0, 30.0, 10.0, 10.0, 40.0, 20.0, 20.0, 50.0, 10.0, 30.0, 40.0, 20.0, 20.0, 40.0, 50.0, 10.0, 30.0, 210.0, 90.0, 530.0, 90.0, 40.0, 50.0, 70.0, 50.0, -50.0, 60.0, 80.0, 90.0, 30.0, 0.0, 50.0, 15.0, 100.0, 70.0, 10.0, 10.0, 60.0, 460.0, 60.0, 10.0, -80.0, 10.0, -20.0, 60.0, 170.0, 40.0, 210.0, 40.0, 50.0, 20.0, 0.0, 10.0, 0.0, 40.0, 50.0, 40.0, 40.0, 40.0, 10.0, 30.0, 20.0, 70.0, 90.0, 30.0, 10.0, 60.0, 20.0, 50.0, 40.0, 40.0, 10.0, 70.0, 50.0, 180.0, 150.0, 60.0, 10.0, 90.0, 60.0, 30.0, 270.0, 30.0, 60.0, 40.0, 120.0, 40.0, 20.0, 30.0, 30.0, 20.0, 0.0, 30.0, 40.0, 40.0, 30.0, 10.0, 30.0, 170.0, 60.0, 60.0, 40.0, 160.0, 0.0, 80.0, 40.0, 30.0, 270.0, 10.0, 30.0, 20.0, 60.0, 0.0, 50.0, 0.0, 60.0, 40.0, 30.0, 40.0, 180.0, 10.0, 40.0, 80.0, 40.0, 40.0, 100.0, 60.0, 30.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 30.0, 0.0, 20.0, 110.0, 0.0, 0.0, 30.0, 160.0, 0.0, 20.0, 50.0, 20.0, 150.0, 20.0, 60.0, 350.0, 30.0, 170.0, -10.0, -50.0, 120.0, -65.0, 30.0, 40.0, 30.0, 0.0, 50.0, 40.0, 20.0, 190.0, 0.0, 0.0, 80.0, 130.0, 0.0, 150.0, 20.0, 70.0, 40.0, 270.0, 0.0, 40.0, 40.0, 10.0, 40.0, 20.0, 40.0, 30.0, 10.0, 20.0, 70.0, 10.0, 90.0, 30.0, 20.0, 30.0, 0.0, 60.0, 10.0, 20.0, 10.0, 40.0, 30.0, 30.0, 300.0, 140.0, -120.0, 20.0, 180.0, 20.0, 20.0, 80.0, 40.0, 20.0, 70.0, 170.0, 50.0, 70.0, 50.0, 60.0, 50.0, 30.0, 80.0, 160.0, 60.0, 50.0, 20.0, 10.0, 60.0, 0.0, 40.0, 20.0, 10.0, 40.0, 40.0, 40.0, 30.0, 70.0, 40.0, 10.0, 100.0, 20.0, 30.0, 160.0, 80.0, 0.0, 70.0, 30.0, 0.0, 40.0, 0.0, -40.0, 0.0, 60.0, 60.0, 10.0, 40.0, 40.0, 90.0, 40.0, 20.0, 20.0, 30.0, 50.0, 30.0, 20.0, 10.0, 60.0, 10.0, 10.0, 0.0, 30.0, 70.0, 20.0, 30.0, 0.0, 40.0, 0.0, 70.0, 10.0, 270.0, 10.0, 40.0, 40.0, 0.0, 10.0, 0.0, 70.0, 40.0, 0.0, 10.0, 40.0, 60.0, 50.0, 20.0, 150.0, 260.0, 20.0, 20.0, 260.0, 60.0, -30.0, 40.0, 0.0, 0.0, 20.0, 10.0, 40.0, 20.0, 50.0, 40.0, 20.0, 20.0, 50.0, 150.0, 20.0, 0.0, 10.0, 50.0, 10.0, 40.0, 10.0, 10.0, 40.0, 80.0, 30.0, 40.0, 0.0, 30.0, 40.0, 40.0, 0.0, 0.0, 10.0, 80.0, 30.0, 120.0, 20.0, 180.0, 40.0, 180.0, 40.0, 370.0, 30.0, 30.0, 0.0, 80.0, 20.0, 20.0, 40.0, 40.0, 10.0, 40.0, 40.0, 0.0, 70.0, 40.0, 20.0, 0.0, 60.0, 40.0, 40.0, 70.0, 40.0, 30.0, 0.0, 190.0, 310.0, 0.0, 100.0, 10.0, 50.0, 170.0, 190.0, 30.0, 250.0, 160.0, 50.0, 10.0, 210.0, 270.0, 150.0, -130.0, 40.0, 20.0, 10.0, 40.0, 20.0, 160.0, 20.0, 20.0, 0.0, 20.0, 50.0, -50.0, 10.0, 30.0, 40.0, 140.0, 10.0, 20.0, 0.0, 40.0, 310.0, 0.0, 90.0, 40.0, 10.0, 20.0, 270.0, 10.0, 40.0, 40.0, 100.0, 70.0, 280.0, 40.0, 10.0, 10.0, 20.0, 20.0, 70.0, 30.0, 0.0, 40.0, 30.0, 30.0, 20.0, 30.0, 70.0, 50.0, 120.0, 40.0, 10.0, 30.0, 10.0, 20.0, 0.0, 150.0, 0.0, 10.0, 0.0, 40.0, 0.0, 10.0, 260.0, 10.0, 20.0, 10.0, 50.0, 20.0, 10.0, 50.0, 20.0, 0.0, 10.0, 40.0, 170.0, 70.0, 20.0, 50.0, 70.0, 30.0, 150.0, 80.0, 0.0, 50.0, 20.0, 60.0, 20.0, 30.0, 10.0, 10.0, 20.0, 40.0, 30.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 10.0, 370.0, 60.0, 50.0, 60.0, 20.0, 50.0, 20.0, 90.0, 0.0, 0.0, 0.0, 60.0, 10.0, 200.0, 70.0, 60.0, -30.0, 50.0, 70.0, 150.0, 20.0, 10.0, 0.0, -20.0, 60.0, 160.0, 50.0, 80.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.8122003846801251, "mean_inference_ms": 2.0160822498766255, "mean_action_processing_ms": 0.5153468289421632, "mean_env_wait_ms": 1.6057131604408739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06265807151794434, "StateBufferConnector_ms": 0.01096487045288086, "ViewRequirementAgentConnector_ms": 0.4085850715637207}, "num_episodes": 18, "episode_return_max": 1190.0, "episode_return_min": 80.0, "episode_return_mean": 450.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.048412043846085, "num_env_steps_trained_throughput_per_sec": 36.048412043846085, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 1000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1000000, "timers": {"training_iteration_time_ms": 110293.261, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110293.209, "sample_time_ms": 2438.533, "learn_time_ms": 107834.632, "learn_throughput": 37.094, "synch_weights_time_ms": 11.735}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 1000000, "num_agent_steps_trained": 1000000}, "done": false, "training_iteration": 25, "trial_id": "57140_00000", "date": "2024-06-27_00-05-45", "timestamp": 1719461145, "time_this_iter_s": 110.97496891021729, "time_total_s": 3072.154217481613, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3f5c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3072.154217481613, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 15.810828025477708, "ram_util_percent": 79.02993630573249}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0647156277594094, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.627247448851126, "policy_loss": -0.0061494157428523925, "vf_loss": 4.632600514246379, "vf_explained_var": 0.0031860841158479927, "kl": 0.00796351964536596, "entropy": 1.0443076170608006, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 239445.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "env_runners": {"episode_reward_max": 1190.0, "episode_reward_min": 80.0, "episode_reward_mean": 463.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -200.0}, "policy_reward_max": {"policy_0": 530.0}, "policy_reward_mean": {"policy_0": 46.305}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.0, 220.0, 590.0, 400.0, 490.0, 290.0, 375.0, 690.0, 180.0, 890.0, 260.0, 240.0, 250.0, 400.0, 240.0, 400.0, 130.0, 190.0, 690.0, 640.0, 680.0, 140.0, 520.0, 340.0, 820.0, 370.0, 520.0, 520.0, 230.0, 730.0, 260.0, 300.0, 1140.0, 455.0, 770.0, 460.0, 400.0, 670.0, 750.0, 250.0, 670.0, 540.0, 620.0, 150.0, 540.0, 655.0, 450.0, 760.0, 340.0, 250.0, 710.0, 650.0, 430.0, 420.0, 340.0, 410.0, 290.0, 490.0, 270.0, 850.0, 220.0, 350.0, 300.0, 1070.0, 310.0, 380.0, 900.0, 1190.0, 350.0, 290.0, 830.0, 650.0, 430.0, 270.0, 440.0, 480.0, 430.0, 150.0, 720.0, 640.0, 360.0, 80.0, 480.0, 230.0, 310.0, 220.0, 150.0, 320.0, 250.0, 460.0, 520.0, 220.0, 550.0, 570.0, 730.0, 270.0, 1010.0, 360.0, 360.0, 350.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [150.0, 0.0, 30.0, 0.0, 30.0, 50.0, 30.0, 10.0, 0.0, 80.0, 30.0, 0.0, 10.0, 0.0, 20.0, 20.0, 90.0, 40.0, 10.0, 0.0, 50.0, 150.0, 20.0, 30.0, 30.0, 70.0, 20.0, 30.0, 80.0, 110.0, 30.0, 30.0, 10.0, 30.0, 30.0, 60.0, 30.0, 150.0, 20.0, 10.0, 150.0, 10.0, 40.0, 10.0, 210.0, 10.0, 0.0, 30.0, 20.0, 10.0, 50.0, 60.0, 40.0, 10.0, 50.0, 40.0, 0.0, 0.0, 20.0, 20.0, 30.0, 160.0, 30.0, 10.0, 10.0, 170.0, -95.0, 10.0, 40.0, 10.0, 30.0, 20.0, 160.0, 70.0, 200.0, 80.0, 40.0, 20.0, 20.0, 50.0, 40.0, 30.0, 0.0, 40.0, 10.0, 0.0, 10.0, 0.0, 40.0, 10.0, 10.0, 280.0, -40.0, 10.0, 50.0, 30.0, 50.0, 210.0, 20.0, 270.0, 20.0, 40.0, 0.0, 0.0, 10.0, 80.0, 30.0, 60.0, 0.0, 20.0, 80.0, 10.0, 10.0, 50.0, 0.0, 10.0, 40.0, 20.0, -50.0, 70.0, 20.0, 0.0, 0.0, 30.0, 30.0, 10.0, 40.0, 0.0, 40.0, 80.0, 20.0, 70.0, 40.0, 40.0, 30.0, 20.0, 100.0, 20.0, 40.0, 20.0, 50.0, 80.0, 0.0, 20.0, 10.0, 0.0, 40.0, 20.0, 20.0, 0.0, 0.0, 30.0, 60.0, 0.0, 90.0, 10.0, 60.0, 30.0, 60.0, 60.0, 0.0, 0.0, 30.0, 50.0, 30.0, 0.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 50.0, 10.0, 50.0, 30.0, 20.0, 170.0, 40.0, 10.0, 280.0, 0.0, 40.0, 20.0, 40.0, 90.0, 0.0, 70.0, 100.0, 60.0, 10.0, 0.0, 310.0, 10.0, 0.0, 10.0, 70.0, 150.0, 250.0, 60.0, 40.0, 110.0, 20.0, -40.0, 20.0, 20.0, 50.0, 0.0, 10.0, 0.0, 0.0, 30.0, 20.0, 10.0, 40.0, 0.0, 30.0, 200.0, 30.0, 180.0, 20.0, 30.0, 20.0, 80.0, -50.0, 10.0, 0.0, 20.0, 30.0, 70.0, 40.0, 30.0, 20.0, 20.0, 70.0, 0.0, 40.0, 270.0, 90.0, -40.0, 40.0, 50.0, 20.0, 0.0, 0.0, 60.0, 330.0, 10.0, 60.0, 30.0, 70.0, 0.0, 40.0, 30.0, 60.0, 40.0, 30.0, 20.0, 20.0, 30.0, 20.0, 10.0, 60.0, 70.0, 50.0, 180.0, 60.0, 20.0, -20.0, 150.0, 50.0, 20.0, 20.0, 20.0, 150.0, 80.0, 30.0, 30.0, 0.0, 30.0, 20.0, 30.0, 20.0, 40.0, 10.0, 30.0, 20.0, -20.0, 90.0, 0.0, 250.0, -10.0, 40.0, 0.0, 30.0, 100.0, 250.0, 50.0, 50.0, 0.0, 30.0, 30.0, 10.0, 10.0, 40.0, 20.0, 20.0, 50.0, 10.0, 30.0, 40.0, 20.0, 20.0, 40.0, 50.0, 10.0, 30.0, 210.0, 90.0, 530.0, 90.0, 40.0, 50.0, 70.0, 50.0, -50.0, 60.0, 80.0, 90.0, 30.0, 0.0, 50.0, 15.0, 100.0, 70.0, 10.0, 10.0, 60.0, 460.0, 60.0, 10.0, -80.0, 10.0, -20.0, 60.0, 170.0, 40.0, 210.0, 40.0, 50.0, 20.0, 0.0, 10.0, 0.0, 40.0, 50.0, 40.0, 40.0, 40.0, 10.0, 30.0, 20.0, 70.0, 90.0, 30.0, 10.0, 60.0, 20.0, 50.0, 40.0, 40.0, 10.0, 70.0, 50.0, 180.0, 150.0, 60.0, 10.0, 90.0, 60.0, 30.0, 270.0, 30.0, 60.0, 40.0, 120.0, 40.0, 20.0, 30.0, 30.0, 20.0, 0.0, 30.0, 40.0, 40.0, 30.0, 10.0, 30.0, 170.0, 60.0, 60.0, 40.0, 160.0, 0.0, 80.0, 40.0, 30.0, 270.0, 10.0, 30.0, 20.0, 60.0, 0.0, 50.0, 0.0, 60.0, 40.0, 30.0, 40.0, 180.0, 10.0, 40.0, 80.0, 40.0, 40.0, 100.0, 60.0, 30.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 30.0, 0.0, 20.0, 110.0, 0.0, 0.0, 30.0, 160.0, 0.0, 20.0, 50.0, 20.0, 150.0, 20.0, 60.0, 350.0, 30.0, 170.0, -10.0, -50.0, 120.0, -65.0, 30.0, 40.0, 30.0, 0.0, 50.0, 40.0, 20.0, 190.0, 0.0, 0.0, 80.0, 130.0, 0.0, 150.0, 20.0, 70.0, 40.0, 270.0, 0.0, 40.0, 40.0, 10.0, 40.0, 20.0, 40.0, 30.0, 10.0, 20.0, 70.0, 10.0, 90.0, 30.0, 20.0, 30.0, 0.0, 60.0, 10.0, 20.0, 10.0, 40.0, 30.0, 30.0, 300.0, 140.0, -120.0, 20.0, 180.0, 20.0, 20.0, 80.0, 40.0, 20.0, 70.0, 170.0, 50.0, 70.0, 50.0, 60.0, 50.0, 30.0, 80.0, 160.0, 60.0, 50.0, 20.0, 10.0, 60.0, 0.0, 40.0, 20.0, 10.0, 40.0, 40.0, 40.0, 30.0, 70.0, 40.0, 10.0, 100.0, 20.0, 30.0, 160.0, 80.0, 0.0, 70.0, 30.0, 0.0, 40.0, 0.0, -40.0, 0.0, 60.0, 60.0, 10.0, 40.0, 40.0, 90.0, 40.0, 20.0, 20.0, 30.0, 50.0, 30.0, 20.0, 10.0, 60.0, 10.0, 10.0, 0.0, 30.0, 70.0, 20.0, 30.0, 0.0, 40.0, 0.0, 70.0, 10.0, 270.0, 10.0, 40.0, 40.0, 0.0, 10.0, 0.0, 70.0, 40.0, 0.0, 10.0, 40.0, 60.0, 50.0, 20.0, 150.0, 260.0, 20.0, 20.0, 260.0, 60.0, -30.0, 40.0, 0.0, 0.0, 20.0, 10.0, 40.0, 20.0, 50.0, 40.0, 20.0, 20.0, 50.0, 150.0, 20.0, 0.0, 10.0, 50.0, 10.0, 40.0, 10.0, 10.0, 40.0, 80.0, 30.0, 40.0, 0.0, 30.0, 40.0, 40.0, 0.0, 0.0, 10.0, 80.0, 30.0, 120.0, 20.0, 180.0, 40.0, 180.0, 40.0, 370.0, 30.0, 30.0, 0.0, 80.0, 20.0, 20.0, 40.0, 40.0, 10.0, 40.0, 40.0, 0.0, 70.0, 40.0, 20.0, 0.0, 60.0, 40.0, 40.0, 70.0, 40.0, 30.0, 0.0, 190.0, 310.0, 0.0, 100.0, 10.0, 50.0, 170.0, 190.0, 30.0, 250.0, 160.0, 50.0, 10.0, 210.0, 270.0, 150.0, -130.0, 40.0, 20.0, 10.0, 40.0, 20.0, 160.0, 20.0, 20.0, 0.0, 20.0, 50.0, -50.0, 10.0, 30.0, 40.0, 140.0, 10.0, 20.0, 0.0, 40.0, 310.0, 0.0, 90.0, 40.0, 10.0, 20.0, 270.0, 10.0, 40.0, 40.0, 100.0, 70.0, 280.0, 40.0, 10.0, 10.0, 20.0, 20.0, 70.0, 30.0, 0.0, 40.0, 30.0, 30.0, 20.0, 30.0, 70.0, 50.0, 120.0, 40.0, 10.0, 30.0, 10.0, 20.0, 0.0, 150.0, 0.0, 10.0, 0.0, 40.0, 0.0, 10.0, 260.0, 10.0, 20.0, 10.0, 50.0, 20.0, 10.0, 50.0, 20.0, 0.0, 10.0, 40.0, 170.0, 70.0, 20.0, 50.0, 70.0, 30.0, 150.0, 80.0, 0.0, 50.0, 20.0, 60.0, 20.0, 30.0, 10.0, 10.0, 20.0, 40.0, 30.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 10.0, 370.0, 60.0, 50.0, 60.0, 20.0, 50.0, 20.0, 90.0, 0.0, 0.0, 0.0, 60.0, 10.0, 200.0, 70.0, 60.0, -30.0, 50.0, 70.0, 150.0, 20.0, 10.0, 0.0, -20.0, 60.0, 160.0, 50.0, 80.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 40.0, 30.0, 20.0, 100.0, 200.0, 0.0, 50.0, 0.0, 20.0, 20.0, 80.0, 20.0, 110.0, 10.0, 10.0, 80.0, 20.0, -200.0, 20.0, 80.0, 40.0, 40.0, 130.0, 0.0, 0.0, 30.0, 10.0, 40.0, 10.0, 10.0, 0.0, 20.0, 0.0, 50.0, 20.0, 30.0, 0.0, 0.0, 0.0, 100.0, 0.0, 0.0, 10.0, 30.0, 30.0, 10.0, 50.0, 20.0, 0.0, 0.0, 10.0, 10.0, 30.0, 20.0, 50.0, 40.0, 50.0, 110.0, 0.0, 0.0, 20.0, 40.0, 10.0, 20.0, 40.0, 30.0, 30.0, 30.0, 20.0, 10.0, 110.0, 30.0, 40.0, 80.0, 0.0, 40.0, 70.0, 0.0, 40.0, 50.0, 20.0, 20.0, 190.0, 60.0, 10.0, 20.0, 60.0, 80.0, 30.0, 30.0, 20.0, 40.0, 60.0, 0.0, 0.0, 20.0, 10.0, 40.0, 0.0, 30.0, 50.0, 10.0, 160.0, 0.0, 10.0, 0.0, 30.0, 30.0, 0.0, 260.0, 0.0, 190.0, 40.0, 30.0, 20.0, 40.0, 50.0, 150.0, 10.0, 40.0, 70.0, 80.0, 30.0, 70.0, 70.0, 30.0, 60.0, 40.0, 60.0, 220.0, 20.0, 20.0, 10.0, 30.0, 100.0, 0.0, 10.0, 30.0, 40.0, 10.0, 80.0, 70.0, 70.0, 160.0, 80.0, 40.0, 130.0, 160.0, 60.0, 160.0, 10.0, 0.0, 0.0, 40.0, -20.0, 30.0, 40.0, 260.0, 0.0, 0.0, 30.0, 70.0, 80.0, 10.0, 40.0, 10.0, 20.0, 20.0, 70.0, 10.0, 40.0, 30.0, 50.0, 20.0, 20.0, 10.0, 30.0, 70.0, 30.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.79418653947249, "mean_inference_ms": 1.9976500058809035, "mean_action_processing_ms": 0.51533889287181, "mean_env_wait_ms": 1.5915929178220132, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06818437576293945, "StateBufferConnector_ms": 0.010903596878051758, "ViewRequirementAgentConnector_ms": 0.40169358253479004}, "num_episodes": 18, "episode_return_max": 1190.0, "episode_return_min": 80.0, "episode_return_mean": 463.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.27388595556654, "num_env_steps_trained_throughput_per_sec": 36.27388595556654, "timesteps_total": 104000, "num_env_steps_sampled_lifetime": 104000, "num_agent_steps_sampled_lifetime": 1040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1040000, "timers": {"training_iteration_time_ms": 110361.295, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110361.246, "sample_time_ms": 2444.181, "learn_time_ms": 107896.993, "learn_throughput": 37.072, "synch_weights_time_ms": 11.934}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 1040000, "num_agent_steps_trained": 1040000}, "done": false, "training_iteration": 26, "trial_id": "57140_00000", "date": "2024-06-27_00-07-35", "timestamp": 1719461255, "time_this_iter_s": 110.28483605384827, "time_total_s": 3182.4390535354614, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3e6dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3182.4390535354614, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 15.666666666666666, "ram_util_percent": 79.18525641025641}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.723967046107347, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.361065722603641, "policy_loss": -0.0061752658435669195, "vf_loss": 5.36634655465968, "vf_explained_var": 0.0009485743931941966, "kl": 0.008944321033708378, "entropy": 0.9992867883528891, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 248835.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "env_runners": {"episode_reward_max": 1310.0, "episode_reward_min": 80.0, "episode_reward_mean": 509.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -200.0}, "policy_reward_max": {"policy_0": 740.0}, "policy_reward_mean": {"policy_0": 50.98}, "custom_metrics": {}, "hist_stats": {"episode_reward": [690.0, 640.0, 680.0, 140.0, 520.0, 340.0, 820.0, 370.0, 520.0, 520.0, 230.0, 730.0, 260.0, 300.0, 1140.0, 455.0, 770.0, 460.0, 400.0, 670.0, 750.0, 250.0, 670.0, 540.0, 620.0, 150.0, 540.0, 655.0, 450.0, 760.0, 340.0, 250.0, 710.0, 650.0, 430.0, 420.0, 340.0, 410.0, 290.0, 490.0, 270.0, 850.0, 220.0, 350.0, 300.0, 1070.0, 310.0, 380.0, 900.0, 1190.0, 350.0, 290.0, 830.0, 650.0, 430.0, 270.0, 440.0, 480.0, 430.0, 150.0, 720.0, 640.0, 360.0, 80.0, 480.0, 230.0, 310.0, 220.0, 150.0, 320.0, 250.0, 460.0, 520.0, 220.0, 550.0, 570.0, 730.0, 270.0, 1010.0, 360.0, 360.0, 350.0, 810.0, 180.0, 800.0, 1310.0, 410.0, 1150.0, 400.0, 320.0, 410.0, 590.0, 850.0, 620.0, 190.0, 280.0, 640.0, 670.0, 875.0, 785.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [170.0, 40.0, 10.0, 280.0, 0.0, 40.0, 20.0, 40.0, 90.0, 0.0, 70.0, 100.0, 60.0, 10.0, 0.0, 310.0, 10.0, 0.0, 10.0, 70.0, 150.0, 250.0, 60.0, 40.0, 110.0, 20.0, -40.0, 20.0, 20.0, 50.0, 0.0, 10.0, 0.0, 0.0, 30.0, 20.0, 10.0, 40.0, 0.0, 30.0, 200.0, 30.0, 180.0, 20.0, 30.0, 20.0, 80.0, -50.0, 10.0, 0.0, 20.0, 30.0, 70.0, 40.0, 30.0, 20.0, 20.0, 70.0, 0.0, 40.0, 270.0, 90.0, -40.0, 40.0, 50.0, 20.0, 0.0, 0.0, 60.0, 330.0, 10.0, 60.0, 30.0, 70.0, 0.0, 40.0, 30.0, 60.0, 40.0, 30.0, 20.0, 20.0, 30.0, 20.0, 10.0, 60.0, 70.0, 50.0, 180.0, 60.0, 20.0, -20.0, 150.0, 50.0, 20.0, 20.0, 20.0, 150.0, 80.0, 30.0, 30.0, 0.0, 30.0, 20.0, 30.0, 20.0, 40.0, 10.0, 30.0, 20.0, -20.0, 90.0, 0.0, 250.0, -10.0, 40.0, 0.0, 30.0, 100.0, 250.0, 50.0, 50.0, 0.0, 30.0, 30.0, 10.0, 10.0, 40.0, 20.0, 20.0, 50.0, 10.0, 30.0, 40.0, 20.0, 20.0, 40.0, 50.0, 10.0, 30.0, 210.0, 90.0, 530.0, 90.0, 40.0, 50.0, 70.0, 50.0, -50.0, 60.0, 80.0, 90.0, 30.0, 0.0, 50.0, 15.0, 100.0, 70.0, 10.0, 10.0, 60.0, 460.0, 60.0, 10.0, -80.0, 10.0, -20.0, 60.0, 170.0, 40.0, 210.0, 40.0, 50.0, 20.0, 0.0, 10.0, 0.0, 40.0, 50.0, 40.0, 40.0, 40.0, 10.0, 30.0, 20.0, 70.0, 90.0, 30.0, 10.0, 60.0, 20.0, 50.0, 40.0, 40.0, 10.0, 70.0, 50.0, 180.0, 150.0, 60.0, 10.0, 90.0, 60.0, 30.0, 270.0, 30.0, 60.0, 40.0, 120.0, 40.0, 20.0, 30.0, 30.0, 20.0, 0.0, 30.0, 40.0, 40.0, 30.0, 10.0, 30.0, 170.0, 60.0, 60.0, 40.0, 160.0, 0.0, 80.0, 40.0, 30.0, 270.0, 10.0, 30.0, 20.0, 60.0, 0.0, 50.0, 0.0, 60.0, 40.0, 30.0, 40.0, 180.0, 10.0, 40.0, 80.0, 40.0, 40.0, 100.0, 60.0, 30.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 30.0, 0.0, 20.0, 110.0, 0.0, 0.0, 30.0, 160.0, 0.0, 20.0, 50.0, 20.0, 150.0, 20.0, 60.0, 350.0, 30.0, 170.0, -10.0, -50.0, 120.0, -65.0, 30.0, 40.0, 30.0, 0.0, 50.0, 40.0, 20.0, 190.0, 0.0, 0.0, 80.0, 130.0, 0.0, 150.0, 20.0, 70.0, 40.0, 270.0, 0.0, 40.0, 40.0, 10.0, 40.0, 20.0, 40.0, 30.0, 10.0, 20.0, 70.0, 10.0, 90.0, 30.0, 20.0, 30.0, 0.0, 60.0, 10.0, 20.0, 10.0, 40.0, 30.0, 30.0, 300.0, 140.0, -120.0, 20.0, 180.0, 20.0, 20.0, 80.0, 40.0, 20.0, 70.0, 170.0, 50.0, 70.0, 50.0, 60.0, 50.0, 30.0, 80.0, 160.0, 60.0, 50.0, 20.0, 10.0, 60.0, 0.0, 40.0, 20.0, 10.0, 40.0, 40.0, 40.0, 30.0, 70.0, 40.0, 10.0, 100.0, 20.0, 30.0, 160.0, 80.0, 0.0, 70.0, 30.0, 0.0, 40.0, 0.0, -40.0, 0.0, 60.0, 60.0, 10.0, 40.0, 40.0, 90.0, 40.0, 20.0, 20.0, 30.0, 50.0, 30.0, 20.0, 10.0, 60.0, 10.0, 10.0, 0.0, 30.0, 70.0, 20.0, 30.0, 0.0, 40.0, 0.0, 70.0, 10.0, 270.0, 10.0, 40.0, 40.0, 0.0, 10.0, 0.0, 70.0, 40.0, 0.0, 10.0, 40.0, 60.0, 50.0, 20.0, 150.0, 260.0, 20.0, 20.0, 260.0, 60.0, -30.0, 40.0, 0.0, 0.0, 20.0, 10.0, 40.0, 20.0, 50.0, 40.0, 20.0, 20.0, 50.0, 150.0, 20.0, 0.0, 10.0, 50.0, 10.0, 40.0, 10.0, 10.0, 40.0, 80.0, 30.0, 40.0, 0.0, 30.0, 40.0, 40.0, 0.0, 0.0, 10.0, 80.0, 30.0, 120.0, 20.0, 180.0, 40.0, 180.0, 40.0, 370.0, 30.0, 30.0, 0.0, 80.0, 20.0, 20.0, 40.0, 40.0, 10.0, 40.0, 40.0, 0.0, 70.0, 40.0, 20.0, 0.0, 60.0, 40.0, 40.0, 70.0, 40.0, 30.0, 0.0, 190.0, 310.0, 0.0, 100.0, 10.0, 50.0, 170.0, 190.0, 30.0, 250.0, 160.0, 50.0, 10.0, 210.0, 270.0, 150.0, -130.0, 40.0, 20.0, 10.0, 40.0, 20.0, 160.0, 20.0, 20.0, 0.0, 20.0, 50.0, -50.0, 10.0, 30.0, 40.0, 140.0, 10.0, 20.0, 0.0, 40.0, 310.0, 0.0, 90.0, 40.0, 10.0, 20.0, 270.0, 10.0, 40.0, 40.0, 100.0, 70.0, 280.0, 40.0, 10.0, 10.0, 20.0, 20.0, 70.0, 30.0, 0.0, 40.0, 30.0, 30.0, 20.0, 30.0, 70.0, 50.0, 120.0, 40.0, 10.0, 30.0, 10.0, 20.0, 0.0, 150.0, 0.0, 10.0, 0.0, 40.0, 0.0, 10.0, 260.0, 10.0, 20.0, 10.0, 50.0, 20.0, 10.0, 50.0, 20.0, 0.0, 10.0, 40.0, 170.0, 70.0, 20.0, 50.0, 70.0, 30.0, 150.0, 80.0, 0.0, 50.0, 20.0, 60.0, 20.0, 30.0, 10.0, 10.0, 20.0, 40.0, 30.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 10.0, 370.0, 60.0, 50.0, 60.0, 20.0, 50.0, 20.0, 90.0, 0.0, 0.0, 0.0, 60.0, 10.0, 200.0, 70.0, 60.0, -30.0, 50.0, 70.0, 150.0, 20.0, 10.0, 0.0, -20.0, 60.0, 160.0, 50.0, 80.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 40.0, 30.0, 20.0, 100.0, 200.0, 0.0, 50.0, 0.0, 20.0, 20.0, 80.0, 20.0, 110.0, 10.0, 10.0, 80.0, 20.0, -200.0, 20.0, 80.0, 40.0, 40.0, 130.0, 0.0, 0.0, 30.0, 10.0, 40.0, 10.0, 10.0, 0.0, 20.0, 0.0, 50.0, 20.0, 30.0, 0.0, 0.0, 0.0, 100.0, 0.0, 0.0, 10.0, 30.0, 30.0, 10.0, 50.0, 20.0, 0.0, 0.0, 10.0, 10.0, 30.0, 20.0, 50.0, 40.0, 50.0, 110.0, 0.0, 0.0, 20.0, 40.0, 10.0, 20.0, 40.0, 30.0, 30.0, 30.0, 20.0, 10.0, 110.0, 30.0, 40.0, 80.0, 0.0, 40.0, 70.0, 0.0, 40.0, 50.0, 20.0, 20.0, 190.0, 60.0, 10.0, 20.0, 60.0, 80.0, 30.0, 30.0, 20.0, 40.0, 60.0, 0.0, 0.0, 20.0, 10.0, 40.0, 0.0, 30.0, 50.0, 10.0, 160.0, 0.0, 10.0, 0.0, 30.0, 30.0, 0.0, 260.0, 0.0, 190.0, 40.0, 30.0, 20.0, 40.0, 50.0, 150.0, 10.0, 40.0, 70.0, 80.0, 30.0, 70.0, 70.0, 30.0, 60.0, 40.0, 60.0, 220.0, 20.0, 20.0, 10.0, 30.0, 100.0, 0.0, 10.0, 30.0, 40.0, 10.0, 80.0, 70.0, 70.0, 160.0, 80.0, 40.0, 130.0, 160.0, 60.0, 160.0, 10.0, 0.0, 0.0, 40.0, -20.0, 30.0, 40.0, 260.0, 0.0, 0.0, 30.0, 70.0, 80.0, 10.0, 40.0, 10.0, 20.0, 20.0, 70.0, 10.0, 40.0, 30.0, 50.0, 20.0, 20.0, 10.0, 30.0, 70.0, 30.0, 50.0, 0.0, 70.0, 160.0, 30.0, 60.0, 80.0, 160.0, 60.0, 160.0, 30.0, 0.0, 20.0, 30.0, 20.0, 20.0, 30.0, 30.0, 0.0, 0.0, 30.0, 30.0, 80.0, 30.0, 30.0, 170.0, 30.0, 50.0, 100.0, 110.0, 170.0, 20.0, 20.0, 160.0, 90.0, 740.0, 40.0, 0.0, 10.0, 80.0, 150.0, 20.0, 50.0, 20.0, 20.0, 20.0, 30.0, 30.0, 80.0, 90.0, 50.0, 50.0, 20.0, 180.0, 70.0, 440.0, 70.0, 30.0, 150.0, 110.0, 30.0, 0.0, 20.0, 20.0, 70.0, 80.0, 10.0, 0.0, 20.0, 80.0, 100.0, 30.0, 0.0, 170.0, 30.0, -100.0, 30.0, 90.0, 40.0, 30.0, 0.0, 0.0, 80.0, 50.0, 60.0, 50.0, 50.0, 10.0, 50.0, 60.0, 0.0, 20.0, 60.0, 10.0, 80.0, 40.0, 90.0, 10.0, 180.0, 90.0, 10.0, 20.0, 60.0, 50.0, 40.0, 80.0, -40.0, 80.0, 280.0, 120.0, 160.0, 50.0, 10.0, 60.0, 30.0, 30.0, 170.0, -10.0, 50.0, 190.0, 40.0, 20.0, 20.0, 10.0, 30.0, 20.0, 30.0, 0.0, 0.0, 40.0, 20.0, 20.0, 70.0, 30.0, 40.0, 30.0, 10.0, 40.0, 20.0, 10.0, 10.0, 20.0, 160.0, 40.0, 30.0, 40.0, 120.0, 210.0, 10.0, 10.0, 0.0, 350.0, 20.0, 10.0, 60.0, 0.0, 40.0, 20.0, 40.0, 40.0, 90.0, 160.0, 300.0, 30.0, 150.0, -30.0, 90.0, 5.0, 80.0, 10.0, 80.0, 30.0, 260.0, 80.0, 55.0, 160.0, 0.0, 10.0, 40.0, 110.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7774942999346508, "mean_inference_ms": 1.9811184003538238, "mean_action_processing_ms": 0.5154563156063665, "mean_env_wait_ms": 1.5785927574170642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06804776191711426, "StateBufferConnector_ms": 0.010390281677246094, "ViewRequirementAgentConnector_ms": 0.4003899097442627}, "num_episodes": 18, "episode_return_max": 1310.0, "episode_return_min": 80.0, "episode_return_mean": 509.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.054821930692654, "num_env_steps_trained_throughput_per_sec": 36.054821930692654, "timesteps_total": 108000, "num_env_steps_sampled_lifetime": 108000, "num_agent_steps_sampled_lifetime": 1080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1080000, "timers": {"training_iteration_time_ms": 110437.143, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110437.094, "sample_time_ms": 2440.322, "learn_time_ms": 107976.531, "learn_throughput": 37.045, "synch_weights_time_ms": 11.986}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 1080000, "num_agent_steps_trained": 1080000}, "done": false, "training_iteration": 27, "trial_id": "57140_00000", "date": "2024-06-27_00-09-26", "timestamp": 1719461366, "time_this_iter_s": 110.95561504364014, "time_total_s": 3293.3946685791016, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3ea790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3293.3946685791016, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 15.782802547770702, "ram_util_percent": 78.89872611464969}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9073293246146334, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.660674966993931, "policy_loss": -0.006052974149504432, "vf_loss": 4.665910938524972, "vf_explained_var": 0.0008836036482558082, "kl": 0.00816995640069534, "entropy": 1.0208183222939284, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 258225.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "env_runners": {"episode_reward_max": 1310.0, "episode_reward_min": 80.0, "episode_reward_mean": 504.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -200.0}, "policy_reward_max": {"policy_0": 740.0}, "policy_reward_mean": {"policy_0": 50.405}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, 670.0, 750.0, 250.0, 670.0, 540.0, 620.0, 150.0, 540.0, 655.0, 450.0, 760.0, 340.0, 250.0, 710.0, 650.0, 430.0, 420.0, 340.0, 410.0, 290.0, 490.0, 270.0, 850.0, 220.0, 350.0, 300.0, 1070.0, 310.0, 380.0, 900.0, 1190.0, 350.0, 290.0, 830.0, 650.0, 430.0, 270.0, 440.0, 480.0, 430.0, 150.0, 720.0, 640.0, 360.0, 80.0, 480.0, 230.0, 310.0, 220.0, 150.0, 320.0, 250.0, 460.0, 520.0, 220.0, 550.0, 570.0, 730.0, 270.0, 1010.0, 360.0, 360.0, 350.0, 810.0, 180.0, 800.0, 1310.0, 410.0, 1150.0, 400.0, 320.0, 410.0, 590.0, 850.0, 620.0, 190.0, 280.0, 640.0, 670.0, 875.0, 785.0, 700.0, 515.0, 370.0, 620.0, 220.0, 930.0, 310.0, 150.0, 610.0, 810.0, 270.0, 260.0, 870.0, 350.0, 1005.0, 220.0, 520.0, 280.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 40.0, 10.0, 30.0, 20.0, 70.0, 90.0, 30.0, 10.0, 60.0, 20.0, 50.0, 40.0, 40.0, 10.0, 70.0, 50.0, 180.0, 150.0, 60.0, 10.0, 90.0, 60.0, 30.0, 270.0, 30.0, 60.0, 40.0, 120.0, 40.0, 20.0, 30.0, 30.0, 20.0, 0.0, 30.0, 40.0, 40.0, 30.0, 10.0, 30.0, 170.0, 60.0, 60.0, 40.0, 160.0, 0.0, 80.0, 40.0, 30.0, 270.0, 10.0, 30.0, 20.0, 60.0, 0.0, 50.0, 0.0, 60.0, 40.0, 30.0, 40.0, 180.0, 10.0, 40.0, 80.0, 40.0, 40.0, 100.0, 60.0, 30.0, 10.0, 10.0, 20.0, 10.0, 10.0, 10.0, 30.0, 0.0, 20.0, 110.0, 0.0, 0.0, 30.0, 160.0, 0.0, 20.0, 50.0, 20.0, 150.0, 20.0, 60.0, 350.0, 30.0, 170.0, -10.0, -50.0, 120.0, -65.0, 30.0, 40.0, 30.0, 0.0, 50.0, 40.0, 20.0, 190.0, 0.0, 0.0, 80.0, 130.0, 0.0, 150.0, 20.0, 70.0, 40.0, 270.0, 0.0, 40.0, 40.0, 10.0, 40.0, 20.0, 40.0, 30.0, 10.0, 20.0, 70.0, 10.0, 90.0, 30.0, 20.0, 30.0, 0.0, 60.0, 10.0, 20.0, 10.0, 40.0, 30.0, 30.0, 300.0, 140.0, -120.0, 20.0, 180.0, 20.0, 20.0, 80.0, 40.0, 20.0, 70.0, 170.0, 50.0, 70.0, 50.0, 60.0, 50.0, 30.0, 80.0, 160.0, 60.0, 50.0, 20.0, 10.0, 60.0, 0.0, 40.0, 20.0, 10.0, 40.0, 40.0, 40.0, 30.0, 70.0, 40.0, 10.0, 100.0, 20.0, 30.0, 160.0, 80.0, 0.0, 70.0, 30.0, 0.0, 40.0, 0.0, -40.0, 0.0, 60.0, 60.0, 10.0, 40.0, 40.0, 90.0, 40.0, 20.0, 20.0, 30.0, 50.0, 30.0, 20.0, 10.0, 60.0, 10.0, 10.0, 0.0, 30.0, 70.0, 20.0, 30.0, 0.0, 40.0, 0.0, 70.0, 10.0, 270.0, 10.0, 40.0, 40.0, 0.0, 10.0, 0.0, 70.0, 40.0, 0.0, 10.0, 40.0, 60.0, 50.0, 20.0, 150.0, 260.0, 20.0, 20.0, 260.0, 60.0, -30.0, 40.0, 0.0, 0.0, 20.0, 10.0, 40.0, 20.0, 50.0, 40.0, 20.0, 20.0, 50.0, 150.0, 20.0, 0.0, 10.0, 50.0, 10.0, 40.0, 10.0, 10.0, 40.0, 80.0, 30.0, 40.0, 0.0, 30.0, 40.0, 40.0, 0.0, 0.0, 10.0, 80.0, 30.0, 120.0, 20.0, 180.0, 40.0, 180.0, 40.0, 370.0, 30.0, 30.0, 0.0, 80.0, 20.0, 20.0, 40.0, 40.0, 10.0, 40.0, 40.0, 0.0, 70.0, 40.0, 20.0, 0.0, 60.0, 40.0, 40.0, 70.0, 40.0, 30.0, 0.0, 190.0, 310.0, 0.0, 100.0, 10.0, 50.0, 170.0, 190.0, 30.0, 250.0, 160.0, 50.0, 10.0, 210.0, 270.0, 150.0, -130.0, 40.0, 20.0, 10.0, 40.0, 20.0, 160.0, 20.0, 20.0, 0.0, 20.0, 50.0, -50.0, 10.0, 30.0, 40.0, 140.0, 10.0, 20.0, 0.0, 40.0, 310.0, 0.0, 90.0, 40.0, 10.0, 20.0, 270.0, 10.0, 40.0, 40.0, 100.0, 70.0, 280.0, 40.0, 10.0, 10.0, 20.0, 20.0, 70.0, 30.0, 0.0, 40.0, 30.0, 30.0, 20.0, 30.0, 70.0, 50.0, 120.0, 40.0, 10.0, 30.0, 10.0, 20.0, 0.0, 150.0, 0.0, 10.0, 0.0, 40.0, 0.0, 10.0, 260.0, 10.0, 20.0, 10.0, 50.0, 20.0, 10.0, 50.0, 20.0, 0.0, 10.0, 40.0, 170.0, 70.0, 20.0, 50.0, 70.0, 30.0, 150.0, 80.0, 0.0, 50.0, 20.0, 60.0, 20.0, 30.0, 10.0, 10.0, 20.0, 40.0, 30.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 10.0, 370.0, 60.0, 50.0, 60.0, 20.0, 50.0, 20.0, 90.0, 0.0, 0.0, 0.0, 60.0, 10.0, 200.0, 70.0, 60.0, -30.0, 50.0, 70.0, 150.0, 20.0, 10.0, 0.0, -20.0, 60.0, 160.0, 50.0, 80.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 40.0, 30.0, 20.0, 100.0, 200.0, 0.0, 50.0, 0.0, 20.0, 20.0, 80.0, 20.0, 110.0, 10.0, 10.0, 80.0, 20.0, -200.0, 20.0, 80.0, 40.0, 40.0, 130.0, 0.0, 0.0, 30.0, 10.0, 40.0, 10.0, 10.0, 0.0, 20.0, 0.0, 50.0, 20.0, 30.0, 0.0, 0.0, 0.0, 100.0, 0.0, 0.0, 10.0, 30.0, 30.0, 10.0, 50.0, 20.0, 0.0, 0.0, 10.0, 10.0, 30.0, 20.0, 50.0, 40.0, 50.0, 110.0, 0.0, 0.0, 20.0, 40.0, 10.0, 20.0, 40.0, 30.0, 30.0, 30.0, 20.0, 10.0, 110.0, 30.0, 40.0, 80.0, 0.0, 40.0, 70.0, 0.0, 40.0, 50.0, 20.0, 20.0, 190.0, 60.0, 10.0, 20.0, 60.0, 80.0, 30.0, 30.0, 20.0, 40.0, 60.0, 0.0, 0.0, 20.0, 10.0, 40.0, 0.0, 30.0, 50.0, 10.0, 160.0, 0.0, 10.0, 0.0, 30.0, 30.0, 0.0, 260.0, 0.0, 190.0, 40.0, 30.0, 20.0, 40.0, 50.0, 150.0, 10.0, 40.0, 70.0, 80.0, 30.0, 70.0, 70.0, 30.0, 60.0, 40.0, 60.0, 220.0, 20.0, 20.0, 10.0, 30.0, 100.0, 0.0, 10.0, 30.0, 40.0, 10.0, 80.0, 70.0, 70.0, 160.0, 80.0, 40.0, 130.0, 160.0, 60.0, 160.0, 10.0, 0.0, 0.0, 40.0, -20.0, 30.0, 40.0, 260.0, 0.0, 0.0, 30.0, 70.0, 80.0, 10.0, 40.0, 10.0, 20.0, 20.0, 70.0, 10.0, 40.0, 30.0, 50.0, 20.0, 20.0, 10.0, 30.0, 70.0, 30.0, 50.0, 0.0, 70.0, 160.0, 30.0, 60.0, 80.0, 160.0, 60.0, 160.0, 30.0, 0.0, 20.0, 30.0, 20.0, 20.0, 30.0, 30.0, 0.0, 0.0, 30.0, 30.0, 80.0, 30.0, 30.0, 170.0, 30.0, 50.0, 100.0, 110.0, 170.0, 20.0, 20.0, 160.0, 90.0, 740.0, 40.0, 0.0, 10.0, 80.0, 150.0, 20.0, 50.0, 20.0, 20.0, 20.0, 30.0, 30.0, 80.0, 90.0, 50.0, 50.0, 20.0, 180.0, 70.0, 440.0, 70.0, 30.0, 150.0, 110.0, 30.0, 0.0, 20.0, 20.0, 70.0, 80.0, 10.0, 0.0, 20.0, 80.0, 100.0, 30.0, 0.0, 170.0, 30.0, -100.0, 30.0, 90.0, 40.0, 30.0, 0.0, 0.0, 80.0, 50.0, 60.0, 50.0, 50.0, 10.0, 50.0, 60.0, 0.0, 20.0, 60.0, 10.0, 80.0, 40.0, 90.0, 10.0, 180.0, 90.0, 10.0, 20.0, 60.0, 50.0, 40.0, 80.0, -40.0, 80.0, 280.0, 120.0, 160.0, 50.0, 10.0, 60.0, 30.0, 30.0, 170.0, -10.0, 50.0, 190.0, 40.0, 20.0, 20.0, 10.0, 30.0, 20.0, 30.0, 0.0, 0.0, 40.0, 20.0, 20.0, 70.0, 30.0, 40.0, 30.0, 10.0, 40.0, 20.0, 10.0, 10.0, 20.0, 160.0, 40.0, 30.0, 40.0, 120.0, 210.0, 10.0, 10.0, 0.0, 350.0, 20.0, 10.0, 60.0, 0.0, 40.0, 20.0, 40.0, 40.0, 90.0, 160.0, 300.0, 30.0, 150.0, -30.0, 90.0, 5.0, 80.0, 10.0, 80.0, 30.0, 260.0, 80.0, 55.0, 160.0, 0.0, 10.0, 40.0, 110.0, 40.0, 50.0, 20.0, 60.0, 10.0, 120.0, 0.0, 160.0, 40.0, 50.0, 190.0, 290.0, 50.0, 20.0, 15.0, 10.0, 50.0, 30.0, 30.0, 20.0, 0.0, 50.0, 30.0, 10.0, 40.0, 50.0, 130.0, 20.0, 0.0, 20.0, 20.0, 50.0, 170.0, 30.0, 20.0, 30.0, 50.0, 170.0, 0.0, 80.0, 20.0, 20.0, 20.0, 40.0, 0.0, 40.0, 40.0, 0.0, 10.0, 20.0, 30.0, 20.0, 50.0, 30.0, 80.0, 190.0, 300.0, 160.0, 30.0, 40.0, 30.0, 30.0, 60.0, 30.0, 40.0, 50.0, 20.0, 10.0, 40.0, 20.0, 10.0, 20.0, 0.0, 30.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 40.0, 70.0, 50.0, 10.0, 50.0, 40.0, 10.0, 70.0, 20.0, 260.0, 30.0, 190.0, 20.0, 70.0, 30.0, 0.0, 50.0, 200.0, 190.0, 30.0, 30.0, 60.0, 40.0, 0.0, 50.0, 0.0, 0.0, 10.0, 40.0, 20.0, 50.0, 0.0, 20.0, 40.0, 60.0, 50.0, 0.0, 10.0, 40.0, 0.0, 40.0, 60.0, 90.0, 40.0, 70.0, 60.0, 110.0, 40.0, 260.0, 80.0, 60.0, 20.0, 10.0, -40.0, 10.0, 20.0, 0.0, 40.0, 40.0, 70.0, 180.0, 15.0, 80.0, 50.0, 420.0, -50.0, -30.0, 50.0, 170.0, 0.0, 300.0, 60.0, 0.0, 20.0, 20.0, 40.0, 40.0, 40.0, 20.0, 10.0, -30.0, 160.0, 40.0, 20.0, 0.0, 50.0, 10.0, 20.0, 180.0, 20.0, 20.0, 10.0, 10.0, 30.0, 20.0, 10.0, 150.0, 20.0, 10.0, 20.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7617562156781792, "mean_inference_ms": 1.9659408465465813, "mean_action_processing_ms": 0.5157514544158872, "mean_env_wait_ms": 1.5664664407974862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06877374649047852, "StateBufferConnector_ms": 0.010394573211669922, "ViewRequirementAgentConnector_ms": 0.4270656108856201}, "num_episodes": 18, "episode_return_max": 1310.0, "episode_return_min": 80.0, "episode_return_mean": 504.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.27911790154769, "num_env_steps_trained_throughput_per_sec": 36.27911790154769, "timesteps_total": 112000, "num_env_steps_sampled_lifetime": 112000, "num_agent_steps_sampled_lifetime": 1120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1120000, "timers": {"training_iteration_time_ms": 110463.952, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110463.903, "sample_time_ms": 2452.064, "learn_time_ms": 107991.361, "learn_throughput": 37.04, "synch_weights_time_ms": 12.137}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 1120000, "num_agent_steps_trained": 1120000}, "done": false, "training_iteration": 28, "trial_id": "57140_00000", "date": "2024-06-27_00-11-17", "timestamp": 1719461477, "time_this_iter_s": 110.26823210716248, "time_total_s": 3403.662900686264, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3eb8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3403.662900686264, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 15.672435897435898, "ram_util_percent": 79.06538461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8690974400383722, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.900977727120169, "policy_loss": -0.005690511487274608, "vf_loss": 4.905908590815446, "vf_explained_var": 0.0011943741220508774, "kl": 0.007596462890729281, "entropy": 0.9794968254396075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 267615.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "env_runners": {"episode_reward_max": 1310.0, "episode_reward_min": 80.0, "episode_reward_mean": 516.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 27, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -200.0}, "policy_reward_max": {"policy_0": 740.0}, "policy_reward_mean": {"policy_0": 51.655}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1070.0, 310.0, 380.0, 900.0, 1190.0, 350.0, 290.0, 830.0, 650.0, 430.0, 270.0, 440.0, 480.0, 430.0, 150.0, 720.0, 640.0, 360.0, 80.0, 480.0, 230.0, 310.0, 220.0, 150.0, 320.0, 250.0, 460.0, 520.0, 220.0, 550.0, 570.0, 730.0, 270.0, 1010.0, 360.0, 360.0, 350.0, 810.0, 180.0, 800.0, 1310.0, 410.0, 1150.0, 400.0, 320.0, 410.0, 590.0, 850.0, 620.0, 190.0, 280.0, 640.0, 670.0, 875.0, 785.0, 700.0, 515.0, 370.0, 620.0, 220.0, 930.0, 310.0, 150.0, 610.0, 810.0, 270.0, 260.0, 870.0, 350.0, 1005.0, 220.0, 520.0, 280.0, 200.0, 400.0, 920.0, 500.0, 160.0, 880.0, 560.0, 650.0, 630.0, 340.0, 400.0, 585.0, 520.0, 430.0, 620.0, 780.0, 160.0, 290.0, 130.0, 340.0, 300.0, 540.0, 1130.0, 690.0, 475.0, 690.0, 705.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 80.0, 30.0, 120.0, 20.0, 180.0, 40.0, 180.0, 40.0, 370.0, 30.0, 30.0, 0.0, 80.0, 20.0, 20.0, 40.0, 40.0, 10.0, 40.0, 40.0, 0.0, 70.0, 40.0, 20.0, 0.0, 60.0, 40.0, 40.0, 70.0, 40.0, 30.0, 0.0, 190.0, 310.0, 0.0, 100.0, 10.0, 50.0, 170.0, 190.0, 30.0, 250.0, 160.0, 50.0, 10.0, 210.0, 270.0, 150.0, -130.0, 40.0, 20.0, 10.0, 40.0, 20.0, 160.0, 20.0, 20.0, 0.0, 20.0, 50.0, -50.0, 10.0, 30.0, 40.0, 140.0, 10.0, 20.0, 0.0, 40.0, 310.0, 0.0, 90.0, 40.0, 10.0, 20.0, 270.0, 10.0, 40.0, 40.0, 100.0, 70.0, 280.0, 40.0, 10.0, 10.0, 20.0, 20.0, 70.0, 30.0, 0.0, 40.0, 30.0, 30.0, 20.0, 30.0, 70.0, 50.0, 120.0, 40.0, 10.0, 30.0, 10.0, 20.0, 0.0, 150.0, 0.0, 10.0, 0.0, 40.0, 0.0, 10.0, 260.0, 10.0, 20.0, 10.0, 50.0, 20.0, 10.0, 50.0, 20.0, 0.0, 10.0, 40.0, 170.0, 70.0, 20.0, 50.0, 70.0, 30.0, 150.0, 80.0, 0.0, 50.0, 20.0, 60.0, 20.0, 30.0, 10.0, 10.0, 20.0, 40.0, 30.0, 10.0, 0.0, 30.0, 10.0, 0.0, 0.0, 10.0, 370.0, 60.0, 50.0, 60.0, 20.0, 50.0, 20.0, 90.0, 0.0, 0.0, 0.0, 60.0, 10.0, 200.0, 70.0, 60.0, -30.0, 50.0, 70.0, 150.0, 20.0, 10.0, 0.0, -20.0, 60.0, 160.0, 50.0, 80.0, 0.0, 0.0, 0.0, 0.0, 30.0, 30.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 40.0, 30.0, 20.0, 100.0, 200.0, 0.0, 50.0, 0.0, 20.0, 20.0, 80.0, 20.0, 110.0, 10.0, 10.0, 80.0, 20.0, -200.0, 20.0, 80.0, 40.0, 40.0, 130.0, 0.0, 0.0, 30.0, 10.0, 40.0, 10.0, 10.0, 0.0, 20.0, 0.0, 50.0, 20.0, 30.0, 0.0, 0.0, 0.0, 100.0, 0.0, 0.0, 10.0, 30.0, 30.0, 10.0, 50.0, 20.0, 0.0, 0.0, 10.0, 10.0, 30.0, 20.0, 50.0, 40.0, 50.0, 110.0, 0.0, 0.0, 20.0, 40.0, 10.0, 20.0, 40.0, 30.0, 30.0, 30.0, 20.0, 10.0, 110.0, 30.0, 40.0, 80.0, 0.0, 40.0, 70.0, 0.0, 40.0, 50.0, 20.0, 20.0, 190.0, 60.0, 10.0, 20.0, 60.0, 80.0, 30.0, 30.0, 20.0, 40.0, 60.0, 0.0, 0.0, 20.0, 10.0, 40.0, 0.0, 30.0, 50.0, 10.0, 160.0, 0.0, 10.0, 0.0, 30.0, 30.0, 0.0, 260.0, 0.0, 190.0, 40.0, 30.0, 20.0, 40.0, 50.0, 150.0, 10.0, 40.0, 70.0, 80.0, 30.0, 70.0, 70.0, 30.0, 60.0, 40.0, 60.0, 220.0, 20.0, 20.0, 10.0, 30.0, 100.0, 0.0, 10.0, 30.0, 40.0, 10.0, 80.0, 70.0, 70.0, 160.0, 80.0, 40.0, 130.0, 160.0, 60.0, 160.0, 10.0, 0.0, 0.0, 40.0, -20.0, 30.0, 40.0, 260.0, 0.0, 0.0, 30.0, 70.0, 80.0, 10.0, 40.0, 10.0, 20.0, 20.0, 70.0, 10.0, 40.0, 30.0, 50.0, 20.0, 20.0, 10.0, 30.0, 70.0, 30.0, 50.0, 0.0, 70.0, 160.0, 30.0, 60.0, 80.0, 160.0, 60.0, 160.0, 30.0, 0.0, 20.0, 30.0, 20.0, 20.0, 30.0, 30.0, 0.0, 0.0, 30.0, 30.0, 80.0, 30.0, 30.0, 170.0, 30.0, 50.0, 100.0, 110.0, 170.0, 20.0, 20.0, 160.0, 90.0, 740.0, 40.0, 0.0, 10.0, 80.0, 150.0, 20.0, 50.0, 20.0, 20.0, 20.0, 30.0, 30.0, 80.0, 90.0, 50.0, 50.0, 20.0, 180.0, 70.0, 440.0, 70.0, 30.0, 150.0, 110.0, 30.0, 0.0, 20.0, 20.0, 70.0, 80.0, 10.0, 0.0, 20.0, 80.0, 100.0, 30.0, 0.0, 170.0, 30.0, -100.0, 30.0, 90.0, 40.0, 30.0, 0.0, 0.0, 80.0, 50.0, 60.0, 50.0, 50.0, 10.0, 50.0, 60.0, 0.0, 20.0, 60.0, 10.0, 80.0, 40.0, 90.0, 10.0, 180.0, 90.0, 10.0, 20.0, 60.0, 50.0, 40.0, 80.0, -40.0, 80.0, 280.0, 120.0, 160.0, 50.0, 10.0, 60.0, 30.0, 30.0, 170.0, -10.0, 50.0, 190.0, 40.0, 20.0, 20.0, 10.0, 30.0, 20.0, 30.0, 0.0, 0.0, 40.0, 20.0, 20.0, 70.0, 30.0, 40.0, 30.0, 10.0, 40.0, 20.0, 10.0, 10.0, 20.0, 160.0, 40.0, 30.0, 40.0, 120.0, 210.0, 10.0, 10.0, 0.0, 350.0, 20.0, 10.0, 60.0, 0.0, 40.0, 20.0, 40.0, 40.0, 90.0, 160.0, 300.0, 30.0, 150.0, -30.0, 90.0, 5.0, 80.0, 10.0, 80.0, 30.0, 260.0, 80.0, 55.0, 160.0, 0.0, 10.0, 40.0, 110.0, 40.0, 50.0, 20.0, 60.0, 10.0, 120.0, 0.0, 160.0, 40.0, 50.0, 190.0, 290.0, 50.0, 20.0, 15.0, 10.0, 50.0, 30.0, 30.0, 20.0, 0.0, 50.0, 30.0, 10.0, 40.0, 50.0, 130.0, 20.0, 0.0, 20.0, 20.0, 50.0, 170.0, 30.0, 20.0, 30.0, 50.0, 170.0, 0.0, 80.0, 20.0, 20.0, 20.0, 40.0, 0.0, 40.0, 40.0, 0.0, 10.0, 20.0, 30.0, 20.0, 50.0, 30.0, 80.0, 190.0, 300.0, 160.0, 30.0, 40.0, 30.0, 30.0, 60.0, 30.0, 40.0, 50.0, 20.0, 10.0, 40.0, 20.0, 10.0, 20.0, 0.0, 30.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 40.0, 70.0, 50.0, 10.0, 50.0, 40.0, 10.0, 70.0, 20.0, 260.0, 30.0, 190.0, 20.0, 70.0, 30.0, 0.0, 50.0, 200.0, 190.0, 30.0, 30.0, 60.0, 40.0, 0.0, 50.0, 0.0, 0.0, 10.0, 40.0, 20.0, 50.0, 0.0, 20.0, 40.0, 60.0, 50.0, 0.0, 10.0, 40.0, 0.0, 40.0, 60.0, 90.0, 40.0, 70.0, 60.0, 110.0, 40.0, 260.0, 80.0, 60.0, 20.0, 10.0, -40.0, 10.0, 20.0, 0.0, 40.0, 40.0, 70.0, 180.0, 15.0, 80.0, 50.0, 420.0, -50.0, -30.0, 50.0, 170.0, 0.0, 300.0, 60.0, 0.0, 20.0, 20.0, 40.0, 40.0, 40.0, 20.0, 10.0, -30.0, 160.0, 40.0, 20.0, 0.0, 50.0, 10.0, 20.0, 180.0, 20.0, 20.0, 10.0, 10.0, 30.0, 20.0, 10.0, 150.0, 20.0, 10.0, 20.0, 0.0, 100.0, 30.0, 0.0, 0.0, 40.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 30.0, 20.0, 60.0, 0.0, 70.0, 160.0, 30.0, 30.0, 110.0, 70.0, 30.0, 320.0, -70.0, 40.0, 70.0, 280.0, 20.0, 50.0, 20.0, 30.0, 80.0, 70.0, 50.0, 60.0, 40.0, 40.0, 110.0, 0.0, 30.0, 0.0, 0.0, 10.0, 40.0, 10.0, 10.0, 0.0, 50.0, 10.0, 30.0, 200.0, 180.0, 190.0, 60.0, 30.0, 40.0, 80.0, 40.0, 30.0, 30.0, 70.0, 20.0, 20.0, 0.0, 60.0, 90.0, 10.0, 10.0, 250.0, 100.0, 90.0, 160.0, 20.0, 20.0, 100.0, 40.0, 20.0, 60.0, 40.0, 40.0, -30.0, 40.0, 0.0, 60.0, 40.0, 370.0, 40.0, 30.0, 40.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 260.0, 30.0, 0.0, 0.0, 70.0, 0.0, 20.0, 20.0, 40.0, 0.0, 60.0, 150.0, 20.0, 20.0, 20.0, 20.0, -5.0, 30.0, 160.0, 190.0, 20.0, 40.0, 90.0, 20.0, 60.0, 20.0, 10.0, 350.0, 20.0, -20.0, 20.0, 40.0, 10.0, 10.0, 0.0, 40.0, 30.0, 40.0, 50.0, 170.0, 10.0, 40.0, 10.0, 40.0, 20.0, 50.0, 250.0, 90.0, 10.0, 0.0, 60.0, 20.0, 70.0, 50.0, 40.0, 160.0, 0.0, 260.0, 40.0, 40.0, 20.0, 30.0, 160.0, 30.0, 10.0, 10.0, 0.0, 20.0, 20.0, 30.0, 50.0, 10.0, 10.0, 0.0, 50.0, 30.0, 10.0, 20.0, 10.0, 40.0, 20.0, 30.0, 60.0, 20.0, 30.0, 30.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 20.0, 50.0, 90.0, 10.0, 30.0, 0.0, 0.0, 20.0, 10.0, 30.0, 100.0, 10.0, 30.0, 10.0, 10.0, 30.0, 40.0, 30.0, 20.0, 40.0, 80.0, 10.0, 20.0, 20.0, 0.0, 50.0, 80.0, 170.0, 20.0, 130.0, 40.0, 100.0, 210.0, 80.0, 30.0, 170.0, 300.0, 110.0, 10.0, 80.0, 40.0, -10.0, 100.0, 30.0, 0.0, 40.0, 390.0, 20.0, 60.0, 30.0, 30.0, 150.0, 30.0, 30.0, -25.0, 30.0, 40.0, 170.0, 0.0, 40.0, 10.0, 0.0, -30.0, 360.0, 110.0, 160.0, 10.0, 20.0, 0.0, 40.0, 20.0, 40.0, 45.0, 160.0, 10.0, 60.0, 60.0, 20.0, 210.0, 30.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7389772276629873, "mean_inference_ms": 1.9430474018381563, "mean_action_processing_ms": 0.5091572458013924, "mean_env_wait_ms": 1.549137015467281, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06358981132507324, "StateBufferConnector_ms": 0.009467601776123047, "ViewRequirementAgentConnector_ms": 0.4122884273529053}, "num_episodes": 27, "episode_return_max": 1310.0, "episode_return_min": 80.0, "episode_return_mean": 516.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.27366251704726, "num_env_steps_trained_throughput_per_sec": 36.27366251704726, "timesteps_total": 116000, "num_env_steps_sampled_lifetime": 116000, "num_agent_steps_sampled_lifetime": 1160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1160000, "timers": {"training_iteration_time_ms": 110556.666, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110556.617, "sample_time_ms": 2460.516, "learn_time_ms": 108075.41, "learn_throughput": 37.011, "synch_weights_time_ms": 12.328}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 1160000, "num_agent_steps_trained": 1160000}, "done": false, "training_iteration": 29, "trial_id": "57140_00000", "date": "2024-06-27_00-13-07", "timestamp": 1719461587, "time_this_iter_s": 110.2863621711731, "time_total_s": 3513.949262857437, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3eaaf0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3513.949262857437, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 15.39294871794872, "ram_util_percent": 79.4525641025641}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8711418683377825, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.573052627971759, "policy_loss": -0.005572385518366314, "vf_loss": 4.577821585113883, "vf_explained_var": 0.0005000828427120773, "kl": 0.008034302572855352, "entropy": 0.9600199289405689, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 277005.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "env_runners": {"episode_reward_max": 1310.0, "episode_reward_min": 80.0, "episode_reward_mean": 509.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -200.0}, "policy_reward_max": {"policy_0": 740.0}, "policy_reward_mean": {"policy_0": 50.945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [80.0, 480.0, 230.0, 310.0, 220.0, 150.0, 320.0, 250.0, 460.0, 520.0, 220.0, 550.0, 570.0, 730.0, 270.0, 1010.0, 360.0, 360.0, 350.0, 810.0, 180.0, 800.0, 1310.0, 410.0, 1150.0, 400.0, 320.0, 410.0, 590.0, 850.0, 620.0, 190.0, 280.0, 640.0, 670.0, 875.0, 785.0, 700.0, 515.0, 370.0, 620.0, 220.0, 930.0, 310.0, 150.0, 610.0, 810.0, 270.0, 260.0, 870.0, 350.0, 1005.0, 220.0, 520.0, 280.0, 200.0, 400.0, 920.0, 500.0, 160.0, 880.0, 560.0, 650.0, 630.0, 340.0, 400.0, 585.0, 520.0, 430.0, 620.0, 780.0, 160.0, 290.0, 130.0, 340.0, 300.0, 540.0, 1130.0, 690.0, 475.0, 690.0, 705.0, 510.0, 650.0, 150.0, 710.0, 210.0, 990.0, 550.0, 820.0, 350.0, 170.0, 180.0, 310.0, 160.0, 210.0, 910.0, 1140.0, 850.0, 310.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 30.0, 30.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 40.0, 30.0, 20.0, 100.0, 200.0, 0.0, 50.0, 0.0, 20.0, 20.0, 80.0, 20.0, 110.0, 10.0, 10.0, 80.0, 20.0, -200.0, 20.0, 80.0, 40.0, 40.0, 130.0, 0.0, 0.0, 30.0, 10.0, 40.0, 10.0, 10.0, 0.0, 20.0, 0.0, 50.0, 20.0, 30.0, 0.0, 0.0, 0.0, 100.0, 0.0, 0.0, 10.0, 30.0, 30.0, 10.0, 50.0, 20.0, 0.0, 0.0, 10.0, 10.0, 30.0, 20.0, 50.0, 40.0, 50.0, 110.0, 0.0, 0.0, 20.0, 40.0, 10.0, 20.0, 40.0, 30.0, 30.0, 30.0, 20.0, 10.0, 110.0, 30.0, 40.0, 80.0, 0.0, 40.0, 70.0, 0.0, 40.0, 50.0, 20.0, 20.0, 190.0, 60.0, 10.0, 20.0, 60.0, 80.0, 30.0, 30.0, 20.0, 40.0, 60.0, 0.0, 0.0, 20.0, 10.0, 40.0, 0.0, 30.0, 50.0, 10.0, 160.0, 0.0, 10.0, 0.0, 30.0, 30.0, 0.0, 260.0, 0.0, 190.0, 40.0, 30.0, 20.0, 40.0, 50.0, 150.0, 10.0, 40.0, 70.0, 80.0, 30.0, 70.0, 70.0, 30.0, 60.0, 40.0, 60.0, 220.0, 20.0, 20.0, 10.0, 30.0, 100.0, 0.0, 10.0, 30.0, 40.0, 10.0, 80.0, 70.0, 70.0, 160.0, 80.0, 40.0, 130.0, 160.0, 60.0, 160.0, 10.0, 0.0, 0.0, 40.0, -20.0, 30.0, 40.0, 260.0, 0.0, 0.0, 30.0, 70.0, 80.0, 10.0, 40.0, 10.0, 20.0, 20.0, 70.0, 10.0, 40.0, 30.0, 50.0, 20.0, 20.0, 10.0, 30.0, 70.0, 30.0, 50.0, 0.0, 70.0, 160.0, 30.0, 60.0, 80.0, 160.0, 60.0, 160.0, 30.0, 0.0, 20.0, 30.0, 20.0, 20.0, 30.0, 30.0, 0.0, 0.0, 30.0, 30.0, 80.0, 30.0, 30.0, 170.0, 30.0, 50.0, 100.0, 110.0, 170.0, 20.0, 20.0, 160.0, 90.0, 740.0, 40.0, 0.0, 10.0, 80.0, 150.0, 20.0, 50.0, 20.0, 20.0, 20.0, 30.0, 30.0, 80.0, 90.0, 50.0, 50.0, 20.0, 180.0, 70.0, 440.0, 70.0, 30.0, 150.0, 110.0, 30.0, 0.0, 20.0, 20.0, 70.0, 80.0, 10.0, 0.0, 20.0, 80.0, 100.0, 30.0, 0.0, 170.0, 30.0, -100.0, 30.0, 90.0, 40.0, 30.0, 0.0, 0.0, 80.0, 50.0, 60.0, 50.0, 50.0, 10.0, 50.0, 60.0, 0.0, 20.0, 60.0, 10.0, 80.0, 40.0, 90.0, 10.0, 180.0, 90.0, 10.0, 20.0, 60.0, 50.0, 40.0, 80.0, -40.0, 80.0, 280.0, 120.0, 160.0, 50.0, 10.0, 60.0, 30.0, 30.0, 170.0, -10.0, 50.0, 190.0, 40.0, 20.0, 20.0, 10.0, 30.0, 20.0, 30.0, 0.0, 0.0, 40.0, 20.0, 20.0, 70.0, 30.0, 40.0, 30.0, 10.0, 40.0, 20.0, 10.0, 10.0, 20.0, 160.0, 40.0, 30.0, 40.0, 120.0, 210.0, 10.0, 10.0, 0.0, 350.0, 20.0, 10.0, 60.0, 0.0, 40.0, 20.0, 40.0, 40.0, 90.0, 160.0, 300.0, 30.0, 150.0, -30.0, 90.0, 5.0, 80.0, 10.0, 80.0, 30.0, 260.0, 80.0, 55.0, 160.0, 0.0, 10.0, 40.0, 110.0, 40.0, 50.0, 20.0, 60.0, 10.0, 120.0, 0.0, 160.0, 40.0, 50.0, 190.0, 290.0, 50.0, 20.0, 15.0, 10.0, 50.0, 30.0, 30.0, 20.0, 0.0, 50.0, 30.0, 10.0, 40.0, 50.0, 130.0, 20.0, 0.0, 20.0, 20.0, 50.0, 170.0, 30.0, 20.0, 30.0, 50.0, 170.0, 0.0, 80.0, 20.0, 20.0, 20.0, 40.0, 0.0, 40.0, 40.0, 0.0, 10.0, 20.0, 30.0, 20.0, 50.0, 30.0, 80.0, 190.0, 300.0, 160.0, 30.0, 40.0, 30.0, 30.0, 60.0, 30.0, 40.0, 50.0, 20.0, 10.0, 40.0, 20.0, 10.0, 20.0, 0.0, 30.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 40.0, 70.0, 50.0, 10.0, 50.0, 40.0, 10.0, 70.0, 20.0, 260.0, 30.0, 190.0, 20.0, 70.0, 30.0, 0.0, 50.0, 200.0, 190.0, 30.0, 30.0, 60.0, 40.0, 0.0, 50.0, 0.0, 0.0, 10.0, 40.0, 20.0, 50.0, 0.0, 20.0, 40.0, 60.0, 50.0, 0.0, 10.0, 40.0, 0.0, 40.0, 60.0, 90.0, 40.0, 70.0, 60.0, 110.0, 40.0, 260.0, 80.0, 60.0, 20.0, 10.0, -40.0, 10.0, 20.0, 0.0, 40.0, 40.0, 70.0, 180.0, 15.0, 80.0, 50.0, 420.0, -50.0, -30.0, 50.0, 170.0, 0.0, 300.0, 60.0, 0.0, 20.0, 20.0, 40.0, 40.0, 40.0, 20.0, 10.0, -30.0, 160.0, 40.0, 20.0, 0.0, 50.0, 10.0, 20.0, 180.0, 20.0, 20.0, 10.0, 10.0, 30.0, 20.0, 10.0, 150.0, 20.0, 10.0, 20.0, 0.0, 100.0, 30.0, 0.0, 0.0, 40.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 30.0, 20.0, 60.0, 0.0, 70.0, 160.0, 30.0, 30.0, 110.0, 70.0, 30.0, 320.0, -70.0, 40.0, 70.0, 280.0, 20.0, 50.0, 20.0, 30.0, 80.0, 70.0, 50.0, 60.0, 40.0, 40.0, 110.0, 0.0, 30.0, 0.0, 0.0, 10.0, 40.0, 10.0, 10.0, 0.0, 50.0, 10.0, 30.0, 200.0, 180.0, 190.0, 60.0, 30.0, 40.0, 80.0, 40.0, 30.0, 30.0, 70.0, 20.0, 20.0, 0.0, 60.0, 90.0, 10.0, 10.0, 250.0, 100.0, 90.0, 160.0, 20.0, 20.0, 100.0, 40.0, 20.0, 60.0, 40.0, 40.0, -30.0, 40.0, 0.0, 60.0, 40.0, 370.0, 40.0, 30.0, 40.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 260.0, 30.0, 0.0, 0.0, 70.0, 0.0, 20.0, 20.0, 40.0, 0.0, 60.0, 150.0, 20.0, 20.0, 20.0, 20.0, -5.0, 30.0, 160.0, 190.0, 20.0, 40.0, 90.0, 20.0, 60.0, 20.0, 10.0, 350.0, 20.0, -20.0, 20.0, 40.0, 10.0, 10.0, 0.0, 40.0, 30.0, 40.0, 50.0, 170.0, 10.0, 40.0, 10.0, 40.0, 20.0, 50.0, 250.0, 90.0, 10.0, 0.0, 60.0, 20.0, 70.0, 50.0, 40.0, 160.0, 0.0, 260.0, 40.0, 40.0, 20.0, 30.0, 160.0, 30.0, 10.0, 10.0, 0.0, 20.0, 20.0, 30.0, 50.0, 10.0, 10.0, 0.0, 50.0, 30.0, 10.0, 20.0, 10.0, 40.0, 20.0, 30.0, 60.0, 20.0, 30.0, 30.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 20.0, 50.0, 90.0, 10.0, 30.0, 0.0, 0.0, 20.0, 10.0, 30.0, 100.0, 10.0, 30.0, 10.0, 10.0, 30.0, 40.0, 30.0, 20.0, 40.0, 80.0, 10.0, 20.0, 20.0, 0.0, 50.0, 80.0, 170.0, 20.0, 130.0, 40.0, 100.0, 210.0, 80.0, 30.0, 170.0, 300.0, 110.0, 10.0, 80.0, 40.0, -10.0, 100.0, 30.0, 0.0, 40.0, 390.0, 20.0, 60.0, 30.0, 30.0, 150.0, 30.0, 30.0, -25.0, 30.0, 40.0, 170.0, 0.0, 40.0, 10.0, 0.0, -30.0, 360.0, 110.0, 160.0, 10.0, 20.0, 0.0, 40.0, 20.0, 40.0, 45.0, 160.0, 10.0, 60.0, 60.0, 20.0, 210.0, 30.0, 70.0, -100.0, 10.0, 90.0, 160.0, -30.0, 90.0, 40.0, 10.0, 60.0, 180.0, 60.0, 360.0, 20.0, 20.0, 40.0, 0.0, 40.0, 0.0, 30.0, 80.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 20.0, 0.0, 30.0, 20.0, 270.0, 40.0, 70.0, 10.0, 160.0, 40.0, 20.0, 20.0, 40.0, 40.0, 30.0, 40.0, 30.0, 30.0, 60.0, 10.0, 10.0, 20.0, 40.0, -60.0, 20.0, 40.0, 90.0, 90.0, 60.0, 50.0, 90.0, 50.0, 480.0, 20.0, 10.0, 10.0, 40.0, 0.0, 80.0, 30.0, 30.0, 250.0, 30.0, 70.0, 160.0, -30.0, -40.0, 90.0, 70.0, -30.0, 80.0, 550.0, 10.0, -40.0, 0.0, 30.0, 70.0, 170.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, 20.0, 30.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 50.0, 30.0, 0.0, 30.0, 30.0, 20.0, 30.0, 160.0, 30.0, 30.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 10.0, 10.0, 30.0, 0.0, 10.0, 20.0, 40.0, 0.0, 30.0, 50.0, 30.0, 10.0, 10.0, 10.0, 20.0, 10.0, 70.0, 40.0, 160.0, 30.0, 130.0, 300.0, 40.0, 20.0, 60.0, 60.0, 200.0, 70.0, 30.0, 50.0, 60.0, 350.0, 60.0, 50.0, 230.0, 40.0, 330.0, 100.0, 10.0, 160.0, 50.0, 60.0, 50.0, 30.0, 50.0, 10.0, 10.0, 40.0, 0.0, 20.0, 30.0, 80.0, 10.0, 30.0, 20.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7250658846836577, "mean_inference_ms": 1.9288523698343811, "mean_action_processing_ms": 0.5049887720728222, "mean_env_wait_ms": 1.5384079713186611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06542134284973145, "StateBufferConnector_ms": 0.009477853775024414, "ViewRequirementAgentConnector_ms": 0.41201162338256836}, "num_episodes": 18, "episode_return_max": 1310.0, "episode_return_min": 80.0, "episode_return_mean": 509.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.000302409805016, "num_env_steps_trained_throughput_per_sec": 36.000302409805016, "timesteps_total": 120000, "num_env_steps_sampled_lifetime": 120000, "num_agent_steps_sampled_lifetime": 1200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1200000, "timers": {"training_iteration_time_ms": 110664.892, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110664.843, "sample_time_ms": 2440.093, "learn_time_ms": 108203.756, "learn_throughput": 36.967, "synch_weights_time_ms": 12.326}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 1200000, "num_agent_steps_trained": 1200000}, "done": false, "training_iteration": 30, "trial_id": "57140_00000", "date": "2024-06-27_00-14-58", "timestamp": 1719461698, "time_this_iter_s": 111.12306499481201, "time_total_s": 3625.072327852249, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af43ab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3625.072327852249, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 16.23057324840764, "ram_util_percent": 79.18598726114651}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.874482849373604, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.969115339427456, "policy_loss": -0.006127352330360574, "vf_loss": 4.974428928114228, "vf_explained_var": 0.0004906372140390804, "kl": 0.008137680791020533, "entropy": 0.9063073842479779, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 286395.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "env_runners": {"episode_reward_max": 1330.0, "episode_reward_min": 130.0, "episode_reward_mean": 559.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 740.0}, "policy_reward_mean": {"policy_0": 55.955}, "custom_metrics": {}, "hist_stats": {"episode_reward": [350.0, 810.0, 180.0, 800.0, 1310.0, 410.0, 1150.0, 400.0, 320.0, 410.0, 590.0, 850.0, 620.0, 190.0, 280.0, 640.0, 670.0, 875.0, 785.0, 700.0, 515.0, 370.0, 620.0, 220.0, 930.0, 310.0, 150.0, 610.0, 810.0, 270.0, 260.0, 870.0, 350.0, 1005.0, 220.0, 520.0, 280.0, 200.0, 400.0, 920.0, 500.0, 160.0, 880.0, 560.0, 650.0, 630.0, 340.0, 400.0, 585.0, 520.0, 430.0, 620.0, 780.0, 160.0, 290.0, 130.0, 340.0, 300.0, 540.0, 1130.0, 690.0, 475.0, 690.0, 705.0, 510.0, 650.0, 150.0, 710.0, 210.0, 990.0, 550.0, 820.0, 350.0, 170.0, 180.0, 310.0, 160.0, 210.0, 910.0, 1140.0, 850.0, 310.0, 925.0, 250.0, 510.0, 410.0, 520.0, 1085.0, 940.0, 1000.0, 330.0, 640.0, 160.0, 440.0, 900.0, 710.0, 580.0, 1330.0, 1190.0, 180.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 30.0, 50.0, 20.0, 20.0, 10.0, 30.0, 70.0, 30.0, 50.0, 0.0, 70.0, 160.0, 30.0, 60.0, 80.0, 160.0, 60.0, 160.0, 30.0, 0.0, 20.0, 30.0, 20.0, 20.0, 30.0, 30.0, 0.0, 0.0, 30.0, 30.0, 80.0, 30.0, 30.0, 170.0, 30.0, 50.0, 100.0, 110.0, 170.0, 20.0, 20.0, 160.0, 90.0, 740.0, 40.0, 0.0, 10.0, 80.0, 150.0, 20.0, 50.0, 20.0, 20.0, 20.0, 30.0, 30.0, 80.0, 90.0, 50.0, 50.0, 20.0, 180.0, 70.0, 440.0, 70.0, 30.0, 150.0, 110.0, 30.0, 0.0, 20.0, 20.0, 70.0, 80.0, 10.0, 0.0, 20.0, 80.0, 100.0, 30.0, 0.0, 170.0, 30.0, -100.0, 30.0, 90.0, 40.0, 30.0, 0.0, 0.0, 80.0, 50.0, 60.0, 50.0, 50.0, 10.0, 50.0, 60.0, 0.0, 20.0, 60.0, 10.0, 80.0, 40.0, 90.0, 10.0, 180.0, 90.0, 10.0, 20.0, 60.0, 50.0, 40.0, 80.0, -40.0, 80.0, 280.0, 120.0, 160.0, 50.0, 10.0, 60.0, 30.0, 30.0, 170.0, -10.0, 50.0, 190.0, 40.0, 20.0, 20.0, 10.0, 30.0, 20.0, 30.0, 0.0, 0.0, 40.0, 20.0, 20.0, 70.0, 30.0, 40.0, 30.0, 10.0, 40.0, 20.0, 10.0, 10.0, 20.0, 160.0, 40.0, 30.0, 40.0, 120.0, 210.0, 10.0, 10.0, 0.0, 350.0, 20.0, 10.0, 60.0, 0.0, 40.0, 20.0, 40.0, 40.0, 90.0, 160.0, 300.0, 30.0, 150.0, -30.0, 90.0, 5.0, 80.0, 10.0, 80.0, 30.0, 260.0, 80.0, 55.0, 160.0, 0.0, 10.0, 40.0, 110.0, 40.0, 50.0, 20.0, 60.0, 10.0, 120.0, 0.0, 160.0, 40.0, 50.0, 190.0, 290.0, 50.0, 20.0, 15.0, 10.0, 50.0, 30.0, 30.0, 20.0, 0.0, 50.0, 30.0, 10.0, 40.0, 50.0, 130.0, 20.0, 0.0, 20.0, 20.0, 50.0, 170.0, 30.0, 20.0, 30.0, 50.0, 170.0, 0.0, 80.0, 20.0, 20.0, 20.0, 40.0, 0.0, 40.0, 40.0, 0.0, 10.0, 20.0, 30.0, 20.0, 50.0, 30.0, 80.0, 190.0, 300.0, 160.0, 30.0, 40.0, 30.0, 30.0, 60.0, 30.0, 40.0, 50.0, 20.0, 10.0, 40.0, 20.0, 10.0, 20.0, 0.0, 30.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 40.0, 70.0, 50.0, 10.0, 50.0, 40.0, 10.0, 70.0, 20.0, 260.0, 30.0, 190.0, 20.0, 70.0, 30.0, 0.0, 50.0, 200.0, 190.0, 30.0, 30.0, 60.0, 40.0, 0.0, 50.0, 0.0, 0.0, 10.0, 40.0, 20.0, 50.0, 0.0, 20.0, 40.0, 60.0, 50.0, 0.0, 10.0, 40.0, 0.0, 40.0, 60.0, 90.0, 40.0, 70.0, 60.0, 110.0, 40.0, 260.0, 80.0, 60.0, 20.0, 10.0, -40.0, 10.0, 20.0, 0.0, 40.0, 40.0, 70.0, 180.0, 15.0, 80.0, 50.0, 420.0, -50.0, -30.0, 50.0, 170.0, 0.0, 300.0, 60.0, 0.0, 20.0, 20.0, 40.0, 40.0, 40.0, 20.0, 10.0, -30.0, 160.0, 40.0, 20.0, 0.0, 50.0, 10.0, 20.0, 180.0, 20.0, 20.0, 10.0, 10.0, 30.0, 20.0, 10.0, 150.0, 20.0, 10.0, 20.0, 0.0, 100.0, 30.0, 0.0, 0.0, 40.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 30.0, 20.0, 60.0, 0.0, 70.0, 160.0, 30.0, 30.0, 110.0, 70.0, 30.0, 320.0, -70.0, 40.0, 70.0, 280.0, 20.0, 50.0, 20.0, 30.0, 80.0, 70.0, 50.0, 60.0, 40.0, 40.0, 110.0, 0.0, 30.0, 0.0, 0.0, 10.0, 40.0, 10.0, 10.0, 0.0, 50.0, 10.0, 30.0, 200.0, 180.0, 190.0, 60.0, 30.0, 40.0, 80.0, 40.0, 30.0, 30.0, 70.0, 20.0, 20.0, 0.0, 60.0, 90.0, 10.0, 10.0, 250.0, 100.0, 90.0, 160.0, 20.0, 20.0, 100.0, 40.0, 20.0, 60.0, 40.0, 40.0, -30.0, 40.0, 0.0, 60.0, 40.0, 370.0, 40.0, 30.0, 40.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 260.0, 30.0, 0.0, 0.0, 70.0, 0.0, 20.0, 20.0, 40.0, 0.0, 60.0, 150.0, 20.0, 20.0, 20.0, 20.0, -5.0, 30.0, 160.0, 190.0, 20.0, 40.0, 90.0, 20.0, 60.0, 20.0, 10.0, 350.0, 20.0, -20.0, 20.0, 40.0, 10.0, 10.0, 0.0, 40.0, 30.0, 40.0, 50.0, 170.0, 10.0, 40.0, 10.0, 40.0, 20.0, 50.0, 250.0, 90.0, 10.0, 0.0, 60.0, 20.0, 70.0, 50.0, 40.0, 160.0, 0.0, 260.0, 40.0, 40.0, 20.0, 30.0, 160.0, 30.0, 10.0, 10.0, 0.0, 20.0, 20.0, 30.0, 50.0, 10.0, 10.0, 0.0, 50.0, 30.0, 10.0, 20.0, 10.0, 40.0, 20.0, 30.0, 60.0, 20.0, 30.0, 30.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 20.0, 50.0, 90.0, 10.0, 30.0, 0.0, 0.0, 20.0, 10.0, 30.0, 100.0, 10.0, 30.0, 10.0, 10.0, 30.0, 40.0, 30.0, 20.0, 40.0, 80.0, 10.0, 20.0, 20.0, 0.0, 50.0, 80.0, 170.0, 20.0, 130.0, 40.0, 100.0, 210.0, 80.0, 30.0, 170.0, 300.0, 110.0, 10.0, 80.0, 40.0, -10.0, 100.0, 30.0, 0.0, 40.0, 390.0, 20.0, 60.0, 30.0, 30.0, 150.0, 30.0, 30.0, -25.0, 30.0, 40.0, 170.0, 0.0, 40.0, 10.0, 0.0, -30.0, 360.0, 110.0, 160.0, 10.0, 20.0, 0.0, 40.0, 20.0, 40.0, 45.0, 160.0, 10.0, 60.0, 60.0, 20.0, 210.0, 30.0, 70.0, -100.0, 10.0, 90.0, 160.0, -30.0, 90.0, 40.0, 10.0, 60.0, 180.0, 60.0, 360.0, 20.0, 20.0, 40.0, 0.0, 40.0, 0.0, 30.0, 80.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 20.0, 0.0, 30.0, 20.0, 270.0, 40.0, 70.0, 10.0, 160.0, 40.0, 20.0, 20.0, 40.0, 40.0, 30.0, 40.0, 30.0, 30.0, 60.0, 10.0, 10.0, 20.0, 40.0, -60.0, 20.0, 40.0, 90.0, 90.0, 60.0, 50.0, 90.0, 50.0, 480.0, 20.0, 10.0, 10.0, 40.0, 0.0, 80.0, 30.0, 30.0, 250.0, 30.0, 70.0, 160.0, -30.0, -40.0, 90.0, 70.0, -30.0, 80.0, 550.0, 10.0, -40.0, 0.0, 30.0, 70.0, 170.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, 20.0, 30.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 50.0, 30.0, 0.0, 30.0, 30.0, 20.0, 30.0, 160.0, 30.0, 30.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 10.0, 10.0, 30.0, 0.0, 10.0, 20.0, 40.0, 0.0, 30.0, 50.0, 30.0, 10.0, 10.0, 10.0, 20.0, 10.0, 70.0, 40.0, 160.0, 30.0, 130.0, 300.0, 40.0, 20.0, 60.0, 60.0, 200.0, 70.0, 30.0, 50.0, 60.0, 350.0, 60.0, 50.0, 230.0, 40.0, 330.0, 100.0, 10.0, 160.0, 50.0, 60.0, 50.0, 30.0, 50.0, 10.0, 10.0, 40.0, 0.0, 20.0, 30.0, 80.0, 10.0, 30.0, 20.0, 70.0, 40.0, 65.0, 270.0, 200.0, 10.0, 180.0, 190.0, 0.0, 20.0, -50.0, 10.0, 40.0, 30.0, 20.0, 40.0, 90.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, -40.0, 290.0, 20.0, 0.0, 40.0, 50.0, 80.0, 60.0, 0.0, 40.0, 10.0, 30.0, 100.0, 20.0, 60.0, 70.0, 90.0, -10.0, 20.0, 180.0, 0.0, 10.0, 20.0, 0.0, 40.0, 80.0, 0.0, 170.0, 50.0, 30.0, 260.0, 90.0, 5.0, 30.0, 30.0, 150.0, 50.0, 390.0, 0.0, 50.0, 160.0, 40.0, 160.0, 0.0, 40.0, 80.0, 360.0, 50.0, 80.0, 80.0, 210.0, 0.0, 210.0, 270.0, 90.0, 20.0, 10.0, 30.0, 40.0, 30.0, -10.0, 60.0, 0.0, 180.0, 0.0, 60.0, 0.0, -30.0, 0.0, 20.0, 20.0, 10.0, 100.0, 10.0, 60.0, -50.0, 90.0, 380.0, 40.0, 10.0, 0.0, 40.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 110.0, 150.0, 60.0, 0.0, 0.0, 40.0, 20.0, 40.0, 20.0, 0.0, 20.0, -40.0, 40.0, 80.0, 260.0, 50.0, 40.0, 30.0, 30.0, 390.0, 0.0, 20.0, 160.0, 30.0, 60.0, 90.0, 100.0, 10.0, 180.0, 60.0, 50.0, 10.0, 90.0, 100.0, 150.0, 20.0, 0.0, 30.0, 40.0, 90.0, 10.0, 40.0, 280.0, -20.0, 240.0, 30.0, 640.0, 70.0, 0.0, 40.0, 40.0, 50.0, 30.0, 90.0, 20.0, 250.0, -30.0, 200.0, 170.0, 370.0, 20.0, 10.0, 50.0, 40.0, 10.0, 0.0, 10.0, 30.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7126321124511954, "mean_inference_ms": 1.9156334992041508, "mean_action_processing_ms": 0.5011672239402764, "mean_env_wait_ms": 1.528516433930833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06010031700134277, "StateBufferConnector_ms": 0.009590387344360352, "ViewRequirementAgentConnector_ms": 0.41235876083374023}, "num_episodes": 18, "episode_return_max": 1330.0, "episode_return_min": 130.0, "episode_return_mean": 559.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.458088953340834, "num_env_steps_trained_throughput_per_sec": 36.458088953340834, "timesteps_total": 124000, "num_env_steps_sampled_lifetime": 124000, "num_agent_steps_sampled_lifetime": 1240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1240000, "timers": {"training_iteration_time_ms": 110588.403, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110588.354, "sample_time_ms": 2445.936, "learn_time_ms": 108121.688, "learn_throughput": 36.995, "synch_weights_time_ms": 12.025}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 1240000, "num_agent_steps_trained": 1240000}, "done": false, "training_iteration": 31, "trial_id": "57140_00000", "date": "2024-06-27_00-16-48", "timestamp": 1719461808, "time_this_iter_s": 109.73006796836853, "time_total_s": 3734.8023958206177, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3ea550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3734.8023958206177, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 15.731612903225807, "ram_util_percent": 79.08193548387098}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.787519662086956, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.792757908122354, "policy_loss": -0.005699112860231012, "vf_loss": 4.797698062550399, "vf_explained_var": 1.4571259958675495e-05, "kl": 0.007589536145003036, "entropy": 0.8970777690220184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 295785.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "env_runners": {"episode_reward_max": 1330.0, "episode_reward_min": 130.0, "episode_reward_mean": 543.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -240.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 54.345}, "custom_metrics": {}, "hist_stats": {"episode_reward": [785.0, 700.0, 515.0, 370.0, 620.0, 220.0, 930.0, 310.0, 150.0, 610.0, 810.0, 270.0, 260.0, 870.0, 350.0, 1005.0, 220.0, 520.0, 280.0, 200.0, 400.0, 920.0, 500.0, 160.0, 880.0, 560.0, 650.0, 630.0, 340.0, 400.0, 585.0, 520.0, 430.0, 620.0, 780.0, 160.0, 290.0, 130.0, 340.0, 300.0, 540.0, 1130.0, 690.0, 475.0, 690.0, 705.0, 510.0, 650.0, 150.0, 710.0, 210.0, 990.0, 550.0, 820.0, 350.0, 170.0, 180.0, 310.0, 160.0, 210.0, 910.0, 1140.0, 850.0, 310.0, 925.0, 250.0, 510.0, 410.0, 520.0, 1085.0, 940.0, 1000.0, 330.0, 640.0, 160.0, 440.0, 900.0, 710.0, 580.0, 1330.0, 1190.0, 180.0, 565.0, 1070.0, 440.0, 320.0, 730.0, 430.0, 450.0, 490.0, 490.0, 490.0, 130.0, 540.0, 420.0, 390.0, 280.0, 770.0, 735.0, 505.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 260.0, 80.0, 55.0, 160.0, 0.0, 10.0, 40.0, 110.0, 40.0, 50.0, 20.0, 60.0, 10.0, 120.0, 0.0, 160.0, 40.0, 50.0, 190.0, 290.0, 50.0, 20.0, 15.0, 10.0, 50.0, 30.0, 30.0, 20.0, 0.0, 50.0, 30.0, 10.0, 40.0, 50.0, 130.0, 20.0, 0.0, 20.0, 20.0, 50.0, 170.0, 30.0, 20.0, 30.0, 50.0, 170.0, 0.0, 80.0, 20.0, 20.0, 20.0, 40.0, 0.0, 40.0, 40.0, 0.0, 10.0, 20.0, 30.0, 20.0, 50.0, 30.0, 80.0, 190.0, 300.0, 160.0, 30.0, 40.0, 30.0, 30.0, 60.0, 30.0, 40.0, 50.0, 20.0, 10.0, 40.0, 20.0, 10.0, 20.0, 0.0, 30.0, 0.0, 20.0, 0.0, 20.0, 10.0, 10.0, 40.0, 70.0, 50.0, 10.0, 50.0, 40.0, 10.0, 70.0, 20.0, 260.0, 30.0, 190.0, 20.0, 70.0, 30.0, 0.0, 50.0, 200.0, 190.0, 30.0, 30.0, 60.0, 40.0, 0.0, 50.0, 0.0, 0.0, 10.0, 40.0, 20.0, 50.0, 0.0, 20.0, 40.0, 60.0, 50.0, 0.0, 10.0, 40.0, 0.0, 40.0, 60.0, 90.0, 40.0, 70.0, 60.0, 110.0, 40.0, 260.0, 80.0, 60.0, 20.0, 10.0, -40.0, 10.0, 20.0, 0.0, 40.0, 40.0, 70.0, 180.0, 15.0, 80.0, 50.0, 420.0, -50.0, -30.0, 50.0, 170.0, 0.0, 300.0, 60.0, 0.0, 20.0, 20.0, 40.0, 40.0, 40.0, 20.0, 10.0, -30.0, 160.0, 40.0, 20.0, 0.0, 50.0, 10.0, 20.0, 180.0, 20.0, 20.0, 10.0, 10.0, 30.0, 20.0, 10.0, 150.0, 20.0, 10.0, 20.0, 0.0, 100.0, 30.0, 0.0, 0.0, 40.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 30.0, 20.0, 60.0, 0.0, 70.0, 160.0, 30.0, 30.0, 110.0, 70.0, 30.0, 320.0, -70.0, 40.0, 70.0, 280.0, 20.0, 50.0, 20.0, 30.0, 80.0, 70.0, 50.0, 60.0, 40.0, 40.0, 110.0, 0.0, 30.0, 0.0, 0.0, 10.0, 40.0, 10.0, 10.0, 0.0, 50.0, 10.0, 30.0, 200.0, 180.0, 190.0, 60.0, 30.0, 40.0, 80.0, 40.0, 30.0, 30.0, 70.0, 20.0, 20.0, 0.0, 60.0, 90.0, 10.0, 10.0, 250.0, 100.0, 90.0, 160.0, 20.0, 20.0, 100.0, 40.0, 20.0, 60.0, 40.0, 40.0, -30.0, 40.0, 0.0, 60.0, 40.0, 370.0, 40.0, 30.0, 40.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 260.0, 30.0, 0.0, 0.0, 70.0, 0.0, 20.0, 20.0, 40.0, 0.0, 60.0, 150.0, 20.0, 20.0, 20.0, 20.0, -5.0, 30.0, 160.0, 190.0, 20.0, 40.0, 90.0, 20.0, 60.0, 20.0, 10.0, 350.0, 20.0, -20.0, 20.0, 40.0, 10.0, 10.0, 0.0, 40.0, 30.0, 40.0, 50.0, 170.0, 10.0, 40.0, 10.0, 40.0, 20.0, 50.0, 250.0, 90.0, 10.0, 0.0, 60.0, 20.0, 70.0, 50.0, 40.0, 160.0, 0.0, 260.0, 40.0, 40.0, 20.0, 30.0, 160.0, 30.0, 10.0, 10.0, 0.0, 20.0, 20.0, 30.0, 50.0, 10.0, 10.0, 0.0, 50.0, 30.0, 10.0, 20.0, 10.0, 40.0, 20.0, 30.0, 60.0, 20.0, 30.0, 30.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 20.0, 50.0, 90.0, 10.0, 30.0, 0.0, 0.0, 20.0, 10.0, 30.0, 100.0, 10.0, 30.0, 10.0, 10.0, 30.0, 40.0, 30.0, 20.0, 40.0, 80.0, 10.0, 20.0, 20.0, 0.0, 50.0, 80.0, 170.0, 20.0, 130.0, 40.0, 100.0, 210.0, 80.0, 30.0, 170.0, 300.0, 110.0, 10.0, 80.0, 40.0, -10.0, 100.0, 30.0, 0.0, 40.0, 390.0, 20.0, 60.0, 30.0, 30.0, 150.0, 30.0, 30.0, -25.0, 30.0, 40.0, 170.0, 0.0, 40.0, 10.0, 0.0, -30.0, 360.0, 110.0, 160.0, 10.0, 20.0, 0.0, 40.0, 20.0, 40.0, 45.0, 160.0, 10.0, 60.0, 60.0, 20.0, 210.0, 30.0, 70.0, -100.0, 10.0, 90.0, 160.0, -30.0, 90.0, 40.0, 10.0, 60.0, 180.0, 60.0, 360.0, 20.0, 20.0, 40.0, 0.0, 40.0, 0.0, 30.0, 80.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 20.0, 0.0, 30.0, 20.0, 270.0, 40.0, 70.0, 10.0, 160.0, 40.0, 20.0, 20.0, 40.0, 40.0, 30.0, 40.0, 30.0, 30.0, 60.0, 10.0, 10.0, 20.0, 40.0, -60.0, 20.0, 40.0, 90.0, 90.0, 60.0, 50.0, 90.0, 50.0, 480.0, 20.0, 10.0, 10.0, 40.0, 0.0, 80.0, 30.0, 30.0, 250.0, 30.0, 70.0, 160.0, -30.0, -40.0, 90.0, 70.0, -30.0, 80.0, 550.0, 10.0, -40.0, 0.0, 30.0, 70.0, 170.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, 20.0, 30.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 50.0, 30.0, 0.0, 30.0, 30.0, 20.0, 30.0, 160.0, 30.0, 30.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 10.0, 10.0, 30.0, 0.0, 10.0, 20.0, 40.0, 0.0, 30.0, 50.0, 30.0, 10.0, 10.0, 10.0, 20.0, 10.0, 70.0, 40.0, 160.0, 30.0, 130.0, 300.0, 40.0, 20.0, 60.0, 60.0, 200.0, 70.0, 30.0, 50.0, 60.0, 350.0, 60.0, 50.0, 230.0, 40.0, 330.0, 100.0, 10.0, 160.0, 50.0, 60.0, 50.0, 30.0, 50.0, 10.0, 10.0, 40.0, 0.0, 20.0, 30.0, 80.0, 10.0, 30.0, 20.0, 70.0, 40.0, 65.0, 270.0, 200.0, 10.0, 180.0, 190.0, 0.0, 20.0, -50.0, 10.0, 40.0, 30.0, 20.0, 40.0, 90.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, -40.0, 290.0, 20.0, 0.0, 40.0, 50.0, 80.0, 60.0, 0.0, 40.0, 10.0, 30.0, 100.0, 20.0, 60.0, 70.0, 90.0, -10.0, 20.0, 180.0, 0.0, 10.0, 20.0, 0.0, 40.0, 80.0, 0.0, 170.0, 50.0, 30.0, 260.0, 90.0, 5.0, 30.0, 30.0, 150.0, 50.0, 390.0, 0.0, 50.0, 160.0, 40.0, 160.0, 0.0, 40.0, 80.0, 360.0, 50.0, 80.0, 80.0, 210.0, 0.0, 210.0, 270.0, 90.0, 20.0, 10.0, 30.0, 40.0, 30.0, -10.0, 60.0, 0.0, 180.0, 0.0, 60.0, 0.0, -30.0, 0.0, 20.0, 20.0, 10.0, 100.0, 10.0, 60.0, -50.0, 90.0, 380.0, 40.0, 10.0, 0.0, 40.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 110.0, 150.0, 60.0, 0.0, 0.0, 40.0, 20.0, 40.0, 20.0, 0.0, 20.0, -40.0, 40.0, 80.0, 260.0, 50.0, 40.0, 30.0, 30.0, 390.0, 0.0, 20.0, 160.0, 30.0, 60.0, 90.0, 100.0, 10.0, 180.0, 60.0, 50.0, 10.0, 90.0, 100.0, 150.0, 20.0, 0.0, 30.0, 40.0, 90.0, 10.0, 40.0, 280.0, -20.0, 240.0, 30.0, 640.0, 70.0, 0.0, 40.0, 40.0, 50.0, 30.0, 90.0, 20.0, 250.0, -30.0, 200.0, 170.0, 370.0, 20.0, 10.0, 50.0, 40.0, 10.0, 0.0, 10.0, 30.0, 10.0, 0.0, 180.0, 300.0, -20.0, 0.0, 60.0, -20.0, -55.0, 10.0, 60.0, 50.0, 80.0, 110.0, 660.0, 40.0, 0.0, 30.0, 20.0, -40.0, 100.0, 70.0, 170.0, 20.0, 0.0, 0.0, 60.0, 20.0, 30.0, 50.0, 70.0, 20.0, 70.0, 30.0, 10.0, 40.0, 0.0, 20.0, 20.0, 40.0, 60.0, 30.0, 450.0, 10.0, -30.0, -30.0, 100.0, 50.0, 10.0, -30.0, 0.0, 200.0, 170.0, 40.0, 30.0, 20.0, 50.0, 90.0, 0.0, 0.0, 10.0, 20.0, 170.0, 50.0, 60.0, 10.0, 0.0, 60.0, 30.0, 20.0, 40.0, 10.0, 10.0, 0.0, 20.0, 20.0, 30.0, 10.0, 130.0, 110.0, 20.0, 140.0, 0.0, 30.0, 20.0, 0.0, 170.0, 10.0, 20.0, 150.0, 10.0, 80.0, 170.0, 40.0, 20.0, 10.0, 30.0, 130.0, 0.0, 40.0, 50.0, 0.0, 0.0, 10.0, 0.0, 0.0, 80.0, 20.0, 0.0, 10.0, 10.0, 0.0, 80.0, 90.0, 10.0, 40.0, 20.0, 20.0, 10.0, 200.0, 40.0, 30.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 30.0, 30.0, 140.0, 160.0, 10.0, 90.0, 0.0, 10.0, 60.0, 20.0, 30.0, 80.0, 20.0, 70.0, 110.0, 40.0, 10.0, 30.0, 10.0, 0.0, 20.0, 40.0, 0.0, 20.0, 250.0, 200.0, -20.0, 110.0, 100.0, -50.0, 20.0, 20.0, 50.0, 90.0, 70.0, 20.0, 280.0, 10.0, -50.0, 10.0, 370.0, 20.0, -45.0, 50.0, 70.0, 30.0, 80.0, 160.0, 380.0, -240.0, -50.0, -55.0, 40.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.7009778966032882, "mean_inference_ms": 1.9030631976907357, "mean_action_processing_ms": 0.49765641946133876, "mean_env_wait_ms": 1.519313640358148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05910205841064453, "StateBufferConnector_ms": 0.009418964385986328, "ViewRequirementAgentConnector_ms": 0.4045102596282959}, "num_episodes": 18, "episode_return_max": 1330.0, "episode_return_min": 130.0, "episode_return_mean": 543.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.335192712400726, "num_env_steps_trained_throughput_per_sec": 36.335192712400726, "timesteps_total": 128000, "num_env_steps_sampled_lifetime": 128000, "num_agent_steps_sampled_lifetime": 1280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1280000, "timers": {"training_iteration_time_ms": 110511.073, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110511.026, "sample_time_ms": 2457.512, "learn_time_ms": 108032.812, "learn_throughput": 37.026, "synch_weights_time_ms": 12.05}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 1280000, "num_agent_steps_trained": 1280000}, "done": false, "training_iteration": 32, "trial_id": "57140_00000", "date": "2024-06-27_00-18-38", "timestamp": 1719461918, "time_this_iter_s": 110.10026812553406, "time_total_s": 3844.9026639461517, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3f6c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3844.9026639461517, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 15.424358974358974, "ram_util_percent": 78.60576923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8201472243942773, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.325508673858845, "policy_loss": -0.005574379696414525, "vf_loss": 4.330331763621971, "vf_explained_var": 2.42311352738938e-05, "kl": 0.007512856418656684, "entropy": 0.9141698821030232, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 305175.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "env_runners": {"episode_reward_max": 1330.0, "episode_reward_min": 60.0, "episode_reward_mean": 563.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -350.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 56.375}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 160.0, 880.0, 560.0, 650.0, 630.0, 340.0, 400.0, 585.0, 520.0, 430.0, 620.0, 780.0, 160.0, 290.0, 130.0, 340.0, 300.0, 540.0, 1130.0, 690.0, 475.0, 690.0, 705.0, 510.0, 650.0, 150.0, 710.0, 210.0, 990.0, 550.0, 820.0, 350.0, 170.0, 180.0, 310.0, 160.0, 210.0, 910.0, 1140.0, 850.0, 310.0, 925.0, 250.0, 510.0, 410.0, 520.0, 1085.0, 940.0, 1000.0, 330.0, 640.0, 160.0, 440.0, 900.0, 710.0, 580.0, 1330.0, 1190.0, 180.0, 565.0, 1070.0, 440.0, 320.0, 730.0, 430.0, 450.0, 490.0, 490.0, 490.0, 130.0, 540.0, 420.0, 390.0, 280.0, 770.0, 735.0, 505.0, 990.0, 865.0, 870.0, 770.0, 820.0, 280.0, 450.0, 290.0, 870.0, 790.0, 940.0, 60.0, 510.0, 380.0, 510.0, 1050.0, 750.0, 120.0, 450.0, 530.0, 310.0, 740.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 30.0, 80.0, 70.0, 50.0, 60.0, 40.0, 40.0, 110.0, 0.0, 30.0, 0.0, 0.0, 10.0, 40.0, 10.0, 10.0, 0.0, 50.0, 10.0, 30.0, 200.0, 180.0, 190.0, 60.0, 30.0, 40.0, 80.0, 40.0, 30.0, 30.0, 70.0, 20.0, 20.0, 0.0, 60.0, 90.0, 10.0, 10.0, 250.0, 100.0, 90.0, 160.0, 20.0, 20.0, 100.0, 40.0, 20.0, 60.0, 40.0, 40.0, -30.0, 40.0, 0.0, 60.0, 40.0, 370.0, 40.0, 30.0, 40.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 260.0, 30.0, 0.0, 0.0, 70.0, 0.0, 20.0, 20.0, 40.0, 0.0, 60.0, 150.0, 20.0, 20.0, 20.0, 20.0, -5.0, 30.0, 160.0, 190.0, 20.0, 40.0, 90.0, 20.0, 60.0, 20.0, 10.0, 350.0, 20.0, -20.0, 20.0, 40.0, 10.0, 10.0, 0.0, 40.0, 30.0, 40.0, 50.0, 170.0, 10.0, 40.0, 10.0, 40.0, 20.0, 50.0, 250.0, 90.0, 10.0, 0.0, 60.0, 20.0, 70.0, 50.0, 40.0, 160.0, 0.0, 260.0, 40.0, 40.0, 20.0, 30.0, 160.0, 30.0, 10.0, 10.0, 0.0, 20.0, 20.0, 30.0, 50.0, 10.0, 10.0, 0.0, 50.0, 30.0, 10.0, 20.0, 10.0, 40.0, 20.0, 30.0, 60.0, 20.0, 30.0, 30.0, 10.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 20.0, 50.0, 90.0, 10.0, 30.0, 0.0, 0.0, 20.0, 10.0, 30.0, 100.0, 10.0, 30.0, 10.0, 10.0, 30.0, 40.0, 30.0, 20.0, 40.0, 80.0, 10.0, 20.0, 20.0, 0.0, 50.0, 80.0, 170.0, 20.0, 130.0, 40.0, 100.0, 210.0, 80.0, 30.0, 170.0, 300.0, 110.0, 10.0, 80.0, 40.0, -10.0, 100.0, 30.0, 0.0, 40.0, 390.0, 20.0, 60.0, 30.0, 30.0, 150.0, 30.0, 30.0, -25.0, 30.0, 40.0, 170.0, 0.0, 40.0, 10.0, 0.0, -30.0, 360.0, 110.0, 160.0, 10.0, 20.0, 0.0, 40.0, 20.0, 40.0, 45.0, 160.0, 10.0, 60.0, 60.0, 20.0, 210.0, 30.0, 70.0, -100.0, 10.0, 90.0, 160.0, -30.0, 90.0, 40.0, 10.0, 60.0, 180.0, 60.0, 360.0, 20.0, 20.0, 40.0, 0.0, 40.0, 0.0, 30.0, 80.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 20.0, 0.0, 30.0, 20.0, 270.0, 40.0, 70.0, 10.0, 160.0, 40.0, 20.0, 20.0, 40.0, 40.0, 30.0, 40.0, 30.0, 30.0, 60.0, 10.0, 10.0, 20.0, 40.0, -60.0, 20.0, 40.0, 90.0, 90.0, 60.0, 50.0, 90.0, 50.0, 480.0, 20.0, 10.0, 10.0, 40.0, 0.0, 80.0, 30.0, 30.0, 250.0, 30.0, 70.0, 160.0, -30.0, -40.0, 90.0, 70.0, -30.0, 80.0, 550.0, 10.0, -40.0, 0.0, 30.0, 70.0, 170.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, 20.0, 30.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 50.0, 30.0, 0.0, 30.0, 30.0, 20.0, 30.0, 160.0, 30.0, 30.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 10.0, 10.0, 30.0, 0.0, 10.0, 20.0, 40.0, 0.0, 30.0, 50.0, 30.0, 10.0, 10.0, 10.0, 20.0, 10.0, 70.0, 40.0, 160.0, 30.0, 130.0, 300.0, 40.0, 20.0, 60.0, 60.0, 200.0, 70.0, 30.0, 50.0, 60.0, 350.0, 60.0, 50.0, 230.0, 40.0, 330.0, 100.0, 10.0, 160.0, 50.0, 60.0, 50.0, 30.0, 50.0, 10.0, 10.0, 40.0, 0.0, 20.0, 30.0, 80.0, 10.0, 30.0, 20.0, 70.0, 40.0, 65.0, 270.0, 200.0, 10.0, 180.0, 190.0, 0.0, 20.0, -50.0, 10.0, 40.0, 30.0, 20.0, 40.0, 90.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, -40.0, 290.0, 20.0, 0.0, 40.0, 50.0, 80.0, 60.0, 0.0, 40.0, 10.0, 30.0, 100.0, 20.0, 60.0, 70.0, 90.0, -10.0, 20.0, 180.0, 0.0, 10.0, 20.0, 0.0, 40.0, 80.0, 0.0, 170.0, 50.0, 30.0, 260.0, 90.0, 5.0, 30.0, 30.0, 150.0, 50.0, 390.0, 0.0, 50.0, 160.0, 40.0, 160.0, 0.0, 40.0, 80.0, 360.0, 50.0, 80.0, 80.0, 210.0, 0.0, 210.0, 270.0, 90.0, 20.0, 10.0, 30.0, 40.0, 30.0, -10.0, 60.0, 0.0, 180.0, 0.0, 60.0, 0.0, -30.0, 0.0, 20.0, 20.0, 10.0, 100.0, 10.0, 60.0, -50.0, 90.0, 380.0, 40.0, 10.0, 0.0, 40.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 110.0, 150.0, 60.0, 0.0, 0.0, 40.0, 20.0, 40.0, 20.0, 0.0, 20.0, -40.0, 40.0, 80.0, 260.0, 50.0, 40.0, 30.0, 30.0, 390.0, 0.0, 20.0, 160.0, 30.0, 60.0, 90.0, 100.0, 10.0, 180.0, 60.0, 50.0, 10.0, 90.0, 100.0, 150.0, 20.0, 0.0, 30.0, 40.0, 90.0, 10.0, 40.0, 280.0, -20.0, 240.0, 30.0, 640.0, 70.0, 0.0, 40.0, 40.0, 50.0, 30.0, 90.0, 20.0, 250.0, -30.0, 200.0, 170.0, 370.0, 20.0, 10.0, 50.0, 40.0, 10.0, 0.0, 10.0, 30.0, 10.0, 0.0, 180.0, 300.0, -20.0, 0.0, 60.0, -20.0, -55.0, 10.0, 60.0, 50.0, 80.0, 110.0, 660.0, 40.0, 0.0, 30.0, 20.0, -40.0, 100.0, 70.0, 170.0, 20.0, 0.0, 0.0, 60.0, 20.0, 30.0, 50.0, 70.0, 20.0, 70.0, 30.0, 10.0, 40.0, 0.0, 20.0, 20.0, 40.0, 60.0, 30.0, 450.0, 10.0, -30.0, -30.0, 100.0, 50.0, 10.0, -30.0, 0.0, 200.0, 170.0, 40.0, 30.0, 20.0, 50.0, 90.0, 0.0, 0.0, 10.0, 20.0, 170.0, 50.0, 60.0, 10.0, 0.0, 60.0, 30.0, 20.0, 40.0, 10.0, 10.0, 0.0, 20.0, 20.0, 30.0, 10.0, 130.0, 110.0, 20.0, 140.0, 0.0, 30.0, 20.0, 0.0, 170.0, 10.0, 20.0, 150.0, 10.0, 80.0, 170.0, 40.0, 20.0, 10.0, 30.0, 130.0, 0.0, 40.0, 50.0, 0.0, 0.0, 10.0, 0.0, 0.0, 80.0, 20.0, 0.0, 10.0, 10.0, 0.0, 80.0, 90.0, 10.0, 40.0, 20.0, 20.0, 10.0, 200.0, 40.0, 30.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 30.0, 30.0, 140.0, 160.0, 10.0, 90.0, 0.0, 10.0, 60.0, 20.0, 30.0, 80.0, 20.0, 70.0, 110.0, 40.0, 10.0, 30.0, 10.0, 0.0, 20.0, 40.0, 0.0, 20.0, 250.0, 200.0, -20.0, 110.0, 100.0, -50.0, 20.0, 20.0, 50.0, 90.0, 70.0, 20.0, 280.0, 10.0, -50.0, 10.0, 370.0, 20.0, -45.0, 50.0, 70.0, 30.0, 80.0, 160.0, 380.0, -240.0, -50.0, -55.0, 40.0, 90.0, 10.0, 50.0, 290.0, 180.0, 150.0, 60.0, 90.0, 60.0, 10.0, 90.0, 30.0, 90.0, 15.0, 40.0, 40.0, 170.0, 0.0, 210.0, 70.0, 200.0, 60.0, 10.0, 40.0, 30.0, 10.0, 150.0, 280.0, 70.0, 60.0, 160.0, 480.0, -40.0, 170.0, 10.0, 70.0, 10.0, 30.0, 40.0, -20.0, 20.0, 60.0, 10.0, 30.0, 290.0, 20.0, 90.0, 10.0, 150.0, 70.0, 90.0, 70.0, 0.0, 0.0, 50.0, 30.0, 20.0, 30.0, 30.0, 30.0, 20.0, 70.0, 10.0, 20.0, 0.0, 120.0, 10.0, 20.0, 10.0, 180.0, 10.0, 140.0, 0.0, 30.0, 10.0, 0.0, 10.0, 40.0, 10.0, 20.0, 30.0, 360.0, 20.0, -20.0, 20.0, 20.0, 40.0, 50.0, 70.0, 50.0, 260.0, 40.0, -50.0, 20.0, 40.0, -40.0, 90.0, 60.0, 470.0, 160.0, 0.0, 290.0, 40.0, 40.0, 280.0, 30.0, 20.0, 50.0, 0.0, 150.0, 40.0, 10.0, 50.0, 10.0, 170.0, 40.0, 10.0, 30.0, -350.0, 30.0, 60.0, 30.0, 80.0, 40.0, 40.0, 70.0, 20.0, 30.0, 30.0, 20.0, 150.0, 30.0, 0.0, 20.0, 80.0, 20.0, 70.0, 40.0, 70.0, 50.0, 0.0, 30.0, 20.0, 110.0, 30.0, 40.0, 30.0, 0.0, 50.0, 140.0, 60.0, 310.0, 80.0, 40.0, 80.0, 30.0, 60.0, 370.0, 30.0, 10.0, 40.0, 230.0, 10.0, 90.0, 180.0, 20.0, 90.0, 10.0, 80.0, 30.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 30.0, 30.0, 20.0, 20.0, 10.0, 0.0, 60.0, 20.0, 10.0, 30.0, 250.0, 130.0, 160.0, 110.0, 20.0, 10.0, 60.0, 20.0, 0.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, 40.0, 40.0, 30.0, 10.0, 30.0, 80.0, 0.0, 80.0, 50.0, 50.0, 50.0, -10.0, -30.0, 170.0, 10.0, 370.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.692566817927071, "mean_inference_ms": 1.8982235404152692, "mean_action_processing_ms": 0.49599518176571683, "mean_env_wait_ms": 1.512257473523183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05933785438537598, "StateBufferConnector_ms": 0.009477853775024414, "ViewRequirementAgentConnector_ms": 0.3743596076965332}, "num_episodes": 22, "episode_return_max": 1330.0, "episode_return_min": 60.0, "episode_return_mean": 563.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 35.9724393725971, "num_env_steps_trained_throughput_per_sec": 35.9724393725971, "timesteps_total": 132000, "num_env_steps_sampled_lifetime": 132000, "num_agent_steps_sampled_lifetime": 1320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1320000, "timers": {"training_iteration_time_ms": 110610.742, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110610.695, "sample_time_ms": 2449.918, "learn_time_ms": 108140.296, "learn_throughput": 36.989, "synch_weights_time_ms": 12.101}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 1320000, "num_agent_steps_trained": 1320000}, "done": false, "training_iteration": 33, "trial_id": "57140_00000", "date": "2024-06-27_00-20-29", "timestamp": 1719462029, "time_this_iter_s": 111.20992183685303, "time_total_s": 3956.1125857830048, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af43a8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 3956.1125857830048, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 15.94076433121019, "ram_util_percent": 78.61464968152866}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.814060250946635, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.986102733698389, "policy_loss": -0.005635985915429585, "vf_loss": 3.9909341520140855, "vf_explained_var": 0.0008266522163273301, "kl": 0.008045647627133237, "entropy": 0.8594174041915625, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 314565.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "env_runners": {"episode_reward_max": 1330.0, "episode_reward_min": 60.0, "episode_reward_mean": 539.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -350.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 53.945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [705.0, 510.0, 650.0, 150.0, 710.0, 210.0, 990.0, 550.0, 820.0, 350.0, 170.0, 180.0, 310.0, 160.0, 210.0, 910.0, 1140.0, 850.0, 310.0, 925.0, 250.0, 510.0, 410.0, 520.0, 1085.0, 940.0, 1000.0, 330.0, 640.0, 160.0, 440.0, 900.0, 710.0, 580.0, 1330.0, 1190.0, 180.0, 565.0, 1070.0, 440.0, 320.0, 730.0, 430.0, 450.0, 490.0, 490.0, 490.0, 130.0, 540.0, 420.0, 390.0, 280.0, 770.0, 735.0, 505.0, 990.0, 865.0, 870.0, 770.0, 820.0, 280.0, 450.0, 290.0, 870.0, 790.0, 940.0, 60.0, 510.0, 380.0, 510.0, 1050.0, 750.0, 120.0, 450.0, 530.0, 310.0, 740.0, 900.0, 160.0, 120.0, 320.0, 700.0, 300.0, 920.0, 340.0, 250.0, 530.0, 250.0, 210.0, 270.0, 305.0, 400.0, 215.0, 840.0, 430.0, 380.0, 860.0, 280.0, 180.0, 210.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 45.0, 160.0, 10.0, 60.0, 60.0, 20.0, 210.0, 30.0, 70.0, -100.0, 10.0, 90.0, 160.0, -30.0, 90.0, 40.0, 10.0, 60.0, 180.0, 60.0, 360.0, 20.0, 20.0, 40.0, 0.0, 40.0, 0.0, 30.0, 80.0, 20.0, 20.0, 10.0, 0.0, 20.0, 10.0, 20.0, 0.0, 30.0, 20.0, 270.0, 40.0, 70.0, 10.0, 160.0, 40.0, 20.0, 20.0, 40.0, 40.0, 30.0, 40.0, 30.0, 30.0, 60.0, 10.0, 10.0, 20.0, 40.0, -60.0, 20.0, 40.0, 90.0, 90.0, 60.0, 50.0, 90.0, 50.0, 480.0, 20.0, 10.0, 10.0, 40.0, 0.0, 80.0, 30.0, 30.0, 250.0, 30.0, 70.0, 160.0, -30.0, -40.0, 90.0, 70.0, -30.0, 80.0, 550.0, 10.0, -40.0, 0.0, 30.0, 70.0, 170.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, 20.0, 30.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 40.0, 50.0, 30.0, 0.0, 30.0, 30.0, 20.0, 30.0, 160.0, 30.0, 30.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 10.0, 10.0, 30.0, 0.0, 10.0, 20.0, 40.0, 0.0, 30.0, 50.0, 30.0, 10.0, 10.0, 10.0, 20.0, 10.0, 70.0, 40.0, 160.0, 30.0, 130.0, 300.0, 40.0, 20.0, 60.0, 60.0, 200.0, 70.0, 30.0, 50.0, 60.0, 350.0, 60.0, 50.0, 230.0, 40.0, 330.0, 100.0, 10.0, 160.0, 50.0, 60.0, 50.0, 30.0, 50.0, 10.0, 10.0, 40.0, 0.0, 20.0, 30.0, 80.0, 10.0, 30.0, 20.0, 70.0, 40.0, 65.0, 270.0, 200.0, 10.0, 180.0, 190.0, 0.0, 20.0, -50.0, 10.0, 40.0, 30.0, 20.0, 40.0, 90.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, -40.0, 290.0, 20.0, 0.0, 40.0, 50.0, 80.0, 60.0, 0.0, 40.0, 10.0, 30.0, 100.0, 20.0, 60.0, 70.0, 90.0, -10.0, 20.0, 180.0, 0.0, 10.0, 20.0, 0.0, 40.0, 80.0, 0.0, 170.0, 50.0, 30.0, 260.0, 90.0, 5.0, 30.0, 30.0, 150.0, 50.0, 390.0, 0.0, 50.0, 160.0, 40.0, 160.0, 0.0, 40.0, 80.0, 360.0, 50.0, 80.0, 80.0, 210.0, 0.0, 210.0, 270.0, 90.0, 20.0, 10.0, 30.0, 40.0, 30.0, -10.0, 60.0, 0.0, 180.0, 0.0, 60.0, 0.0, -30.0, 0.0, 20.0, 20.0, 10.0, 100.0, 10.0, 60.0, -50.0, 90.0, 380.0, 40.0, 10.0, 0.0, 40.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 110.0, 150.0, 60.0, 0.0, 0.0, 40.0, 20.0, 40.0, 20.0, 0.0, 20.0, -40.0, 40.0, 80.0, 260.0, 50.0, 40.0, 30.0, 30.0, 390.0, 0.0, 20.0, 160.0, 30.0, 60.0, 90.0, 100.0, 10.0, 180.0, 60.0, 50.0, 10.0, 90.0, 100.0, 150.0, 20.0, 0.0, 30.0, 40.0, 90.0, 10.0, 40.0, 280.0, -20.0, 240.0, 30.0, 640.0, 70.0, 0.0, 40.0, 40.0, 50.0, 30.0, 90.0, 20.0, 250.0, -30.0, 200.0, 170.0, 370.0, 20.0, 10.0, 50.0, 40.0, 10.0, 0.0, 10.0, 30.0, 10.0, 0.0, 180.0, 300.0, -20.0, 0.0, 60.0, -20.0, -55.0, 10.0, 60.0, 50.0, 80.0, 110.0, 660.0, 40.0, 0.0, 30.0, 20.0, -40.0, 100.0, 70.0, 170.0, 20.0, 0.0, 0.0, 60.0, 20.0, 30.0, 50.0, 70.0, 20.0, 70.0, 30.0, 10.0, 40.0, 0.0, 20.0, 20.0, 40.0, 60.0, 30.0, 450.0, 10.0, -30.0, -30.0, 100.0, 50.0, 10.0, -30.0, 0.0, 200.0, 170.0, 40.0, 30.0, 20.0, 50.0, 90.0, 0.0, 0.0, 10.0, 20.0, 170.0, 50.0, 60.0, 10.0, 0.0, 60.0, 30.0, 20.0, 40.0, 10.0, 10.0, 0.0, 20.0, 20.0, 30.0, 10.0, 130.0, 110.0, 20.0, 140.0, 0.0, 30.0, 20.0, 0.0, 170.0, 10.0, 20.0, 150.0, 10.0, 80.0, 170.0, 40.0, 20.0, 10.0, 30.0, 130.0, 0.0, 40.0, 50.0, 0.0, 0.0, 10.0, 0.0, 0.0, 80.0, 20.0, 0.0, 10.0, 10.0, 0.0, 80.0, 90.0, 10.0, 40.0, 20.0, 20.0, 10.0, 200.0, 40.0, 30.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 30.0, 30.0, 140.0, 160.0, 10.0, 90.0, 0.0, 10.0, 60.0, 20.0, 30.0, 80.0, 20.0, 70.0, 110.0, 40.0, 10.0, 30.0, 10.0, 0.0, 20.0, 40.0, 0.0, 20.0, 250.0, 200.0, -20.0, 110.0, 100.0, -50.0, 20.0, 20.0, 50.0, 90.0, 70.0, 20.0, 280.0, 10.0, -50.0, 10.0, 370.0, 20.0, -45.0, 50.0, 70.0, 30.0, 80.0, 160.0, 380.0, -240.0, -50.0, -55.0, 40.0, 90.0, 10.0, 50.0, 290.0, 180.0, 150.0, 60.0, 90.0, 60.0, 10.0, 90.0, 30.0, 90.0, 15.0, 40.0, 40.0, 170.0, 0.0, 210.0, 70.0, 200.0, 60.0, 10.0, 40.0, 30.0, 10.0, 150.0, 280.0, 70.0, 60.0, 160.0, 480.0, -40.0, 170.0, 10.0, 70.0, 10.0, 30.0, 40.0, -20.0, 20.0, 60.0, 10.0, 30.0, 290.0, 20.0, 90.0, 10.0, 150.0, 70.0, 90.0, 70.0, 0.0, 0.0, 50.0, 30.0, 20.0, 30.0, 30.0, 30.0, 20.0, 70.0, 10.0, 20.0, 0.0, 120.0, 10.0, 20.0, 10.0, 180.0, 10.0, 140.0, 0.0, 30.0, 10.0, 0.0, 10.0, 40.0, 10.0, 20.0, 30.0, 360.0, 20.0, -20.0, 20.0, 20.0, 40.0, 50.0, 70.0, 50.0, 260.0, 40.0, -50.0, 20.0, 40.0, -40.0, 90.0, 60.0, 470.0, 160.0, 0.0, 290.0, 40.0, 40.0, 280.0, 30.0, 20.0, 50.0, 0.0, 150.0, 40.0, 10.0, 50.0, 10.0, 170.0, 40.0, 10.0, 30.0, -350.0, 30.0, 60.0, 30.0, 80.0, 40.0, 40.0, 70.0, 20.0, 30.0, 30.0, 20.0, 150.0, 30.0, 0.0, 20.0, 80.0, 20.0, 70.0, 40.0, 70.0, 50.0, 0.0, 30.0, 20.0, 110.0, 30.0, 40.0, 30.0, 0.0, 50.0, 140.0, 60.0, 310.0, 80.0, 40.0, 80.0, 30.0, 60.0, 370.0, 30.0, 10.0, 40.0, 230.0, 10.0, 90.0, 180.0, 20.0, 90.0, 10.0, 80.0, 30.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 30.0, 30.0, 20.0, 20.0, 10.0, 0.0, 60.0, 20.0, 10.0, 30.0, 250.0, 130.0, 160.0, 110.0, 20.0, 10.0, 60.0, 20.0, 0.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, 40.0, 40.0, 30.0, 10.0, 30.0, 80.0, 0.0, 80.0, 50.0, 50.0, 50.0, -10.0, -30.0, 170.0, 10.0, 370.0, -10.0, 10.0, 40.0, 30.0, 40.0, 30.0, 360.0, 150.0, 270.0, -20.0, 30.0, 20.0, 0.0, 20.0, 40.0, 10.0, 0.0, 0.0, 0.0, 40.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 30.0, 40.0, 0.0, 20.0, 30.0, -30.0, 100.0, 10.0, 40.0, 80.0, 20.0, 0.0, 50.0, 20.0, 80.0, 120.0, 250.0, 40.0, 10.0, 70.0, 40.0, 10.0, 0.0, 80.0, 0.0, 50.0, 0.0, 110.0, 20.0, 10.0, 40.0, 40.0, 20.0, 10.0, 10.0, 40.0, 40.0, 60.0, 150.0, -20.0, 150.0, 430.0, 20.0, 40.0, 20.0, 0.0, 40.0, 70.0, 80.0, 10.0, 0.0, 60.0, 30.0, 30.0, 50.0, 20.0, 40.0, 30.0, 30.0, 50.0, 10.0, 0.0, 0.0, 20.0, 30.0, 160.0, 40.0, 50.0, 20.0, 10.0, 160.0, 40.0, 10.0, 10.0, 20.0, 10.0, 30.0, 30.0, 10.0, 40.0, 20.0, 60.0, 30.0, 0.0, 30.0, 30.0, 30.0, 10.0, 40.0, 10.0, 40.0, 10.0, 0.0, 10.0, 20.0, 30.0, 30.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 100.0, 30.0, 25.0, 60.0, 100.0, 10.0, 0.0, 0.0, 60.0, 0.0, 20.0, 50.0, 60.0, 0.0, 90.0, 80.0, 0.0, 0.0, 60.0, 20.0, 40.0, 10.0, 90.0, 30.0, 10.0, 0.0, 20.0, 40.0, 10.0, 5.0, 0.0, 30.0, 10.0, 10.0, 20.0, 120.0, 560.0, 10.0, 0.0, 30.0, 50.0, 0.0, 70.0, 10.0, 40.0, 20.0, 10.0, 70.0, 0.0, 50.0, 160.0, 0.0, 40.0, 10.0, 0.0, 20.0, 170.0, 40.0, 50.0, 10.0, 40.0, 0.0, 50.0, 20.0, 50.0, 60.0, 0.0, 30.0, 550.0, 70.0, 30.0, 20.0, 10.0, 30.0, 60.0, 30.0, 10.0, 30.0, 10.0, 40.0, 40.0, 0.0, 30.0, 0.0, 20.0, 10.0, 20.0, 10.0, 0.0, 50.0, 40.0, 20.0, 10.0, 10.0, 20.0, 0.0, 10.0, 80.0, 10.0, 10.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.674944316374156, "mean_inference_ms": 1.87634944679297, "mean_action_processing_ms": 0.4901160416094807, "mean_env_wait_ms": 1.4991765406959825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05811619758605957, "StateBufferConnector_ms": 0.009180307388305664, "ViewRequirementAgentConnector_ms": 0.3601961135864258}, "num_episodes": 23, "episode_return_max": 1330.0, "episode_return_min": 60.0, "episode_return_mean": 539.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.44356540007513, "num_env_steps_trained_throughput_per_sec": 36.44356540007513, "timesteps_total": 136000, "num_env_steps_sampled_lifetime": 136000, "num_agent_steps_sampled_lifetime": 1360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1360000, "timers": {"training_iteration_time_ms": 110457.176, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110457.129, "sample_time_ms": 2409.627, "learn_time_ms": 108027.089, "learn_throughput": 37.028, "synch_weights_time_ms": 11.994}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 1360000, "num_agent_steps_trained": 1360000}, "done": false, "training_iteration": 34, "trial_id": "57140_00000", "date": "2024-06-27_00-22-19", "timestamp": 1719462139, "time_this_iter_s": 109.77018022537231, "time_total_s": 4065.882766008377, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3f6f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4065.882766008377, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 15.380645161290323, "ram_util_percent": 79.37096774193549}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8029817591650417, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.548397661855046, "policy_loss": -0.005433582295368587, "vf_loss": 5.55307322652957, "vf_explained_var": 0.0006090386289631089, "kl": 0.007580307283984854, "entropy": 0.8422805142923158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 323955.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "env_runners": {"episode_reward_max": 1330.0, "episode_reward_min": 60.0, "episode_reward_mean": 558.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -350.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 55.85}, "custom_metrics": {}, "hist_stats": {"episode_reward": [310.0, 925.0, 250.0, 510.0, 410.0, 520.0, 1085.0, 940.0, 1000.0, 330.0, 640.0, 160.0, 440.0, 900.0, 710.0, 580.0, 1330.0, 1190.0, 180.0, 565.0, 1070.0, 440.0, 320.0, 730.0, 430.0, 450.0, 490.0, 490.0, 490.0, 130.0, 540.0, 420.0, 390.0, 280.0, 770.0, 735.0, 505.0, 990.0, 865.0, 870.0, 770.0, 820.0, 280.0, 450.0, 290.0, 870.0, 790.0, 940.0, 60.0, 510.0, 380.0, 510.0, 1050.0, 750.0, 120.0, 450.0, 530.0, 310.0, 740.0, 900.0, 160.0, 120.0, 320.0, 700.0, 300.0, 920.0, 340.0, 250.0, 530.0, 250.0, 210.0, 270.0, 305.0, 400.0, 215.0, 840.0, 430.0, 380.0, 860.0, 280.0, 180.0, 210.0, 260.0, 690.0, 380.0, 280.0, 710.0, 780.0, 610.0, 730.0, 1000.0, 400.0, 1160.0, 320.0, 430.0, 840.0, 790.0, 810.0, 330.0, 960.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 40.0, 0.0, 20.0, 30.0, 80.0, 10.0, 30.0, 20.0, 70.0, 40.0, 65.0, 270.0, 200.0, 10.0, 180.0, 190.0, 0.0, 20.0, -50.0, 10.0, 40.0, 30.0, 20.0, 40.0, 90.0, 0.0, 0.0, 0.0, 20.0, 0.0, 10.0, -40.0, 290.0, 20.0, 0.0, 40.0, 50.0, 80.0, 60.0, 0.0, 40.0, 10.0, 30.0, 100.0, 20.0, 60.0, 70.0, 90.0, -10.0, 20.0, 180.0, 0.0, 10.0, 20.0, 0.0, 40.0, 80.0, 0.0, 170.0, 50.0, 30.0, 260.0, 90.0, 5.0, 30.0, 30.0, 150.0, 50.0, 390.0, 0.0, 50.0, 160.0, 40.0, 160.0, 0.0, 40.0, 80.0, 360.0, 50.0, 80.0, 80.0, 210.0, 0.0, 210.0, 270.0, 90.0, 20.0, 10.0, 30.0, 40.0, 30.0, -10.0, 60.0, 0.0, 180.0, 0.0, 60.0, 0.0, -30.0, 0.0, 20.0, 20.0, 10.0, 100.0, 10.0, 60.0, -50.0, 90.0, 380.0, 40.0, 10.0, 0.0, 40.0, 10.0, 10.0, 0.0, 10.0, 20.0, 20.0, 110.0, 150.0, 60.0, 0.0, 0.0, 40.0, 20.0, 40.0, 20.0, 0.0, 20.0, -40.0, 40.0, 80.0, 260.0, 50.0, 40.0, 30.0, 30.0, 390.0, 0.0, 20.0, 160.0, 30.0, 60.0, 90.0, 100.0, 10.0, 180.0, 60.0, 50.0, 10.0, 90.0, 100.0, 150.0, 20.0, 0.0, 30.0, 40.0, 90.0, 10.0, 40.0, 280.0, -20.0, 240.0, 30.0, 640.0, 70.0, 0.0, 40.0, 40.0, 50.0, 30.0, 90.0, 20.0, 250.0, -30.0, 200.0, 170.0, 370.0, 20.0, 10.0, 50.0, 40.0, 10.0, 0.0, 10.0, 30.0, 10.0, 0.0, 180.0, 300.0, -20.0, 0.0, 60.0, -20.0, -55.0, 10.0, 60.0, 50.0, 80.0, 110.0, 660.0, 40.0, 0.0, 30.0, 20.0, -40.0, 100.0, 70.0, 170.0, 20.0, 0.0, 0.0, 60.0, 20.0, 30.0, 50.0, 70.0, 20.0, 70.0, 30.0, 10.0, 40.0, 0.0, 20.0, 20.0, 40.0, 60.0, 30.0, 450.0, 10.0, -30.0, -30.0, 100.0, 50.0, 10.0, -30.0, 0.0, 200.0, 170.0, 40.0, 30.0, 20.0, 50.0, 90.0, 0.0, 0.0, 10.0, 20.0, 170.0, 50.0, 60.0, 10.0, 0.0, 60.0, 30.0, 20.0, 40.0, 10.0, 10.0, 0.0, 20.0, 20.0, 30.0, 10.0, 130.0, 110.0, 20.0, 140.0, 0.0, 30.0, 20.0, 0.0, 170.0, 10.0, 20.0, 150.0, 10.0, 80.0, 170.0, 40.0, 20.0, 10.0, 30.0, 130.0, 0.0, 40.0, 50.0, 0.0, 0.0, 10.0, 0.0, 0.0, 80.0, 20.0, 0.0, 10.0, 10.0, 0.0, 80.0, 90.0, 10.0, 40.0, 20.0, 20.0, 10.0, 200.0, 40.0, 30.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 30.0, 30.0, 140.0, 160.0, 10.0, 90.0, 0.0, 10.0, 60.0, 20.0, 30.0, 80.0, 20.0, 70.0, 110.0, 40.0, 10.0, 30.0, 10.0, 0.0, 20.0, 40.0, 0.0, 20.0, 250.0, 200.0, -20.0, 110.0, 100.0, -50.0, 20.0, 20.0, 50.0, 90.0, 70.0, 20.0, 280.0, 10.0, -50.0, 10.0, 370.0, 20.0, -45.0, 50.0, 70.0, 30.0, 80.0, 160.0, 380.0, -240.0, -50.0, -55.0, 40.0, 90.0, 10.0, 50.0, 290.0, 180.0, 150.0, 60.0, 90.0, 60.0, 10.0, 90.0, 30.0, 90.0, 15.0, 40.0, 40.0, 170.0, 0.0, 210.0, 70.0, 200.0, 60.0, 10.0, 40.0, 30.0, 10.0, 150.0, 280.0, 70.0, 60.0, 160.0, 480.0, -40.0, 170.0, 10.0, 70.0, 10.0, 30.0, 40.0, -20.0, 20.0, 60.0, 10.0, 30.0, 290.0, 20.0, 90.0, 10.0, 150.0, 70.0, 90.0, 70.0, 0.0, 0.0, 50.0, 30.0, 20.0, 30.0, 30.0, 30.0, 20.0, 70.0, 10.0, 20.0, 0.0, 120.0, 10.0, 20.0, 10.0, 180.0, 10.0, 140.0, 0.0, 30.0, 10.0, 0.0, 10.0, 40.0, 10.0, 20.0, 30.0, 360.0, 20.0, -20.0, 20.0, 20.0, 40.0, 50.0, 70.0, 50.0, 260.0, 40.0, -50.0, 20.0, 40.0, -40.0, 90.0, 60.0, 470.0, 160.0, 0.0, 290.0, 40.0, 40.0, 280.0, 30.0, 20.0, 50.0, 0.0, 150.0, 40.0, 10.0, 50.0, 10.0, 170.0, 40.0, 10.0, 30.0, -350.0, 30.0, 60.0, 30.0, 80.0, 40.0, 40.0, 70.0, 20.0, 30.0, 30.0, 20.0, 150.0, 30.0, 0.0, 20.0, 80.0, 20.0, 70.0, 40.0, 70.0, 50.0, 0.0, 30.0, 20.0, 110.0, 30.0, 40.0, 30.0, 0.0, 50.0, 140.0, 60.0, 310.0, 80.0, 40.0, 80.0, 30.0, 60.0, 370.0, 30.0, 10.0, 40.0, 230.0, 10.0, 90.0, 180.0, 20.0, 90.0, 10.0, 80.0, 30.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 30.0, 30.0, 20.0, 20.0, 10.0, 0.0, 60.0, 20.0, 10.0, 30.0, 250.0, 130.0, 160.0, 110.0, 20.0, 10.0, 60.0, 20.0, 0.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, 40.0, 40.0, 30.0, 10.0, 30.0, 80.0, 0.0, 80.0, 50.0, 50.0, 50.0, -10.0, -30.0, 170.0, 10.0, 370.0, -10.0, 10.0, 40.0, 30.0, 40.0, 30.0, 360.0, 150.0, 270.0, -20.0, 30.0, 20.0, 0.0, 20.0, 40.0, 10.0, 0.0, 0.0, 0.0, 40.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 30.0, 40.0, 0.0, 20.0, 30.0, -30.0, 100.0, 10.0, 40.0, 80.0, 20.0, 0.0, 50.0, 20.0, 80.0, 120.0, 250.0, 40.0, 10.0, 70.0, 40.0, 10.0, 0.0, 80.0, 0.0, 50.0, 0.0, 110.0, 20.0, 10.0, 40.0, 40.0, 20.0, 10.0, 10.0, 40.0, 40.0, 60.0, 150.0, -20.0, 150.0, 430.0, 20.0, 40.0, 20.0, 0.0, 40.0, 70.0, 80.0, 10.0, 0.0, 60.0, 30.0, 30.0, 50.0, 20.0, 40.0, 30.0, 30.0, 50.0, 10.0, 0.0, 0.0, 20.0, 30.0, 160.0, 40.0, 50.0, 20.0, 10.0, 160.0, 40.0, 10.0, 10.0, 20.0, 10.0, 30.0, 30.0, 10.0, 40.0, 20.0, 60.0, 30.0, 0.0, 30.0, 30.0, 30.0, 10.0, 40.0, 10.0, 40.0, 10.0, 0.0, 10.0, 20.0, 30.0, 30.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 100.0, 30.0, 25.0, 60.0, 100.0, 10.0, 0.0, 0.0, 60.0, 0.0, 20.0, 50.0, 60.0, 0.0, 90.0, 80.0, 0.0, 0.0, 60.0, 20.0, 40.0, 10.0, 90.0, 30.0, 10.0, 0.0, 20.0, 40.0, 10.0, 5.0, 0.0, 30.0, 10.0, 10.0, 20.0, 120.0, 560.0, 10.0, 0.0, 30.0, 50.0, 0.0, 70.0, 10.0, 40.0, 20.0, 10.0, 70.0, 0.0, 50.0, 160.0, 0.0, 40.0, 10.0, 0.0, 20.0, 170.0, 40.0, 50.0, 10.0, 40.0, 0.0, 50.0, 20.0, 50.0, 60.0, 0.0, 30.0, 550.0, 70.0, 30.0, 20.0, 10.0, 30.0, 60.0, 30.0, 10.0, 30.0, 10.0, 40.0, 40.0, 0.0, 30.0, 0.0, 20.0, 10.0, 20.0, 10.0, 0.0, 50.0, 40.0, 20.0, 10.0, 10.0, 20.0, 0.0, 10.0, 80.0, 10.0, 10.0, 40.0, 40.0, 0.0, 10.0, 10.0, 50.0, 40.0, 30.0, 50.0, 20.0, 10.0, 80.0, 40.0, 40.0, 160.0, 10.0, 170.0, 10.0, 80.0, 30.0, 70.0, 30.0, 40.0, 0.0, 30.0, 30.0, 160.0, 40.0, 30.0, 20.0, 0.0, 30.0, 20.0, 80.0, 0.0, 60.0, 10.0, 0.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 480.0, 20.0, 10.0, 60.0, 60.0, 10.0, 20.0, 20.0, 260.0, 50.0, -30.0, 280.0, 60.0, 20.0, 20.0, 40.0, 60.0, 160.0, 20.0, 0.0, 180.0, 10.0, 10.0, 50.0, 200.0, 20.0, -40.0, 20.0, 360.0, 40.0, 10.0, 60.0, 80.0, 50.0, 20.0, 40.0, 50.0, 50.0, -60.0, 110.0, 80.0, 280.0, 70.0, 80.0, 50.0, 160.0, 180.0, 30.0, 10.0, 10.0, 100.0, 60.0, 40.0, 60.0, 40.0, 20.0, 30.0, 110.0, 560.0, 70.0, 110.0, -20.0, 30.0, 110.0, 70.0, 0.0, 120.0, 40.0, 40.0, 50.0, 30.0, 20.0, -80.0, 30.0, 0.0, 40.0, 150.0, 40.0, 70.0, 30.0, 0.0, 60.0, 130.0, 20.0, 20.0, 20.0, 40.0, 20.0, 110.0, 20.0, 0.0, 380.0, 130.0, 50.0, 50.0, 20.0, 60.0, 30.0, 180.0, 10.0, 160.0, 10.0, 30.0, 10.0, 20.0, 260.0, 80.0, 80.0, 160.0, 40.0, 40.0, 0.0, 20.0, 10.0, 450.0, 10.0, 0.0, 50.0, 20.0, 10.0, 170.0, 10.0, 20.0, 10.0, -40.0, 20.0, 60.0, 20.0, 0.0, 120.0, 40.0, 50.0, 10.0, 10.0, 120.0, 80.0, 510.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6648641709709113, "mean_inference_ms": 1.8667470117751686, "mean_action_processing_ms": 0.4873219903627327, "mean_env_wait_ms": 1.4917989122526552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.054674386978149414, "StateBufferConnector_ms": 0.009194135665893555, "ViewRequirementAgentConnector_ms": 0.35291266441345215}, "num_episodes": 18, "episode_return_max": 1330.0, "episode_return_min": 60.0, "episode_return_mean": 558.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.24727238573997, "num_env_steps_trained_throughput_per_sec": 36.24727238573997, "timesteps_total": 140000, "num_env_steps_sampled_lifetime": 140000, "num_agent_steps_sampled_lifetime": 1400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1400000, "timers": {"training_iteration_time_ms": 110396.3, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110396.252, "sample_time_ms": 2422.593, "learn_time_ms": 107953.373, "learn_throughput": 37.053, "synch_weights_time_ms": 11.865}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 1400000, "num_agent_steps_trained": 1400000}, "done": false, "training_iteration": 35, "trial_id": "57140_00000", "date": "2024-06-27_00-24-09", "timestamp": 1719462249, "time_this_iter_s": 110.36830067634583, "time_total_s": 4176.251066684723, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3ea8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4176.251066684723, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 15.462179487179487, "ram_util_percent": 78.51474358974359}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8416607164409848, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.299170983891391, "policy_loss": -0.007010268099175585, "vf_loss": 5.305282724424165, "vf_explained_var": 0.0017260437829298967, "kl": 0.008985291364271756, "entropy": 0.8254307413951785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 333345.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "env_runners": {"episode_reward_max": 1160.0, "episode_reward_min": 60.0, "episode_reward_mean": 544.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -350.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 54.435}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.0, 565.0, 1070.0, 440.0, 320.0, 730.0, 430.0, 450.0, 490.0, 490.0, 490.0, 130.0, 540.0, 420.0, 390.0, 280.0, 770.0, 735.0, 505.0, 990.0, 865.0, 870.0, 770.0, 820.0, 280.0, 450.0, 290.0, 870.0, 790.0, 940.0, 60.0, 510.0, 380.0, 510.0, 1050.0, 750.0, 120.0, 450.0, 530.0, 310.0, 740.0, 900.0, 160.0, 120.0, 320.0, 700.0, 300.0, 920.0, 340.0, 250.0, 530.0, 250.0, 210.0, 270.0, 305.0, 400.0, 215.0, 840.0, 430.0, 380.0, 860.0, 280.0, 180.0, 210.0, 260.0, 690.0, 380.0, 280.0, 710.0, 780.0, 610.0, 730.0, 1000.0, 400.0, 1160.0, 320.0, 430.0, 840.0, 790.0, 810.0, 330.0, 960.0, 680.0, 870.0, 330.0, 525.0, 660.0, 930.0, 260.0, 625.0, 120.0, 400.0, 555.0, 630.0, 710.0, 360.0, 590.0, 975.0, 885.0, 710.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 10.0, 50.0, 40.0, 10.0, 0.0, 10.0, 30.0, 10.0, 0.0, 180.0, 300.0, -20.0, 0.0, 60.0, -20.0, -55.0, 10.0, 60.0, 50.0, 80.0, 110.0, 660.0, 40.0, 0.0, 30.0, 20.0, -40.0, 100.0, 70.0, 170.0, 20.0, 0.0, 0.0, 60.0, 20.0, 30.0, 50.0, 70.0, 20.0, 70.0, 30.0, 10.0, 40.0, 0.0, 20.0, 20.0, 40.0, 60.0, 30.0, 450.0, 10.0, -30.0, -30.0, 100.0, 50.0, 10.0, -30.0, 0.0, 200.0, 170.0, 40.0, 30.0, 20.0, 50.0, 90.0, 0.0, 0.0, 10.0, 20.0, 170.0, 50.0, 60.0, 10.0, 0.0, 60.0, 30.0, 20.0, 40.0, 10.0, 10.0, 0.0, 20.0, 20.0, 30.0, 10.0, 130.0, 110.0, 20.0, 140.0, 0.0, 30.0, 20.0, 0.0, 170.0, 10.0, 20.0, 150.0, 10.0, 80.0, 170.0, 40.0, 20.0, 10.0, 30.0, 130.0, 0.0, 40.0, 50.0, 0.0, 0.0, 10.0, 0.0, 0.0, 80.0, 20.0, 0.0, 10.0, 10.0, 0.0, 80.0, 90.0, 10.0, 40.0, 20.0, 20.0, 10.0, 200.0, 40.0, 30.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 30.0, 30.0, 140.0, 160.0, 10.0, 90.0, 0.0, 10.0, 60.0, 20.0, 30.0, 80.0, 20.0, 70.0, 110.0, 40.0, 10.0, 30.0, 10.0, 0.0, 20.0, 40.0, 0.0, 20.0, 250.0, 200.0, -20.0, 110.0, 100.0, -50.0, 20.0, 20.0, 50.0, 90.0, 70.0, 20.0, 280.0, 10.0, -50.0, 10.0, 370.0, 20.0, -45.0, 50.0, 70.0, 30.0, 80.0, 160.0, 380.0, -240.0, -50.0, -55.0, 40.0, 90.0, 10.0, 50.0, 290.0, 180.0, 150.0, 60.0, 90.0, 60.0, 10.0, 90.0, 30.0, 90.0, 15.0, 40.0, 40.0, 170.0, 0.0, 210.0, 70.0, 200.0, 60.0, 10.0, 40.0, 30.0, 10.0, 150.0, 280.0, 70.0, 60.0, 160.0, 480.0, -40.0, 170.0, 10.0, 70.0, 10.0, 30.0, 40.0, -20.0, 20.0, 60.0, 10.0, 30.0, 290.0, 20.0, 90.0, 10.0, 150.0, 70.0, 90.0, 70.0, 0.0, 0.0, 50.0, 30.0, 20.0, 30.0, 30.0, 30.0, 20.0, 70.0, 10.0, 20.0, 0.0, 120.0, 10.0, 20.0, 10.0, 180.0, 10.0, 140.0, 0.0, 30.0, 10.0, 0.0, 10.0, 40.0, 10.0, 20.0, 30.0, 360.0, 20.0, -20.0, 20.0, 20.0, 40.0, 50.0, 70.0, 50.0, 260.0, 40.0, -50.0, 20.0, 40.0, -40.0, 90.0, 60.0, 470.0, 160.0, 0.0, 290.0, 40.0, 40.0, 280.0, 30.0, 20.0, 50.0, 0.0, 150.0, 40.0, 10.0, 50.0, 10.0, 170.0, 40.0, 10.0, 30.0, -350.0, 30.0, 60.0, 30.0, 80.0, 40.0, 40.0, 70.0, 20.0, 30.0, 30.0, 20.0, 150.0, 30.0, 0.0, 20.0, 80.0, 20.0, 70.0, 40.0, 70.0, 50.0, 0.0, 30.0, 20.0, 110.0, 30.0, 40.0, 30.0, 0.0, 50.0, 140.0, 60.0, 310.0, 80.0, 40.0, 80.0, 30.0, 60.0, 370.0, 30.0, 10.0, 40.0, 230.0, 10.0, 90.0, 180.0, 20.0, 90.0, 10.0, 80.0, 30.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 30.0, 30.0, 20.0, 20.0, 10.0, 0.0, 60.0, 20.0, 10.0, 30.0, 250.0, 130.0, 160.0, 110.0, 20.0, 10.0, 60.0, 20.0, 0.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, 40.0, 40.0, 30.0, 10.0, 30.0, 80.0, 0.0, 80.0, 50.0, 50.0, 50.0, -10.0, -30.0, 170.0, 10.0, 370.0, -10.0, 10.0, 40.0, 30.0, 40.0, 30.0, 360.0, 150.0, 270.0, -20.0, 30.0, 20.0, 0.0, 20.0, 40.0, 10.0, 0.0, 0.0, 0.0, 40.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 30.0, 40.0, 0.0, 20.0, 30.0, -30.0, 100.0, 10.0, 40.0, 80.0, 20.0, 0.0, 50.0, 20.0, 80.0, 120.0, 250.0, 40.0, 10.0, 70.0, 40.0, 10.0, 0.0, 80.0, 0.0, 50.0, 0.0, 110.0, 20.0, 10.0, 40.0, 40.0, 20.0, 10.0, 10.0, 40.0, 40.0, 60.0, 150.0, -20.0, 150.0, 430.0, 20.0, 40.0, 20.0, 0.0, 40.0, 70.0, 80.0, 10.0, 0.0, 60.0, 30.0, 30.0, 50.0, 20.0, 40.0, 30.0, 30.0, 50.0, 10.0, 0.0, 0.0, 20.0, 30.0, 160.0, 40.0, 50.0, 20.0, 10.0, 160.0, 40.0, 10.0, 10.0, 20.0, 10.0, 30.0, 30.0, 10.0, 40.0, 20.0, 60.0, 30.0, 0.0, 30.0, 30.0, 30.0, 10.0, 40.0, 10.0, 40.0, 10.0, 0.0, 10.0, 20.0, 30.0, 30.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 100.0, 30.0, 25.0, 60.0, 100.0, 10.0, 0.0, 0.0, 60.0, 0.0, 20.0, 50.0, 60.0, 0.0, 90.0, 80.0, 0.0, 0.0, 60.0, 20.0, 40.0, 10.0, 90.0, 30.0, 10.0, 0.0, 20.0, 40.0, 10.0, 5.0, 0.0, 30.0, 10.0, 10.0, 20.0, 120.0, 560.0, 10.0, 0.0, 30.0, 50.0, 0.0, 70.0, 10.0, 40.0, 20.0, 10.0, 70.0, 0.0, 50.0, 160.0, 0.0, 40.0, 10.0, 0.0, 20.0, 170.0, 40.0, 50.0, 10.0, 40.0, 0.0, 50.0, 20.0, 50.0, 60.0, 0.0, 30.0, 550.0, 70.0, 30.0, 20.0, 10.0, 30.0, 60.0, 30.0, 10.0, 30.0, 10.0, 40.0, 40.0, 0.0, 30.0, 0.0, 20.0, 10.0, 20.0, 10.0, 0.0, 50.0, 40.0, 20.0, 10.0, 10.0, 20.0, 0.0, 10.0, 80.0, 10.0, 10.0, 40.0, 40.0, 0.0, 10.0, 10.0, 50.0, 40.0, 30.0, 50.0, 20.0, 10.0, 80.0, 40.0, 40.0, 160.0, 10.0, 170.0, 10.0, 80.0, 30.0, 70.0, 30.0, 40.0, 0.0, 30.0, 30.0, 160.0, 40.0, 30.0, 20.0, 0.0, 30.0, 20.0, 80.0, 0.0, 60.0, 10.0, 0.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 480.0, 20.0, 10.0, 60.0, 60.0, 10.0, 20.0, 20.0, 260.0, 50.0, -30.0, 280.0, 60.0, 20.0, 20.0, 40.0, 60.0, 160.0, 20.0, 0.0, 180.0, 10.0, 10.0, 50.0, 200.0, 20.0, -40.0, 20.0, 360.0, 40.0, 10.0, 60.0, 80.0, 50.0, 20.0, 40.0, 50.0, 50.0, -60.0, 110.0, 80.0, 280.0, 70.0, 80.0, 50.0, 160.0, 180.0, 30.0, 10.0, 10.0, 100.0, 60.0, 40.0, 60.0, 40.0, 20.0, 30.0, 110.0, 560.0, 70.0, 110.0, -20.0, 30.0, 110.0, 70.0, 0.0, 120.0, 40.0, 40.0, 50.0, 30.0, 20.0, -80.0, 30.0, 0.0, 40.0, 150.0, 40.0, 70.0, 30.0, 0.0, 60.0, 130.0, 20.0, 20.0, 20.0, 40.0, 20.0, 110.0, 20.0, 0.0, 380.0, 130.0, 50.0, 50.0, 20.0, 60.0, 30.0, 180.0, 10.0, 160.0, 10.0, 30.0, 10.0, 20.0, 260.0, 80.0, 80.0, 160.0, 40.0, 40.0, 0.0, 20.0, 10.0, 450.0, 10.0, 0.0, 50.0, 20.0, 10.0, 170.0, 10.0, 20.0, 10.0, -40.0, 20.0, 60.0, 20.0, 0.0, 120.0, 40.0, 50.0, 10.0, 10.0, 120.0, 80.0, 510.0, 70.0, 10.0, 40.0, 150.0, 80.0, 250.0, 20.0, 40.0, 0.0, 20.0, 50.0, 460.0, 0.0, 40.0, -50.0, 10.0, 80.0, 170.0, 70.0, 40.0, 70.0, 60.0, 60.0, 0.0, 40.0, 0.0, 30.0, 60.0, 0.0, 10.0, -10.0, 30.0, 10.0, -5.0, 120.0, 190.0, 20.0, 100.0, 60.0, 10.0, 370.0, 65.0, 10.0, 70.0, 170.0, -25.0, -35.0, 10.0, 35.0, -10.0, 50.0, -40.0, 70.0, -40.0, 50.0, 170.0, 30.0, 370.0, 220.0, 50.0, 20.0, 20.0, 120.0, 0.0, 10.0, 0.0, 30.0, 60.0, 0.0, 0.0, 0.0, 10.0, 170.0, 260.0, 10.0, 20.0, 0.0, 45.0, 30.0, 80.0, 30.0, -105.0, -135.0, 60.0, 270.0, 10.0, 90.0, 20.0, -140.0, 20.0, 90.0, 40.0, 10.0, 70.0, 10.0, 70.0, 20.0, 40.0, 40.0, 10.0, 10.0, 20.0, -50.0, 100.0, 180.0, 170.0, 40.0, 0.0, 50.0, 35.0, 20.0, 40.0, 40.0, 50.0, 40.0, 50.0, 80.0, 30.0, 250.0, 30.0, 60.0, 20.0, 30.0, 90.0, 30.0, 20.0, 90.0, 160.0, 0.0, 210.0, 60.0, 150.0, 10.0, 10.0, 20.0, 50.0, 0.0, 0.0, 20.0, 40.0, -15.0, 70.0, 20.0, 10.0, 350.0, 40.0, 80.0, 80.0, -5.0, -40.0, 260.0, 360.0, 30.0, 5.0, 60.0, 30.0, -20.0, 150.0, 90.0, 10.0, 0.0, 30.0, 20.0, 480.0, 170.0, 40.0, 30.0, 20.0, 50.0, 45.0, 20.0, 60.0, 370.0, 30.0, 20.0, 10.0, 0.0, 80.0, 40.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.655126312375234, "mean_inference_ms": 1.857492046108067, "mean_action_processing_ms": 0.4846940070658341, "mean_env_wait_ms": 1.484744819730218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05438065528869629, "StateBufferConnector_ms": 0.009056329727172852, "ViewRequirementAgentConnector_ms": 0.35637664794921875}, "num_episodes": 18, "episode_return_max": 1160.0, "episode_return_min": 60.0, "episode_return_mean": 544.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 35.87299369550035, "num_env_steps_trained_throughput_per_sec": 35.87299369550035, "timesteps_total": 144000, "num_env_steps_sampled_lifetime": 144000, "num_agent_steps_sampled_lifetime": 1440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1440000, "timers": {"training_iteration_time_ms": 110519.533, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110519.485, "sample_time_ms": 2410.772, "learn_time_ms": 108088.622, "learn_throughput": 37.007, "synch_weights_time_ms": 11.653}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 1440000, "num_agent_steps_trained": 1440000}, "done": false, "training_iteration": 36, "trial_id": "57140_00000", "date": "2024-06-27_00-26-01", "timestamp": 1719462361, "time_this_iter_s": 111.51788806915283, "time_total_s": 4287.768954753876, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af436670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4287.768954753876, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 18.76012658227848, "ram_util_percent": 77.55569620253164}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.923003268597352, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.91813848229389, "policy_loss": -0.005823648083026206, "vf_loss": 4.923213624344847, "vf_explained_var": 0.0003569182179098566, "kl": 0.007485091257542267, "entropy": 0.810291768948491, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 342735.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "env_runners": {"episode_reward_max": 1260.0, "episode_reward_min": 60.0, "episode_reward_mean": 573.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -350.0}, "policy_reward_max": {"policy_0": 560.0}, "policy_reward_mean": {"policy_0": 57.34}, "custom_metrics": {}, "hist_stats": {"episode_reward": [505.0, 990.0, 865.0, 870.0, 770.0, 820.0, 280.0, 450.0, 290.0, 870.0, 790.0, 940.0, 60.0, 510.0, 380.0, 510.0, 1050.0, 750.0, 120.0, 450.0, 530.0, 310.0, 740.0, 900.0, 160.0, 120.0, 320.0, 700.0, 300.0, 920.0, 340.0, 250.0, 530.0, 250.0, 210.0, 270.0, 305.0, 400.0, 215.0, 840.0, 430.0, 380.0, 860.0, 280.0, 180.0, 210.0, 260.0, 690.0, 380.0, 280.0, 710.0, 780.0, 610.0, 730.0, 1000.0, 400.0, 1160.0, 320.0, 430.0, 840.0, 790.0, 810.0, 330.0, 960.0, 680.0, 870.0, 330.0, 525.0, 660.0, 930.0, 260.0, 625.0, 120.0, 400.0, 555.0, 630.0, 710.0, 360.0, 590.0, 975.0, 885.0, 710.0, 875.0, 900.0, 775.0, 630.0, 420.0, 710.0, 510.0, 1260.0, 960.0, 650.0, 1020.0, 375.0, 360.0, 240.0, 280.0, 370.0, 960.0, 530.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 30.0, 80.0, 160.0, 380.0, -240.0, -50.0, -55.0, 40.0, 90.0, 10.0, 50.0, 290.0, 180.0, 150.0, 60.0, 90.0, 60.0, 10.0, 90.0, 30.0, 90.0, 15.0, 40.0, 40.0, 170.0, 0.0, 210.0, 70.0, 200.0, 60.0, 10.0, 40.0, 30.0, 10.0, 150.0, 280.0, 70.0, 60.0, 160.0, 480.0, -40.0, 170.0, 10.0, 70.0, 10.0, 30.0, 40.0, -20.0, 20.0, 60.0, 10.0, 30.0, 290.0, 20.0, 90.0, 10.0, 150.0, 70.0, 90.0, 70.0, 0.0, 0.0, 50.0, 30.0, 20.0, 30.0, 30.0, 30.0, 20.0, 70.0, 10.0, 20.0, 0.0, 120.0, 10.0, 20.0, 10.0, 180.0, 10.0, 140.0, 0.0, 30.0, 10.0, 0.0, 10.0, 40.0, 10.0, 20.0, 30.0, 360.0, 20.0, -20.0, 20.0, 20.0, 40.0, 50.0, 70.0, 50.0, 260.0, 40.0, -50.0, 20.0, 40.0, -40.0, 90.0, 60.0, 470.0, 160.0, 0.0, 290.0, 40.0, 40.0, 280.0, 30.0, 20.0, 50.0, 0.0, 150.0, 40.0, 10.0, 50.0, 10.0, 170.0, 40.0, 10.0, 30.0, -350.0, 30.0, 60.0, 30.0, 80.0, 40.0, 40.0, 70.0, 20.0, 30.0, 30.0, 20.0, 150.0, 30.0, 0.0, 20.0, 80.0, 20.0, 70.0, 40.0, 70.0, 50.0, 0.0, 30.0, 20.0, 110.0, 30.0, 40.0, 30.0, 0.0, 50.0, 140.0, 60.0, 310.0, 80.0, 40.0, 80.0, 30.0, 60.0, 370.0, 30.0, 10.0, 40.0, 230.0, 10.0, 90.0, 180.0, 20.0, 90.0, 10.0, 80.0, 30.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 30.0, 30.0, 20.0, 20.0, 10.0, 0.0, 60.0, 20.0, 10.0, 30.0, 250.0, 130.0, 160.0, 110.0, 20.0, 10.0, 60.0, 20.0, 0.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, 40.0, 40.0, 30.0, 10.0, 30.0, 80.0, 0.0, 80.0, 50.0, 50.0, 50.0, -10.0, -30.0, 170.0, 10.0, 370.0, -10.0, 10.0, 40.0, 30.0, 40.0, 30.0, 360.0, 150.0, 270.0, -20.0, 30.0, 20.0, 0.0, 20.0, 40.0, 10.0, 0.0, 0.0, 0.0, 40.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 30.0, 40.0, 0.0, 20.0, 30.0, -30.0, 100.0, 10.0, 40.0, 80.0, 20.0, 0.0, 50.0, 20.0, 80.0, 120.0, 250.0, 40.0, 10.0, 70.0, 40.0, 10.0, 0.0, 80.0, 0.0, 50.0, 0.0, 110.0, 20.0, 10.0, 40.0, 40.0, 20.0, 10.0, 10.0, 40.0, 40.0, 60.0, 150.0, -20.0, 150.0, 430.0, 20.0, 40.0, 20.0, 0.0, 40.0, 70.0, 80.0, 10.0, 0.0, 60.0, 30.0, 30.0, 50.0, 20.0, 40.0, 30.0, 30.0, 50.0, 10.0, 0.0, 0.0, 20.0, 30.0, 160.0, 40.0, 50.0, 20.0, 10.0, 160.0, 40.0, 10.0, 10.0, 20.0, 10.0, 30.0, 30.0, 10.0, 40.0, 20.0, 60.0, 30.0, 0.0, 30.0, 30.0, 30.0, 10.0, 40.0, 10.0, 40.0, 10.0, 0.0, 10.0, 20.0, 30.0, 30.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 100.0, 30.0, 25.0, 60.0, 100.0, 10.0, 0.0, 0.0, 60.0, 0.0, 20.0, 50.0, 60.0, 0.0, 90.0, 80.0, 0.0, 0.0, 60.0, 20.0, 40.0, 10.0, 90.0, 30.0, 10.0, 0.0, 20.0, 40.0, 10.0, 5.0, 0.0, 30.0, 10.0, 10.0, 20.0, 120.0, 560.0, 10.0, 0.0, 30.0, 50.0, 0.0, 70.0, 10.0, 40.0, 20.0, 10.0, 70.0, 0.0, 50.0, 160.0, 0.0, 40.0, 10.0, 0.0, 20.0, 170.0, 40.0, 50.0, 10.0, 40.0, 0.0, 50.0, 20.0, 50.0, 60.0, 0.0, 30.0, 550.0, 70.0, 30.0, 20.0, 10.0, 30.0, 60.0, 30.0, 10.0, 30.0, 10.0, 40.0, 40.0, 0.0, 30.0, 0.0, 20.0, 10.0, 20.0, 10.0, 0.0, 50.0, 40.0, 20.0, 10.0, 10.0, 20.0, 0.0, 10.0, 80.0, 10.0, 10.0, 40.0, 40.0, 0.0, 10.0, 10.0, 50.0, 40.0, 30.0, 50.0, 20.0, 10.0, 80.0, 40.0, 40.0, 160.0, 10.0, 170.0, 10.0, 80.0, 30.0, 70.0, 30.0, 40.0, 0.0, 30.0, 30.0, 160.0, 40.0, 30.0, 20.0, 0.0, 30.0, 20.0, 80.0, 0.0, 60.0, 10.0, 0.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 480.0, 20.0, 10.0, 60.0, 60.0, 10.0, 20.0, 20.0, 260.0, 50.0, -30.0, 280.0, 60.0, 20.0, 20.0, 40.0, 60.0, 160.0, 20.0, 0.0, 180.0, 10.0, 10.0, 50.0, 200.0, 20.0, -40.0, 20.0, 360.0, 40.0, 10.0, 60.0, 80.0, 50.0, 20.0, 40.0, 50.0, 50.0, -60.0, 110.0, 80.0, 280.0, 70.0, 80.0, 50.0, 160.0, 180.0, 30.0, 10.0, 10.0, 100.0, 60.0, 40.0, 60.0, 40.0, 20.0, 30.0, 110.0, 560.0, 70.0, 110.0, -20.0, 30.0, 110.0, 70.0, 0.0, 120.0, 40.0, 40.0, 50.0, 30.0, 20.0, -80.0, 30.0, 0.0, 40.0, 150.0, 40.0, 70.0, 30.0, 0.0, 60.0, 130.0, 20.0, 20.0, 20.0, 40.0, 20.0, 110.0, 20.0, 0.0, 380.0, 130.0, 50.0, 50.0, 20.0, 60.0, 30.0, 180.0, 10.0, 160.0, 10.0, 30.0, 10.0, 20.0, 260.0, 80.0, 80.0, 160.0, 40.0, 40.0, 0.0, 20.0, 10.0, 450.0, 10.0, 0.0, 50.0, 20.0, 10.0, 170.0, 10.0, 20.0, 10.0, -40.0, 20.0, 60.0, 20.0, 0.0, 120.0, 40.0, 50.0, 10.0, 10.0, 120.0, 80.0, 510.0, 70.0, 10.0, 40.0, 150.0, 80.0, 250.0, 20.0, 40.0, 0.0, 20.0, 50.0, 460.0, 0.0, 40.0, -50.0, 10.0, 80.0, 170.0, 70.0, 40.0, 70.0, 60.0, 60.0, 0.0, 40.0, 0.0, 30.0, 60.0, 0.0, 10.0, -10.0, 30.0, 10.0, -5.0, 120.0, 190.0, 20.0, 100.0, 60.0, 10.0, 370.0, 65.0, 10.0, 70.0, 170.0, -25.0, -35.0, 10.0, 35.0, -10.0, 50.0, -40.0, 70.0, -40.0, 50.0, 170.0, 30.0, 370.0, 220.0, 50.0, 20.0, 20.0, 120.0, 0.0, 10.0, 0.0, 30.0, 60.0, 0.0, 0.0, 0.0, 10.0, 170.0, 260.0, 10.0, 20.0, 0.0, 45.0, 30.0, 80.0, 30.0, -105.0, -135.0, 60.0, 270.0, 10.0, 90.0, 20.0, -140.0, 20.0, 90.0, 40.0, 10.0, 70.0, 10.0, 70.0, 20.0, 40.0, 40.0, 10.0, 10.0, 20.0, -50.0, 100.0, 180.0, 170.0, 40.0, 0.0, 50.0, 35.0, 20.0, 40.0, 40.0, 50.0, 40.0, 50.0, 80.0, 30.0, 250.0, 30.0, 60.0, 20.0, 30.0, 90.0, 30.0, 20.0, 90.0, 160.0, 0.0, 210.0, 60.0, 150.0, 10.0, 10.0, 20.0, 50.0, 0.0, 0.0, 20.0, 40.0, -15.0, 70.0, 20.0, 10.0, 350.0, 40.0, 80.0, 80.0, -5.0, -40.0, 260.0, 360.0, 30.0, 5.0, 60.0, 30.0, -20.0, 150.0, 90.0, 10.0, 0.0, 30.0, 20.0, 480.0, 170.0, 40.0, 30.0, 20.0, 50.0, 45.0, 20.0, 60.0, 370.0, 30.0, 20.0, 10.0, 0.0, 80.0, 40.0, 80.0, 370.0, -50.0, -35.0, 310.0, 30.0, 40.0, 50.0, 0.0, 10.0, 150.0, 50.0, 40.0, 150.0, 10.0, 20.0, 180.0, 100.0, 60.0, 10.0, 280.0, 55.0, 70.0, 170.0, -30.0, 10.0, 20.0, 20.0, 240.0, 70.0, 150.0, 30.0, -40.0, 60.0, 20.0, 380.0, 150.0, 20.0, 10.0, 0.0, 0.0, 70.0, 10.0, 10.0, 180.0, 20.0, 10.0, 0.0, 10.0, 40.0, 70.0, 20.0, 50.0, 30.0, 20.0, 80.0, 70.0, 30.0, 100.0, 120.0, 190.0, 280.0, 30.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 40.0, -10.0, 260.0, 80.0, 170.0, 160.0, 20.0, 60.0, 0.0, 400.0, 120.0, 220.0, 150.0, 70.0, 30.0, 20.0, 50.0, 30.0, 0.0, 370.0, 20.0, 20.0, 30.0, 0.0, 350.0, 0.0, 10.0, 10.0, 140.0, 50.0, 40.0, 40.0, 160.0, 70.0, 360.0, 30.0, 90.0, 0.0, 60.0, 40.0, 170.0, 30.0, 0.0, 0.0, 40.0, 60.0, 40.0, 170.0, 20.0, -5.0, 20.0, 80.0, 30.0, 20.0, 0.0, 20.0, 100.0, 30.0, 40.0, 40.0, 0.0, 0.0, 30.0, 20.0, 40.0, 50.0, 10.0, 10.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 10.0, 40.0, 40.0, 40.0, 30.0, 40.0, 0.0, 30.0, 0.0, 10.0, 20.0, 30.0, 120.0, 20.0, 50.0, 50.0, 40.0, 70.0, 0.0, 10.0, 50.0, 300.0, 110.0, 40.0, 360.0, 0.0, 20.0, 40.0, 10.0, 20.0, 150.0, 110.0, 50.0, 20.0, 0.0, 80.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6460598006133764, "mean_inference_ms": 1.8489087376775002, "mean_action_processing_ms": 0.48214873392398183, "mean_env_wait_ms": 1.4780201306297642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055487632751464844, "StateBufferConnector_ms": 0.009213924407958984, "ViewRequirementAgentConnector_ms": 0.3728964328765869}, "num_episodes": 18, "episode_return_max": 1260.0, "episode_return_min": 60.0, "episode_return_mean": 573.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.06551970446664, "num_env_steps_trained_throughput_per_sec": 36.06551970446664, "timesteps_total": 148000, "num_env_steps_sampled_lifetime": 148000, "num_agent_steps_sampled_lifetime": 1480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1480000, "timers": {"training_iteration_time_ms": 110516.242, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110516.194, "sample_time_ms": 2404.637, "learn_time_ms": 108091.744, "learn_throughput": 37.006, "synch_weights_time_ms": 11.407}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 1480000, "num_agent_steps_trained": 1480000}, "done": false, "training_iteration": 37, "trial_id": "57140_00000", "date": "2024-06-27_00-27-52", "timestamp": 1719462472, "time_this_iter_s": 110.9230170249939, "time_total_s": 4398.69197177887, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3e7dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4398.69197177887, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 18.88152866242038, "ram_util_percent": 78.29808917197452}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9311002495507208, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.448246844888876, "policy_loss": -0.0059472451544157505, "vf_loss": 4.453404996951167, "vf_explained_var": 0.0011732137558686214, "kl": 0.00789092798152064, "entropy": 0.8037733567662386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 352125.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "env_runners": {"episode_reward_max": 1260.0, "episode_reward_min": 120.0, "episode_reward_mean": 572.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 590.0}, "policy_reward_mean": {"policy_0": 57.205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [740.0, 900.0, 160.0, 120.0, 320.0, 700.0, 300.0, 920.0, 340.0, 250.0, 530.0, 250.0, 210.0, 270.0, 305.0, 400.0, 215.0, 840.0, 430.0, 380.0, 860.0, 280.0, 180.0, 210.0, 260.0, 690.0, 380.0, 280.0, 710.0, 780.0, 610.0, 730.0, 1000.0, 400.0, 1160.0, 320.0, 430.0, 840.0, 790.0, 810.0, 330.0, 960.0, 680.0, 870.0, 330.0, 525.0, 660.0, 930.0, 260.0, 625.0, 120.0, 400.0, 555.0, 630.0, 710.0, 360.0, 590.0, 975.0, 885.0, 710.0, 875.0, 900.0, 775.0, 630.0, 420.0, 710.0, 510.0, 1260.0, 960.0, 650.0, 1020.0, 375.0, 360.0, 240.0, 280.0, 370.0, 960.0, 530.0, 1030.0, 505.0, 880.0, 595.0, 740.0, 390.0, 1005.0, 400.0, 260.0, 570.0, 710.0, 475.0, 955.0, 960.0, 270.0, 770.0, 550.0, 170.0, 660.0, 290.0, 370.0, 420.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 80.0, 50.0, 50.0, 50.0, -10.0, -30.0, 170.0, 10.0, 370.0, -10.0, 10.0, 40.0, 30.0, 40.0, 30.0, 360.0, 150.0, 270.0, -20.0, 30.0, 20.0, 0.0, 20.0, 40.0, 10.0, 0.0, 0.0, 0.0, 40.0, 0.0, 20.0, 10.0, 0.0, 0.0, 0.0, 30.0, 40.0, 0.0, 20.0, 30.0, -30.0, 100.0, 10.0, 40.0, 80.0, 20.0, 0.0, 50.0, 20.0, 80.0, 120.0, 250.0, 40.0, 10.0, 70.0, 40.0, 10.0, 0.0, 80.0, 0.0, 50.0, 0.0, 110.0, 20.0, 10.0, 40.0, 40.0, 20.0, 10.0, 10.0, 40.0, 40.0, 60.0, 150.0, -20.0, 150.0, 430.0, 20.0, 40.0, 20.0, 0.0, 40.0, 70.0, 80.0, 10.0, 0.0, 60.0, 30.0, 30.0, 50.0, 20.0, 40.0, 30.0, 30.0, 50.0, 10.0, 0.0, 0.0, 20.0, 30.0, 160.0, 40.0, 50.0, 20.0, 10.0, 160.0, 40.0, 10.0, 10.0, 20.0, 10.0, 30.0, 30.0, 10.0, 40.0, 20.0, 60.0, 30.0, 0.0, 30.0, 30.0, 30.0, 10.0, 40.0, 10.0, 40.0, 10.0, 0.0, 10.0, 20.0, 30.0, 30.0, 10.0, 0.0, 20.0, 20.0, 20.0, 20.0, 100.0, 30.0, 25.0, 60.0, 100.0, 10.0, 0.0, 0.0, 60.0, 0.0, 20.0, 50.0, 60.0, 0.0, 90.0, 80.0, 0.0, 0.0, 60.0, 20.0, 40.0, 10.0, 90.0, 30.0, 10.0, 0.0, 20.0, 40.0, 10.0, 5.0, 0.0, 30.0, 10.0, 10.0, 20.0, 120.0, 560.0, 10.0, 0.0, 30.0, 50.0, 0.0, 70.0, 10.0, 40.0, 20.0, 10.0, 70.0, 0.0, 50.0, 160.0, 0.0, 40.0, 10.0, 0.0, 20.0, 170.0, 40.0, 50.0, 10.0, 40.0, 0.0, 50.0, 20.0, 50.0, 60.0, 0.0, 30.0, 550.0, 70.0, 30.0, 20.0, 10.0, 30.0, 60.0, 30.0, 10.0, 30.0, 10.0, 40.0, 40.0, 0.0, 30.0, 0.0, 20.0, 10.0, 20.0, 10.0, 0.0, 50.0, 40.0, 20.0, 10.0, 10.0, 20.0, 0.0, 10.0, 80.0, 10.0, 10.0, 40.0, 40.0, 0.0, 10.0, 10.0, 50.0, 40.0, 30.0, 50.0, 20.0, 10.0, 80.0, 40.0, 40.0, 160.0, 10.0, 170.0, 10.0, 80.0, 30.0, 70.0, 30.0, 40.0, 0.0, 30.0, 30.0, 160.0, 40.0, 30.0, 20.0, 0.0, 30.0, 20.0, 80.0, 0.0, 60.0, 10.0, 0.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 480.0, 20.0, 10.0, 60.0, 60.0, 10.0, 20.0, 20.0, 260.0, 50.0, -30.0, 280.0, 60.0, 20.0, 20.0, 40.0, 60.0, 160.0, 20.0, 0.0, 180.0, 10.0, 10.0, 50.0, 200.0, 20.0, -40.0, 20.0, 360.0, 40.0, 10.0, 60.0, 80.0, 50.0, 20.0, 40.0, 50.0, 50.0, -60.0, 110.0, 80.0, 280.0, 70.0, 80.0, 50.0, 160.0, 180.0, 30.0, 10.0, 10.0, 100.0, 60.0, 40.0, 60.0, 40.0, 20.0, 30.0, 110.0, 560.0, 70.0, 110.0, -20.0, 30.0, 110.0, 70.0, 0.0, 120.0, 40.0, 40.0, 50.0, 30.0, 20.0, -80.0, 30.0, 0.0, 40.0, 150.0, 40.0, 70.0, 30.0, 0.0, 60.0, 130.0, 20.0, 20.0, 20.0, 40.0, 20.0, 110.0, 20.0, 0.0, 380.0, 130.0, 50.0, 50.0, 20.0, 60.0, 30.0, 180.0, 10.0, 160.0, 10.0, 30.0, 10.0, 20.0, 260.0, 80.0, 80.0, 160.0, 40.0, 40.0, 0.0, 20.0, 10.0, 450.0, 10.0, 0.0, 50.0, 20.0, 10.0, 170.0, 10.0, 20.0, 10.0, -40.0, 20.0, 60.0, 20.0, 0.0, 120.0, 40.0, 50.0, 10.0, 10.0, 120.0, 80.0, 510.0, 70.0, 10.0, 40.0, 150.0, 80.0, 250.0, 20.0, 40.0, 0.0, 20.0, 50.0, 460.0, 0.0, 40.0, -50.0, 10.0, 80.0, 170.0, 70.0, 40.0, 70.0, 60.0, 60.0, 0.0, 40.0, 0.0, 30.0, 60.0, 0.0, 10.0, -10.0, 30.0, 10.0, -5.0, 120.0, 190.0, 20.0, 100.0, 60.0, 10.0, 370.0, 65.0, 10.0, 70.0, 170.0, -25.0, -35.0, 10.0, 35.0, -10.0, 50.0, -40.0, 70.0, -40.0, 50.0, 170.0, 30.0, 370.0, 220.0, 50.0, 20.0, 20.0, 120.0, 0.0, 10.0, 0.0, 30.0, 60.0, 0.0, 0.0, 0.0, 10.0, 170.0, 260.0, 10.0, 20.0, 0.0, 45.0, 30.0, 80.0, 30.0, -105.0, -135.0, 60.0, 270.0, 10.0, 90.0, 20.0, -140.0, 20.0, 90.0, 40.0, 10.0, 70.0, 10.0, 70.0, 20.0, 40.0, 40.0, 10.0, 10.0, 20.0, -50.0, 100.0, 180.0, 170.0, 40.0, 0.0, 50.0, 35.0, 20.0, 40.0, 40.0, 50.0, 40.0, 50.0, 80.0, 30.0, 250.0, 30.0, 60.0, 20.0, 30.0, 90.0, 30.0, 20.0, 90.0, 160.0, 0.0, 210.0, 60.0, 150.0, 10.0, 10.0, 20.0, 50.0, 0.0, 0.0, 20.0, 40.0, -15.0, 70.0, 20.0, 10.0, 350.0, 40.0, 80.0, 80.0, -5.0, -40.0, 260.0, 360.0, 30.0, 5.0, 60.0, 30.0, -20.0, 150.0, 90.0, 10.0, 0.0, 30.0, 20.0, 480.0, 170.0, 40.0, 30.0, 20.0, 50.0, 45.0, 20.0, 60.0, 370.0, 30.0, 20.0, 10.0, 0.0, 80.0, 40.0, 80.0, 370.0, -50.0, -35.0, 310.0, 30.0, 40.0, 50.0, 0.0, 10.0, 150.0, 50.0, 40.0, 150.0, 10.0, 20.0, 180.0, 100.0, 60.0, 10.0, 280.0, 55.0, 70.0, 170.0, -30.0, 10.0, 20.0, 20.0, 240.0, 70.0, 150.0, 30.0, -40.0, 60.0, 20.0, 380.0, 150.0, 20.0, 10.0, 0.0, 0.0, 70.0, 10.0, 10.0, 180.0, 20.0, 10.0, 0.0, 10.0, 40.0, 70.0, 20.0, 50.0, 30.0, 20.0, 80.0, 70.0, 30.0, 100.0, 120.0, 190.0, 280.0, 30.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 40.0, -10.0, 260.0, 80.0, 170.0, 160.0, 20.0, 60.0, 0.0, 400.0, 120.0, 220.0, 150.0, 70.0, 30.0, 20.0, 50.0, 30.0, 0.0, 370.0, 20.0, 20.0, 30.0, 0.0, 350.0, 0.0, 10.0, 10.0, 140.0, 50.0, 40.0, 40.0, 160.0, 70.0, 360.0, 30.0, 90.0, 0.0, 60.0, 40.0, 170.0, 30.0, 0.0, 0.0, 40.0, 60.0, 40.0, 170.0, 20.0, -5.0, 20.0, 80.0, 30.0, 20.0, 0.0, 20.0, 100.0, 30.0, 40.0, 40.0, 0.0, 0.0, 30.0, 20.0, 40.0, 50.0, 10.0, 10.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 10.0, 40.0, 40.0, 40.0, 30.0, 40.0, 0.0, 30.0, 0.0, 10.0, 20.0, 30.0, 120.0, 20.0, 50.0, 50.0, 40.0, 70.0, 0.0, 10.0, 50.0, 300.0, 110.0, 40.0, 360.0, 0.0, 20.0, 40.0, 10.0, 20.0, 150.0, 110.0, 50.0, 20.0, 0.0, 80.0, 50.0, 320.0, 140.0, 50.0, 30.0, 0.0, 20.0, 20.0, 100.0, 190.0, 160.0, 0.0, 130.0, -15.0, 130.0, 30.0, 40.0, 15.0, 270.0, -40.0, -55.0, 410.0, -30.0, 10.0, -40.0, 50.0, 200.0, 10.0, 150.0, 90.0, 30.0, 60.0, 160.0, -35.0, 0.0, 290.0, 20.0, -10.0, 30.0, 0.0, 80.0, 170.0, 20.0, 30.0, 80.0, 0.0, 110.0, 10.0, -10.0, 270.0, 60.0, 30.0, 80.0, 10.0, 20.0, 60.0, 40.0, 60.0, 20.0, 70.0, 0.0, 30.0, 10.0, 90.0, 150.0, 160.0, 0.0, 460.0, 20.0, 70.0, 15.0, 0.0, 160.0, 0.0, 20.0, 80.0, 60.0, 0.0, 40.0, 40.0, 0.0, 0.0, 10.0, 40.0, 0.0, 40.0, 20.0, 20.0, 50.0, 50.0, 30.0, 200.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 180.0, 30.0, 100.0, 40.0, 270.0, 50.0, 20.0, -30.0, 70.0, 10.0, 260.0, 10.0, 10.0, 170.0, 10.0, 160.0, 0.0, 0.0, -5.0, 40.0, 50.0, 50.0, 0.0, 40.0, 20.0, 40.0, 25.0, 590.0, 120.0, 30.0, 20.0, 30.0, 40.0, 0.0, 20.0, 20.0, 270.0, 50.0, -30.0, 350.0, 90.0, 190.0, 0.0, 30.0, 40.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 30.0, 120.0, 30.0, 190.0, 270.0, 10.0, 50.0, 10.0, 100.0, 50.0, 10.0, 50.0, 0.0, 0.0, 0.0, 20.0, 50.0, 250.0, 40.0, 20.0, 150.0, 20.0, 20.0, 0.0, 30.0, 40.0, 10.0, 0.0, 20.0, 0.0, 30.0, 20.0, 190.0, 90.0, 20.0, 20.0, 0.0, 30.0, 30.0, 30.0, 0.0, 250.0, 20.0, 40.0, 30.0, 40.0, 30.0, 20.0, 0.0, 40.0, 30.0, 40.0, 40.0, 0.0, 40.0, 60.0, 70.0, 10.0, 40.0, 40.0, 30.0, 40.0, 20.0, 20.0, 110.0, 0.0, 180.0, 30.0, 30.0, 0.0, 20.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6359928599929583, "mean_inference_ms": 1.8386450210472531, "mean_action_processing_ms": 0.4791106545831741, "mean_env_wait_ms": 1.4702593574775056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05598092079162598, "StateBufferConnector_ms": 0.009348154067993164, "ViewRequirementAgentConnector_ms": 0.37755823135375977}, "num_episodes": 22, "episode_return_max": 1260.0, "episode_return_min": 120.0, "episode_return_mean": 572.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.25872136424815, "num_env_steps_trained_throughput_per_sec": 36.25872136424815, "timesteps_total": 152000, "num_env_steps_sampled_lifetime": 152000, "num_agent_steps_sampled_lifetime": 1520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1520000, "timers": {"training_iteration_time_ms": 110522.444, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110522.396, "sample_time_ms": 2411.092, "learn_time_ms": 108091.426, "learn_throughput": 37.006, "synch_weights_time_ms": 11.481}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 1520000, "num_agent_steps_trained": 1520000}, "done": false, "training_iteration": 38, "trial_id": "57140_00000", "date": "2024-06-27_00-29-42", "timestamp": 1719462582, "time_this_iter_s": 110.33182191848755, "time_total_s": 4509.023793697357, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af4364c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4509.023793697357, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 15.872435897435894, "ram_util_percent": 78.58269230769231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7976816681754222, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.549208167109627, "policy_loss": -0.006331229716697083, "vf_loss": 4.554674612904509, "vf_explained_var": 0.0011040447111200855, "kl": 0.008647840137202946, "entropy": 0.7592459314928268, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 361515.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "env_runners": {"episode_reward_max": 1260.0, "episode_reward_min": 120.0, "episode_reward_mean": 595.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -180.0}, "policy_reward_max": {"policy_0": 590.0}, "policy_reward_mean": {"policy_0": 59.595}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.0, 260.0, 690.0, 380.0, 280.0, 710.0, 780.0, 610.0, 730.0, 1000.0, 400.0, 1160.0, 320.0, 430.0, 840.0, 790.0, 810.0, 330.0, 960.0, 680.0, 870.0, 330.0, 525.0, 660.0, 930.0, 260.0, 625.0, 120.0, 400.0, 555.0, 630.0, 710.0, 360.0, 590.0, 975.0, 885.0, 710.0, 875.0, 900.0, 775.0, 630.0, 420.0, 710.0, 510.0, 1260.0, 960.0, 650.0, 1020.0, 375.0, 360.0, 240.0, 280.0, 370.0, 960.0, 530.0, 1030.0, 505.0, 880.0, 595.0, 740.0, 390.0, 1005.0, 400.0, 260.0, 570.0, 710.0, 475.0, 955.0, 960.0, 270.0, 770.0, 550.0, 170.0, 660.0, 290.0, 370.0, 420.0, 790.0, 470.0, 570.0, 540.0, 560.0, 915.0, 400.0, 640.0, 655.0, 350.0, 160.0, 730.0, 650.0, 1145.0, 585.0, 560.0, 460.0, 250.0, 620.0, 620.0, 190.0, 120.0, 310.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 10.0, 10.0, 20.0, 0.0, 10.0, 80.0, 10.0, 10.0, 40.0, 40.0, 0.0, 10.0, 10.0, 50.0, 40.0, 30.0, 50.0, 20.0, 10.0, 80.0, 40.0, 40.0, 160.0, 10.0, 170.0, 10.0, 80.0, 30.0, 70.0, 30.0, 40.0, 0.0, 30.0, 30.0, 160.0, 40.0, 30.0, 20.0, 0.0, 30.0, 20.0, 80.0, 0.0, 60.0, 10.0, 0.0, 20.0, 20.0, 40.0, 20.0, 10.0, 20.0, 480.0, 20.0, 10.0, 60.0, 60.0, 10.0, 20.0, 20.0, 260.0, 50.0, -30.0, 280.0, 60.0, 20.0, 20.0, 40.0, 60.0, 160.0, 20.0, 0.0, 180.0, 10.0, 10.0, 50.0, 200.0, 20.0, -40.0, 20.0, 360.0, 40.0, 10.0, 60.0, 80.0, 50.0, 20.0, 40.0, 50.0, 50.0, -60.0, 110.0, 80.0, 280.0, 70.0, 80.0, 50.0, 160.0, 180.0, 30.0, 10.0, 10.0, 100.0, 60.0, 40.0, 60.0, 40.0, 20.0, 30.0, 110.0, 560.0, 70.0, 110.0, -20.0, 30.0, 110.0, 70.0, 0.0, 120.0, 40.0, 40.0, 50.0, 30.0, 20.0, -80.0, 30.0, 0.0, 40.0, 150.0, 40.0, 70.0, 30.0, 0.0, 60.0, 130.0, 20.0, 20.0, 20.0, 40.0, 20.0, 110.0, 20.0, 0.0, 380.0, 130.0, 50.0, 50.0, 20.0, 60.0, 30.0, 180.0, 10.0, 160.0, 10.0, 30.0, 10.0, 20.0, 260.0, 80.0, 80.0, 160.0, 40.0, 40.0, 0.0, 20.0, 10.0, 450.0, 10.0, 0.0, 50.0, 20.0, 10.0, 170.0, 10.0, 20.0, 10.0, -40.0, 20.0, 60.0, 20.0, 0.0, 120.0, 40.0, 50.0, 10.0, 10.0, 120.0, 80.0, 510.0, 70.0, 10.0, 40.0, 150.0, 80.0, 250.0, 20.0, 40.0, 0.0, 20.0, 50.0, 460.0, 0.0, 40.0, -50.0, 10.0, 80.0, 170.0, 70.0, 40.0, 70.0, 60.0, 60.0, 0.0, 40.0, 0.0, 30.0, 60.0, 0.0, 10.0, -10.0, 30.0, 10.0, -5.0, 120.0, 190.0, 20.0, 100.0, 60.0, 10.0, 370.0, 65.0, 10.0, 70.0, 170.0, -25.0, -35.0, 10.0, 35.0, -10.0, 50.0, -40.0, 70.0, -40.0, 50.0, 170.0, 30.0, 370.0, 220.0, 50.0, 20.0, 20.0, 120.0, 0.0, 10.0, 0.0, 30.0, 60.0, 0.0, 0.0, 0.0, 10.0, 170.0, 260.0, 10.0, 20.0, 0.0, 45.0, 30.0, 80.0, 30.0, -105.0, -135.0, 60.0, 270.0, 10.0, 90.0, 20.0, -140.0, 20.0, 90.0, 40.0, 10.0, 70.0, 10.0, 70.0, 20.0, 40.0, 40.0, 10.0, 10.0, 20.0, -50.0, 100.0, 180.0, 170.0, 40.0, 0.0, 50.0, 35.0, 20.0, 40.0, 40.0, 50.0, 40.0, 50.0, 80.0, 30.0, 250.0, 30.0, 60.0, 20.0, 30.0, 90.0, 30.0, 20.0, 90.0, 160.0, 0.0, 210.0, 60.0, 150.0, 10.0, 10.0, 20.0, 50.0, 0.0, 0.0, 20.0, 40.0, -15.0, 70.0, 20.0, 10.0, 350.0, 40.0, 80.0, 80.0, -5.0, -40.0, 260.0, 360.0, 30.0, 5.0, 60.0, 30.0, -20.0, 150.0, 90.0, 10.0, 0.0, 30.0, 20.0, 480.0, 170.0, 40.0, 30.0, 20.0, 50.0, 45.0, 20.0, 60.0, 370.0, 30.0, 20.0, 10.0, 0.0, 80.0, 40.0, 80.0, 370.0, -50.0, -35.0, 310.0, 30.0, 40.0, 50.0, 0.0, 10.0, 150.0, 50.0, 40.0, 150.0, 10.0, 20.0, 180.0, 100.0, 60.0, 10.0, 280.0, 55.0, 70.0, 170.0, -30.0, 10.0, 20.0, 20.0, 240.0, 70.0, 150.0, 30.0, -40.0, 60.0, 20.0, 380.0, 150.0, 20.0, 10.0, 0.0, 0.0, 70.0, 10.0, 10.0, 180.0, 20.0, 10.0, 0.0, 10.0, 40.0, 70.0, 20.0, 50.0, 30.0, 20.0, 80.0, 70.0, 30.0, 100.0, 120.0, 190.0, 280.0, 30.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 40.0, -10.0, 260.0, 80.0, 170.0, 160.0, 20.0, 60.0, 0.0, 400.0, 120.0, 220.0, 150.0, 70.0, 30.0, 20.0, 50.0, 30.0, 0.0, 370.0, 20.0, 20.0, 30.0, 0.0, 350.0, 0.0, 10.0, 10.0, 140.0, 50.0, 40.0, 40.0, 160.0, 70.0, 360.0, 30.0, 90.0, 0.0, 60.0, 40.0, 170.0, 30.0, 0.0, 0.0, 40.0, 60.0, 40.0, 170.0, 20.0, -5.0, 20.0, 80.0, 30.0, 20.0, 0.0, 20.0, 100.0, 30.0, 40.0, 40.0, 0.0, 0.0, 30.0, 20.0, 40.0, 50.0, 10.0, 10.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 10.0, 40.0, 40.0, 40.0, 30.0, 40.0, 0.0, 30.0, 0.0, 10.0, 20.0, 30.0, 120.0, 20.0, 50.0, 50.0, 40.0, 70.0, 0.0, 10.0, 50.0, 300.0, 110.0, 40.0, 360.0, 0.0, 20.0, 40.0, 10.0, 20.0, 150.0, 110.0, 50.0, 20.0, 0.0, 80.0, 50.0, 320.0, 140.0, 50.0, 30.0, 0.0, 20.0, 20.0, 100.0, 190.0, 160.0, 0.0, 130.0, -15.0, 130.0, 30.0, 40.0, 15.0, 270.0, -40.0, -55.0, 410.0, -30.0, 10.0, -40.0, 50.0, 200.0, 10.0, 150.0, 90.0, 30.0, 60.0, 160.0, -35.0, 0.0, 290.0, 20.0, -10.0, 30.0, 0.0, 80.0, 170.0, 20.0, 30.0, 80.0, 0.0, 110.0, 10.0, -10.0, 270.0, 60.0, 30.0, 80.0, 10.0, 20.0, 60.0, 40.0, 60.0, 20.0, 70.0, 0.0, 30.0, 10.0, 90.0, 150.0, 160.0, 0.0, 460.0, 20.0, 70.0, 15.0, 0.0, 160.0, 0.0, 20.0, 80.0, 60.0, 0.0, 40.0, 40.0, 0.0, 0.0, 10.0, 40.0, 0.0, 40.0, 20.0, 20.0, 50.0, 50.0, 30.0, 200.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 180.0, 30.0, 100.0, 40.0, 270.0, 50.0, 20.0, -30.0, 70.0, 10.0, 260.0, 10.0, 10.0, 170.0, 10.0, 160.0, 0.0, 0.0, -5.0, 40.0, 50.0, 50.0, 0.0, 40.0, 20.0, 40.0, 25.0, 590.0, 120.0, 30.0, 20.0, 30.0, 40.0, 0.0, 20.0, 20.0, 270.0, 50.0, -30.0, 350.0, 90.0, 190.0, 0.0, 30.0, 40.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 30.0, 120.0, 30.0, 190.0, 270.0, 10.0, 50.0, 10.0, 100.0, 50.0, 10.0, 50.0, 0.0, 0.0, 0.0, 20.0, 50.0, 250.0, 40.0, 20.0, 150.0, 20.0, 20.0, 0.0, 30.0, 40.0, 10.0, 0.0, 20.0, 0.0, 30.0, 20.0, 190.0, 90.0, 20.0, 20.0, 0.0, 30.0, 30.0, 30.0, 0.0, 250.0, 20.0, 40.0, 30.0, 40.0, 30.0, 20.0, 0.0, 40.0, 30.0, 40.0, 40.0, 0.0, 40.0, 60.0, 70.0, 10.0, 40.0, 40.0, 30.0, 40.0, 20.0, 20.0, 110.0, 0.0, 180.0, 30.0, 30.0, 0.0, 20.0, 10.0, 90.0, 20.0, 30.0, 350.0, 0.0, 80.0, 60.0, 120.0, 20.0, 20.0, 50.0, 20.0, 30.0, 150.0, 40.0, 30.0, 20.0, 100.0, 30.0, 0.0, 180.0, 0.0, 30.0, 160.0, 50.0, 10.0, 40.0, 0.0, 60.0, 40.0, 170.0, 130.0, 20.0, 40.0, -100.0, 160.0, 10.0, 50.0, 40.0, 20.0, 180.0, 0.0, 0.0, 120.0, 50.0, 50.0, 10.0, 60.0, 50.0, 40.0, 40.0, 255.0, -10.0, 70.0, 70.0, 10.0, 90.0, 210.0, 180.0, 0.0, 30.0, 60.0, 20.0, 20.0, 20.0, 10.0, 70.0, 20.0, 150.0, 0.0, 30.0, 380.0, 0.0, 40.0, 0.0, 30.0, 30.0, 30.0, 60.0, 40.0, 20.0, 210.0, 10.0, 120.0, 250.0, -165.0, -30.0, -50.0, -180.0, 470.0, 10.0, 60.0, 60.0, 40.0, 0.0, 0.0, 0.0, 60.0, 60.0, 60.0, 10.0, 20.0, 10.0, 10.0, 30.0, 0.0, 0.0, 80.0, 0.0, 0.0, 20.0, 20.0, 20.0, 360.0, -40.0, 50.0, 80.0, 30.0, 40.0, 150.0, 20.0, 60.0, 10.0, 100.0, 40.0, 30.0, 40.0, 30.0, 290.0, 30.0, 40.0, 50.0, 45.0, 50.0, 110.0, 130.0, 590.0, 20.0, 80.0, 30.0, 170.0, 20.0, 20.0, 70.0, 5.0, 190.0, 30.0, 60.0, 20.0, 0.0, 90.0, 40.0, 20.0, 20.0, 80.0, 70.0, 30.0, 150.0, 70.0, -10.0, 170.0, 80.0, 20.0, 40.0, 0.0, 20.0, 30.0, 70.0, 20.0, 10.0, 20.0, 170.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 30.0, 30.0, 70.0, 260.0, -10.0, 30.0, 80.0, 40.0, 70.0, 20.0, -10.0, 30.0, 30.0, 0.0, 260.0, 30.0, 20.0, 90.0, 20.0, 150.0, 20.0, 30.0, 10.0, 0.0, 30.0, 20.0, 20.0, 0.0, 30.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 30.0, 30.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 40.0, 0.0, 30.0, 30.0, 10.0, 20.0, 170.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6268905594826522, "mean_inference_ms": 1.8290332381402488, "mean_action_processing_ms": 0.47620817558976164, "mean_env_wait_ms": 1.4627063588958265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05578279495239258, "StateBufferConnector_ms": 0.009471893310546875, "ViewRequirementAgentConnector_ms": 0.3960537910461426}, "num_episodes": 23, "episode_return_max": 1260.0, "episode_return_min": 120.0, "episode_return_mean": 595.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.30792582900232, "num_env_steps_trained_throughput_per_sec": 36.30792582900232, "timesteps_total": 156000, "num_env_steps_sampled_lifetime": 156000, "num_agent_steps_sampled_lifetime": 1560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1560000, "timers": {"training_iteration_time_ms": 110512.038, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110511.988, "sample_time_ms": 2410.458, "learn_time_ms": 108081.925, "learn_throughput": 37.009, "synch_weights_time_ms": 11.298}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 1560000, "num_agent_steps_trained": 1560000}, "done": false, "training_iteration": 39, "trial_id": "57140_00000", "date": "2024-06-27_00-31-32", "timestamp": 1719462692, "time_this_iter_s": 110.18443274497986, "time_total_s": 4619.208226442337, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af43af70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4619.208226442337, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 15.45897435897436, "ram_util_percent": 78.43910256410257}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8266259285398185, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.538454678619758, "policy_loss": -0.0056154679798737315, "vf_loss": 4.543265522478488, "vf_explained_var": 0.0005220706470477315, "kl": 0.00804624235345733, "entropy": 0.7336899049365864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 370905.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "env_runners": {"episode_reward_max": 1260.0, "episode_reward_min": 120.0, "episode_reward_mean": 586.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -180.0}, "policy_reward_max": {"policy_0": 590.0}, "policy_reward_mean": {"policy_0": 58.615}, "custom_metrics": {}, "hist_stats": {"episode_reward": [960.0, 680.0, 870.0, 330.0, 525.0, 660.0, 930.0, 260.0, 625.0, 120.0, 400.0, 555.0, 630.0, 710.0, 360.0, 590.0, 975.0, 885.0, 710.0, 875.0, 900.0, 775.0, 630.0, 420.0, 710.0, 510.0, 1260.0, 960.0, 650.0, 1020.0, 375.0, 360.0, 240.0, 280.0, 370.0, 960.0, 530.0, 1030.0, 505.0, 880.0, 595.0, 740.0, 390.0, 1005.0, 400.0, 260.0, 570.0, 710.0, 475.0, 955.0, 960.0, 270.0, 770.0, 550.0, 170.0, 660.0, 290.0, 370.0, 420.0, 790.0, 470.0, 570.0, 540.0, 560.0, 915.0, 400.0, 640.0, 655.0, 350.0, 160.0, 730.0, 650.0, 1145.0, 585.0, 560.0, 460.0, 250.0, 620.0, 620.0, 190.0, 120.0, 310.0, 240.0, 335.0, 340.0, 1060.0, 1020.0, 595.0, 420.0, 870.0, 570.0, 350.0, 730.0, 420.0, 220.0, 570.0, 615.0, 450.0, 500.0, 445.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 0.0, 120.0, 40.0, 50.0, 10.0, 10.0, 120.0, 80.0, 510.0, 70.0, 10.0, 40.0, 150.0, 80.0, 250.0, 20.0, 40.0, 0.0, 20.0, 50.0, 460.0, 0.0, 40.0, -50.0, 10.0, 80.0, 170.0, 70.0, 40.0, 70.0, 60.0, 60.0, 0.0, 40.0, 0.0, 30.0, 60.0, 0.0, 10.0, -10.0, 30.0, 10.0, -5.0, 120.0, 190.0, 20.0, 100.0, 60.0, 10.0, 370.0, 65.0, 10.0, 70.0, 170.0, -25.0, -35.0, 10.0, 35.0, -10.0, 50.0, -40.0, 70.0, -40.0, 50.0, 170.0, 30.0, 370.0, 220.0, 50.0, 20.0, 20.0, 120.0, 0.0, 10.0, 0.0, 30.0, 60.0, 0.0, 0.0, 0.0, 10.0, 170.0, 260.0, 10.0, 20.0, 0.0, 45.0, 30.0, 80.0, 30.0, -105.0, -135.0, 60.0, 270.0, 10.0, 90.0, 20.0, -140.0, 20.0, 90.0, 40.0, 10.0, 70.0, 10.0, 70.0, 20.0, 40.0, 40.0, 10.0, 10.0, 20.0, -50.0, 100.0, 180.0, 170.0, 40.0, 0.0, 50.0, 35.0, 20.0, 40.0, 40.0, 50.0, 40.0, 50.0, 80.0, 30.0, 250.0, 30.0, 60.0, 20.0, 30.0, 90.0, 30.0, 20.0, 90.0, 160.0, 0.0, 210.0, 60.0, 150.0, 10.0, 10.0, 20.0, 50.0, 0.0, 0.0, 20.0, 40.0, -15.0, 70.0, 20.0, 10.0, 350.0, 40.0, 80.0, 80.0, -5.0, -40.0, 260.0, 360.0, 30.0, 5.0, 60.0, 30.0, -20.0, 150.0, 90.0, 10.0, 0.0, 30.0, 20.0, 480.0, 170.0, 40.0, 30.0, 20.0, 50.0, 45.0, 20.0, 60.0, 370.0, 30.0, 20.0, 10.0, 0.0, 80.0, 40.0, 80.0, 370.0, -50.0, -35.0, 310.0, 30.0, 40.0, 50.0, 0.0, 10.0, 150.0, 50.0, 40.0, 150.0, 10.0, 20.0, 180.0, 100.0, 60.0, 10.0, 280.0, 55.0, 70.0, 170.0, -30.0, 10.0, 20.0, 20.0, 240.0, 70.0, 150.0, 30.0, -40.0, 60.0, 20.0, 380.0, 150.0, 20.0, 10.0, 0.0, 0.0, 70.0, 10.0, 10.0, 180.0, 20.0, 10.0, 0.0, 10.0, 40.0, 70.0, 20.0, 50.0, 30.0, 20.0, 80.0, 70.0, 30.0, 100.0, 120.0, 190.0, 280.0, 30.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 40.0, -10.0, 260.0, 80.0, 170.0, 160.0, 20.0, 60.0, 0.0, 400.0, 120.0, 220.0, 150.0, 70.0, 30.0, 20.0, 50.0, 30.0, 0.0, 370.0, 20.0, 20.0, 30.0, 0.0, 350.0, 0.0, 10.0, 10.0, 140.0, 50.0, 40.0, 40.0, 160.0, 70.0, 360.0, 30.0, 90.0, 0.0, 60.0, 40.0, 170.0, 30.0, 0.0, 0.0, 40.0, 60.0, 40.0, 170.0, 20.0, -5.0, 20.0, 80.0, 30.0, 20.0, 0.0, 20.0, 100.0, 30.0, 40.0, 40.0, 0.0, 0.0, 30.0, 20.0, 40.0, 50.0, 10.0, 10.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 10.0, 40.0, 40.0, 40.0, 30.0, 40.0, 0.0, 30.0, 0.0, 10.0, 20.0, 30.0, 120.0, 20.0, 50.0, 50.0, 40.0, 70.0, 0.0, 10.0, 50.0, 300.0, 110.0, 40.0, 360.0, 0.0, 20.0, 40.0, 10.0, 20.0, 150.0, 110.0, 50.0, 20.0, 0.0, 80.0, 50.0, 320.0, 140.0, 50.0, 30.0, 0.0, 20.0, 20.0, 100.0, 190.0, 160.0, 0.0, 130.0, -15.0, 130.0, 30.0, 40.0, 15.0, 270.0, -40.0, -55.0, 410.0, -30.0, 10.0, -40.0, 50.0, 200.0, 10.0, 150.0, 90.0, 30.0, 60.0, 160.0, -35.0, 0.0, 290.0, 20.0, -10.0, 30.0, 0.0, 80.0, 170.0, 20.0, 30.0, 80.0, 0.0, 110.0, 10.0, -10.0, 270.0, 60.0, 30.0, 80.0, 10.0, 20.0, 60.0, 40.0, 60.0, 20.0, 70.0, 0.0, 30.0, 10.0, 90.0, 150.0, 160.0, 0.0, 460.0, 20.0, 70.0, 15.0, 0.0, 160.0, 0.0, 20.0, 80.0, 60.0, 0.0, 40.0, 40.0, 0.0, 0.0, 10.0, 40.0, 0.0, 40.0, 20.0, 20.0, 50.0, 50.0, 30.0, 200.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 180.0, 30.0, 100.0, 40.0, 270.0, 50.0, 20.0, -30.0, 70.0, 10.0, 260.0, 10.0, 10.0, 170.0, 10.0, 160.0, 0.0, 0.0, -5.0, 40.0, 50.0, 50.0, 0.0, 40.0, 20.0, 40.0, 25.0, 590.0, 120.0, 30.0, 20.0, 30.0, 40.0, 0.0, 20.0, 20.0, 270.0, 50.0, -30.0, 350.0, 90.0, 190.0, 0.0, 30.0, 40.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 30.0, 120.0, 30.0, 190.0, 270.0, 10.0, 50.0, 10.0, 100.0, 50.0, 10.0, 50.0, 0.0, 0.0, 0.0, 20.0, 50.0, 250.0, 40.0, 20.0, 150.0, 20.0, 20.0, 0.0, 30.0, 40.0, 10.0, 0.0, 20.0, 0.0, 30.0, 20.0, 190.0, 90.0, 20.0, 20.0, 0.0, 30.0, 30.0, 30.0, 0.0, 250.0, 20.0, 40.0, 30.0, 40.0, 30.0, 20.0, 0.0, 40.0, 30.0, 40.0, 40.0, 0.0, 40.0, 60.0, 70.0, 10.0, 40.0, 40.0, 30.0, 40.0, 20.0, 20.0, 110.0, 0.0, 180.0, 30.0, 30.0, 0.0, 20.0, 10.0, 90.0, 20.0, 30.0, 350.0, 0.0, 80.0, 60.0, 120.0, 20.0, 20.0, 50.0, 20.0, 30.0, 150.0, 40.0, 30.0, 20.0, 100.0, 30.0, 0.0, 180.0, 0.0, 30.0, 160.0, 50.0, 10.0, 40.0, 0.0, 60.0, 40.0, 170.0, 130.0, 20.0, 40.0, -100.0, 160.0, 10.0, 50.0, 40.0, 20.0, 180.0, 0.0, 0.0, 120.0, 50.0, 50.0, 10.0, 60.0, 50.0, 40.0, 40.0, 255.0, -10.0, 70.0, 70.0, 10.0, 90.0, 210.0, 180.0, 0.0, 30.0, 60.0, 20.0, 20.0, 20.0, 10.0, 70.0, 20.0, 150.0, 0.0, 30.0, 380.0, 0.0, 40.0, 0.0, 30.0, 30.0, 30.0, 60.0, 40.0, 20.0, 210.0, 10.0, 120.0, 250.0, -165.0, -30.0, -50.0, -180.0, 470.0, 10.0, 60.0, 60.0, 40.0, 0.0, 0.0, 0.0, 60.0, 60.0, 60.0, 10.0, 20.0, 10.0, 10.0, 30.0, 0.0, 0.0, 80.0, 0.0, 0.0, 20.0, 20.0, 20.0, 360.0, -40.0, 50.0, 80.0, 30.0, 40.0, 150.0, 20.0, 60.0, 10.0, 100.0, 40.0, 30.0, 40.0, 30.0, 290.0, 30.0, 40.0, 50.0, 45.0, 50.0, 110.0, 130.0, 590.0, 20.0, 80.0, 30.0, 170.0, 20.0, 20.0, 70.0, 5.0, 190.0, 30.0, 60.0, 20.0, 0.0, 90.0, 40.0, 20.0, 20.0, 80.0, 70.0, 30.0, 150.0, 70.0, -10.0, 170.0, 80.0, 20.0, 40.0, 0.0, 20.0, 30.0, 70.0, 20.0, 10.0, 20.0, 170.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 30.0, 30.0, 70.0, 260.0, -10.0, 30.0, 80.0, 40.0, 70.0, 20.0, -10.0, 30.0, 30.0, 0.0, 260.0, 30.0, 20.0, 90.0, 20.0, 150.0, 20.0, 30.0, 10.0, 0.0, 30.0, 20.0, 20.0, 0.0, 30.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 30.0, 30.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 40.0, 0.0, 30.0, 30.0, 10.0, 20.0, 170.0, 20.0, 60.0, 30.0, 10.0, 10.0, 0.0, 40.0, 40.0, 0.0, 30.0, 10.0, 70.0, 5.0, 0.0, 70.0, 30.0, 20.0, 20.0, 110.0, 0.0, 90.0, 0.0, 30.0, 0.0, 10.0, 20.0, 0.0, 20.0, 160.0, 10.0, 10.0, 40.0, 40.0, 180.0, 10.0, 160.0, 550.0, 20.0, 20.0, 30.0, 260.0, 10.0, 20.0, 50.0, 390.0, 60.0, 50.0, 0.0, 80.0, 100.0, -15.0, 20.0, 0.0, 450.0, 60.0, 60.0, -70.0, 70.0, 10.0, 10.0, 35.0, 10.0, 10.0, 30.0, 20.0, 30.0, 25.0, 10.0, 180.0, 70.0, 280.0, 380.0, 20.0, 40.0, -40.0, 30.0, 60.0, 100.0, 0.0, 0.0, 60.0, 30.0, 10.0, 30.0, -15.0, 5.0, 0.0, 50.0, 40.0, 360.0, 10.0, 40.0, 40.0, 10.0, 0.0, 160.0, 50.0, 10.0, 0.0, 30.0, 0.0, 40.0, 260.0, 260.0, 0.0, 10.0, 80.0, 10.0, 30.0, 40.0, 30.0, 80.0, 70.0, 10.0, 0.0, 60.0, 90.0, 0.0, 40.0, 40.0, 30.0, 10.0, 0.0, 0.0, 10.0, 10.0, 50.0, 10.0, 30.0, 70.0, 20.0, 260.0, 60.0, 90.0, 0.0, 20.0, 20.0, 50.0, 40.0, 10.0, -20.0, -70.0, -20.0, 0.0, -55.0, 0.0, 170.0, 470.0, 90.0, 50.0, 10.0, 20.0, 200.0, 40.0, 80.0, 40.0, 0.0, 20.0, 30.0, 10.0, 10.0, 40.0, 10.0, 280.0, 20.0, 0.0, 0.0, 50.0, 90.0, 0.0, 0.0, 50.0, 30.0, 10.0, 10.0, 50.0, 250.0, 30.0, 0.0, 15.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.620020677797652, "mean_inference_ms": 1.821509742332014, "mean_action_processing_ms": 0.4740241204873385, "mean_env_wait_ms": 1.4570026593950254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05629706382751465, "StateBufferConnector_ms": 0.009459972381591797, "ViewRequirementAgentConnector_ms": 0.4002857208251953}, "num_episodes": 18, "episode_return_max": 1260.0, "episode_return_min": 120.0, "episode_return_mean": 586.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.311066497504335, "num_env_steps_trained_throughput_per_sec": 36.311066497504335, "timesteps_total": 160000, "num_env_steps_sampled_lifetime": 160000, "num_agent_steps_sampled_lifetime": 1600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1600000, "timers": {"training_iteration_time_ms": 110416.945, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110416.894, "sample_time_ms": 2405.706, "learn_time_ms": 107991.83, "learn_throughput": 37.04, "synch_weights_time_ms": 11.166}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 1600000, "num_agent_steps_trained": 1600000}, "done": false, "training_iteration": 40, "trial_id": "57140_00000", "date": "2024-06-27_00-33-23", "timestamp": 1719462803, "time_this_iter_s": 110.17414093017578, "time_total_s": 4729.382367372513, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af436040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4729.382367372513, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 15.650322580645163, "ram_util_percent": 78.59225806451613}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7773109980855888, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.9823815000450775, "policy_loss": -0.0072080375994401915, "vf_loss": 4.988709537010477, "vf_explained_var": 0.00011471921897416932, "kl": 0.008800001785312575, "entropy": 0.7348607656293022, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 380295.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000}, "env_runners": {"episode_reward_max": 1260.0, "episode_reward_min": 120.0, "episode_reward_mean": 589.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -180.0}, "policy_reward_max": {"policy_0": 590.0}, "policy_reward_mean": {"policy_0": 58.995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [710.0, 875.0, 900.0, 775.0, 630.0, 420.0, 710.0, 510.0, 1260.0, 960.0, 650.0, 1020.0, 375.0, 360.0, 240.0, 280.0, 370.0, 960.0, 530.0, 1030.0, 505.0, 880.0, 595.0, 740.0, 390.0, 1005.0, 400.0, 260.0, 570.0, 710.0, 475.0, 955.0, 960.0, 270.0, 770.0, 550.0, 170.0, 660.0, 290.0, 370.0, 420.0, 790.0, 470.0, 570.0, 540.0, 560.0, 915.0, 400.0, 640.0, 655.0, 350.0, 160.0, 730.0, 650.0, 1145.0, 585.0, 560.0, 460.0, 250.0, 620.0, 620.0, 190.0, 120.0, 310.0, 240.0, 335.0, 340.0, 1060.0, 1020.0, 595.0, 420.0, 870.0, 570.0, 350.0, 730.0, 420.0, 220.0, 570.0, 615.0, 450.0, 500.0, 445.0, 630.0, 250.0, 500.0, 710.0, 860.0, 510.0, 550.0, 1075.0, 830.0, 250.0, 1060.0, 520.0, 750.0, 470.0, 260.0, 730.0, 1050.0, 440.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 60.0, 370.0, 30.0, 20.0, 10.0, 0.0, 80.0, 40.0, 80.0, 370.0, -50.0, -35.0, 310.0, 30.0, 40.0, 50.0, 0.0, 10.0, 150.0, 50.0, 40.0, 150.0, 10.0, 20.0, 180.0, 100.0, 60.0, 10.0, 280.0, 55.0, 70.0, 170.0, -30.0, 10.0, 20.0, 20.0, 240.0, 70.0, 150.0, 30.0, -40.0, 60.0, 20.0, 380.0, 150.0, 20.0, 10.0, 0.0, 0.0, 70.0, 10.0, 10.0, 180.0, 20.0, 10.0, 0.0, 10.0, 40.0, 70.0, 20.0, 50.0, 30.0, 20.0, 80.0, 70.0, 30.0, 100.0, 120.0, 190.0, 280.0, 30.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 40.0, -10.0, 260.0, 80.0, 170.0, 160.0, 20.0, 60.0, 0.0, 400.0, 120.0, 220.0, 150.0, 70.0, 30.0, 20.0, 50.0, 30.0, 0.0, 370.0, 20.0, 20.0, 30.0, 0.0, 350.0, 0.0, 10.0, 10.0, 140.0, 50.0, 40.0, 40.0, 160.0, 70.0, 360.0, 30.0, 90.0, 0.0, 60.0, 40.0, 170.0, 30.0, 0.0, 0.0, 40.0, 60.0, 40.0, 170.0, 20.0, -5.0, 20.0, 80.0, 30.0, 20.0, 0.0, 20.0, 100.0, 30.0, 40.0, 40.0, 0.0, 0.0, 30.0, 20.0, 40.0, 50.0, 10.0, 10.0, 30.0, 30.0, 20.0, 30.0, 20.0, 30.0, 10.0, 40.0, 40.0, 40.0, 30.0, 40.0, 0.0, 30.0, 0.0, 10.0, 20.0, 30.0, 120.0, 20.0, 50.0, 50.0, 40.0, 70.0, 0.0, 10.0, 50.0, 300.0, 110.0, 40.0, 360.0, 0.0, 20.0, 40.0, 10.0, 20.0, 150.0, 110.0, 50.0, 20.0, 0.0, 80.0, 50.0, 320.0, 140.0, 50.0, 30.0, 0.0, 20.0, 20.0, 100.0, 190.0, 160.0, 0.0, 130.0, -15.0, 130.0, 30.0, 40.0, 15.0, 270.0, -40.0, -55.0, 410.0, -30.0, 10.0, -40.0, 50.0, 200.0, 10.0, 150.0, 90.0, 30.0, 60.0, 160.0, -35.0, 0.0, 290.0, 20.0, -10.0, 30.0, 0.0, 80.0, 170.0, 20.0, 30.0, 80.0, 0.0, 110.0, 10.0, -10.0, 270.0, 60.0, 30.0, 80.0, 10.0, 20.0, 60.0, 40.0, 60.0, 20.0, 70.0, 0.0, 30.0, 10.0, 90.0, 150.0, 160.0, 0.0, 460.0, 20.0, 70.0, 15.0, 0.0, 160.0, 0.0, 20.0, 80.0, 60.0, 0.0, 40.0, 40.0, 0.0, 0.0, 10.0, 40.0, 0.0, 40.0, 20.0, 20.0, 50.0, 50.0, 30.0, 200.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 180.0, 30.0, 100.0, 40.0, 270.0, 50.0, 20.0, -30.0, 70.0, 10.0, 260.0, 10.0, 10.0, 170.0, 10.0, 160.0, 0.0, 0.0, -5.0, 40.0, 50.0, 50.0, 0.0, 40.0, 20.0, 40.0, 25.0, 590.0, 120.0, 30.0, 20.0, 30.0, 40.0, 0.0, 20.0, 20.0, 270.0, 50.0, -30.0, 350.0, 90.0, 190.0, 0.0, 30.0, 40.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 30.0, 120.0, 30.0, 190.0, 270.0, 10.0, 50.0, 10.0, 100.0, 50.0, 10.0, 50.0, 0.0, 0.0, 0.0, 20.0, 50.0, 250.0, 40.0, 20.0, 150.0, 20.0, 20.0, 0.0, 30.0, 40.0, 10.0, 0.0, 20.0, 0.0, 30.0, 20.0, 190.0, 90.0, 20.0, 20.0, 0.0, 30.0, 30.0, 30.0, 0.0, 250.0, 20.0, 40.0, 30.0, 40.0, 30.0, 20.0, 0.0, 40.0, 30.0, 40.0, 40.0, 0.0, 40.0, 60.0, 70.0, 10.0, 40.0, 40.0, 30.0, 40.0, 20.0, 20.0, 110.0, 0.0, 180.0, 30.0, 30.0, 0.0, 20.0, 10.0, 90.0, 20.0, 30.0, 350.0, 0.0, 80.0, 60.0, 120.0, 20.0, 20.0, 50.0, 20.0, 30.0, 150.0, 40.0, 30.0, 20.0, 100.0, 30.0, 0.0, 180.0, 0.0, 30.0, 160.0, 50.0, 10.0, 40.0, 0.0, 60.0, 40.0, 170.0, 130.0, 20.0, 40.0, -100.0, 160.0, 10.0, 50.0, 40.0, 20.0, 180.0, 0.0, 0.0, 120.0, 50.0, 50.0, 10.0, 60.0, 50.0, 40.0, 40.0, 255.0, -10.0, 70.0, 70.0, 10.0, 90.0, 210.0, 180.0, 0.0, 30.0, 60.0, 20.0, 20.0, 20.0, 10.0, 70.0, 20.0, 150.0, 0.0, 30.0, 380.0, 0.0, 40.0, 0.0, 30.0, 30.0, 30.0, 60.0, 40.0, 20.0, 210.0, 10.0, 120.0, 250.0, -165.0, -30.0, -50.0, -180.0, 470.0, 10.0, 60.0, 60.0, 40.0, 0.0, 0.0, 0.0, 60.0, 60.0, 60.0, 10.0, 20.0, 10.0, 10.0, 30.0, 0.0, 0.0, 80.0, 0.0, 0.0, 20.0, 20.0, 20.0, 360.0, -40.0, 50.0, 80.0, 30.0, 40.0, 150.0, 20.0, 60.0, 10.0, 100.0, 40.0, 30.0, 40.0, 30.0, 290.0, 30.0, 40.0, 50.0, 45.0, 50.0, 110.0, 130.0, 590.0, 20.0, 80.0, 30.0, 170.0, 20.0, 20.0, 70.0, 5.0, 190.0, 30.0, 60.0, 20.0, 0.0, 90.0, 40.0, 20.0, 20.0, 80.0, 70.0, 30.0, 150.0, 70.0, -10.0, 170.0, 80.0, 20.0, 40.0, 0.0, 20.0, 30.0, 70.0, 20.0, 10.0, 20.0, 170.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 30.0, 30.0, 70.0, 260.0, -10.0, 30.0, 80.0, 40.0, 70.0, 20.0, -10.0, 30.0, 30.0, 0.0, 260.0, 30.0, 20.0, 90.0, 20.0, 150.0, 20.0, 30.0, 10.0, 0.0, 30.0, 20.0, 20.0, 0.0, 30.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 30.0, 30.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 40.0, 0.0, 30.0, 30.0, 10.0, 20.0, 170.0, 20.0, 60.0, 30.0, 10.0, 10.0, 0.0, 40.0, 40.0, 0.0, 30.0, 10.0, 70.0, 5.0, 0.0, 70.0, 30.0, 20.0, 20.0, 110.0, 0.0, 90.0, 0.0, 30.0, 0.0, 10.0, 20.0, 0.0, 20.0, 160.0, 10.0, 10.0, 40.0, 40.0, 180.0, 10.0, 160.0, 550.0, 20.0, 20.0, 30.0, 260.0, 10.0, 20.0, 50.0, 390.0, 60.0, 50.0, 0.0, 80.0, 100.0, -15.0, 20.0, 0.0, 450.0, 60.0, 60.0, -70.0, 70.0, 10.0, 10.0, 35.0, 10.0, 10.0, 30.0, 20.0, 30.0, 25.0, 10.0, 180.0, 70.0, 280.0, 380.0, 20.0, 40.0, -40.0, 30.0, 60.0, 100.0, 0.0, 0.0, 60.0, 30.0, 10.0, 30.0, -15.0, 5.0, 0.0, 50.0, 40.0, 360.0, 10.0, 40.0, 40.0, 10.0, 0.0, 160.0, 50.0, 10.0, 0.0, 30.0, 0.0, 40.0, 260.0, 260.0, 0.0, 10.0, 80.0, 10.0, 30.0, 40.0, 30.0, 80.0, 70.0, 10.0, 0.0, 60.0, 90.0, 0.0, 40.0, 40.0, 30.0, 10.0, 0.0, 0.0, 10.0, 10.0, 50.0, 10.0, 30.0, 70.0, 20.0, 260.0, 60.0, 90.0, 0.0, 20.0, 20.0, 50.0, 40.0, 10.0, -20.0, -70.0, -20.0, 0.0, -55.0, 0.0, 170.0, 470.0, 90.0, 50.0, 10.0, 20.0, 200.0, 40.0, 80.0, 40.0, 0.0, 20.0, 30.0, 10.0, 10.0, 40.0, 10.0, 280.0, 20.0, 0.0, 0.0, 50.0, 90.0, 0.0, 0.0, 50.0, 30.0, 10.0, 10.0, 50.0, 250.0, 30.0, 0.0, 15.0, 70.0, 0.0, 10.0, 20.0, 250.0, 60.0, 0.0, 40.0, 10.0, 170.0, 20.0, 40.0, 20.0, 60.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 10.0, 10.0, 130.0, 10.0, 30.0, 80.0, 50.0, 70.0, 20.0, 90.0, 20.0, 0.0, 90.0, 140.0, 0.0, 290.0, 80.0, 40.0, 40.0, 10.0, 30.0, 50.0, 80.0, 50.0, 470.0, 0.0, 10.0, 140.0, 20.0, 10.0, 50.0, 20.0, 30.0, 90.0, 0.0, 40.0, 10.0, 80.0, 160.0, 30.0, 30.0, 20.0, 0.0, 10.0, 40.0, 150.0, 40.0, 170.0, 10.0, 80.0, 575.0, 180.0, 20.0, 30.0, 80.0, 30.0, 50.0, 20.0, 60.0, 30.0, 0.0, 60.0, 60.0, 170.0, 20.0, 20.0, 350.0, 50.0, 30.0, 70.0, 50.0, 70.0, 20.0, 30.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 10.0, 100.0, 470.0, 0.0, 150.0, -55.0, 270.0, 15.0, 60.0, 40.0, 50.0, 10.0, 0.0, 110.0, 40.0, 250.0, 30.0, 0.0, 20.0, 10.0, 160.0, 45.0, 100.0, -40.0, 45.0, 20.0, -10.0, 10.0, 20.0, 400.0, 0.0, -10.0, 0.0, 360.0, 150.0, 25.0, 30.0, -150.0, 25.0, 40.0, 30.0, 20.0, 20.0, 30.0, 40.0, 0.0, 20.0, 40.0, 30.0, 30.0, 10.0, 80.0, 170.0, 10.0, 0.0, 10.0, 180.0, 10.0, 10.0, 250.0, 70.0, 30.0, 300.0, 10.0, 170.0, 80.0, 40.0, 120.0, 200.0, 30.0, 0.0, 30.0, 0.0, 10.0, 160.0, 10.0, 50.0, 120.0, 40.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.613455857370858, "mean_inference_ms": 1.8146142752052186, "mean_action_processing_ms": 0.47195358082186745, "mean_env_wait_ms": 1.4515874323812552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056737422943115234, "StateBufferConnector_ms": 0.00950169563293457, "ViewRequirementAgentConnector_ms": 0.40039682388305664}, "num_episodes": 18, "episode_return_max": 1260.0, "episode_return_min": 120.0, "episode_return_mean": 589.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.36849515583929, "num_env_steps_trained_throughput_per_sec": 36.36849515583929, "timesteps_total": 164000, "num_env_steps_sampled_lifetime": 164000, "num_agent_steps_sampled_lifetime": 1640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1640000, "timers": {"training_iteration_time_ms": 110443.974, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110443.922, "sample_time_ms": 2410.118, "learn_time_ms": 108014.026, "learn_throughput": 37.032, "synch_weights_time_ms": 11.58}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 1640000, "num_agent_steps_trained": 1640000}, "done": false, "training_iteration": 41, "trial_id": "57140_00000", "date": "2024-06-27_00-35-13", "timestamp": 1719462913, "time_this_iter_s": 110.0001060962677, "time_total_s": 4839.3824734687805, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af408670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4839.3824734687805, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 16.015384615384615, "ram_util_percent": 78.59551282051282}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7598128335798384, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.118895975444009, "policy_loss": -0.0049701319617904615, "vf_loss": 4.123114962014147, "vf_explained_var": 0.002454120961748881, "kl": 0.007511490677597923, "entropy": 0.7238515583788371, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 389685.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "env_runners": {"episode_reward_max": 1360.0, "episode_reward_min": 100.0, "episode_reward_mean": 572.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -180.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 57.27}, "custom_metrics": {}, "hist_stats": {"episode_reward": [530.0, 1030.0, 505.0, 880.0, 595.0, 740.0, 390.0, 1005.0, 400.0, 260.0, 570.0, 710.0, 475.0, 955.0, 960.0, 270.0, 770.0, 550.0, 170.0, 660.0, 290.0, 370.0, 420.0, 790.0, 470.0, 570.0, 540.0, 560.0, 915.0, 400.0, 640.0, 655.0, 350.0, 160.0, 730.0, 650.0, 1145.0, 585.0, 560.0, 460.0, 250.0, 620.0, 620.0, 190.0, 120.0, 310.0, 240.0, 335.0, 340.0, 1060.0, 1020.0, 595.0, 420.0, 870.0, 570.0, 350.0, 730.0, 420.0, 220.0, 570.0, 615.0, 450.0, 500.0, 445.0, 630.0, 250.0, 500.0, 710.0, 860.0, 510.0, 550.0, 1075.0, 830.0, 250.0, 1060.0, 520.0, 750.0, 470.0, 260.0, 730.0, 1050.0, 440.0, 375.0, 810.0, 320.0, 430.0, 450.0, 310.0, 850.0, 625.0, 100.0, 425.0, 550.0, 290.0, 440.0, 660.0, 510.0, 1050.0, 1360.0, 725.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 10.0, 20.0, 150.0, 110.0, 50.0, 20.0, 0.0, 80.0, 50.0, 320.0, 140.0, 50.0, 30.0, 0.0, 20.0, 20.0, 100.0, 190.0, 160.0, 0.0, 130.0, -15.0, 130.0, 30.0, 40.0, 15.0, 270.0, -40.0, -55.0, 410.0, -30.0, 10.0, -40.0, 50.0, 200.0, 10.0, 150.0, 90.0, 30.0, 60.0, 160.0, -35.0, 0.0, 290.0, 20.0, -10.0, 30.0, 0.0, 80.0, 170.0, 20.0, 30.0, 80.0, 0.0, 110.0, 10.0, -10.0, 270.0, 60.0, 30.0, 80.0, 10.0, 20.0, 60.0, 40.0, 60.0, 20.0, 70.0, 0.0, 30.0, 10.0, 90.0, 150.0, 160.0, 0.0, 460.0, 20.0, 70.0, 15.0, 0.0, 160.0, 0.0, 20.0, 80.0, 60.0, 0.0, 40.0, 40.0, 0.0, 0.0, 10.0, 40.0, 0.0, 40.0, 20.0, 20.0, 50.0, 50.0, 30.0, 200.0, 0.0, 30.0, 10.0, 10.0, 10.0, 0.0, 180.0, 30.0, 100.0, 40.0, 270.0, 50.0, 20.0, -30.0, 70.0, 10.0, 260.0, 10.0, 10.0, 170.0, 10.0, 160.0, 0.0, 0.0, -5.0, 40.0, 50.0, 50.0, 0.0, 40.0, 20.0, 40.0, 25.0, 590.0, 120.0, 30.0, 20.0, 30.0, 40.0, 0.0, 20.0, 20.0, 270.0, 50.0, -30.0, 350.0, 90.0, 190.0, 0.0, 30.0, 40.0, 20.0, 0.0, 20.0, 0.0, 10.0, 0.0, 30.0, 120.0, 30.0, 190.0, 270.0, 10.0, 50.0, 10.0, 100.0, 50.0, 10.0, 50.0, 0.0, 0.0, 0.0, 20.0, 50.0, 250.0, 40.0, 20.0, 150.0, 20.0, 20.0, 0.0, 30.0, 40.0, 10.0, 0.0, 20.0, 0.0, 30.0, 20.0, 190.0, 90.0, 20.0, 20.0, 0.0, 30.0, 30.0, 30.0, 0.0, 250.0, 20.0, 40.0, 30.0, 40.0, 30.0, 20.0, 0.0, 40.0, 30.0, 40.0, 40.0, 0.0, 40.0, 60.0, 70.0, 10.0, 40.0, 40.0, 30.0, 40.0, 20.0, 20.0, 110.0, 0.0, 180.0, 30.0, 30.0, 0.0, 20.0, 10.0, 90.0, 20.0, 30.0, 350.0, 0.0, 80.0, 60.0, 120.0, 20.0, 20.0, 50.0, 20.0, 30.0, 150.0, 40.0, 30.0, 20.0, 100.0, 30.0, 0.0, 180.0, 0.0, 30.0, 160.0, 50.0, 10.0, 40.0, 0.0, 60.0, 40.0, 170.0, 130.0, 20.0, 40.0, -100.0, 160.0, 10.0, 50.0, 40.0, 20.0, 180.0, 0.0, 0.0, 120.0, 50.0, 50.0, 10.0, 60.0, 50.0, 40.0, 40.0, 255.0, -10.0, 70.0, 70.0, 10.0, 90.0, 210.0, 180.0, 0.0, 30.0, 60.0, 20.0, 20.0, 20.0, 10.0, 70.0, 20.0, 150.0, 0.0, 30.0, 380.0, 0.0, 40.0, 0.0, 30.0, 30.0, 30.0, 60.0, 40.0, 20.0, 210.0, 10.0, 120.0, 250.0, -165.0, -30.0, -50.0, -180.0, 470.0, 10.0, 60.0, 60.0, 40.0, 0.0, 0.0, 0.0, 60.0, 60.0, 60.0, 10.0, 20.0, 10.0, 10.0, 30.0, 0.0, 0.0, 80.0, 0.0, 0.0, 20.0, 20.0, 20.0, 360.0, -40.0, 50.0, 80.0, 30.0, 40.0, 150.0, 20.0, 60.0, 10.0, 100.0, 40.0, 30.0, 40.0, 30.0, 290.0, 30.0, 40.0, 50.0, 45.0, 50.0, 110.0, 130.0, 590.0, 20.0, 80.0, 30.0, 170.0, 20.0, 20.0, 70.0, 5.0, 190.0, 30.0, 60.0, 20.0, 0.0, 90.0, 40.0, 20.0, 20.0, 80.0, 70.0, 30.0, 150.0, 70.0, -10.0, 170.0, 80.0, 20.0, 40.0, 0.0, 20.0, 30.0, 70.0, 20.0, 10.0, 20.0, 170.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 30.0, 30.0, 70.0, 260.0, -10.0, 30.0, 80.0, 40.0, 70.0, 20.0, -10.0, 30.0, 30.0, 0.0, 260.0, 30.0, 20.0, 90.0, 20.0, 150.0, 20.0, 30.0, 10.0, 0.0, 30.0, 20.0, 20.0, 0.0, 30.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 30.0, 30.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 40.0, 0.0, 30.0, 30.0, 10.0, 20.0, 170.0, 20.0, 60.0, 30.0, 10.0, 10.0, 0.0, 40.0, 40.0, 0.0, 30.0, 10.0, 70.0, 5.0, 0.0, 70.0, 30.0, 20.0, 20.0, 110.0, 0.0, 90.0, 0.0, 30.0, 0.0, 10.0, 20.0, 0.0, 20.0, 160.0, 10.0, 10.0, 40.0, 40.0, 180.0, 10.0, 160.0, 550.0, 20.0, 20.0, 30.0, 260.0, 10.0, 20.0, 50.0, 390.0, 60.0, 50.0, 0.0, 80.0, 100.0, -15.0, 20.0, 0.0, 450.0, 60.0, 60.0, -70.0, 70.0, 10.0, 10.0, 35.0, 10.0, 10.0, 30.0, 20.0, 30.0, 25.0, 10.0, 180.0, 70.0, 280.0, 380.0, 20.0, 40.0, -40.0, 30.0, 60.0, 100.0, 0.0, 0.0, 60.0, 30.0, 10.0, 30.0, -15.0, 5.0, 0.0, 50.0, 40.0, 360.0, 10.0, 40.0, 40.0, 10.0, 0.0, 160.0, 50.0, 10.0, 0.0, 30.0, 0.0, 40.0, 260.0, 260.0, 0.0, 10.0, 80.0, 10.0, 30.0, 40.0, 30.0, 80.0, 70.0, 10.0, 0.0, 60.0, 90.0, 0.0, 40.0, 40.0, 30.0, 10.0, 0.0, 0.0, 10.0, 10.0, 50.0, 10.0, 30.0, 70.0, 20.0, 260.0, 60.0, 90.0, 0.0, 20.0, 20.0, 50.0, 40.0, 10.0, -20.0, -70.0, -20.0, 0.0, -55.0, 0.0, 170.0, 470.0, 90.0, 50.0, 10.0, 20.0, 200.0, 40.0, 80.0, 40.0, 0.0, 20.0, 30.0, 10.0, 10.0, 40.0, 10.0, 280.0, 20.0, 0.0, 0.0, 50.0, 90.0, 0.0, 0.0, 50.0, 30.0, 10.0, 10.0, 50.0, 250.0, 30.0, 0.0, 15.0, 70.0, 0.0, 10.0, 20.0, 250.0, 60.0, 0.0, 40.0, 10.0, 170.0, 20.0, 40.0, 20.0, 60.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 10.0, 10.0, 130.0, 10.0, 30.0, 80.0, 50.0, 70.0, 20.0, 90.0, 20.0, 0.0, 90.0, 140.0, 0.0, 290.0, 80.0, 40.0, 40.0, 10.0, 30.0, 50.0, 80.0, 50.0, 470.0, 0.0, 10.0, 140.0, 20.0, 10.0, 50.0, 20.0, 30.0, 90.0, 0.0, 40.0, 10.0, 80.0, 160.0, 30.0, 30.0, 20.0, 0.0, 10.0, 40.0, 150.0, 40.0, 170.0, 10.0, 80.0, 575.0, 180.0, 20.0, 30.0, 80.0, 30.0, 50.0, 20.0, 60.0, 30.0, 0.0, 60.0, 60.0, 170.0, 20.0, 20.0, 350.0, 50.0, 30.0, 70.0, 50.0, 70.0, 20.0, 30.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 10.0, 100.0, 470.0, 0.0, 150.0, -55.0, 270.0, 15.0, 60.0, 40.0, 50.0, 10.0, 0.0, 110.0, 40.0, 250.0, 30.0, 0.0, 20.0, 10.0, 160.0, 45.0, 100.0, -40.0, 45.0, 20.0, -10.0, 10.0, 20.0, 400.0, 0.0, -10.0, 0.0, 360.0, 150.0, 25.0, 30.0, -150.0, 25.0, 40.0, 30.0, 20.0, 20.0, 30.0, 40.0, 0.0, 20.0, 40.0, 30.0, 30.0, 10.0, 80.0, 170.0, 10.0, 0.0, 10.0, 180.0, 10.0, 10.0, 250.0, 70.0, 30.0, 300.0, 10.0, 170.0, 80.0, 40.0, 120.0, 200.0, 30.0, 0.0, 30.0, 0.0, 10.0, 160.0, 10.0, 50.0, 120.0, 40.0, 20.0, 50.0, 30.0, 0.0, 150.0, 20.0, -5.0, 20.0, 20.0, 60.0, 30.0, 30.0, 20.0, 380.0, 190.0, 10.0, 20.0, 50.0, 40.0, 20.0, 50.0, 20.0, 50.0, 10.0, 20.0, 40.0, 100.0, 0.0, 40.0, 10.0, 30.0, 20.0, 60.0, 30.0, 190.0, 20.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 170.0, 30.0, 20.0, 10.0, 150.0, 0.0, 30.0, -130.0, 170.0, 110.0, 60.0, 20.0, 10.0, 40.0, 10.0, 0.0, 40.0, 0.0, 20.0, 30.0, 20.0, 40.0, 50.0, 40.0, 250.0, 50.0, 80.0, 260.0, 30.0, 20.0, 40.0, 20.0, 10.0, 250.0, 40.0, 190.0, 30.0, 10.0, 15.0, 0.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, -60.0, -30.0, 20.0, 110.0, 150.0, -15.0, 20.0, 50.0, 180.0, 0.0, 30.0, 50.0, 0.0, 170.0, 30.0, 40.0, 50.0, 80.0, 50.0, 50.0, 80.0, 20.0, 0.0, 80.0, 0.0, 30.0, 10.0, 30.0, 20.0, 20.0, -5.0, 260.0, 0.0, 40.0, 25.0, 10.0, 20.0, 40.0, 10.0, 40.0, 210.0, 190.0, 40.0, 20.0, 0.0, 40.0, 40.0, 60.0, 0.0, 60.0, 40.0, 70.0, 60.0, 40.0, 20.0, 50.0, 40.0, 110.0, 0.0, 80.0, 70.0, 360.0, 160.0, 30.0, 160.0, 60.0, 20.0, 70.0, 80.0, 40.0, 60.0, 20.0, 760.0, 240.0, 30.0, 30.0, 210.0, 0.0, 10.0, 0.0, 50.0, 10.0, 50.0, 60.0, 80.0, 50.0, 20.0, 10.0, 40.0, 355.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.6072664579608005, "mean_inference_ms": 1.8085115851745746, "mean_action_processing_ms": 0.4700975067911824, "mean_env_wait_ms": 1.446621385735792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05617403984069824, "StateBufferConnector_ms": 0.009435415267944336, "ViewRequirementAgentConnector_ms": 0.3895909786224365}, "num_episodes": 18, "episode_return_max": 1360.0, "episode_return_min": 100.0, "episode_return_mean": 572.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.44232123889004, "num_env_steps_trained_throughput_per_sec": 36.44232123889004, "timesteps_total": 168000, "num_env_steps_sampled_lifetime": 168000, "num_agent_steps_sampled_lifetime": 1680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1680000, "timers": {"training_iteration_time_ms": 110411.613, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110411.559, "sample_time_ms": 2411.784, "learn_time_ms": 107980.198, "learn_throughput": 37.044, "synch_weights_time_ms": 11.316}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 1680000, "num_agent_steps_trained": 1680000}, "done": false, "training_iteration": 42, "trial_id": "57140_00000", "date": "2024-06-27_00-37-02", "timestamp": 1719463022, "time_this_iter_s": 109.77674508094788, "time_total_s": 4949.159218549728, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3e6940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 4949.159218549728, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 15.534838709677418, "ram_util_percent": 79.02967741935483}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9926115459463976, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.147810639563206, "policy_loss": -0.00591842582527671, "vf_loss": 4.15276609386245, "vf_explained_var": 0.0004932739737188727, "kl": 0.00962978844494215, "entropy": 0.7183275749063848, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 399075.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000}, "env_runners": {"episode_reward_max": 1360.0, "episode_reward_min": 100.0, "episode_reward_mean": 558.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -205.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 55.89}, "custom_metrics": {}, "hist_stats": {"episode_reward": [420.0, 790.0, 470.0, 570.0, 540.0, 560.0, 915.0, 400.0, 640.0, 655.0, 350.0, 160.0, 730.0, 650.0, 1145.0, 585.0, 560.0, 460.0, 250.0, 620.0, 620.0, 190.0, 120.0, 310.0, 240.0, 335.0, 340.0, 1060.0, 1020.0, 595.0, 420.0, 870.0, 570.0, 350.0, 730.0, 420.0, 220.0, 570.0, 615.0, 450.0, 500.0, 445.0, 630.0, 250.0, 500.0, 710.0, 860.0, 510.0, 550.0, 1075.0, 830.0, 250.0, 1060.0, 520.0, 750.0, 470.0, 260.0, 730.0, 1050.0, 440.0, 375.0, 810.0, 320.0, 430.0, 450.0, 310.0, 850.0, 625.0, 100.0, 425.0, 550.0, 290.0, 440.0, 660.0, 510.0, 1050.0, 1360.0, 725.0, 260.0, 260.0, 140.0, 280.0, 820.0, 330.0, 680.0, 380.0, 1030.0, 130.0, 740.0, 380.0, 300.0, 980.0, 515.0, 830.0, 930.0, 480.0, 590.0, 600.0, 730.0, 320.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 20.0, 110.0, 0.0, 180.0, 30.0, 30.0, 0.0, 20.0, 10.0, 90.0, 20.0, 30.0, 350.0, 0.0, 80.0, 60.0, 120.0, 20.0, 20.0, 50.0, 20.0, 30.0, 150.0, 40.0, 30.0, 20.0, 100.0, 30.0, 0.0, 180.0, 0.0, 30.0, 160.0, 50.0, 10.0, 40.0, 0.0, 60.0, 40.0, 170.0, 130.0, 20.0, 40.0, -100.0, 160.0, 10.0, 50.0, 40.0, 20.0, 180.0, 0.0, 0.0, 120.0, 50.0, 50.0, 10.0, 60.0, 50.0, 40.0, 40.0, 255.0, -10.0, 70.0, 70.0, 10.0, 90.0, 210.0, 180.0, 0.0, 30.0, 60.0, 20.0, 20.0, 20.0, 10.0, 70.0, 20.0, 150.0, 0.0, 30.0, 380.0, 0.0, 40.0, 0.0, 30.0, 30.0, 30.0, 60.0, 40.0, 20.0, 210.0, 10.0, 120.0, 250.0, -165.0, -30.0, -50.0, -180.0, 470.0, 10.0, 60.0, 60.0, 40.0, 0.0, 0.0, 0.0, 60.0, 60.0, 60.0, 10.0, 20.0, 10.0, 10.0, 30.0, 0.0, 0.0, 80.0, 0.0, 0.0, 20.0, 20.0, 20.0, 360.0, -40.0, 50.0, 80.0, 30.0, 40.0, 150.0, 20.0, 60.0, 10.0, 100.0, 40.0, 30.0, 40.0, 30.0, 290.0, 30.0, 40.0, 50.0, 45.0, 50.0, 110.0, 130.0, 590.0, 20.0, 80.0, 30.0, 170.0, 20.0, 20.0, 70.0, 5.0, 190.0, 30.0, 60.0, 20.0, 0.0, 90.0, 40.0, 20.0, 20.0, 80.0, 70.0, 30.0, 150.0, 70.0, -10.0, 170.0, 80.0, 20.0, 40.0, 0.0, 20.0, 30.0, 70.0, 20.0, 10.0, 20.0, 170.0, 10.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 30.0, 30.0, 70.0, 260.0, -10.0, 30.0, 80.0, 40.0, 70.0, 20.0, -10.0, 30.0, 30.0, 0.0, 260.0, 30.0, 20.0, 90.0, 20.0, 150.0, 20.0, 30.0, 10.0, 0.0, 30.0, 20.0, 20.0, 0.0, 30.0, 30.0, 10.0, 20.0, 0.0, 0.0, 20.0, 30.0, 30.0, 10.0, 0.0, 0.0, 0.0, 10.0, 0.0, 40.0, 0.0, 30.0, 30.0, 10.0, 20.0, 170.0, 20.0, 60.0, 30.0, 10.0, 10.0, 0.0, 40.0, 40.0, 0.0, 30.0, 10.0, 70.0, 5.0, 0.0, 70.0, 30.0, 20.0, 20.0, 110.0, 0.0, 90.0, 0.0, 30.0, 0.0, 10.0, 20.0, 0.0, 20.0, 160.0, 10.0, 10.0, 40.0, 40.0, 180.0, 10.0, 160.0, 550.0, 20.0, 20.0, 30.0, 260.0, 10.0, 20.0, 50.0, 390.0, 60.0, 50.0, 0.0, 80.0, 100.0, -15.0, 20.0, 0.0, 450.0, 60.0, 60.0, -70.0, 70.0, 10.0, 10.0, 35.0, 10.0, 10.0, 30.0, 20.0, 30.0, 25.0, 10.0, 180.0, 70.0, 280.0, 380.0, 20.0, 40.0, -40.0, 30.0, 60.0, 100.0, 0.0, 0.0, 60.0, 30.0, 10.0, 30.0, -15.0, 5.0, 0.0, 50.0, 40.0, 360.0, 10.0, 40.0, 40.0, 10.0, 0.0, 160.0, 50.0, 10.0, 0.0, 30.0, 0.0, 40.0, 260.0, 260.0, 0.0, 10.0, 80.0, 10.0, 30.0, 40.0, 30.0, 80.0, 70.0, 10.0, 0.0, 60.0, 90.0, 0.0, 40.0, 40.0, 30.0, 10.0, 0.0, 0.0, 10.0, 10.0, 50.0, 10.0, 30.0, 70.0, 20.0, 260.0, 60.0, 90.0, 0.0, 20.0, 20.0, 50.0, 40.0, 10.0, -20.0, -70.0, -20.0, 0.0, -55.0, 0.0, 170.0, 470.0, 90.0, 50.0, 10.0, 20.0, 200.0, 40.0, 80.0, 40.0, 0.0, 20.0, 30.0, 10.0, 10.0, 40.0, 10.0, 280.0, 20.0, 0.0, 0.0, 50.0, 90.0, 0.0, 0.0, 50.0, 30.0, 10.0, 10.0, 50.0, 250.0, 30.0, 0.0, 15.0, 70.0, 0.0, 10.0, 20.0, 250.0, 60.0, 0.0, 40.0, 10.0, 170.0, 20.0, 40.0, 20.0, 60.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 10.0, 10.0, 130.0, 10.0, 30.0, 80.0, 50.0, 70.0, 20.0, 90.0, 20.0, 0.0, 90.0, 140.0, 0.0, 290.0, 80.0, 40.0, 40.0, 10.0, 30.0, 50.0, 80.0, 50.0, 470.0, 0.0, 10.0, 140.0, 20.0, 10.0, 50.0, 20.0, 30.0, 90.0, 0.0, 40.0, 10.0, 80.0, 160.0, 30.0, 30.0, 20.0, 0.0, 10.0, 40.0, 150.0, 40.0, 170.0, 10.0, 80.0, 575.0, 180.0, 20.0, 30.0, 80.0, 30.0, 50.0, 20.0, 60.0, 30.0, 0.0, 60.0, 60.0, 170.0, 20.0, 20.0, 350.0, 50.0, 30.0, 70.0, 50.0, 70.0, 20.0, 30.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 10.0, 100.0, 470.0, 0.0, 150.0, -55.0, 270.0, 15.0, 60.0, 40.0, 50.0, 10.0, 0.0, 110.0, 40.0, 250.0, 30.0, 0.0, 20.0, 10.0, 160.0, 45.0, 100.0, -40.0, 45.0, 20.0, -10.0, 10.0, 20.0, 400.0, 0.0, -10.0, 0.0, 360.0, 150.0, 25.0, 30.0, -150.0, 25.0, 40.0, 30.0, 20.0, 20.0, 30.0, 40.0, 0.0, 20.0, 40.0, 30.0, 30.0, 10.0, 80.0, 170.0, 10.0, 0.0, 10.0, 180.0, 10.0, 10.0, 250.0, 70.0, 30.0, 300.0, 10.0, 170.0, 80.0, 40.0, 120.0, 200.0, 30.0, 0.0, 30.0, 0.0, 10.0, 160.0, 10.0, 50.0, 120.0, 40.0, 20.0, 50.0, 30.0, 0.0, 150.0, 20.0, -5.0, 20.0, 20.0, 60.0, 30.0, 30.0, 20.0, 380.0, 190.0, 10.0, 20.0, 50.0, 40.0, 20.0, 50.0, 20.0, 50.0, 10.0, 20.0, 40.0, 100.0, 0.0, 40.0, 10.0, 30.0, 20.0, 60.0, 30.0, 190.0, 20.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 170.0, 30.0, 20.0, 10.0, 150.0, 0.0, 30.0, -130.0, 170.0, 110.0, 60.0, 20.0, 10.0, 40.0, 10.0, 0.0, 40.0, 0.0, 20.0, 30.0, 20.0, 40.0, 50.0, 40.0, 250.0, 50.0, 80.0, 260.0, 30.0, 20.0, 40.0, 20.0, 10.0, 250.0, 40.0, 190.0, 30.0, 10.0, 15.0, 0.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, -60.0, -30.0, 20.0, 110.0, 150.0, -15.0, 20.0, 50.0, 180.0, 0.0, 30.0, 50.0, 0.0, 170.0, 30.0, 40.0, 50.0, 80.0, 50.0, 50.0, 80.0, 20.0, 0.0, 80.0, 0.0, 30.0, 10.0, 30.0, 20.0, 20.0, -5.0, 260.0, 0.0, 40.0, 25.0, 10.0, 20.0, 40.0, 10.0, 40.0, 210.0, 190.0, 40.0, 20.0, 0.0, 40.0, 40.0, 60.0, 0.0, 60.0, 40.0, 70.0, 60.0, 40.0, 20.0, 50.0, 40.0, 110.0, 0.0, 80.0, 70.0, 360.0, 160.0, 30.0, 160.0, 60.0, 20.0, 70.0, 80.0, 40.0, 60.0, 20.0, 760.0, 240.0, 30.0, 30.0, 210.0, 0.0, 10.0, 0.0, 50.0, 10.0, 50.0, 60.0, 80.0, 50.0, 20.0, 10.0, 40.0, 355.0, 10.0, 40.0, 0.0, 0.0, 0.0, 0.0, 180.0, 0.0, 30.0, 0.0, 40.0, 40.0, 20.0, 70.0, 10.0, 0.0, 10.0, 40.0, 20.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 20.0, 50.0, 30.0, 0.0, 0.0, 30.0, 20.0, 30.0, 10.0, 130.0, 0.0, 0.0, 20.0, 20.0, 20.0, 0.0, 0.0, 80.0, 60.0, 20.0, -10.0, 20.0, 30.0, 250.0, 370.0, 40.0, 70.0, 70.0, 40.0, 20.0, 20.0, 10.0, 20.0, 0.0, 40.0, 0.0, -20.0, 100.0, 320.0, 10.0, 190.0, 0.0, 30.0, 10.0, 40.0, 250.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 30.0, 50.0, 0.0, 10.0, 20.0, 80.0, 40.0, 70.0, 70.0, 130.0, 560.0, 30.0, 20.0, 40.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 50.0, 40.0, 60.0, 350.0, 0.0, 140.0, 70.0, 40.0, 10.0, 30.0, 0.0, 20.0, 20.0, 20.0, 0.0, 20.0, 20.0, 10.0, 80.0, 150.0, 40.0, 40.0, -45.0, 180.0, 20.0, 10.0, 10.0, -15.0, 40.0, 30.0, 30.0, -50.0, 50.0, 0.0, 660.0, 40.0, 60.0, 60.0, 150.0, 40.0, -30.0, -40.0, 170.0, -40.0, -20.0, 40.0, 710.0, -170.0, -40.0, -205.0, 110.0, 370.0, 30.0, 20.0, 160.0, 40.0, 20.0, 50.0, 50.0, 40.0, 50.0, 170.0, 210.0, 40.0, 30.0, 50.0, 40.0, 30.0, 0.0, 350.0, 10.0, 10.0, 0.0, 30.0, 40.0, 40.0, 170.0, 40.0, 60.0, 40.0, 50.0, 30.0, 40.0, 10.0, 30.0, 0.0, 20.0, 180.0, 0.0, 10.0, 270.0, 20.0, 0.0, 20.0, 150.0, 170.0, 160.0, 20.0, 20.0, 40.0, 0.0, 60.0, 20.0, 40.0, 300.0, 40.0, 130.0, 30.0, 30.0, 50.0, 30.0, 0.0, 0.0, 0.0, 200.0, 40.0, 30.0, 10.0, 0.0, 0.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5999114400401067, "mean_inference_ms": 1.801251811329758, "mean_action_processing_ms": 0.46797712962162813, "mean_env_wait_ms": 1.4408956929230081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05647635459899902, "StateBufferConnector_ms": 0.009441852569580078, "ViewRequirementAgentConnector_ms": 0.4037179946899414}, "num_episodes": 22, "episode_return_max": 1360.0, "episode_return_min": 100.0, "episode_return_mean": 558.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.32905279947661, "num_env_steps_trained_throughput_per_sec": 36.32905279947661, "timesteps_total": 172000, "num_env_steps_sampled_lifetime": 172000, "num_agent_steps_sampled_lifetime": 1720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1720000, "timers": {"training_iteration_time_ms": 110302.461, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110302.407, "sample_time_ms": 2414.042, "learn_time_ms": 107868.698, "learn_throughput": 37.082, "synch_weights_time_ms": 11.195}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 1720000, "num_agent_steps_trained": 1720000}, "done": false, "training_iteration": 43, "trial_id": "57140_00000", "date": "2024-06-27_00-38-52", "timestamp": 1719463132, "time_this_iter_s": 110.11469221115112, "time_total_s": 5059.2739107608795, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af43a550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5059.2739107608795, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 15.563461538461537, "ram_util_percent": 78.51666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0638615385475503, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.330938534513195, "policy_loss": -0.0060925429855761964, "vf_loss": 4.3361394807807425, "vf_explained_var": 0.0006036139651736258, "kl": 0.008915963850992949, "entropy": 0.6614584079248329, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 408465.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "env_runners": {"episode_reward_max": 1480.0, "episode_reward_min": 100.0, "episode_reward_mean": 549.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -205.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 54.96}, "custom_metrics": {}, "hist_stats": {"episode_reward": [310.0, 240.0, 335.0, 340.0, 1060.0, 1020.0, 595.0, 420.0, 870.0, 570.0, 350.0, 730.0, 420.0, 220.0, 570.0, 615.0, 450.0, 500.0, 445.0, 630.0, 250.0, 500.0, 710.0, 860.0, 510.0, 550.0, 1075.0, 830.0, 250.0, 1060.0, 520.0, 750.0, 470.0, 260.0, 730.0, 1050.0, 440.0, 375.0, 810.0, 320.0, 430.0, 450.0, 310.0, 850.0, 625.0, 100.0, 425.0, 550.0, 290.0, 440.0, 660.0, 510.0, 1050.0, 1360.0, 725.0, 260.0, 260.0, 140.0, 280.0, 820.0, 330.0, 680.0, 380.0, 1030.0, 130.0, 740.0, 380.0, 300.0, 980.0, 515.0, 830.0, 930.0, 480.0, 590.0, 600.0, 730.0, 320.0, 230.0, 250.0, 500.0, 230.0, 250.0, 840.0, 720.0, 630.0, 530.0, 715.0, 1480.0, 710.0, 285.0, 550.0, 270.0, 450.0, 635.0, 310.0, 340.0, 495.0, 220.0, 630.0, 200.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 10.0, 0.0, 40.0, 0.0, 30.0, 30.0, 10.0, 20.0, 170.0, 20.0, 60.0, 30.0, 10.0, 10.0, 0.0, 40.0, 40.0, 0.0, 30.0, 10.0, 70.0, 5.0, 0.0, 70.0, 30.0, 20.0, 20.0, 110.0, 0.0, 90.0, 0.0, 30.0, 0.0, 10.0, 20.0, 0.0, 20.0, 160.0, 10.0, 10.0, 40.0, 40.0, 180.0, 10.0, 160.0, 550.0, 20.0, 20.0, 30.0, 260.0, 10.0, 20.0, 50.0, 390.0, 60.0, 50.0, 0.0, 80.0, 100.0, -15.0, 20.0, 0.0, 450.0, 60.0, 60.0, -70.0, 70.0, 10.0, 10.0, 35.0, 10.0, 10.0, 30.0, 20.0, 30.0, 25.0, 10.0, 180.0, 70.0, 280.0, 380.0, 20.0, 40.0, -40.0, 30.0, 60.0, 100.0, 0.0, 0.0, 60.0, 30.0, 10.0, 30.0, -15.0, 5.0, 0.0, 50.0, 40.0, 360.0, 10.0, 40.0, 40.0, 10.0, 0.0, 160.0, 50.0, 10.0, 0.0, 30.0, 0.0, 40.0, 260.0, 260.0, 0.0, 10.0, 80.0, 10.0, 30.0, 40.0, 30.0, 80.0, 70.0, 10.0, 0.0, 60.0, 90.0, 0.0, 40.0, 40.0, 30.0, 10.0, 0.0, 0.0, 10.0, 10.0, 50.0, 10.0, 30.0, 70.0, 20.0, 260.0, 60.0, 90.0, 0.0, 20.0, 20.0, 50.0, 40.0, 10.0, -20.0, -70.0, -20.0, 0.0, -55.0, 0.0, 170.0, 470.0, 90.0, 50.0, 10.0, 20.0, 200.0, 40.0, 80.0, 40.0, 0.0, 20.0, 30.0, 10.0, 10.0, 40.0, 10.0, 280.0, 20.0, 0.0, 0.0, 50.0, 90.0, 0.0, 0.0, 50.0, 30.0, 10.0, 10.0, 50.0, 250.0, 30.0, 0.0, 15.0, 70.0, 0.0, 10.0, 20.0, 250.0, 60.0, 0.0, 40.0, 10.0, 170.0, 20.0, 40.0, 20.0, 60.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 10.0, 10.0, 130.0, 10.0, 30.0, 80.0, 50.0, 70.0, 20.0, 90.0, 20.0, 0.0, 90.0, 140.0, 0.0, 290.0, 80.0, 40.0, 40.0, 10.0, 30.0, 50.0, 80.0, 50.0, 470.0, 0.0, 10.0, 140.0, 20.0, 10.0, 50.0, 20.0, 30.0, 90.0, 0.0, 40.0, 10.0, 80.0, 160.0, 30.0, 30.0, 20.0, 0.0, 10.0, 40.0, 150.0, 40.0, 170.0, 10.0, 80.0, 575.0, 180.0, 20.0, 30.0, 80.0, 30.0, 50.0, 20.0, 60.0, 30.0, 0.0, 60.0, 60.0, 170.0, 20.0, 20.0, 350.0, 50.0, 30.0, 70.0, 50.0, 70.0, 20.0, 30.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 10.0, 100.0, 470.0, 0.0, 150.0, -55.0, 270.0, 15.0, 60.0, 40.0, 50.0, 10.0, 0.0, 110.0, 40.0, 250.0, 30.0, 0.0, 20.0, 10.0, 160.0, 45.0, 100.0, -40.0, 45.0, 20.0, -10.0, 10.0, 20.0, 400.0, 0.0, -10.0, 0.0, 360.0, 150.0, 25.0, 30.0, -150.0, 25.0, 40.0, 30.0, 20.0, 20.0, 30.0, 40.0, 0.0, 20.0, 40.0, 30.0, 30.0, 10.0, 80.0, 170.0, 10.0, 0.0, 10.0, 180.0, 10.0, 10.0, 250.0, 70.0, 30.0, 300.0, 10.0, 170.0, 80.0, 40.0, 120.0, 200.0, 30.0, 0.0, 30.0, 0.0, 10.0, 160.0, 10.0, 50.0, 120.0, 40.0, 20.0, 50.0, 30.0, 0.0, 150.0, 20.0, -5.0, 20.0, 20.0, 60.0, 30.0, 30.0, 20.0, 380.0, 190.0, 10.0, 20.0, 50.0, 40.0, 20.0, 50.0, 20.0, 50.0, 10.0, 20.0, 40.0, 100.0, 0.0, 40.0, 10.0, 30.0, 20.0, 60.0, 30.0, 190.0, 20.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 170.0, 30.0, 20.0, 10.0, 150.0, 0.0, 30.0, -130.0, 170.0, 110.0, 60.0, 20.0, 10.0, 40.0, 10.0, 0.0, 40.0, 0.0, 20.0, 30.0, 20.0, 40.0, 50.0, 40.0, 250.0, 50.0, 80.0, 260.0, 30.0, 20.0, 40.0, 20.0, 10.0, 250.0, 40.0, 190.0, 30.0, 10.0, 15.0, 0.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, -60.0, -30.0, 20.0, 110.0, 150.0, -15.0, 20.0, 50.0, 180.0, 0.0, 30.0, 50.0, 0.0, 170.0, 30.0, 40.0, 50.0, 80.0, 50.0, 50.0, 80.0, 20.0, 0.0, 80.0, 0.0, 30.0, 10.0, 30.0, 20.0, 20.0, -5.0, 260.0, 0.0, 40.0, 25.0, 10.0, 20.0, 40.0, 10.0, 40.0, 210.0, 190.0, 40.0, 20.0, 0.0, 40.0, 40.0, 60.0, 0.0, 60.0, 40.0, 70.0, 60.0, 40.0, 20.0, 50.0, 40.0, 110.0, 0.0, 80.0, 70.0, 360.0, 160.0, 30.0, 160.0, 60.0, 20.0, 70.0, 80.0, 40.0, 60.0, 20.0, 760.0, 240.0, 30.0, 30.0, 210.0, 0.0, 10.0, 0.0, 50.0, 10.0, 50.0, 60.0, 80.0, 50.0, 20.0, 10.0, 40.0, 355.0, 10.0, 40.0, 0.0, 0.0, 0.0, 0.0, 180.0, 0.0, 30.0, 0.0, 40.0, 40.0, 20.0, 70.0, 10.0, 0.0, 10.0, 40.0, 20.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 20.0, 50.0, 30.0, 0.0, 0.0, 30.0, 20.0, 30.0, 10.0, 130.0, 0.0, 0.0, 20.0, 20.0, 20.0, 0.0, 0.0, 80.0, 60.0, 20.0, -10.0, 20.0, 30.0, 250.0, 370.0, 40.0, 70.0, 70.0, 40.0, 20.0, 20.0, 10.0, 20.0, 0.0, 40.0, 0.0, -20.0, 100.0, 320.0, 10.0, 190.0, 0.0, 30.0, 10.0, 40.0, 250.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 30.0, 50.0, 0.0, 10.0, 20.0, 80.0, 40.0, 70.0, 70.0, 130.0, 560.0, 30.0, 20.0, 40.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 50.0, 40.0, 60.0, 350.0, 0.0, 140.0, 70.0, 40.0, 10.0, 30.0, 0.0, 20.0, 20.0, 20.0, 0.0, 20.0, 20.0, 10.0, 80.0, 150.0, 40.0, 40.0, -45.0, 180.0, 20.0, 10.0, 10.0, -15.0, 40.0, 30.0, 30.0, -50.0, 50.0, 0.0, 660.0, 40.0, 60.0, 60.0, 150.0, 40.0, -30.0, -40.0, 170.0, -40.0, -20.0, 40.0, 710.0, -170.0, -40.0, -205.0, 110.0, 370.0, 30.0, 20.0, 160.0, 40.0, 20.0, 50.0, 50.0, 40.0, 50.0, 170.0, 210.0, 40.0, 30.0, 50.0, 40.0, 30.0, 0.0, 350.0, 10.0, 10.0, 0.0, 30.0, 40.0, 40.0, 170.0, 40.0, 60.0, 40.0, 50.0, 30.0, 40.0, 10.0, 30.0, 0.0, 20.0, 180.0, 0.0, 10.0, 270.0, 20.0, 0.0, 20.0, 150.0, 170.0, 160.0, 20.0, 20.0, 40.0, 0.0, 60.0, 20.0, 40.0, 300.0, 40.0, 130.0, 30.0, 30.0, 50.0, 30.0, 0.0, 0.0, 0.0, 200.0, 40.0, 30.0, 10.0, 0.0, 0.0, 40.0, 30.0, -20.0, 70.0, 0.0, 20.0, 50.0, 10.0, 10.0, 40.0, 20.0, 80.0, 0.0, 10.0, 0.0, 30.0, 0.0, 40.0, 30.0, 40.0, 20.0, 10.0, 20.0, 20.0, 30.0, 30.0, 60.0, 90.0, 30.0, 30.0, 180.0, 0.0, 10.0, 60.0, 40.0, 110.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 20.0, 20.0, 20.0, 10.0, 20.0, 120.0, 150.0, 30.0, 30.0, 60.0, 80.0, 0.0, 190.0, 10.0, 200.0, 90.0, 260.0, 10.0, 170.0, 10.0, 30.0, 50.0, 180.0, 10.0, 20.0, -20.0, 100.0, 50.0, 20.0, 50.0, 250.0, 0.0, 70.0, 0.0, 60.0, 30.0, 120.0, 0.0, 20.0, 30.0, 20.0, 190.0, 40.0, 50.0, 10.0, 50.0, 40.0, 0.0, 80.0, 5.0, 50.0, 30.0, 100.0, 0.0, 370.0, 40.0, 80.0, 90.0, -20.0, 60.0, 280.0, 40.0, 130.0, 40.0, 390.0, 390.0, 50.0, 360.0, 0.0, 70.0, 60.0, 30.0, 80.0, 40.0, 0.0, 20.0, 0.0, 10.0, 20.0, 70.0, 0.0, 60.0, 15.0, 0.0, 90.0, 20.0, 150.0, 20.0, 70.0, 10.0, 70.0, 80.0, 10.0, 60.0, 10.0, 70.0, 20.0, 30.0, 0.0, 30.0, 90.0, 20.0, 20.0, 20.0, 0.0, 40.0, 300.0, 60.0, 30.0, 30.0, 20.0, -50.0, 0.0, 0.0, 60.0, 0.0, 0.0, 100.0, 0.0, 270.0, 160.0, 20.0, -60.0, -5.0, 60.0, 90.0, 120.0, 10.0, 60.0, 20.0, 0.0, 60.0, 20.0, 5.0, 15.0, 0.0, 40.0, 20.0, 30.0, 20.0, 10.0, 10.0, 70.0, 20.0, 70.0, 50.0, 20.0, 0.0, 150.0, 190.0, -5.0, 20.0, 20.0, 50.0, 0.0, 50.0, 10.0, 40.0, 10.0, 20.0, 10.0, 30.0, 30.0, 30.0, 20.0, 20.0, 50.0, 30.0, 0.0, 20.0, 30.0, 90.0, 0.0, 20.0, 360.0, 30.0, 30.0, 20.0, 0.0, 0.0, 0.0, 60.0, 40.0, 30.0, 20.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5917796684600527, "mean_inference_ms": 1.793480709433994, "mean_action_processing_ms": 0.4657277604645253, "mean_env_wait_ms": 1.4349370420394587, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0564725399017334, "StateBufferConnector_ms": 0.009562492370605469, "ViewRequirementAgentConnector_ms": 0.39068126678466797}, "num_episodes": 23, "episode_return_max": 1480.0, "episode_return_min": 100.0, "episode_return_mean": 549.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.30608059488629, "num_env_steps_trained_throughput_per_sec": 36.30608059488629, "timesteps_total": 176000, "num_env_steps_sampled_lifetime": 176000, "num_agent_steps_sampled_lifetime": 1760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1760000, "timers": {"training_iteration_time_ms": 110344.025, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110343.97, "sample_time_ms": 2413.542, "learn_time_ms": 107910.829, "learn_throughput": 37.068, "synch_weights_time_ms": 11.193}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 1760000, "num_agent_steps_trained": 1760000}, "done": false, "training_iteration": 44, "trial_id": "57140_00000", "date": "2024-06-27_00-40-43", "timestamp": 1719463243, "time_this_iter_s": 110.1881012916565, "time_total_s": 5169.462012052536, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af408280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5169.462012052536, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 15.440384615384614, "ram_util_percent": 78.65833333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6565515872547294, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.776854054310832, "policy_loss": -0.005351473157543538, "vf_loss": 3.7814006451219795, "vf_explained_var": 0.0007930400907295073, "kl": 0.008048855221366216, "entropy": 0.7248873435651152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 417855.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "env_runners": {"episode_reward_max": 1480.0, "episode_reward_min": 100.0, "episode_reward_mean": 538.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -290.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 53.865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [445.0, 630.0, 250.0, 500.0, 710.0, 860.0, 510.0, 550.0, 1075.0, 830.0, 250.0, 1060.0, 520.0, 750.0, 470.0, 260.0, 730.0, 1050.0, 440.0, 375.0, 810.0, 320.0, 430.0, 450.0, 310.0, 850.0, 625.0, 100.0, 425.0, 550.0, 290.0, 440.0, 660.0, 510.0, 1050.0, 1360.0, 725.0, 260.0, 260.0, 140.0, 280.0, 820.0, 330.0, 680.0, 380.0, 1030.0, 130.0, 740.0, 380.0, 300.0, 980.0, 515.0, 830.0, 930.0, 480.0, 590.0, 600.0, 730.0, 320.0, 230.0, 250.0, 500.0, 230.0, 250.0, 840.0, 720.0, 630.0, 530.0, 715.0, 1480.0, 710.0, 285.0, 550.0, 270.0, 450.0, 635.0, 310.0, 340.0, 495.0, 220.0, 630.0, 200.0, 690.0, 360.0, 450.0, 100.0, 500.0, 360.0, 340.0, 710.0, 590.0, 180.0, 600.0, 290.0, 590.0, 350.0, 190.0, 1030.0, 280.0, 910.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 50.0, 30.0, 10.0, 10.0, 50.0, 250.0, 30.0, 0.0, 15.0, 70.0, 0.0, 10.0, 20.0, 250.0, 60.0, 0.0, 40.0, 10.0, 170.0, 20.0, 40.0, 20.0, 60.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 10.0, 10.0, 130.0, 10.0, 30.0, 80.0, 50.0, 70.0, 20.0, 90.0, 20.0, 0.0, 90.0, 140.0, 0.0, 290.0, 80.0, 40.0, 40.0, 10.0, 30.0, 50.0, 80.0, 50.0, 470.0, 0.0, 10.0, 140.0, 20.0, 10.0, 50.0, 20.0, 30.0, 90.0, 0.0, 40.0, 10.0, 80.0, 160.0, 30.0, 30.0, 20.0, 0.0, 10.0, 40.0, 150.0, 40.0, 170.0, 10.0, 80.0, 575.0, 180.0, 20.0, 30.0, 80.0, 30.0, 50.0, 20.0, 60.0, 30.0, 0.0, 60.0, 60.0, 170.0, 20.0, 20.0, 350.0, 50.0, 30.0, 70.0, 50.0, 70.0, 20.0, 30.0, 10.0, 0.0, 30.0, 10.0, 20.0, 10.0, 10.0, 100.0, 470.0, 0.0, 150.0, -55.0, 270.0, 15.0, 60.0, 40.0, 50.0, 10.0, 0.0, 110.0, 40.0, 250.0, 30.0, 0.0, 20.0, 10.0, 160.0, 45.0, 100.0, -40.0, 45.0, 20.0, -10.0, 10.0, 20.0, 400.0, 0.0, -10.0, 0.0, 360.0, 150.0, 25.0, 30.0, -150.0, 25.0, 40.0, 30.0, 20.0, 20.0, 30.0, 40.0, 0.0, 20.0, 40.0, 30.0, 30.0, 10.0, 80.0, 170.0, 10.0, 0.0, 10.0, 180.0, 10.0, 10.0, 250.0, 70.0, 30.0, 300.0, 10.0, 170.0, 80.0, 40.0, 120.0, 200.0, 30.0, 0.0, 30.0, 0.0, 10.0, 160.0, 10.0, 50.0, 120.0, 40.0, 20.0, 50.0, 30.0, 0.0, 150.0, 20.0, -5.0, 20.0, 20.0, 60.0, 30.0, 30.0, 20.0, 380.0, 190.0, 10.0, 20.0, 50.0, 40.0, 20.0, 50.0, 20.0, 50.0, 10.0, 20.0, 40.0, 100.0, 0.0, 40.0, 10.0, 30.0, 20.0, 60.0, 30.0, 190.0, 20.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 170.0, 30.0, 20.0, 10.0, 150.0, 0.0, 30.0, -130.0, 170.0, 110.0, 60.0, 20.0, 10.0, 40.0, 10.0, 0.0, 40.0, 0.0, 20.0, 30.0, 20.0, 40.0, 50.0, 40.0, 250.0, 50.0, 80.0, 260.0, 30.0, 20.0, 40.0, 20.0, 10.0, 250.0, 40.0, 190.0, 30.0, 10.0, 15.0, 0.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, -60.0, -30.0, 20.0, 110.0, 150.0, -15.0, 20.0, 50.0, 180.0, 0.0, 30.0, 50.0, 0.0, 170.0, 30.0, 40.0, 50.0, 80.0, 50.0, 50.0, 80.0, 20.0, 0.0, 80.0, 0.0, 30.0, 10.0, 30.0, 20.0, 20.0, -5.0, 260.0, 0.0, 40.0, 25.0, 10.0, 20.0, 40.0, 10.0, 40.0, 210.0, 190.0, 40.0, 20.0, 0.0, 40.0, 40.0, 60.0, 0.0, 60.0, 40.0, 70.0, 60.0, 40.0, 20.0, 50.0, 40.0, 110.0, 0.0, 80.0, 70.0, 360.0, 160.0, 30.0, 160.0, 60.0, 20.0, 70.0, 80.0, 40.0, 60.0, 20.0, 760.0, 240.0, 30.0, 30.0, 210.0, 0.0, 10.0, 0.0, 50.0, 10.0, 50.0, 60.0, 80.0, 50.0, 20.0, 10.0, 40.0, 355.0, 10.0, 40.0, 0.0, 0.0, 0.0, 0.0, 180.0, 0.0, 30.0, 0.0, 40.0, 40.0, 20.0, 70.0, 10.0, 0.0, 10.0, 40.0, 20.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 20.0, 50.0, 30.0, 0.0, 0.0, 30.0, 20.0, 30.0, 10.0, 130.0, 0.0, 0.0, 20.0, 20.0, 20.0, 0.0, 0.0, 80.0, 60.0, 20.0, -10.0, 20.0, 30.0, 250.0, 370.0, 40.0, 70.0, 70.0, 40.0, 20.0, 20.0, 10.0, 20.0, 0.0, 40.0, 0.0, -20.0, 100.0, 320.0, 10.0, 190.0, 0.0, 30.0, 10.0, 40.0, 250.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 30.0, 50.0, 0.0, 10.0, 20.0, 80.0, 40.0, 70.0, 70.0, 130.0, 560.0, 30.0, 20.0, 40.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 50.0, 40.0, 60.0, 350.0, 0.0, 140.0, 70.0, 40.0, 10.0, 30.0, 0.0, 20.0, 20.0, 20.0, 0.0, 20.0, 20.0, 10.0, 80.0, 150.0, 40.0, 40.0, -45.0, 180.0, 20.0, 10.0, 10.0, -15.0, 40.0, 30.0, 30.0, -50.0, 50.0, 0.0, 660.0, 40.0, 60.0, 60.0, 150.0, 40.0, -30.0, -40.0, 170.0, -40.0, -20.0, 40.0, 710.0, -170.0, -40.0, -205.0, 110.0, 370.0, 30.0, 20.0, 160.0, 40.0, 20.0, 50.0, 50.0, 40.0, 50.0, 170.0, 210.0, 40.0, 30.0, 50.0, 40.0, 30.0, 0.0, 350.0, 10.0, 10.0, 0.0, 30.0, 40.0, 40.0, 170.0, 40.0, 60.0, 40.0, 50.0, 30.0, 40.0, 10.0, 30.0, 0.0, 20.0, 180.0, 0.0, 10.0, 270.0, 20.0, 0.0, 20.0, 150.0, 170.0, 160.0, 20.0, 20.0, 40.0, 0.0, 60.0, 20.0, 40.0, 300.0, 40.0, 130.0, 30.0, 30.0, 50.0, 30.0, 0.0, 0.0, 0.0, 200.0, 40.0, 30.0, 10.0, 0.0, 0.0, 40.0, 30.0, -20.0, 70.0, 0.0, 20.0, 50.0, 10.0, 10.0, 40.0, 20.0, 80.0, 0.0, 10.0, 0.0, 30.0, 0.0, 40.0, 30.0, 40.0, 20.0, 10.0, 20.0, 20.0, 30.0, 30.0, 60.0, 90.0, 30.0, 30.0, 180.0, 0.0, 10.0, 60.0, 40.0, 110.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 20.0, 20.0, 20.0, 10.0, 20.0, 120.0, 150.0, 30.0, 30.0, 60.0, 80.0, 0.0, 190.0, 10.0, 200.0, 90.0, 260.0, 10.0, 170.0, 10.0, 30.0, 50.0, 180.0, 10.0, 20.0, -20.0, 100.0, 50.0, 20.0, 50.0, 250.0, 0.0, 70.0, 0.0, 60.0, 30.0, 120.0, 0.0, 20.0, 30.0, 20.0, 190.0, 40.0, 50.0, 10.0, 50.0, 40.0, 0.0, 80.0, 5.0, 50.0, 30.0, 100.0, 0.0, 370.0, 40.0, 80.0, 90.0, -20.0, 60.0, 280.0, 40.0, 130.0, 40.0, 390.0, 390.0, 50.0, 360.0, 0.0, 70.0, 60.0, 30.0, 80.0, 40.0, 0.0, 20.0, 0.0, 10.0, 20.0, 70.0, 0.0, 60.0, 15.0, 0.0, 90.0, 20.0, 150.0, 20.0, 70.0, 10.0, 70.0, 80.0, 10.0, 60.0, 10.0, 70.0, 20.0, 30.0, 0.0, 30.0, 90.0, 20.0, 20.0, 20.0, 0.0, 40.0, 300.0, 60.0, 30.0, 30.0, 20.0, -50.0, 0.0, 0.0, 60.0, 0.0, 0.0, 100.0, 0.0, 270.0, 160.0, 20.0, -60.0, -5.0, 60.0, 90.0, 120.0, 10.0, 60.0, 20.0, 0.0, 60.0, 20.0, 5.0, 15.0, 0.0, 40.0, 20.0, 30.0, 20.0, 10.0, 10.0, 70.0, 20.0, 70.0, 50.0, 20.0, 0.0, 150.0, 190.0, -5.0, 20.0, 20.0, 50.0, 0.0, 50.0, 10.0, 40.0, 10.0, 20.0, 10.0, 30.0, 30.0, 30.0, 20.0, 20.0, 50.0, 30.0, 0.0, 20.0, 30.0, 90.0, 0.0, 20.0, 360.0, 30.0, 30.0, 20.0, 0.0, 0.0, 0.0, 60.0, 40.0, 30.0, 20.0, 0.0, 20.0, 0.0, 180.0, 230.0, -30.0, 180.0, 60.0, 10.0, 10.0, 30.0, 50.0, 30.0, 10.0, 0.0, 40.0, 20.0, 10.0, 20.0, 40.0, 140.0, 470.0, -290.0, 70.0, 40.0, -30.0, 80.0, 40.0, 70.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 60.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 60.0, 0.0, 70.0, 40.0, 30.0, 80.0, 150.0, 50.0, 30.0, 30.0, 0.0, 20.0, 40.0, 0.0, 40.0, 150.0, 10.0, 40.0, 0.0, 10.0, 0.0, 160.0, 40.0, 0.0, 20.0, 40.0, 60.0, 10.0, 150.0, 0.0, 0.0, 20.0, 150.0, 160.0, 40.0, 90.0, 60.0, 40.0, 90.0, 270.0, 10.0, 60.0, 60.0, 30.0, 0.0, 40.0, 20.0, 10.0, 10.0, 30.0, 30.0, 0.0, 20.0, 10.0, 40.0, 0.0, 30.0, 10.0, 0.0, 90.0, 80.0, 10.0, 20.0, 150.0, 10.0, 200.0, 20.0, 20.0, 30.0, 0.0, 30.0, 150.0, 0.0, 0.0, 20.0, 20.0, 10.0, 30.0, 30.0, 30.0, 20.0, 0.0, 470.0, 20.0, 0.0, -20.0, 30.0, 10.0, 50.0, 10.0, 130.0, 0.0, 20.0, 40.0, 20.0, 0.0, 50.0, 30.0, 30.0, 10.0, 0.0, 30.0, 20.0, 20.0, 40.0, 30.0, 10.0, 0.0, -10.0, 50.0, 20.0, 590.0, 30.0, 30.0, 40.0, 90.0, 170.0, 20.0, 30.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 40.0, 60.0, 50.0, 380.0, -20.0, 30.0, 10.0, 60.0, 370.0, 40.0, 60.0, -50.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5857560514860205, "mean_inference_ms": 1.7877738550403963, "mean_action_processing_ms": 0.4640457582653129, "mean_env_wait_ms": 1.4304876401112336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05659961700439453, "StateBufferConnector_ms": 0.009550333023071289, "ViewRequirementAgentConnector_ms": 0.39037203788757324}, "num_episodes": 18, "episode_return_max": 1480.0, "episode_return_min": 100.0, "episode_return_mean": 538.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.13551937179102, "num_env_steps_trained_throughput_per_sec": 36.13551937179102, "timesteps_total": 180000, "num_env_steps_sampled_lifetime": 180000, "num_agent_steps_sampled_lifetime": 1800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1800000, "timers": {"training_iteration_time_ms": 110378.152, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110378.098, "sample_time_ms": 2406.865, "learn_time_ms": 107951.665, "learn_throughput": 37.054, "synch_weights_time_ms": 11.239}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 1800000, "num_agent_steps_trained": 1800000}, "done": false, "training_iteration": 45, "trial_id": "57140_00000", "date": "2024-06-27_00-42-33", "timestamp": 1719463353, "time_this_iter_s": 110.70835900306702, "time_total_s": 5280.170371055603, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3eaf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5280.170371055603, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 16.64871794871795, "ram_util_percent": 79.34935897435898}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.851268768307373, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.980464904503828, "policy_loss": -0.004759518611091125, "vf_loss": 4.984492425161936, "vf_explained_var": 0.0009281060185295324, "kl": 0.007320023074730733, "entropy": 0.6721016616168748, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 427245.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "env_runners": {"episode_reward_max": 1480.0, "episode_reward_min": -200.0, "episode_reward_mean": 523.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -720.0}, "policy_reward_max": {"policy_0": 880.0}, "policy_reward_mean": {"policy_0": 52.32}, "custom_metrics": {}, "hist_stats": {"episode_reward": [440.0, 375.0, 810.0, 320.0, 430.0, 450.0, 310.0, 850.0, 625.0, 100.0, 425.0, 550.0, 290.0, 440.0, 660.0, 510.0, 1050.0, 1360.0, 725.0, 260.0, 260.0, 140.0, 280.0, 820.0, 330.0, 680.0, 380.0, 1030.0, 130.0, 740.0, 380.0, 300.0, 980.0, 515.0, 830.0, 930.0, 480.0, 590.0, 600.0, 730.0, 320.0, 230.0, 250.0, 500.0, 230.0, 250.0, 840.0, 720.0, 630.0, 530.0, 715.0, 1480.0, 710.0, 285.0, 550.0, 270.0, 450.0, 635.0, 310.0, 340.0, 495.0, 220.0, 630.0, 200.0, 690.0, 360.0, 450.0, 100.0, 500.0, 360.0, 340.0, 710.0, 590.0, 180.0, 600.0, 290.0, 590.0, 350.0, 190.0, 1030.0, 280.0, 910.0, -200.0, 910.0, 330.0, 700.0, 600.0, 965.0, 270.0, 780.0, 780.0, 690.0, 450.0, 550.0, 200.0, 1260.0, 540.0, 320.0, 140.0, 620.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 30.0, 0.0, 10.0, 160.0, 10.0, 50.0, 120.0, 40.0, 20.0, 50.0, 30.0, 0.0, 150.0, 20.0, -5.0, 20.0, 20.0, 60.0, 30.0, 30.0, 20.0, 380.0, 190.0, 10.0, 20.0, 50.0, 40.0, 20.0, 50.0, 20.0, 50.0, 10.0, 20.0, 40.0, 100.0, 0.0, 40.0, 10.0, 30.0, 20.0, 60.0, 30.0, 190.0, 20.0, 30.0, 20.0, 0.0, 30.0, 30.0, 0.0, 170.0, 30.0, 20.0, 10.0, 150.0, 0.0, 30.0, -130.0, 170.0, 110.0, 60.0, 20.0, 10.0, 40.0, 10.0, 0.0, 40.0, 0.0, 20.0, 30.0, 20.0, 40.0, 50.0, 40.0, 250.0, 50.0, 80.0, 260.0, 30.0, 20.0, 40.0, 20.0, 10.0, 250.0, 40.0, 190.0, 30.0, 10.0, 15.0, 0.0, 30.0, 0.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, -60.0, -30.0, 20.0, 110.0, 150.0, -15.0, 20.0, 50.0, 180.0, 0.0, 30.0, 50.0, 0.0, 170.0, 30.0, 40.0, 50.0, 80.0, 50.0, 50.0, 80.0, 20.0, 0.0, 80.0, 0.0, 30.0, 10.0, 30.0, 20.0, 20.0, -5.0, 260.0, 0.0, 40.0, 25.0, 10.0, 20.0, 40.0, 10.0, 40.0, 210.0, 190.0, 40.0, 20.0, 0.0, 40.0, 40.0, 60.0, 0.0, 60.0, 40.0, 70.0, 60.0, 40.0, 20.0, 50.0, 40.0, 110.0, 0.0, 80.0, 70.0, 360.0, 160.0, 30.0, 160.0, 60.0, 20.0, 70.0, 80.0, 40.0, 60.0, 20.0, 760.0, 240.0, 30.0, 30.0, 210.0, 0.0, 10.0, 0.0, 50.0, 10.0, 50.0, 60.0, 80.0, 50.0, 20.0, 10.0, 40.0, 355.0, 10.0, 40.0, 0.0, 0.0, 0.0, 0.0, 180.0, 0.0, 30.0, 0.0, 40.0, 40.0, 20.0, 70.0, 10.0, 0.0, 10.0, 40.0, 20.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 20.0, 50.0, 30.0, 0.0, 0.0, 30.0, 20.0, 30.0, 10.0, 130.0, 0.0, 0.0, 20.0, 20.0, 20.0, 0.0, 0.0, 80.0, 60.0, 20.0, -10.0, 20.0, 30.0, 250.0, 370.0, 40.0, 70.0, 70.0, 40.0, 20.0, 20.0, 10.0, 20.0, 0.0, 40.0, 0.0, -20.0, 100.0, 320.0, 10.0, 190.0, 0.0, 30.0, 10.0, 40.0, 250.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 30.0, 50.0, 0.0, 10.0, 20.0, 80.0, 40.0, 70.0, 70.0, 130.0, 560.0, 30.0, 20.0, 40.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 50.0, 40.0, 60.0, 350.0, 0.0, 140.0, 70.0, 40.0, 10.0, 30.0, 0.0, 20.0, 20.0, 20.0, 0.0, 20.0, 20.0, 10.0, 80.0, 150.0, 40.0, 40.0, -45.0, 180.0, 20.0, 10.0, 10.0, -15.0, 40.0, 30.0, 30.0, -50.0, 50.0, 0.0, 660.0, 40.0, 60.0, 60.0, 150.0, 40.0, -30.0, -40.0, 170.0, -40.0, -20.0, 40.0, 710.0, -170.0, -40.0, -205.0, 110.0, 370.0, 30.0, 20.0, 160.0, 40.0, 20.0, 50.0, 50.0, 40.0, 50.0, 170.0, 210.0, 40.0, 30.0, 50.0, 40.0, 30.0, 0.0, 350.0, 10.0, 10.0, 0.0, 30.0, 40.0, 40.0, 170.0, 40.0, 60.0, 40.0, 50.0, 30.0, 40.0, 10.0, 30.0, 0.0, 20.0, 180.0, 0.0, 10.0, 270.0, 20.0, 0.0, 20.0, 150.0, 170.0, 160.0, 20.0, 20.0, 40.0, 0.0, 60.0, 20.0, 40.0, 300.0, 40.0, 130.0, 30.0, 30.0, 50.0, 30.0, 0.0, 0.0, 0.0, 200.0, 40.0, 30.0, 10.0, 0.0, 0.0, 40.0, 30.0, -20.0, 70.0, 0.0, 20.0, 50.0, 10.0, 10.0, 40.0, 20.0, 80.0, 0.0, 10.0, 0.0, 30.0, 0.0, 40.0, 30.0, 40.0, 20.0, 10.0, 20.0, 20.0, 30.0, 30.0, 60.0, 90.0, 30.0, 30.0, 180.0, 0.0, 10.0, 60.0, 40.0, 110.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 20.0, 20.0, 20.0, 10.0, 20.0, 120.0, 150.0, 30.0, 30.0, 60.0, 80.0, 0.0, 190.0, 10.0, 200.0, 90.0, 260.0, 10.0, 170.0, 10.0, 30.0, 50.0, 180.0, 10.0, 20.0, -20.0, 100.0, 50.0, 20.0, 50.0, 250.0, 0.0, 70.0, 0.0, 60.0, 30.0, 120.0, 0.0, 20.0, 30.0, 20.0, 190.0, 40.0, 50.0, 10.0, 50.0, 40.0, 0.0, 80.0, 5.0, 50.0, 30.0, 100.0, 0.0, 370.0, 40.0, 80.0, 90.0, -20.0, 60.0, 280.0, 40.0, 130.0, 40.0, 390.0, 390.0, 50.0, 360.0, 0.0, 70.0, 60.0, 30.0, 80.0, 40.0, 0.0, 20.0, 0.0, 10.0, 20.0, 70.0, 0.0, 60.0, 15.0, 0.0, 90.0, 20.0, 150.0, 20.0, 70.0, 10.0, 70.0, 80.0, 10.0, 60.0, 10.0, 70.0, 20.0, 30.0, 0.0, 30.0, 90.0, 20.0, 20.0, 20.0, 0.0, 40.0, 300.0, 60.0, 30.0, 30.0, 20.0, -50.0, 0.0, 0.0, 60.0, 0.0, 0.0, 100.0, 0.0, 270.0, 160.0, 20.0, -60.0, -5.0, 60.0, 90.0, 120.0, 10.0, 60.0, 20.0, 0.0, 60.0, 20.0, 5.0, 15.0, 0.0, 40.0, 20.0, 30.0, 20.0, 10.0, 10.0, 70.0, 20.0, 70.0, 50.0, 20.0, 0.0, 150.0, 190.0, -5.0, 20.0, 20.0, 50.0, 0.0, 50.0, 10.0, 40.0, 10.0, 20.0, 10.0, 30.0, 30.0, 30.0, 20.0, 20.0, 50.0, 30.0, 0.0, 20.0, 30.0, 90.0, 0.0, 20.0, 360.0, 30.0, 30.0, 20.0, 0.0, 0.0, 0.0, 60.0, 40.0, 30.0, 20.0, 0.0, 20.0, 0.0, 180.0, 230.0, -30.0, 180.0, 60.0, 10.0, 10.0, 30.0, 50.0, 30.0, 10.0, 0.0, 40.0, 20.0, 10.0, 20.0, 40.0, 140.0, 470.0, -290.0, 70.0, 40.0, -30.0, 80.0, 40.0, 70.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 60.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 60.0, 0.0, 70.0, 40.0, 30.0, 80.0, 150.0, 50.0, 30.0, 30.0, 0.0, 20.0, 40.0, 0.0, 40.0, 150.0, 10.0, 40.0, 0.0, 10.0, 0.0, 160.0, 40.0, 0.0, 20.0, 40.0, 60.0, 10.0, 150.0, 0.0, 0.0, 20.0, 150.0, 160.0, 40.0, 90.0, 60.0, 40.0, 90.0, 270.0, 10.0, 60.0, 60.0, 30.0, 0.0, 40.0, 20.0, 10.0, 10.0, 30.0, 30.0, 0.0, 20.0, 10.0, 40.0, 0.0, 30.0, 10.0, 0.0, 90.0, 80.0, 10.0, 20.0, 150.0, 10.0, 200.0, 20.0, 20.0, 30.0, 0.0, 30.0, 150.0, 0.0, 0.0, 20.0, 20.0, 10.0, 30.0, 30.0, 30.0, 20.0, 0.0, 470.0, 20.0, 0.0, -20.0, 30.0, 10.0, 50.0, 10.0, 130.0, 0.0, 20.0, 40.0, 20.0, 0.0, 50.0, 30.0, 30.0, 10.0, 0.0, 30.0, 20.0, 20.0, 40.0, 30.0, 10.0, 0.0, -10.0, 50.0, 20.0, 590.0, 30.0, 30.0, 40.0, 90.0, 170.0, 20.0, 30.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 40.0, 60.0, 50.0, 380.0, -20.0, 30.0, 10.0, 60.0, 370.0, 40.0, 60.0, -50.0, 30.0, 50.0, -720.0, 30.0, 10.0, 170.0, 10.0, 20.0, 10.0, 30.0, 190.0, 40.0, 60.0, 0.0, 360.0, 70.0, 80.0, 50.0, 80.0, 110.0, 60.0, 20.0, 40.0, 40.0, 40.0, 30.0, 40.0, 20.0, 10.0, 60.0, 30.0, 170.0, 80.0, 30.0, 20.0, 60.0, 40.0, 30.0, 60.0, 130.0, 80.0, 60.0, 30.0, 60.0, 10.0, -40.0, 30.0, 10.0, 40.0, 40.0, 360.0, 20.0, 370.0, 100.0, 35.0, 250.0, 30.0, 50.0, 70.0, 0.0, 40.0, 110.0, 20.0, 30.0, 30.0, 10.0, 0.0, 0.0, 10.0, 10.0, 50.0, 80.0, 100.0, 10.0, 10.0, 180.0, 20.0, 220.0, 60.0, 50.0, 50.0, 40.0, 100.0, 160.0, 20.0, 20.0, 80.0, 10.0, 40.0, 250.0, 60.0, 30.0, 30.0, 30.0, 450.0, 40.0, 10.0, 40.0, 0.0, 30.0, 30.0, 10.0, 30.0, 10.0, 20.0, 0.0, 120.0, 30.0, 180.0, 20.0, 30.0, 70.0, 30.0, 40.0, 70.0, 50.0, 10.0, 40.0, 160.0, 30.0, 50.0, 10.0, 40.0, 40.0, 20.0, 10.0, 20.0, 20.0, 0.0, 40.0, 0.0, 880.0, 40.0, 20.0, 160.0, 60.0, 80.0, 0.0, -30.0, -40.0, 90.0, 70.0, 40.0, 0.0, 0.0, 0.0, 60.0, 20.0, 120.0, 40.0, 190.0, 60.0, 30.0, 20.0, 30.0, 40.0, 40.0, 20.0, 40.0, 0.0, 40.0, 0.0, 30.0, 10.0, 0.0, 0.0, 40.0, 10.0, 0.0, 50.0, 0.0, 40.0, 20.0, 80.0, 10.0, 80.0, 200.0, 40.0, 70.0, 0.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5801885226082621, "mean_inference_ms": 1.7819628124183295, "mean_action_processing_ms": 0.4624049708936322, "mean_env_wait_ms": 1.4262524132391508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06264829635620117, "StateBufferConnector_ms": 0.009484291076660156, "ViewRequirementAgentConnector_ms": 0.38111019134521484}, "num_episodes": 18, "episode_return_max": 1480.0, "episode_return_min": -200.0, "episode_return_mean": 523.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.19912884186358, "num_env_steps_trained_throughput_per_sec": 36.19912884186358, "timesteps_total": 184000, "num_env_steps_sampled_lifetime": 184000, "num_agent_steps_sampled_lifetime": 1840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1840000, "timers": {"training_iteration_time_ms": 110277.692, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110277.638, "sample_time_ms": 2411.609, "learn_time_ms": 107846.513, "learn_throughput": 37.09, "synch_weights_time_ms": 11.432}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 1840000, "num_agent_steps_trained": 1840000}, "done": false, "training_iteration": 46, "trial_id": "57140_00000", "date": "2024-06-27_00-44-24", "timestamp": 1719463464, "time_this_iter_s": 110.5048041343689, "time_total_s": 5390.675175189972, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3e69d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5390.675175189972, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 15.511538461538462, "ram_util_percent": 78.78589743589745}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.033456672901036, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.1253443197701305, "policy_loss": -0.005338706418683929, "vf_loss": 4.129876975129587, "vf_explained_var": 0.0014817451389706807, "kl": 0.008060473803034226, "entropy": 0.6584867049710819, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 436635.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000}, "env_runners": {"episode_reward_max": 1480.0, "episode_reward_min": -200.0, "episode_reward_mean": 533.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -720.0}, "policy_reward_max": {"policy_0": 880.0}, "policy_reward_mean": {"policy_0": 53.365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.0, 820.0, 330.0, 680.0, 380.0, 1030.0, 130.0, 740.0, 380.0, 300.0, 980.0, 515.0, 830.0, 930.0, 480.0, 590.0, 600.0, 730.0, 320.0, 230.0, 250.0, 500.0, 230.0, 250.0, 840.0, 720.0, 630.0, 530.0, 715.0, 1480.0, 710.0, 285.0, 550.0, 270.0, 450.0, 635.0, 310.0, 340.0, 495.0, 220.0, 630.0, 200.0, 690.0, 360.0, 450.0, 100.0, 500.0, 360.0, 340.0, 710.0, 590.0, 180.0, 600.0, 290.0, 590.0, 350.0, 190.0, 1030.0, 280.0, 910.0, -200.0, 910.0, 330.0, 700.0, 600.0, 965.0, 270.0, 780.0, 780.0, 690.0, 450.0, 550.0, 200.0, 1260.0, 540.0, 320.0, 140.0, 620.0, 670.0, 900.0, 360.0, 310.0, 235.0, 300.0, 630.0, 190.0, 960.0, 830.0, 1000.0, 380.0, 940.0, 170.0, 620.0, 170.0, 310.0, 300.0, 570.0, 1130.0, 290.0, 1160.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 20.0, 30.0, 10.0, 130.0, 0.0, 0.0, 20.0, 20.0, 20.0, 0.0, 0.0, 80.0, 60.0, 20.0, -10.0, 20.0, 30.0, 250.0, 370.0, 40.0, 70.0, 70.0, 40.0, 20.0, 20.0, 10.0, 20.0, 0.0, 40.0, 0.0, -20.0, 100.0, 320.0, 10.0, 190.0, 0.0, 30.0, 10.0, 40.0, 250.0, 20.0, 0.0, 10.0, 0.0, 10.0, 10.0, 30.0, 50.0, 0.0, 10.0, 20.0, 80.0, 40.0, 70.0, 70.0, 130.0, 560.0, 30.0, 20.0, 40.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 0.0, 10.0, 50.0, 40.0, 60.0, 350.0, 0.0, 140.0, 70.0, 40.0, 10.0, 30.0, 0.0, 20.0, 20.0, 20.0, 0.0, 20.0, 20.0, 10.0, 80.0, 150.0, 40.0, 40.0, -45.0, 180.0, 20.0, 10.0, 10.0, -15.0, 40.0, 30.0, 30.0, -50.0, 50.0, 0.0, 660.0, 40.0, 60.0, 60.0, 150.0, 40.0, -30.0, -40.0, 170.0, -40.0, -20.0, 40.0, 710.0, -170.0, -40.0, -205.0, 110.0, 370.0, 30.0, 20.0, 160.0, 40.0, 20.0, 50.0, 50.0, 40.0, 50.0, 170.0, 210.0, 40.0, 30.0, 50.0, 40.0, 30.0, 0.0, 350.0, 10.0, 10.0, 0.0, 30.0, 40.0, 40.0, 170.0, 40.0, 60.0, 40.0, 50.0, 30.0, 40.0, 10.0, 30.0, 0.0, 20.0, 180.0, 0.0, 10.0, 270.0, 20.0, 0.0, 20.0, 150.0, 170.0, 160.0, 20.0, 20.0, 40.0, 0.0, 60.0, 20.0, 40.0, 300.0, 40.0, 130.0, 30.0, 30.0, 50.0, 30.0, 0.0, 0.0, 0.0, 200.0, 40.0, 30.0, 10.0, 0.0, 0.0, 40.0, 30.0, -20.0, 70.0, 0.0, 20.0, 50.0, 10.0, 10.0, 40.0, 20.0, 80.0, 0.0, 10.0, 0.0, 30.0, 0.0, 40.0, 30.0, 40.0, 20.0, 10.0, 20.0, 20.0, 30.0, 30.0, 60.0, 90.0, 30.0, 30.0, 180.0, 0.0, 10.0, 60.0, 40.0, 110.0, 10.0, 0.0, 0.0, 0.0, 0.0, 20.0, 20.0, 0.0, 0.0, 20.0, 20.0, 20.0, 10.0, 20.0, 120.0, 150.0, 30.0, 30.0, 60.0, 80.0, 0.0, 190.0, 10.0, 200.0, 90.0, 260.0, 10.0, 170.0, 10.0, 30.0, 50.0, 180.0, 10.0, 20.0, -20.0, 100.0, 50.0, 20.0, 50.0, 250.0, 0.0, 70.0, 0.0, 60.0, 30.0, 120.0, 0.0, 20.0, 30.0, 20.0, 190.0, 40.0, 50.0, 10.0, 50.0, 40.0, 0.0, 80.0, 5.0, 50.0, 30.0, 100.0, 0.0, 370.0, 40.0, 80.0, 90.0, -20.0, 60.0, 280.0, 40.0, 130.0, 40.0, 390.0, 390.0, 50.0, 360.0, 0.0, 70.0, 60.0, 30.0, 80.0, 40.0, 0.0, 20.0, 0.0, 10.0, 20.0, 70.0, 0.0, 60.0, 15.0, 0.0, 90.0, 20.0, 150.0, 20.0, 70.0, 10.0, 70.0, 80.0, 10.0, 60.0, 10.0, 70.0, 20.0, 30.0, 0.0, 30.0, 90.0, 20.0, 20.0, 20.0, 0.0, 40.0, 300.0, 60.0, 30.0, 30.0, 20.0, -50.0, 0.0, 0.0, 60.0, 0.0, 0.0, 100.0, 0.0, 270.0, 160.0, 20.0, -60.0, -5.0, 60.0, 90.0, 120.0, 10.0, 60.0, 20.0, 0.0, 60.0, 20.0, 5.0, 15.0, 0.0, 40.0, 20.0, 30.0, 20.0, 10.0, 10.0, 70.0, 20.0, 70.0, 50.0, 20.0, 0.0, 150.0, 190.0, -5.0, 20.0, 20.0, 50.0, 0.0, 50.0, 10.0, 40.0, 10.0, 20.0, 10.0, 30.0, 30.0, 30.0, 20.0, 20.0, 50.0, 30.0, 0.0, 20.0, 30.0, 90.0, 0.0, 20.0, 360.0, 30.0, 30.0, 20.0, 0.0, 0.0, 0.0, 60.0, 40.0, 30.0, 20.0, 0.0, 20.0, 0.0, 180.0, 230.0, -30.0, 180.0, 60.0, 10.0, 10.0, 30.0, 50.0, 30.0, 10.0, 0.0, 40.0, 20.0, 10.0, 20.0, 40.0, 140.0, 470.0, -290.0, 70.0, 40.0, -30.0, 80.0, 40.0, 70.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 60.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 60.0, 0.0, 70.0, 40.0, 30.0, 80.0, 150.0, 50.0, 30.0, 30.0, 0.0, 20.0, 40.0, 0.0, 40.0, 150.0, 10.0, 40.0, 0.0, 10.0, 0.0, 160.0, 40.0, 0.0, 20.0, 40.0, 60.0, 10.0, 150.0, 0.0, 0.0, 20.0, 150.0, 160.0, 40.0, 90.0, 60.0, 40.0, 90.0, 270.0, 10.0, 60.0, 60.0, 30.0, 0.0, 40.0, 20.0, 10.0, 10.0, 30.0, 30.0, 0.0, 20.0, 10.0, 40.0, 0.0, 30.0, 10.0, 0.0, 90.0, 80.0, 10.0, 20.0, 150.0, 10.0, 200.0, 20.0, 20.0, 30.0, 0.0, 30.0, 150.0, 0.0, 0.0, 20.0, 20.0, 10.0, 30.0, 30.0, 30.0, 20.0, 0.0, 470.0, 20.0, 0.0, -20.0, 30.0, 10.0, 50.0, 10.0, 130.0, 0.0, 20.0, 40.0, 20.0, 0.0, 50.0, 30.0, 30.0, 10.0, 0.0, 30.0, 20.0, 20.0, 40.0, 30.0, 10.0, 0.0, -10.0, 50.0, 20.0, 590.0, 30.0, 30.0, 40.0, 90.0, 170.0, 20.0, 30.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 40.0, 60.0, 50.0, 380.0, -20.0, 30.0, 10.0, 60.0, 370.0, 40.0, 60.0, -50.0, 30.0, 50.0, -720.0, 30.0, 10.0, 170.0, 10.0, 20.0, 10.0, 30.0, 190.0, 40.0, 60.0, 0.0, 360.0, 70.0, 80.0, 50.0, 80.0, 110.0, 60.0, 20.0, 40.0, 40.0, 40.0, 30.0, 40.0, 20.0, 10.0, 60.0, 30.0, 170.0, 80.0, 30.0, 20.0, 60.0, 40.0, 30.0, 60.0, 130.0, 80.0, 60.0, 30.0, 60.0, 10.0, -40.0, 30.0, 10.0, 40.0, 40.0, 360.0, 20.0, 370.0, 100.0, 35.0, 250.0, 30.0, 50.0, 70.0, 0.0, 40.0, 110.0, 20.0, 30.0, 30.0, 10.0, 0.0, 0.0, 10.0, 10.0, 50.0, 80.0, 100.0, 10.0, 10.0, 180.0, 20.0, 220.0, 60.0, 50.0, 50.0, 40.0, 100.0, 160.0, 20.0, 20.0, 80.0, 10.0, 40.0, 250.0, 60.0, 30.0, 30.0, 30.0, 450.0, 40.0, 10.0, 40.0, 0.0, 30.0, 30.0, 10.0, 30.0, 10.0, 20.0, 0.0, 120.0, 30.0, 180.0, 20.0, 30.0, 70.0, 30.0, 40.0, 70.0, 50.0, 10.0, 40.0, 160.0, 30.0, 50.0, 10.0, 40.0, 40.0, 20.0, 10.0, 20.0, 20.0, 0.0, 40.0, 0.0, 880.0, 40.0, 20.0, 160.0, 60.0, 80.0, 0.0, -30.0, -40.0, 90.0, 70.0, 40.0, 0.0, 0.0, 0.0, 60.0, 20.0, 120.0, 40.0, 190.0, 60.0, 30.0, 20.0, 30.0, 40.0, 40.0, 20.0, 40.0, 0.0, 40.0, 0.0, 30.0, 10.0, 0.0, 0.0, 40.0, 10.0, 0.0, 50.0, 0.0, 40.0, 20.0, 80.0, 10.0, 80.0, 200.0, 40.0, 70.0, 0.0, 80.0, 0.0, 40.0, 20.0, 440.0, 10.0, 30.0, 20.0, 40.0, 10.0, 60.0, 40.0, 40.0, -30.0, 10.0, 60.0, 110.0, 560.0, 30.0, 20.0, 60.0, 20.0, 10.0, 30.0, 0.0, 190.0, 30.0, 30.0, 30.0, 20.0, 0.0, 40.0, 30.0, 40.0, 40.0, 20.0, 20.0, 30.0, 40.0, 30.0, 20.0, 90.0, 0.0, 40.0, 20.0, 40.0, 0.0, 0.0, 30.0, 5.0, 10.0, 40.0, 60.0, 60.0, 20.0, 0.0, 20.0, 60.0, 20.0, 20.0, 0.0, 0.0, 80.0, 40.0, 30.0, 30.0, 40.0, 60.0, 170.0, 0.0, 180.0, 10.0, 30.0, 40.0, 60.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 0.0, 450.0, 40.0, 160.0, -30.0, 60.0, -60.0, 280.0, 40.0, 50.0, 70.0, 50.0, 300.0, -150.0, 40.0, 150.0, 260.0, 30.0, 30.0, 30.0, 50.0, 190.0, 170.0, -30.0, 120.0, 50.0, 170.0, 70.0, 180.0, 10.0, 160.0, 70.0, 10.0, 20.0, 30.0, 0.0, 0.0, 0.0, 80.0, 170.0, 80.0, 100.0, 300.0, 50.0, 60.0, 60.0, 10.0, 20.0, 90.0, 0.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 30.0, 0.0, 30.0, 20.0, 40.0, 10.0, 0.0, 70.0, 40.0, 160.0, 260.0, 10.0, 10.0, 30.0, 0.0, 0.0, 30.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, 30.0, 160.0, 0.0, 0.0, 10.0, 0.0, 50.0, 20.0, 10.0, 30.0, 10.0, 20.0, 70.0, 70.0, 20.0, 80.0, 0.0, 10.0, 20.0, 0.0, 30.0, 80.0, 60.0, 40.0, 170.0, 40.0, 30.0, 30.0, 50.0, 40.0, 10.0, 150.0, 20.0, 220.0, 90.0, 40.0, 30.0, 480.0, 10.0, 80.0, 20.0, 80.0, 10.0, 30.0, 0.0, 0.0, 30.0, 100.0, 20.0, 0.0, 40.0, 50.0, 30.0, 360.0, 40.0, 370.0, 150.0, 60.0, 10.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5774179995764104, "mean_inference_ms": 1.7829656641113747, "mean_action_processing_ms": 0.462357336982998, "mean_env_wait_ms": 1.4244025875787734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06417489051818848, "StateBufferConnector_ms": 0.009451150894165039, "ViewRequirementAgentConnector_ms": 0.3824951648712158}, "num_episodes": 22, "episode_return_max": 1480.0, "episode_return_min": -200.0, "episode_return_mean": 533.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.147500881613205, "num_env_steps_trained_throughput_per_sec": 36.147500881613205, "timesteps_total": 188000, "num_env_steps_sampled_lifetime": 188000, "num_agent_steps_sampled_lifetime": 1880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1880000, "timers": {"training_iteration_time_ms": 110252.539, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110252.484, "sample_time_ms": 2415.198, "learn_time_ms": 107817.375, "learn_throughput": 37.1, "synch_weights_time_ms": 11.647}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 1880000, "num_agent_steps_trained": 1880000}, "done": false, "training_iteration": 47, "trial_id": "57140_00000", "date": "2024-06-27_00-46-15", "timestamp": 1719463575, "time_this_iter_s": 110.66779279708862, "time_total_s": 5501.342967987061, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af43a820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5501.342967987061, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 15.773885350318471, "ram_util_percent": 78.79681528662421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.725495606851273, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.7963366741062607, "policy_loss": -0.005927835443454841, "vf_loss": 3.801483287090184, "vf_explained_var": 0.0016100119224117715, "kl": 0.007812267117186177, "entropy": 0.6708266712034853, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 446025.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "env_runners": {"episode_reward_max": 1480.0, "episode_reward_min": -200.0, "episode_reward_mean": 520.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -720.0}, "policy_reward_max": {"policy_0": 880.0}, "policy_reward_mean": {"policy_0": 52.01}, "custom_metrics": {}, "hist_stats": {"episode_reward": [250.0, 840.0, 720.0, 630.0, 530.0, 715.0, 1480.0, 710.0, 285.0, 550.0, 270.0, 450.0, 635.0, 310.0, 340.0, 495.0, 220.0, 630.0, 200.0, 690.0, 360.0, 450.0, 100.0, 500.0, 360.0, 340.0, 710.0, 590.0, 180.0, 600.0, 290.0, 590.0, 350.0, 190.0, 1030.0, 280.0, 910.0, -200.0, 910.0, 330.0, 700.0, 600.0, 965.0, 270.0, 780.0, 780.0, 690.0, 450.0, 550.0, 200.0, 1260.0, 540.0, 320.0, 140.0, 620.0, 670.0, 900.0, 360.0, 310.0, 235.0, 300.0, 630.0, 190.0, 960.0, 830.0, 1000.0, 380.0, 940.0, 170.0, 620.0, 170.0, 310.0, 300.0, 570.0, 1130.0, 290.0, 1160.0, 140.0, 200.0, 260.0, 880.0, 260.0, 850.0, 320.0, 650.0, 490.0, 1105.0, 180.0, 840.0, 380.0, 190.0, 690.0, 450.0, 190.0, 910.0, 45.0, 580.0, 400.0, 680.0, 210.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 20.0, 0.0, 0.0, 20.0, 20.0, 20.0, 10.0, 20.0, 120.0, 150.0, 30.0, 30.0, 60.0, 80.0, 0.0, 190.0, 10.0, 200.0, 90.0, 260.0, 10.0, 170.0, 10.0, 30.0, 50.0, 180.0, 10.0, 20.0, -20.0, 100.0, 50.0, 20.0, 50.0, 250.0, 0.0, 70.0, 0.0, 60.0, 30.0, 120.0, 0.0, 20.0, 30.0, 20.0, 190.0, 40.0, 50.0, 10.0, 50.0, 40.0, 0.0, 80.0, 5.0, 50.0, 30.0, 100.0, 0.0, 370.0, 40.0, 80.0, 90.0, -20.0, 60.0, 280.0, 40.0, 130.0, 40.0, 390.0, 390.0, 50.0, 360.0, 0.0, 70.0, 60.0, 30.0, 80.0, 40.0, 0.0, 20.0, 0.0, 10.0, 20.0, 70.0, 0.0, 60.0, 15.0, 0.0, 90.0, 20.0, 150.0, 20.0, 70.0, 10.0, 70.0, 80.0, 10.0, 60.0, 10.0, 70.0, 20.0, 30.0, 0.0, 30.0, 90.0, 20.0, 20.0, 20.0, 0.0, 40.0, 300.0, 60.0, 30.0, 30.0, 20.0, -50.0, 0.0, 0.0, 60.0, 0.0, 0.0, 100.0, 0.0, 270.0, 160.0, 20.0, -60.0, -5.0, 60.0, 90.0, 120.0, 10.0, 60.0, 20.0, 0.0, 60.0, 20.0, 5.0, 15.0, 0.0, 40.0, 20.0, 30.0, 20.0, 10.0, 10.0, 70.0, 20.0, 70.0, 50.0, 20.0, 0.0, 150.0, 190.0, -5.0, 20.0, 20.0, 50.0, 0.0, 50.0, 10.0, 40.0, 10.0, 20.0, 10.0, 30.0, 30.0, 30.0, 20.0, 20.0, 50.0, 30.0, 0.0, 20.0, 30.0, 90.0, 0.0, 20.0, 360.0, 30.0, 30.0, 20.0, 0.0, 0.0, 0.0, 60.0, 40.0, 30.0, 20.0, 0.0, 20.0, 0.0, 180.0, 230.0, -30.0, 180.0, 60.0, 10.0, 10.0, 30.0, 50.0, 30.0, 10.0, 0.0, 40.0, 20.0, 10.0, 20.0, 40.0, 140.0, 470.0, -290.0, 70.0, 40.0, -30.0, 80.0, 40.0, 70.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 60.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 60.0, 0.0, 70.0, 40.0, 30.0, 80.0, 150.0, 50.0, 30.0, 30.0, 0.0, 20.0, 40.0, 0.0, 40.0, 150.0, 10.0, 40.0, 0.0, 10.0, 0.0, 160.0, 40.0, 0.0, 20.0, 40.0, 60.0, 10.0, 150.0, 0.0, 0.0, 20.0, 150.0, 160.0, 40.0, 90.0, 60.0, 40.0, 90.0, 270.0, 10.0, 60.0, 60.0, 30.0, 0.0, 40.0, 20.0, 10.0, 10.0, 30.0, 30.0, 0.0, 20.0, 10.0, 40.0, 0.0, 30.0, 10.0, 0.0, 90.0, 80.0, 10.0, 20.0, 150.0, 10.0, 200.0, 20.0, 20.0, 30.0, 0.0, 30.0, 150.0, 0.0, 0.0, 20.0, 20.0, 10.0, 30.0, 30.0, 30.0, 20.0, 0.0, 470.0, 20.0, 0.0, -20.0, 30.0, 10.0, 50.0, 10.0, 130.0, 0.0, 20.0, 40.0, 20.0, 0.0, 50.0, 30.0, 30.0, 10.0, 0.0, 30.0, 20.0, 20.0, 40.0, 30.0, 10.0, 0.0, -10.0, 50.0, 20.0, 590.0, 30.0, 30.0, 40.0, 90.0, 170.0, 20.0, 30.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 40.0, 60.0, 50.0, 380.0, -20.0, 30.0, 10.0, 60.0, 370.0, 40.0, 60.0, -50.0, 30.0, 50.0, -720.0, 30.0, 10.0, 170.0, 10.0, 20.0, 10.0, 30.0, 190.0, 40.0, 60.0, 0.0, 360.0, 70.0, 80.0, 50.0, 80.0, 110.0, 60.0, 20.0, 40.0, 40.0, 40.0, 30.0, 40.0, 20.0, 10.0, 60.0, 30.0, 170.0, 80.0, 30.0, 20.0, 60.0, 40.0, 30.0, 60.0, 130.0, 80.0, 60.0, 30.0, 60.0, 10.0, -40.0, 30.0, 10.0, 40.0, 40.0, 360.0, 20.0, 370.0, 100.0, 35.0, 250.0, 30.0, 50.0, 70.0, 0.0, 40.0, 110.0, 20.0, 30.0, 30.0, 10.0, 0.0, 0.0, 10.0, 10.0, 50.0, 80.0, 100.0, 10.0, 10.0, 180.0, 20.0, 220.0, 60.0, 50.0, 50.0, 40.0, 100.0, 160.0, 20.0, 20.0, 80.0, 10.0, 40.0, 250.0, 60.0, 30.0, 30.0, 30.0, 450.0, 40.0, 10.0, 40.0, 0.0, 30.0, 30.0, 10.0, 30.0, 10.0, 20.0, 0.0, 120.0, 30.0, 180.0, 20.0, 30.0, 70.0, 30.0, 40.0, 70.0, 50.0, 10.0, 40.0, 160.0, 30.0, 50.0, 10.0, 40.0, 40.0, 20.0, 10.0, 20.0, 20.0, 0.0, 40.0, 0.0, 880.0, 40.0, 20.0, 160.0, 60.0, 80.0, 0.0, -30.0, -40.0, 90.0, 70.0, 40.0, 0.0, 0.0, 0.0, 60.0, 20.0, 120.0, 40.0, 190.0, 60.0, 30.0, 20.0, 30.0, 40.0, 40.0, 20.0, 40.0, 0.0, 40.0, 0.0, 30.0, 10.0, 0.0, 0.0, 40.0, 10.0, 0.0, 50.0, 0.0, 40.0, 20.0, 80.0, 10.0, 80.0, 200.0, 40.0, 70.0, 0.0, 80.0, 0.0, 40.0, 20.0, 440.0, 10.0, 30.0, 20.0, 40.0, 10.0, 60.0, 40.0, 40.0, -30.0, 10.0, 60.0, 110.0, 560.0, 30.0, 20.0, 60.0, 20.0, 10.0, 30.0, 0.0, 190.0, 30.0, 30.0, 30.0, 20.0, 0.0, 40.0, 30.0, 40.0, 40.0, 20.0, 20.0, 30.0, 40.0, 30.0, 20.0, 90.0, 0.0, 40.0, 20.0, 40.0, 0.0, 0.0, 30.0, 5.0, 10.0, 40.0, 60.0, 60.0, 20.0, 0.0, 20.0, 60.0, 20.0, 20.0, 0.0, 0.0, 80.0, 40.0, 30.0, 30.0, 40.0, 60.0, 170.0, 0.0, 180.0, 10.0, 30.0, 40.0, 60.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 0.0, 450.0, 40.0, 160.0, -30.0, 60.0, -60.0, 280.0, 40.0, 50.0, 70.0, 50.0, 300.0, -150.0, 40.0, 150.0, 260.0, 30.0, 30.0, 30.0, 50.0, 190.0, 170.0, -30.0, 120.0, 50.0, 170.0, 70.0, 180.0, 10.0, 160.0, 70.0, 10.0, 20.0, 30.0, 0.0, 0.0, 0.0, 80.0, 170.0, 80.0, 100.0, 300.0, 50.0, 60.0, 60.0, 10.0, 20.0, 90.0, 0.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 30.0, 0.0, 30.0, 20.0, 40.0, 10.0, 0.0, 70.0, 40.0, 160.0, 260.0, 10.0, 10.0, 30.0, 0.0, 0.0, 30.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, 30.0, 160.0, 0.0, 0.0, 10.0, 0.0, 50.0, 20.0, 10.0, 30.0, 10.0, 20.0, 70.0, 70.0, 20.0, 80.0, 0.0, 10.0, 20.0, 0.0, 30.0, 80.0, 60.0, 40.0, 170.0, 40.0, 30.0, 30.0, 50.0, 40.0, 10.0, 150.0, 20.0, 220.0, 90.0, 40.0, 30.0, 480.0, 10.0, 80.0, 20.0, 80.0, 10.0, 30.0, 0.0, 0.0, 30.0, 100.0, 20.0, 0.0, 40.0, 50.0, 30.0, 360.0, 40.0, 370.0, 150.0, 60.0, 10.0, 50.0, 30.0, 0.0, 20.0, 0.0, 10.0, 30.0, 10.0, 0.0, 10.0, 30.0, 40.0, 10.0, 10.0, 30.0, 10.0, 30.0, 20.0, 10.0, 30.0, 10.0, 40.0, 0.0, 60.0, 20.0, 10.0, 20.0, 50.0, 30.0, 30.0, 0.0, 230.0, 40.0, 120.0, 160.0, 10.0, 30.0, 0.0, 40.0, 170.0, 80.0, 20.0, 10.0, 0.0, 0.0, 150.0, 30.0, 0.0, 0.0, 10.0, 40.0, 0.0, 300.0, 10.0, 40.0, 60.0, 180.0, 50.0, 100.0, 50.0, 60.0, 10.0, 40.0, 30.0, 20.0, 110.0, 0.0, 30.0, 40.0, 0.0, 40.0, 360.0, 160.0, 50.0, -30.0, 0.0, 30.0, 50.0, 0.0, 0.0, 30.0, 30.0, 40.0, 10.0, 30.0, 180.0, 110.0, 20.0, 0.0, 20.0, 50.0, 20.0, 10.0, 30.0, 60.0, 50.0, 210.0, 15.0, 60.0, 150.0, 500.0, 10.0, 20.0, 0.0, 30.0, 10.0, 20.0, 0.0, 10.0, 70.0, 10.0, 70.0, 20.0, 20.0, 20.0, 50.0, 20.0, 560.0, 10.0, 40.0, 30.0, 20.0, 10.0, 0.0, 100.0, 40.0, 30.0, 80.0, 20.0, 10.0, 70.0, 10.0, 10.0, 40.0, 0.0, 20.0, 0.0, 40.0, 0.0, 50.0, 20.0, 30.0, 250.0, 0.0, 40.0, 20.0, 70.0, 70.0, 0.0, 60.0, 150.0, 90.0, 30.0, 30.0, 220.0, 20.0, 40.0, -30.0, 30.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 30.0, 0.0, 30.0, 20.0, 20.0, 40.0, 150.0, 40.0, 170.0, -40.0, 70.0, 380.0, 20.0, 0.0, 50.0, 70.0, -35.0, 160.0, -50.0, 10.0, -55.0, 5.0, -20.0, -60.0, 20.0, 70.0, 150.0, 60.0, 120.0, 50.0, 100.0, 40.0, 0.0, 10.0, 0.0, 50.0, 40.0, 10.0, 10.0, 0.0, 30.0, 10.0, 60.0, 190.0, 0.0, 50.0, 30.0, 80.0, 0.0, 40.0, 40.0, 40.0, 560.0, -140.0, 20.0, 10.0, 40.0, 30.0, 0.0, 0.0, 20.0, 20.0, 20.0, 0.0, 80.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5680408811390811, "mean_inference_ms": 1.7629885545074726, "mean_action_processing_ms": 0.4583836699544335, "mean_env_wait_ms": 1.4154709191576313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0643765926361084, "StateBufferConnector_ms": 0.009386062622070312, "ViewRequirementAgentConnector_ms": 0.3721277713775635}, "num_episodes": 23, "episode_return_max": 1480.0, "episode_return_min": -200.0, "episode_return_mean": 520.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.31422594505333, "num_env_steps_trained_throughput_per_sec": 36.31422594505333, "timesteps_total": 192000, "num_env_steps_sampled_lifetime": 192000, "num_agent_steps_sampled_lifetime": 1920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1920000, "timers": {"training_iteration_time_ms": 110235.677, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110235.622, "sample_time_ms": 2404.552, "learn_time_ms": 107811.353, "learn_throughput": 37.102, "synch_weights_time_ms": 11.557}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 1920000, "num_agent_steps_trained": 1920000}, "done": false, "training_iteration": 48, "trial_id": "57140_00000", "date": "2024-06-27_00-48-05", "timestamp": 1719463685, "time_this_iter_s": 110.16282105445862, "time_total_s": 5611.505789041519, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af4368b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5611.505789041519, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 15.675641025641026, "ram_util_percent": 78.81858974358974}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8936828327921633, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.932796175741413, "policy_loss": -0.005500409318480335, "vf_loss": 3.937517339302201, "vf_explained_var": 0.0014250581383832093, "kl": 0.007792450055053812, "entropy": 0.6516346516764076, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 455415.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000}, "env_runners": {"episode_reward_max": 1260.0, "episode_reward_min": -200.0, "episode_reward_mean": 514.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -720.0}, "policy_reward_max": {"policy_0": 880.0}, "policy_reward_mean": {"policy_0": 51.41}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 690.0, 360.0, 450.0, 100.0, 500.0, 360.0, 340.0, 710.0, 590.0, 180.0, 600.0, 290.0, 590.0, 350.0, 190.0, 1030.0, 280.0, 910.0, -200.0, 910.0, 330.0, 700.0, 600.0, 965.0, 270.0, 780.0, 780.0, 690.0, 450.0, 550.0, 200.0, 1260.0, 540.0, 320.0, 140.0, 620.0, 670.0, 900.0, 360.0, 310.0, 235.0, 300.0, 630.0, 190.0, 960.0, 830.0, 1000.0, 380.0, 940.0, 170.0, 620.0, 170.0, 310.0, 300.0, 570.0, 1130.0, 290.0, 1160.0, 140.0, 200.0, 260.0, 880.0, 260.0, 850.0, 320.0, 650.0, 490.0, 1105.0, 180.0, 840.0, 380.0, 190.0, 690.0, 450.0, 190.0, 910.0, 45.0, 580.0, 400.0, 680.0, 210.0, 1150.0, 620.0, 440.0, 660.0, 360.0, 430.0, 360.0, 300.0, 230.0, 490.0, 610.0, 560.0, 590.0, 685.0, 560.0, 250.0, 985.0, 180.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 20.0, 0.0, 0.0, 0.0, 60.0, 40.0, 30.0, 20.0, 0.0, 20.0, 0.0, 180.0, 230.0, -30.0, 180.0, 60.0, 10.0, 10.0, 30.0, 50.0, 30.0, 10.0, 0.0, 40.0, 20.0, 10.0, 20.0, 40.0, 140.0, 470.0, -290.0, 70.0, 40.0, -30.0, 80.0, 40.0, 70.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 60.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 10.0, 60.0, 0.0, 70.0, 40.0, 30.0, 80.0, 150.0, 50.0, 30.0, 30.0, 0.0, 20.0, 40.0, 0.0, 40.0, 150.0, 10.0, 40.0, 0.0, 10.0, 0.0, 160.0, 40.0, 0.0, 20.0, 40.0, 60.0, 10.0, 150.0, 0.0, 0.0, 20.0, 150.0, 160.0, 40.0, 90.0, 60.0, 40.0, 90.0, 270.0, 10.0, 60.0, 60.0, 30.0, 0.0, 40.0, 20.0, 10.0, 10.0, 30.0, 30.0, 0.0, 20.0, 10.0, 40.0, 0.0, 30.0, 10.0, 0.0, 90.0, 80.0, 10.0, 20.0, 150.0, 10.0, 200.0, 20.0, 20.0, 30.0, 0.0, 30.0, 150.0, 0.0, 0.0, 20.0, 20.0, 10.0, 30.0, 30.0, 30.0, 20.0, 0.0, 470.0, 20.0, 0.0, -20.0, 30.0, 10.0, 50.0, 10.0, 130.0, 0.0, 20.0, 40.0, 20.0, 0.0, 50.0, 30.0, 30.0, 10.0, 0.0, 30.0, 20.0, 20.0, 40.0, 30.0, 10.0, 0.0, -10.0, 50.0, 20.0, 590.0, 30.0, 30.0, 40.0, 90.0, 170.0, 20.0, 30.0, 10.0, 10.0, 20.0, 20.0, 20.0, 20.0, 40.0, 60.0, 50.0, 380.0, -20.0, 30.0, 10.0, 60.0, 370.0, 40.0, 60.0, -50.0, 30.0, 50.0, -720.0, 30.0, 10.0, 170.0, 10.0, 20.0, 10.0, 30.0, 190.0, 40.0, 60.0, 0.0, 360.0, 70.0, 80.0, 50.0, 80.0, 110.0, 60.0, 20.0, 40.0, 40.0, 40.0, 30.0, 40.0, 20.0, 10.0, 60.0, 30.0, 170.0, 80.0, 30.0, 20.0, 60.0, 40.0, 30.0, 60.0, 130.0, 80.0, 60.0, 30.0, 60.0, 10.0, -40.0, 30.0, 10.0, 40.0, 40.0, 360.0, 20.0, 370.0, 100.0, 35.0, 250.0, 30.0, 50.0, 70.0, 0.0, 40.0, 110.0, 20.0, 30.0, 30.0, 10.0, 0.0, 0.0, 10.0, 10.0, 50.0, 80.0, 100.0, 10.0, 10.0, 180.0, 20.0, 220.0, 60.0, 50.0, 50.0, 40.0, 100.0, 160.0, 20.0, 20.0, 80.0, 10.0, 40.0, 250.0, 60.0, 30.0, 30.0, 30.0, 450.0, 40.0, 10.0, 40.0, 0.0, 30.0, 30.0, 10.0, 30.0, 10.0, 20.0, 0.0, 120.0, 30.0, 180.0, 20.0, 30.0, 70.0, 30.0, 40.0, 70.0, 50.0, 10.0, 40.0, 160.0, 30.0, 50.0, 10.0, 40.0, 40.0, 20.0, 10.0, 20.0, 20.0, 0.0, 40.0, 0.0, 880.0, 40.0, 20.0, 160.0, 60.0, 80.0, 0.0, -30.0, -40.0, 90.0, 70.0, 40.0, 0.0, 0.0, 0.0, 60.0, 20.0, 120.0, 40.0, 190.0, 60.0, 30.0, 20.0, 30.0, 40.0, 40.0, 20.0, 40.0, 0.0, 40.0, 0.0, 30.0, 10.0, 0.0, 0.0, 40.0, 10.0, 0.0, 50.0, 0.0, 40.0, 20.0, 80.0, 10.0, 80.0, 200.0, 40.0, 70.0, 0.0, 80.0, 0.0, 40.0, 20.0, 440.0, 10.0, 30.0, 20.0, 40.0, 10.0, 60.0, 40.0, 40.0, -30.0, 10.0, 60.0, 110.0, 560.0, 30.0, 20.0, 60.0, 20.0, 10.0, 30.0, 0.0, 190.0, 30.0, 30.0, 30.0, 20.0, 0.0, 40.0, 30.0, 40.0, 40.0, 20.0, 20.0, 30.0, 40.0, 30.0, 20.0, 90.0, 0.0, 40.0, 20.0, 40.0, 0.0, 0.0, 30.0, 5.0, 10.0, 40.0, 60.0, 60.0, 20.0, 0.0, 20.0, 60.0, 20.0, 20.0, 0.0, 0.0, 80.0, 40.0, 30.0, 30.0, 40.0, 60.0, 170.0, 0.0, 180.0, 10.0, 30.0, 40.0, 60.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 0.0, 450.0, 40.0, 160.0, -30.0, 60.0, -60.0, 280.0, 40.0, 50.0, 70.0, 50.0, 300.0, -150.0, 40.0, 150.0, 260.0, 30.0, 30.0, 30.0, 50.0, 190.0, 170.0, -30.0, 120.0, 50.0, 170.0, 70.0, 180.0, 10.0, 160.0, 70.0, 10.0, 20.0, 30.0, 0.0, 0.0, 0.0, 80.0, 170.0, 80.0, 100.0, 300.0, 50.0, 60.0, 60.0, 10.0, 20.0, 90.0, 0.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 30.0, 0.0, 30.0, 20.0, 40.0, 10.0, 0.0, 70.0, 40.0, 160.0, 260.0, 10.0, 10.0, 30.0, 0.0, 0.0, 30.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, 30.0, 160.0, 0.0, 0.0, 10.0, 0.0, 50.0, 20.0, 10.0, 30.0, 10.0, 20.0, 70.0, 70.0, 20.0, 80.0, 0.0, 10.0, 20.0, 0.0, 30.0, 80.0, 60.0, 40.0, 170.0, 40.0, 30.0, 30.0, 50.0, 40.0, 10.0, 150.0, 20.0, 220.0, 90.0, 40.0, 30.0, 480.0, 10.0, 80.0, 20.0, 80.0, 10.0, 30.0, 0.0, 0.0, 30.0, 100.0, 20.0, 0.0, 40.0, 50.0, 30.0, 360.0, 40.0, 370.0, 150.0, 60.0, 10.0, 50.0, 30.0, 0.0, 20.0, 0.0, 10.0, 30.0, 10.0, 0.0, 10.0, 30.0, 40.0, 10.0, 10.0, 30.0, 10.0, 30.0, 20.0, 10.0, 30.0, 10.0, 40.0, 0.0, 60.0, 20.0, 10.0, 20.0, 50.0, 30.0, 30.0, 0.0, 230.0, 40.0, 120.0, 160.0, 10.0, 30.0, 0.0, 40.0, 170.0, 80.0, 20.0, 10.0, 0.0, 0.0, 150.0, 30.0, 0.0, 0.0, 10.0, 40.0, 0.0, 300.0, 10.0, 40.0, 60.0, 180.0, 50.0, 100.0, 50.0, 60.0, 10.0, 40.0, 30.0, 20.0, 110.0, 0.0, 30.0, 40.0, 0.0, 40.0, 360.0, 160.0, 50.0, -30.0, 0.0, 30.0, 50.0, 0.0, 0.0, 30.0, 30.0, 40.0, 10.0, 30.0, 180.0, 110.0, 20.0, 0.0, 20.0, 50.0, 20.0, 10.0, 30.0, 60.0, 50.0, 210.0, 15.0, 60.0, 150.0, 500.0, 10.0, 20.0, 0.0, 30.0, 10.0, 20.0, 0.0, 10.0, 70.0, 10.0, 70.0, 20.0, 20.0, 20.0, 50.0, 20.0, 560.0, 10.0, 40.0, 30.0, 20.0, 10.0, 0.0, 100.0, 40.0, 30.0, 80.0, 20.0, 10.0, 70.0, 10.0, 10.0, 40.0, 0.0, 20.0, 0.0, 40.0, 0.0, 50.0, 20.0, 30.0, 250.0, 0.0, 40.0, 20.0, 70.0, 70.0, 0.0, 60.0, 150.0, 90.0, 30.0, 30.0, 220.0, 20.0, 40.0, -30.0, 30.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 30.0, 0.0, 30.0, 20.0, 20.0, 40.0, 150.0, 40.0, 170.0, -40.0, 70.0, 380.0, 20.0, 0.0, 50.0, 70.0, -35.0, 160.0, -50.0, 10.0, -55.0, 5.0, -20.0, -60.0, 20.0, 70.0, 150.0, 60.0, 120.0, 50.0, 100.0, 40.0, 0.0, 10.0, 0.0, 50.0, 40.0, 10.0, 10.0, 0.0, 30.0, 10.0, 60.0, 190.0, 0.0, 50.0, 30.0, 80.0, 0.0, 40.0, 40.0, 40.0, 560.0, -140.0, 20.0, 10.0, 40.0, 30.0, 0.0, 0.0, 20.0, 20.0, 20.0, 0.0, 80.0, 0.0, 50.0, 50.0, 40.0, 80.0, 20.0, 470.0, 360.0, 10.0, 30.0, 40.0, 40.0, 250.0, 70.0, 30.0, 70.0, 0.0, 80.0, 50.0, 0.0, 30.0, 20.0, 0.0, 10.0, 30.0, 40.0, 50.0, 10.0, 0.0, 280.0, 0.0, 30.0, 260.0, 40.0, 0.0, 0.0, 10.0, 40.0, 160.0, 90.0, 30.0, 20.0, 40.0, 150.0, 40.0, 30.0, 0.0, 30.0, 10.0, 0.0, 40.0, 40.0, 80.0, 30.0, 150.0, 50.0, 10.0, 30.0, 10.0, 20.0, 10.0, 0.0, 10.0, 40.0, 40.0, 60.0, 50.0, 30.0, 30.0, 60.0, 40.0, 30.0, 20.0, 10.0, 30.0, 80.0, 20.0, 30.0, 30.0, 30.0, 20.0, 0.0, 10.0, 20.0, 40.0, 10.0, 0.0, 20.0, 10.0, 90.0, 30.0, 180.0, 10.0, 60.0, 0.0, 0.0, 30.0, 100.0, 40.0, 70.0, 0.0, 40.0, 80.0, 30.0, 40.0, 170.0, -30.0, 30.0, 200.0, 10.0, 40.0, 20.0, 30.0, 260.0, 50.0, 20.0, 30.0, 40.0, 80.0, 20.0, 10.0, 190.0, 10.0, 0.0, 30.0, 40.0, 20.0, 30.0, 0.0, 20.0, 250.0, 30.0, 170.0, 20.0, 80.0, -5.0, 40.0, 30.0, 0.0, 290.0, 30.0, 50.0, 40.0, 40.0, 10.0, 30.0, 70.0, 60.0, 150.0, 110.0, 0.0, 60.0, 0.0, 40.0, 20.0, 70.0, 10.0, 20.0, 10.0, 10.0, 10.0, 60.0, 10.0, 70.0, 250.0, 40.0, 70.0, 275.0, 80.0, 100.0, 30.0, 10.0, 20.0, 10.0, 30.0, 80.0, 10.0, 10.0, 0.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5628276304145334, "mean_inference_ms": 1.763962568400213, "mean_action_processing_ms": 0.4571935477348737, "mean_env_wait_ms": 1.4133339107287466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06469154357910156, "StateBufferConnector_ms": 0.009211540222167969, "ViewRequirementAgentConnector_ms": 0.37366151809692383}, "num_episodes": 18, "episode_return_max": 1260.0, "episode_return_min": -200.0, "episode_return_mean": 514.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.18499657835437, "num_env_steps_trained_throughput_per_sec": 36.18499657835437, "timesteps_total": 196000, "num_env_steps_sampled_lifetime": 196000, "num_agent_steps_sampled_lifetime": 1960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 1960000, "timers": {"training_iteration_time_ms": 110273.104, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110273.05, "sample_time_ms": 2414.705, "learn_time_ms": 107838.168, "learn_throughput": 37.093, "synch_weights_time_ms": 11.654}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 1960000, "num_agent_steps_trained": 1960000}, "done": false, "training_iteration": 49, "trial_id": "57140_00000", "date": "2024-06-27_00-49-55", "timestamp": 1719463795, "time_this_iter_s": 110.5542950630188, "time_total_s": 5722.060084104538, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af404820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5722.060084104538, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 15.608333333333336, "ram_util_percent": 79.40769230769232}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.591406521683557, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9972756007228036, "policy_loss": -0.004517072805585846, "vf_loss": 4.001064465627376, "vf_explained_var": -0.0001478712716168616, "kl": 0.0072820644462055885, "entropy": 0.6764961894423055, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 464805.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "env_runners": {"episode_reward_max": 1635.0, "episode_reward_min": -200.0, "episode_reward_mean": 524.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -720.0}, "policy_reward_max": {"policy_0": 910.0}, "policy_reward_mean": {"policy_0": 52.415}, "custom_metrics": {}, "hist_stats": {"episode_reward": [910.0, -200.0, 910.0, 330.0, 700.0, 600.0, 965.0, 270.0, 780.0, 780.0, 690.0, 450.0, 550.0, 200.0, 1260.0, 540.0, 320.0, 140.0, 620.0, 670.0, 900.0, 360.0, 310.0, 235.0, 300.0, 630.0, 190.0, 960.0, 830.0, 1000.0, 380.0, 940.0, 170.0, 620.0, 170.0, 310.0, 300.0, 570.0, 1130.0, 290.0, 1160.0, 140.0, 200.0, 260.0, 880.0, 260.0, 850.0, 320.0, 650.0, 490.0, 1105.0, 180.0, 840.0, 380.0, 190.0, 690.0, 450.0, 190.0, 910.0, 45.0, 580.0, 400.0, 680.0, 210.0, 1150.0, 620.0, 440.0, 660.0, 360.0, 430.0, 360.0, 300.0, 230.0, 490.0, 610.0, 560.0, 590.0, 685.0, 560.0, 250.0, 985.0, 180.0, 640.0, 605.0, 520.0, 1635.0, 150.0, 330.0, 280.0, 340.0, 865.0, 370.0, 430.0, 400.0, 580.0, 160.0, 520.0, 580.0, 280.0, 130.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [380.0, -20.0, 30.0, 10.0, 60.0, 370.0, 40.0, 60.0, -50.0, 30.0, 50.0, -720.0, 30.0, 10.0, 170.0, 10.0, 20.0, 10.0, 30.0, 190.0, 40.0, 60.0, 0.0, 360.0, 70.0, 80.0, 50.0, 80.0, 110.0, 60.0, 20.0, 40.0, 40.0, 40.0, 30.0, 40.0, 20.0, 10.0, 60.0, 30.0, 170.0, 80.0, 30.0, 20.0, 60.0, 40.0, 30.0, 60.0, 130.0, 80.0, 60.0, 30.0, 60.0, 10.0, -40.0, 30.0, 10.0, 40.0, 40.0, 360.0, 20.0, 370.0, 100.0, 35.0, 250.0, 30.0, 50.0, 70.0, 0.0, 40.0, 110.0, 20.0, 30.0, 30.0, 10.0, 0.0, 0.0, 10.0, 10.0, 50.0, 80.0, 100.0, 10.0, 10.0, 180.0, 20.0, 220.0, 60.0, 50.0, 50.0, 40.0, 100.0, 160.0, 20.0, 20.0, 80.0, 10.0, 40.0, 250.0, 60.0, 30.0, 30.0, 30.0, 450.0, 40.0, 10.0, 40.0, 0.0, 30.0, 30.0, 10.0, 30.0, 10.0, 20.0, 0.0, 120.0, 30.0, 180.0, 20.0, 30.0, 70.0, 30.0, 40.0, 70.0, 50.0, 10.0, 40.0, 160.0, 30.0, 50.0, 10.0, 40.0, 40.0, 20.0, 10.0, 20.0, 20.0, 0.0, 40.0, 0.0, 880.0, 40.0, 20.0, 160.0, 60.0, 80.0, 0.0, -30.0, -40.0, 90.0, 70.0, 40.0, 0.0, 0.0, 0.0, 60.0, 20.0, 120.0, 40.0, 190.0, 60.0, 30.0, 20.0, 30.0, 40.0, 40.0, 20.0, 40.0, 0.0, 40.0, 0.0, 30.0, 10.0, 0.0, 0.0, 40.0, 10.0, 0.0, 50.0, 0.0, 40.0, 20.0, 80.0, 10.0, 80.0, 200.0, 40.0, 70.0, 0.0, 80.0, 0.0, 40.0, 20.0, 440.0, 10.0, 30.0, 20.0, 40.0, 10.0, 60.0, 40.0, 40.0, -30.0, 10.0, 60.0, 110.0, 560.0, 30.0, 20.0, 60.0, 20.0, 10.0, 30.0, 0.0, 190.0, 30.0, 30.0, 30.0, 20.0, 0.0, 40.0, 30.0, 40.0, 40.0, 20.0, 20.0, 30.0, 40.0, 30.0, 20.0, 90.0, 0.0, 40.0, 20.0, 40.0, 0.0, 0.0, 30.0, 5.0, 10.0, 40.0, 60.0, 60.0, 20.0, 0.0, 20.0, 60.0, 20.0, 20.0, 0.0, 0.0, 80.0, 40.0, 30.0, 30.0, 40.0, 60.0, 170.0, 0.0, 180.0, 10.0, 30.0, 40.0, 60.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 0.0, 450.0, 40.0, 160.0, -30.0, 60.0, -60.0, 280.0, 40.0, 50.0, 70.0, 50.0, 300.0, -150.0, 40.0, 150.0, 260.0, 30.0, 30.0, 30.0, 50.0, 190.0, 170.0, -30.0, 120.0, 50.0, 170.0, 70.0, 180.0, 10.0, 160.0, 70.0, 10.0, 20.0, 30.0, 0.0, 0.0, 0.0, 80.0, 170.0, 80.0, 100.0, 300.0, 50.0, 60.0, 60.0, 10.0, 20.0, 90.0, 0.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 30.0, 0.0, 30.0, 20.0, 40.0, 10.0, 0.0, 70.0, 40.0, 160.0, 260.0, 10.0, 10.0, 30.0, 0.0, 0.0, 30.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, 30.0, 160.0, 0.0, 0.0, 10.0, 0.0, 50.0, 20.0, 10.0, 30.0, 10.0, 20.0, 70.0, 70.0, 20.0, 80.0, 0.0, 10.0, 20.0, 0.0, 30.0, 80.0, 60.0, 40.0, 170.0, 40.0, 30.0, 30.0, 50.0, 40.0, 10.0, 150.0, 20.0, 220.0, 90.0, 40.0, 30.0, 480.0, 10.0, 80.0, 20.0, 80.0, 10.0, 30.0, 0.0, 0.0, 30.0, 100.0, 20.0, 0.0, 40.0, 50.0, 30.0, 360.0, 40.0, 370.0, 150.0, 60.0, 10.0, 50.0, 30.0, 0.0, 20.0, 0.0, 10.0, 30.0, 10.0, 0.0, 10.0, 30.0, 40.0, 10.0, 10.0, 30.0, 10.0, 30.0, 20.0, 10.0, 30.0, 10.0, 40.0, 0.0, 60.0, 20.0, 10.0, 20.0, 50.0, 30.0, 30.0, 0.0, 230.0, 40.0, 120.0, 160.0, 10.0, 30.0, 0.0, 40.0, 170.0, 80.0, 20.0, 10.0, 0.0, 0.0, 150.0, 30.0, 0.0, 0.0, 10.0, 40.0, 0.0, 300.0, 10.0, 40.0, 60.0, 180.0, 50.0, 100.0, 50.0, 60.0, 10.0, 40.0, 30.0, 20.0, 110.0, 0.0, 30.0, 40.0, 0.0, 40.0, 360.0, 160.0, 50.0, -30.0, 0.0, 30.0, 50.0, 0.0, 0.0, 30.0, 30.0, 40.0, 10.0, 30.0, 180.0, 110.0, 20.0, 0.0, 20.0, 50.0, 20.0, 10.0, 30.0, 60.0, 50.0, 210.0, 15.0, 60.0, 150.0, 500.0, 10.0, 20.0, 0.0, 30.0, 10.0, 20.0, 0.0, 10.0, 70.0, 10.0, 70.0, 20.0, 20.0, 20.0, 50.0, 20.0, 560.0, 10.0, 40.0, 30.0, 20.0, 10.0, 0.0, 100.0, 40.0, 30.0, 80.0, 20.0, 10.0, 70.0, 10.0, 10.0, 40.0, 0.0, 20.0, 0.0, 40.0, 0.0, 50.0, 20.0, 30.0, 250.0, 0.0, 40.0, 20.0, 70.0, 70.0, 0.0, 60.0, 150.0, 90.0, 30.0, 30.0, 220.0, 20.0, 40.0, -30.0, 30.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 30.0, 0.0, 30.0, 20.0, 20.0, 40.0, 150.0, 40.0, 170.0, -40.0, 70.0, 380.0, 20.0, 0.0, 50.0, 70.0, -35.0, 160.0, -50.0, 10.0, -55.0, 5.0, -20.0, -60.0, 20.0, 70.0, 150.0, 60.0, 120.0, 50.0, 100.0, 40.0, 0.0, 10.0, 0.0, 50.0, 40.0, 10.0, 10.0, 0.0, 30.0, 10.0, 60.0, 190.0, 0.0, 50.0, 30.0, 80.0, 0.0, 40.0, 40.0, 40.0, 560.0, -140.0, 20.0, 10.0, 40.0, 30.0, 0.0, 0.0, 20.0, 20.0, 20.0, 0.0, 80.0, 0.0, 50.0, 50.0, 40.0, 80.0, 20.0, 470.0, 360.0, 10.0, 30.0, 40.0, 40.0, 250.0, 70.0, 30.0, 70.0, 0.0, 80.0, 50.0, 0.0, 30.0, 20.0, 0.0, 10.0, 30.0, 40.0, 50.0, 10.0, 0.0, 280.0, 0.0, 30.0, 260.0, 40.0, 0.0, 0.0, 10.0, 40.0, 160.0, 90.0, 30.0, 20.0, 40.0, 150.0, 40.0, 30.0, 0.0, 30.0, 10.0, 0.0, 40.0, 40.0, 80.0, 30.0, 150.0, 50.0, 10.0, 30.0, 10.0, 20.0, 10.0, 0.0, 10.0, 40.0, 40.0, 60.0, 50.0, 30.0, 30.0, 60.0, 40.0, 30.0, 20.0, 10.0, 30.0, 80.0, 20.0, 30.0, 30.0, 30.0, 20.0, 0.0, 10.0, 20.0, 40.0, 10.0, 0.0, 20.0, 10.0, 90.0, 30.0, 180.0, 10.0, 60.0, 0.0, 0.0, 30.0, 100.0, 40.0, 70.0, 0.0, 40.0, 80.0, 30.0, 40.0, 170.0, -30.0, 30.0, 200.0, 10.0, 40.0, 20.0, 30.0, 260.0, 50.0, 20.0, 30.0, 40.0, 80.0, 20.0, 10.0, 190.0, 10.0, 0.0, 30.0, 40.0, 20.0, 30.0, 0.0, 20.0, 250.0, 30.0, 170.0, 20.0, 80.0, -5.0, 40.0, 30.0, 0.0, 290.0, 30.0, 50.0, 40.0, 40.0, 10.0, 30.0, 70.0, 60.0, 150.0, 110.0, 0.0, 60.0, 0.0, 40.0, 20.0, 70.0, 10.0, 20.0, 10.0, 10.0, 10.0, 60.0, 10.0, 70.0, 250.0, 40.0, 70.0, 275.0, 80.0, 100.0, 30.0, 10.0, 20.0, 10.0, 30.0, 80.0, 10.0, 10.0, 0.0, 0.0, 10.0, 70.0, 10.0, 30.0, 0.0, 0.0, 260.0, 60.0, 60.0, 40.0, 110.0, 20.0, 180.0, 0.0, 20.0, 260.0, 20.0, 20.0, 5.0, 50.0, 30.0, 0.0, 80.0, 20.0, 30.0, 290.0, 20.0, 40.0, 10.0, 0.0, 30.0, 50.0, 20.0, 405.0, 50.0, 910.0, 0.0, 60.0, 60.0, 30.0, 50.0, 40.0, 0.0, 40.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 30.0, 30.0, 10.0, 30.0, 0.0, 20.0, 180.0, 30.0, 0.0, 0.0, 30.0, 20.0, 110.0, 40.0, 20.0, 40.0, 0.0, 0.0, 10.0, 0.0, 40.0, 30.0, 150.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 30.0, 60.0, 45.0, 40.0, 40.0, 360.0, 20.0, 250.0, 50.0, 70.0, -30.0, 20.0, 70.0, 50.0, 70.0, -40.0, 0.0, 70.0, 40.0, 50.0, 50.0, 10.0, 60.0, 30.0, 180.0, 30.0, 30.0, 50.0, 10.0, 10.0, 0.0, 30.0, 30.0, 180.0, 30.0, 0.0, 20.0, 30.0, 0.0, 20.0, 10.0, 80.0, 160.0, 20.0, 120.0, 20.0, 20.0, 40.0, 10.0, 160.0, 20.0, 10.0, 20.0, 0.0, 20.0, 0.0, 0.0, 30.0, 30.0, 30.0, 0.0, 30.0, 40.0, 190.0, 70.0, 80.0, 20.0, 30.0, 0.0, 60.0, 30.0, 0.0, 10.0, 80.0, 10.0, 60.0, 30.0, 170.0, 10.0, 10.0, 160.0, 40.0, 20.0, 40.0, 10.0, 0.0, 20.0, 20.0, 40.0, 60.0, 40.0, 30.0, 10.0, 0.0, 0.0, 50.0, 10.0, 10.0, 10.0, 30.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5587681425442423, "mean_inference_ms": 1.7597698102427302, "mean_action_processing_ms": 0.45593496612117723, "mean_env_wait_ms": 1.4103537307342713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06417512893676758, "StateBufferConnector_ms": 0.009178638458251953, "ViewRequirementAgentConnector_ms": 0.3639223575592041}, "num_episodes": 18, "episode_return_max": 1635.0, "episode_return_min": -200.0, "episode_return_mean": 524.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.178203301939966, "num_env_steps_trained_throughput_per_sec": 36.178203301939966, "timesteps_total": 200000, "num_env_steps_sampled_lifetime": 200000, "num_agent_steps_sampled_lifetime": 2000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2000000, "timers": {"training_iteration_time_ms": 110313.559, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110313.508, "sample_time_ms": 2419.802, "learn_time_ms": 107873.68, "learn_throughput": 37.08, "synch_weights_time_ms": 11.37}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 2000000, "num_agent_steps_trained": 2000000}, "done": false, "training_iteration": 50, "trial_id": "57140_00000", "date": "2024-06-27_00-51-46", "timestamp": 1719463906, "time_this_iter_s": 110.57672595977783, "time_total_s": 5832.636810064316, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af4084c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5832.636810064316, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 16.546496815286627, "ram_util_percent": 79.4579617834395}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.756661925992519, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.007478622557383, "policy_loss": -0.005390925870100443, "vf_loss": 4.012071146523229, "vf_explained_var": 8.353473533329746e-05, "kl": 0.007984000873099754, "entropy": 0.6663239426442736, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 474195.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "env_runners": {"episode_reward_max": 1635.0, "episode_reward_min": 45.0, "episode_reward_mean": 523.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 910.0}, "policy_reward_mean": {"policy_0": 52.335}, "custom_metrics": {}, "hist_stats": {"episode_reward": [620.0, 670.0, 900.0, 360.0, 310.0, 235.0, 300.0, 630.0, 190.0, 960.0, 830.0, 1000.0, 380.0, 940.0, 170.0, 620.0, 170.0, 310.0, 300.0, 570.0, 1130.0, 290.0, 1160.0, 140.0, 200.0, 260.0, 880.0, 260.0, 850.0, 320.0, 650.0, 490.0, 1105.0, 180.0, 840.0, 380.0, 190.0, 690.0, 450.0, 190.0, 910.0, 45.0, 580.0, 400.0, 680.0, 210.0, 1150.0, 620.0, 440.0, 660.0, 360.0, 430.0, 360.0, 300.0, 230.0, 490.0, 610.0, 560.0, 590.0, 685.0, 560.0, 250.0, 985.0, 180.0, 640.0, 605.0, 520.0, 1635.0, 150.0, 330.0, 280.0, 340.0, 865.0, 370.0, 430.0, 400.0, 580.0, 160.0, 520.0, 580.0, 280.0, 130.0, 680.0, 880.0, 535.0, 440.0, 430.0, 900.0, 580.0, 370.0, 300.0, 660.0, 950.0, 380.0, 530.0, 250.0, 1220.0, 220.0, 310.0, 480.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 20.0, 80.0, 10.0, 80.0, 200.0, 40.0, 70.0, 0.0, 80.0, 0.0, 40.0, 20.0, 440.0, 10.0, 30.0, 20.0, 40.0, 10.0, 60.0, 40.0, 40.0, -30.0, 10.0, 60.0, 110.0, 560.0, 30.0, 20.0, 60.0, 20.0, 10.0, 30.0, 0.0, 190.0, 30.0, 30.0, 30.0, 20.0, 0.0, 40.0, 30.0, 40.0, 40.0, 20.0, 20.0, 30.0, 40.0, 30.0, 20.0, 90.0, 0.0, 40.0, 20.0, 40.0, 0.0, 0.0, 30.0, 5.0, 10.0, 40.0, 60.0, 60.0, 20.0, 0.0, 20.0, 60.0, 20.0, 20.0, 0.0, 0.0, 80.0, 40.0, 30.0, 30.0, 40.0, 60.0, 170.0, 0.0, 180.0, 10.0, 30.0, 40.0, 60.0, 0.0, 10.0, 0.0, 10.0, 10.0, 20.0, 20.0, 0.0, 450.0, 40.0, 160.0, -30.0, 60.0, -60.0, 280.0, 40.0, 50.0, 70.0, 50.0, 300.0, -150.0, 40.0, 150.0, 260.0, 30.0, 30.0, 30.0, 50.0, 190.0, 170.0, -30.0, 120.0, 50.0, 170.0, 70.0, 180.0, 10.0, 160.0, 70.0, 10.0, 20.0, 30.0, 0.0, 0.0, 0.0, 80.0, 170.0, 80.0, 100.0, 300.0, 50.0, 60.0, 60.0, 10.0, 20.0, 90.0, 0.0, 20.0, 20.0, 10.0, 30.0, 30.0, 0.0, 30.0, 0.0, 30.0, 20.0, 40.0, 10.0, 0.0, 70.0, 40.0, 160.0, 260.0, 10.0, 10.0, 30.0, 0.0, 0.0, 30.0, 20.0, 20.0, 20.0, 20.0, 30.0, 0.0, 30.0, 160.0, 0.0, 0.0, 10.0, 0.0, 50.0, 20.0, 10.0, 30.0, 10.0, 20.0, 70.0, 70.0, 20.0, 80.0, 0.0, 10.0, 20.0, 0.0, 30.0, 80.0, 60.0, 40.0, 170.0, 40.0, 30.0, 30.0, 50.0, 40.0, 10.0, 150.0, 20.0, 220.0, 90.0, 40.0, 30.0, 480.0, 10.0, 80.0, 20.0, 80.0, 10.0, 30.0, 0.0, 0.0, 30.0, 100.0, 20.0, 0.0, 40.0, 50.0, 30.0, 360.0, 40.0, 370.0, 150.0, 60.0, 10.0, 50.0, 30.0, 0.0, 20.0, 0.0, 10.0, 30.0, 10.0, 0.0, 10.0, 30.0, 40.0, 10.0, 10.0, 30.0, 10.0, 30.0, 20.0, 10.0, 30.0, 10.0, 40.0, 0.0, 60.0, 20.0, 10.0, 20.0, 50.0, 30.0, 30.0, 0.0, 230.0, 40.0, 120.0, 160.0, 10.0, 30.0, 0.0, 40.0, 170.0, 80.0, 20.0, 10.0, 0.0, 0.0, 150.0, 30.0, 0.0, 0.0, 10.0, 40.0, 0.0, 300.0, 10.0, 40.0, 60.0, 180.0, 50.0, 100.0, 50.0, 60.0, 10.0, 40.0, 30.0, 20.0, 110.0, 0.0, 30.0, 40.0, 0.0, 40.0, 360.0, 160.0, 50.0, -30.0, 0.0, 30.0, 50.0, 0.0, 0.0, 30.0, 30.0, 40.0, 10.0, 30.0, 180.0, 110.0, 20.0, 0.0, 20.0, 50.0, 20.0, 10.0, 30.0, 60.0, 50.0, 210.0, 15.0, 60.0, 150.0, 500.0, 10.0, 20.0, 0.0, 30.0, 10.0, 20.0, 0.0, 10.0, 70.0, 10.0, 70.0, 20.0, 20.0, 20.0, 50.0, 20.0, 560.0, 10.0, 40.0, 30.0, 20.0, 10.0, 0.0, 100.0, 40.0, 30.0, 80.0, 20.0, 10.0, 70.0, 10.0, 10.0, 40.0, 0.0, 20.0, 0.0, 40.0, 0.0, 50.0, 20.0, 30.0, 250.0, 0.0, 40.0, 20.0, 70.0, 70.0, 0.0, 60.0, 150.0, 90.0, 30.0, 30.0, 220.0, 20.0, 40.0, -30.0, 30.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 30.0, 0.0, 30.0, 20.0, 20.0, 40.0, 150.0, 40.0, 170.0, -40.0, 70.0, 380.0, 20.0, 0.0, 50.0, 70.0, -35.0, 160.0, -50.0, 10.0, -55.0, 5.0, -20.0, -60.0, 20.0, 70.0, 150.0, 60.0, 120.0, 50.0, 100.0, 40.0, 0.0, 10.0, 0.0, 50.0, 40.0, 10.0, 10.0, 0.0, 30.0, 10.0, 60.0, 190.0, 0.0, 50.0, 30.0, 80.0, 0.0, 40.0, 40.0, 40.0, 560.0, -140.0, 20.0, 10.0, 40.0, 30.0, 0.0, 0.0, 20.0, 20.0, 20.0, 0.0, 80.0, 0.0, 50.0, 50.0, 40.0, 80.0, 20.0, 470.0, 360.0, 10.0, 30.0, 40.0, 40.0, 250.0, 70.0, 30.0, 70.0, 0.0, 80.0, 50.0, 0.0, 30.0, 20.0, 0.0, 10.0, 30.0, 40.0, 50.0, 10.0, 0.0, 280.0, 0.0, 30.0, 260.0, 40.0, 0.0, 0.0, 10.0, 40.0, 160.0, 90.0, 30.0, 20.0, 40.0, 150.0, 40.0, 30.0, 0.0, 30.0, 10.0, 0.0, 40.0, 40.0, 80.0, 30.0, 150.0, 50.0, 10.0, 30.0, 10.0, 20.0, 10.0, 0.0, 10.0, 40.0, 40.0, 60.0, 50.0, 30.0, 30.0, 60.0, 40.0, 30.0, 20.0, 10.0, 30.0, 80.0, 20.0, 30.0, 30.0, 30.0, 20.0, 0.0, 10.0, 20.0, 40.0, 10.0, 0.0, 20.0, 10.0, 90.0, 30.0, 180.0, 10.0, 60.0, 0.0, 0.0, 30.0, 100.0, 40.0, 70.0, 0.0, 40.0, 80.0, 30.0, 40.0, 170.0, -30.0, 30.0, 200.0, 10.0, 40.0, 20.0, 30.0, 260.0, 50.0, 20.0, 30.0, 40.0, 80.0, 20.0, 10.0, 190.0, 10.0, 0.0, 30.0, 40.0, 20.0, 30.0, 0.0, 20.0, 250.0, 30.0, 170.0, 20.0, 80.0, -5.0, 40.0, 30.0, 0.0, 290.0, 30.0, 50.0, 40.0, 40.0, 10.0, 30.0, 70.0, 60.0, 150.0, 110.0, 0.0, 60.0, 0.0, 40.0, 20.0, 70.0, 10.0, 20.0, 10.0, 10.0, 10.0, 60.0, 10.0, 70.0, 250.0, 40.0, 70.0, 275.0, 80.0, 100.0, 30.0, 10.0, 20.0, 10.0, 30.0, 80.0, 10.0, 10.0, 0.0, 0.0, 10.0, 70.0, 10.0, 30.0, 0.0, 0.0, 260.0, 60.0, 60.0, 40.0, 110.0, 20.0, 180.0, 0.0, 20.0, 260.0, 20.0, 20.0, 5.0, 50.0, 30.0, 0.0, 80.0, 20.0, 30.0, 290.0, 20.0, 40.0, 10.0, 0.0, 30.0, 50.0, 20.0, 405.0, 50.0, 910.0, 0.0, 60.0, 60.0, 30.0, 50.0, 40.0, 0.0, 40.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 30.0, 30.0, 10.0, 30.0, 0.0, 20.0, 180.0, 30.0, 0.0, 0.0, 30.0, 20.0, 110.0, 40.0, 20.0, 40.0, 0.0, 0.0, 10.0, 0.0, 40.0, 30.0, 150.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 30.0, 60.0, 45.0, 40.0, 40.0, 360.0, 20.0, 250.0, 50.0, 70.0, -30.0, 20.0, 70.0, 50.0, 70.0, -40.0, 0.0, 70.0, 40.0, 50.0, 50.0, 10.0, 60.0, 30.0, 180.0, 30.0, 30.0, 50.0, 10.0, 10.0, 0.0, 30.0, 30.0, 180.0, 30.0, 0.0, 20.0, 30.0, 0.0, 20.0, 10.0, 80.0, 160.0, 20.0, 120.0, 20.0, 20.0, 40.0, 10.0, 160.0, 20.0, 10.0, 20.0, 0.0, 20.0, 0.0, 0.0, 30.0, 30.0, 30.0, 0.0, 30.0, 40.0, 190.0, 70.0, 80.0, 20.0, 30.0, 0.0, 60.0, 30.0, 0.0, 10.0, 80.0, 10.0, 60.0, 30.0, 170.0, 10.0, 10.0, 160.0, 40.0, 20.0, 40.0, 10.0, 0.0, 20.0, 20.0, 40.0, 60.0, 40.0, 30.0, 10.0, 0.0, 0.0, 50.0, 10.0, 10.0, 10.0, 30.0, 0.0, 10.0, 20.0, 20.0, 40.0, 20.0, 30.0, 170.0, 120.0, 70.0, 30.0, 160.0, 100.0, 20.0, 100.0, 290.0, 0.0, -30.0, 30.0, 110.0, 220.0, 40.0, 15.0, 40.0, 0.0, 20.0, 150.0, 40.0, 30.0, 160.0, 60.0, 20.0, 0.0, 200.0, 10.0, 60.0, 30.0, 20.0, 30.0, 30.0, 50.0, 10.0, 20.0, 155.0, 0.0, 10.0, 60.0, 150.0, 0.0, 15.0, 20.0, 0.0, 90.0, 60.0, 20.0, 20.0, -30.0, 50.0, 160.0, 250.0, 120.0, 160.0, 40.0, 80.0, 50.0, 20.0, 20.0, 60.0, 290.0, 30.0, 90.0, -100.0, 40.0, 20.0, 80.0, 20.0, 110.0, 40.0, 0.0, 20.0, 40.0, 0.0, 10.0, 40.0, 50.0, 40.0, 30.0, 40.0, 30.0, 20.0, 20.0, 20.0, 40.0, 120.0, 190.0, 0.0, 170.0, 0.0, 10.0, 30.0, 40.0, 60.0, 10.0, 510.0, 40.0, 50.0, 250.0, -30.0, 20.0, 70.0, 70.0, -40.0, 40.0, 10.0, 0.0, 70.0, 50.0, 40.0, 30.0, 20.0, 20.0, 100.0, 40.0, 10.0, 0.0, 20.0, 150.0, 20.0, 0.0, 90.0, 20.0, 180.0, 0.0, 10.0, 0.0, 60.0, 60.0, 30.0, 30.0, 0.0, 20.0, 40.0, 50.0, 50.0, 480.0, 190.0, 120.0, 60.0, 10.0, 0.0, 200.0, 60.0, 20.0, 0.0, 40.0, 40.0, 0.0, 10.0, 40.0, 20.0, 20.0, 30.0, 20.0, 0.0, 30.0, 170.0, 30.0, 0.0, 10.0, 20.0, 30.0, 0.0, 70.0, 10.0, 30.0, 10.0, 10.0, 180.0, 60.0, 0.0, 80.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5547710187461024, "mean_inference_ms": 1.7558385859358259, "mean_action_processing_ms": 0.4548032633017449, "mean_env_wait_ms": 1.4075716676472034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05799579620361328, "StateBufferConnector_ms": 0.009226560592651367, "ViewRequirementAgentConnector_ms": 0.3672811985015869}, "num_episodes": 18, "episode_return_max": 1635.0, "episode_return_min": 45.0, "episode_return_mean": 523.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.19195784365323, "num_env_steps_trained_throughput_per_sec": 36.19195784365323, "timesteps_total": 204000, "num_env_steps_sampled_lifetime": 204000, "num_agent_steps_sampled_lifetime": 2040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2040000, "timers": {"training_iteration_time_ms": 110367.207, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110367.157, "sample_time_ms": 2416.086, "learn_time_ms": 107931.366, "learn_throughput": 37.061, "synch_weights_time_ms": 11.043}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 2040000, "num_agent_steps_trained": 2040000}, "done": false, "training_iteration": 51, "trial_id": "57140_00000", "date": "2024-06-27_00-53-37", "timestamp": 1719464017, "time_this_iter_s": 110.53295516967773, "time_total_s": 5943.1697652339935, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af43a8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 5943.1697652339935, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 15.485897435897437, "ram_util_percent": 78.94871794871794}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9662936823944441, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.1968394077624, "policy_loss": -0.005444400500420866, "vf_loss": 4.201500239057409, "vf_explained_var": 0.0009086225487299748, "kl": 0.007835716181782392, "entropy": 0.6317253748639323, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 483585.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "env_runners": {"episode_reward_max": 1635.0, "episode_reward_min": 45.0, "episode_reward_mean": 515.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 910.0}, "policy_reward_mean": {"policy_0": 51.515}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1160.0, 140.0, 200.0, 260.0, 880.0, 260.0, 850.0, 320.0, 650.0, 490.0, 1105.0, 180.0, 840.0, 380.0, 190.0, 690.0, 450.0, 190.0, 910.0, 45.0, 580.0, 400.0, 680.0, 210.0, 1150.0, 620.0, 440.0, 660.0, 360.0, 430.0, 360.0, 300.0, 230.0, 490.0, 610.0, 560.0, 590.0, 685.0, 560.0, 250.0, 985.0, 180.0, 640.0, 605.0, 520.0, 1635.0, 150.0, 330.0, 280.0, 340.0, 865.0, 370.0, 430.0, 400.0, 580.0, 160.0, 520.0, 580.0, 280.0, 130.0, 680.0, 880.0, 535.0, 440.0, 430.0, 900.0, 580.0, 370.0, 300.0, 660.0, 950.0, 380.0, 530.0, 250.0, 1220.0, 220.0, 310.0, 480.0, 1220.0, 460.0, 510.0, 450.0, 200.0, 470.0, 420.0, 160.0, 800.0, 500.0, 470.0, 200.0, 930.0, 335.0, 230.0, 460.0, 440.0, 340.0, 630.0, 180.0, 130.0, 1530.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 50.0, 30.0, 360.0, 40.0, 370.0, 150.0, 60.0, 10.0, 50.0, 30.0, 0.0, 20.0, 0.0, 10.0, 30.0, 10.0, 0.0, 10.0, 30.0, 40.0, 10.0, 10.0, 30.0, 10.0, 30.0, 20.0, 10.0, 30.0, 10.0, 40.0, 0.0, 60.0, 20.0, 10.0, 20.0, 50.0, 30.0, 30.0, 0.0, 230.0, 40.0, 120.0, 160.0, 10.0, 30.0, 0.0, 40.0, 170.0, 80.0, 20.0, 10.0, 0.0, 0.0, 150.0, 30.0, 0.0, 0.0, 10.0, 40.0, 0.0, 300.0, 10.0, 40.0, 60.0, 180.0, 50.0, 100.0, 50.0, 60.0, 10.0, 40.0, 30.0, 20.0, 110.0, 0.0, 30.0, 40.0, 0.0, 40.0, 360.0, 160.0, 50.0, -30.0, 0.0, 30.0, 50.0, 0.0, 0.0, 30.0, 30.0, 40.0, 10.0, 30.0, 180.0, 110.0, 20.0, 0.0, 20.0, 50.0, 20.0, 10.0, 30.0, 60.0, 50.0, 210.0, 15.0, 60.0, 150.0, 500.0, 10.0, 20.0, 0.0, 30.0, 10.0, 20.0, 0.0, 10.0, 70.0, 10.0, 70.0, 20.0, 20.0, 20.0, 50.0, 20.0, 560.0, 10.0, 40.0, 30.0, 20.0, 10.0, 0.0, 100.0, 40.0, 30.0, 80.0, 20.0, 10.0, 70.0, 10.0, 10.0, 40.0, 0.0, 20.0, 0.0, 40.0, 0.0, 50.0, 20.0, 30.0, 250.0, 0.0, 40.0, 20.0, 70.0, 70.0, 0.0, 60.0, 150.0, 90.0, 30.0, 30.0, 220.0, 20.0, 40.0, -30.0, 30.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 30.0, 0.0, 30.0, 20.0, 20.0, 40.0, 150.0, 40.0, 170.0, -40.0, 70.0, 380.0, 20.0, 0.0, 50.0, 70.0, -35.0, 160.0, -50.0, 10.0, -55.0, 5.0, -20.0, -60.0, 20.0, 70.0, 150.0, 60.0, 120.0, 50.0, 100.0, 40.0, 0.0, 10.0, 0.0, 50.0, 40.0, 10.0, 10.0, 0.0, 30.0, 10.0, 60.0, 190.0, 0.0, 50.0, 30.0, 80.0, 0.0, 40.0, 40.0, 40.0, 560.0, -140.0, 20.0, 10.0, 40.0, 30.0, 0.0, 0.0, 20.0, 20.0, 20.0, 0.0, 80.0, 0.0, 50.0, 50.0, 40.0, 80.0, 20.0, 470.0, 360.0, 10.0, 30.0, 40.0, 40.0, 250.0, 70.0, 30.0, 70.0, 0.0, 80.0, 50.0, 0.0, 30.0, 20.0, 0.0, 10.0, 30.0, 40.0, 50.0, 10.0, 0.0, 280.0, 0.0, 30.0, 260.0, 40.0, 0.0, 0.0, 10.0, 40.0, 160.0, 90.0, 30.0, 20.0, 40.0, 150.0, 40.0, 30.0, 0.0, 30.0, 10.0, 0.0, 40.0, 40.0, 80.0, 30.0, 150.0, 50.0, 10.0, 30.0, 10.0, 20.0, 10.0, 0.0, 10.0, 40.0, 40.0, 60.0, 50.0, 30.0, 30.0, 60.0, 40.0, 30.0, 20.0, 10.0, 30.0, 80.0, 20.0, 30.0, 30.0, 30.0, 20.0, 0.0, 10.0, 20.0, 40.0, 10.0, 0.0, 20.0, 10.0, 90.0, 30.0, 180.0, 10.0, 60.0, 0.0, 0.0, 30.0, 100.0, 40.0, 70.0, 0.0, 40.0, 80.0, 30.0, 40.0, 170.0, -30.0, 30.0, 200.0, 10.0, 40.0, 20.0, 30.0, 260.0, 50.0, 20.0, 30.0, 40.0, 80.0, 20.0, 10.0, 190.0, 10.0, 0.0, 30.0, 40.0, 20.0, 30.0, 0.0, 20.0, 250.0, 30.0, 170.0, 20.0, 80.0, -5.0, 40.0, 30.0, 0.0, 290.0, 30.0, 50.0, 40.0, 40.0, 10.0, 30.0, 70.0, 60.0, 150.0, 110.0, 0.0, 60.0, 0.0, 40.0, 20.0, 70.0, 10.0, 20.0, 10.0, 10.0, 10.0, 60.0, 10.0, 70.0, 250.0, 40.0, 70.0, 275.0, 80.0, 100.0, 30.0, 10.0, 20.0, 10.0, 30.0, 80.0, 10.0, 10.0, 0.0, 0.0, 10.0, 70.0, 10.0, 30.0, 0.0, 0.0, 260.0, 60.0, 60.0, 40.0, 110.0, 20.0, 180.0, 0.0, 20.0, 260.0, 20.0, 20.0, 5.0, 50.0, 30.0, 0.0, 80.0, 20.0, 30.0, 290.0, 20.0, 40.0, 10.0, 0.0, 30.0, 50.0, 20.0, 405.0, 50.0, 910.0, 0.0, 60.0, 60.0, 30.0, 50.0, 40.0, 0.0, 40.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 30.0, 30.0, 10.0, 30.0, 0.0, 20.0, 180.0, 30.0, 0.0, 0.0, 30.0, 20.0, 110.0, 40.0, 20.0, 40.0, 0.0, 0.0, 10.0, 0.0, 40.0, 30.0, 150.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 30.0, 60.0, 45.0, 40.0, 40.0, 360.0, 20.0, 250.0, 50.0, 70.0, -30.0, 20.0, 70.0, 50.0, 70.0, -40.0, 0.0, 70.0, 40.0, 50.0, 50.0, 10.0, 60.0, 30.0, 180.0, 30.0, 30.0, 50.0, 10.0, 10.0, 0.0, 30.0, 30.0, 180.0, 30.0, 0.0, 20.0, 30.0, 0.0, 20.0, 10.0, 80.0, 160.0, 20.0, 120.0, 20.0, 20.0, 40.0, 10.0, 160.0, 20.0, 10.0, 20.0, 0.0, 20.0, 0.0, 0.0, 30.0, 30.0, 30.0, 0.0, 30.0, 40.0, 190.0, 70.0, 80.0, 20.0, 30.0, 0.0, 60.0, 30.0, 0.0, 10.0, 80.0, 10.0, 60.0, 30.0, 170.0, 10.0, 10.0, 160.0, 40.0, 20.0, 40.0, 10.0, 0.0, 20.0, 20.0, 40.0, 60.0, 40.0, 30.0, 10.0, 0.0, 0.0, 50.0, 10.0, 10.0, 10.0, 30.0, 0.0, 10.0, 20.0, 20.0, 40.0, 20.0, 30.0, 170.0, 120.0, 70.0, 30.0, 160.0, 100.0, 20.0, 100.0, 290.0, 0.0, -30.0, 30.0, 110.0, 220.0, 40.0, 15.0, 40.0, 0.0, 20.0, 150.0, 40.0, 30.0, 160.0, 60.0, 20.0, 0.0, 200.0, 10.0, 60.0, 30.0, 20.0, 30.0, 30.0, 50.0, 10.0, 20.0, 155.0, 0.0, 10.0, 60.0, 150.0, 0.0, 15.0, 20.0, 0.0, 90.0, 60.0, 20.0, 20.0, -30.0, 50.0, 160.0, 250.0, 120.0, 160.0, 40.0, 80.0, 50.0, 20.0, 20.0, 60.0, 290.0, 30.0, 90.0, -100.0, 40.0, 20.0, 80.0, 20.0, 110.0, 40.0, 0.0, 20.0, 40.0, 0.0, 10.0, 40.0, 50.0, 40.0, 30.0, 40.0, 30.0, 20.0, 20.0, 20.0, 40.0, 120.0, 190.0, 0.0, 170.0, 0.0, 10.0, 30.0, 40.0, 60.0, 10.0, 510.0, 40.0, 50.0, 250.0, -30.0, 20.0, 70.0, 70.0, -40.0, 40.0, 10.0, 0.0, 70.0, 50.0, 40.0, 30.0, 20.0, 20.0, 100.0, 40.0, 10.0, 0.0, 20.0, 150.0, 20.0, 0.0, 90.0, 20.0, 180.0, 0.0, 10.0, 0.0, 60.0, 60.0, 30.0, 30.0, 0.0, 20.0, 40.0, 50.0, 50.0, 480.0, 190.0, 120.0, 60.0, 10.0, 0.0, 200.0, 60.0, 20.0, 0.0, 40.0, 40.0, 0.0, 10.0, 40.0, 20.0, 20.0, 30.0, 20.0, 0.0, 30.0, 170.0, 30.0, 0.0, 10.0, 20.0, 30.0, 0.0, 70.0, 10.0, 30.0, 10.0, 10.0, 180.0, 60.0, 0.0, 80.0, 30.0, 260.0, 160.0, 20.0, 20.0, -10.0, 80.0, 60.0, 360.0, 70.0, 200.0, 0.0, 30.0, 60.0, 50.0, 270.0, 30.0, 10.0, 10.0, 0.0, 0.0, 40.0, 110.0, -50.0, 20.0, 70.0, 10.0, 80.0, -130.0, 390.0, -30.0, 30.0, 40.0, 40.0, 10.0, 30.0, 190.0, 20.0, 50.0, 10.0, 30.0, 0.0, 0.0, 90.0, 80.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 30.0, 20.0, 30.0, 110.0, 20.0, 50.0, 0.0, 170.0, 40.0, 0.0, 20.0, 30.0, 30.0, 40.0, 0.0, 40.0, 20.0, 190.0, 50.0, 30.0, 40.0, 10.0, 0.0, 10.0, 30.0, 30.0, 0.0, 0.0, 10.0, 10.0, 170.0, 0.0, 30.0, 20.0, 20.0, 100.0, 20.0, 360.0, 70.0, 30.0, 20.0, 10.0, 0.0, 30.0, 10.0, 30.0, 0.0, 10.0, 360.0, 0.0, 0.0, 20.0, 30.0, 10.0, 20.0, 370.0, -30.0, 20.0, 30.0, 40.0, 20.0, 30.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 40.0, 150.0, 10.0, 50.0, 10.0, 320.0, 40.0, 250.0, 70.0, -10.0, 160.0, 5.0, 50.0, 100.0, -15.0, -10.0, 60.0, 50.0, -25.0, -40.0, 30.0, 70.0, 0.0, 80.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 80.0, 40.0, 90.0, 30.0, 0.0, 50.0, 80.0, 60.0, 10.0, 60.0, 30.0, 0.0, 20.0, 60.0, 20.0, 30.0, 50.0, 0.0, 170.0, 0.0, 30.0, 40.0, 60.0, 10.0, 40.0, 10.0, 30.0, 100.0, 20.0, 40.0, 10.0, 40.0, 40.0, 460.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 40.0, 0.0, 50.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 40.0, 30.0, 20.0, 0.0, 20.0, 0.0, -20.0, 40.0, 30.0, 130.0, 370.0, 70.0, 330.0, 100.0, 70.0, 290.0, 10.0, 130.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5502301520607222, "mean_inference_ms": 1.7510783645230965, "mean_action_processing_ms": 0.45345151775811443, "mean_env_wait_ms": 1.404331581590862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05660581588745117, "StateBufferConnector_ms": 0.009221553802490234, "ViewRequirementAgentConnector_ms": 0.36628293991088867}, "num_episodes": 22, "episode_return_max": 1635.0, "episode_return_min": 45.0, "episode_return_mean": 515.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.11254478529115, "num_env_steps_trained_throughput_per_sec": 36.11254478529115, "timesteps_total": 208000, "num_env_steps_sampled_lifetime": 208000, "num_agent_steps_sampled_lifetime": 2080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2080000, "timers": {"training_iteration_time_ms": 110467.441, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110467.392, "sample_time_ms": 2401.364, "learn_time_ms": 108046.133, "learn_throughput": 37.021, "synch_weights_time_ms": 11.265}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 2080000, "num_agent_steps_trained": 2080000}, "done": false, "training_iteration": 52, "trial_id": "57140_00000", "date": "2024-06-27_00-55-27", "timestamp": 1719464127, "time_this_iter_s": 110.77711319923401, "time_total_s": 6053.9468784332275, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af42e9d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6053.9468784332275, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 17.346496815286624, "ram_util_percent": 79.06624203821656}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1781999423385807, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.8651188781594064, "policy_loss": -0.008141167596809733, "vf_loss": 3.872379247880718, "vf_explained_var": 0.0014267222505534927, "kl": 0.008807984604483732, "entropy": 0.6230501597205671, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 492975.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000}, "env_runners": {"episode_reward_max": 1635.0, "episode_reward_min": -90.0, "episode_reward_mean": 517.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -380.0}, "policy_reward_max": {"policy_0": 910.0}, "policy_reward_mean": {"policy_0": 51.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [210.0, 1150.0, 620.0, 440.0, 660.0, 360.0, 430.0, 360.0, 300.0, 230.0, 490.0, 610.0, 560.0, 590.0, 685.0, 560.0, 250.0, 985.0, 180.0, 640.0, 605.0, 520.0, 1635.0, 150.0, 330.0, 280.0, 340.0, 865.0, 370.0, 430.0, 400.0, 580.0, 160.0, 520.0, 580.0, 280.0, 130.0, 680.0, 880.0, 535.0, 440.0, 430.0, 900.0, 580.0, 370.0, 300.0, 660.0, 950.0, 380.0, 530.0, 250.0, 1220.0, 220.0, 310.0, 480.0, 1220.0, 460.0, 510.0, 450.0, 200.0, 470.0, 420.0, 160.0, 800.0, 500.0, 470.0, 200.0, 930.0, 335.0, 230.0, 460.0, 440.0, 340.0, 630.0, 180.0, 130.0, 1530.0, 550.0, 1240.0, 780.0, 170.0, 750.0, 710.0, 650.0, 75.0, 440.0, 410.0, 200.0, 930.0, 1190.0, -90.0, 250.0, 140.0, 160.0, 970.0, 505.0, 570.0, 795.0, 320.0, 370.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 30.0, 0.0, 0.0, 20.0, 20.0, 20.0, 0.0, 80.0, 0.0, 50.0, 50.0, 40.0, 80.0, 20.0, 470.0, 360.0, 10.0, 30.0, 40.0, 40.0, 250.0, 70.0, 30.0, 70.0, 0.0, 80.0, 50.0, 0.0, 30.0, 20.0, 0.0, 10.0, 30.0, 40.0, 50.0, 10.0, 0.0, 280.0, 0.0, 30.0, 260.0, 40.0, 0.0, 0.0, 10.0, 40.0, 160.0, 90.0, 30.0, 20.0, 40.0, 150.0, 40.0, 30.0, 0.0, 30.0, 10.0, 0.0, 40.0, 40.0, 80.0, 30.0, 150.0, 50.0, 10.0, 30.0, 10.0, 20.0, 10.0, 0.0, 10.0, 40.0, 40.0, 60.0, 50.0, 30.0, 30.0, 60.0, 40.0, 30.0, 20.0, 10.0, 30.0, 80.0, 20.0, 30.0, 30.0, 30.0, 20.0, 0.0, 10.0, 20.0, 40.0, 10.0, 0.0, 20.0, 10.0, 90.0, 30.0, 180.0, 10.0, 60.0, 0.0, 0.0, 30.0, 100.0, 40.0, 70.0, 0.0, 40.0, 80.0, 30.0, 40.0, 170.0, -30.0, 30.0, 200.0, 10.0, 40.0, 20.0, 30.0, 260.0, 50.0, 20.0, 30.0, 40.0, 80.0, 20.0, 10.0, 190.0, 10.0, 0.0, 30.0, 40.0, 20.0, 30.0, 0.0, 20.0, 250.0, 30.0, 170.0, 20.0, 80.0, -5.0, 40.0, 30.0, 0.0, 290.0, 30.0, 50.0, 40.0, 40.0, 10.0, 30.0, 70.0, 60.0, 150.0, 110.0, 0.0, 60.0, 0.0, 40.0, 20.0, 70.0, 10.0, 20.0, 10.0, 10.0, 10.0, 60.0, 10.0, 70.0, 250.0, 40.0, 70.0, 275.0, 80.0, 100.0, 30.0, 10.0, 20.0, 10.0, 30.0, 80.0, 10.0, 10.0, 0.0, 0.0, 10.0, 70.0, 10.0, 30.0, 0.0, 0.0, 260.0, 60.0, 60.0, 40.0, 110.0, 20.0, 180.0, 0.0, 20.0, 260.0, 20.0, 20.0, 5.0, 50.0, 30.0, 0.0, 80.0, 20.0, 30.0, 290.0, 20.0, 40.0, 10.0, 0.0, 30.0, 50.0, 20.0, 405.0, 50.0, 910.0, 0.0, 60.0, 60.0, 30.0, 50.0, 40.0, 0.0, 40.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 30.0, 30.0, 10.0, 30.0, 0.0, 20.0, 180.0, 30.0, 0.0, 0.0, 30.0, 20.0, 110.0, 40.0, 20.0, 40.0, 0.0, 0.0, 10.0, 0.0, 40.0, 30.0, 150.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 30.0, 60.0, 45.0, 40.0, 40.0, 360.0, 20.0, 250.0, 50.0, 70.0, -30.0, 20.0, 70.0, 50.0, 70.0, -40.0, 0.0, 70.0, 40.0, 50.0, 50.0, 10.0, 60.0, 30.0, 180.0, 30.0, 30.0, 50.0, 10.0, 10.0, 0.0, 30.0, 30.0, 180.0, 30.0, 0.0, 20.0, 30.0, 0.0, 20.0, 10.0, 80.0, 160.0, 20.0, 120.0, 20.0, 20.0, 40.0, 10.0, 160.0, 20.0, 10.0, 20.0, 0.0, 20.0, 0.0, 0.0, 30.0, 30.0, 30.0, 0.0, 30.0, 40.0, 190.0, 70.0, 80.0, 20.0, 30.0, 0.0, 60.0, 30.0, 0.0, 10.0, 80.0, 10.0, 60.0, 30.0, 170.0, 10.0, 10.0, 160.0, 40.0, 20.0, 40.0, 10.0, 0.0, 20.0, 20.0, 40.0, 60.0, 40.0, 30.0, 10.0, 0.0, 0.0, 50.0, 10.0, 10.0, 10.0, 30.0, 0.0, 10.0, 20.0, 20.0, 40.0, 20.0, 30.0, 170.0, 120.0, 70.0, 30.0, 160.0, 100.0, 20.0, 100.0, 290.0, 0.0, -30.0, 30.0, 110.0, 220.0, 40.0, 15.0, 40.0, 0.0, 20.0, 150.0, 40.0, 30.0, 160.0, 60.0, 20.0, 0.0, 200.0, 10.0, 60.0, 30.0, 20.0, 30.0, 30.0, 50.0, 10.0, 20.0, 155.0, 0.0, 10.0, 60.0, 150.0, 0.0, 15.0, 20.0, 0.0, 90.0, 60.0, 20.0, 20.0, -30.0, 50.0, 160.0, 250.0, 120.0, 160.0, 40.0, 80.0, 50.0, 20.0, 20.0, 60.0, 290.0, 30.0, 90.0, -100.0, 40.0, 20.0, 80.0, 20.0, 110.0, 40.0, 0.0, 20.0, 40.0, 0.0, 10.0, 40.0, 50.0, 40.0, 30.0, 40.0, 30.0, 20.0, 20.0, 20.0, 40.0, 120.0, 190.0, 0.0, 170.0, 0.0, 10.0, 30.0, 40.0, 60.0, 10.0, 510.0, 40.0, 50.0, 250.0, -30.0, 20.0, 70.0, 70.0, -40.0, 40.0, 10.0, 0.0, 70.0, 50.0, 40.0, 30.0, 20.0, 20.0, 100.0, 40.0, 10.0, 0.0, 20.0, 150.0, 20.0, 0.0, 90.0, 20.0, 180.0, 0.0, 10.0, 0.0, 60.0, 60.0, 30.0, 30.0, 0.0, 20.0, 40.0, 50.0, 50.0, 480.0, 190.0, 120.0, 60.0, 10.0, 0.0, 200.0, 60.0, 20.0, 0.0, 40.0, 40.0, 0.0, 10.0, 40.0, 20.0, 20.0, 30.0, 20.0, 0.0, 30.0, 170.0, 30.0, 0.0, 10.0, 20.0, 30.0, 0.0, 70.0, 10.0, 30.0, 10.0, 10.0, 180.0, 60.0, 0.0, 80.0, 30.0, 260.0, 160.0, 20.0, 20.0, -10.0, 80.0, 60.0, 360.0, 70.0, 200.0, 0.0, 30.0, 60.0, 50.0, 270.0, 30.0, 10.0, 10.0, 0.0, 0.0, 40.0, 110.0, -50.0, 20.0, 70.0, 10.0, 80.0, -130.0, 390.0, -30.0, 30.0, 40.0, 40.0, 10.0, 30.0, 190.0, 20.0, 50.0, 10.0, 30.0, 0.0, 0.0, 90.0, 80.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 30.0, 20.0, 30.0, 110.0, 20.0, 50.0, 0.0, 170.0, 40.0, 0.0, 20.0, 30.0, 30.0, 40.0, 0.0, 40.0, 20.0, 190.0, 50.0, 30.0, 40.0, 10.0, 0.0, 10.0, 30.0, 30.0, 0.0, 0.0, 10.0, 10.0, 170.0, 0.0, 30.0, 20.0, 20.0, 100.0, 20.0, 360.0, 70.0, 30.0, 20.0, 10.0, 0.0, 30.0, 10.0, 30.0, 0.0, 10.0, 360.0, 0.0, 0.0, 20.0, 30.0, 10.0, 20.0, 370.0, -30.0, 20.0, 30.0, 40.0, 20.0, 30.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 40.0, 150.0, 10.0, 50.0, 10.0, 320.0, 40.0, 250.0, 70.0, -10.0, 160.0, 5.0, 50.0, 100.0, -15.0, -10.0, 60.0, 50.0, -25.0, -40.0, 30.0, 70.0, 0.0, 80.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 80.0, 40.0, 90.0, 30.0, 0.0, 50.0, 80.0, 60.0, 10.0, 60.0, 30.0, 0.0, 20.0, 60.0, 20.0, 30.0, 50.0, 0.0, 170.0, 0.0, 30.0, 40.0, 60.0, 10.0, 40.0, 10.0, 30.0, 100.0, 20.0, 40.0, 10.0, 40.0, 40.0, 460.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 40.0, 0.0, 50.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 40.0, 30.0, 20.0, 0.0, 20.0, 0.0, -20.0, 40.0, 30.0, 130.0, 370.0, 70.0, 330.0, 100.0, 70.0, 290.0, 10.0, 130.0, 0.0, 0.0, 30.0, 30.0, 50.0, 30.0, 70.0, 40.0, 30.0, 270.0, 40.0, 170.0, 660.0, 0.0, 160.0, 50.0, 80.0, 30.0, 0.0, 50.0, 40.0, 5.0, 180.0, 5.0, 40.0, 40.0, 80.0, 380.0, 10.0, 0.0, 40.0, 20.0, 0.0, 20.0, 20.0, 0.0, 20.0, 10.0, 30.0, 10.0, 40.0, 40.0, -40.0, 10.0, 20.0, 40.0, 130.0, 50.0, 10.0, 450.0, 270.0, 20.0, 20.0, 20.0, 20.0, 0.0, 160.0, 60.0, 60.0, 80.0, 60.0, 30.0, 50.0, 150.0, 60.0, 170.0, 60.0, 30.0, 30.0, 10.0, 20.0, 60.0, -185.0, 20.0, 180.0, -30.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0, 0.0, 80.0, 130.0, 50.0, 70.0, 10.0, 20.0, 20.0, 0.0, 0.0, 250.0, 50.0, 10.0, 10.0, 40.0, 20.0, 10.0, 20.0, 20.0, 20.0, 40.0, 0.0, 10.0, 10.0, 30.0, 40.0, 10.0, 20.0, 20.0, 460.0, 70.0, 30.0, 200.0, 70.0, 10.0, 30.0, 0.0, 40.0, 180.0, 0.0, 280.0, 80.0, 40.0, 170.0, 30.0, 330.0, 40.0, 40.0, 150.0, 0.0, 0.0, 30.0, 10.0, 30.0, 30.0, 20.0, -380.0, 20.0, 10.0, 0.0, 110.0, 30.0, 0.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 0.0, 0.0, 20.0, 30.0, 50.0, 0.0, 0.0, 0.0, 20.0, 0.0, 30.0, 10.0, 0.0, 50.0, 20.0, 0.0, 10.0, 10.0, 30.0, 50.0, 70.0, -10.0, 40.0, 50.0, 160.0, 60.0, 10.0, 500.0, 40.0, 70.0, 30.0, 40.0, -5.0, 40.0, 10.0, 90.0, 30.0, 20.0, 180.0, 10.0, 0.0, 10.0, 270.0, 70.0, 40.0, 80.0, 40.0, 30.0, 20.0, 10.0, 0.0, 305.0, 0.0, 20.0, 90.0, 100.0, 180.0, 20.0, 70.0, 10.0, 20.0, 30.0, 40.0, 20.0, 10.0, 50.0, 10.0, 70.0, 60.0, 40.0, 10.0, 10.0, 30.0, 40.0, 40.0, 20.0, 0.0, 140.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5455336004764029, "mean_inference_ms": 1.74625068585169, "mean_action_processing_ms": 0.4521237481609129, "mean_env_wait_ms": 1.40113498653512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05594038963317871, "StateBufferConnector_ms": 0.00915670394897461, "ViewRequirementAgentConnector_ms": 0.3677096366882324}, "num_episodes": 23, "episode_return_max": 1635.0, "episode_return_min": -90.0, "episode_return_mean": 517.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.22042579158438, "num_env_steps_trained_throughput_per_sec": 36.22042579158438, "timesteps_total": 212000, "num_env_steps_sampled_lifetime": 212000, "num_agent_steps_sampled_lifetime": 2120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2120000, "timers": {"training_iteration_time_ms": 110500.462, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110500.413, "sample_time_ms": 2399.697, "learn_time_ms": 108081.09, "learn_throughput": 37.009, "synch_weights_time_ms": 11.253}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 2120000, "num_agent_steps_trained": 2120000}, "done": false, "training_iteration": 53, "trial_id": "57140_00000", "date": "2024-06-27_00-57-18", "timestamp": 1719464238, "time_this_iter_s": 110.45083403587341, "time_total_s": 6164.397712469101, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af404820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6164.397712469101, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 16.723076923076924, "ram_util_percent": 78.89358974358974}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8266980568885296, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.525580774658658, "policy_loss": -0.004923194296634731, "vf_loss": 4.529777116694262, "vf_explained_var": 0.0012090565424503737, "kl": 0.007268581803627824, "entropy": 0.6097673543694174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 502365.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "env_runners": {"episode_reward_max": 1635.0, "episode_reward_min": -90.0, "episode_reward_mean": 518.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -380.0}, "policy_reward_max": {"policy_0": 910.0}, "policy_reward_mean": {"policy_0": 51.865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.0, 640.0, 605.0, 520.0, 1635.0, 150.0, 330.0, 280.0, 340.0, 865.0, 370.0, 430.0, 400.0, 580.0, 160.0, 520.0, 580.0, 280.0, 130.0, 680.0, 880.0, 535.0, 440.0, 430.0, 900.0, 580.0, 370.0, 300.0, 660.0, 950.0, 380.0, 530.0, 250.0, 1220.0, 220.0, 310.0, 480.0, 1220.0, 460.0, 510.0, 450.0, 200.0, 470.0, 420.0, 160.0, 800.0, 500.0, 470.0, 200.0, 930.0, 335.0, 230.0, 460.0, 440.0, 340.0, 630.0, 180.0, 130.0, 1530.0, 550.0, 1240.0, 780.0, 170.0, 750.0, 710.0, 650.0, 75.0, 440.0, 410.0, 200.0, 930.0, 1190.0, -90.0, 250.0, 140.0, 160.0, 970.0, 505.0, 570.0, 795.0, 320.0, 370.0, 245.0, 210.0, 690.0, 920.0, 1030.0, 320.0, 440.0, 660.0, 240.0, 910.0, 310.0, 535.0, 800.0, 280.0, 255.0, 1130.0, 250.0, 380.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 20.0, 10.0, 30.0, 80.0, 10.0, 10.0, 0.0, 0.0, 10.0, 70.0, 10.0, 30.0, 0.0, 0.0, 260.0, 60.0, 60.0, 40.0, 110.0, 20.0, 180.0, 0.0, 20.0, 260.0, 20.0, 20.0, 5.0, 50.0, 30.0, 0.0, 80.0, 20.0, 30.0, 290.0, 20.0, 40.0, 10.0, 0.0, 30.0, 50.0, 20.0, 405.0, 50.0, 910.0, 0.0, 60.0, 60.0, 30.0, 50.0, 40.0, 0.0, 40.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 30.0, 30.0, 10.0, 30.0, 0.0, 20.0, 180.0, 30.0, 0.0, 0.0, 30.0, 20.0, 110.0, 40.0, 20.0, 40.0, 0.0, 0.0, 10.0, 0.0, 40.0, 30.0, 150.0, 20.0, 10.0, 0.0, 20.0, 10.0, 10.0, 30.0, 60.0, 45.0, 40.0, 40.0, 360.0, 20.0, 250.0, 50.0, 70.0, -30.0, 20.0, 70.0, 50.0, 70.0, -40.0, 0.0, 70.0, 40.0, 50.0, 50.0, 10.0, 60.0, 30.0, 180.0, 30.0, 30.0, 50.0, 10.0, 10.0, 0.0, 30.0, 30.0, 180.0, 30.0, 0.0, 20.0, 30.0, 0.0, 20.0, 10.0, 80.0, 160.0, 20.0, 120.0, 20.0, 20.0, 40.0, 10.0, 160.0, 20.0, 10.0, 20.0, 0.0, 20.0, 0.0, 0.0, 30.0, 30.0, 30.0, 0.0, 30.0, 40.0, 190.0, 70.0, 80.0, 20.0, 30.0, 0.0, 60.0, 30.0, 0.0, 10.0, 80.0, 10.0, 60.0, 30.0, 170.0, 10.0, 10.0, 160.0, 40.0, 20.0, 40.0, 10.0, 0.0, 20.0, 20.0, 40.0, 60.0, 40.0, 30.0, 10.0, 0.0, 0.0, 50.0, 10.0, 10.0, 10.0, 30.0, 0.0, 10.0, 20.0, 20.0, 40.0, 20.0, 30.0, 170.0, 120.0, 70.0, 30.0, 160.0, 100.0, 20.0, 100.0, 290.0, 0.0, -30.0, 30.0, 110.0, 220.0, 40.0, 15.0, 40.0, 0.0, 20.0, 150.0, 40.0, 30.0, 160.0, 60.0, 20.0, 0.0, 200.0, 10.0, 60.0, 30.0, 20.0, 30.0, 30.0, 50.0, 10.0, 20.0, 155.0, 0.0, 10.0, 60.0, 150.0, 0.0, 15.0, 20.0, 0.0, 90.0, 60.0, 20.0, 20.0, -30.0, 50.0, 160.0, 250.0, 120.0, 160.0, 40.0, 80.0, 50.0, 20.0, 20.0, 60.0, 290.0, 30.0, 90.0, -100.0, 40.0, 20.0, 80.0, 20.0, 110.0, 40.0, 0.0, 20.0, 40.0, 0.0, 10.0, 40.0, 50.0, 40.0, 30.0, 40.0, 30.0, 20.0, 20.0, 20.0, 40.0, 120.0, 190.0, 0.0, 170.0, 0.0, 10.0, 30.0, 40.0, 60.0, 10.0, 510.0, 40.0, 50.0, 250.0, -30.0, 20.0, 70.0, 70.0, -40.0, 40.0, 10.0, 0.0, 70.0, 50.0, 40.0, 30.0, 20.0, 20.0, 100.0, 40.0, 10.0, 0.0, 20.0, 150.0, 20.0, 0.0, 90.0, 20.0, 180.0, 0.0, 10.0, 0.0, 60.0, 60.0, 30.0, 30.0, 0.0, 20.0, 40.0, 50.0, 50.0, 480.0, 190.0, 120.0, 60.0, 10.0, 0.0, 200.0, 60.0, 20.0, 0.0, 40.0, 40.0, 0.0, 10.0, 40.0, 20.0, 20.0, 30.0, 20.0, 0.0, 30.0, 170.0, 30.0, 0.0, 10.0, 20.0, 30.0, 0.0, 70.0, 10.0, 30.0, 10.0, 10.0, 180.0, 60.0, 0.0, 80.0, 30.0, 260.0, 160.0, 20.0, 20.0, -10.0, 80.0, 60.0, 360.0, 70.0, 200.0, 0.0, 30.0, 60.0, 50.0, 270.0, 30.0, 10.0, 10.0, 0.0, 0.0, 40.0, 110.0, -50.0, 20.0, 70.0, 10.0, 80.0, -130.0, 390.0, -30.0, 30.0, 40.0, 40.0, 10.0, 30.0, 190.0, 20.0, 50.0, 10.0, 30.0, 0.0, 0.0, 90.0, 80.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 30.0, 20.0, 30.0, 110.0, 20.0, 50.0, 0.0, 170.0, 40.0, 0.0, 20.0, 30.0, 30.0, 40.0, 0.0, 40.0, 20.0, 190.0, 50.0, 30.0, 40.0, 10.0, 0.0, 10.0, 30.0, 30.0, 0.0, 0.0, 10.0, 10.0, 170.0, 0.0, 30.0, 20.0, 20.0, 100.0, 20.0, 360.0, 70.0, 30.0, 20.0, 10.0, 0.0, 30.0, 10.0, 30.0, 0.0, 10.0, 360.0, 0.0, 0.0, 20.0, 30.0, 10.0, 20.0, 370.0, -30.0, 20.0, 30.0, 40.0, 20.0, 30.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 40.0, 150.0, 10.0, 50.0, 10.0, 320.0, 40.0, 250.0, 70.0, -10.0, 160.0, 5.0, 50.0, 100.0, -15.0, -10.0, 60.0, 50.0, -25.0, -40.0, 30.0, 70.0, 0.0, 80.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 80.0, 40.0, 90.0, 30.0, 0.0, 50.0, 80.0, 60.0, 10.0, 60.0, 30.0, 0.0, 20.0, 60.0, 20.0, 30.0, 50.0, 0.0, 170.0, 0.0, 30.0, 40.0, 60.0, 10.0, 40.0, 10.0, 30.0, 100.0, 20.0, 40.0, 10.0, 40.0, 40.0, 460.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 40.0, 0.0, 50.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 40.0, 30.0, 20.0, 0.0, 20.0, 0.0, -20.0, 40.0, 30.0, 130.0, 370.0, 70.0, 330.0, 100.0, 70.0, 290.0, 10.0, 130.0, 0.0, 0.0, 30.0, 30.0, 50.0, 30.0, 70.0, 40.0, 30.0, 270.0, 40.0, 170.0, 660.0, 0.0, 160.0, 50.0, 80.0, 30.0, 0.0, 50.0, 40.0, 5.0, 180.0, 5.0, 40.0, 40.0, 80.0, 380.0, 10.0, 0.0, 40.0, 20.0, 0.0, 20.0, 20.0, 0.0, 20.0, 10.0, 30.0, 10.0, 40.0, 40.0, -40.0, 10.0, 20.0, 40.0, 130.0, 50.0, 10.0, 450.0, 270.0, 20.0, 20.0, 20.0, 20.0, 0.0, 160.0, 60.0, 60.0, 80.0, 60.0, 30.0, 50.0, 150.0, 60.0, 170.0, 60.0, 30.0, 30.0, 10.0, 20.0, 60.0, -185.0, 20.0, 180.0, -30.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0, 0.0, 80.0, 130.0, 50.0, 70.0, 10.0, 20.0, 20.0, 0.0, 0.0, 250.0, 50.0, 10.0, 10.0, 40.0, 20.0, 10.0, 20.0, 20.0, 20.0, 40.0, 0.0, 10.0, 10.0, 30.0, 40.0, 10.0, 20.0, 20.0, 460.0, 70.0, 30.0, 200.0, 70.0, 10.0, 30.0, 0.0, 40.0, 180.0, 0.0, 280.0, 80.0, 40.0, 170.0, 30.0, 330.0, 40.0, 40.0, 150.0, 0.0, 0.0, 30.0, 10.0, 30.0, 30.0, 20.0, -380.0, 20.0, 10.0, 0.0, 110.0, 30.0, 0.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 0.0, 0.0, 20.0, 30.0, 50.0, 0.0, 0.0, 0.0, 20.0, 0.0, 30.0, 10.0, 0.0, 50.0, 20.0, 0.0, 10.0, 10.0, 30.0, 50.0, 70.0, -10.0, 40.0, 50.0, 160.0, 60.0, 10.0, 500.0, 40.0, 70.0, 30.0, 40.0, -5.0, 40.0, 10.0, 90.0, 30.0, 20.0, 180.0, 10.0, 0.0, 10.0, 270.0, 70.0, 40.0, 80.0, 40.0, 30.0, 20.0, 10.0, 0.0, 305.0, 0.0, 20.0, 90.0, 100.0, 180.0, 20.0, 70.0, 10.0, 20.0, 30.0, 40.0, 20.0, 10.0, 50.0, 10.0, 70.0, 60.0, 40.0, 10.0, 10.0, 30.0, 40.0, 40.0, 20.0, 0.0, 140.0, 40.0, 70.0, 10.0, -15.0, 20.0, 30.0, 30.0, 20.0, -10.0, 20.0, 70.0, 30.0, 50.0, 10.0, 30.0, 0.0, 0.0, 20.0, 10.0, 40.0, 20.0, 20.0, 20.0, 0.0, 30.0, 480.0, 10.0, 20.0, 90.0, 0.0, 20.0, 270.0, 160.0, 10.0, 70.0, 90.0, 50.0, 50.0, 10.0, 170.0, 40.0, 40.0, 70.0, 30.0, 100.0, -10.0, 460.0, 170.0, 150.0, 10.0, 10.0, 40.0, 40.0, 10.0, 70.0, 30.0, 30.0, 20.0, 40.0, 30.0, 10.0, 20.0, 30.0, 60.0, 200.0, 70.0, 30.0, 0.0, 10.0, 20.0, 0.0, -20.0, 310.0, 20.0, 10.0, 10.0, 70.0, 0.0, 160.0, 50.0, 50.0, 20.0, 0.0, 40.0, 40.0, 40.0, 40.0, 10.0, 20.0, 30.0, 0.0, 10.0, 40.0, 90.0, -20.0, 160.0, 210.0, 70.0, 110.0, 190.0, 50.0, 30.0, 20.0, 0.0, 250.0, 20.0, -50.0, 20.0, 20.0, 0.0, 0.0, 30.0, 40.0, 90.0, 0.0, 90.0, -15.0, 180.0, 30.0, 30.0, 60.0, 70.0, 0.0, 90.0, 0.0, 500.0, 50.0, 30.0, 0.0, 50.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 10.0, 0.0, 30.0, 170.0, 20.0, 10.0, 0.0, -5.0, 20.0, 190.0, 0.0, 0.0, 0.0, 30.0, 10.0, 160.0, 230.0, 60.0, 30.0, 30.0, 270.0, 180.0, 170.0, 30.0, -30.0, 40.0, 10.0, 10.0, 0.0, 90.0, 40.0, 30.0, 10.0, 10.0, 10.0, 0.0, 40.0, 50.0, 80.0, 40.0, 0.0, 40.0, 40.0, 50.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5413690834212184, "mean_inference_ms": 1.741771177475824, "mean_action_processing_ms": 0.4509422400770529, "mean_env_wait_ms": 1.398207159583868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05359005928039551, "StateBufferConnector_ms": 0.009053707122802734, "ViewRequirementAgentConnector_ms": 0.36978864669799805}, "num_episodes": 18, "episode_return_max": 1635.0, "episode_return_min": -90.0, "episode_return_mean": 518.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.30383003245562, "num_env_steps_trained_throughput_per_sec": 36.30383003245562, "timesteps_total": 216000, "num_env_steps_sampled_lifetime": 216000, "num_agent_steps_sampled_lifetime": 2160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2160000, "timers": {"training_iteration_time_ms": 110501.145, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110501.097, "sample_time_ms": 2399.489, "learn_time_ms": 108082.051, "learn_throughput": 37.009, "synch_weights_time_ms": 11.111}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 2160000, "num_agent_steps_trained": 2160000}, "done": false, "training_iteration": 54, "trial_id": "57140_00000", "date": "2024-06-27_00-59-08", "timestamp": 1719464348, "time_this_iter_s": 110.1951231956482, "time_total_s": 6274.592835664749, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af42e5e0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6274.592835664749, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 15.835256410256408, "ram_util_percent": 79.01794871794871}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.373281515222261, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.128285786214347, "policy_loss": -0.00623651426669837, "vf_loss": 5.1336893932760965, "vf_explained_var": 0.0021750462131378367, "kl": 0.008329076249271825, "entropy": 0.5765208220932557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 511755.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000}, "env_runners": {"episode_reward_max": 1530.0, "episode_reward_min": -90.0, "episode_reward_mean": 537.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -380.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 53.76}, "custom_metrics": {}, "hist_stats": {"episode_reward": [130.0, 680.0, 880.0, 535.0, 440.0, 430.0, 900.0, 580.0, 370.0, 300.0, 660.0, 950.0, 380.0, 530.0, 250.0, 1220.0, 220.0, 310.0, 480.0, 1220.0, 460.0, 510.0, 450.0, 200.0, 470.0, 420.0, 160.0, 800.0, 500.0, 470.0, 200.0, 930.0, 335.0, 230.0, 460.0, 440.0, 340.0, 630.0, 180.0, 130.0, 1530.0, 550.0, 1240.0, 780.0, 170.0, 750.0, 710.0, 650.0, 75.0, 440.0, 410.0, 200.0, 930.0, 1190.0, -90.0, 250.0, 140.0, 160.0, 970.0, 505.0, 570.0, 795.0, 320.0, 370.0, 245.0, 210.0, 690.0, 920.0, 1030.0, 320.0, 440.0, 660.0, 240.0, 910.0, 310.0, 535.0, 800.0, 280.0, 255.0, 1130.0, 250.0, 380.0, 540.0, 1240.0, 730.0, 210.0, 370.0, 895.0, 600.0, 540.0, 340.0, 645.0, 285.0, 970.0, 850.0, 390.0, 385.0, 500.0, 630.0, 640.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 0.0, 0.0, 50.0, 10.0, 10.0, 10.0, 30.0, 0.0, 10.0, 20.0, 20.0, 40.0, 20.0, 30.0, 170.0, 120.0, 70.0, 30.0, 160.0, 100.0, 20.0, 100.0, 290.0, 0.0, -30.0, 30.0, 110.0, 220.0, 40.0, 15.0, 40.0, 0.0, 20.0, 150.0, 40.0, 30.0, 160.0, 60.0, 20.0, 0.0, 200.0, 10.0, 60.0, 30.0, 20.0, 30.0, 30.0, 50.0, 10.0, 20.0, 155.0, 0.0, 10.0, 60.0, 150.0, 0.0, 15.0, 20.0, 0.0, 90.0, 60.0, 20.0, 20.0, -30.0, 50.0, 160.0, 250.0, 120.0, 160.0, 40.0, 80.0, 50.0, 20.0, 20.0, 60.0, 290.0, 30.0, 90.0, -100.0, 40.0, 20.0, 80.0, 20.0, 110.0, 40.0, 0.0, 20.0, 40.0, 0.0, 10.0, 40.0, 50.0, 40.0, 30.0, 40.0, 30.0, 20.0, 20.0, 20.0, 40.0, 120.0, 190.0, 0.0, 170.0, 0.0, 10.0, 30.0, 40.0, 60.0, 10.0, 510.0, 40.0, 50.0, 250.0, -30.0, 20.0, 70.0, 70.0, -40.0, 40.0, 10.0, 0.0, 70.0, 50.0, 40.0, 30.0, 20.0, 20.0, 100.0, 40.0, 10.0, 0.0, 20.0, 150.0, 20.0, 0.0, 90.0, 20.0, 180.0, 0.0, 10.0, 0.0, 60.0, 60.0, 30.0, 30.0, 0.0, 20.0, 40.0, 50.0, 50.0, 480.0, 190.0, 120.0, 60.0, 10.0, 0.0, 200.0, 60.0, 20.0, 0.0, 40.0, 40.0, 0.0, 10.0, 40.0, 20.0, 20.0, 30.0, 20.0, 0.0, 30.0, 170.0, 30.0, 0.0, 10.0, 20.0, 30.0, 0.0, 70.0, 10.0, 30.0, 10.0, 10.0, 180.0, 60.0, 0.0, 80.0, 30.0, 260.0, 160.0, 20.0, 20.0, -10.0, 80.0, 60.0, 360.0, 70.0, 200.0, 0.0, 30.0, 60.0, 50.0, 270.0, 30.0, 10.0, 10.0, 0.0, 0.0, 40.0, 110.0, -50.0, 20.0, 70.0, 10.0, 80.0, -130.0, 390.0, -30.0, 30.0, 40.0, 40.0, 10.0, 30.0, 190.0, 20.0, 50.0, 10.0, 30.0, 0.0, 0.0, 90.0, 80.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 30.0, 20.0, 30.0, 110.0, 20.0, 50.0, 0.0, 170.0, 40.0, 0.0, 20.0, 30.0, 30.0, 40.0, 0.0, 40.0, 20.0, 190.0, 50.0, 30.0, 40.0, 10.0, 0.0, 10.0, 30.0, 30.0, 0.0, 0.0, 10.0, 10.0, 170.0, 0.0, 30.0, 20.0, 20.0, 100.0, 20.0, 360.0, 70.0, 30.0, 20.0, 10.0, 0.0, 30.0, 10.0, 30.0, 0.0, 10.0, 360.0, 0.0, 0.0, 20.0, 30.0, 10.0, 20.0, 370.0, -30.0, 20.0, 30.0, 40.0, 20.0, 30.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 40.0, 150.0, 10.0, 50.0, 10.0, 320.0, 40.0, 250.0, 70.0, -10.0, 160.0, 5.0, 50.0, 100.0, -15.0, -10.0, 60.0, 50.0, -25.0, -40.0, 30.0, 70.0, 0.0, 80.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 80.0, 40.0, 90.0, 30.0, 0.0, 50.0, 80.0, 60.0, 10.0, 60.0, 30.0, 0.0, 20.0, 60.0, 20.0, 30.0, 50.0, 0.0, 170.0, 0.0, 30.0, 40.0, 60.0, 10.0, 40.0, 10.0, 30.0, 100.0, 20.0, 40.0, 10.0, 40.0, 40.0, 460.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 40.0, 0.0, 50.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 40.0, 30.0, 20.0, 0.0, 20.0, 0.0, -20.0, 40.0, 30.0, 130.0, 370.0, 70.0, 330.0, 100.0, 70.0, 290.0, 10.0, 130.0, 0.0, 0.0, 30.0, 30.0, 50.0, 30.0, 70.0, 40.0, 30.0, 270.0, 40.0, 170.0, 660.0, 0.0, 160.0, 50.0, 80.0, 30.0, 0.0, 50.0, 40.0, 5.0, 180.0, 5.0, 40.0, 40.0, 80.0, 380.0, 10.0, 0.0, 40.0, 20.0, 0.0, 20.0, 20.0, 0.0, 20.0, 10.0, 30.0, 10.0, 40.0, 40.0, -40.0, 10.0, 20.0, 40.0, 130.0, 50.0, 10.0, 450.0, 270.0, 20.0, 20.0, 20.0, 20.0, 0.0, 160.0, 60.0, 60.0, 80.0, 60.0, 30.0, 50.0, 150.0, 60.0, 170.0, 60.0, 30.0, 30.0, 10.0, 20.0, 60.0, -185.0, 20.0, 180.0, -30.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0, 0.0, 80.0, 130.0, 50.0, 70.0, 10.0, 20.0, 20.0, 0.0, 0.0, 250.0, 50.0, 10.0, 10.0, 40.0, 20.0, 10.0, 20.0, 20.0, 20.0, 40.0, 0.0, 10.0, 10.0, 30.0, 40.0, 10.0, 20.0, 20.0, 460.0, 70.0, 30.0, 200.0, 70.0, 10.0, 30.0, 0.0, 40.0, 180.0, 0.0, 280.0, 80.0, 40.0, 170.0, 30.0, 330.0, 40.0, 40.0, 150.0, 0.0, 0.0, 30.0, 10.0, 30.0, 30.0, 20.0, -380.0, 20.0, 10.0, 0.0, 110.0, 30.0, 0.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 0.0, 0.0, 20.0, 30.0, 50.0, 0.0, 0.0, 0.0, 20.0, 0.0, 30.0, 10.0, 0.0, 50.0, 20.0, 0.0, 10.0, 10.0, 30.0, 50.0, 70.0, -10.0, 40.0, 50.0, 160.0, 60.0, 10.0, 500.0, 40.0, 70.0, 30.0, 40.0, -5.0, 40.0, 10.0, 90.0, 30.0, 20.0, 180.0, 10.0, 0.0, 10.0, 270.0, 70.0, 40.0, 80.0, 40.0, 30.0, 20.0, 10.0, 0.0, 305.0, 0.0, 20.0, 90.0, 100.0, 180.0, 20.0, 70.0, 10.0, 20.0, 30.0, 40.0, 20.0, 10.0, 50.0, 10.0, 70.0, 60.0, 40.0, 10.0, 10.0, 30.0, 40.0, 40.0, 20.0, 0.0, 140.0, 40.0, 70.0, 10.0, -15.0, 20.0, 30.0, 30.0, 20.0, -10.0, 20.0, 70.0, 30.0, 50.0, 10.0, 30.0, 0.0, 0.0, 20.0, 10.0, 40.0, 20.0, 20.0, 20.0, 0.0, 30.0, 480.0, 10.0, 20.0, 90.0, 0.0, 20.0, 270.0, 160.0, 10.0, 70.0, 90.0, 50.0, 50.0, 10.0, 170.0, 40.0, 40.0, 70.0, 30.0, 100.0, -10.0, 460.0, 170.0, 150.0, 10.0, 10.0, 40.0, 40.0, 10.0, 70.0, 30.0, 30.0, 20.0, 40.0, 30.0, 10.0, 20.0, 30.0, 60.0, 200.0, 70.0, 30.0, 0.0, 10.0, 20.0, 0.0, -20.0, 310.0, 20.0, 10.0, 10.0, 70.0, 0.0, 160.0, 50.0, 50.0, 20.0, 0.0, 40.0, 40.0, 40.0, 40.0, 10.0, 20.0, 30.0, 0.0, 10.0, 40.0, 90.0, -20.0, 160.0, 210.0, 70.0, 110.0, 190.0, 50.0, 30.0, 20.0, 0.0, 250.0, 20.0, -50.0, 20.0, 20.0, 0.0, 0.0, 30.0, 40.0, 90.0, 0.0, 90.0, -15.0, 180.0, 30.0, 30.0, 60.0, 70.0, 0.0, 90.0, 0.0, 500.0, 50.0, 30.0, 0.0, 50.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 10.0, 0.0, 30.0, 170.0, 20.0, 10.0, 0.0, -5.0, 20.0, 190.0, 0.0, 0.0, 0.0, 30.0, 10.0, 160.0, 230.0, 60.0, 30.0, 30.0, 270.0, 180.0, 170.0, 30.0, -30.0, 40.0, 10.0, 10.0, 0.0, 90.0, 40.0, 30.0, 10.0, 10.0, 10.0, 0.0, 40.0, 50.0, 80.0, 40.0, 0.0, 40.0, 40.0, 50.0, 40.0, 110.0, 50.0, 20.0, 10.0, 10.0, 20.0, 100.0, 160.0, 40.0, 20.0, 100.0, 30.0, 30.0, 0.0, 20.0, 10.0, 450.0, 70.0, 160.0, 370.0, 170.0, 20.0, 20.0, 160.0, 180.0, 40.0, 40.0, 50.0, 50.0, 0.0, 20.0, 0.0, 50.0, 0.0, 10.0, 20.0, 20.0, 10.0, 30.0, 50.0, 40.0, 0.0, 10.0, 0.0, 10.0, 130.0, 130.0, 10.0, 30.0, 10.0, 100.0, 60.0, 10.0, 90.0, 30.0, 60.0, 15.0, 50.0, 470.0, 10.0, 0.0, 40.0, 50.0, 0.0, 20.0, 40.0, 90.0, 330.0, 20.0, 10.0, 170.0, 50.0, 100.0, 30.0, -370.0, 50.0, 10.0, 260.0, 220.0, 20.0, 80.0, 20.0, 40.0, 30.0, 10.0, 0.0, 40.0, 60.0, 10.0, 50.0, 290.0, 30.0, 50.0, 40.0, 10.0, 70.0, 50.0, 50.0, 40.0, 15.0, 0.0, 50.0, 80.0, 15.0, 20.0, 60.0, 0.0, 60.0, 0.0, 0.0, 60.0, 80.0, 40.0, 190.0, 60.0, 10.0, 30.0, 470.0, -10.0, 40.0, 40.0, 0.0, 60.0, 20.0, 220.0, 360.0, 0.0, 10.0, 60.0, 80.0, 0.0, 30.0, 250.0, 40.0, 10.0, 10.0, 20.0, 20.0, 0.0, 10.0, 50.0, 10.0, 80.0, 50.0, 40.0, 70.0, 20.0, 40.0, 10.0, 15.0, 10.0, 40.0, 30.0, 110.0, 0.0, 10.0, 50.0, 0.0, 220.0, 30.0, 20.0, 30.0, 40.0, 260.0, 100.0, 0.0, 60.0, 40.0, 60.0, 20.0, 60.0, 70.0, 0.0, 40.0, 40.0, 90.0, 0.0, 30.0, 40.0, 270.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5373162947012249, "mean_inference_ms": 1.7374105000168232, "mean_action_processing_ms": 0.4497956078572403, "mean_env_wait_ms": 1.395296034807559, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05366969108581543, "StateBufferConnector_ms": 0.009250164031982422, "ViewRequirementAgentConnector_ms": 0.3715081214904785}, "num_episodes": 18, "episode_return_max": 1530.0, "episode_return_min": -90.0, "episode_return_mean": 537.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.239321971339386, "num_env_steps_trained_throughput_per_sec": 36.239321971339386, "timesteps_total": 220000, "num_env_steps_sampled_lifetime": 220000, "num_agent_steps_sampled_lifetime": 2200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2200000, "timers": {"training_iteration_time_ms": 110469.438, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110469.39, "sample_time_ms": 2396.296, "learn_time_ms": 108053.297, "learn_throughput": 37.019, "synch_weights_time_ms": 11.182}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 2200000, "num_agent_steps_trained": 2200000}, "done": false, "training_iteration": 55, "trial_id": "57140_00000", "date": "2024-06-27_01-00-58", "timestamp": 1719464458, "time_this_iter_s": 110.39171004295349, "time_total_s": 6384.984545707703, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3e63a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6384.984545707703, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 15.967948717948717, "ram_util_percent": 78.9403846153846}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.083170794970946, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.572099116435067, "policy_loss": -0.00491064746306983, "vf_loss": 4.576052970271776, "vf_explained_var": 0.00016874192367854338, "kl": 0.009567987664387106, "entropy": 0.5914752263294114, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 521145.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "env_runners": {"episode_reward_max": 1530.0, "episode_reward_min": -90.0, "episode_reward_mean": 551.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -380.0}, "policy_reward_max": {"policy_0": 660.0}, "policy_reward_mean": {"policy_0": 55.17}, "custom_metrics": {}, "hist_stats": {"episode_reward": [480.0, 1220.0, 460.0, 510.0, 450.0, 200.0, 470.0, 420.0, 160.0, 800.0, 500.0, 470.0, 200.0, 930.0, 335.0, 230.0, 460.0, 440.0, 340.0, 630.0, 180.0, 130.0, 1530.0, 550.0, 1240.0, 780.0, 170.0, 750.0, 710.0, 650.0, 75.0, 440.0, 410.0, 200.0, 930.0, 1190.0, -90.0, 250.0, 140.0, 160.0, 970.0, 505.0, 570.0, 795.0, 320.0, 370.0, 245.0, 210.0, 690.0, 920.0, 1030.0, 320.0, 440.0, 660.0, 240.0, 910.0, 310.0, 535.0, 800.0, 280.0, 255.0, 1130.0, 250.0, 380.0, 540.0, 1240.0, 730.0, 210.0, 370.0, 895.0, 600.0, 540.0, 340.0, 645.0, 285.0, 970.0, 850.0, 390.0, 385.0, 500.0, 630.0, 640.0, 920.0, 580.0, 185.0, 690.0, 655.0, 1230.0, 680.0, 910.0, 520.0, 170.0, 510.0, 885.0, 590.0, 880.0, 360.0, 330.0, 470.0, 610.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 10.0, 30.0, 10.0, 10.0, 180.0, 60.0, 0.0, 80.0, 30.0, 260.0, 160.0, 20.0, 20.0, -10.0, 80.0, 60.0, 360.0, 70.0, 200.0, 0.0, 30.0, 60.0, 50.0, 270.0, 30.0, 10.0, 10.0, 0.0, 0.0, 40.0, 110.0, -50.0, 20.0, 70.0, 10.0, 80.0, -130.0, 390.0, -30.0, 30.0, 40.0, 40.0, 10.0, 30.0, 190.0, 20.0, 50.0, 10.0, 30.0, 0.0, 0.0, 90.0, 80.0, 0.0, 0.0, 10.0, 10.0, 10.0, 0.0, 0.0, 30.0, 20.0, 30.0, 110.0, 20.0, 50.0, 0.0, 170.0, 40.0, 0.0, 20.0, 30.0, 30.0, 40.0, 0.0, 40.0, 20.0, 190.0, 50.0, 30.0, 40.0, 10.0, 0.0, 10.0, 30.0, 30.0, 0.0, 0.0, 10.0, 10.0, 170.0, 0.0, 30.0, 20.0, 20.0, 100.0, 20.0, 360.0, 70.0, 30.0, 20.0, 10.0, 0.0, 30.0, 10.0, 30.0, 0.0, 10.0, 360.0, 0.0, 0.0, 20.0, 30.0, 10.0, 20.0, 370.0, -30.0, 20.0, 30.0, 40.0, 20.0, 30.0, 20.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 40.0, 150.0, 10.0, 50.0, 10.0, 320.0, 40.0, 250.0, 70.0, -10.0, 160.0, 5.0, 50.0, 100.0, -15.0, -10.0, 60.0, 50.0, -25.0, -40.0, 30.0, 70.0, 0.0, 80.0, 20.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 80.0, 40.0, 90.0, 30.0, 0.0, 50.0, 80.0, 60.0, 10.0, 60.0, 30.0, 0.0, 20.0, 60.0, 20.0, 30.0, 50.0, 0.0, 170.0, 0.0, 30.0, 40.0, 60.0, 10.0, 40.0, 10.0, 30.0, 100.0, 20.0, 40.0, 10.0, 40.0, 40.0, 460.0, 0.0, 10.0, 0.0, 10.0, 20.0, 10.0, 20.0, 0.0, 40.0, 0.0, 50.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 40.0, 30.0, 20.0, 0.0, 20.0, 0.0, -20.0, 40.0, 30.0, 130.0, 370.0, 70.0, 330.0, 100.0, 70.0, 290.0, 10.0, 130.0, 0.0, 0.0, 30.0, 30.0, 50.0, 30.0, 70.0, 40.0, 30.0, 270.0, 40.0, 170.0, 660.0, 0.0, 160.0, 50.0, 80.0, 30.0, 0.0, 50.0, 40.0, 5.0, 180.0, 5.0, 40.0, 40.0, 80.0, 380.0, 10.0, 0.0, 40.0, 20.0, 0.0, 20.0, 20.0, 0.0, 20.0, 10.0, 30.0, 10.0, 40.0, 40.0, -40.0, 10.0, 20.0, 40.0, 130.0, 50.0, 10.0, 450.0, 270.0, 20.0, 20.0, 20.0, 20.0, 0.0, 160.0, 60.0, 60.0, 80.0, 60.0, 30.0, 50.0, 150.0, 60.0, 170.0, 60.0, 30.0, 30.0, 10.0, 20.0, 60.0, -185.0, 20.0, 180.0, -30.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0, 0.0, 80.0, 130.0, 50.0, 70.0, 10.0, 20.0, 20.0, 0.0, 0.0, 250.0, 50.0, 10.0, 10.0, 40.0, 20.0, 10.0, 20.0, 20.0, 20.0, 40.0, 0.0, 10.0, 10.0, 30.0, 40.0, 10.0, 20.0, 20.0, 460.0, 70.0, 30.0, 200.0, 70.0, 10.0, 30.0, 0.0, 40.0, 180.0, 0.0, 280.0, 80.0, 40.0, 170.0, 30.0, 330.0, 40.0, 40.0, 150.0, 0.0, 0.0, 30.0, 10.0, 30.0, 30.0, 20.0, -380.0, 20.0, 10.0, 0.0, 110.0, 30.0, 0.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 0.0, 0.0, 20.0, 30.0, 50.0, 0.0, 0.0, 0.0, 20.0, 0.0, 30.0, 10.0, 0.0, 50.0, 20.0, 0.0, 10.0, 10.0, 30.0, 50.0, 70.0, -10.0, 40.0, 50.0, 160.0, 60.0, 10.0, 500.0, 40.0, 70.0, 30.0, 40.0, -5.0, 40.0, 10.0, 90.0, 30.0, 20.0, 180.0, 10.0, 0.0, 10.0, 270.0, 70.0, 40.0, 80.0, 40.0, 30.0, 20.0, 10.0, 0.0, 305.0, 0.0, 20.0, 90.0, 100.0, 180.0, 20.0, 70.0, 10.0, 20.0, 30.0, 40.0, 20.0, 10.0, 50.0, 10.0, 70.0, 60.0, 40.0, 10.0, 10.0, 30.0, 40.0, 40.0, 20.0, 0.0, 140.0, 40.0, 70.0, 10.0, -15.0, 20.0, 30.0, 30.0, 20.0, -10.0, 20.0, 70.0, 30.0, 50.0, 10.0, 30.0, 0.0, 0.0, 20.0, 10.0, 40.0, 20.0, 20.0, 20.0, 0.0, 30.0, 480.0, 10.0, 20.0, 90.0, 0.0, 20.0, 270.0, 160.0, 10.0, 70.0, 90.0, 50.0, 50.0, 10.0, 170.0, 40.0, 40.0, 70.0, 30.0, 100.0, -10.0, 460.0, 170.0, 150.0, 10.0, 10.0, 40.0, 40.0, 10.0, 70.0, 30.0, 30.0, 20.0, 40.0, 30.0, 10.0, 20.0, 30.0, 60.0, 200.0, 70.0, 30.0, 0.0, 10.0, 20.0, 0.0, -20.0, 310.0, 20.0, 10.0, 10.0, 70.0, 0.0, 160.0, 50.0, 50.0, 20.0, 0.0, 40.0, 40.0, 40.0, 40.0, 10.0, 20.0, 30.0, 0.0, 10.0, 40.0, 90.0, -20.0, 160.0, 210.0, 70.0, 110.0, 190.0, 50.0, 30.0, 20.0, 0.0, 250.0, 20.0, -50.0, 20.0, 20.0, 0.0, 0.0, 30.0, 40.0, 90.0, 0.0, 90.0, -15.0, 180.0, 30.0, 30.0, 60.0, 70.0, 0.0, 90.0, 0.0, 500.0, 50.0, 30.0, 0.0, 50.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 10.0, 0.0, 30.0, 170.0, 20.0, 10.0, 0.0, -5.0, 20.0, 190.0, 0.0, 0.0, 0.0, 30.0, 10.0, 160.0, 230.0, 60.0, 30.0, 30.0, 270.0, 180.0, 170.0, 30.0, -30.0, 40.0, 10.0, 10.0, 0.0, 90.0, 40.0, 30.0, 10.0, 10.0, 10.0, 0.0, 40.0, 50.0, 80.0, 40.0, 0.0, 40.0, 40.0, 50.0, 40.0, 110.0, 50.0, 20.0, 10.0, 10.0, 20.0, 100.0, 160.0, 40.0, 20.0, 100.0, 30.0, 30.0, 0.0, 20.0, 10.0, 450.0, 70.0, 160.0, 370.0, 170.0, 20.0, 20.0, 160.0, 180.0, 40.0, 40.0, 50.0, 50.0, 0.0, 20.0, 0.0, 50.0, 0.0, 10.0, 20.0, 20.0, 10.0, 30.0, 50.0, 40.0, 0.0, 10.0, 0.0, 10.0, 130.0, 130.0, 10.0, 30.0, 10.0, 100.0, 60.0, 10.0, 90.0, 30.0, 60.0, 15.0, 50.0, 470.0, 10.0, 0.0, 40.0, 50.0, 0.0, 20.0, 40.0, 90.0, 330.0, 20.0, 10.0, 170.0, 50.0, 100.0, 30.0, -370.0, 50.0, 10.0, 260.0, 220.0, 20.0, 80.0, 20.0, 40.0, 30.0, 10.0, 0.0, 40.0, 60.0, 10.0, 50.0, 290.0, 30.0, 50.0, 40.0, 10.0, 70.0, 50.0, 50.0, 40.0, 15.0, 0.0, 50.0, 80.0, 15.0, 20.0, 60.0, 0.0, 60.0, 0.0, 0.0, 60.0, 80.0, 40.0, 190.0, 60.0, 10.0, 30.0, 470.0, -10.0, 40.0, 40.0, 0.0, 60.0, 20.0, 220.0, 360.0, 0.0, 10.0, 60.0, 80.0, 0.0, 30.0, 250.0, 40.0, 10.0, 10.0, 20.0, 20.0, 0.0, 10.0, 50.0, 10.0, 80.0, 50.0, 40.0, 70.0, 20.0, 40.0, 10.0, 15.0, 10.0, 40.0, 30.0, 110.0, 0.0, 10.0, 50.0, 0.0, 220.0, 30.0, 20.0, 30.0, 40.0, 260.0, 100.0, 0.0, 60.0, 40.0, 60.0, 20.0, 60.0, 70.0, 0.0, 40.0, 40.0, 90.0, 0.0, 30.0, 40.0, 270.0, 160.0, 80.0, 20.0, 350.0, 10.0, 10.0, 0.0, 280.0, 0.0, 10.0, 30.0, 70.0, 20.0, 30.0, 50.0, 0.0, 260.0, 10.0, 90.0, 20.0, 30.0, 0.0, 30.0, 40.0, 20.0, 20.0, 10.0, 0.0, 15.0, 20.0, 0.0, -20.0, 50.0, 280.0, 40.0, 20.0, 10.0, 90.0, 180.0, 40.0, 0.0, 250.0, -5.0, 40.0, 160.0, 20.0, 160.0, 0.0, 30.0, 0.0, 50.0, 390.0, 30.0, 20.0, -10.0, 130.0, 460.0, 70.0, 40.0, 50.0, 40.0, 30.0, 20.0, 110.0, 30.0, 90.0, 270.0, 20.0, 50.0, 20.0, 20.0, 60.0, 60.0, 0.0, 30.0, 250.0, 50.0, 20.0, 40.0, 380.0, 260.0, 20.0, 40.0, 20.0, 30.0, 0.0, 10.0, 10.0, 80.0, 50.0, 10.0, 0.0, 10.0, 30.0, 10.0, 0.0, 0.0, 90.0, 10.0, 10.0, 30.0, 40.0, 10.0, 40.0, 20.0, 40.0, 0.0, 260.0, 20.0, 50.0, 480.0, 0.0, 110.0, -5.0, 20.0, 180.0, 50.0, 30.0, 20.0, 0.0, 30.0, 0.0, 20.0, 160.0, 30.0, 0.0, 30.0, 40.0, 280.0, 0.0, 50.0, -20.0, 70.0, 60.0, 360.0, 100.0, 150.0, 80.0, -20.0, 50.0, 20.0, 10.0, 40.0, 0.0, 30.0, 40.0, 140.0, 60.0, 20.0, 0.0, 30.0, 10.0, 10.0, 0.0, 30.0, 110.0, 40.0, 20.0, 60.0, 20.0, 10.0, 0.0, 20.0, 160.0, 40.0, 30.0, 20.0, 30.0, 0.0, 160.0, 30.0, 20.0, 160.0, 10.0, 40.0, 30.0, 10.0, 20.0, 270.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5334717533841604, "mean_inference_ms": 1.7334988321509752, "mean_action_processing_ms": 0.4486322133423779, "mean_env_wait_ms": 1.3924535029995466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05342721939086914, "StateBufferConnector_ms": 0.009247064590454102, "ViewRequirementAgentConnector_ms": 0.367901086807251}, "num_episodes": 18, "episode_return_max": 1530.0, "episode_return_min": -90.0, "episode_return_mean": 551.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.214868673068466, "num_env_steps_trained_throughput_per_sec": 36.214868673068466, "timesteps_total": 224000, "num_env_steps_sampled_lifetime": 224000, "num_agent_steps_sampled_lifetime": 2240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2240000, "timers": {"training_iteration_time_ms": 110464.635, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110464.587, "sample_time_ms": 2398.008, "learn_time_ms": 108046.924, "learn_throughput": 37.021, "synch_weights_time_ms": 10.885}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 2240000, "num_agent_steps_trained": 2240000}, "done": false, "training_iteration": 56, "trial_id": "57140_00000", "date": "2024-06-27_01-02-49", "timestamp": 1719464569, "time_this_iter_s": 110.46254086494446, "time_total_s": 6495.447086572647, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af404550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6495.447086572647, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 16.744230769230768, "ram_util_percent": 78.98910256410257}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2712740593063185, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.187976975664417, "policy_loss": -0.0059161322304797466, "vf_loss": 5.193122467065391, "vf_explained_var": -2.8771238205151055e-05, "kl": 0.007706361831023386, "entropy": 0.5579763715227826, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 530535.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "env_runners": {"episode_reward_max": 1530.0, "episode_reward_min": -90.0, "episode_reward_mean": 601.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -380.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 60.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1530.0, 550.0, 1240.0, 780.0, 170.0, 750.0, 710.0, 650.0, 75.0, 440.0, 410.0, 200.0, 930.0, 1190.0, -90.0, 250.0, 140.0, 160.0, 970.0, 505.0, 570.0, 795.0, 320.0, 370.0, 245.0, 210.0, 690.0, 920.0, 1030.0, 320.0, 440.0, 660.0, 240.0, 910.0, 310.0, 535.0, 800.0, 280.0, 255.0, 1130.0, 250.0, 380.0, 540.0, 1240.0, 730.0, 210.0, 370.0, 895.0, 600.0, 540.0, 340.0, 645.0, 285.0, 970.0, 850.0, 390.0, 385.0, 500.0, 630.0, 640.0, 920.0, 580.0, 185.0, 690.0, 655.0, 1230.0, 680.0, 910.0, 520.0, 170.0, 510.0, 885.0, 590.0, 880.0, 360.0, 330.0, 470.0, 610.0, 770.0, 560.0, 1430.0, 690.0, 1050.0, 210.0, 770.0, 320.0, 850.0, 390.0, 470.0, 510.0, 190.0, 600.0, 990.0, 980.0, 540.0, 775.0, 985.0, 1020.0, 170.0, 770.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 130.0, 370.0, 70.0, 330.0, 100.0, 70.0, 290.0, 10.0, 130.0, 0.0, 0.0, 30.0, 30.0, 50.0, 30.0, 70.0, 40.0, 30.0, 270.0, 40.0, 170.0, 660.0, 0.0, 160.0, 50.0, 80.0, 30.0, 0.0, 50.0, 40.0, 5.0, 180.0, 5.0, 40.0, 40.0, 80.0, 380.0, 10.0, 0.0, 40.0, 20.0, 0.0, 20.0, 20.0, 0.0, 20.0, 10.0, 30.0, 10.0, 40.0, 40.0, -40.0, 10.0, 20.0, 40.0, 130.0, 50.0, 10.0, 450.0, 270.0, 20.0, 20.0, 20.0, 20.0, 0.0, 160.0, 60.0, 60.0, 80.0, 60.0, 30.0, 50.0, 150.0, 60.0, 170.0, 60.0, 30.0, 30.0, 10.0, 20.0, 60.0, -185.0, 20.0, 180.0, -30.0, 10.0, 0.0, 0.0, 0.0, 20.0, 40.0, 0.0, 80.0, 130.0, 50.0, 70.0, 10.0, 20.0, 20.0, 0.0, 0.0, 250.0, 50.0, 10.0, 10.0, 40.0, 20.0, 10.0, 20.0, 20.0, 20.0, 40.0, 0.0, 10.0, 10.0, 30.0, 40.0, 10.0, 20.0, 20.0, 460.0, 70.0, 30.0, 200.0, 70.0, 10.0, 30.0, 0.0, 40.0, 180.0, 0.0, 280.0, 80.0, 40.0, 170.0, 30.0, 330.0, 40.0, 40.0, 150.0, 0.0, 0.0, 30.0, 10.0, 30.0, 30.0, 20.0, -380.0, 20.0, 10.0, 0.0, 110.0, 30.0, 0.0, 30.0, 10.0, 30.0, 20.0, 10.0, 20.0, 0.0, 0.0, 20.0, 30.0, 50.0, 0.0, 0.0, 0.0, 20.0, 0.0, 30.0, 10.0, 0.0, 50.0, 20.0, 0.0, 10.0, 10.0, 30.0, 50.0, 70.0, -10.0, 40.0, 50.0, 160.0, 60.0, 10.0, 500.0, 40.0, 70.0, 30.0, 40.0, -5.0, 40.0, 10.0, 90.0, 30.0, 20.0, 180.0, 10.0, 0.0, 10.0, 270.0, 70.0, 40.0, 80.0, 40.0, 30.0, 20.0, 10.0, 0.0, 305.0, 0.0, 20.0, 90.0, 100.0, 180.0, 20.0, 70.0, 10.0, 20.0, 30.0, 40.0, 20.0, 10.0, 50.0, 10.0, 70.0, 60.0, 40.0, 10.0, 10.0, 30.0, 40.0, 40.0, 20.0, 0.0, 140.0, 40.0, 70.0, 10.0, -15.0, 20.0, 30.0, 30.0, 20.0, -10.0, 20.0, 70.0, 30.0, 50.0, 10.0, 30.0, 0.0, 0.0, 20.0, 10.0, 40.0, 20.0, 20.0, 20.0, 0.0, 30.0, 480.0, 10.0, 20.0, 90.0, 0.0, 20.0, 270.0, 160.0, 10.0, 70.0, 90.0, 50.0, 50.0, 10.0, 170.0, 40.0, 40.0, 70.0, 30.0, 100.0, -10.0, 460.0, 170.0, 150.0, 10.0, 10.0, 40.0, 40.0, 10.0, 70.0, 30.0, 30.0, 20.0, 40.0, 30.0, 10.0, 20.0, 30.0, 60.0, 200.0, 70.0, 30.0, 0.0, 10.0, 20.0, 0.0, -20.0, 310.0, 20.0, 10.0, 10.0, 70.0, 0.0, 160.0, 50.0, 50.0, 20.0, 0.0, 40.0, 40.0, 40.0, 40.0, 10.0, 20.0, 30.0, 0.0, 10.0, 40.0, 90.0, -20.0, 160.0, 210.0, 70.0, 110.0, 190.0, 50.0, 30.0, 20.0, 0.0, 250.0, 20.0, -50.0, 20.0, 20.0, 0.0, 0.0, 30.0, 40.0, 90.0, 0.0, 90.0, -15.0, 180.0, 30.0, 30.0, 60.0, 70.0, 0.0, 90.0, 0.0, 500.0, 50.0, 30.0, 0.0, 50.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 10.0, 0.0, 30.0, 170.0, 20.0, 10.0, 0.0, -5.0, 20.0, 190.0, 0.0, 0.0, 0.0, 30.0, 10.0, 160.0, 230.0, 60.0, 30.0, 30.0, 270.0, 180.0, 170.0, 30.0, -30.0, 40.0, 10.0, 10.0, 0.0, 90.0, 40.0, 30.0, 10.0, 10.0, 10.0, 0.0, 40.0, 50.0, 80.0, 40.0, 0.0, 40.0, 40.0, 50.0, 40.0, 110.0, 50.0, 20.0, 10.0, 10.0, 20.0, 100.0, 160.0, 40.0, 20.0, 100.0, 30.0, 30.0, 0.0, 20.0, 10.0, 450.0, 70.0, 160.0, 370.0, 170.0, 20.0, 20.0, 160.0, 180.0, 40.0, 40.0, 50.0, 50.0, 0.0, 20.0, 0.0, 50.0, 0.0, 10.0, 20.0, 20.0, 10.0, 30.0, 50.0, 40.0, 0.0, 10.0, 0.0, 10.0, 130.0, 130.0, 10.0, 30.0, 10.0, 100.0, 60.0, 10.0, 90.0, 30.0, 60.0, 15.0, 50.0, 470.0, 10.0, 0.0, 40.0, 50.0, 0.0, 20.0, 40.0, 90.0, 330.0, 20.0, 10.0, 170.0, 50.0, 100.0, 30.0, -370.0, 50.0, 10.0, 260.0, 220.0, 20.0, 80.0, 20.0, 40.0, 30.0, 10.0, 0.0, 40.0, 60.0, 10.0, 50.0, 290.0, 30.0, 50.0, 40.0, 10.0, 70.0, 50.0, 50.0, 40.0, 15.0, 0.0, 50.0, 80.0, 15.0, 20.0, 60.0, 0.0, 60.0, 0.0, 0.0, 60.0, 80.0, 40.0, 190.0, 60.0, 10.0, 30.0, 470.0, -10.0, 40.0, 40.0, 0.0, 60.0, 20.0, 220.0, 360.0, 0.0, 10.0, 60.0, 80.0, 0.0, 30.0, 250.0, 40.0, 10.0, 10.0, 20.0, 20.0, 0.0, 10.0, 50.0, 10.0, 80.0, 50.0, 40.0, 70.0, 20.0, 40.0, 10.0, 15.0, 10.0, 40.0, 30.0, 110.0, 0.0, 10.0, 50.0, 0.0, 220.0, 30.0, 20.0, 30.0, 40.0, 260.0, 100.0, 0.0, 60.0, 40.0, 60.0, 20.0, 60.0, 70.0, 0.0, 40.0, 40.0, 90.0, 0.0, 30.0, 40.0, 270.0, 160.0, 80.0, 20.0, 350.0, 10.0, 10.0, 0.0, 280.0, 0.0, 10.0, 30.0, 70.0, 20.0, 30.0, 50.0, 0.0, 260.0, 10.0, 90.0, 20.0, 30.0, 0.0, 30.0, 40.0, 20.0, 20.0, 10.0, 0.0, 15.0, 20.0, 0.0, -20.0, 50.0, 280.0, 40.0, 20.0, 10.0, 90.0, 180.0, 40.0, 0.0, 250.0, -5.0, 40.0, 160.0, 20.0, 160.0, 0.0, 30.0, 0.0, 50.0, 390.0, 30.0, 20.0, -10.0, 130.0, 460.0, 70.0, 40.0, 50.0, 40.0, 30.0, 20.0, 110.0, 30.0, 90.0, 270.0, 20.0, 50.0, 20.0, 20.0, 60.0, 60.0, 0.0, 30.0, 250.0, 50.0, 20.0, 40.0, 380.0, 260.0, 20.0, 40.0, 20.0, 30.0, 0.0, 10.0, 10.0, 80.0, 50.0, 10.0, 0.0, 10.0, 30.0, 10.0, 0.0, 0.0, 90.0, 10.0, 10.0, 30.0, 40.0, 10.0, 40.0, 20.0, 40.0, 0.0, 260.0, 20.0, 50.0, 480.0, 0.0, 110.0, -5.0, 20.0, 180.0, 50.0, 30.0, 20.0, 0.0, 30.0, 0.0, 20.0, 160.0, 30.0, 0.0, 30.0, 40.0, 280.0, 0.0, 50.0, -20.0, 70.0, 60.0, 360.0, 100.0, 150.0, 80.0, -20.0, 50.0, 20.0, 10.0, 40.0, 0.0, 30.0, 40.0, 140.0, 60.0, 20.0, 0.0, 30.0, 10.0, 10.0, 0.0, 30.0, 110.0, 40.0, 20.0, 60.0, 20.0, 10.0, 0.0, 20.0, 160.0, 40.0, 30.0, 20.0, 30.0, 0.0, 160.0, 30.0, 20.0, 160.0, 10.0, 40.0, 30.0, 10.0, 20.0, 270.0, 20.0, 10.0, 80.0, 110.0, 100.0, 60.0, 40.0, 580.0, -330.0, 90.0, 30.0, 0.0, 5.0, 15.0, 260.0, 20.0, -5.0, 5.0, 230.0, 40.0, -10.0, 380.0, -40.0, 20.0, 30.0, 700.0, 40.0, 130.0, 20.0, 120.0, 30.0, 250.0, 50.0, 40.0, 60.0, 0.0, 20.0, 20.0, 20.0, 80.0, 150.0, 40.0, 270.0, 10.0, 380.0, 160.0, 50.0, 30.0, 10.0, 70.0, 30.0, 0.0, 20.0, 10.0, 30.0, 0.0, 40.0, 60.0, 20.0, 0.0, 30.0, 60.0, 170.0, 20.0, 150.0, 70.0, 110.0, 40.0, 90.0, 40.0, 20.0, 0.0, 30.0, 10.0, 150.0, 20.0, 30.0, 0.0, 70.0, 0.0, 10.0, -10.0, 160.0, -150.0, 80.0, 110.0, 10.0, -40.0, 400.0, 200.0, 90.0, 0.0, 30.0, 10.0, 80.0, 160.0, 10.0, 10.0, 40.0, 40.0, 10.0, 70.0, 20.0, 40.0, -50.0, 30.0, 60.0, 160.0, 30.0, 20.0, 90.0, 0.0, 20.0, 10.0, 0.0, 190.0, 160.0, 10.0, 40.0, 70.0, 10.0, 10.0, 0.0, 20.0, 0.0, 50.0, 30.0, 0.0, 60.0, 20.0, 0.0, 0.0, 450.0, 10.0, 30.0, 40.0, 30.0, 0.0, 30.0, 10.0, 0.0, 180.0, 70.0, 50.0, 80.0, 40.0, 50.0, 100.0, 60.0, 10.0, 350.0, 50.0, 10.0, 370.0, 0.0, 20.0, 60.0, 30.0, 220.0, 170.0, 50.0, 170.0, 60.0, 30.0, 70.0, 0.0, 10.0, 170.0, 20.0, 10.0, 0.0, 260.0, 250.0, 30.0, 90.0, 25.0, 40.0, 0.0, 20.0, 50.0, 10.0, 0.0, 0.0, 105.0, 50.0, 350.0, 20.0, 0.0, 500.0, -50.0, 10.0, -75.0, 370.0, 30.0, 70.0, 140.0, -40.0, 290.0, 40.0, 5.0, 190.0, 50.0, 40.0, 0.0, 0.0, 40.0, 20.0, 10.0, 0.0, 10.0, 0.0, 40.0, 20.0, 180.0, 60.0, 20.0, 20.0, 360.0, 20.0, 30.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.529427930791756, "mean_inference_ms": 1.7292025911257987, "mean_action_processing_ms": 0.4473405076241819, "mean_env_wait_ms": 1.3892048401406856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05467367172241211, "StateBufferConnector_ms": 0.009450674057006836, "ViewRequirementAgentConnector_ms": 0.3889474868774414}, "num_episodes": 22, "episode_return_max": 1530.0, "episode_return_min": -90.0, "episode_return_mean": 601.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.40449712240661, "num_env_steps_trained_throughput_per_sec": 36.40449712240661, "timesteps_total": 228000, "num_env_steps_sampled_lifetime": 228000, "num_agent_steps_sampled_lifetime": 2280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2280000, "timers": {"training_iteration_time_ms": 110386.517, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110386.469, "sample_time_ms": 2409.139, "learn_time_ms": 107957.828, "learn_throughput": 37.052, "synch_weights_time_ms": 10.906}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 2280000, "num_agent_steps_trained": 2280000}, "done": false, "training_iteration": 57, "trial_id": "57140_00000", "date": "2024-06-27_01-04-39", "timestamp": 1719464679, "time_this_iter_s": 109.8915810585022, "time_total_s": 6605.338667631149, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af404e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6605.338667631149, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 15.584516129032261, "ram_util_percent": 78.64258064516127}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.035899011954205, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.9501982729275005, "policy_loss": -0.005732389658747025, "vf_loss": 4.955218802016383, "vf_explained_var": 0.00014981715062174935, "kl": 0.007118531192306079, "entropy": 0.5522372752237624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 539925.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "env_runners": {"episode_reward_max": 1430.0, "episode_reward_min": 170.0, "episode_reward_mean": 609.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 60.915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [370.0, 245.0, 210.0, 690.0, 920.0, 1030.0, 320.0, 440.0, 660.0, 240.0, 910.0, 310.0, 535.0, 800.0, 280.0, 255.0, 1130.0, 250.0, 380.0, 540.0, 1240.0, 730.0, 210.0, 370.0, 895.0, 600.0, 540.0, 340.0, 645.0, 285.0, 970.0, 850.0, 390.0, 385.0, 500.0, 630.0, 640.0, 920.0, 580.0, 185.0, 690.0, 655.0, 1230.0, 680.0, 910.0, 520.0, 170.0, 510.0, 885.0, 590.0, 880.0, 360.0, 330.0, 470.0, 610.0, 770.0, 560.0, 1430.0, 690.0, 1050.0, 210.0, 770.0, 320.0, 850.0, 390.0, 470.0, 510.0, 190.0, 600.0, 990.0, 980.0, 540.0, 775.0, 985.0, 1020.0, 170.0, 770.0, 920.0, 1120.0, 180.0, 820.0, 660.0, 460.0, 370.0, 470.0, 1020.0, 860.0, 530.0, 250.0, 820.0, 925.0, 270.0, 850.0, 380.0, 775.0, 210.0, 540.0, 240.0, 795.0, 500.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 10.0, 10.0, 30.0, 40.0, 40.0, 20.0, 0.0, 140.0, 40.0, 70.0, 10.0, -15.0, 20.0, 30.0, 30.0, 20.0, -10.0, 20.0, 70.0, 30.0, 50.0, 10.0, 30.0, 0.0, 0.0, 20.0, 10.0, 40.0, 20.0, 20.0, 20.0, 0.0, 30.0, 480.0, 10.0, 20.0, 90.0, 0.0, 20.0, 270.0, 160.0, 10.0, 70.0, 90.0, 50.0, 50.0, 10.0, 170.0, 40.0, 40.0, 70.0, 30.0, 100.0, -10.0, 460.0, 170.0, 150.0, 10.0, 10.0, 40.0, 40.0, 10.0, 70.0, 30.0, 30.0, 20.0, 40.0, 30.0, 10.0, 20.0, 30.0, 60.0, 200.0, 70.0, 30.0, 0.0, 10.0, 20.0, 0.0, -20.0, 310.0, 20.0, 10.0, 10.0, 70.0, 0.0, 160.0, 50.0, 50.0, 20.0, 0.0, 40.0, 40.0, 40.0, 40.0, 10.0, 20.0, 30.0, 0.0, 10.0, 40.0, 90.0, -20.0, 160.0, 210.0, 70.0, 110.0, 190.0, 50.0, 30.0, 20.0, 0.0, 250.0, 20.0, -50.0, 20.0, 20.0, 0.0, 0.0, 30.0, 40.0, 90.0, 0.0, 90.0, -15.0, 180.0, 30.0, 30.0, 60.0, 70.0, 0.0, 90.0, 0.0, 500.0, 50.0, 30.0, 0.0, 50.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 10.0, 0.0, 30.0, 170.0, 20.0, 10.0, 0.0, -5.0, 20.0, 190.0, 0.0, 0.0, 0.0, 30.0, 10.0, 160.0, 230.0, 60.0, 30.0, 30.0, 270.0, 180.0, 170.0, 30.0, -30.0, 40.0, 10.0, 10.0, 0.0, 90.0, 40.0, 30.0, 10.0, 10.0, 10.0, 0.0, 40.0, 50.0, 80.0, 40.0, 0.0, 40.0, 40.0, 50.0, 40.0, 110.0, 50.0, 20.0, 10.0, 10.0, 20.0, 100.0, 160.0, 40.0, 20.0, 100.0, 30.0, 30.0, 0.0, 20.0, 10.0, 450.0, 70.0, 160.0, 370.0, 170.0, 20.0, 20.0, 160.0, 180.0, 40.0, 40.0, 50.0, 50.0, 0.0, 20.0, 0.0, 50.0, 0.0, 10.0, 20.0, 20.0, 10.0, 30.0, 50.0, 40.0, 0.0, 10.0, 0.0, 10.0, 130.0, 130.0, 10.0, 30.0, 10.0, 100.0, 60.0, 10.0, 90.0, 30.0, 60.0, 15.0, 50.0, 470.0, 10.0, 0.0, 40.0, 50.0, 0.0, 20.0, 40.0, 90.0, 330.0, 20.0, 10.0, 170.0, 50.0, 100.0, 30.0, -370.0, 50.0, 10.0, 260.0, 220.0, 20.0, 80.0, 20.0, 40.0, 30.0, 10.0, 0.0, 40.0, 60.0, 10.0, 50.0, 290.0, 30.0, 50.0, 40.0, 10.0, 70.0, 50.0, 50.0, 40.0, 15.0, 0.0, 50.0, 80.0, 15.0, 20.0, 60.0, 0.0, 60.0, 0.0, 0.0, 60.0, 80.0, 40.0, 190.0, 60.0, 10.0, 30.0, 470.0, -10.0, 40.0, 40.0, 0.0, 60.0, 20.0, 220.0, 360.0, 0.0, 10.0, 60.0, 80.0, 0.0, 30.0, 250.0, 40.0, 10.0, 10.0, 20.0, 20.0, 0.0, 10.0, 50.0, 10.0, 80.0, 50.0, 40.0, 70.0, 20.0, 40.0, 10.0, 15.0, 10.0, 40.0, 30.0, 110.0, 0.0, 10.0, 50.0, 0.0, 220.0, 30.0, 20.0, 30.0, 40.0, 260.0, 100.0, 0.0, 60.0, 40.0, 60.0, 20.0, 60.0, 70.0, 0.0, 40.0, 40.0, 90.0, 0.0, 30.0, 40.0, 270.0, 160.0, 80.0, 20.0, 350.0, 10.0, 10.0, 0.0, 280.0, 0.0, 10.0, 30.0, 70.0, 20.0, 30.0, 50.0, 0.0, 260.0, 10.0, 90.0, 20.0, 30.0, 0.0, 30.0, 40.0, 20.0, 20.0, 10.0, 0.0, 15.0, 20.0, 0.0, -20.0, 50.0, 280.0, 40.0, 20.0, 10.0, 90.0, 180.0, 40.0, 0.0, 250.0, -5.0, 40.0, 160.0, 20.0, 160.0, 0.0, 30.0, 0.0, 50.0, 390.0, 30.0, 20.0, -10.0, 130.0, 460.0, 70.0, 40.0, 50.0, 40.0, 30.0, 20.0, 110.0, 30.0, 90.0, 270.0, 20.0, 50.0, 20.0, 20.0, 60.0, 60.0, 0.0, 30.0, 250.0, 50.0, 20.0, 40.0, 380.0, 260.0, 20.0, 40.0, 20.0, 30.0, 0.0, 10.0, 10.0, 80.0, 50.0, 10.0, 0.0, 10.0, 30.0, 10.0, 0.0, 0.0, 90.0, 10.0, 10.0, 30.0, 40.0, 10.0, 40.0, 20.0, 40.0, 0.0, 260.0, 20.0, 50.0, 480.0, 0.0, 110.0, -5.0, 20.0, 180.0, 50.0, 30.0, 20.0, 0.0, 30.0, 0.0, 20.0, 160.0, 30.0, 0.0, 30.0, 40.0, 280.0, 0.0, 50.0, -20.0, 70.0, 60.0, 360.0, 100.0, 150.0, 80.0, -20.0, 50.0, 20.0, 10.0, 40.0, 0.0, 30.0, 40.0, 140.0, 60.0, 20.0, 0.0, 30.0, 10.0, 10.0, 0.0, 30.0, 110.0, 40.0, 20.0, 60.0, 20.0, 10.0, 0.0, 20.0, 160.0, 40.0, 30.0, 20.0, 30.0, 0.0, 160.0, 30.0, 20.0, 160.0, 10.0, 40.0, 30.0, 10.0, 20.0, 270.0, 20.0, 10.0, 80.0, 110.0, 100.0, 60.0, 40.0, 580.0, -330.0, 90.0, 30.0, 0.0, 5.0, 15.0, 260.0, 20.0, -5.0, 5.0, 230.0, 40.0, -10.0, 380.0, -40.0, 20.0, 30.0, 700.0, 40.0, 130.0, 20.0, 120.0, 30.0, 250.0, 50.0, 40.0, 60.0, 0.0, 20.0, 20.0, 20.0, 80.0, 150.0, 40.0, 270.0, 10.0, 380.0, 160.0, 50.0, 30.0, 10.0, 70.0, 30.0, 0.0, 20.0, 10.0, 30.0, 0.0, 40.0, 60.0, 20.0, 0.0, 30.0, 60.0, 170.0, 20.0, 150.0, 70.0, 110.0, 40.0, 90.0, 40.0, 20.0, 0.0, 30.0, 10.0, 150.0, 20.0, 30.0, 0.0, 70.0, 0.0, 10.0, -10.0, 160.0, -150.0, 80.0, 110.0, 10.0, -40.0, 400.0, 200.0, 90.0, 0.0, 30.0, 10.0, 80.0, 160.0, 10.0, 10.0, 40.0, 40.0, 10.0, 70.0, 20.0, 40.0, -50.0, 30.0, 60.0, 160.0, 30.0, 20.0, 90.0, 0.0, 20.0, 10.0, 0.0, 190.0, 160.0, 10.0, 40.0, 70.0, 10.0, 10.0, 0.0, 20.0, 0.0, 50.0, 30.0, 0.0, 60.0, 20.0, 0.0, 0.0, 450.0, 10.0, 30.0, 40.0, 30.0, 0.0, 30.0, 10.0, 0.0, 180.0, 70.0, 50.0, 80.0, 40.0, 50.0, 100.0, 60.0, 10.0, 350.0, 50.0, 10.0, 370.0, 0.0, 20.0, 60.0, 30.0, 220.0, 170.0, 50.0, 170.0, 60.0, 30.0, 70.0, 0.0, 10.0, 170.0, 20.0, 10.0, 0.0, 260.0, 250.0, 30.0, 90.0, 25.0, 40.0, 0.0, 20.0, 50.0, 10.0, 0.0, 0.0, 105.0, 50.0, 350.0, 20.0, 0.0, 500.0, -50.0, 10.0, -75.0, 370.0, 30.0, 70.0, 140.0, -40.0, 290.0, 40.0, 5.0, 190.0, 50.0, 40.0, 0.0, 0.0, 40.0, 20.0, 10.0, 0.0, 10.0, 0.0, 40.0, 20.0, 180.0, 60.0, 20.0, 20.0, 360.0, 20.0, 30.0, 20.0, 190.0, 250.0, 30.0, 40.0, 60.0, 120.0, 180.0, 40.0, 0.0, 10.0, 580.0, 50.0, -50.0, 0.0, 90.0, 120.0, 150.0, 0.0, 160.0, 20.0, 40.0, 10.0, -20.0, 50.0, 60.0, 30.0, -30.0, 40.0, 0.0, 0.0, 170.0, 60.0, 40.0, 50.0, 270.0, 40.0, 30.0, 90.0, 50.0, 20.0, 220.0, 40.0, 50.0, 50.0, 30.0, 0.0, 30.0, 30.0, 30.0, 180.0, 20.0, 190.0, 70.0, 40.0, 60.0, 40.0, 0.0, 20.0, 20.0, 0.0, 10.0, 10.0, 0.0, 20.0, 20.0, 10.0, 80.0, 30.0, 190.0, 0.0, 40.0, 30.0, 20.0, 10.0, 150.0, 10.0, 150.0, 20.0, 20.0, 20.0, -30.0, 30.0, 40.0, 50.0, -20.0, 350.0, 350.0, 50.0, 170.0, 30.0, 100.0, 470.0, 10.0, 20.0, 10.0, 30.0, 20.0, 30.0, 60.0, 110.0, 0.0, 100.0, 30.0, 20.0, 40.0, 40.0, 10.0, 30.0, 260.0, 0.0, 10.0, 10.0, 0.0, 20.0, -50.0, 10.0, 20.0, 160.0, 10.0, 60.0, 70.0, 40.0, 250.0, 0.0, 150.0, 140.0, 50.0, 0.0, 80.0, 40.0, 170.0, -15.0, 80.0, 260.0, 160.0, 30.0, 180.0, 40.0, 20.0, 0.0, 30.0, 0.0, 70.0, 30.0, 100.0, 40.0, 80.0, -250.0, 20.0, 150.0, -10.0, 370.0, 40.0, 80.0, 60.0, 10.0, 70.0, 150.0, 60.0, 20.0, 20.0, 10.0, 20.0, 30.0, 40.0, 0.0, 80.0, 150.0, 20.0, 10.0, 70.0, 30.0, 40.0, 40.0, 50.0, -25.0, 180.0, 170.0, 180.0, 40.0, 20.0, 50.0, 20.0, 20.0, 50.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 20.0, 20.0, 40.0, 0.0, 260.0, 50.0, 60.0, 40.0, 30.0, 10.0, 20.0, 10.0, 30.0, 50.0, 50.0, 30.0, 10.0, 30.0, 0.0, 320.0, 0.0, 10.0, 30.0, -5.0, 40.0, 50.0, 70.0, 30.0, 250.0, 10.0, 10.0, 70.0, 0.0, 0.0, 0.0, 0.0, 170.0, 180.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5251356911866167, "mean_inference_ms": 1.7252657997599041, "mean_action_processing_ms": 0.4460455873048707, "mean_env_wait_ms": 1.3858352575527766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055296897888183594, "StateBufferConnector_ms": 0.009546041488647461, "ViewRequirementAgentConnector_ms": 0.39430689811706543}, "num_episodes": 23, "episode_return_max": 1430.0, "episode_return_min": 170.0, "episode_return_mean": 609.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 35.955145409527006, "num_env_steps_trained_throughput_per_sec": 35.955145409527006, "timesteps_total": 232000, "num_env_steps_sampled_lifetime": 232000, "num_agent_steps_sampled_lifetime": 2320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2320000, "timers": {"training_iteration_time_ms": 110496.522, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110496.475, "sample_time_ms": 2413.126, "learn_time_ms": 108063.773, "learn_throughput": 37.015, "synch_weights_time_ms": 10.796}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 2320000, "num_agent_steps_trained": 2320000}, "done": false, "training_iteration": 58, "trial_id": "57140_00000", "date": "2024-06-27_01-06-30", "timestamp": 1719464790, "time_this_iter_s": 111.26170110702515, "time_total_s": 6716.600368738174, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b19478b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6716.600368738174, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 16.42341772151899, "ram_util_percent": 78.33037974683545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.953534413802738, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.626563278326211, "policy_loss": -0.005562911135778307, "vf_loss": 4.631371168181285, "vf_explained_var": 0.00121954355123071, "kl": 0.007550114902275704, "entropy": 0.5505054507805263, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 549315.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000}, "env_runners": {"episode_reward_max": 1430.0, "episode_reward_min": 120.0, "episode_reward_mean": 619.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -370.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 61.98}, "custom_metrics": {}, "hist_stats": {"episode_reward": [380.0, 540.0, 1240.0, 730.0, 210.0, 370.0, 895.0, 600.0, 540.0, 340.0, 645.0, 285.0, 970.0, 850.0, 390.0, 385.0, 500.0, 630.0, 640.0, 920.0, 580.0, 185.0, 690.0, 655.0, 1230.0, 680.0, 910.0, 520.0, 170.0, 510.0, 885.0, 590.0, 880.0, 360.0, 330.0, 470.0, 610.0, 770.0, 560.0, 1430.0, 690.0, 1050.0, 210.0, 770.0, 320.0, 850.0, 390.0, 470.0, 510.0, 190.0, 600.0, 990.0, 980.0, 540.0, 775.0, 985.0, 1020.0, 170.0, 770.0, 920.0, 1120.0, 180.0, 820.0, 660.0, 460.0, 370.0, 470.0, 1020.0, 860.0, 530.0, 250.0, 820.0, 925.0, 270.0, 850.0, 380.0, 775.0, 210.0, 540.0, 240.0, 795.0, 500.0, 230.0, 540.0, 895.0, 565.0, 295.0, 320.0, 1170.0, 855.0, 380.0, 650.0, 550.0, 420.0, 150.0, 430.0, 810.0, 1360.0, 920.0, 120.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 40.0, 50.0, 80.0, 40.0, 0.0, 40.0, 40.0, 50.0, 40.0, 110.0, 50.0, 20.0, 10.0, 10.0, 20.0, 100.0, 160.0, 40.0, 20.0, 100.0, 30.0, 30.0, 0.0, 20.0, 10.0, 450.0, 70.0, 160.0, 370.0, 170.0, 20.0, 20.0, 160.0, 180.0, 40.0, 40.0, 50.0, 50.0, 0.0, 20.0, 0.0, 50.0, 0.0, 10.0, 20.0, 20.0, 10.0, 30.0, 50.0, 40.0, 0.0, 10.0, 0.0, 10.0, 130.0, 130.0, 10.0, 30.0, 10.0, 100.0, 60.0, 10.0, 90.0, 30.0, 60.0, 15.0, 50.0, 470.0, 10.0, 0.0, 40.0, 50.0, 0.0, 20.0, 40.0, 90.0, 330.0, 20.0, 10.0, 170.0, 50.0, 100.0, 30.0, -370.0, 50.0, 10.0, 260.0, 220.0, 20.0, 80.0, 20.0, 40.0, 30.0, 10.0, 0.0, 40.0, 60.0, 10.0, 50.0, 290.0, 30.0, 50.0, 40.0, 10.0, 70.0, 50.0, 50.0, 40.0, 15.0, 0.0, 50.0, 80.0, 15.0, 20.0, 60.0, 0.0, 60.0, 0.0, 0.0, 60.0, 80.0, 40.0, 190.0, 60.0, 10.0, 30.0, 470.0, -10.0, 40.0, 40.0, 0.0, 60.0, 20.0, 220.0, 360.0, 0.0, 10.0, 60.0, 80.0, 0.0, 30.0, 250.0, 40.0, 10.0, 10.0, 20.0, 20.0, 0.0, 10.0, 50.0, 10.0, 80.0, 50.0, 40.0, 70.0, 20.0, 40.0, 10.0, 15.0, 10.0, 40.0, 30.0, 110.0, 0.0, 10.0, 50.0, 0.0, 220.0, 30.0, 20.0, 30.0, 40.0, 260.0, 100.0, 0.0, 60.0, 40.0, 60.0, 20.0, 60.0, 70.0, 0.0, 40.0, 40.0, 90.0, 0.0, 30.0, 40.0, 270.0, 160.0, 80.0, 20.0, 350.0, 10.0, 10.0, 0.0, 280.0, 0.0, 10.0, 30.0, 70.0, 20.0, 30.0, 50.0, 0.0, 260.0, 10.0, 90.0, 20.0, 30.0, 0.0, 30.0, 40.0, 20.0, 20.0, 10.0, 0.0, 15.0, 20.0, 0.0, -20.0, 50.0, 280.0, 40.0, 20.0, 10.0, 90.0, 180.0, 40.0, 0.0, 250.0, -5.0, 40.0, 160.0, 20.0, 160.0, 0.0, 30.0, 0.0, 50.0, 390.0, 30.0, 20.0, -10.0, 130.0, 460.0, 70.0, 40.0, 50.0, 40.0, 30.0, 20.0, 110.0, 30.0, 90.0, 270.0, 20.0, 50.0, 20.0, 20.0, 60.0, 60.0, 0.0, 30.0, 250.0, 50.0, 20.0, 40.0, 380.0, 260.0, 20.0, 40.0, 20.0, 30.0, 0.0, 10.0, 10.0, 80.0, 50.0, 10.0, 0.0, 10.0, 30.0, 10.0, 0.0, 0.0, 90.0, 10.0, 10.0, 30.0, 40.0, 10.0, 40.0, 20.0, 40.0, 0.0, 260.0, 20.0, 50.0, 480.0, 0.0, 110.0, -5.0, 20.0, 180.0, 50.0, 30.0, 20.0, 0.0, 30.0, 0.0, 20.0, 160.0, 30.0, 0.0, 30.0, 40.0, 280.0, 0.0, 50.0, -20.0, 70.0, 60.0, 360.0, 100.0, 150.0, 80.0, -20.0, 50.0, 20.0, 10.0, 40.0, 0.0, 30.0, 40.0, 140.0, 60.0, 20.0, 0.0, 30.0, 10.0, 10.0, 0.0, 30.0, 110.0, 40.0, 20.0, 60.0, 20.0, 10.0, 0.0, 20.0, 160.0, 40.0, 30.0, 20.0, 30.0, 0.0, 160.0, 30.0, 20.0, 160.0, 10.0, 40.0, 30.0, 10.0, 20.0, 270.0, 20.0, 10.0, 80.0, 110.0, 100.0, 60.0, 40.0, 580.0, -330.0, 90.0, 30.0, 0.0, 5.0, 15.0, 260.0, 20.0, -5.0, 5.0, 230.0, 40.0, -10.0, 380.0, -40.0, 20.0, 30.0, 700.0, 40.0, 130.0, 20.0, 120.0, 30.0, 250.0, 50.0, 40.0, 60.0, 0.0, 20.0, 20.0, 20.0, 80.0, 150.0, 40.0, 270.0, 10.0, 380.0, 160.0, 50.0, 30.0, 10.0, 70.0, 30.0, 0.0, 20.0, 10.0, 30.0, 0.0, 40.0, 60.0, 20.0, 0.0, 30.0, 60.0, 170.0, 20.0, 150.0, 70.0, 110.0, 40.0, 90.0, 40.0, 20.0, 0.0, 30.0, 10.0, 150.0, 20.0, 30.0, 0.0, 70.0, 0.0, 10.0, -10.0, 160.0, -150.0, 80.0, 110.0, 10.0, -40.0, 400.0, 200.0, 90.0, 0.0, 30.0, 10.0, 80.0, 160.0, 10.0, 10.0, 40.0, 40.0, 10.0, 70.0, 20.0, 40.0, -50.0, 30.0, 60.0, 160.0, 30.0, 20.0, 90.0, 0.0, 20.0, 10.0, 0.0, 190.0, 160.0, 10.0, 40.0, 70.0, 10.0, 10.0, 0.0, 20.0, 0.0, 50.0, 30.0, 0.0, 60.0, 20.0, 0.0, 0.0, 450.0, 10.0, 30.0, 40.0, 30.0, 0.0, 30.0, 10.0, 0.0, 180.0, 70.0, 50.0, 80.0, 40.0, 50.0, 100.0, 60.0, 10.0, 350.0, 50.0, 10.0, 370.0, 0.0, 20.0, 60.0, 30.0, 220.0, 170.0, 50.0, 170.0, 60.0, 30.0, 70.0, 0.0, 10.0, 170.0, 20.0, 10.0, 0.0, 260.0, 250.0, 30.0, 90.0, 25.0, 40.0, 0.0, 20.0, 50.0, 10.0, 0.0, 0.0, 105.0, 50.0, 350.0, 20.0, 0.0, 500.0, -50.0, 10.0, -75.0, 370.0, 30.0, 70.0, 140.0, -40.0, 290.0, 40.0, 5.0, 190.0, 50.0, 40.0, 0.0, 0.0, 40.0, 20.0, 10.0, 0.0, 10.0, 0.0, 40.0, 20.0, 180.0, 60.0, 20.0, 20.0, 360.0, 20.0, 30.0, 20.0, 190.0, 250.0, 30.0, 40.0, 60.0, 120.0, 180.0, 40.0, 0.0, 10.0, 580.0, 50.0, -50.0, 0.0, 90.0, 120.0, 150.0, 0.0, 160.0, 20.0, 40.0, 10.0, -20.0, 50.0, 60.0, 30.0, -30.0, 40.0, 0.0, 0.0, 170.0, 60.0, 40.0, 50.0, 270.0, 40.0, 30.0, 90.0, 50.0, 20.0, 220.0, 40.0, 50.0, 50.0, 30.0, 0.0, 30.0, 30.0, 30.0, 180.0, 20.0, 190.0, 70.0, 40.0, 60.0, 40.0, 0.0, 20.0, 20.0, 0.0, 10.0, 10.0, 0.0, 20.0, 20.0, 10.0, 80.0, 30.0, 190.0, 0.0, 40.0, 30.0, 20.0, 10.0, 150.0, 10.0, 150.0, 20.0, 20.0, 20.0, -30.0, 30.0, 40.0, 50.0, -20.0, 350.0, 350.0, 50.0, 170.0, 30.0, 100.0, 470.0, 10.0, 20.0, 10.0, 30.0, 20.0, 30.0, 60.0, 110.0, 0.0, 100.0, 30.0, 20.0, 40.0, 40.0, 10.0, 30.0, 260.0, 0.0, 10.0, 10.0, 0.0, 20.0, -50.0, 10.0, 20.0, 160.0, 10.0, 60.0, 70.0, 40.0, 250.0, 0.0, 150.0, 140.0, 50.0, 0.0, 80.0, 40.0, 170.0, -15.0, 80.0, 260.0, 160.0, 30.0, 180.0, 40.0, 20.0, 0.0, 30.0, 0.0, 70.0, 30.0, 100.0, 40.0, 80.0, -250.0, 20.0, 150.0, -10.0, 370.0, 40.0, 80.0, 60.0, 10.0, 70.0, 150.0, 60.0, 20.0, 20.0, 10.0, 20.0, 30.0, 40.0, 0.0, 80.0, 150.0, 20.0, 10.0, 70.0, 30.0, 40.0, 40.0, 50.0, -25.0, 180.0, 170.0, 180.0, 40.0, 20.0, 50.0, 20.0, 20.0, 50.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 20.0, 20.0, 40.0, 0.0, 260.0, 50.0, 60.0, 40.0, 30.0, 10.0, 20.0, 10.0, 30.0, 50.0, 50.0, 30.0, 10.0, 30.0, 0.0, 320.0, 0.0, 10.0, 30.0, -5.0, 40.0, 50.0, 70.0, 30.0, 250.0, 10.0, 10.0, 70.0, 0.0, 0.0, 0.0, 0.0, 170.0, 180.0, 60.0, 50.0, 10.0, 0.0, 20.0, 0.0, 20.0, 40.0, 20.0, 30.0, 40.0, 20.0, 10.0, 50.0, 20.0, 10.0, 10.0, 100.0, 220.0, 60.0, 40.0, 270.0, 380.0, 40.0, 150.0, 40.0, 45.0, 10.0, -20.0, -40.0, 20.0, 30.0, 15.0, 260.0, -10.0, 35.0, 30.0, 110.0, 80.0, 30.0, -15.0, 20.0, 60.0, 20.0, 110.0, 20.0, 20.0, 0.0, 30.0, 10.0, 5.0, 190.0, 40.0, 30.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 370.0, 60.0, 180.0, 50.0, 150.0, 140.0, 160.0, 50.0, 10.0, 0.0, 200.0, 35.0, 100.0, 20.0, 80.0, 330.0, 40.0, 10.0, 30.0, 10.0, 10.0, 60.0, 10.0, 50.0, 0.0, 60.0, 10.0, 70.0, 100.0, 10.0, 80.0, 20.0, 20.0, 170.0, 60.0, 40.0, 20.0, 150.0, 90.0, 0.0, 40.0, 30.0, 80.0, 40.0, 80.0, 30.0, 70.0, 70.0, 80.0, 30.0, 10.0, 0.0, 10.0, 60.0, 20.0, 150.0, 40.0, 70.0, 40.0, 20.0, 20.0, 0.0, 30.0, 20.0, 10.0, 10.0, 10.0, 20.0, 0.0, 30.0, 190.0, 40.0, 10.0, 70.0, 50.0, 0.0, 40.0, 30.0, 0.0, 0.0, 20.0, 40.0, 170.0, 30.0, 0.0, 30.0, 190.0, 250.0, 70.0, 10.0, 0.0, 120.0, 270.0, 140.0, 160.0, 80.0, 20.0, 290.0, 60.0, 220.0, 370.0, 40.0, 120.0, 20.0, 170.0, 30.0, 30.0, 0.0, 80.0, 60.0, 10.0, 0.0, 30.0, 30.0, 0.0, 10.0, 10.0, 20.0, 10.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5217764948457053, "mean_inference_ms": 1.722618285887525, "mean_action_processing_ms": 0.44512637115084275, "mean_env_wait_ms": 1.3832912168897276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05620765686035156, "StateBufferConnector_ms": 0.009555816650390625, "ViewRequirementAgentConnector_ms": 0.37961578369140625}, "num_episodes": 18, "episode_return_max": 1430.0, "episode_return_min": 120.0, "episode_return_mean": 619.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.36002111519762, "num_env_steps_trained_throughput_per_sec": 36.36002111519762, "timesteps_total": 236000, "num_env_steps_sampled_lifetime": 236000, "num_agent_steps_sampled_lifetime": 2360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2360000, "timers": {"training_iteration_time_ms": 110443.311, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110443.264, "sample_time_ms": 2393.353, "learn_time_ms": 108030.816, "learn_throughput": 37.026, "synch_weights_time_ms": 10.715}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 2360000, "num_agent_steps_trained": 2360000}, "done": false, "training_iteration": 59, "trial_id": "57140_00000", "date": "2024-06-27_01-08-20", "timestamp": 1719464900, "time_this_iter_s": 110.02556586265564, "time_total_s": 6826.62593460083, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af42edc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6826.62593460083, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 15.887096774193548, "ram_util_percent": 78.19612903225806}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9340953574362147, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.109674895152497, "policy_loss": -0.005581011652601318, "vf_loss": 4.114459600133764, "vf_explained_var": 0.00133782604251045, "kl": 0.007963044972597345, "entropy": 0.5706337659725874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 558705.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "env_runners": {"episode_reward_max": 1430.0, "episode_reward_min": 120.0, "episode_reward_mean": 611.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -330.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 61.17}, "custom_metrics": {}, "hist_stats": {"episode_reward": [640.0, 920.0, 580.0, 185.0, 690.0, 655.0, 1230.0, 680.0, 910.0, 520.0, 170.0, 510.0, 885.0, 590.0, 880.0, 360.0, 330.0, 470.0, 610.0, 770.0, 560.0, 1430.0, 690.0, 1050.0, 210.0, 770.0, 320.0, 850.0, 390.0, 470.0, 510.0, 190.0, 600.0, 990.0, 980.0, 540.0, 775.0, 985.0, 1020.0, 170.0, 770.0, 920.0, 1120.0, 180.0, 820.0, 660.0, 460.0, 370.0, 470.0, 1020.0, 860.0, 530.0, 250.0, 820.0, 925.0, 270.0, 850.0, 380.0, 775.0, 210.0, 540.0, 240.0, 795.0, 500.0, 230.0, 540.0, 895.0, 565.0, 295.0, 320.0, 1170.0, 855.0, 380.0, 650.0, 550.0, 420.0, 150.0, 430.0, 810.0, 1360.0, 920.0, 120.0, 390.0, 700.0, 730.0, 570.0, 610.0, 830.0, 280.0, 675.0, 940.0, 400.0, 520.0, 350.0, 255.0, 270.0, 150.0, 1040.0, 560.0, 420.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 70.0, 0.0, 40.0, 40.0, 90.0, 0.0, 30.0, 40.0, 270.0, 160.0, 80.0, 20.0, 350.0, 10.0, 10.0, 0.0, 280.0, 0.0, 10.0, 30.0, 70.0, 20.0, 30.0, 50.0, 0.0, 260.0, 10.0, 90.0, 20.0, 30.0, 0.0, 30.0, 40.0, 20.0, 20.0, 10.0, 0.0, 15.0, 20.0, 0.0, -20.0, 50.0, 280.0, 40.0, 20.0, 10.0, 90.0, 180.0, 40.0, 0.0, 250.0, -5.0, 40.0, 160.0, 20.0, 160.0, 0.0, 30.0, 0.0, 50.0, 390.0, 30.0, 20.0, -10.0, 130.0, 460.0, 70.0, 40.0, 50.0, 40.0, 30.0, 20.0, 110.0, 30.0, 90.0, 270.0, 20.0, 50.0, 20.0, 20.0, 60.0, 60.0, 0.0, 30.0, 250.0, 50.0, 20.0, 40.0, 380.0, 260.0, 20.0, 40.0, 20.0, 30.0, 0.0, 10.0, 10.0, 80.0, 50.0, 10.0, 0.0, 10.0, 30.0, 10.0, 0.0, 0.0, 90.0, 10.0, 10.0, 30.0, 40.0, 10.0, 40.0, 20.0, 40.0, 0.0, 260.0, 20.0, 50.0, 480.0, 0.0, 110.0, -5.0, 20.0, 180.0, 50.0, 30.0, 20.0, 0.0, 30.0, 0.0, 20.0, 160.0, 30.0, 0.0, 30.0, 40.0, 280.0, 0.0, 50.0, -20.0, 70.0, 60.0, 360.0, 100.0, 150.0, 80.0, -20.0, 50.0, 20.0, 10.0, 40.0, 0.0, 30.0, 40.0, 140.0, 60.0, 20.0, 0.0, 30.0, 10.0, 10.0, 0.0, 30.0, 110.0, 40.0, 20.0, 60.0, 20.0, 10.0, 0.0, 20.0, 160.0, 40.0, 30.0, 20.0, 30.0, 0.0, 160.0, 30.0, 20.0, 160.0, 10.0, 40.0, 30.0, 10.0, 20.0, 270.0, 20.0, 10.0, 80.0, 110.0, 100.0, 60.0, 40.0, 580.0, -330.0, 90.0, 30.0, 0.0, 5.0, 15.0, 260.0, 20.0, -5.0, 5.0, 230.0, 40.0, -10.0, 380.0, -40.0, 20.0, 30.0, 700.0, 40.0, 130.0, 20.0, 120.0, 30.0, 250.0, 50.0, 40.0, 60.0, 0.0, 20.0, 20.0, 20.0, 80.0, 150.0, 40.0, 270.0, 10.0, 380.0, 160.0, 50.0, 30.0, 10.0, 70.0, 30.0, 0.0, 20.0, 10.0, 30.0, 0.0, 40.0, 60.0, 20.0, 0.0, 30.0, 60.0, 170.0, 20.0, 150.0, 70.0, 110.0, 40.0, 90.0, 40.0, 20.0, 0.0, 30.0, 10.0, 150.0, 20.0, 30.0, 0.0, 70.0, 0.0, 10.0, -10.0, 160.0, -150.0, 80.0, 110.0, 10.0, -40.0, 400.0, 200.0, 90.0, 0.0, 30.0, 10.0, 80.0, 160.0, 10.0, 10.0, 40.0, 40.0, 10.0, 70.0, 20.0, 40.0, -50.0, 30.0, 60.0, 160.0, 30.0, 20.0, 90.0, 0.0, 20.0, 10.0, 0.0, 190.0, 160.0, 10.0, 40.0, 70.0, 10.0, 10.0, 0.0, 20.0, 0.0, 50.0, 30.0, 0.0, 60.0, 20.0, 0.0, 0.0, 450.0, 10.0, 30.0, 40.0, 30.0, 0.0, 30.0, 10.0, 0.0, 180.0, 70.0, 50.0, 80.0, 40.0, 50.0, 100.0, 60.0, 10.0, 350.0, 50.0, 10.0, 370.0, 0.0, 20.0, 60.0, 30.0, 220.0, 170.0, 50.0, 170.0, 60.0, 30.0, 70.0, 0.0, 10.0, 170.0, 20.0, 10.0, 0.0, 260.0, 250.0, 30.0, 90.0, 25.0, 40.0, 0.0, 20.0, 50.0, 10.0, 0.0, 0.0, 105.0, 50.0, 350.0, 20.0, 0.0, 500.0, -50.0, 10.0, -75.0, 370.0, 30.0, 70.0, 140.0, -40.0, 290.0, 40.0, 5.0, 190.0, 50.0, 40.0, 0.0, 0.0, 40.0, 20.0, 10.0, 0.0, 10.0, 0.0, 40.0, 20.0, 180.0, 60.0, 20.0, 20.0, 360.0, 20.0, 30.0, 20.0, 190.0, 250.0, 30.0, 40.0, 60.0, 120.0, 180.0, 40.0, 0.0, 10.0, 580.0, 50.0, -50.0, 0.0, 90.0, 120.0, 150.0, 0.0, 160.0, 20.0, 40.0, 10.0, -20.0, 50.0, 60.0, 30.0, -30.0, 40.0, 0.0, 0.0, 170.0, 60.0, 40.0, 50.0, 270.0, 40.0, 30.0, 90.0, 50.0, 20.0, 220.0, 40.0, 50.0, 50.0, 30.0, 0.0, 30.0, 30.0, 30.0, 180.0, 20.0, 190.0, 70.0, 40.0, 60.0, 40.0, 0.0, 20.0, 20.0, 0.0, 10.0, 10.0, 0.0, 20.0, 20.0, 10.0, 80.0, 30.0, 190.0, 0.0, 40.0, 30.0, 20.0, 10.0, 150.0, 10.0, 150.0, 20.0, 20.0, 20.0, -30.0, 30.0, 40.0, 50.0, -20.0, 350.0, 350.0, 50.0, 170.0, 30.0, 100.0, 470.0, 10.0, 20.0, 10.0, 30.0, 20.0, 30.0, 60.0, 110.0, 0.0, 100.0, 30.0, 20.0, 40.0, 40.0, 10.0, 30.0, 260.0, 0.0, 10.0, 10.0, 0.0, 20.0, -50.0, 10.0, 20.0, 160.0, 10.0, 60.0, 70.0, 40.0, 250.0, 0.0, 150.0, 140.0, 50.0, 0.0, 80.0, 40.0, 170.0, -15.0, 80.0, 260.0, 160.0, 30.0, 180.0, 40.0, 20.0, 0.0, 30.0, 0.0, 70.0, 30.0, 100.0, 40.0, 80.0, -250.0, 20.0, 150.0, -10.0, 370.0, 40.0, 80.0, 60.0, 10.0, 70.0, 150.0, 60.0, 20.0, 20.0, 10.0, 20.0, 30.0, 40.0, 0.0, 80.0, 150.0, 20.0, 10.0, 70.0, 30.0, 40.0, 40.0, 50.0, -25.0, 180.0, 170.0, 180.0, 40.0, 20.0, 50.0, 20.0, 20.0, 50.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 20.0, 20.0, 40.0, 0.0, 260.0, 50.0, 60.0, 40.0, 30.0, 10.0, 20.0, 10.0, 30.0, 50.0, 50.0, 30.0, 10.0, 30.0, 0.0, 320.0, 0.0, 10.0, 30.0, -5.0, 40.0, 50.0, 70.0, 30.0, 250.0, 10.0, 10.0, 70.0, 0.0, 0.0, 0.0, 0.0, 170.0, 180.0, 60.0, 50.0, 10.0, 0.0, 20.0, 0.0, 20.0, 40.0, 20.0, 30.0, 40.0, 20.0, 10.0, 50.0, 20.0, 10.0, 10.0, 100.0, 220.0, 60.0, 40.0, 270.0, 380.0, 40.0, 150.0, 40.0, 45.0, 10.0, -20.0, -40.0, 20.0, 30.0, 15.0, 260.0, -10.0, 35.0, 30.0, 110.0, 80.0, 30.0, -15.0, 20.0, 60.0, 20.0, 110.0, 20.0, 20.0, 0.0, 30.0, 10.0, 5.0, 190.0, 40.0, 30.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 370.0, 60.0, 180.0, 50.0, 150.0, 140.0, 160.0, 50.0, 10.0, 0.0, 200.0, 35.0, 100.0, 20.0, 80.0, 330.0, 40.0, 10.0, 30.0, 10.0, 10.0, 60.0, 10.0, 50.0, 0.0, 60.0, 10.0, 70.0, 100.0, 10.0, 80.0, 20.0, 20.0, 170.0, 60.0, 40.0, 20.0, 150.0, 90.0, 0.0, 40.0, 30.0, 80.0, 40.0, 80.0, 30.0, 70.0, 70.0, 80.0, 30.0, 10.0, 0.0, 10.0, 60.0, 20.0, 150.0, 40.0, 70.0, 40.0, 20.0, 20.0, 0.0, 30.0, 20.0, 10.0, 10.0, 10.0, 20.0, 0.0, 30.0, 190.0, 40.0, 10.0, 70.0, 50.0, 0.0, 40.0, 30.0, 0.0, 0.0, 20.0, 40.0, 170.0, 30.0, 0.0, 30.0, 190.0, 250.0, 70.0, 10.0, 0.0, 120.0, 270.0, 140.0, 160.0, 80.0, 20.0, 290.0, 60.0, 220.0, 370.0, 40.0, 120.0, 20.0, 170.0, 30.0, 30.0, 0.0, 80.0, 60.0, 10.0, 0.0, 30.0, 30.0, 0.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 40.0, 0.0, 140.0, 0.0, 20.0, 10.0, 180.0, 0.0, 90.0, -50.0, 30.0, 190.0, 210.0, 40.0, 20.0, 40.0, 100.0, 30.0, 170.0, 20.0, 160.0, 20.0, 160.0, 20.0, 30.0, 100.0, 30.0, 20.0, 290.0, 10.0, 20.0, 20.0, 0.0, 0.0, 30.0, 0.0, 180.0, 20.0, 30.0, 10.0, 30.0, 60.0, 100.0, 30.0, 10.0, 40.0, 70.0, 230.0, 10.0, 70.0, 10.0, 60.0, 320.0, 40.0, -20.0, -30.0, 290.0, 80.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 50.0, 30.0, 0.0, 110.0, 40.0, 30.0, 30.0, -40.0, 160.0, 20.0, 50.0, 30.0, -5.0, 360.0, 30.0, 320.0, 20.0, 20.0, 280.0, 90.0, 20.0, 0.0, 20.0, 140.0, 30.0, 30.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 180.0, 110.0, 90.0, 0.0, 170.0, 10.0, 0.0, 40.0, 100.0, 0.0, 100.0, 10.0, 0.0, 40.0, 150.0, -20.0, 10.0, 60.0, 20.0, 30.0, 40.0, 20.0, 40.0, 20.0, 10.0, 0.0, 5.0, 30.0, 20.0, 60.0, 60.0, 10.0, 40.0, 0.0, 40.0, 10.0, 80.0, 20.0, 30.0, 0.0, 30.0, 20.0, 60.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 30.0, 30.0, 0.0, 50.0, 60.0, 30.0, 350.0, 30.0, 90.0, 50.0, 60.0, 310.0, 10.0, 200.0, 40.0, 20.0, 0.0, 50.0, 30.0, 10.0, 20.0, 30.0, 160.0, 30.0, 70.0, 190.0, 10.0, 40.0, 10.0, 0.0, 20.0, 40.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.518362867800569, "mean_inference_ms": 1.7200311660818353, "mean_action_processing_ms": 0.44421665101192204, "mean_env_wait_ms": 1.3808657674528808, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05632734298706055, "StateBufferConnector_ms": 0.00932621955871582, "ViewRequirementAgentConnector_ms": 0.38544368743896484}, "num_episodes": 18, "episode_return_max": 1430.0, "episode_return_min": 120.0, "episode_return_mean": 611.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.06491072401819, "num_env_steps_trained_throughput_per_sec": 36.06491072401819, "timesteps_total": 240000, "num_env_steps_sampled_lifetime": 240000, "num_agent_steps_sampled_lifetime": 2400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2400000, "timers": {"training_iteration_time_ms": 110478.043, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110477.995, "sample_time_ms": 2397.212, "learn_time_ms": 108061.682, "learn_throughput": 37.016, "synch_weights_time_ms": 10.893}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 2400000, "num_agent_steps_trained": 2400000}, "done": false, "training_iteration": 60, "trial_id": "57140_00000", "date": "2024-06-27_01-10-11", "timestamp": 1719465011, "time_this_iter_s": 110.92430901527405, "time_total_s": 6937.550243616104, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b1947d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 6937.550243616104, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 16.14968152866242, "ram_util_percent": 78.11910828025478}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9407740109359113, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.240972512243147, "policy_loss": -0.005173539955908367, "vf_loss": 4.245363528482195, "vf_explained_var": 0.0016241381787898315, "kl": 0.007825158113717747, "entropy": 0.5399040151327944, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 568095.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000}, "env_runners": {"episode_reward_max": 1410.0, "episode_reward_min": 120.0, "episode_reward_mean": 582.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -250.0}, "policy_reward_max": {"policy_0": 590.0}, "policy_reward_mean": {"policy_0": 58.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [690.0, 1050.0, 210.0, 770.0, 320.0, 850.0, 390.0, 470.0, 510.0, 190.0, 600.0, 990.0, 980.0, 540.0, 775.0, 985.0, 1020.0, 170.0, 770.0, 920.0, 1120.0, 180.0, 820.0, 660.0, 460.0, 370.0, 470.0, 1020.0, 860.0, 530.0, 250.0, 820.0, 925.0, 270.0, 850.0, 380.0, 775.0, 210.0, 540.0, 240.0, 795.0, 500.0, 230.0, 540.0, 895.0, 565.0, 295.0, 320.0, 1170.0, 855.0, 380.0, 650.0, 550.0, 420.0, 150.0, 430.0, 810.0, 1360.0, 920.0, 120.0, 390.0, 700.0, 730.0, 570.0, 610.0, 830.0, 280.0, 675.0, 940.0, 400.0, 520.0, 350.0, 255.0, 270.0, 150.0, 1040.0, 560.0, 420.0, 435.0, 580.0, 1040.0, 780.0, 180.0, 400.0, 495.0, 570.0, 310.0, 180.0, 765.0, 300.0, 330.0, 250.0, 210.0, 1410.0, 150.0, 460.0, 550.0, 490.0, 1255.0, 530.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [250.0, 50.0, 40.0, 60.0, 0.0, 20.0, 20.0, 20.0, 80.0, 150.0, 40.0, 270.0, 10.0, 380.0, 160.0, 50.0, 30.0, 10.0, 70.0, 30.0, 0.0, 20.0, 10.0, 30.0, 0.0, 40.0, 60.0, 20.0, 0.0, 30.0, 60.0, 170.0, 20.0, 150.0, 70.0, 110.0, 40.0, 90.0, 40.0, 20.0, 0.0, 30.0, 10.0, 150.0, 20.0, 30.0, 0.0, 70.0, 0.0, 10.0, -10.0, 160.0, -150.0, 80.0, 110.0, 10.0, -40.0, 400.0, 200.0, 90.0, 0.0, 30.0, 10.0, 80.0, 160.0, 10.0, 10.0, 40.0, 40.0, 10.0, 70.0, 20.0, 40.0, -50.0, 30.0, 60.0, 160.0, 30.0, 20.0, 90.0, 0.0, 20.0, 10.0, 0.0, 190.0, 160.0, 10.0, 40.0, 70.0, 10.0, 10.0, 0.0, 20.0, 0.0, 50.0, 30.0, 0.0, 60.0, 20.0, 0.0, 0.0, 450.0, 10.0, 30.0, 40.0, 30.0, 0.0, 30.0, 10.0, 0.0, 180.0, 70.0, 50.0, 80.0, 40.0, 50.0, 100.0, 60.0, 10.0, 350.0, 50.0, 10.0, 370.0, 0.0, 20.0, 60.0, 30.0, 220.0, 170.0, 50.0, 170.0, 60.0, 30.0, 70.0, 0.0, 10.0, 170.0, 20.0, 10.0, 0.0, 260.0, 250.0, 30.0, 90.0, 25.0, 40.0, 0.0, 20.0, 50.0, 10.0, 0.0, 0.0, 105.0, 50.0, 350.0, 20.0, 0.0, 500.0, -50.0, 10.0, -75.0, 370.0, 30.0, 70.0, 140.0, -40.0, 290.0, 40.0, 5.0, 190.0, 50.0, 40.0, 0.0, 0.0, 40.0, 20.0, 10.0, 0.0, 10.0, 0.0, 40.0, 20.0, 180.0, 60.0, 20.0, 20.0, 360.0, 20.0, 30.0, 20.0, 190.0, 250.0, 30.0, 40.0, 60.0, 120.0, 180.0, 40.0, 0.0, 10.0, 580.0, 50.0, -50.0, 0.0, 90.0, 120.0, 150.0, 0.0, 160.0, 20.0, 40.0, 10.0, -20.0, 50.0, 60.0, 30.0, -30.0, 40.0, 0.0, 0.0, 170.0, 60.0, 40.0, 50.0, 270.0, 40.0, 30.0, 90.0, 50.0, 20.0, 220.0, 40.0, 50.0, 50.0, 30.0, 0.0, 30.0, 30.0, 30.0, 180.0, 20.0, 190.0, 70.0, 40.0, 60.0, 40.0, 0.0, 20.0, 20.0, 0.0, 10.0, 10.0, 0.0, 20.0, 20.0, 10.0, 80.0, 30.0, 190.0, 0.0, 40.0, 30.0, 20.0, 10.0, 150.0, 10.0, 150.0, 20.0, 20.0, 20.0, -30.0, 30.0, 40.0, 50.0, -20.0, 350.0, 350.0, 50.0, 170.0, 30.0, 100.0, 470.0, 10.0, 20.0, 10.0, 30.0, 20.0, 30.0, 60.0, 110.0, 0.0, 100.0, 30.0, 20.0, 40.0, 40.0, 10.0, 30.0, 260.0, 0.0, 10.0, 10.0, 0.0, 20.0, -50.0, 10.0, 20.0, 160.0, 10.0, 60.0, 70.0, 40.0, 250.0, 0.0, 150.0, 140.0, 50.0, 0.0, 80.0, 40.0, 170.0, -15.0, 80.0, 260.0, 160.0, 30.0, 180.0, 40.0, 20.0, 0.0, 30.0, 0.0, 70.0, 30.0, 100.0, 40.0, 80.0, -250.0, 20.0, 150.0, -10.0, 370.0, 40.0, 80.0, 60.0, 10.0, 70.0, 150.0, 60.0, 20.0, 20.0, 10.0, 20.0, 30.0, 40.0, 0.0, 80.0, 150.0, 20.0, 10.0, 70.0, 30.0, 40.0, 40.0, 50.0, -25.0, 180.0, 170.0, 180.0, 40.0, 20.0, 50.0, 20.0, 20.0, 50.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 20.0, 20.0, 40.0, 0.0, 260.0, 50.0, 60.0, 40.0, 30.0, 10.0, 20.0, 10.0, 30.0, 50.0, 50.0, 30.0, 10.0, 30.0, 0.0, 320.0, 0.0, 10.0, 30.0, -5.0, 40.0, 50.0, 70.0, 30.0, 250.0, 10.0, 10.0, 70.0, 0.0, 0.0, 0.0, 0.0, 170.0, 180.0, 60.0, 50.0, 10.0, 0.0, 20.0, 0.0, 20.0, 40.0, 20.0, 30.0, 40.0, 20.0, 10.0, 50.0, 20.0, 10.0, 10.0, 100.0, 220.0, 60.0, 40.0, 270.0, 380.0, 40.0, 150.0, 40.0, 45.0, 10.0, -20.0, -40.0, 20.0, 30.0, 15.0, 260.0, -10.0, 35.0, 30.0, 110.0, 80.0, 30.0, -15.0, 20.0, 60.0, 20.0, 110.0, 20.0, 20.0, 0.0, 30.0, 10.0, 5.0, 190.0, 40.0, 30.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 370.0, 60.0, 180.0, 50.0, 150.0, 140.0, 160.0, 50.0, 10.0, 0.0, 200.0, 35.0, 100.0, 20.0, 80.0, 330.0, 40.0, 10.0, 30.0, 10.0, 10.0, 60.0, 10.0, 50.0, 0.0, 60.0, 10.0, 70.0, 100.0, 10.0, 80.0, 20.0, 20.0, 170.0, 60.0, 40.0, 20.0, 150.0, 90.0, 0.0, 40.0, 30.0, 80.0, 40.0, 80.0, 30.0, 70.0, 70.0, 80.0, 30.0, 10.0, 0.0, 10.0, 60.0, 20.0, 150.0, 40.0, 70.0, 40.0, 20.0, 20.0, 0.0, 30.0, 20.0, 10.0, 10.0, 10.0, 20.0, 0.0, 30.0, 190.0, 40.0, 10.0, 70.0, 50.0, 0.0, 40.0, 30.0, 0.0, 0.0, 20.0, 40.0, 170.0, 30.0, 0.0, 30.0, 190.0, 250.0, 70.0, 10.0, 0.0, 120.0, 270.0, 140.0, 160.0, 80.0, 20.0, 290.0, 60.0, 220.0, 370.0, 40.0, 120.0, 20.0, 170.0, 30.0, 30.0, 0.0, 80.0, 60.0, 10.0, 0.0, 30.0, 30.0, 0.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 40.0, 0.0, 140.0, 0.0, 20.0, 10.0, 180.0, 0.0, 90.0, -50.0, 30.0, 190.0, 210.0, 40.0, 20.0, 40.0, 100.0, 30.0, 170.0, 20.0, 160.0, 20.0, 160.0, 20.0, 30.0, 100.0, 30.0, 20.0, 290.0, 10.0, 20.0, 20.0, 0.0, 0.0, 30.0, 0.0, 180.0, 20.0, 30.0, 10.0, 30.0, 60.0, 100.0, 30.0, 10.0, 40.0, 70.0, 230.0, 10.0, 70.0, 10.0, 60.0, 320.0, 40.0, -20.0, -30.0, 290.0, 80.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 50.0, 30.0, 0.0, 110.0, 40.0, 30.0, 30.0, -40.0, 160.0, 20.0, 50.0, 30.0, -5.0, 360.0, 30.0, 320.0, 20.0, 20.0, 280.0, 90.0, 20.0, 0.0, 20.0, 140.0, 30.0, 30.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 180.0, 110.0, 90.0, 0.0, 170.0, 10.0, 0.0, 40.0, 100.0, 0.0, 100.0, 10.0, 0.0, 40.0, 150.0, -20.0, 10.0, 60.0, 20.0, 30.0, 40.0, 20.0, 40.0, 20.0, 10.0, 0.0, 5.0, 30.0, 20.0, 60.0, 60.0, 10.0, 40.0, 0.0, 40.0, 10.0, 80.0, 20.0, 30.0, 0.0, 30.0, 20.0, 60.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 30.0, 30.0, 0.0, 50.0, 60.0, 30.0, 350.0, 30.0, 90.0, 50.0, 60.0, 310.0, 10.0, 200.0, 40.0, 20.0, 0.0, 50.0, 30.0, 10.0, 20.0, 30.0, 160.0, 30.0, 70.0, 190.0, 10.0, 40.0, 10.0, 0.0, 20.0, 40.0, 10.0, 20.0, 200.0, 40.0, 50.0, 20.0, 20.0, 0.0, 50.0, 25.0, 10.0, 40.0, 0.0, 40.0, 0.0, 70.0, 20.0, 160.0, 20.0, 160.0, 70.0, 350.0, 60.0, 40.0, 40.0, 0.0, -10.0, 400.0, 110.0, 10.0, 40.0, 160.0, 350.0, 0.0, 40.0, 70.0, 30.0, 30.0, 30.0, 40.0, 30.0, 20.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 30.0, 70.0, 10.0, 10.0, 0.0, 20.0, 30.0, 30.0, 10.0, 0.0, 30.0, 250.0, 20.0, 30.0, 0.0, 30.0, 10.0, 40.0, 80.0, -30.0, -55.0, 360.0, 30.0, 60.0, 40.0, 270.0, 0.0, 30.0, 50.0, 10.0, 70.0, 10.0, 30.0, 30.0, 10.0, -20.0, 180.0, 30.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 80.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 50.0, 10.0, 250.0, 80.0, 20.0, 10.0, 260.0, 60.0, -5.0, 0.0, 30.0, 40.0, 0.0, 70.0, 10.0, 80.0, 10.0, 20.0, 40.0, 0.0, 20.0, 0.0, 40.0, 40.0, 0.0, 10.0, 70.0, 60.0, 90.0, 30.0, 20.0, 40.0, 20.0, -40.0, 10.0, 10.0, 0.0, 160.0, 0.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 20.0, 20.0, 10.0, 30.0, 70.0, 110.0, 300.0, 60.0, 60.0, 70.0, 80.0, 590.0, 10.0, 60.0, 0.0, 30.0, 70.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 50.0, 20.0, 250.0, 20.0, 20.0, 0.0, 30.0, 40.0, 30.0, 40.0, 10.0, 20.0, 10.0, 310.0, 30.0, 30.0, 0.0, 50.0, 60.0, 50.0, 60.0, 40.0, 180.0, 0.0, 30.0, 20.0, 290.0, 5.0, 270.0, 20.0, 20.0, 150.0, 60.0, 50.0, 90.0, 300.0, 370.0, 50.0, 0.0, -20.0, 10.0, 20.0, 0.0, 70.0, 0.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5180559893337822, "mean_inference_ms": 1.7245318864415906, "mean_action_processing_ms": 0.44499382703327256, "mean_env_wait_ms": 1.38122572206582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05771303176879883, "StateBufferConnector_ms": 0.009387969970703125, "ViewRequirementAgentConnector_ms": 0.3969452381134033}, "num_episodes": 22, "episode_return_max": 1410.0, "episode_return_min": 120.0, "episode_return_mean": 582.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.515621324026455, "num_env_steps_trained_throughput_per_sec": 36.515621324026455, "timesteps_total": 244000, "num_env_steps_sampled_lifetime": 244000, "num_agent_steps_sampled_lifetime": 2440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2440000, "timers": {"training_iteration_time_ms": 110380.08, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110380.032, "sample_time_ms": 2405.174, "learn_time_ms": 107955.383, "learn_throughput": 37.052, "synch_weights_time_ms": 11.036}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 2440000, "num_agent_steps_trained": 2440000}, "done": false, "training_iteration": 61, "trial_id": "57140_00000", "date": "2024-06-27_01-12-01", "timestamp": 1719465121, "time_this_iter_s": 109.55170106887817, "time_total_s": 7047.101944684982, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3e6280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7047.101944684982, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 15.195483870967744, "ram_util_percent": 78.73612903225805}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9774883457107413, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.557172212737818, "policy_loss": -0.005154023991740994, "vf_loss": 4.561638768513998, "vf_explained_var": 0.0008708568617177847, "kl": 0.006874658363442733, "entropy": 0.5281886580113532, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 577485.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "env_runners": {"episode_reward_max": 1410.0, "episode_reward_min": 120.0, "episode_reward_mean": 577.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -250.0}, "policy_reward_max": {"policy_0": 720.0}, "policy_reward_mean": {"policy_0": 57.76}, "custom_metrics": {}, "hist_stats": {"episode_reward": [770.0, 920.0, 1120.0, 180.0, 820.0, 660.0, 460.0, 370.0, 470.0, 1020.0, 860.0, 530.0, 250.0, 820.0, 925.0, 270.0, 850.0, 380.0, 775.0, 210.0, 540.0, 240.0, 795.0, 500.0, 230.0, 540.0, 895.0, 565.0, 295.0, 320.0, 1170.0, 855.0, 380.0, 650.0, 550.0, 420.0, 150.0, 430.0, 810.0, 1360.0, 920.0, 120.0, 390.0, 700.0, 730.0, 570.0, 610.0, 830.0, 280.0, 675.0, 940.0, 400.0, 520.0, 350.0, 255.0, 270.0, 150.0, 1040.0, 560.0, 420.0, 435.0, 580.0, 1040.0, 780.0, 180.0, 400.0, 495.0, 570.0, 310.0, 180.0, 765.0, 300.0, 330.0, 250.0, 210.0, 1410.0, 150.0, 460.0, 550.0, 490.0, 1255.0, 530.0, 240.0, 970.0, 380.0, 895.0, 740.0, 750.0, 290.0, 320.0, 520.0, 750.0, 900.0, 1250.0, 220.0, 1020.0, 385.0, 150.0, 930.0, 295.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 20.0, 180.0, 60.0, 20.0, 20.0, 360.0, 20.0, 30.0, 20.0, 190.0, 250.0, 30.0, 40.0, 60.0, 120.0, 180.0, 40.0, 0.0, 10.0, 580.0, 50.0, -50.0, 0.0, 90.0, 120.0, 150.0, 0.0, 160.0, 20.0, 40.0, 10.0, -20.0, 50.0, 60.0, 30.0, -30.0, 40.0, 0.0, 0.0, 170.0, 60.0, 40.0, 50.0, 270.0, 40.0, 30.0, 90.0, 50.0, 20.0, 220.0, 40.0, 50.0, 50.0, 30.0, 0.0, 30.0, 30.0, 30.0, 180.0, 20.0, 190.0, 70.0, 40.0, 60.0, 40.0, 0.0, 20.0, 20.0, 0.0, 10.0, 10.0, 0.0, 20.0, 20.0, 10.0, 80.0, 30.0, 190.0, 0.0, 40.0, 30.0, 20.0, 10.0, 150.0, 10.0, 150.0, 20.0, 20.0, 20.0, -30.0, 30.0, 40.0, 50.0, -20.0, 350.0, 350.0, 50.0, 170.0, 30.0, 100.0, 470.0, 10.0, 20.0, 10.0, 30.0, 20.0, 30.0, 60.0, 110.0, 0.0, 100.0, 30.0, 20.0, 40.0, 40.0, 10.0, 30.0, 260.0, 0.0, 10.0, 10.0, 0.0, 20.0, -50.0, 10.0, 20.0, 160.0, 10.0, 60.0, 70.0, 40.0, 250.0, 0.0, 150.0, 140.0, 50.0, 0.0, 80.0, 40.0, 170.0, -15.0, 80.0, 260.0, 160.0, 30.0, 180.0, 40.0, 20.0, 0.0, 30.0, 0.0, 70.0, 30.0, 100.0, 40.0, 80.0, -250.0, 20.0, 150.0, -10.0, 370.0, 40.0, 80.0, 60.0, 10.0, 70.0, 150.0, 60.0, 20.0, 20.0, 10.0, 20.0, 30.0, 40.0, 0.0, 80.0, 150.0, 20.0, 10.0, 70.0, 30.0, 40.0, 40.0, 50.0, -25.0, 180.0, 170.0, 180.0, 40.0, 20.0, 50.0, 20.0, 20.0, 50.0, 0.0, 20.0, 0.0, 10.0, 20.0, 20.0, 20.0, 20.0, 40.0, 0.0, 260.0, 50.0, 60.0, 40.0, 30.0, 10.0, 20.0, 10.0, 30.0, 50.0, 50.0, 30.0, 10.0, 30.0, 0.0, 320.0, 0.0, 10.0, 30.0, -5.0, 40.0, 50.0, 70.0, 30.0, 250.0, 10.0, 10.0, 70.0, 0.0, 0.0, 0.0, 0.0, 170.0, 180.0, 60.0, 50.0, 10.0, 0.0, 20.0, 0.0, 20.0, 40.0, 20.0, 30.0, 40.0, 20.0, 10.0, 50.0, 20.0, 10.0, 10.0, 100.0, 220.0, 60.0, 40.0, 270.0, 380.0, 40.0, 150.0, 40.0, 45.0, 10.0, -20.0, -40.0, 20.0, 30.0, 15.0, 260.0, -10.0, 35.0, 30.0, 110.0, 80.0, 30.0, -15.0, 20.0, 60.0, 20.0, 110.0, 20.0, 20.0, 0.0, 30.0, 10.0, 5.0, 190.0, 40.0, 30.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 370.0, 60.0, 180.0, 50.0, 150.0, 140.0, 160.0, 50.0, 10.0, 0.0, 200.0, 35.0, 100.0, 20.0, 80.0, 330.0, 40.0, 10.0, 30.0, 10.0, 10.0, 60.0, 10.0, 50.0, 0.0, 60.0, 10.0, 70.0, 100.0, 10.0, 80.0, 20.0, 20.0, 170.0, 60.0, 40.0, 20.0, 150.0, 90.0, 0.0, 40.0, 30.0, 80.0, 40.0, 80.0, 30.0, 70.0, 70.0, 80.0, 30.0, 10.0, 0.0, 10.0, 60.0, 20.0, 150.0, 40.0, 70.0, 40.0, 20.0, 20.0, 0.0, 30.0, 20.0, 10.0, 10.0, 10.0, 20.0, 0.0, 30.0, 190.0, 40.0, 10.0, 70.0, 50.0, 0.0, 40.0, 30.0, 0.0, 0.0, 20.0, 40.0, 170.0, 30.0, 0.0, 30.0, 190.0, 250.0, 70.0, 10.0, 0.0, 120.0, 270.0, 140.0, 160.0, 80.0, 20.0, 290.0, 60.0, 220.0, 370.0, 40.0, 120.0, 20.0, 170.0, 30.0, 30.0, 0.0, 80.0, 60.0, 10.0, 0.0, 30.0, 30.0, 0.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 40.0, 0.0, 140.0, 0.0, 20.0, 10.0, 180.0, 0.0, 90.0, -50.0, 30.0, 190.0, 210.0, 40.0, 20.0, 40.0, 100.0, 30.0, 170.0, 20.0, 160.0, 20.0, 160.0, 20.0, 30.0, 100.0, 30.0, 20.0, 290.0, 10.0, 20.0, 20.0, 0.0, 0.0, 30.0, 0.0, 180.0, 20.0, 30.0, 10.0, 30.0, 60.0, 100.0, 30.0, 10.0, 40.0, 70.0, 230.0, 10.0, 70.0, 10.0, 60.0, 320.0, 40.0, -20.0, -30.0, 290.0, 80.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 50.0, 30.0, 0.0, 110.0, 40.0, 30.0, 30.0, -40.0, 160.0, 20.0, 50.0, 30.0, -5.0, 360.0, 30.0, 320.0, 20.0, 20.0, 280.0, 90.0, 20.0, 0.0, 20.0, 140.0, 30.0, 30.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 180.0, 110.0, 90.0, 0.0, 170.0, 10.0, 0.0, 40.0, 100.0, 0.0, 100.0, 10.0, 0.0, 40.0, 150.0, -20.0, 10.0, 60.0, 20.0, 30.0, 40.0, 20.0, 40.0, 20.0, 10.0, 0.0, 5.0, 30.0, 20.0, 60.0, 60.0, 10.0, 40.0, 0.0, 40.0, 10.0, 80.0, 20.0, 30.0, 0.0, 30.0, 20.0, 60.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 30.0, 30.0, 0.0, 50.0, 60.0, 30.0, 350.0, 30.0, 90.0, 50.0, 60.0, 310.0, 10.0, 200.0, 40.0, 20.0, 0.0, 50.0, 30.0, 10.0, 20.0, 30.0, 160.0, 30.0, 70.0, 190.0, 10.0, 40.0, 10.0, 0.0, 20.0, 40.0, 10.0, 20.0, 200.0, 40.0, 50.0, 20.0, 20.0, 0.0, 50.0, 25.0, 10.0, 40.0, 0.0, 40.0, 0.0, 70.0, 20.0, 160.0, 20.0, 160.0, 70.0, 350.0, 60.0, 40.0, 40.0, 0.0, -10.0, 400.0, 110.0, 10.0, 40.0, 160.0, 350.0, 0.0, 40.0, 70.0, 30.0, 30.0, 30.0, 40.0, 30.0, 20.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 30.0, 70.0, 10.0, 10.0, 0.0, 20.0, 30.0, 30.0, 10.0, 0.0, 30.0, 250.0, 20.0, 30.0, 0.0, 30.0, 10.0, 40.0, 80.0, -30.0, -55.0, 360.0, 30.0, 60.0, 40.0, 270.0, 0.0, 30.0, 50.0, 10.0, 70.0, 10.0, 30.0, 30.0, 10.0, -20.0, 180.0, 30.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 80.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 50.0, 10.0, 250.0, 80.0, 20.0, 10.0, 260.0, 60.0, -5.0, 0.0, 30.0, 40.0, 0.0, 70.0, 10.0, 80.0, 10.0, 20.0, 40.0, 0.0, 20.0, 0.0, 40.0, 40.0, 0.0, 10.0, 70.0, 60.0, 90.0, 30.0, 20.0, 40.0, 20.0, -40.0, 10.0, 10.0, 0.0, 160.0, 0.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 20.0, 20.0, 10.0, 30.0, 70.0, 110.0, 300.0, 60.0, 60.0, 70.0, 80.0, 590.0, 10.0, 60.0, 0.0, 30.0, 70.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 50.0, 20.0, 250.0, 20.0, 20.0, 0.0, 30.0, 40.0, 30.0, 40.0, 10.0, 20.0, 10.0, 310.0, 30.0, 30.0, 0.0, 50.0, 60.0, 50.0, 60.0, 40.0, 180.0, 0.0, 30.0, 20.0, 290.0, 5.0, 270.0, 20.0, 20.0, 150.0, 60.0, 50.0, 90.0, 300.0, 370.0, 50.0, 0.0, -20.0, 10.0, 20.0, 0.0, 70.0, 0.0, 30.0, 10.0, 10.0, 80.0, 0.0, 40.0, 20.0, 0.0, 10.0, 20.0, 50.0, 0.0, 170.0, 10.0, 230.0, 10.0, 190.0, 170.0, 30.0, 40.0, 120.0, 20.0, 100.0, 10.0, 0.0, 0.0, 20.0, 30.0, 50.0, 0.0, 150.0, 60.0, 260.0, -5.0, 260.0, 30.0, 180.0, 20.0, 0.0, 60.0, 30.0, 30.0, 70.0, 300.0, 20.0, 70.0, 0.0, 40.0, 80.0, 110.0, 20.0, 60.0, 50.0, 30.0, 10.0, -20.0, 360.0, 50.0, 0.0, 30.0, 180.0, 10.0, 20.0, 20.0, 30.0, 30.0, 40.0, 80.0, 10.0, 40.0, 10.0, 30.0, 10.0, 10.0, 0.0, 10.0, 60.0, 170.0, 20.0, 0.0, 10.0, 20.0, 10.0, 280.0, 60.0, 30.0, 30.0, 20.0, 10.0, 20.0, 40.0, 220.0, 0.0, 50.0, 60.0, 200.0, 70.0, 70.0, 40.0, 40.0, 0.0, 20.0, 40.0, 460.0, 145.0, 100.0, 10.0, -45.0, 30.0, 70.0, 70.0, 10.0, 10.0, 50.0, 60.0, 70.0, 0.0, 150.0, 90.0, 720.0, 90.0, 30.0, 20.0, 0.0, 0.0, 10.0, 40.0, 40.0, 20.0, 30.0, 30.0, 190.0, 0.0, 30.0, 10.0, 360.0, 350.0, 40.0, 20.0, 10.0, 10.0, 10.0, 180.0, 10.0, 20.0, 0.0, 70.0, 30.0, -5.0, 30.0, 40.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 40.0, 0.0, 40.0, 10.0, 120.0, 50.0, 50.0, 40.0, 170.0, 110.0, 10.0, 190.0, 20.0, 170.0, 120.0, 80.0, 30.0, 0.0, -5.0, 20.0, 30.0, 20.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5113431880689598, "mean_inference_ms": 1.7145664788531758, "mean_action_processing_ms": 0.44233246890026623, "mean_env_wait_ms": 1.375772974255332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056237220764160156, "StateBufferConnector_ms": 0.009213685989379883, "ViewRequirementAgentConnector_ms": 0.375903844833374}, "num_episodes": 18, "episode_return_max": 1410.0, "episode_return_min": 120.0, "episode_return_mean": 577.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.38291197926272, "num_env_steps_trained_throughput_per_sec": 36.38291197926272, "timesteps_total": 248000, "num_env_steps_sampled_lifetime": 248000, "num_agent_steps_sampled_lifetime": 2480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2480000, "timers": {"training_iteration_time_ms": 110297.769, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110297.721, "sample_time_ms": 2411.775, "learn_time_ms": 107866.429, "learn_throughput": 37.083, "synch_weights_time_ms": 11.005}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 2480000, "num_agent_steps_trained": 2480000}, "done": false, "training_iteration": 62, "trial_id": "57140_00000", "date": "2024-06-27_01-13-51", "timestamp": 1719465231, "time_this_iter_s": 109.95442605018616, "time_total_s": 7157.0563707351685, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b19473a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7157.0563707351685, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 15.378846153846156, "ram_util_percent": 78.20320512820513}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8750371824946013, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.04863160590902, "policy_loss": -0.00532289883252025, "vf_loss": 5.053237537708019, "vf_explained_var": 0.0004942140830591463, "kl": 0.007169680444515911, "entropy": 0.49692585003007844, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 586875.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000}, "env_runners": {"episode_reward_max": 1490.0, "episode_reward_min": 120.0, "episode_reward_mean": 596.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -550.0}, "policy_reward_max": {"policy_0": 720.0}, "policy_reward_mean": {"policy_0": 59.62}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 230.0, 540.0, 895.0, 565.0, 295.0, 320.0, 1170.0, 855.0, 380.0, 650.0, 550.0, 420.0, 150.0, 430.0, 810.0, 1360.0, 920.0, 120.0, 390.0, 700.0, 730.0, 570.0, 610.0, 830.0, 280.0, 675.0, 940.0, 400.0, 520.0, 350.0, 255.0, 270.0, 150.0, 1040.0, 560.0, 420.0, 435.0, 580.0, 1040.0, 780.0, 180.0, 400.0, 495.0, 570.0, 310.0, 180.0, 765.0, 300.0, 330.0, 250.0, 210.0, 1410.0, 150.0, 460.0, 550.0, 490.0, 1255.0, 530.0, 240.0, 970.0, 380.0, 895.0, 740.0, 750.0, 290.0, 320.0, 520.0, 750.0, 900.0, 1250.0, 220.0, 1020.0, 385.0, 150.0, 930.0, 295.0, 590.0, 670.0, 670.0, 460.0, 860.0, 310.0, 440.0, 1140.0, 930.0, 520.0, 1020.0, 1490.0, 670.0, 620.0, 640.0, 390.0, 440.0, 310.0, 475.0, 520.0, 565.0, 915.0, 1450.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 10.0, 70.0, 0.0, 0.0, 0.0, 0.0, 170.0, 180.0, 60.0, 50.0, 10.0, 0.0, 20.0, 0.0, 20.0, 40.0, 20.0, 30.0, 40.0, 20.0, 10.0, 50.0, 20.0, 10.0, 10.0, 100.0, 220.0, 60.0, 40.0, 270.0, 380.0, 40.0, 150.0, 40.0, 45.0, 10.0, -20.0, -40.0, 20.0, 30.0, 15.0, 260.0, -10.0, 35.0, 30.0, 110.0, 80.0, 30.0, -15.0, 20.0, 60.0, 20.0, 110.0, 20.0, 20.0, 0.0, 30.0, 10.0, 5.0, 190.0, 40.0, 30.0, 0.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 370.0, 60.0, 180.0, 50.0, 150.0, 140.0, 160.0, 50.0, 10.0, 0.0, 200.0, 35.0, 100.0, 20.0, 80.0, 330.0, 40.0, 10.0, 30.0, 10.0, 10.0, 60.0, 10.0, 50.0, 0.0, 60.0, 10.0, 70.0, 100.0, 10.0, 80.0, 20.0, 20.0, 170.0, 60.0, 40.0, 20.0, 150.0, 90.0, 0.0, 40.0, 30.0, 80.0, 40.0, 80.0, 30.0, 70.0, 70.0, 80.0, 30.0, 10.0, 0.0, 10.0, 60.0, 20.0, 150.0, 40.0, 70.0, 40.0, 20.0, 20.0, 0.0, 30.0, 20.0, 10.0, 10.0, 10.0, 20.0, 0.0, 30.0, 190.0, 40.0, 10.0, 70.0, 50.0, 0.0, 40.0, 30.0, 0.0, 0.0, 20.0, 40.0, 170.0, 30.0, 0.0, 30.0, 190.0, 250.0, 70.0, 10.0, 0.0, 120.0, 270.0, 140.0, 160.0, 80.0, 20.0, 290.0, 60.0, 220.0, 370.0, 40.0, 120.0, 20.0, 170.0, 30.0, 30.0, 0.0, 80.0, 60.0, 10.0, 0.0, 30.0, 30.0, 0.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 40.0, 0.0, 140.0, 0.0, 20.0, 10.0, 180.0, 0.0, 90.0, -50.0, 30.0, 190.0, 210.0, 40.0, 20.0, 40.0, 100.0, 30.0, 170.0, 20.0, 160.0, 20.0, 160.0, 20.0, 30.0, 100.0, 30.0, 20.0, 290.0, 10.0, 20.0, 20.0, 0.0, 0.0, 30.0, 0.0, 180.0, 20.0, 30.0, 10.0, 30.0, 60.0, 100.0, 30.0, 10.0, 40.0, 70.0, 230.0, 10.0, 70.0, 10.0, 60.0, 320.0, 40.0, -20.0, -30.0, 290.0, 80.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 50.0, 30.0, 0.0, 110.0, 40.0, 30.0, 30.0, -40.0, 160.0, 20.0, 50.0, 30.0, -5.0, 360.0, 30.0, 320.0, 20.0, 20.0, 280.0, 90.0, 20.0, 0.0, 20.0, 140.0, 30.0, 30.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 180.0, 110.0, 90.0, 0.0, 170.0, 10.0, 0.0, 40.0, 100.0, 0.0, 100.0, 10.0, 0.0, 40.0, 150.0, -20.0, 10.0, 60.0, 20.0, 30.0, 40.0, 20.0, 40.0, 20.0, 10.0, 0.0, 5.0, 30.0, 20.0, 60.0, 60.0, 10.0, 40.0, 0.0, 40.0, 10.0, 80.0, 20.0, 30.0, 0.0, 30.0, 20.0, 60.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 30.0, 30.0, 0.0, 50.0, 60.0, 30.0, 350.0, 30.0, 90.0, 50.0, 60.0, 310.0, 10.0, 200.0, 40.0, 20.0, 0.0, 50.0, 30.0, 10.0, 20.0, 30.0, 160.0, 30.0, 70.0, 190.0, 10.0, 40.0, 10.0, 0.0, 20.0, 40.0, 10.0, 20.0, 200.0, 40.0, 50.0, 20.0, 20.0, 0.0, 50.0, 25.0, 10.0, 40.0, 0.0, 40.0, 0.0, 70.0, 20.0, 160.0, 20.0, 160.0, 70.0, 350.0, 60.0, 40.0, 40.0, 0.0, -10.0, 400.0, 110.0, 10.0, 40.0, 160.0, 350.0, 0.0, 40.0, 70.0, 30.0, 30.0, 30.0, 40.0, 30.0, 20.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 30.0, 70.0, 10.0, 10.0, 0.0, 20.0, 30.0, 30.0, 10.0, 0.0, 30.0, 250.0, 20.0, 30.0, 0.0, 30.0, 10.0, 40.0, 80.0, -30.0, -55.0, 360.0, 30.0, 60.0, 40.0, 270.0, 0.0, 30.0, 50.0, 10.0, 70.0, 10.0, 30.0, 30.0, 10.0, -20.0, 180.0, 30.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 80.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 50.0, 10.0, 250.0, 80.0, 20.0, 10.0, 260.0, 60.0, -5.0, 0.0, 30.0, 40.0, 0.0, 70.0, 10.0, 80.0, 10.0, 20.0, 40.0, 0.0, 20.0, 0.0, 40.0, 40.0, 0.0, 10.0, 70.0, 60.0, 90.0, 30.0, 20.0, 40.0, 20.0, -40.0, 10.0, 10.0, 0.0, 160.0, 0.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 20.0, 20.0, 10.0, 30.0, 70.0, 110.0, 300.0, 60.0, 60.0, 70.0, 80.0, 590.0, 10.0, 60.0, 0.0, 30.0, 70.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 50.0, 20.0, 250.0, 20.0, 20.0, 0.0, 30.0, 40.0, 30.0, 40.0, 10.0, 20.0, 10.0, 310.0, 30.0, 30.0, 0.0, 50.0, 60.0, 50.0, 60.0, 40.0, 180.0, 0.0, 30.0, 20.0, 290.0, 5.0, 270.0, 20.0, 20.0, 150.0, 60.0, 50.0, 90.0, 300.0, 370.0, 50.0, 0.0, -20.0, 10.0, 20.0, 0.0, 70.0, 0.0, 30.0, 10.0, 10.0, 80.0, 0.0, 40.0, 20.0, 0.0, 10.0, 20.0, 50.0, 0.0, 170.0, 10.0, 230.0, 10.0, 190.0, 170.0, 30.0, 40.0, 120.0, 20.0, 100.0, 10.0, 0.0, 0.0, 20.0, 30.0, 50.0, 0.0, 150.0, 60.0, 260.0, -5.0, 260.0, 30.0, 180.0, 20.0, 0.0, 60.0, 30.0, 30.0, 70.0, 300.0, 20.0, 70.0, 0.0, 40.0, 80.0, 110.0, 20.0, 60.0, 50.0, 30.0, 10.0, -20.0, 360.0, 50.0, 0.0, 30.0, 180.0, 10.0, 20.0, 20.0, 30.0, 30.0, 40.0, 80.0, 10.0, 40.0, 10.0, 30.0, 10.0, 10.0, 0.0, 10.0, 60.0, 170.0, 20.0, 0.0, 10.0, 20.0, 10.0, 280.0, 60.0, 30.0, 30.0, 20.0, 10.0, 20.0, 40.0, 220.0, 0.0, 50.0, 60.0, 200.0, 70.0, 70.0, 40.0, 40.0, 0.0, 20.0, 40.0, 460.0, 145.0, 100.0, 10.0, -45.0, 30.0, 70.0, 70.0, 10.0, 10.0, 50.0, 60.0, 70.0, 0.0, 150.0, 90.0, 720.0, 90.0, 30.0, 20.0, 0.0, 0.0, 10.0, 40.0, 40.0, 20.0, 30.0, 30.0, 190.0, 0.0, 30.0, 10.0, 360.0, 350.0, 40.0, 20.0, 10.0, 10.0, 10.0, 180.0, 10.0, 20.0, 0.0, 70.0, 30.0, -5.0, 30.0, 40.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 40.0, 0.0, 40.0, 10.0, 120.0, 50.0, 50.0, 40.0, 170.0, 110.0, 10.0, 190.0, 20.0, 170.0, 120.0, 80.0, 30.0, 0.0, -5.0, 20.0, 30.0, 20.0, 0.0, 0.0, 30.0, 30.0, 10.0, 20.0, 50.0, 200.0, 60.0, 10.0, 140.0, 40.0, 10.0, 10.0, 0.0, 20.0, 10.0, 40.0, 10.0, 550.0, -10.0, 30.0, -550.0, 350.0, 100.0, 40.0, 40.0, 40.0, 30.0, 20.0, 300.0, 300.0, 10.0, 90.0, 20.0, 160.0, 60.0, 20.0, 30.0, 20.0, 40.0, 10.0, 20.0, 30.0, 210.0, 170.0, 50.0, 40.0, 90.0, 30.0, 170.0, 50.0, 40.0, 30.0, 60.0, 0.0, 10.0, 40.0, 35.0, 30.0, 40.0, 25.0, 20.0, 20.0, 10.0, 30.0, 10.0, 0.0, 10.0, 190.0, 0.0, 150.0, 20.0, 670.0, 60.0, 200.0, 70.0, -10.0, 20.0, 30.0, 80.0, 0.0, 190.0, 30.0, 120.0, 130.0, 30.0, 240.0, 20.0, 50.0, 50.0, 70.0, 170.0, -10.0, 10.0, 20.0, 40.0, 30.0, 150.0, 0.0, 70.0, 40.0, 190.0, 180.0, 90.0, 100.0, 0.0, 20.0, 200.0, 190.0, 70.0, -20.0, 40.0, 10.0, 50.0, 330.0, 650.0, 90.0, 110.0, 160.0, 80.0, -30.0, 30.0, -10.0, 20.0, 390.0, 20.0, 20.0, 30.0, 90.0, 80.0, 0.0, 170.0, 40.0, 60.0, 70.0, 10.0, 80.0, 30.0, 10.0, 130.0, 20.0, 20.0, 60.0, 250.0, 110.0, 30.0, 60.0, 0.0, 20.0, 30.0, 60.0, 20.0, 40.0, 40.0, 30.0, 110.0, 40.0, 30.0, 10.0, 10.0, 60.0, 0.0, 60.0, 130.0, 0.0, 30.0, 0.0, 100.0, 40.0, 50.0, 30.0, 10.0, 30.0, 0.0, 30.0, 0.0, 10.0, 40.0, 30.0, 160.0, 0.0, 30.0, 70.0, 10.0, 270.0, 25.0, 0.0, 0.0, 20.0, 0.0, 50.0, 20.0, 30.0, 10.0, 40.0, 120.0, 40.0, 190.0, 0.0, 30.0, 40.0, 0.0, 25.0, 10.0, 260.0, 0.0, 40.0, 20.0, 70.0, 100.0, 40.0, 60.0, 160.0, 100.0, 60.0, 250.0, 30.0, 30.0, 150.0, 40.0, 35.0, 40.0, 190.0, 90.0, 70.0, 570.0, 190.0, 130.0, 30.0, 120.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5075031477194158, "mean_inference_ms": 1.7110351739189642, "mean_action_processing_ms": 0.441280994969861, "mean_env_wait_ms": 1.3728227763093233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05739092826843262, "StateBufferConnector_ms": 0.00935983657836914, "ViewRequirementAgentConnector_ms": 0.38782548904418945}, "num_episodes": 23, "episode_return_max": 1490.0, "episode_return_min": 120.0, "episode_return_mean": 596.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.025591140731265, "num_env_steps_trained_throughput_per_sec": 36.025591140731265, "timesteps_total": 252000, "num_env_steps_sampled_lifetime": 252000, "num_agent_steps_sampled_lifetime": 2520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2520000, "timers": {"training_iteration_time_ms": 110357.495, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110357.447, "sample_time_ms": 2411.337, "learn_time_ms": 107926.293, "learn_throughput": 37.062, "synch_weights_time_ms": 11.211}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 2520000, "num_agent_steps_trained": 2520000}, "done": false, "training_iteration": 63, "trial_id": "57140_00000", "date": "2024-06-27_01-15-42", "timestamp": 1719465342, "time_this_iter_s": 111.04582524299622, "time_total_s": 7268.102195978165, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af404f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7268.102195978165, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 16.50509554140127, "ram_util_percent": 78.23949044585987}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9850246302934247, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.484496555440088, "policy_loss": -0.0054618262625706045, "vf_loss": 4.4891955012838425, "vf_explained_var": 0.0009751286496496556, "kl": 0.007628799991139915, "entropy": 0.5217051652356332, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 596265.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "env_runners": {"episode_reward_max": 1490.0, "episode_reward_min": 120.0, "episode_reward_mean": 587.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -550.0}, "policy_reward_max": {"policy_0": 720.0}, "policy_reward_mean": {"policy_0": 58.76}, "custom_metrics": {}, "hist_stats": {"episode_reward": [120.0, 390.0, 700.0, 730.0, 570.0, 610.0, 830.0, 280.0, 675.0, 940.0, 400.0, 520.0, 350.0, 255.0, 270.0, 150.0, 1040.0, 560.0, 420.0, 435.0, 580.0, 1040.0, 780.0, 180.0, 400.0, 495.0, 570.0, 310.0, 180.0, 765.0, 300.0, 330.0, 250.0, 210.0, 1410.0, 150.0, 460.0, 550.0, 490.0, 1255.0, 530.0, 240.0, 970.0, 380.0, 895.0, 740.0, 750.0, 290.0, 320.0, 520.0, 750.0, 900.0, 1250.0, 220.0, 1020.0, 385.0, 150.0, 930.0, 295.0, 590.0, 670.0, 670.0, 460.0, 860.0, 310.0, 440.0, 1140.0, 930.0, 520.0, 1020.0, 1490.0, 670.0, 620.0, 640.0, 390.0, 440.0, 310.0, 475.0, 520.0, 565.0, 915.0, 1450.0, 635.0, 470.0, 620.0, 540.0, 180.0, 340.0, 630.0, 775.0, 1130.0, 350.0, 465.0, 140.0, 390.0, 760.0, 410.0, 360.0, 1075.0, 910.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 0.0, 30.0, 30.0, 0.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 40.0, 0.0, 140.0, 0.0, 20.0, 10.0, 180.0, 0.0, 90.0, -50.0, 30.0, 190.0, 210.0, 40.0, 20.0, 40.0, 100.0, 30.0, 170.0, 20.0, 160.0, 20.0, 160.0, 20.0, 30.0, 100.0, 30.0, 20.0, 290.0, 10.0, 20.0, 20.0, 0.0, 0.0, 30.0, 0.0, 180.0, 20.0, 30.0, 10.0, 30.0, 60.0, 100.0, 30.0, 10.0, 40.0, 70.0, 230.0, 10.0, 70.0, 10.0, 60.0, 320.0, 40.0, -20.0, -30.0, 290.0, 80.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 50.0, 30.0, 0.0, 110.0, 40.0, 30.0, 30.0, -40.0, 160.0, 20.0, 50.0, 30.0, -5.0, 360.0, 30.0, 320.0, 20.0, 20.0, 280.0, 90.0, 20.0, 0.0, 20.0, 140.0, 30.0, 30.0, 10.0, 10.0, 10.0, 0.0, 20.0, 0.0, 180.0, 110.0, 90.0, 0.0, 170.0, 10.0, 0.0, 40.0, 100.0, 0.0, 100.0, 10.0, 0.0, 40.0, 150.0, -20.0, 10.0, 60.0, 20.0, 30.0, 40.0, 20.0, 40.0, 20.0, 10.0, 0.0, 5.0, 30.0, 20.0, 60.0, 60.0, 10.0, 40.0, 0.0, 40.0, 10.0, 80.0, 20.0, 30.0, 0.0, 30.0, 20.0, 60.0, 0.0, 10.0, 10.0, 0.0, 0.0, 10.0, 30.0, 30.0, 0.0, 50.0, 60.0, 30.0, 350.0, 30.0, 90.0, 50.0, 60.0, 310.0, 10.0, 200.0, 40.0, 20.0, 0.0, 50.0, 30.0, 10.0, 20.0, 30.0, 160.0, 30.0, 70.0, 190.0, 10.0, 40.0, 10.0, 0.0, 20.0, 40.0, 10.0, 20.0, 200.0, 40.0, 50.0, 20.0, 20.0, 0.0, 50.0, 25.0, 10.0, 40.0, 0.0, 40.0, 0.0, 70.0, 20.0, 160.0, 20.0, 160.0, 70.0, 350.0, 60.0, 40.0, 40.0, 0.0, -10.0, 400.0, 110.0, 10.0, 40.0, 160.0, 350.0, 0.0, 40.0, 70.0, 30.0, 30.0, 30.0, 40.0, 30.0, 20.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 30.0, 70.0, 10.0, 10.0, 0.0, 20.0, 30.0, 30.0, 10.0, 0.0, 30.0, 250.0, 20.0, 30.0, 0.0, 30.0, 10.0, 40.0, 80.0, -30.0, -55.0, 360.0, 30.0, 60.0, 40.0, 270.0, 0.0, 30.0, 50.0, 10.0, 70.0, 10.0, 30.0, 30.0, 10.0, -20.0, 180.0, 30.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 80.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 50.0, 10.0, 250.0, 80.0, 20.0, 10.0, 260.0, 60.0, -5.0, 0.0, 30.0, 40.0, 0.0, 70.0, 10.0, 80.0, 10.0, 20.0, 40.0, 0.0, 20.0, 0.0, 40.0, 40.0, 0.0, 10.0, 70.0, 60.0, 90.0, 30.0, 20.0, 40.0, 20.0, -40.0, 10.0, 10.0, 0.0, 160.0, 0.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 20.0, 20.0, 10.0, 30.0, 70.0, 110.0, 300.0, 60.0, 60.0, 70.0, 80.0, 590.0, 10.0, 60.0, 0.0, 30.0, 70.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 50.0, 20.0, 250.0, 20.0, 20.0, 0.0, 30.0, 40.0, 30.0, 40.0, 10.0, 20.0, 10.0, 310.0, 30.0, 30.0, 0.0, 50.0, 60.0, 50.0, 60.0, 40.0, 180.0, 0.0, 30.0, 20.0, 290.0, 5.0, 270.0, 20.0, 20.0, 150.0, 60.0, 50.0, 90.0, 300.0, 370.0, 50.0, 0.0, -20.0, 10.0, 20.0, 0.0, 70.0, 0.0, 30.0, 10.0, 10.0, 80.0, 0.0, 40.0, 20.0, 0.0, 10.0, 20.0, 50.0, 0.0, 170.0, 10.0, 230.0, 10.0, 190.0, 170.0, 30.0, 40.0, 120.0, 20.0, 100.0, 10.0, 0.0, 0.0, 20.0, 30.0, 50.0, 0.0, 150.0, 60.0, 260.0, -5.0, 260.0, 30.0, 180.0, 20.0, 0.0, 60.0, 30.0, 30.0, 70.0, 300.0, 20.0, 70.0, 0.0, 40.0, 80.0, 110.0, 20.0, 60.0, 50.0, 30.0, 10.0, -20.0, 360.0, 50.0, 0.0, 30.0, 180.0, 10.0, 20.0, 20.0, 30.0, 30.0, 40.0, 80.0, 10.0, 40.0, 10.0, 30.0, 10.0, 10.0, 0.0, 10.0, 60.0, 170.0, 20.0, 0.0, 10.0, 20.0, 10.0, 280.0, 60.0, 30.0, 30.0, 20.0, 10.0, 20.0, 40.0, 220.0, 0.0, 50.0, 60.0, 200.0, 70.0, 70.0, 40.0, 40.0, 0.0, 20.0, 40.0, 460.0, 145.0, 100.0, 10.0, -45.0, 30.0, 70.0, 70.0, 10.0, 10.0, 50.0, 60.0, 70.0, 0.0, 150.0, 90.0, 720.0, 90.0, 30.0, 20.0, 0.0, 0.0, 10.0, 40.0, 40.0, 20.0, 30.0, 30.0, 190.0, 0.0, 30.0, 10.0, 360.0, 350.0, 40.0, 20.0, 10.0, 10.0, 10.0, 180.0, 10.0, 20.0, 0.0, 70.0, 30.0, -5.0, 30.0, 40.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 40.0, 0.0, 40.0, 10.0, 120.0, 50.0, 50.0, 40.0, 170.0, 110.0, 10.0, 190.0, 20.0, 170.0, 120.0, 80.0, 30.0, 0.0, -5.0, 20.0, 30.0, 20.0, 0.0, 0.0, 30.0, 30.0, 10.0, 20.0, 50.0, 200.0, 60.0, 10.0, 140.0, 40.0, 10.0, 10.0, 0.0, 20.0, 10.0, 40.0, 10.0, 550.0, -10.0, 30.0, -550.0, 350.0, 100.0, 40.0, 40.0, 40.0, 30.0, 20.0, 300.0, 300.0, 10.0, 90.0, 20.0, 160.0, 60.0, 20.0, 30.0, 20.0, 40.0, 10.0, 20.0, 30.0, 210.0, 170.0, 50.0, 40.0, 90.0, 30.0, 170.0, 50.0, 40.0, 30.0, 60.0, 0.0, 10.0, 40.0, 35.0, 30.0, 40.0, 25.0, 20.0, 20.0, 10.0, 30.0, 10.0, 0.0, 10.0, 190.0, 0.0, 150.0, 20.0, 670.0, 60.0, 200.0, 70.0, -10.0, 20.0, 30.0, 80.0, 0.0, 190.0, 30.0, 120.0, 130.0, 30.0, 240.0, 20.0, 50.0, 50.0, 70.0, 170.0, -10.0, 10.0, 20.0, 40.0, 30.0, 150.0, 0.0, 70.0, 40.0, 190.0, 180.0, 90.0, 100.0, 0.0, 20.0, 200.0, 190.0, 70.0, -20.0, 40.0, 10.0, 50.0, 330.0, 650.0, 90.0, 110.0, 160.0, 80.0, -30.0, 30.0, -10.0, 20.0, 390.0, 20.0, 20.0, 30.0, 90.0, 80.0, 0.0, 170.0, 40.0, 60.0, 70.0, 10.0, 80.0, 30.0, 10.0, 130.0, 20.0, 20.0, 60.0, 250.0, 110.0, 30.0, 60.0, 0.0, 20.0, 30.0, 60.0, 20.0, 40.0, 40.0, 30.0, 110.0, 40.0, 30.0, 10.0, 10.0, 60.0, 0.0, 60.0, 130.0, 0.0, 30.0, 0.0, 100.0, 40.0, 50.0, 30.0, 10.0, 30.0, 0.0, 30.0, 0.0, 10.0, 40.0, 30.0, 160.0, 0.0, 30.0, 70.0, 10.0, 270.0, 25.0, 0.0, 0.0, 20.0, 0.0, 50.0, 20.0, 30.0, 10.0, 40.0, 120.0, 40.0, 190.0, 0.0, 30.0, 40.0, 0.0, 25.0, 10.0, 260.0, 0.0, 40.0, 20.0, 70.0, 100.0, 40.0, 60.0, 160.0, 100.0, 60.0, 250.0, 30.0, 30.0, 150.0, 40.0, 35.0, 40.0, 190.0, 90.0, 70.0, 570.0, 190.0, 130.0, 30.0, 120.0, 20.0, 20.0, 150.0, 150.0, 10.0, 0.0, 0.0, 25.0, 50.0, 210.0, 20.0, 0.0, 40.0, 210.0, 40.0, 20.0, 30.0, 40.0, 30.0, 20.0, 40.0, 50.0, 0.0, 70.0, -30.0, 20.0, 20.0, 30.0, 110.0, 400.0, -50.0, 20.0, 180.0, 0.0, 40.0, 40.0, 25.0, 190.0, 40.0, 30.0, -25.0, 0.0, 30.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 80.0, 30.0, 30.0, 60.0, 40.0, 0.0, 40.0, 20.0, 10.0, 70.0, 70.0, 0.0, 40.0, 60.0, 180.0, 50.0, 20.0, 30.0, 40.0, 170.0, 20.0, 20.0, 0.0, 70.0, 120.0, 180.0, 40.0, 80.0, 45.0, 180.0, 30.0, 30.0, 50.0, 10.0, 120.0, 30.0, 90.0, 80.0, 540.0, 40.0, 30.0, 140.0, 0.0, 30.0, 40.0, 70.0, 20.0, 140.0, 0.0, 30.0, 0.0, 20.0, 270.0, 30.0, 80.0, 30.0, 10.0, -15.0, -10.0, 0.0, 40.0, 30.0, 0.0, 50.0, 20.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 40.0, 150.0, 0.0, 20.0, 0.0, 10.0, 20.0, 40.0, 90.0, 20.0, 40.0, 20.0, 80.0, 130.0, 10.0, 40.0, 220.0, 30.0, 10.0, 180.0, 40.0, 60.0, 20.0, 0.0, 0.0, 180.0, 30.0, 0.0, 0.0, 80.0, 90.0, 20.0, 10.0, 30.0, 20.0, 10.0, 0.0, 150.0, 0.0, 30.0, 255.0, 70.0, 60.0, -40.0, -50.0, 400.0, 30.0, 380.0, 0.0, -30.0, 20.0, 240.0, 150.0, 160.0, 40.0, 10.0, 20.0, 10.0, 30.0, 230.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.504627992815688, "mean_inference_ms": 1.7083036284130546, "mean_action_processing_ms": 0.44042540454888957, "mean_env_wait_ms": 1.3706256431876014, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056687116622924805, "StateBufferConnector_ms": 0.009369373321533203, "ViewRequirementAgentConnector_ms": 0.3835790157318115}, "num_episodes": 18, "episode_return_max": 1490.0, "episode_return_min": 120.0, "episode_return_mean": 587.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.468006788487386, "num_env_steps_trained_throughput_per_sec": 36.468006788487386, "timesteps_total": 256000, "num_env_steps_sampled_lifetime": 256000, "num_agent_steps_sampled_lifetime": 2560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2560000, "timers": {"training_iteration_time_ms": 110307.892, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110307.844, "sample_time_ms": 2408.988, "learn_time_ms": 107879.266, "learn_throughput": 37.078, "synch_weights_time_ms": 11.178}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 2560000, "num_agent_steps_trained": 2560000}, "done": false, "training_iteration": 64, "trial_id": "57140_00000", "date": "2024-06-27_01-17-31", "timestamp": 1719465451, "time_this_iter_s": 109.69851899147034, "time_total_s": 7377.800714969635, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af436670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7377.800714969635, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 15.384516129032258, "ram_util_percent": 78.8225806451613}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9778697559532648, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.359715335082195, "policy_loss": -0.004587271257875937, "vf_loss": 4.363541876774627, "vf_explained_var": 0.0006760159556985028, "kl": 0.0076073005584561286, "entropy": 0.5114152145715821, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 605655.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000}, "env_runners": {"episode_reward_max": 1490.0, "episode_reward_min": 140.0, "episode_reward_mean": 610.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -550.0}, "policy_reward_max": {"policy_0": 1010.0}, "policy_reward_mean": {"policy_0": 61.02}, "custom_metrics": {}, "hist_stats": {"episode_reward": [420.0, 435.0, 580.0, 1040.0, 780.0, 180.0, 400.0, 495.0, 570.0, 310.0, 180.0, 765.0, 300.0, 330.0, 250.0, 210.0, 1410.0, 150.0, 460.0, 550.0, 490.0, 1255.0, 530.0, 240.0, 970.0, 380.0, 895.0, 740.0, 750.0, 290.0, 320.0, 520.0, 750.0, 900.0, 1250.0, 220.0, 1020.0, 385.0, 150.0, 930.0, 295.0, 590.0, 670.0, 670.0, 460.0, 860.0, 310.0, 440.0, 1140.0, 930.0, 520.0, 1020.0, 1490.0, 670.0, 620.0, 640.0, 390.0, 440.0, 310.0, 475.0, 520.0, 565.0, 915.0, 1450.0, 635.0, 470.0, 620.0, 540.0, 180.0, 340.0, 630.0, 775.0, 1130.0, 350.0, 465.0, 140.0, 390.0, 760.0, 410.0, 360.0, 1075.0, 910.0, 580.0, 1245.0, 330.0, 375.0, 670.0, 935.0, 290.0, 510.0, 220.0, 850.0, 660.0, 445.0, 515.0, 1070.0, 540.0, 490.0, 1250.0, 675.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 70.0, 190.0, 10.0, 40.0, 10.0, 0.0, 20.0, 40.0, 10.0, 20.0, 200.0, 40.0, 50.0, 20.0, 20.0, 0.0, 50.0, 25.0, 10.0, 40.0, 0.0, 40.0, 0.0, 70.0, 20.0, 160.0, 20.0, 160.0, 70.0, 350.0, 60.0, 40.0, 40.0, 0.0, -10.0, 400.0, 110.0, 10.0, 40.0, 160.0, 350.0, 0.0, 40.0, 70.0, 30.0, 30.0, 30.0, 40.0, 30.0, 20.0, 0.0, 0.0, 50.0, 0.0, 0.0, 0.0, 30.0, 70.0, 10.0, 10.0, 0.0, 20.0, 30.0, 30.0, 10.0, 0.0, 30.0, 250.0, 20.0, 30.0, 0.0, 30.0, 10.0, 40.0, 80.0, -30.0, -55.0, 360.0, 30.0, 60.0, 40.0, 270.0, 0.0, 30.0, 50.0, 10.0, 70.0, 10.0, 30.0, 30.0, 10.0, -20.0, 180.0, 30.0, 0.0, 10.0, 20.0, 20.0, 30.0, 0.0, 80.0, 10.0, 0.0, 0.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 50.0, 10.0, 250.0, 80.0, 20.0, 10.0, 260.0, 60.0, -5.0, 0.0, 30.0, 40.0, 0.0, 70.0, 10.0, 80.0, 10.0, 20.0, 40.0, 0.0, 20.0, 0.0, 40.0, 40.0, 0.0, 10.0, 70.0, 60.0, 90.0, 30.0, 20.0, 40.0, 20.0, -40.0, 10.0, 10.0, 0.0, 160.0, 0.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 20.0, 20.0, 10.0, 30.0, 70.0, 110.0, 300.0, 60.0, 60.0, 70.0, 80.0, 590.0, 10.0, 60.0, 0.0, 30.0, 70.0, 0.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 50.0, 20.0, 250.0, 20.0, 20.0, 0.0, 30.0, 40.0, 30.0, 40.0, 10.0, 20.0, 10.0, 310.0, 30.0, 30.0, 0.0, 50.0, 60.0, 50.0, 60.0, 40.0, 180.0, 0.0, 30.0, 20.0, 290.0, 5.0, 270.0, 20.0, 20.0, 150.0, 60.0, 50.0, 90.0, 300.0, 370.0, 50.0, 0.0, -20.0, 10.0, 20.0, 0.0, 70.0, 0.0, 30.0, 10.0, 10.0, 80.0, 0.0, 40.0, 20.0, 0.0, 10.0, 20.0, 50.0, 0.0, 170.0, 10.0, 230.0, 10.0, 190.0, 170.0, 30.0, 40.0, 120.0, 20.0, 100.0, 10.0, 0.0, 0.0, 20.0, 30.0, 50.0, 0.0, 150.0, 60.0, 260.0, -5.0, 260.0, 30.0, 180.0, 20.0, 0.0, 60.0, 30.0, 30.0, 70.0, 300.0, 20.0, 70.0, 0.0, 40.0, 80.0, 110.0, 20.0, 60.0, 50.0, 30.0, 10.0, -20.0, 360.0, 50.0, 0.0, 30.0, 180.0, 10.0, 20.0, 20.0, 30.0, 30.0, 40.0, 80.0, 10.0, 40.0, 10.0, 30.0, 10.0, 10.0, 0.0, 10.0, 60.0, 170.0, 20.0, 0.0, 10.0, 20.0, 10.0, 280.0, 60.0, 30.0, 30.0, 20.0, 10.0, 20.0, 40.0, 220.0, 0.0, 50.0, 60.0, 200.0, 70.0, 70.0, 40.0, 40.0, 0.0, 20.0, 40.0, 460.0, 145.0, 100.0, 10.0, -45.0, 30.0, 70.0, 70.0, 10.0, 10.0, 50.0, 60.0, 70.0, 0.0, 150.0, 90.0, 720.0, 90.0, 30.0, 20.0, 0.0, 0.0, 10.0, 40.0, 40.0, 20.0, 30.0, 30.0, 190.0, 0.0, 30.0, 10.0, 360.0, 350.0, 40.0, 20.0, 10.0, 10.0, 10.0, 180.0, 10.0, 20.0, 0.0, 70.0, 30.0, -5.0, 30.0, 40.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 40.0, 0.0, 40.0, 10.0, 120.0, 50.0, 50.0, 40.0, 170.0, 110.0, 10.0, 190.0, 20.0, 170.0, 120.0, 80.0, 30.0, 0.0, -5.0, 20.0, 30.0, 20.0, 0.0, 0.0, 30.0, 30.0, 10.0, 20.0, 50.0, 200.0, 60.0, 10.0, 140.0, 40.0, 10.0, 10.0, 0.0, 20.0, 10.0, 40.0, 10.0, 550.0, -10.0, 30.0, -550.0, 350.0, 100.0, 40.0, 40.0, 40.0, 30.0, 20.0, 300.0, 300.0, 10.0, 90.0, 20.0, 160.0, 60.0, 20.0, 30.0, 20.0, 40.0, 10.0, 20.0, 30.0, 210.0, 170.0, 50.0, 40.0, 90.0, 30.0, 170.0, 50.0, 40.0, 30.0, 60.0, 0.0, 10.0, 40.0, 35.0, 30.0, 40.0, 25.0, 20.0, 20.0, 10.0, 30.0, 10.0, 0.0, 10.0, 190.0, 0.0, 150.0, 20.0, 670.0, 60.0, 200.0, 70.0, -10.0, 20.0, 30.0, 80.0, 0.0, 190.0, 30.0, 120.0, 130.0, 30.0, 240.0, 20.0, 50.0, 50.0, 70.0, 170.0, -10.0, 10.0, 20.0, 40.0, 30.0, 150.0, 0.0, 70.0, 40.0, 190.0, 180.0, 90.0, 100.0, 0.0, 20.0, 200.0, 190.0, 70.0, -20.0, 40.0, 10.0, 50.0, 330.0, 650.0, 90.0, 110.0, 160.0, 80.0, -30.0, 30.0, -10.0, 20.0, 390.0, 20.0, 20.0, 30.0, 90.0, 80.0, 0.0, 170.0, 40.0, 60.0, 70.0, 10.0, 80.0, 30.0, 10.0, 130.0, 20.0, 20.0, 60.0, 250.0, 110.0, 30.0, 60.0, 0.0, 20.0, 30.0, 60.0, 20.0, 40.0, 40.0, 30.0, 110.0, 40.0, 30.0, 10.0, 10.0, 60.0, 0.0, 60.0, 130.0, 0.0, 30.0, 0.0, 100.0, 40.0, 50.0, 30.0, 10.0, 30.0, 0.0, 30.0, 0.0, 10.0, 40.0, 30.0, 160.0, 0.0, 30.0, 70.0, 10.0, 270.0, 25.0, 0.0, 0.0, 20.0, 0.0, 50.0, 20.0, 30.0, 10.0, 40.0, 120.0, 40.0, 190.0, 0.0, 30.0, 40.0, 0.0, 25.0, 10.0, 260.0, 0.0, 40.0, 20.0, 70.0, 100.0, 40.0, 60.0, 160.0, 100.0, 60.0, 250.0, 30.0, 30.0, 150.0, 40.0, 35.0, 40.0, 190.0, 90.0, 70.0, 570.0, 190.0, 130.0, 30.0, 120.0, 20.0, 20.0, 150.0, 150.0, 10.0, 0.0, 0.0, 25.0, 50.0, 210.0, 20.0, 0.0, 40.0, 210.0, 40.0, 20.0, 30.0, 40.0, 30.0, 20.0, 40.0, 50.0, 0.0, 70.0, -30.0, 20.0, 20.0, 30.0, 110.0, 400.0, -50.0, 20.0, 180.0, 0.0, 40.0, 40.0, 25.0, 190.0, 40.0, 30.0, -25.0, 0.0, 30.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 80.0, 30.0, 30.0, 60.0, 40.0, 0.0, 40.0, 20.0, 10.0, 70.0, 70.0, 0.0, 40.0, 60.0, 180.0, 50.0, 20.0, 30.0, 40.0, 170.0, 20.0, 20.0, 0.0, 70.0, 120.0, 180.0, 40.0, 80.0, 45.0, 180.0, 30.0, 30.0, 50.0, 10.0, 120.0, 30.0, 90.0, 80.0, 540.0, 40.0, 30.0, 140.0, 0.0, 30.0, 40.0, 70.0, 20.0, 140.0, 0.0, 30.0, 0.0, 20.0, 270.0, 30.0, 80.0, 30.0, 10.0, -15.0, -10.0, 0.0, 40.0, 30.0, 0.0, 50.0, 20.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 40.0, 150.0, 0.0, 20.0, 0.0, 10.0, 20.0, 40.0, 90.0, 20.0, 40.0, 20.0, 80.0, 130.0, 10.0, 40.0, 220.0, 30.0, 10.0, 180.0, 40.0, 60.0, 20.0, 0.0, 0.0, 180.0, 30.0, 0.0, 0.0, 80.0, 90.0, 20.0, 10.0, 30.0, 20.0, 10.0, 0.0, 150.0, 0.0, 30.0, 255.0, 70.0, 60.0, -40.0, -50.0, 400.0, 30.0, 380.0, 0.0, -30.0, 20.0, 240.0, 150.0, 160.0, 40.0, 10.0, 20.0, 10.0, 30.0, 230.0, 160.0, 20.0, 30.0, 60.0, 50.0, 160.0, 0.0, 80.0, 20.0, 0.0, 20.0, 790.0, 10.0, 45.0, 290.0, -20.0, 0.0, 140.0, -30.0, 0.0, 150.0, 30.0, 0.0, 50.0, 0.0, 20.0, 0.0, 10.0, 10.0, 60.0, 30.0, 10.0, 0.0, 60.0, 20.0, 30.0, 190.0, -25.0, 10.0, 50.0, 30.0, 5.0, 5.0, 150.0, 90.0, 70.0, 0.0, 30.0, 230.0, 60.0, 20.0, 40.0, 20.0, 380.0, 160.0, 50.0, 10.0, 25.0, 50.0, 180.0, 40.0, 30.0, 30.0, 10.0, 10.0, 20.0, 10.0, 80.0, 20.0, 40.0, 30.0, 60.0, 170.0, 70.0, 40.0, 40.0, 10.0, 10.0, 40.0, 40.0, 0.0, 40.0, 20.0, 20.0, 70.0, 30.0, 30.0, 10.0, 0.0, 0.0, 370.0, -5.0, -85.0, 90.0, -50.0, 40.0, 40.0, 0.0, 480.0, -30.0, 70.0, 40.0, 30.0, 20.0, 190.0, 150.0, 40.0, 40.0, 60.0, 20.0, 260.0, 20.0, 90.0, 0.0, 0.0, 50.0, -15.0, 20.0, -10.0, 30.0, -40.0, 0.0, 170.0, 10.0, 0.0, 280.0, -90.0, 160.0, 20.0, 5.0, 10.0, 160.0, 70.0, 690.0, 0.0, 30.0, 30.0, 20.0, 20.0, 40.0, 0.0, 20.0, 20.0, 40.0, 40.0, 0.0, 40.0, 30.0, 200.0, 150.0, 50.0, 10.0, 50.0, 30.0, 50.0, 30.0, 40.0, 30.0, 180.0, 20.0, 40.0, 60.0, 20.0, 80.0, -40.0, 1010.0, 20.0, 30.0, 10.0, 20.0, 20.0, 180.0, 20.0, 70.0, 0.0, 50.0, -10.0, -25.0, 10.0, 360.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.5020937330087463, "mean_inference_ms": 1.705603903983744, "mean_action_processing_ms": 0.43960931145701687, "mean_env_wait_ms": 1.3684802649978156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05668759346008301, "StateBufferConnector_ms": 0.009509563446044922, "ViewRequirementAgentConnector_ms": 0.3758432865142822}, "num_episodes": 18, "episode_return_max": 1490.0, "episode_return_min": 140.0, "episode_return_mean": 610.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.36705785421952, "num_env_steps_trained_throughput_per_sec": 36.36705785421952, "timesteps_total": 260000, "num_env_steps_sampled_lifetime": 260000, "num_agent_steps_sampled_lifetime": 2600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2600000, "timers": {"training_iteration_time_ms": 110269.123, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110269.075, "sample_time_ms": 2406.824, "learn_time_ms": 107842.909, "learn_throughput": 37.091, "synch_weights_time_ms": 11.036}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 2600000, "num_agent_steps_trained": 2600000}, "done": false, "training_iteration": 65, "trial_id": "57140_00000", "date": "2024-06-27_01-19-21", "timestamp": 1719465561, "time_this_iter_s": 110.00401782989502, "time_total_s": 7487.80473279953, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b1947a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7487.80473279953, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 15.454193548387094, "ram_util_percent": 78.38129032258065}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.330647158343444, "cur_kl_coeff": 0.1, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004969402142310429, "vf_loss": 4.729188371593325, "vf_explained_var": 0.0011619034666603746, "kl": Infinity, "entropy": 0.45959268611587023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 615045.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "env_runners": {"episode_reward_max": 1490.0, "episode_reward_min": 30.0, "episode_reward_mean": 630.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -550.0}, "policy_reward_max": {"policy_0": 1010.0}, "policy_reward_mean": {"policy_0": 63.02}, "custom_metrics": {}, "hist_stats": {"episode_reward": [530.0, 240.0, 970.0, 380.0, 895.0, 740.0, 750.0, 290.0, 320.0, 520.0, 750.0, 900.0, 1250.0, 220.0, 1020.0, 385.0, 150.0, 930.0, 295.0, 590.0, 670.0, 670.0, 460.0, 860.0, 310.0, 440.0, 1140.0, 930.0, 520.0, 1020.0, 1490.0, 670.0, 620.0, 640.0, 390.0, 440.0, 310.0, 475.0, 520.0, 565.0, 915.0, 1450.0, 635.0, 470.0, 620.0, 540.0, 180.0, 340.0, 630.0, 775.0, 1130.0, 350.0, 465.0, 140.0, 390.0, 760.0, 410.0, 360.0, 1075.0, 910.0, 580.0, 1245.0, 330.0, 375.0, 670.0, 935.0, 290.0, 510.0, 220.0, 850.0, 660.0, 445.0, 515.0, 1070.0, 540.0, 490.0, 1250.0, 675.0, 110.0, 1380.0, 270.0, 30.0, 810.0, 1115.0, 1110.0, 270.0, 880.0, 435.0, 550.0, 585.0, 240.0, 910.0, 360.0, 980.0, 610.0, 400.0, 500.0, 845.0, 570.0, 600.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [370.0, 50.0, 0.0, -20.0, 10.0, 20.0, 0.0, 70.0, 0.0, 30.0, 10.0, 10.0, 80.0, 0.0, 40.0, 20.0, 0.0, 10.0, 20.0, 50.0, 0.0, 170.0, 10.0, 230.0, 10.0, 190.0, 170.0, 30.0, 40.0, 120.0, 20.0, 100.0, 10.0, 0.0, 0.0, 20.0, 30.0, 50.0, 0.0, 150.0, 60.0, 260.0, -5.0, 260.0, 30.0, 180.0, 20.0, 0.0, 60.0, 30.0, 30.0, 70.0, 300.0, 20.0, 70.0, 0.0, 40.0, 80.0, 110.0, 20.0, 60.0, 50.0, 30.0, 10.0, -20.0, 360.0, 50.0, 0.0, 30.0, 180.0, 10.0, 20.0, 20.0, 30.0, 30.0, 40.0, 80.0, 10.0, 40.0, 10.0, 30.0, 10.0, 10.0, 0.0, 10.0, 60.0, 170.0, 20.0, 0.0, 10.0, 20.0, 10.0, 280.0, 60.0, 30.0, 30.0, 20.0, 10.0, 20.0, 40.0, 220.0, 0.0, 50.0, 60.0, 200.0, 70.0, 70.0, 40.0, 40.0, 0.0, 20.0, 40.0, 460.0, 145.0, 100.0, 10.0, -45.0, 30.0, 70.0, 70.0, 10.0, 10.0, 50.0, 60.0, 70.0, 0.0, 150.0, 90.0, 720.0, 90.0, 30.0, 20.0, 0.0, 0.0, 10.0, 40.0, 40.0, 20.0, 30.0, 30.0, 190.0, 0.0, 30.0, 10.0, 360.0, 350.0, 40.0, 20.0, 10.0, 10.0, 10.0, 180.0, 10.0, 20.0, 0.0, 70.0, 30.0, -5.0, 30.0, 40.0, 0.0, 0.0, 60.0, 0.0, 0.0, 0.0, 40.0, 0.0, 40.0, 10.0, 120.0, 50.0, 50.0, 40.0, 170.0, 110.0, 10.0, 190.0, 20.0, 170.0, 120.0, 80.0, 30.0, 0.0, -5.0, 20.0, 30.0, 20.0, 0.0, 0.0, 30.0, 30.0, 10.0, 20.0, 50.0, 200.0, 60.0, 10.0, 140.0, 40.0, 10.0, 10.0, 0.0, 20.0, 10.0, 40.0, 10.0, 550.0, -10.0, 30.0, -550.0, 350.0, 100.0, 40.0, 40.0, 40.0, 30.0, 20.0, 300.0, 300.0, 10.0, 90.0, 20.0, 160.0, 60.0, 20.0, 30.0, 20.0, 40.0, 10.0, 20.0, 30.0, 210.0, 170.0, 50.0, 40.0, 90.0, 30.0, 170.0, 50.0, 40.0, 30.0, 60.0, 0.0, 10.0, 40.0, 35.0, 30.0, 40.0, 25.0, 20.0, 20.0, 10.0, 30.0, 10.0, 0.0, 10.0, 190.0, 0.0, 150.0, 20.0, 670.0, 60.0, 200.0, 70.0, -10.0, 20.0, 30.0, 80.0, 0.0, 190.0, 30.0, 120.0, 130.0, 30.0, 240.0, 20.0, 50.0, 50.0, 70.0, 170.0, -10.0, 10.0, 20.0, 40.0, 30.0, 150.0, 0.0, 70.0, 40.0, 190.0, 180.0, 90.0, 100.0, 0.0, 20.0, 200.0, 190.0, 70.0, -20.0, 40.0, 10.0, 50.0, 330.0, 650.0, 90.0, 110.0, 160.0, 80.0, -30.0, 30.0, -10.0, 20.0, 390.0, 20.0, 20.0, 30.0, 90.0, 80.0, 0.0, 170.0, 40.0, 60.0, 70.0, 10.0, 80.0, 30.0, 10.0, 130.0, 20.0, 20.0, 60.0, 250.0, 110.0, 30.0, 60.0, 0.0, 20.0, 30.0, 60.0, 20.0, 40.0, 40.0, 30.0, 110.0, 40.0, 30.0, 10.0, 10.0, 60.0, 0.0, 60.0, 130.0, 0.0, 30.0, 0.0, 100.0, 40.0, 50.0, 30.0, 10.0, 30.0, 0.0, 30.0, 0.0, 10.0, 40.0, 30.0, 160.0, 0.0, 30.0, 70.0, 10.0, 270.0, 25.0, 0.0, 0.0, 20.0, 0.0, 50.0, 20.0, 30.0, 10.0, 40.0, 120.0, 40.0, 190.0, 0.0, 30.0, 40.0, 0.0, 25.0, 10.0, 260.0, 0.0, 40.0, 20.0, 70.0, 100.0, 40.0, 60.0, 160.0, 100.0, 60.0, 250.0, 30.0, 30.0, 150.0, 40.0, 35.0, 40.0, 190.0, 90.0, 70.0, 570.0, 190.0, 130.0, 30.0, 120.0, 20.0, 20.0, 150.0, 150.0, 10.0, 0.0, 0.0, 25.0, 50.0, 210.0, 20.0, 0.0, 40.0, 210.0, 40.0, 20.0, 30.0, 40.0, 30.0, 20.0, 40.0, 50.0, 0.0, 70.0, -30.0, 20.0, 20.0, 30.0, 110.0, 400.0, -50.0, 20.0, 180.0, 0.0, 40.0, 40.0, 25.0, 190.0, 40.0, 30.0, -25.0, 0.0, 30.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 80.0, 30.0, 30.0, 60.0, 40.0, 0.0, 40.0, 20.0, 10.0, 70.0, 70.0, 0.0, 40.0, 60.0, 180.0, 50.0, 20.0, 30.0, 40.0, 170.0, 20.0, 20.0, 0.0, 70.0, 120.0, 180.0, 40.0, 80.0, 45.0, 180.0, 30.0, 30.0, 50.0, 10.0, 120.0, 30.0, 90.0, 80.0, 540.0, 40.0, 30.0, 140.0, 0.0, 30.0, 40.0, 70.0, 20.0, 140.0, 0.0, 30.0, 0.0, 20.0, 270.0, 30.0, 80.0, 30.0, 10.0, -15.0, -10.0, 0.0, 40.0, 30.0, 0.0, 50.0, 20.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 40.0, 150.0, 0.0, 20.0, 0.0, 10.0, 20.0, 40.0, 90.0, 20.0, 40.0, 20.0, 80.0, 130.0, 10.0, 40.0, 220.0, 30.0, 10.0, 180.0, 40.0, 60.0, 20.0, 0.0, 0.0, 180.0, 30.0, 0.0, 0.0, 80.0, 90.0, 20.0, 10.0, 30.0, 20.0, 10.0, 0.0, 150.0, 0.0, 30.0, 255.0, 70.0, 60.0, -40.0, -50.0, 400.0, 30.0, 380.0, 0.0, -30.0, 20.0, 240.0, 150.0, 160.0, 40.0, 10.0, 20.0, 10.0, 30.0, 230.0, 160.0, 20.0, 30.0, 60.0, 50.0, 160.0, 0.0, 80.0, 20.0, 0.0, 20.0, 790.0, 10.0, 45.0, 290.0, -20.0, 0.0, 140.0, -30.0, 0.0, 150.0, 30.0, 0.0, 50.0, 0.0, 20.0, 0.0, 10.0, 10.0, 60.0, 30.0, 10.0, 0.0, 60.0, 20.0, 30.0, 190.0, -25.0, 10.0, 50.0, 30.0, 5.0, 5.0, 150.0, 90.0, 70.0, 0.0, 30.0, 230.0, 60.0, 20.0, 40.0, 20.0, 380.0, 160.0, 50.0, 10.0, 25.0, 50.0, 180.0, 40.0, 30.0, 30.0, 10.0, 10.0, 20.0, 10.0, 80.0, 20.0, 40.0, 30.0, 60.0, 170.0, 70.0, 40.0, 40.0, 10.0, 10.0, 40.0, 40.0, 0.0, 40.0, 20.0, 20.0, 70.0, 30.0, 30.0, 10.0, 0.0, 0.0, 370.0, -5.0, -85.0, 90.0, -50.0, 40.0, 40.0, 0.0, 480.0, -30.0, 70.0, 40.0, 30.0, 20.0, 190.0, 150.0, 40.0, 40.0, 60.0, 20.0, 260.0, 20.0, 90.0, 0.0, 0.0, 50.0, -15.0, 20.0, -10.0, 30.0, -40.0, 0.0, 170.0, 10.0, 0.0, 280.0, -90.0, 160.0, 20.0, 5.0, 10.0, 160.0, 70.0, 690.0, 0.0, 30.0, 30.0, 20.0, 20.0, 40.0, 0.0, 20.0, 20.0, 40.0, 40.0, 0.0, 40.0, 30.0, 200.0, 150.0, 50.0, 10.0, 50.0, 30.0, 50.0, 30.0, 40.0, 30.0, 180.0, 20.0, 40.0, 60.0, 20.0, 80.0, -40.0, 1010.0, 20.0, 30.0, 10.0, 20.0, 20.0, 180.0, 20.0, 70.0, 0.0, 50.0, -10.0, -25.0, 10.0, 360.0, 10.0, 0.0, 30.0, 10.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 290.0, 0.0, 50.0, 10.0, 10.0, 100.0, 200.0, 10.0, 0.0, 710.0, 30.0, 0.0, 150.0, 40.0, -30.0, 0.0, 0.0, 0.0, 50.0, 30.0, 30.0, 0.0, 30.0, 10.0, 30.0, -140.0, 0.0, 10.0, 60.0, 0.0, 40.0, 0.0, 40.0, 400.0, 50.0, 100.0, 40.0, 80.0, 30.0, 30.0, 80.0, -50.0, 10.0, 40.0, 570.0, -65.0, 190.0, 160.0, 20.0, 160.0, 10.0, 100.0, 110.0, 660.0, 10.0, 10.0, 10.0, 170.0, 20.0, 10.0, 20.0, 20.0, 0.0, 10.0, 10.0, -10.0, 10.0, 190.0, 20.0, 0.0, 50.0, 0.0, 30.0, 0.0, 70.0, 20.0, 20.0, 40.0, 660.0, -10.0, 70.0, 50.0, 160.0, 20.0, 30.0, 25.0, 0.0, 30.0, 20.0, 30.0, 160.0, 10.0, 0.0, 0.0, 40.0, 0.0, 0.0, 240.0, 80.0, 20.0, 160.0, 50.0, 280.0, 25.0, 10.0, 30.0, 0.0, 0.0, 10.0, 20.0, 0.0, 30.0, 0.0, 20.0, 20.0, 70.0, 30.0, 20.0, 30.0, 20.0, 10.0, 360.0, 20.0, 30.0, 40.0, 110.0, 260.0, -40.0, 80.0, 40.0, 70.0, 0.0, 0.0, 40.0, 100.0, 40.0, 80.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 160.0, 0.0, 550.0, 10.0, 0.0, 120.0, 80.0, 170.0, 60.0, 50.0, 30.0, 70.0, 40.0, 70.0, 20.0, 60.0, 40.0, 30.0, 40.0, 50.0, 170.0, 40.0, 20.0, 20.0, 0.0, 30.0, 0.0, 110.0, 0.0, 30.0, 50.0, 0.0, 270.0, 30.0, 10.0, 0.0, 0.0, 210.0, 30.0, -45.0, 60.0, 280.0, 60.0, 180.0, 40.0, 20.0, 10.0, 20.0, 20.0, 10.0, 30.0, 10.0, 90.0, 150.0, 0.0, 40.0, 200.0, 30.0, 550.0, -10.0, 20.0, 30.0, -50.0, 0.0, 0.0, 30.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4991209838418944, "mean_inference_ms": 1.7022992843452096, "mean_action_processing_ms": 0.4386393546326036, "mean_env_wait_ms": 1.3659827891570182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05878853797912598, "StateBufferConnector_ms": 0.009429931640625, "ViewRequirementAgentConnector_ms": 0.3768782615661621}, "num_episodes": 22, "episode_return_max": 1490.0, "episode_return_min": 30.0, "episode_return_mean": 630.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.29382344880666, "num_env_steps_trained_throughput_per_sec": 36.29382344880666, "timesteps_total": 264000, "num_env_steps_sampled_lifetime": 264000, "num_agent_steps_sampled_lifetime": 2640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2640000, "timers": {"training_iteration_time_ms": 110245.095, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110245.047, "sample_time_ms": 2404.013, "learn_time_ms": 107821.364, "learn_throughput": 37.098, "synch_weights_time_ms": 11.101}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 2640000, "num_agent_steps_trained": 2640000}, "done": false, "training_iteration": 66, "trial_id": "57140_00000", "date": "2024-06-27_01-21-12", "timestamp": 1719465672, "time_this_iter_s": 110.22293782234192, "time_total_s": 7598.027670621872, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18ccf70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7598.027670621872, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 15.645512820512819, "ram_util_percent": 78.39038461538462}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9397745458208842, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.527297972972654, "policy_loss": -0.005064059042940125, "vf_loss": 4.531452703704469, "vf_explained_var": 0.0017550540871767444, "kl": 0.006062174411602384, "entropy": 0.4874272008546498, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 624435.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000}, "env_runners": {"episode_reward_max": 1490.0, "episode_reward_min": 30.0, "episode_reward_mean": 631.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 1010.0}, "policy_reward_mean": {"policy_0": 63.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [860.0, 310.0, 440.0, 1140.0, 930.0, 520.0, 1020.0, 1490.0, 670.0, 620.0, 640.0, 390.0, 440.0, 310.0, 475.0, 520.0, 565.0, 915.0, 1450.0, 635.0, 470.0, 620.0, 540.0, 180.0, 340.0, 630.0, 775.0, 1130.0, 350.0, 465.0, 140.0, 390.0, 760.0, 410.0, 360.0, 1075.0, 910.0, 580.0, 1245.0, 330.0, 375.0, 670.0, 935.0, 290.0, 510.0, 220.0, 850.0, 660.0, 445.0, 515.0, 1070.0, 540.0, 490.0, 1250.0, 675.0, 110.0, 1380.0, 270.0, 30.0, 810.0, 1115.0, 1110.0, 270.0, 880.0, 435.0, 550.0, 585.0, 240.0, 910.0, 360.0, 980.0, 610.0, 400.0, 500.0, 845.0, 570.0, 600.0, 320.0, 620.0, 355.0, 1100.0, 1195.0, 440.0, 160.0, 210.0, 1180.0, 330.0, 250.0, 290.0, 590.0, 310.0, 645.0, 1010.0, 960.0, 610.0, 710.0, 320.0, 565.0, 1020.0, 815.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 30.0, 210.0, 170.0, 50.0, 40.0, 90.0, 30.0, 170.0, 50.0, 40.0, 30.0, 60.0, 0.0, 10.0, 40.0, 35.0, 30.0, 40.0, 25.0, 20.0, 20.0, 10.0, 30.0, 10.0, 0.0, 10.0, 190.0, 0.0, 150.0, 20.0, 670.0, 60.0, 200.0, 70.0, -10.0, 20.0, 30.0, 80.0, 0.0, 190.0, 30.0, 120.0, 130.0, 30.0, 240.0, 20.0, 50.0, 50.0, 70.0, 170.0, -10.0, 10.0, 20.0, 40.0, 30.0, 150.0, 0.0, 70.0, 40.0, 190.0, 180.0, 90.0, 100.0, 0.0, 20.0, 200.0, 190.0, 70.0, -20.0, 40.0, 10.0, 50.0, 330.0, 650.0, 90.0, 110.0, 160.0, 80.0, -30.0, 30.0, -10.0, 20.0, 390.0, 20.0, 20.0, 30.0, 90.0, 80.0, 0.0, 170.0, 40.0, 60.0, 70.0, 10.0, 80.0, 30.0, 10.0, 130.0, 20.0, 20.0, 60.0, 250.0, 110.0, 30.0, 60.0, 0.0, 20.0, 30.0, 60.0, 20.0, 40.0, 40.0, 30.0, 110.0, 40.0, 30.0, 10.0, 10.0, 60.0, 0.0, 60.0, 130.0, 0.0, 30.0, 0.0, 100.0, 40.0, 50.0, 30.0, 10.0, 30.0, 0.0, 30.0, 0.0, 10.0, 40.0, 30.0, 160.0, 0.0, 30.0, 70.0, 10.0, 270.0, 25.0, 0.0, 0.0, 20.0, 0.0, 50.0, 20.0, 30.0, 10.0, 40.0, 120.0, 40.0, 190.0, 0.0, 30.0, 40.0, 0.0, 25.0, 10.0, 260.0, 0.0, 40.0, 20.0, 70.0, 100.0, 40.0, 60.0, 160.0, 100.0, 60.0, 250.0, 30.0, 30.0, 150.0, 40.0, 35.0, 40.0, 190.0, 90.0, 70.0, 570.0, 190.0, 130.0, 30.0, 120.0, 20.0, 20.0, 150.0, 150.0, 10.0, 0.0, 0.0, 25.0, 50.0, 210.0, 20.0, 0.0, 40.0, 210.0, 40.0, 20.0, 30.0, 40.0, 30.0, 20.0, 40.0, 50.0, 0.0, 70.0, -30.0, 20.0, 20.0, 30.0, 110.0, 400.0, -50.0, 20.0, 180.0, 0.0, 40.0, 40.0, 25.0, 190.0, 40.0, 30.0, -25.0, 0.0, 30.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 80.0, 30.0, 30.0, 60.0, 40.0, 0.0, 40.0, 20.0, 10.0, 70.0, 70.0, 0.0, 40.0, 60.0, 180.0, 50.0, 20.0, 30.0, 40.0, 170.0, 20.0, 20.0, 0.0, 70.0, 120.0, 180.0, 40.0, 80.0, 45.0, 180.0, 30.0, 30.0, 50.0, 10.0, 120.0, 30.0, 90.0, 80.0, 540.0, 40.0, 30.0, 140.0, 0.0, 30.0, 40.0, 70.0, 20.0, 140.0, 0.0, 30.0, 0.0, 20.0, 270.0, 30.0, 80.0, 30.0, 10.0, -15.0, -10.0, 0.0, 40.0, 30.0, 0.0, 50.0, 20.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 40.0, 150.0, 0.0, 20.0, 0.0, 10.0, 20.0, 40.0, 90.0, 20.0, 40.0, 20.0, 80.0, 130.0, 10.0, 40.0, 220.0, 30.0, 10.0, 180.0, 40.0, 60.0, 20.0, 0.0, 0.0, 180.0, 30.0, 0.0, 0.0, 80.0, 90.0, 20.0, 10.0, 30.0, 20.0, 10.0, 0.0, 150.0, 0.0, 30.0, 255.0, 70.0, 60.0, -40.0, -50.0, 400.0, 30.0, 380.0, 0.0, -30.0, 20.0, 240.0, 150.0, 160.0, 40.0, 10.0, 20.0, 10.0, 30.0, 230.0, 160.0, 20.0, 30.0, 60.0, 50.0, 160.0, 0.0, 80.0, 20.0, 0.0, 20.0, 790.0, 10.0, 45.0, 290.0, -20.0, 0.0, 140.0, -30.0, 0.0, 150.0, 30.0, 0.0, 50.0, 0.0, 20.0, 0.0, 10.0, 10.0, 60.0, 30.0, 10.0, 0.0, 60.0, 20.0, 30.0, 190.0, -25.0, 10.0, 50.0, 30.0, 5.0, 5.0, 150.0, 90.0, 70.0, 0.0, 30.0, 230.0, 60.0, 20.0, 40.0, 20.0, 380.0, 160.0, 50.0, 10.0, 25.0, 50.0, 180.0, 40.0, 30.0, 30.0, 10.0, 10.0, 20.0, 10.0, 80.0, 20.0, 40.0, 30.0, 60.0, 170.0, 70.0, 40.0, 40.0, 10.0, 10.0, 40.0, 40.0, 0.0, 40.0, 20.0, 20.0, 70.0, 30.0, 30.0, 10.0, 0.0, 0.0, 370.0, -5.0, -85.0, 90.0, -50.0, 40.0, 40.0, 0.0, 480.0, -30.0, 70.0, 40.0, 30.0, 20.0, 190.0, 150.0, 40.0, 40.0, 60.0, 20.0, 260.0, 20.0, 90.0, 0.0, 0.0, 50.0, -15.0, 20.0, -10.0, 30.0, -40.0, 0.0, 170.0, 10.0, 0.0, 280.0, -90.0, 160.0, 20.0, 5.0, 10.0, 160.0, 70.0, 690.0, 0.0, 30.0, 30.0, 20.0, 20.0, 40.0, 0.0, 20.0, 20.0, 40.0, 40.0, 0.0, 40.0, 30.0, 200.0, 150.0, 50.0, 10.0, 50.0, 30.0, 50.0, 30.0, 40.0, 30.0, 180.0, 20.0, 40.0, 60.0, 20.0, 80.0, -40.0, 1010.0, 20.0, 30.0, 10.0, 20.0, 20.0, 180.0, 20.0, 70.0, 0.0, 50.0, -10.0, -25.0, 10.0, 360.0, 10.0, 0.0, 30.0, 10.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 290.0, 0.0, 50.0, 10.0, 10.0, 100.0, 200.0, 10.0, 0.0, 710.0, 30.0, 0.0, 150.0, 40.0, -30.0, 0.0, 0.0, 0.0, 50.0, 30.0, 30.0, 0.0, 30.0, 10.0, 30.0, -140.0, 0.0, 10.0, 60.0, 0.0, 40.0, 0.0, 40.0, 400.0, 50.0, 100.0, 40.0, 80.0, 30.0, 30.0, 80.0, -50.0, 10.0, 40.0, 570.0, -65.0, 190.0, 160.0, 20.0, 160.0, 10.0, 100.0, 110.0, 660.0, 10.0, 10.0, 10.0, 170.0, 20.0, 10.0, 20.0, 20.0, 0.0, 10.0, 10.0, -10.0, 10.0, 190.0, 20.0, 0.0, 50.0, 0.0, 30.0, 0.0, 70.0, 20.0, 20.0, 40.0, 660.0, -10.0, 70.0, 50.0, 160.0, 20.0, 30.0, 25.0, 0.0, 30.0, 20.0, 30.0, 160.0, 10.0, 0.0, 0.0, 40.0, 0.0, 0.0, 240.0, 80.0, 20.0, 160.0, 50.0, 280.0, 25.0, 10.0, 30.0, 0.0, 0.0, 10.0, 20.0, 0.0, 30.0, 0.0, 20.0, 20.0, 70.0, 30.0, 20.0, 30.0, 20.0, 10.0, 360.0, 20.0, 30.0, 40.0, 110.0, 260.0, -40.0, 80.0, 40.0, 70.0, 0.0, 0.0, 40.0, 100.0, 40.0, 80.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 160.0, 0.0, 550.0, 10.0, 0.0, 120.0, 80.0, 170.0, 60.0, 50.0, 30.0, 70.0, 40.0, 70.0, 20.0, 60.0, 40.0, 30.0, 40.0, 50.0, 170.0, 40.0, 20.0, 20.0, 0.0, 30.0, 0.0, 110.0, 0.0, 30.0, 50.0, 0.0, 270.0, 30.0, 10.0, 0.0, 0.0, 210.0, 30.0, -45.0, 60.0, 280.0, 60.0, 180.0, 40.0, 20.0, 10.0, 20.0, 20.0, 10.0, 30.0, 10.0, 90.0, 150.0, 0.0, 40.0, 200.0, 30.0, 550.0, -10.0, 20.0, 30.0, -50.0, 0.0, 0.0, 30.0, 0.0, 20.0, 20.0, 160.0, 0.0, 20.0, 0.0, 20.0, 40.0, 0.0, 40.0, 10.0, 50.0, 40.0, 50.0, 10.0, 10.0, 20.0, 40.0, 360.0, 30.0, 0.0, 20.0, 30.0, 40.0, -5.0, 0.0, 10.0, 40.0, 40.0, 180.0, 20.0, 20.0, 10.0, 90.0, 210.0, 40.0, 40.0, 20.0, 500.0, 150.0, 80.0, 480.0, 0.0, 130.0, 180.0, 10.0, 100.0, 30.0, 190.0, -5.0, 40.0, 60.0, 20.0, 10.0, 10.0, 0.0, 0.0, 20.0, 260.0, 20.0, 10.0, 40.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 50.0, 0.0, 20.0, 60.0, 30.0, 10.0, 30.0, 20.0, 0.0, 40.0, 0.0, 40.0, 50.0, 90.0, 500.0, 280.0, 40.0, 20.0, -20.0, 150.0, 30.0, 0.0, 0.0, 0.0, 0.0, 270.0, 0.0, 0.0, -40.0, 20.0, 80.0, 20.0, 30.0, 30.0, 20.0, 10.0, 20.0, 20.0, 40.0, 20.0, 40.0, 30.0, 20.0, 20.0, 30.0, 90.0, 50.0, 0.0, 10.0, 30.0, 10.0, 10.0, 60.0, -80.0, 0.0, 0.0, 20.0, 0.0, 20.0, 570.0, -10.0, 0.0, 0.0, 10.0, 30.0, 60.0, 20.0, 40.0, 30.0, 60.0, 60.0, 50.0, 20.0, 20.0, 25.0, 40.0, 0.0, 260.0, 40.0, 180.0, 10.0, 40.0, -50.0, 60.0, 670.0, 10.0, 10.0, 10.0, 150.0, 70.0, 40.0, 30.0, 20.0, 10.0, 40.0, -30.0, -70.0, 60.0, 590.0, 80.0, 230.0, 0.0, 40.0, 40.0, 50.0, 40.0, 270.0, 40.0, 90.0, 20.0, 20.0, 30.0, 60.0, 70.0, 190.0, 70.0, 40.0, 20.0, 130.0, 60.0, 40.0, 10.0, 20.0, 170.0, 30.0, 20.0, 10.0, 0.0, 10.0, 10.0, 40.0, 40.0, -5.0, 380.0, 20.0, 0.0, 20.0, 40.0, 40.0, 10.0, 20.0, 70.0, 90.0, 80.0, 40.0, 60.0, 10.0, 360.0, 230.0, 20.0, 60.0, -10.0, 210.0, 100.0, 20.0, 150.0, 30.0, 180.0, -50.0, 45.0, 140.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.496501140955309, "mean_inference_ms": 1.6933105729405704, "mean_action_processing_ms": 0.43752001511815997, "mean_env_wait_ms": 1.3624978393103344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058617353439331055, "StateBufferConnector_ms": 0.009420633316040039, "ViewRequirementAgentConnector_ms": 0.3832066059112549}, "num_episodes": 23, "episode_return_max": 1490.0, "episode_return_min": 30.0, "episode_return_mean": 631.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.522680737915145, "num_env_steps_trained_throughput_per_sec": 36.522680737915145, "timesteps_total": 268000, "num_env_steps_sampled_lifetime": 268000, "num_agent_steps_sampled_lifetime": 2680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2680000, "timers": {"training_iteration_time_ms": 110209.54, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110209.493, "sample_time_ms": 2395.285, "learn_time_ms": 107794.674, "learn_throughput": 37.108, "synch_weights_time_ms": 11.022}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 2680000, "num_agent_steps_trained": 2680000}, "done": false, "training_iteration": 67, "trial_id": "57140_00000", "date": "2024-06-27_01-23-01", "timestamp": 1719465781, "time_this_iter_s": 109.53401279449463, "time_total_s": 7707.561683416367, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b1947790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7707.561683416367, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 15.374193548387098, "ram_util_percent": 79.34064516129031}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0065339467522945, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004479353956896038, "vf_loss": 4.212037861359894, "vf_explained_var": 0.0011134159133330194, "kl": Infinity, "entropy": 0.4760313934474961, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 633825.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "env_runners": {"episode_reward_max": 1450.0, "episode_reward_min": 30.0, "episode_reward_mean": 605.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 1010.0}, "policy_reward_mean": {"policy_0": 60.52}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1450.0, 635.0, 470.0, 620.0, 540.0, 180.0, 340.0, 630.0, 775.0, 1130.0, 350.0, 465.0, 140.0, 390.0, 760.0, 410.0, 360.0, 1075.0, 910.0, 580.0, 1245.0, 330.0, 375.0, 670.0, 935.0, 290.0, 510.0, 220.0, 850.0, 660.0, 445.0, 515.0, 1070.0, 540.0, 490.0, 1250.0, 675.0, 110.0, 1380.0, 270.0, 30.0, 810.0, 1115.0, 1110.0, 270.0, 880.0, 435.0, 550.0, 585.0, 240.0, 910.0, 360.0, 980.0, 610.0, 400.0, 500.0, 845.0, 570.0, 600.0, 320.0, 620.0, 355.0, 1100.0, 1195.0, 440.0, 160.0, 210.0, 1180.0, 330.0, 250.0, 290.0, 590.0, 310.0, 645.0, 1010.0, 960.0, 610.0, 710.0, 320.0, 565.0, 1020.0, 815.0, 400.0, 970.0, 830.0, 340.0, 490.0, 640.0, 590.0, 550.0, 350.0, 180.0, 625.0, 180.0, 160.0, 510.0, 1230.0, 1010.0, 200.0, 420.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 190.0, 90.0, 70.0, 570.0, 190.0, 130.0, 30.0, 120.0, 20.0, 20.0, 150.0, 150.0, 10.0, 0.0, 0.0, 25.0, 50.0, 210.0, 20.0, 0.0, 40.0, 210.0, 40.0, 20.0, 30.0, 40.0, 30.0, 20.0, 40.0, 50.0, 0.0, 70.0, -30.0, 20.0, 20.0, 30.0, 110.0, 400.0, -50.0, 20.0, 180.0, 0.0, 40.0, 40.0, 25.0, 190.0, 40.0, 30.0, -25.0, 0.0, 30.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 80.0, 30.0, 30.0, 60.0, 40.0, 0.0, 40.0, 20.0, 10.0, 70.0, 70.0, 0.0, 40.0, 60.0, 180.0, 50.0, 20.0, 30.0, 40.0, 170.0, 20.0, 20.0, 0.0, 70.0, 120.0, 180.0, 40.0, 80.0, 45.0, 180.0, 30.0, 30.0, 50.0, 10.0, 120.0, 30.0, 90.0, 80.0, 540.0, 40.0, 30.0, 140.0, 0.0, 30.0, 40.0, 70.0, 20.0, 140.0, 0.0, 30.0, 0.0, 20.0, 270.0, 30.0, 80.0, 30.0, 10.0, -15.0, -10.0, 0.0, 40.0, 30.0, 0.0, 50.0, 20.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 10.0, 40.0, 150.0, 0.0, 20.0, 0.0, 10.0, 20.0, 40.0, 90.0, 20.0, 40.0, 20.0, 80.0, 130.0, 10.0, 40.0, 220.0, 30.0, 10.0, 180.0, 40.0, 60.0, 20.0, 0.0, 0.0, 180.0, 30.0, 0.0, 0.0, 80.0, 90.0, 20.0, 10.0, 30.0, 20.0, 10.0, 0.0, 150.0, 0.0, 30.0, 255.0, 70.0, 60.0, -40.0, -50.0, 400.0, 30.0, 380.0, 0.0, -30.0, 20.0, 240.0, 150.0, 160.0, 40.0, 10.0, 20.0, 10.0, 30.0, 230.0, 160.0, 20.0, 30.0, 60.0, 50.0, 160.0, 0.0, 80.0, 20.0, 0.0, 20.0, 790.0, 10.0, 45.0, 290.0, -20.0, 0.0, 140.0, -30.0, 0.0, 150.0, 30.0, 0.0, 50.0, 0.0, 20.0, 0.0, 10.0, 10.0, 60.0, 30.0, 10.0, 0.0, 60.0, 20.0, 30.0, 190.0, -25.0, 10.0, 50.0, 30.0, 5.0, 5.0, 150.0, 90.0, 70.0, 0.0, 30.0, 230.0, 60.0, 20.0, 40.0, 20.0, 380.0, 160.0, 50.0, 10.0, 25.0, 50.0, 180.0, 40.0, 30.0, 30.0, 10.0, 10.0, 20.0, 10.0, 80.0, 20.0, 40.0, 30.0, 60.0, 170.0, 70.0, 40.0, 40.0, 10.0, 10.0, 40.0, 40.0, 0.0, 40.0, 20.0, 20.0, 70.0, 30.0, 30.0, 10.0, 0.0, 0.0, 370.0, -5.0, -85.0, 90.0, -50.0, 40.0, 40.0, 0.0, 480.0, -30.0, 70.0, 40.0, 30.0, 20.0, 190.0, 150.0, 40.0, 40.0, 60.0, 20.0, 260.0, 20.0, 90.0, 0.0, 0.0, 50.0, -15.0, 20.0, -10.0, 30.0, -40.0, 0.0, 170.0, 10.0, 0.0, 280.0, -90.0, 160.0, 20.0, 5.0, 10.0, 160.0, 70.0, 690.0, 0.0, 30.0, 30.0, 20.0, 20.0, 40.0, 0.0, 20.0, 20.0, 40.0, 40.0, 0.0, 40.0, 30.0, 200.0, 150.0, 50.0, 10.0, 50.0, 30.0, 50.0, 30.0, 40.0, 30.0, 180.0, 20.0, 40.0, 60.0, 20.0, 80.0, -40.0, 1010.0, 20.0, 30.0, 10.0, 20.0, 20.0, 180.0, 20.0, 70.0, 0.0, 50.0, -10.0, -25.0, 10.0, 360.0, 10.0, 0.0, 30.0, 10.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 290.0, 0.0, 50.0, 10.0, 10.0, 100.0, 200.0, 10.0, 0.0, 710.0, 30.0, 0.0, 150.0, 40.0, -30.0, 0.0, 0.0, 0.0, 50.0, 30.0, 30.0, 0.0, 30.0, 10.0, 30.0, -140.0, 0.0, 10.0, 60.0, 0.0, 40.0, 0.0, 40.0, 400.0, 50.0, 100.0, 40.0, 80.0, 30.0, 30.0, 80.0, -50.0, 10.0, 40.0, 570.0, -65.0, 190.0, 160.0, 20.0, 160.0, 10.0, 100.0, 110.0, 660.0, 10.0, 10.0, 10.0, 170.0, 20.0, 10.0, 20.0, 20.0, 0.0, 10.0, 10.0, -10.0, 10.0, 190.0, 20.0, 0.0, 50.0, 0.0, 30.0, 0.0, 70.0, 20.0, 20.0, 40.0, 660.0, -10.0, 70.0, 50.0, 160.0, 20.0, 30.0, 25.0, 0.0, 30.0, 20.0, 30.0, 160.0, 10.0, 0.0, 0.0, 40.0, 0.0, 0.0, 240.0, 80.0, 20.0, 160.0, 50.0, 280.0, 25.0, 10.0, 30.0, 0.0, 0.0, 10.0, 20.0, 0.0, 30.0, 0.0, 20.0, 20.0, 70.0, 30.0, 20.0, 30.0, 20.0, 10.0, 360.0, 20.0, 30.0, 40.0, 110.0, 260.0, -40.0, 80.0, 40.0, 70.0, 0.0, 0.0, 40.0, 100.0, 40.0, 80.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 160.0, 0.0, 550.0, 10.0, 0.0, 120.0, 80.0, 170.0, 60.0, 50.0, 30.0, 70.0, 40.0, 70.0, 20.0, 60.0, 40.0, 30.0, 40.0, 50.0, 170.0, 40.0, 20.0, 20.0, 0.0, 30.0, 0.0, 110.0, 0.0, 30.0, 50.0, 0.0, 270.0, 30.0, 10.0, 0.0, 0.0, 210.0, 30.0, -45.0, 60.0, 280.0, 60.0, 180.0, 40.0, 20.0, 10.0, 20.0, 20.0, 10.0, 30.0, 10.0, 90.0, 150.0, 0.0, 40.0, 200.0, 30.0, 550.0, -10.0, 20.0, 30.0, -50.0, 0.0, 0.0, 30.0, 0.0, 20.0, 20.0, 160.0, 0.0, 20.0, 0.0, 20.0, 40.0, 0.0, 40.0, 10.0, 50.0, 40.0, 50.0, 10.0, 10.0, 20.0, 40.0, 360.0, 30.0, 0.0, 20.0, 30.0, 40.0, -5.0, 0.0, 10.0, 40.0, 40.0, 180.0, 20.0, 20.0, 10.0, 90.0, 210.0, 40.0, 40.0, 20.0, 500.0, 150.0, 80.0, 480.0, 0.0, 130.0, 180.0, 10.0, 100.0, 30.0, 190.0, -5.0, 40.0, 60.0, 20.0, 10.0, 10.0, 0.0, 0.0, 20.0, 260.0, 20.0, 10.0, 40.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 50.0, 0.0, 20.0, 60.0, 30.0, 10.0, 30.0, 20.0, 0.0, 40.0, 0.0, 40.0, 50.0, 90.0, 500.0, 280.0, 40.0, 20.0, -20.0, 150.0, 30.0, 0.0, 0.0, 0.0, 0.0, 270.0, 0.0, 0.0, -40.0, 20.0, 80.0, 20.0, 30.0, 30.0, 20.0, 10.0, 20.0, 20.0, 40.0, 20.0, 40.0, 30.0, 20.0, 20.0, 30.0, 90.0, 50.0, 0.0, 10.0, 30.0, 10.0, 10.0, 60.0, -80.0, 0.0, 0.0, 20.0, 0.0, 20.0, 570.0, -10.0, 0.0, 0.0, 10.0, 30.0, 60.0, 20.0, 40.0, 30.0, 60.0, 60.0, 50.0, 20.0, 20.0, 25.0, 40.0, 0.0, 260.0, 40.0, 180.0, 10.0, 40.0, -50.0, 60.0, 670.0, 10.0, 10.0, 10.0, 150.0, 70.0, 40.0, 30.0, 20.0, 10.0, 40.0, -30.0, -70.0, 60.0, 590.0, 80.0, 230.0, 0.0, 40.0, 40.0, 50.0, 40.0, 270.0, 40.0, 90.0, 20.0, 20.0, 30.0, 60.0, 70.0, 190.0, 70.0, 40.0, 20.0, 130.0, 60.0, 40.0, 10.0, 20.0, 170.0, 30.0, 20.0, 10.0, 0.0, 10.0, 10.0, 40.0, 40.0, -5.0, 380.0, 20.0, 0.0, 20.0, 40.0, 40.0, 10.0, 20.0, 70.0, 90.0, 80.0, 40.0, 60.0, 10.0, 360.0, 230.0, 20.0, 60.0, -10.0, 210.0, 100.0, 20.0, 150.0, 30.0, 180.0, -50.0, 45.0, 140.0, 30.0, 30.0, 50.0, 40.0, 10.0, 40.0, 40.0, 20.0, 80.0, 60.0, 90.0, 180.0, 230.0, 170.0, 20.0, -40.0, 30.0, 70.0, 30.0, 190.0, 190.0, 60.0, 20.0, 380.0, 30.0, 80.0, 40.0, 0.0, 10.0, 20.0, 20.0, 20.0, 10.0, 30.0, 30.0, 20.0, 100.0, 20.0, 90.0, 0.0, 270.0, 40.0, 20.0, 20.0, 0.0, 40.0, 40.0, 20.0, 20.0, 20.0, 20.0, 40.0, 10.0, 40.0, -40.0, 550.0, 10.0, -20.0, 30.0, 0.0, 0.0, 250.0, -20.0, 30.0, 60.0, 170.0, 40.0, 20.0, 40.0, 0.0, 200.0, 30.0, 10.0, 40.0, 90.0, 70.0, 0.0, 20.0, 70.0, 20.0, 40.0, 110.0, 20.0, 0.0, 20.0, 60.0, 20.0, 10.0, 40.0, 30.0, 40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, 0.0, 50.0, 5.0, 10.0, 20.0, 40.0, 10.0, 370.0, 100.0, 0.0, 60.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 20.0, 40.0, 30.0, 0.0, 40.0, 50.0, 0.0, 10.0, 30.0, 0.0, 10.0, 20.0, 30.0, 0.0, 10.0, 0.0, 0.0, 30.0, 310.0, 10.0, 0.0, 40.0, 60.0, 0.0, 60.0, 40.0, 580.0, 0.0, 10.0, 40.0, 60.0, 20.0, 40.0, 40.0, 400.0, 20.0, 120.0, 20.0, 20.0, 160.0, 70.0, 10.0, 40.0, 0.0, 550.0, 20.0, 10.0, 40.0, 60.0, 0.0, 0.0, 70.0, 10.0, 0.0, -10.0, 20.0, 10.0, 20.0, 30.0, 0.0, 40.0, 40.0, 220.0, 30.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4937671868715698, "mean_inference_ms": 1.6964725882420744, "mean_action_processing_ms": 0.43699277536786363, "mean_env_wait_ms": 1.3617795423686543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05756521224975586, "StateBufferConnector_ms": 0.009239435195922852, "ViewRequirementAgentConnector_ms": 0.36858344078063965}, "num_episodes": 18, "episode_return_max": 1450.0, "episode_return_min": 30.0, "episode_return_mean": 605.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.12558247526005, "num_env_steps_trained_throughput_per_sec": 36.12558247526005, "timesteps_total": 272000, "num_env_steps_sampled_lifetime": 272000, "num_agent_steps_sampled_lifetime": 2720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2720000, "timers": {"training_iteration_time_ms": 110157.053, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110157.007, "sample_time_ms": 2395.333, "learn_time_ms": 107742.305, "learn_throughput": 37.126, "synch_weights_time_ms": 11.014}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 2720000, "num_agent_steps_trained": 2720000}, "done": false, "training_iteration": 68, "trial_id": "57140_00000", "date": "2024-06-27_01-24-52", "timestamp": 1719465892, "time_this_iter_s": 110.73866081237793, "time_total_s": 7818.3003442287445, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b19470d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7818.3003442287445, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 16.064331210191085, "ram_util_percent": 78.82611464968153}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1101430739140232, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.187044619853758, "policy_loss": -0.005494257085584699, "vf_loss": 4.191353748553096, "vf_explained_var": 0.0004570782882844805, "kl": 0.005267235303163455, "entropy": 0.4642355618099816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 643215.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000}, "env_runners": {"episode_reward_max": 1380.0, "episode_reward_min": 30.0, "episode_reward_mean": 604.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 1010.0}, "policy_reward_mean": {"policy_0": 60.485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [910.0, 580.0, 1245.0, 330.0, 375.0, 670.0, 935.0, 290.0, 510.0, 220.0, 850.0, 660.0, 445.0, 515.0, 1070.0, 540.0, 490.0, 1250.0, 675.0, 110.0, 1380.0, 270.0, 30.0, 810.0, 1115.0, 1110.0, 270.0, 880.0, 435.0, 550.0, 585.0, 240.0, 910.0, 360.0, 980.0, 610.0, 400.0, 500.0, 845.0, 570.0, 600.0, 320.0, 620.0, 355.0, 1100.0, 1195.0, 440.0, 160.0, 210.0, 1180.0, 330.0, 250.0, 290.0, 590.0, 310.0, 645.0, 1010.0, 960.0, 610.0, 710.0, 320.0, 565.0, 1020.0, 815.0, 400.0, 970.0, 830.0, 340.0, 490.0, 640.0, 590.0, 550.0, 350.0, 180.0, 625.0, 180.0, 160.0, 510.0, 1230.0, 1010.0, 200.0, 420.0, 660.0, 430.0, 300.0, 1380.0, 100.0, 360.0, 780.0, 1220.0, 395.0, 280.0, 850.0, 210.0, 1035.0, 190.0, 345.0, 960.0, 440.0, 750.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 240.0, 150.0, 160.0, 40.0, 10.0, 20.0, 10.0, 30.0, 230.0, 160.0, 20.0, 30.0, 60.0, 50.0, 160.0, 0.0, 80.0, 20.0, 0.0, 20.0, 790.0, 10.0, 45.0, 290.0, -20.0, 0.0, 140.0, -30.0, 0.0, 150.0, 30.0, 0.0, 50.0, 0.0, 20.0, 0.0, 10.0, 10.0, 60.0, 30.0, 10.0, 0.0, 60.0, 20.0, 30.0, 190.0, -25.0, 10.0, 50.0, 30.0, 5.0, 5.0, 150.0, 90.0, 70.0, 0.0, 30.0, 230.0, 60.0, 20.0, 40.0, 20.0, 380.0, 160.0, 50.0, 10.0, 25.0, 50.0, 180.0, 40.0, 30.0, 30.0, 10.0, 10.0, 20.0, 10.0, 80.0, 20.0, 40.0, 30.0, 60.0, 170.0, 70.0, 40.0, 40.0, 10.0, 10.0, 40.0, 40.0, 0.0, 40.0, 20.0, 20.0, 70.0, 30.0, 30.0, 10.0, 0.0, 0.0, 370.0, -5.0, -85.0, 90.0, -50.0, 40.0, 40.0, 0.0, 480.0, -30.0, 70.0, 40.0, 30.0, 20.0, 190.0, 150.0, 40.0, 40.0, 60.0, 20.0, 260.0, 20.0, 90.0, 0.0, 0.0, 50.0, -15.0, 20.0, -10.0, 30.0, -40.0, 0.0, 170.0, 10.0, 0.0, 280.0, -90.0, 160.0, 20.0, 5.0, 10.0, 160.0, 70.0, 690.0, 0.0, 30.0, 30.0, 20.0, 20.0, 40.0, 0.0, 20.0, 20.0, 40.0, 40.0, 0.0, 40.0, 30.0, 200.0, 150.0, 50.0, 10.0, 50.0, 30.0, 50.0, 30.0, 40.0, 30.0, 180.0, 20.0, 40.0, 60.0, 20.0, 80.0, -40.0, 1010.0, 20.0, 30.0, 10.0, 20.0, 20.0, 180.0, 20.0, 70.0, 0.0, 50.0, -10.0, -25.0, 10.0, 360.0, 10.0, 0.0, 30.0, 10.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 290.0, 0.0, 50.0, 10.0, 10.0, 100.0, 200.0, 10.0, 0.0, 710.0, 30.0, 0.0, 150.0, 40.0, -30.0, 0.0, 0.0, 0.0, 50.0, 30.0, 30.0, 0.0, 30.0, 10.0, 30.0, -140.0, 0.0, 10.0, 60.0, 0.0, 40.0, 0.0, 40.0, 400.0, 50.0, 100.0, 40.0, 80.0, 30.0, 30.0, 80.0, -50.0, 10.0, 40.0, 570.0, -65.0, 190.0, 160.0, 20.0, 160.0, 10.0, 100.0, 110.0, 660.0, 10.0, 10.0, 10.0, 170.0, 20.0, 10.0, 20.0, 20.0, 0.0, 10.0, 10.0, -10.0, 10.0, 190.0, 20.0, 0.0, 50.0, 0.0, 30.0, 0.0, 70.0, 20.0, 20.0, 40.0, 660.0, -10.0, 70.0, 50.0, 160.0, 20.0, 30.0, 25.0, 0.0, 30.0, 20.0, 30.0, 160.0, 10.0, 0.0, 0.0, 40.0, 0.0, 0.0, 240.0, 80.0, 20.0, 160.0, 50.0, 280.0, 25.0, 10.0, 30.0, 0.0, 0.0, 10.0, 20.0, 0.0, 30.0, 0.0, 20.0, 20.0, 70.0, 30.0, 20.0, 30.0, 20.0, 10.0, 360.0, 20.0, 30.0, 40.0, 110.0, 260.0, -40.0, 80.0, 40.0, 70.0, 0.0, 0.0, 40.0, 100.0, 40.0, 80.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 160.0, 0.0, 550.0, 10.0, 0.0, 120.0, 80.0, 170.0, 60.0, 50.0, 30.0, 70.0, 40.0, 70.0, 20.0, 60.0, 40.0, 30.0, 40.0, 50.0, 170.0, 40.0, 20.0, 20.0, 0.0, 30.0, 0.0, 110.0, 0.0, 30.0, 50.0, 0.0, 270.0, 30.0, 10.0, 0.0, 0.0, 210.0, 30.0, -45.0, 60.0, 280.0, 60.0, 180.0, 40.0, 20.0, 10.0, 20.0, 20.0, 10.0, 30.0, 10.0, 90.0, 150.0, 0.0, 40.0, 200.0, 30.0, 550.0, -10.0, 20.0, 30.0, -50.0, 0.0, 0.0, 30.0, 0.0, 20.0, 20.0, 160.0, 0.0, 20.0, 0.0, 20.0, 40.0, 0.0, 40.0, 10.0, 50.0, 40.0, 50.0, 10.0, 10.0, 20.0, 40.0, 360.0, 30.0, 0.0, 20.0, 30.0, 40.0, -5.0, 0.0, 10.0, 40.0, 40.0, 180.0, 20.0, 20.0, 10.0, 90.0, 210.0, 40.0, 40.0, 20.0, 500.0, 150.0, 80.0, 480.0, 0.0, 130.0, 180.0, 10.0, 100.0, 30.0, 190.0, -5.0, 40.0, 60.0, 20.0, 10.0, 10.0, 0.0, 0.0, 20.0, 260.0, 20.0, 10.0, 40.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 50.0, 0.0, 20.0, 60.0, 30.0, 10.0, 30.0, 20.0, 0.0, 40.0, 0.0, 40.0, 50.0, 90.0, 500.0, 280.0, 40.0, 20.0, -20.0, 150.0, 30.0, 0.0, 0.0, 0.0, 0.0, 270.0, 0.0, 0.0, -40.0, 20.0, 80.0, 20.0, 30.0, 30.0, 20.0, 10.0, 20.0, 20.0, 40.0, 20.0, 40.0, 30.0, 20.0, 20.0, 30.0, 90.0, 50.0, 0.0, 10.0, 30.0, 10.0, 10.0, 60.0, -80.0, 0.0, 0.0, 20.0, 0.0, 20.0, 570.0, -10.0, 0.0, 0.0, 10.0, 30.0, 60.0, 20.0, 40.0, 30.0, 60.0, 60.0, 50.0, 20.0, 20.0, 25.0, 40.0, 0.0, 260.0, 40.0, 180.0, 10.0, 40.0, -50.0, 60.0, 670.0, 10.0, 10.0, 10.0, 150.0, 70.0, 40.0, 30.0, 20.0, 10.0, 40.0, -30.0, -70.0, 60.0, 590.0, 80.0, 230.0, 0.0, 40.0, 40.0, 50.0, 40.0, 270.0, 40.0, 90.0, 20.0, 20.0, 30.0, 60.0, 70.0, 190.0, 70.0, 40.0, 20.0, 130.0, 60.0, 40.0, 10.0, 20.0, 170.0, 30.0, 20.0, 10.0, 0.0, 10.0, 10.0, 40.0, 40.0, -5.0, 380.0, 20.0, 0.0, 20.0, 40.0, 40.0, 10.0, 20.0, 70.0, 90.0, 80.0, 40.0, 60.0, 10.0, 360.0, 230.0, 20.0, 60.0, -10.0, 210.0, 100.0, 20.0, 150.0, 30.0, 180.0, -50.0, 45.0, 140.0, 30.0, 30.0, 50.0, 40.0, 10.0, 40.0, 40.0, 20.0, 80.0, 60.0, 90.0, 180.0, 230.0, 170.0, 20.0, -40.0, 30.0, 70.0, 30.0, 190.0, 190.0, 60.0, 20.0, 380.0, 30.0, 80.0, 40.0, 0.0, 10.0, 20.0, 20.0, 20.0, 10.0, 30.0, 30.0, 20.0, 100.0, 20.0, 90.0, 0.0, 270.0, 40.0, 20.0, 20.0, 0.0, 40.0, 40.0, 20.0, 20.0, 20.0, 20.0, 40.0, 10.0, 40.0, -40.0, 550.0, 10.0, -20.0, 30.0, 0.0, 0.0, 250.0, -20.0, 30.0, 60.0, 170.0, 40.0, 20.0, 40.0, 0.0, 200.0, 30.0, 10.0, 40.0, 90.0, 70.0, 0.0, 20.0, 70.0, 20.0, 40.0, 110.0, 20.0, 0.0, 20.0, 60.0, 20.0, 10.0, 40.0, 30.0, 40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, 0.0, 50.0, 5.0, 10.0, 20.0, 40.0, 10.0, 370.0, 100.0, 0.0, 60.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 20.0, 40.0, 30.0, 0.0, 40.0, 50.0, 0.0, 10.0, 30.0, 0.0, 10.0, 20.0, 30.0, 0.0, 10.0, 0.0, 0.0, 30.0, 310.0, 10.0, 0.0, 40.0, 60.0, 0.0, 60.0, 40.0, 580.0, 0.0, 10.0, 40.0, 60.0, 20.0, 40.0, 40.0, 400.0, 20.0, 120.0, 20.0, 20.0, 160.0, 70.0, 10.0, 40.0, 0.0, 550.0, 20.0, 10.0, 40.0, 60.0, 0.0, 0.0, 70.0, 10.0, 0.0, -10.0, 20.0, 10.0, 20.0, 30.0, 0.0, 40.0, 40.0, 220.0, 30.0, 10.0, 10.0, 360.0, 30.0, 0.0, 0.0, 70.0, 70.0, 60.0, 60.0, 0.0, 60.0, 0.0, 40.0, 30.0, 70.0, 20.0, 0.0, 0.0, 40.0, 170.0, 10.0, 50.0, 30.0, 20.0, 40.0, 90.0, 0.0, 30.0, 10.0, 20.0, 40.0, -20.0, -20.0, 710.0, 220.0, 110.0, 50.0, 260.0, 5.0, 25.0, 20.0, 20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 40.0, 20.0, 0.0, 20.0, 20.0, 170.0, 0.0, 20.0, 50.0, 280.0, 170.0, 30.0, 30.0, 40.0, 60.0, 40.0, 40.0, 50.0, 40.0, 60.0, 200.0, 30.0, 50.0, 40.0, 190.0, -40.0, 60.0, 630.0, 0.0, 40.0, 30.0, 70.0, 30.0, 170.0, 35.0, 10.0, 0.0, 10.0, 0.0, 30.0, 80.0, 90.0, 30.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 60.0, 560.0, 0.0, 30.0, 0.0, 40.0, 30.0, 80.0, 40.0, 10.0, 30.0, 0.0, 50.0, 0.0, 10.0, 10.0, 10.0, 20.0, 50.0, 30.0, 355.0, 0.0, 60.0, 90.0, 150.0, 50.0, 30.0, 40.0, 150.0, 110.0, 10.0, 30.0, 10.0, 10.0, 10.0, 20.0, 30.0, 20.0, 30.0, 20.0, -5.0, 5.0, 190.0, 20.0, 50.0, 190.0, -20.0, -40.0, -15.0, -30.0, 160.0, 180.0, 170.0, 40.0, 110.0, 120.0, 80.0, 60.0, 10.0, 30.0, 60.0, 20.0, 10.0, 60.0, 250.0, 30.0, 10.0, 0.0, 0.0, 0.0, 20.0, 70.0, 200.0, 30.0, 50.0, 210.0, 60.0, 70.0, 10.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.491663387342241, "mean_inference_ms": 1.6940108501914097, "mean_action_processing_ms": 0.4362950347685409, "mean_env_wait_ms": 1.360017844495369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05805850028991699, "StateBufferConnector_ms": 0.00929570198059082, "ViewRequirementAgentConnector_ms": 0.3812863826751709}, "num_episodes": 18, "episode_return_max": 1380.0, "episode_return_min": 30.0, "episode_return_mean": 604.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.32395908969836, "num_env_steps_trained_throughput_per_sec": 36.32395908969836, "timesteps_total": 276000, "num_env_steps_sampled_lifetime": 276000, "num_agent_steps_sampled_lifetime": 2760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2760000, "timers": {"training_iteration_time_ms": 110167.975, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110167.928, "sample_time_ms": 2393.729, "learn_time_ms": 107754.502, "learn_throughput": 37.121, "synch_weights_time_ms": 11.192}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 2760000, "num_agent_steps_trained": 2760000}, "done": false, "training_iteration": 69, "trial_id": "57140_00000", "date": "2024-06-27_01-26-42", "timestamp": 1719466002, "time_this_iter_s": 110.1319990158081, "time_total_s": 7928.432343244553, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18e8700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 7928.432343244553, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 16.565161290322582, "ram_util_percent": 78.59096774193547}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0078436104634316, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004947978123269689, "vf_loss": 4.258092847088783, "vf_explained_var": 0.0006578105453231211, "kl": Infinity, "entropy": 0.4693211204645098, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 652605.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "env_runners": {"episode_reward_max": 1380.0, "episode_reward_min": 30.0, "episode_reward_mean": 581.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 860.0}, "policy_reward_mean": {"policy_0": 58.195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [675.0, 110.0, 1380.0, 270.0, 30.0, 810.0, 1115.0, 1110.0, 270.0, 880.0, 435.0, 550.0, 585.0, 240.0, 910.0, 360.0, 980.0, 610.0, 400.0, 500.0, 845.0, 570.0, 600.0, 320.0, 620.0, 355.0, 1100.0, 1195.0, 440.0, 160.0, 210.0, 1180.0, 330.0, 250.0, 290.0, 590.0, 310.0, 645.0, 1010.0, 960.0, 610.0, 710.0, 320.0, 565.0, 1020.0, 815.0, 400.0, 970.0, 830.0, 340.0, 490.0, 640.0, 590.0, 550.0, 350.0, 180.0, 625.0, 180.0, 160.0, 510.0, 1230.0, 1010.0, 200.0, 420.0, 660.0, 430.0, 300.0, 1380.0, 100.0, 360.0, 780.0, 1220.0, 395.0, 280.0, 850.0, 210.0, 1035.0, 190.0, 345.0, 960.0, 440.0, 750.0, 220.0, 890.0, 790.0, 1070.0, 180.0, 235.0, 900.0, 620.0, 350.0, 455.0, 490.0, 570.0, 450.0, 210.0, 480.0, 555.0, 610.0, 520.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 180.0, 20.0, 70.0, 0.0, 50.0, -10.0, -25.0, 10.0, 360.0, 10.0, 0.0, 30.0, 10.0, 10.0, 30.0, 20.0, 0.0, 0.0, 0.0, 290.0, 0.0, 50.0, 10.0, 10.0, 100.0, 200.0, 10.0, 0.0, 710.0, 30.0, 0.0, 150.0, 40.0, -30.0, 0.0, 0.0, 0.0, 50.0, 30.0, 30.0, 0.0, 30.0, 10.0, 30.0, -140.0, 0.0, 10.0, 60.0, 0.0, 40.0, 0.0, 40.0, 400.0, 50.0, 100.0, 40.0, 80.0, 30.0, 30.0, 80.0, -50.0, 10.0, 40.0, 570.0, -65.0, 190.0, 160.0, 20.0, 160.0, 10.0, 100.0, 110.0, 660.0, 10.0, 10.0, 10.0, 170.0, 20.0, 10.0, 20.0, 20.0, 0.0, 10.0, 10.0, -10.0, 10.0, 190.0, 20.0, 0.0, 50.0, 0.0, 30.0, 0.0, 70.0, 20.0, 20.0, 40.0, 660.0, -10.0, 70.0, 50.0, 160.0, 20.0, 30.0, 25.0, 0.0, 30.0, 20.0, 30.0, 160.0, 10.0, 0.0, 0.0, 40.0, 0.0, 0.0, 240.0, 80.0, 20.0, 160.0, 50.0, 280.0, 25.0, 10.0, 30.0, 0.0, 0.0, 10.0, 20.0, 0.0, 30.0, 0.0, 20.0, 20.0, 70.0, 30.0, 20.0, 30.0, 20.0, 10.0, 360.0, 20.0, 30.0, 40.0, 110.0, 260.0, -40.0, 80.0, 40.0, 70.0, 0.0, 0.0, 40.0, 100.0, 40.0, 80.0, 10.0, 20.0, 0.0, 20.0, 20.0, 20.0, 160.0, 0.0, 550.0, 10.0, 0.0, 120.0, 80.0, 170.0, 60.0, 50.0, 30.0, 70.0, 40.0, 70.0, 20.0, 60.0, 40.0, 30.0, 40.0, 50.0, 170.0, 40.0, 20.0, 20.0, 0.0, 30.0, 0.0, 110.0, 0.0, 30.0, 50.0, 0.0, 270.0, 30.0, 10.0, 0.0, 0.0, 210.0, 30.0, -45.0, 60.0, 280.0, 60.0, 180.0, 40.0, 20.0, 10.0, 20.0, 20.0, 10.0, 30.0, 10.0, 90.0, 150.0, 0.0, 40.0, 200.0, 30.0, 550.0, -10.0, 20.0, 30.0, -50.0, 0.0, 0.0, 30.0, 0.0, 20.0, 20.0, 160.0, 0.0, 20.0, 0.0, 20.0, 40.0, 0.0, 40.0, 10.0, 50.0, 40.0, 50.0, 10.0, 10.0, 20.0, 40.0, 360.0, 30.0, 0.0, 20.0, 30.0, 40.0, -5.0, 0.0, 10.0, 40.0, 40.0, 180.0, 20.0, 20.0, 10.0, 90.0, 210.0, 40.0, 40.0, 20.0, 500.0, 150.0, 80.0, 480.0, 0.0, 130.0, 180.0, 10.0, 100.0, 30.0, 190.0, -5.0, 40.0, 60.0, 20.0, 10.0, 10.0, 0.0, 0.0, 20.0, 260.0, 20.0, 10.0, 40.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 50.0, 0.0, 20.0, 60.0, 30.0, 10.0, 30.0, 20.0, 0.0, 40.0, 0.0, 40.0, 50.0, 90.0, 500.0, 280.0, 40.0, 20.0, -20.0, 150.0, 30.0, 0.0, 0.0, 0.0, 0.0, 270.0, 0.0, 0.0, -40.0, 20.0, 80.0, 20.0, 30.0, 30.0, 20.0, 10.0, 20.0, 20.0, 40.0, 20.0, 40.0, 30.0, 20.0, 20.0, 30.0, 90.0, 50.0, 0.0, 10.0, 30.0, 10.0, 10.0, 60.0, -80.0, 0.0, 0.0, 20.0, 0.0, 20.0, 570.0, -10.0, 0.0, 0.0, 10.0, 30.0, 60.0, 20.0, 40.0, 30.0, 60.0, 60.0, 50.0, 20.0, 20.0, 25.0, 40.0, 0.0, 260.0, 40.0, 180.0, 10.0, 40.0, -50.0, 60.0, 670.0, 10.0, 10.0, 10.0, 150.0, 70.0, 40.0, 30.0, 20.0, 10.0, 40.0, -30.0, -70.0, 60.0, 590.0, 80.0, 230.0, 0.0, 40.0, 40.0, 50.0, 40.0, 270.0, 40.0, 90.0, 20.0, 20.0, 30.0, 60.0, 70.0, 190.0, 70.0, 40.0, 20.0, 130.0, 60.0, 40.0, 10.0, 20.0, 170.0, 30.0, 20.0, 10.0, 0.0, 10.0, 10.0, 40.0, 40.0, -5.0, 380.0, 20.0, 0.0, 20.0, 40.0, 40.0, 10.0, 20.0, 70.0, 90.0, 80.0, 40.0, 60.0, 10.0, 360.0, 230.0, 20.0, 60.0, -10.0, 210.0, 100.0, 20.0, 150.0, 30.0, 180.0, -50.0, 45.0, 140.0, 30.0, 30.0, 50.0, 40.0, 10.0, 40.0, 40.0, 20.0, 80.0, 60.0, 90.0, 180.0, 230.0, 170.0, 20.0, -40.0, 30.0, 70.0, 30.0, 190.0, 190.0, 60.0, 20.0, 380.0, 30.0, 80.0, 40.0, 0.0, 10.0, 20.0, 20.0, 20.0, 10.0, 30.0, 30.0, 20.0, 100.0, 20.0, 90.0, 0.0, 270.0, 40.0, 20.0, 20.0, 0.0, 40.0, 40.0, 20.0, 20.0, 20.0, 20.0, 40.0, 10.0, 40.0, -40.0, 550.0, 10.0, -20.0, 30.0, 0.0, 0.0, 250.0, -20.0, 30.0, 60.0, 170.0, 40.0, 20.0, 40.0, 0.0, 200.0, 30.0, 10.0, 40.0, 90.0, 70.0, 0.0, 20.0, 70.0, 20.0, 40.0, 110.0, 20.0, 0.0, 20.0, 60.0, 20.0, 10.0, 40.0, 30.0, 40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, 0.0, 50.0, 5.0, 10.0, 20.0, 40.0, 10.0, 370.0, 100.0, 0.0, 60.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 20.0, 40.0, 30.0, 0.0, 40.0, 50.0, 0.0, 10.0, 30.0, 0.0, 10.0, 20.0, 30.0, 0.0, 10.0, 0.0, 0.0, 30.0, 310.0, 10.0, 0.0, 40.0, 60.0, 0.0, 60.0, 40.0, 580.0, 0.0, 10.0, 40.0, 60.0, 20.0, 40.0, 40.0, 400.0, 20.0, 120.0, 20.0, 20.0, 160.0, 70.0, 10.0, 40.0, 0.0, 550.0, 20.0, 10.0, 40.0, 60.0, 0.0, 0.0, 70.0, 10.0, 0.0, -10.0, 20.0, 10.0, 20.0, 30.0, 0.0, 40.0, 40.0, 220.0, 30.0, 10.0, 10.0, 360.0, 30.0, 0.0, 0.0, 70.0, 70.0, 60.0, 60.0, 0.0, 60.0, 0.0, 40.0, 30.0, 70.0, 20.0, 0.0, 0.0, 40.0, 170.0, 10.0, 50.0, 30.0, 20.0, 40.0, 90.0, 0.0, 30.0, 10.0, 20.0, 40.0, -20.0, -20.0, 710.0, 220.0, 110.0, 50.0, 260.0, 5.0, 25.0, 20.0, 20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 40.0, 20.0, 0.0, 20.0, 20.0, 170.0, 0.0, 20.0, 50.0, 280.0, 170.0, 30.0, 30.0, 40.0, 60.0, 40.0, 40.0, 50.0, 40.0, 60.0, 200.0, 30.0, 50.0, 40.0, 190.0, -40.0, 60.0, 630.0, 0.0, 40.0, 30.0, 70.0, 30.0, 170.0, 35.0, 10.0, 0.0, 10.0, 0.0, 30.0, 80.0, 90.0, 30.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 60.0, 560.0, 0.0, 30.0, 0.0, 40.0, 30.0, 80.0, 40.0, 10.0, 30.0, 0.0, 50.0, 0.0, 10.0, 10.0, 10.0, 20.0, 50.0, 30.0, 355.0, 0.0, 60.0, 90.0, 150.0, 50.0, 30.0, 40.0, 150.0, 110.0, 10.0, 30.0, 10.0, 10.0, 10.0, 20.0, 30.0, 20.0, 30.0, 20.0, -5.0, 5.0, 190.0, 20.0, 50.0, 190.0, -20.0, -40.0, -15.0, -30.0, 160.0, 180.0, 170.0, 40.0, 110.0, 120.0, 80.0, 60.0, 10.0, 30.0, 60.0, 20.0, 10.0, 60.0, 250.0, 30.0, 10.0, 0.0, 0.0, 0.0, 20.0, 70.0, 200.0, 30.0, 50.0, 210.0, 60.0, 70.0, 10.0, 30.0, 10.0, 50.0, 0.0, 60.0, 20.0, 30.0, 0.0, 0.0, 0.0, 50.0, 20.0, 60.0, 70.0, 600.0, 80.0, 30.0, 10.0, 20.0, -20.0, 20.0, 0.0, 0.0, 20.0, 460.0, 30.0, 0.0, 10.0, 260.0, 10.0, 0.0, 20.0, 80.0, 650.0, 60.0, 70.0, 30.0, 70.0, 10.0, 30.0, 50.0, 40.0, 0.0, 40.0, 0.0, 0.0, 20.0, 10.0, 30.0, 30.0, 10.0, 20.0, 10.0, 40.0, 30.0, -15.0, 40.0, 0.0, 10.0, 60.0, 40.0, 190.0, 20.0, 320.0, 360.0, 10.0, 160.0, 30.0, -140.0, 0.0, -50.0, 50.0, 110.0, 10.0, 60.0, 40.0, 10.0, 20.0, 40.0, 0.0, 280.0, 40.0, 70.0, 20.0, 180.0, 0.0, 0.0, 0.0, 10.0, 0.0, 30.0, 560.0, 25.0, -15.0, 10.0, 10.0, -30.0, -30.0, 5.0, -90.0, 10.0, 20.0, -90.0, -90.0, 20.0, -120.0, -80.0, 80.0, -30.0, -80.0, 860.0, 40.0, 40.0, 50.0, 260.0, 10.0, 40.0, 40.0, 30.0, 50.0, 10.0, 50.0, -130.0, 40.0, 40.0, -50.0, 400.0, 10.0, 20.0, 20.0, 50.0, 0.0, -5.0, 40.0, 0.0, 0.0, 30.0, 25.0, 80.0, 30.0, 10.0, 30.0, 50.0, 30.0, 80.0, 40.0, 210.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 220.0, 60.0, 270.0, -30.0, 0.0, -25.0, 30.0, 10.0, 20.0, 20.0, 20.0, -30.0, 20.0, 150.0, 40.0, 60.0, 190.0, 120.0, -50.0, 10.0, 150.0, 0.0, 10.0, 300.0, 20.0, 50.0, 0.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4894525601618107, "mean_inference_ms": 1.691663437491477, "mean_action_processing_ms": 0.43561925092291487, "mean_env_wait_ms": 1.3582423168694029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05844616889953613, "StateBufferConnector_ms": 0.009201765060424805, "ViewRequirementAgentConnector_ms": 0.3842647075653076}, "num_episodes": 18, "episode_return_max": 1380.0, "episode_return_min": 30.0, "episode_return_mean": 581.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 35.908721927484144, "num_env_steps_trained_throughput_per_sec": 35.908721927484144, "timesteps_total": 280000, "num_env_steps_sampled_lifetime": 280000, "num_agent_steps_sampled_lifetime": 2800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2800000, "timers": {"training_iteration_time_ms": 110216.217, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110216.169, "sample_time_ms": 2389.343, "learn_time_ms": 107806.957, "learn_throughput": 37.103, "synch_weights_time_ms": 11.335}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 2800000, "num_agent_steps_trained": 2800000}, "done": false, "training_iteration": 70, "trial_id": "57140_00000", "date": "2024-06-27_01-28-34", "timestamp": 1719466114, "time_this_iter_s": 111.40767788887024, "time_total_s": 8039.840021133423, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af404b80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8039.840021133423, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 19.098734177215192, "ram_util_percent": 78.8126582278481}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0608566783297175, "cur_kl_coeff": 0.3375, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.915424808628135, "policy_loss": -0.0040915085710694216, "vf_loss": 4.918120425907822, "vf_explained_var": 0.0008736762185447132, "kl": 0.004135973616775757, "entropy": 0.4329010529386096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 661995.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000}, "env_runners": {"episode_reward_max": 1380.0, "episode_reward_min": 100.0, "episode_reward_mean": 565.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -140.0}, "policy_reward_max": {"policy_0": 860.0}, "policy_reward_mean": {"policy_0": 56.53}, "custom_metrics": {}, "hist_stats": {"episode_reward": [600.0, 320.0, 620.0, 355.0, 1100.0, 1195.0, 440.0, 160.0, 210.0, 1180.0, 330.0, 250.0, 290.0, 590.0, 310.0, 645.0, 1010.0, 960.0, 610.0, 710.0, 320.0, 565.0, 1020.0, 815.0, 400.0, 970.0, 830.0, 340.0, 490.0, 640.0, 590.0, 550.0, 350.0, 180.0, 625.0, 180.0, 160.0, 510.0, 1230.0, 1010.0, 200.0, 420.0, 660.0, 430.0, 300.0, 1380.0, 100.0, 360.0, 780.0, 1220.0, 395.0, 280.0, 850.0, 210.0, 1035.0, 190.0, 345.0, 960.0, 440.0, 750.0, 220.0, 890.0, 790.0, 1070.0, 180.0, 235.0, 900.0, 620.0, 350.0, 455.0, 490.0, 570.0, 450.0, 210.0, 480.0, 555.0, 610.0, 520.0, 190.0, 285.0, 630.0, 550.0, 240.0, 800.0, 160.0, 345.0, 840.0, 770.0, 820.0, 640.0, 495.0, 440.0, 490.0, 440.0, 660.0, 400.0, 180.0, 1295.0, 470.0, 830.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 550.0, -10.0, 20.0, 30.0, -50.0, 0.0, 0.0, 30.0, 0.0, 20.0, 20.0, 160.0, 0.0, 20.0, 0.0, 20.0, 40.0, 0.0, 40.0, 10.0, 50.0, 40.0, 50.0, 10.0, 10.0, 20.0, 40.0, 360.0, 30.0, 0.0, 20.0, 30.0, 40.0, -5.0, 0.0, 10.0, 40.0, 40.0, 180.0, 20.0, 20.0, 10.0, 90.0, 210.0, 40.0, 40.0, 20.0, 500.0, 150.0, 80.0, 480.0, 0.0, 130.0, 180.0, 10.0, 100.0, 30.0, 190.0, -5.0, 40.0, 60.0, 20.0, 10.0, 10.0, 0.0, 0.0, 20.0, 260.0, 20.0, 10.0, 40.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 50.0, 0.0, 20.0, 60.0, 30.0, 10.0, 30.0, 20.0, 0.0, 40.0, 0.0, 40.0, 50.0, 90.0, 500.0, 280.0, 40.0, 20.0, -20.0, 150.0, 30.0, 0.0, 0.0, 0.0, 0.0, 270.0, 0.0, 0.0, -40.0, 20.0, 80.0, 20.0, 30.0, 30.0, 20.0, 10.0, 20.0, 20.0, 40.0, 20.0, 40.0, 30.0, 20.0, 20.0, 30.0, 90.0, 50.0, 0.0, 10.0, 30.0, 10.0, 10.0, 60.0, -80.0, 0.0, 0.0, 20.0, 0.0, 20.0, 570.0, -10.0, 0.0, 0.0, 10.0, 30.0, 60.0, 20.0, 40.0, 30.0, 60.0, 60.0, 50.0, 20.0, 20.0, 25.0, 40.0, 0.0, 260.0, 40.0, 180.0, 10.0, 40.0, -50.0, 60.0, 670.0, 10.0, 10.0, 10.0, 150.0, 70.0, 40.0, 30.0, 20.0, 10.0, 40.0, -30.0, -70.0, 60.0, 590.0, 80.0, 230.0, 0.0, 40.0, 40.0, 50.0, 40.0, 270.0, 40.0, 90.0, 20.0, 20.0, 30.0, 60.0, 70.0, 190.0, 70.0, 40.0, 20.0, 130.0, 60.0, 40.0, 10.0, 20.0, 170.0, 30.0, 20.0, 10.0, 0.0, 10.0, 10.0, 40.0, 40.0, -5.0, 380.0, 20.0, 0.0, 20.0, 40.0, 40.0, 10.0, 20.0, 70.0, 90.0, 80.0, 40.0, 60.0, 10.0, 360.0, 230.0, 20.0, 60.0, -10.0, 210.0, 100.0, 20.0, 150.0, 30.0, 180.0, -50.0, 45.0, 140.0, 30.0, 30.0, 50.0, 40.0, 10.0, 40.0, 40.0, 20.0, 80.0, 60.0, 90.0, 180.0, 230.0, 170.0, 20.0, -40.0, 30.0, 70.0, 30.0, 190.0, 190.0, 60.0, 20.0, 380.0, 30.0, 80.0, 40.0, 0.0, 10.0, 20.0, 20.0, 20.0, 10.0, 30.0, 30.0, 20.0, 100.0, 20.0, 90.0, 0.0, 270.0, 40.0, 20.0, 20.0, 0.0, 40.0, 40.0, 20.0, 20.0, 20.0, 20.0, 40.0, 10.0, 40.0, -40.0, 550.0, 10.0, -20.0, 30.0, 0.0, 0.0, 250.0, -20.0, 30.0, 60.0, 170.0, 40.0, 20.0, 40.0, 0.0, 200.0, 30.0, 10.0, 40.0, 90.0, 70.0, 0.0, 20.0, 70.0, 20.0, 40.0, 110.0, 20.0, 0.0, 20.0, 60.0, 20.0, 10.0, 40.0, 30.0, 40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, 0.0, 50.0, 5.0, 10.0, 20.0, 40.0, 10.0, 370.0, 100.0, 0.0, 60.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 20.0, 40.0, 30.0, 0.0, 40.0, 50.0, 0.0, 10.0, 30.0, 0.0, 10.0, 20.0, 30.0, 0.0, 10.0, 0.0, 0.0, 30.0, 310.0, 10.0, 0.0, 40.0, 60.0, 0.0, 60.0, 40.0, 580.0, 0.0, 10.0, 40.0, 60.0, 20.0, 40.0, 40.0, 400.0, 20.0, 120.0, 20.0, 20.0, 160.0, 70.0, 10.0, 40.0, 0.0, 550.0, 20.0, 10.0, 40.0, 60.0, 0.0, 0.0, 70.0, 10.0, 0.0, -10.0, 20.0, 10.0, 20.0, 30.0, 0.0, 40.0, 40.0, 220.0, 30.0, 10.0, 10.0, 360.0, 30.0, 0.0, 0.0, 70.0, 70.0, 60.0, 60.0, 0.0, 60.0, 0.0, 40.0, 30.0, 70.0, 20.0, 0.0, 0.0, 40.0, 170.0, 10.0, 50.0, 30.0, 20.0, 40.0, 90.0, 0.0, 30.0, 10.0, 20.0, 40.0, -20.0, -20.0, 710.0, 220.0, 110.0, 50.0, 260.0, 5.0, 25.0, 20.0, 20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 40.0, 20.0, 0.0, 20.0, 20.0, 170.0, 0.0, 20.0, 50.0, 280.0, 170.0, 30.0, 30.0, 40.0, 60.0, 40.0, 40.0, 50.0, 40.0, 60.0, 200.0, 30.0, 50.0, 40.0, 190.0, -40.0, 60.0, 630.0, 0.0, 40.0, 30.0, 70.0, 30.0, 170.0, 35.0, 10.0, 0.0, 10.0, 0.0, 30.0, 80.0, 90.0, 30.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 60.0, 560.0, 0.0, 30.0, 0.0, 40.0, 30.0, 80.0, 40.0, 10.0, 30.0, 0.0, 50.0, 0.0, 10.0, 10.0, 10.0, 20.0, 50.0, 30.0, 355.0, 0.0, 60.0, 90.0, 150.0, 50.0, 30.0, 40.0, 150.0, 110.0, 10.0, 30.0, 10.0, 10.0, 10.0, 20.0, 30.0, 20.0, 30.0, 20.0, -5.0, 5.0, 190.0, 20.0, 50.0, 190.0, -20.0, -40.0, -15.0, -30.0, 160.0, 180.0, 170.0, 40.0, 110.0, 120.0, 80.0, 60.0, 10.0, 30.0, 60.0, 20.0, 10.0, 60.0, 250.0, 30.0, 10.0, 0.0, 0.0, 0.0, 20.0, 70.0, 200.0, 30.0, 50.0, 210.0, 60.0, 70.0, 10.0, 30.0, 10.0, 50.0, 0.0, 60.0, 20.0, 30.0, 0.0, 0.0, 0.0, 50.0, 20.0, 60.0, 70.0, 600.0, 80.0, 30.0, 10.0, 20.0, -20.0, 20.0, 0.0, 0.0, 20.0, 460.0, 30.0, 0.0, 10.0, 260.0, 10.0, 0.0, 20.0, 80.0, 650.0, 60.0, 70.0, 30.0, 70.0, 10.0, 30.0, 50.0, 40.0, 0.0, 40.0, 0.0, 0.0, 20.0, 10.0, 30.0, 30.0, 10.0, 20.0, 10.0, 40.0, 30.0, -15.0, 40.0, 0.0, 10.0, 60.0, 40.0, 190.0, 20.0, 320.0, 360.0, 10.0, 160.0, 30.0, -140.0, 0.0, -50.0, 50.0, 110.0, 10.0, 60.0, 40.0, 10.0, 20.0, 40.0, 0.0, 280.0, 40.0, 70.0, 20.0, 180.0, 0.0, 0.0, 0.0, 10.0, 0.0, 30.0, 560.0, 25.0, -15.0, 10.0, 10.0, -30.0, -30.0, 5.0, -90.0, 10.0, 20.0, -90.0, -90.0, 20.0, -120.0, -80.0, 80.0, -30.0, -80.0, 860.0, 40.0, 40.0, 50.0, 260.0, 10.0, 40.0, 40.0, 30.0, 50.0, 10.0, 50.0, -130.0, 40.0, 40.0, -50.0, 400.0, 10.0, 20.0, 20.0, 50.0, 0.0, -5.0, 40.0, 0.0, 0.0, 30.0, 25.0, 80.0, 30.0, 10.0, 30.0, 50.0, 30.0, 80.0, 40.0, 210.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 220.0, 60.0, 270.0, -30.0, 0.0, -25.0, 30.0, 10.0, 20.0, 20.0, 20.0, -30.0, 20.0, 150.0, 40.0, 60.0, 190.0, 120.0, -50.0, 10.0, 150.0, 0.0, 10.0, 300.0, 20.0, 50.0, 0.0, 30.0, 0.0, 30.0, 0.0, 10.0, 10.0, 30.0, 70.0, 20.0, 20.0, 0.0, 40.0, 10.0, 100.0, 10.0, 30.0, 30.0, 50.0, 0.0, -25.0, 40.0, -5.0, 390.0, 40.0, 30.0, 20.0, 90.0, 0.0, 10.0, 15.0, 40.0, 40.0, 80.0, 0.0, 20.0, 10.0, 70.0, 30.0, 80.0, 160.0, 60.0, 40.0, 50.0, 30.0, 20.0, 0.0, 0.0, 10.0, 40.0, 40.0, 10.0, 0.0, 20.0, 50.0, 80.0, 130.0, 370.0, 90.0, 40.0, -20.0, 40.0, 0.0, 30.0, 60.0, 0.0, 10.0, 20.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 210.0, 15.0, 30.0, 70.0, 0.0, 10.0, 100.0, 260.0, 60.0, -20.0, -5.0, 5.0, 80.0, 180.0, 170.0, 50.0, 70.0, 250.0, 110.0, 60.0, 20.0, 10.0, 160.0, 0.0, 40.0, 20.0, 50.0, 60.0, 10.0, 10.0, 60.0, 40.0, 30.0, 60.0, 480.0, 20.0, 90.0, 260.0, 20.0, 20.0, 40.0, 40.0, 70.0, 20.0, 60.0, 0.0, 290.0, 0.0, -25.0, 20.0, 30.0, 110.0, 20.0, 10.0, 40.0, 30.0, 380.0, -30.0, 0.0, 20.0, 30.0, -50.0, 10.0, 30.0, 20.0, 50.0, 10.0, 30.0, 20.0, 0.0, 30.0, 160.0, 80.0, 60.0, 50.0, 40.0, 60.0, 60.0, 40.0, 40.0, 40.0, 40.0, 10.0, 70.0, 40.0, 20.0, 350.0, 20.0, 40.0, 100.0, 30.0, 10.0, 10.0, 20.0, 60.0, 0.0, 120.0, 80.0, 10.0, 40.0, 30.0, 20.0, 80.0, 20.0, 0.0, 40.0, 20.0, 0.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 50.0, 20.0, 25.0, 60.0, 40.0, 210.0, -20.0, 20.0, 40.0, 850.0, 80.0, 80.0, 10.0, 0.0, 70.0, 40.0, 40.0, 110.0, 20.0, 20.0, 20.0, 10.0, 40.0, 40.0, 30.0, 40.0, 170.0, 20.0, 80.0, 380.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4867552087359315, "mean_inference_ms": 1.6890600925903505, "mean_action_processing_ms": 0.4348159767363352, "mean_env_wait_ms": 1.3561352493142562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05567598342895508, "StateBufferConnector_ms": 0.009530305862426758, "ViewRequirementAgentConnector_ms": 0.38593292236328125}, "num_episodes": 22, "episode_return_max": 1380.0, "episode_return_min": 100.0, "episode_return_mean": 565.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.454011883142186, "num_env_steps_trained_throughput_per_sec": 36.454011883142186, "timesteps_total": 284000, "num_env_steps_sampled_lifetime": 284000, "num_agent_steps_sampled_lifetime": 2840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2840000, "timers": {"training_iteration_time_ms": 110234.73, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110234.681, "sample_time_ms": 2382.504, "learn_time_ms": 107832.587, "learn_throughput": 37.095, "synch_weights_time_ms": 11.076}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 2840000, "num_agent_steps_trained": 2840000}, "done": false, "training_iteration": 71, "trial_id": "57140_00000", "date": "2024-06-27_01-30-23", "timestamp": 1719466223, "time_this_iter_s": 109.73936200141907, "time_total_s": 8149.579383134842, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af436af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8149.579383134842, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 15.525806451612901, "ram_util_percent": 78.51161290322581}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.951964078816616, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.137788301027113, "policy_loss": -0.004227536690968889, "vf_loss": 4.141045393476598, "vf_explained_var": 0.0004947367884988348, "kl": 0.005750782718223992, "entropy": 0.4369678220048118, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 671385.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "env_runners": {"episode_reward_max": 1380.0, "episode_reward_min": 100.0, "episode_reward_mean": 554.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 860.0}, "policy_reward_mean": {"policy_0": 55.49}, "custom_metrics": {}, "hist_stats": {"episode_reward": [815.0, 400.0, 970.0, 830.0, 340.0, 490.0, 640.0, 590.0, 550.0, 350.0, 180.0, 625.0, 180.0, 160.0, 510.0, 1230.0, 1010.0, 200.0, 420.0, 660.0, 430.0, 300.0, 1380.0, 100.0, 360.0, 780.0, 1220.0, 395.0, 280.0, 850.0, 210.0, 1035.0, 190.0, 345.0, 960.0, 440.0, 750.0, 220.0, 890.0, 790.0, 1070.0, 180.0, 235.0, 900.0, 620.0, 350.0, 455.0, 490.0, 570.0, 450.0, 210.0, 480.0, 555.0, 610.0, 520.0, 190.0, 285.0, 630.0, 550.0, 240.0, 800.0, 160.0, 345.0, 840.0, 770.0, 820.0, 640.0, 495.0, 440.0, 490.0, 440.0, 660.0, 400.0, 180.0, 1295.0, 470.0, 830.0, 750.0, 210.0, 150.0, 480.0, 900.0, 390.0, 740.0, 450.0, 780.0, 875.0, 280.0, 725.0, 220.0, 210.0, 710.0, 1270.0, 420.0, 490.0, 500.0, 320.0, 190.0, 1080.0, 610.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [-10.0, 210.0, 100.0, 20.0, 150.0, 30.0, 180.0, -50.0, 45.0, 140.0, 30.0, 30.0, 50.0, 40.0, 10.0, 40.0, 40.0, 20.0, 80.0, 60.0, 90.0, 180.0, 230.0, 170.0, 20.0, -40.0, 30.0, 70.0, 30.0, 190.0, 190.0, 60.0, 20.0, 380.0, 30.0, 80.0, 40.0, 0.0, 10.0, 20.0, 20.0, 20.0, 10.0, 30.0, 30.0, 20.0, 100.0, 20.0, 90.0, 0.0, 270.0, 40.0, 20.0, 20.0, 0.0, 40.0, 40.0, 20.0, 20.0, 20.0, 20.0, 40.0, 10.0, 40.0, -40.0, 550.0, 10.0, -20.0, 30.0, 0.0, 0.0, 250.0, -20.0, 30.0, 60.0, 170.0, 40.0, 20.0, 40.0, 0.0, 200.0, 30.0, 10.0, 40.0, 90.0, 70.0, 0.0, 20.0, 70.0, 20.0, 40.0, 110.0, 20.0, 0.0, 20.0, 60.0, 20.0, 10.0, 40.0, 30.0, 40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, 0.0, 50.0, 5.0, 10.0, 20.0, 40.0, 10.0, 370.0, 100.0, 0.0, 60.0, 10.0, 20.0, 10.0, 10.0, 10.0, 0.0, 20.0, 40.0, 30.0, 0.0, 40.0, 50.0, 0.0, 10.0, 30.0, 0.0, 10.0, 20.0, 30.0, 0.0, 10.0, 0.0, 0.0, 30.0, 310.0, 10.0, 0.0, 40.0, 60.0, 0.0, 60.0, 40.0, 580.0, 0.0, 10.0, 40.0, 60.0, 20.0, 40.0, 40.0, 400.0, 20.0, 120.0, 20.0, 20.0, 160.0, 70.0, 10.0, 40.0, 0.0, 550.0, 20.0, 10.0, 40.0, 60.0, 0.0, 0.0, 70.0, 10.0, 0.0, -10.0, 20.0, 10.0, 20.0, 30.0, 0.0, 40.0, 40.0, 220.0, 30.0, 10.0, 10.0, 360.0, 30.0, 0.0, 0.0, 70.0, 70.0, 60.0, 60.0, 0.0, 60.0, 0.0, 40.0, 30.0, 70.0, 20.0, 0.0, 0.0, 40.0, 170.0, 10.0, 50.0, 30.0, 20.0, 40.0, 90.0, 0.0, 30.0, 10.0, 20.0, 40.0, -20.0, -20.0, 710.0, 220.0, 110.0, 50.0, 260.0, 5.0, 25.0, 20.0, 20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 40.0, 20.0, 0.0, 20.0, 20.0, 170.0, 0.0, 20.0, 50.0, 280.0, 170.0, 30.0, 30.0, 40.0, 60.0, 40.0, 40.0, 50.0, 40.0, 60.0, 200.0, 30.0, 50.0, 40.0, 190.0, -40.0, 60.0, 630.0, 0.0, 40.0, 30.0, 70.0, 30.0, 170.0, 35.0, 10.0, 0.0, 10.0, 0.0, 30.0, 80.0, 90.0, 30.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 60.0, 560.0, 0.0, 30.0, 0.0, 40.0, 30.0, 80.0, 40.0, 10.0, 30.0, 0.0, 50.0, 0.0, 10.0, 10.0, 10.0, 20.0, 50.0, 30.0, 355.0, 0.0, 60.0, 90.0, 150.0, 50.0, 30.0, 40.0, 150.0, 110.0, 10.0, 30.0, 10.0, 10.0, 10.0, 20.0, 30.0, 20.0, 30.0, 20.0, -5.0, 5.0, 190.0, 20.0, 50.0, 190.0, -20.0, -40.0, -15.0, -30.0, 160.0, 180.0, 170.0, 40.0, 110.0, 120.0, 80.0, 60.0, 10.0, 30.0, 60.0, 20.0, 10.0, 60.0, 250.0, 30.0, 10.0, 0.0, 0.0, 0.0, 20.0, 70.0, 200.0, 30.0, 50.0, 210.0, 60.0, 70.0, 10.0, 30.0, 10.0, 50.0, 0.0, 60.0, 20.0, 30.0, 0.0, 0.0, 0.0, 50.0, 20.0, 60.0, 70.0, 600.0, 80.0, 30.0, 10.0, 20.0, -20.0, 20.0, 0.0, 0.0, 20.0, 460.0, 30.0, 0.0, 10.0, 260.0, 10.0, 0.0, 20.0, 80.0, 650.0, 60.0, 70.0, 30.0, 70.0, 10.0, 30.0, 50.0, 40.0, 0.0, 40.0, 0.0, 0.0, 20.0, 10.0, 30.0, 30.0, 10.0, 20.0, 10.0, 40.0, 30.0, -15.0, 40.0, 0.0, 10.0, 60.0, 40.0, 190.0, 20.0, 320.0, 360.0, 10.0, 160.0, 30.0, -140.0, 0.0, -50.0, 50.0, 110.0, 10.0, 60.0, 40.0, 10.0, 20.0, 40.0, 0.0, 280.0, 40.0, 70.0, 20.0, 180.0, 0.0, 0.0, 0.0, 10.0, 0.0, 30.0, 560.0, 25.0, -15.0, 10.0, 10.0, -30.0, -30.0, 5.0, -90.0, 10.0, 20.0, -90.0, -90.0, 20.0, -120.0, -80.0, 80.0, -30.0, -80.0, 860.0, 40.0, 40.0, 50.0, 260.0, 10.0, 40.0, 40.0, 30.0, 50.0, 10.0, 50.0, -130.0, 40.0, 40.0, -50.0, 400.0, 10.0, 20.0, 20.0, 50.0, 0.0, -5.0, 40.0, 0.0, 0.0, 30.0, 25.0, 80.0, 30.0, 10.0, 30.0, 50.0, 30.0, 80.0, 40.0, 210.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 220.0, 60.0, 270.0, -30.0, 0.0, -25.0, 30.0, 10.0, 20.0, 20.0, 20.0, -30.0, 20.0, 150.0, 40.0, 60.0, 190.0, 120.0, -50.0, 10.0, 150.0, 0.0, 10.0, 300.0, 20.0, 50.0, 0.0, 30.0, 0.0, 30.0, 0.0, 10.0, 10.0, 30.0, 70.0, 20.0, 20.0, 0.0, 40.0, 10.0, 100.0, 10.0, 30.0, 30.0, 50.0, 0.0, -25.0, 40.0, -5.0, 390.0, 40.0, 30.0, 20.0, 90.0, 0.0, 10.0, 15.0, 40.0, 40.0, 80.0, 0.0, 20.0, 10.0, 70.0, 30.0, 80.0, 160.0, 60.0, 40.0, 50.0, 30.0, 20.0, 0.0, 0.0, 10.0, 40.0, 40.0, 10.0, 0.0, 20.0, 50.0, 80.0, 130.0, 370.0, 90.0, 40.0, -20.0, 40.0, 0.0, 30.0, 60.0, 0.0, 10.0, 20.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 210.0, 15.0, 30.0, 70.0, 0.0, 10.0, 100.0, 260.0, 60.0, -20.0, -5.0, 5.0, 80.0, 180.0, 170.0, 50.0, 70.0, 250.0, 110.0, 60.0, 20.0, 10.0, 160.0, 0.0, 40.0, 20.0, 50.0, 60.0, 10.0, 10.0, 60.0, 40.0, 30.0, 60.0, 480.0, 20.0, 90.0, 260.0, 20.0, 20.0, 40.0, 40.0, 70.0, 20.0, 60.0, 0.0, 290.0, 0.0, -25.0, 20.0, 30.0, 110.0, 20.0, 10.0, 40.0, 30.0, 380.0, -30.0, 0.0, 20.0, 30.0, -50.0, 10.0, 30.0, 20.0, 50.0, 10.0, 30.0, 20.0, 0.0, 30.0, 160.0, 80.0, 60.0, 50.0, 40.0, 60.0, 60.0, 40.0, 40.0, 40.0, 40.0, 10.0, 70.0, 40.0, 20.0, 350.0, 20.0, 40.0, 100.0, 30.0, 10.0, 10.0, 20.0, 60.0, 0.0, 120.0, 80.0, 10.0, 40.0, 30.0, 20.0, 80.0, 20.0, 0.0, 40.0, 20.0, 0.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 50.0, 20.0, 25.0, 60.0, 40.0, 210.0, -20.0, 20.0, 40.0, 850.0, 80.0, 80.0, 10.0, 0.0, 70.0, 40.0, 40.0, 110.0, 20.0, 20.0, 20.0, 10.0, 40.0, 40.0, 30.0, 40.0, 170.0, 20.0, 80.0, 380.0, 40.0, 70.0, 60.0, 80.0, 20.0, 170.0, 40.0, 190.0, 60.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 40.0, 40.0, 40.0, 30.0, 50.0, 0.0, 30.0, 0.0, 10.0, 10.0, 0.0, 30.0, 20.0, 10.0, 40.0, 10.0, 0.0, 20.0, 40.0, 60.0, 30.0, 10.0, 20.0, 290.0, 0.0, 60.0, 30.0, 370.0, 190.0, 40.0, 50.0, 50.0, 40.0, 40.0, 30.0, 30.0, 30.0, 0.0, 0.0, 50.0, 80.0, 60.0, 20.0, 30.0, 90.0, 20.0, 30.0, 60.0, 230.0, 90.0, 70.0, 10.0, 20.0, 60.0, 150.0, 0.0, 20.0, 30.0, 20.0, 10.0, 20.0, 20.0, 120.0, 190.0, 20.0, 10.0, 0.0, 100.0, 100.0, 0.0, 180.0, 20.0, 50.0, 40.0, 280.0, 50.0, 40.0, 50.0, 560.0, 30.0, 120.0, 0.0, 20.0, 40.0, -35.0, 20.0, 90.0, 40.0, 10.0, 10.0, 70.0, 10.0, 20.0, 10.0, 0.0, 100.0, 0.0, 310.0, 20.0, 170.0, 20.0, 90.0, 10.0, -45.0, 50.0, 10.0, 0.0, 70.0, 40.0, 0.0, 40.0, 10.0, 0.0, 10.0, 40.0, 40.0, 30.0, 20.0, 10.0, -10.0, 40.0, 10.0, 30.0, 20.0, 20.0, 80.0, 120.0, 130.0, 0.0, 10.0, 60.0, 60.0, 40.0, 200.0, 10.0, 500.0, 80.0, 100.0, 290.0, 70.0, 10.0, 30.0, 100.0, 30.0, 60.0, 260.0, 20.0, 10.0, 0.0, 10.0, 40.0, 0.0, 0.0, 30.0, 50.0, 60.0, 90.0, 50.0, 20.0, 30.0, 170.0, 0.0, 190.0, -130.0, 10.0, 20.0, 10.0, 410.0, 0.0, 20.0, 0.0, 0.0, 30.0, 10.0, 0.0, 30.0, 20.0, 20.0, 90.0, 30.0, 40.0, 20.0, 30.0, 30.0, 10.0, 10.0, 0.0, 10.0, 60.0, 30.0, 30.0, 10.0, 0.0, 0.0, 40.0, 170.0, 320.0, 20.0, 80.0, 10.0, 170.0, 100.0, 90.0, 270.0, -150.0, 10.0, 10.0, 80.0, 30.0, 40.0, 20.0, 290.0, 60.0, 30.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4839427175881084, "mean_inference_ms": 1.686455332724916, "mean_action_processing_ms": 0.43399986587544165, "mean_env_wait_ms": 1.3539336874877341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05521512031555176, "StateBufferConnector_ms": 0.009386539459228516, "ViewRequirementAgentConnector_ms": 0.38030409812927246}, "num_episodes": 23, "episode_return_max": 1380.0, "episode_return_min": 100.0, "episode_return_mean": 554.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.430448947203764, "num_env_steps_trained_throughput_per_sec": 36.430448947203764, "timesteps_total": 288000, "num_env_steps_sampled_lifetime": 288000, "num_agent_steps_sampled_lifetime": 2880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2880000, "timers": {"training_iteration_time_ms": 110220.385, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110220.336, "sample_time_ms": 2379.223, "learn_time_ms": 107821.524, "learn_throughput": 37.098, "synch_weights_time_ms": 11.047}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 2880000, "num_agent_steps_trained": 2880000}, "done": false, "training_iteration": 72, "trial_id": "57140_00000", "date": "2024-06-27_01-32-13", "timestamp": 1719466333, "time_this_iter_s": 109.80968880653381, "time_total_s": 8259.389071941376, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18e8550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8259.389071941376, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 15.69032258064516, "ram_util_percent": 79.12838709677419}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2096449458211884, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.900388206689121, "policy_loss": -0.005811882881099047, "vf_loss": 4.905009442675736, "vf_explained_var": 0.0006653008750452401, "kl": 0.007055651574469426, "entropy": 0.4124604539590649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 680775.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000}, "env_runners": {"episode_reward_max": 1410.0, "episode_reward_min": 100.0, "episode_reward_mean": 580.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -320.0}, "policy_reward_max": {"policy_0": 860.0}, "policy_reward_mean": {"policy_0": 58.03}, "custom_metrics": {}, "hist_stats": {"episode_reward": [420.0, 660.0, 430.0, 300.0, 1380.0, 100.0, 360.0, 780.0, 1220.0, 395.0, 280.0, 850.0, 210.0, 1035.0, 190.0, 345.0, 960.0, 440.0, 750.0, 220.0, 890.0, 790.0, 1070.0, 180.0, 235.0, 900.0, 620.0, 350.0, 455.0, 490.0, 570.0, 450.0, 210.0, 480.0, 555.0, 610.0, 520.0, 190.0, 285.0, 630.0, 550.0, 240.0, 800.0, 160.0, 345.0, 840.0, 770.0, 820.0, 640.0, 495.0, 440.0, 490.0, 440.0, 660.0, 400.0, 180.0, 1295.0, 470.0, 830.0, 750.0, 210.0, 150.0, 480.0, 900.0, 390.0, 740.0, 450.0, 780.0, 875.0, 280.0, 725.0, 220.0, 210.0, 710.0, 1270.0, 420.0, 490.0, 500.0, 320.0, 190.0, 1080.0, 610.0, 310.0, 710.0, 1180.0, 780.0, 380.0, 760.0, 1200.0, 990.0, 1410.0, 380.0, 460.0, 880.0, 180.0, 740.0, 410.0, 770.0, 390.0, 680.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 10.0, 20.0, 30.0, 0.0, 40.0, 40.0, 220.0, 30.0, 10.0, 10.0, 360.0, 30.0, 0.0, 0.0, 70.0, 70.0, 60.0, 60.0, 0.0, 60.0, 0.0, 40.0, 30.0, 70.0, 20.0, 0.0, 0.0, 40.0, 170.0, 10.0, 50.0, 30.0, 20.0, 40.0, 90.0, 0.0, 30.0, 10.0, 20.0, 40.0, -20.0, -20.0, 710.0, 220.0, 110.0, 50.0, 260.0, 5.0, 25.0, 20.0, 20.0, 10.0, 10.0, 0.0, 10.0, 0.0, 20.0, 10.0, 0.0, 20.0, 40.0, 20.0, 0.0, 20.0, 20.0, 170.0, 0.0, 20.0, 50.0, 280.0, 170.0, 30.0, 30.0, 40.0, 60.0, 40.0, 40.0, 50.0, 40.0, 60.0, 200.0, 30.0, 50.0, 40.0, 190.0, -40.0, 60.0, 630.0, 0.0, 40.0, 30.0, 70.0, 30.0, 170.0, 35.0, 10.0, 0.0, 10.0, 0.0, 30.0, 80.0, 90.0, 30.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 60.0, 560.0, 0.0, 30.0, 0.0, 40.0, 30.0, 80.0, 40.0, 10.0, 30.0, 0.0, 50.0, 0.0, 10.0, 10.0, 10.0, 20.0, 50.0, 30.0, 355.0, 0.0, 60.0, 90.0, 150.0, 50.0, 30.0, 40.0, 150.0, 110.0, 10.0, 30.0, 10.0, 10.0, 10.0, 20.0, 30.0, 20.0, 30.0, 20.0, -5.0, 5.0, 190.0, 20.0, 50.0, 190.0, -20.0, -40.0, -15.0, -30.0, 160.0, 180.0, 170.0, 40.0, 110.0, 120.0, 80.0, 60.0, 10.0, 30.0, 60.0, 20.0, 10.0, 60.0, 250.0, 30.0, 10.0, 0.0, 0.0, 0.0, 20.0, 70.0, 200.0, 30.0, 50.0, 210.0, 60.0, 70.0, 10.0, 30.0, 10.0, 50.0, 0.0, 60.0, 20.0, 30.0, 0.0, 0.0, 0.0, 50.0, 20.0, 60.0, 70.0, 600.0, 80.0, 30.0, 10.0, 20.0, -20.0, 20.0, 0.0, 0.0, 20.0, 460.0, 30.0, 0.0, 10.0, 260.0, 10.0, 0.0, 20.0, 80.0, 650.0, 60.0, 70.0, 30.0, 70.0, 10.0, 30.0, 50.0, 40.0, 0.0, 40.0, 0.0, 0.0, 20.0, 10.0, 30.0, 30.0, 10.0, 20.0, 10.0, 40.0, 30.0, -15.0, 40.0, 0.0, 10.0, 60.0, 40.0, 190.0, 20.0, 320.0, 360.0, 10.0, 160.0, 30.0, -140.0, 0.0, -50.0, 50.0, 110.0, 10.0, 60.0, 40.0, 10.0, 20.0, 40.0, 0.0, 280.0, 40.0, 70.0, 20.0, 180.0, 0.0, 0.0, 0.0, 10.0, 0.0, 30.0, 560.0, 25.0, -15.0, 10.0, 10.0, -30.0, -30.0, 5.0, -90.0, 10.0, 20.0, -90.0, -90.0, 20.0, -120.0, -80.0, 80.0, -30.0, -80.0, 860.0, 40.0, 40.0, 50.0, 260.0, 10.0, 40.0, 40.0, 30.0, 50.0, 10.0, 50.0, -130.0, 40.0, 40.0, -50.0, 400.0, 10.0, 20.0, 20.0, 50.0, 0.0, -5.0, 40.0, 0.0, 0.0, 30.0, 25.0, 80.0, 30.0, 10.0, 30.0, 50.0, 30.0, 80.0, 40.0, 210.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 220.0, 60.0, 270.0, -30.0, 0.0, -25.0, 30.0, 10.0, 20.0, 20.0, 20.0, -30.0, 20.0, 150.0, 40.0, 60.0, 190.0, 120.0, -50.0, 10.0, 150.0, 0.0, 10.0, 300.0, 20.0, 50.0, 0.0, 30.0, 0.0, 30.0, 0.0, 10.0, 10.0, 30.0, 70.0, 20.0, 20.0, 0.0, 40.0, 10.0, 100.0, 10.0, 30.0, 30.0, 50.0, 0.0, -25.0, 40.0, -5.0, 390.0, 40.0, 30.0, 20.0, 90.0, 0.0, 10.0, 15.0, 40.0, 40.0, 80.0, 0.0, 20.0, 10.0, 70.0, 30.0, 80.0, 160.0, 60.0, 40.0, 50.0, 30.0, 20.0, 0.0, 0.0, 10.0, 40.0, 40.0, 10.0, 0.0, 20.0, 50.0, 80.0, 130.0, 370.0, 90.0, 40.0, -20.0, 40.0, 0.0, 30.0, 60.0, 0.0, 10.0, 20.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 210.0, 15.0, 30.0, 70.0, 0.0, 10.0, 100.0, 260.0, 60.0, -20.0, -5.0, 5.0, 80.0, 180.0, 170.0, 50.0, 70.0, 250.0, 110.0, 60.0, 20.0, 10.0, 160.0, 0.0, 40.0, 20.0, 50.0, 60.0, 10.0, 10.0, 60.0, 40.0, 30.0, 60.0, 480.0, 20.0, 90.0, 260.0, 20.0, 20.0, 40.0, 40.0, 70.0, 20.0, 60.0, 0.0, 290.0, 0.0, -25.0, 20.0, 30.0, 110.0, 20.0, 10.0, 40.0, 30.0, 380.0, -30.0, 0.0, 20.0, 30.0, -50.0, 10.0, 30.0, 20.0, 50.0, 10.0, 30.0, 20.0, 0.0, 30.0, 160.0, 80.0, 60.0, 50.0, 40.0, 60.0, 60.0, 40.0, 40.0, 40.0, 40.0, 10.0, 70.0, 40.0, 20.0, 350.0, 20.0, 40.0, 100.0, 30.0, 10.0, 10.0, 20.0, 60.0, 0.0, 120.0, 80.0, 10.0, 40.0, 30.0, 20.0, 80.0, 20.0, 0.0, 40.0, 20.0, 0.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 50.0, 20.0, 25.0, 60.0, 40.0, 210.0, -20.0, 20.0, 40.0, 850.0, 80.0, 80.0, 10.0, 0.0, 70.0, 40.0, 40.0, 110.0, 20.0, 20.0, 20.0, 10.0, 40.0, 40.0, 30.0, 40.0, 170.0, 20.0, 80.0, 380.0, 40.0, 70.0, 60.0, 80.0, 20.0, 170.0, 40.0, 190.0, 60.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 40.0, 40.0, 40.0, 30.0, 50.0, 0.0, 30.0, 0.0, 10.0, 10.0, 0.0, 30.0, 20.0, 10.0, 40.0, 10.0, 0.0, 20.0, 40.0, 60.0, 30.0, 10.0, 20.0, 290.0, 0.0, 60.0, 30.0, 370.0, 190.0, 40.0, 50.0, 50.0, 40.0, 40.0, 30.0, 30.0, 30.0, 0.0, 0.0, 50.0, 80.0, 60.0, 20.0, 30.0, 90.0, 20.0, 30.0, 60.0, 230.0, 90.0, 70.0, 10.0, 20.0, 60.0, 150.0, 0.0, 20.0, 30.0, 20.0, 10.0, 20.0, 20.0, 120.0, 190.0, 20.0, 10.0, 0.0, 100.0, 100.0, 0.0, 180.0, 20.0, 50.0, 40.0, 280.0, 50.0, 40.0, 50.0, 560.0, 30.0, 120.0, 0.0, 20.0, 40.0, -35.0, 20.0, 90.0, 40.0, 10.0, 10.0, 70.0, 10.0, 20.0, 10.0, 0.0, 100.0, 0.0, 310.0, 20.0, 170.0, 20.0, 90.0, 10.0, -45.0, 50.0, 10.0, 0.0, 70.0, 40.0, 0.0, 40.0, 10.0, 0.0, 10.0, 40.0, 40.0, 30.0, 20.0, 10.0, -10.0, 40.0, 10.0, 30.0, 20.0, 20.0, 80.0, 120.0, 130.0, 0.0, 10.0, 60.0, 60.0, 40.0, 200.0, 10.0, 500.0, 80.0, 100.0, 290.0, 70.0, 10.0, 30.0, 100.0, 30.0, 60.0, 260.0, 20.0, 10.0, 0.0, 10.0, 40.0, 0.0, 0.0, 30.0, 50.0, 60.0, 90.0, 50.0, 20.0, 30.0, 170.0, 0.0, 190.0, -130.0, 10.0, 20.0, 10.0, 410.0, 0.0, 20.0, 0.0, 0.0, 30.0, 10.0, 0.0, 30.0, 20.0, 20.0, 90.0, 30.0, 40.0, 20.0, 30.0, 30.0, 10.0, 10.0, 0.0, 10.0, 60.0, 30.0, 30.0, 10.0, 0.0, 0.0, 40.0, 170.0, 320.0, 20.0, 80.0, 10.0, 170.0, 100.0, 90.0, 270.0, -150.0, 10.0, 10.0, 80.0, 30.0, 40.0, 20.0, 290.0, 60.0, 30.0, 40.0, 40.0, 0.0, 0.0, -130.0, 30.0, 150.0, 30.0, 0.0, 170.0, 20.0, 70.0, 40.0, 140.0, 0.0, 0.0, 270.0, 60.0, 60.0, 70.0, 0.0, 70.0, -90.0, 170.0, 150.0, 40.0, 210.0, 10.0, -10.0, 640.0, -10.0, 0.0, 370.0, 0.0, 10.0, 160.0, 160.0, 30.0, -40.0, 30.0, 60.0, 20.0, 0.0, 10.0, 40.0, 0.0, 170.0, 20.0, 40.0, 70.0, 10.0, -10.0, 70.0, 180.0, 30.0, 0.0, 250.0, 80.0, 60.0, 20.0, 80.0, 30.0, 60.0, 20.0, 10.0, 650.0, 10.0, 30.0, 0.0, 50.0, 340.0, 40.0, 45.0, 40.0, 520.0, 160.0, 5.0, 0.0, 20.0, 80.0, 80.0, 130.0, 90.0, 250.0, 200.0, 20.0, 60.0, 40.0, 20.0, 440.0, 160.0, 130.0, 0.0, 10.0, 10.0, 80.0, 30.0, 30.0, 10.0, 40.0, 40.0, 0.0, 10.0, -320.0, 70.0, 30.0, -10.0, 570.0, 30.0, 50.0, 30.0, 130.0, 60.0, -30.0, 30.0, 50.0, -50.0, 180.0, 20.0, 460.0, 30.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 70.0, 40.0, 0.0, 20.0, 30.0, 10.0, 40.0, 20.0, 70.0, 10.0, 450.0, 80.0, 10.0, 20.0, 40.0, 10.0, 20.0, 10.0, 80.0, 50.0, 30.0, 0.0, 140.0, 30.0, 50.0, 0.0, 10.0, 260.0, 160.0, 110.0, 40.0, 30.0, 110.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 30.0, 10.0, 260.0, 10.0, 30.0, 70.0, 20.0, 0.0, 210.0, 40.0, 250.0, 30.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4818419688845461, "mean_inference_ms": 1.6844172592932887, "mean_action_processing_ms": 0.4333607403674973, "mean_env_wait_ms": 1.3522407580708289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05478644371032715, "StateBufferConnector_ms": 0.009423255920410156, "ViewRequirementAgentConnector_ms": 0.38744091987609863}, "num_episodes": 18, "episode_return_max": 1410.0, "episode_return_min": 100.0, "episode_return_mean": 580.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.34453902115627, "num_env_steps_trained_throughput_per_sec": 36.34453902115627, "timesteps_total": 292000, "num_env_steps_sampled_lifetime": 292000, "num_agent_steps_sampled_lifetime": 2920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2920000, "timers": {"training_iteration_time_ms": 110122.948, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110122.897, "sample_time_ms": 2375.826, "learn_time_ms": 107727.702, "learn_throughput": 37.131, "synch_weights_time_ms": 10.827}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 2920000, "num_agent_steps_trained": 2920000}, "done": false, "training_iteration": 73, "trial_id": "57140_00000", "date": "2024-06-27_01-34-03", "timestamp": 1719466443, "time_this_iter_s": 110.07050085067749, "time_total_s": 8369.459572792053, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18e8310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8369.459572792053, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 15.427564102564101, "ram_util_percent": 78.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1545954269469103, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.072955500965302, "policy_loss": -0.0035907925613407003, "vf_loss": 5.075420630295564, "vf_explained_var": 0.0024579597230409535, "kl": 0.006670575138229525, "entropy": 0.42219868641310987, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 690165.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "env_runners": {"episode_reward_max": 1410.0, "episode_reward_min": 150.0, "episode_reward_mean": 594.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -320.0}, "policy_reward_max": {"policy_0": 860.0}, "policy_reward_mean": {"policy_0": 59.465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [750.0, 220.0, 890.0, 790.0, 1070.0, 180.0, 235.0, 900.0, 620.0, 350.0, 455.0, 490.0, 570.0, 450.0, 210.0, 480.0, 555.0, 610.0, 520.0, 190.0, 285.0, 630.0, 550.0, 240.0, 800.0, 160.0, 345.0, 840.0, 770.0, 820.0, 640.0, 495.0, 440.0, 490.0, 440.0, 660.0, 400.0, 180.0, 1295.0, 470.0, 830.0, 750.0, 210.0, 150.0, 480.0, 900.0, 390.0, 740.0, 450.0, 780.0, 875.0, 280.0, 725.0, 220.0, 210.0, 710.0, 1270.0, 420.0, 490.0, 500.0, 320.0, 190.0, 1080.0, 610.0, 310.0, 710.0, 1180.0, 780.0, 380.0, 760.0, 1200.0, 990.0, 1410.0, 380.0, 460.0, 880.0, 180.0, 740.0, 410.0, 770.0, 390.0, 680.0, 670.0, 340.0, 940.0, 750.0, 400.0, 870.0, 640.0, 280.0, 620.0, 1090.0, 1100.0, 670.0, 520.0, 700.0, 380.0, 700.0, 650.0, 470.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 70.0, 200.0, 30.0, 50.0, 210.0, 60.0, 70.0, 10.0, 30.0, 10.0, 50.0, 0.0, 60.0, 20.0, 30.0, 0.0, 0.0, 0.0, 50.0, 20.0, 60.0, 70.0, 600.0, 80.0, 30.0, 10.0, 20.0, -20.0, 20.0, 0.0, 0.0, 20.0, 460.0, 30.0, 0.0, 10.0, 260.0, 10.0, 0.0, 20.0, 80.0, 650.0, 60.0, 70.0, 30.0, 70.0, 10.0, 30.0, 50.0, 40.0, 0.0, 40.0, 0.0, 0.0, 20.0, 10.0, 30.0, 30.0, 10.0, 20.0, 10.0, 40.0, 30.0, -15.0, 40.0, 0.0, 10.0, 60.0, 40.0, 190.0, 20.0, 320.0, 360.0, 10.0, 160.0, 30.0, -140.0, 0.0, -50.0, 50.0, 110.0, 10.0, 60.0, 40.0, 10.0, 20.0, 40.0, 0.0, 280.0, 40.0, 70.0, 20.0, 180.0, 0.0, 0.0, 0.0, 10.0, 0.0, 30.0, 560.0, 25.0, -15.0, 10.0, 10.0, -30.0, -30.0, 5.0, -90.0, 10.0, 20.0, -90.0, -90.0, 20.0, -120.0, -80.0, 80.0, -30.0, -80.0, 860.0, 40.0, 40.0, 50.0, 260.0, 10.0, 40.0, 40.0, 30.0, 50.0, 10.0, 50.0, -130.0, 40.0, 40.0, -50.0, 400.0, 10.0, 20.0, 20.0, 50.0, 0.0, -5.0, 40.0, 0.0, 0.0, 30.0, 25.0, 80.0, 30.0, 10.0, 30.0, 50.0, 30.0, 80.0, 40.0, 210.0, 20.0, 20.0, 0.0, 0.0, 0.0, 20.0, 220.0, 60.0, 270.0, -30.0, 0.0, -25.0, 30.0, 10.0, 20.0, 20.0, 20.0, -30.0, 20.0, 150.0, 40.0, 60.0, 190.0, 120.0, -50.0, 10.0, 150.0, 0.0, 10.0, 300.0, 20.0, 50.0, 0.0, 30.0, 0.0, 30.0, 0.0, 10.0, 10.0, 30.0, 70.0, 20.0, 20.0, 0.0, 40.0, 10.0, 100.0, 10.0, 30.0, 30.0, 50.0, 0.0, -25.0, 40.0, -5.0, 390.0, 40.0, 30.0, 20.0, 90.0, 0.0, 10.0, 15.0, 40.0, 40.0, 80.0, 0.0, 20.0, 10.0, 70.0, 30.0, 80.0, 160.0, 60.0, 40.0, 50.0, 30.0, 20.0, 0.0, 0.0, 10.0, 40.0, 40.0, 10.0, 0.0, 20.0, 50.0, 80.0, 130.0, 370.0, 90.0, 40.0, -20.0, 40.0, 0.0, 30.0, 60.0, 0.0, 10.0, 20.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 210.0, 15.0, 30.0, 70.0, 0.0, 10.0, 100.0, 260.0, 60.0, -20.0, -5.0, 5.0, 80.0, 180.0, 170.0, 50.0, 70.0, 250.0, 110.0, 60.0, 20.0, 10.0, 160.0, 0.0, 40.0, 20.0, 50.0, 60.0, 10.0, 10.0, 60.0, 40.0, 30.0, 60.0, 480.0, 20.0, 90.0, 260.0, 20.0, 20.0, 40.0, 40.0, 70.0, 20.0, 60.0, 0.0, 290.0, 0.0, -25.0, 20.0, 30.0, 110.0, 20.0, 10.0, 40.0, 30.0, 380.0, -30.0, 0.0, 20.0, 30.0, -50.0, 10.0, 30.0, 20.0, 50.0, 10.0, 30.0, 20.0, 0.0, 30.0, 160.0, 80.0, 60.0, 50.0, 40.0, 60.0, 60.0, 40.0, 40.0, 40.0, 40.0, 10.0, 70.0, 40.0, 20.0, 350.0, 20.0, 40.0, 100.0, 30.0, 10.0, 10.0, 20.0, 60.0, 0.0, 120.0, 80.0, 10.0, 40.0, 30.0, 20.0, 80.0, 20.0, 0.0, 40.0, 20.0, 0.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 50.0, 20.0, 25.0, 60.0, 40.0, 210.0, -20.0, 20.0, 40.0, 850.0, 80.0, 80.0, 10.0, 0.0, 70.0, 40.0, 40.0, 110.0, 20.0, 20.0, 20.0, 10.0, 40.0, 40.0, 30.0, 40.0, 170.0, 20.0, 80.0, 380.0, 40.0, 70.0, 60.0, 80.0, 20.0, 170.0, 40.0, 190.0, 60.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 40.0, 40.0, 40.0, 30.0, 50.0, 0.0, 30.0, 0.0, 10.0, 10.0, 0.0, 30.0, 20.0, 10.0, 40.0, 10.0, 0.0, 20.0, 40.0, 60.0, 30.0, 10.0, 20.0, 290.0, 0.0, 60.0, 30.0, 370.0, 190.0, 40.0, 50.0, 50.0, 40.0, 40.0, 30.0, 30.0, 30.0, 0.0, 0.0, 50.0, 80.0, 60.0, 20.0, 30.0, 90.0, 20.0, 30.0, 60.0, 230.0, 90.0, 70.0, 10.0, 20.0, 60.0, 150.0, 0.0, 20.0, 30.0, 20.0, 10.0, 20.0, 20.0, 120.0, 190.0, 20.0, 10.0, 0.0, 100.0, 100.0, 0.0, 180.0, 20.0, 50.0, 40.0, 280.0, 50.0, 40.0, 50.0, 560.0, 30.0, 120.0, 0.0, 20.0, 40.0, -35.0, 20.0, 90.0, 40.0, 10.0, 10.0, 70.0, 10.0, 20.0, 10.0, 0.0, 100.0, 0.0, 310.0, 20.0, 170.0, 20.0, 90.0, 10.0, -45.0, 50.0, 10.0, 0.0, 70.0, 40.0, 0.0, 40.0, 10.0, 0.0, 10.0, 40.0, 40.0, 30.0, 20.0, 10.0, -10.0, 40.0, 10.0, 30.0, 20.0, 20.0, 80.0, 120.0, 130.0, 0.0, 10.0, 60.0, 60.0, 40.0, 200.0, 10.0, 500.0, 80.0, 100.0, 290.0, 70.0, 10.0, 30.0, 100.0, 30.0, 60.0, 260.0, 20.0, 10.0, 0.0, 10.0, 40.0, 0.0, 0.0, 30.0, 50.0, 60.0, 90.0, 50.0, 20.0, 30.0, 170.0, 0.0, 190.0, -130.0, 10.0, 20.0, 10.0, 410.0, 0.0, 20.0, 0.0, 0.0, 30.0, 10.0, 0.0, 30.0, 20.0, 20.0, 90.0, 30.0, 40.0, 20.0, 30.0, 30.0, 10.0, 10.0, 0.0, 10.0, 60.0, 30.0, 30.0, 10.0, 0.0, 0.0, 40.0, 170.0, 320.0, 20.0, 80.0, 10.0, 170.0, 100.0, 90.0, 270.0, -150.0, 10.0, 10.0, 80.0, 30.0, 40.0, 20.0, 290.0, 60.0, 30.0, 40.0, 40.0, 0.0, 0.0, -130.0, 30.0, 150.0, 30.0, 0.0, 170.0, 20.0, 70.0, 40.0, 140.0, 0.0, 0.0, 270.0, 60.0, 60.0, 70.0, 0.0, 70.0, -90.0, 170.0, 150.0, 40.0, 210.0, 10.0, -10.0, 640.0, -10.0, 0.0, 370.0, 0.0, 10.0, 160.0, 160.0, 30.0, -40.0, 30.0, 60.0, 20.0, 0.0, 10.0, 40.0, 0.0, 170.0, 20.0, 40.0, 70.0, 10.0, -10.0, 70.0, 180.0, 30.0, 0.0, 250.0, 80.0, 60.0, 20.0, 80.0, 30.0, 60.0, 20.0, 10.0, 650.0, 10.0, 30.0, 0.0, 50.0, 340.0, 40.0, 45.0, 40.0, 520.0, 160.0, 5.0, 0.0, 20.0, 80.0, 80.0, 130.0, 90.0, 250.0, 200.0, 20.0, 60.0, 40.0, 20.0, 440.0, 160.0, 130.0, 0.0, 10.0, 10.0, 80.0, 30.0, 30.0, 10.0, 40.0, 40.0, 0.0, 10.0, -320.0, 70.0, 30.0, -10.0, 570.0, 30.0, 50.0, 30.0, 130.0, 60.0, -30.0, 30.0, 50.0, -50.0, 180.0, 20.0, 460.0, 30.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 70.0, 40.0, 0.0, 20.0, 30.0, 10.0, 40.0, 20.0, 70.0, 10.0, 450.0, 80.0, 10.0, 20.0, 40.0, 10.0, 20.0, 10.0, 80.0, 50.0, 30.0, 0.0, 140.0, 30.0, 50.0, 0.0, 10.0, 260.0, 160.0, 110.0, 40.0, 30.0, 110.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 30.0, 10.0, 260.0, 10.0, 30.0, 70.0, 20.0, 0.0, 210.0, 40.0, 250.0, 30.0, 20.0, 90.0, 390.0, 20.0, 70.0, 30.0, 0.0, 20.0, 20.0, 30.0, 0.0, 20.0, 0.0, 10.0, 50.0, 40.0, 0.0, 10.0, 30.0, 20.0, 160.0, 90.0, 20.0, -100.0, 30.0, 50.0, 10.0, 10.0, 20.0, 120.0, 690.0, -50.0, 90.0, 60.0, 10.0, 60.0, 30.0, 300.0, 10.0, 220.0, 20.0, 60.0, 20.0, 20.0, 40.0, 10.0, 160.0, 0.0, 70.0, 0.0, 20.0, 310.0, 30.0, 80.0, 260.0, 90.0, 0.0, 10.0, 40.0, 30.0, 20.0, 20.0, 190.0, 130.0, 40.0, 20.0, 30.0, 50.0, 30.0, 110.0, 20.0, 0.0, 0.0, 40.0, 80.0, 40.0, 50.0, 0.0, 0.0, 50.0, 20.0, 90.0, 100.0, 40.0, 30.0, 10.0, 70.0, 40.0, 20.0, 30.0, 190.0, 260.0, 70.0, 60.0, 270.0, 250.0, 70.0, -50.0, 50.0, 60.0, 50.0, 30.0, 30.0, 150.0, 90.0, 410.0, 90.0, 180.0, 30.0, 40.0, 50.0, 30.0, 90.0, 190.0, 50.0, 10.0, 60.0, 10.0, 150.0, 40.0, 40.0, -10.0, 50.0, 60.0, 40.0, 80.0, 70.0, 10.0, 170.0, 50.0, 0.0, 40.0, 40.0, 80.0, 0.0, 50.0, 60.0, 150.0, 250.0, 10.0, 20.0, 30.0, 70.0, 40.0, 30.0, 20.0, 10.0, 60.0, 20.0, 60.0, 40.0, 280.0, 20.0, 30.0, -30.0, 30.0, 170.0, 70.0, -10.0, -10.0, 150.0, 70.0, 400.0, 40.0, 100.0, 30.0, 20.0, 10.0, 10.0, -30.0, 0.0, 0.0, 60.0, 40.0, 30.0, 40.0, 100.0, 20.0, 0.0, 180.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4800267232379598, "mean_inference_ms": 1.6826930761968595, "mean_action_processing_ms": 0.43409414123136053, "mean_env_wait_ms": 1.3506546341979413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055529117584228516, "StateBufferConnector_ms": 0.009522438049316406, "ViewRequirementAgentConnector_ms": 0.3966062068939209}, "num_episodes": 18, "episode_return_max": 1410.0, "episode_return_min": 150.0, "episode_return_mean": 594.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 35.9628131936309, "num_env_steps_trained_throughput_per_sec": 35.9628131936309, "timesteps_total": 296000, "num_env_steps_sampled_lifetime": 296000, "num_agent_steps_sampled_lifetime": 2960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 2960000, "timers": {"training_iteration_time_ms": 110277.029, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110276.979, "sample_time_ms": 2414.442, "learn_time_ms": 107843.045, "learn_throughput": 37.091, "synch_weights_time_ms": 10.868}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 2960000, "num_agent_steps_trained": 2960000}, "done": false, "training_iteration": 74, "trial_id": "57140_00000", "date": "2024-06-27_01-35-54", "timestamp": 1719466554, "time_this_iter_s": 111.24119091033936, "time_total_s": 8480.700763702393, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af3e6700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8480.700763702393, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 16.527388535031847, "ram_util_percent": 78.28407643312102}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1350583794906624, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.820545730880275, "policy_loss": -0.003184463576358149, "vf_loss": 4.822652220700623, "vf_explained_var": 0.003162589577186349, "kl": 0.006387972001031776, "entropy": 0.44509102538053474, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 699555.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000}, "env_runners": {"episode_reward_max": 1410.0, "episode_reward_min": 150.0, "episode_reward_mean": 628.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -320.0}, "policy_reward_max": {"policy_0": 850.0}, "policy_reward_mean": {"policy_0": 62.89}, "custom_metrics": {}, "hist_stats": {"episode_reward": [550.0, 240.0, 800.0, 160.0, 345.0, 840.0, 770.0, 820.0, 640.0, 495.0, 440.0, 490.0, 440.0, 660.0, 400.0, 180.0, 1295.0, 470.0, 830.0, 750.0, 210.0, 150.0, 480.0, 900.0, 390.0, 740.0, 450.0, 780.0, 875.0, 280.0, 725.0, 220.0, 210.0, 710.0, 1270.0, 420.0, 490.0, 500.0, 320.0, 190.0, 1080.0, 610.0, 310.0, 710.0, 1180.0, 780.0, 380.0, 760.0, 1200.0, 990.0, 1410.0, 380.0, 460.0, 880.0, 180.0, 740.0, 410.0, 770.0, 390.0, 680.0, 670.0, 340.0, 940.0, 750.0, 400.0, 870.0, 640.0, 280.0, 620.0, 1090.0, 1100.0, 670.0, 520.0, 700.0, 380.0, 700.0, 650.0, 470.0, 350.0, 840.0, 260.0, 285.0, 1040.0, 590.0, 1200.0, 350.0, 930.0, 420.0, 240.0, 660.0, 190.0, 1390.0, 550.0, 480.0, 950.0, 590.0, 570.0, 935.0, 1135.0, 920.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 80.0, 0.0, 20.0, 10.0, 70.0, 30.0, 80.0, 160.0, 60.0, 40.0, 50.0, 30.0, 20.0, 0.0, 0.0, 10.0, 40.0, 40.0, 10.0, 0.0, 20.0, 50.0, 80.0, 130.0, 370.0, 90.0, 40.0, -20.0, 40.0, 0.0, 30.0, 60.0, 0.0, 10.0, 20.0, 40.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 210.0, 15.0, 30.0, 70.0, 0.0, 10.0, 100.0, 260.0, 60.0, -20.0, -5.0, 5.0, 80.0, 180.0, 170.0, 50.0, 70.0, 250.0, 110.0, 60.0, 20.0, 10.0, 160.0, 0.0, 40.0, 20.0, 50.0, 60.0, 10.0, 10.0, 60.0, 40.0, 30.0, 60.0, 480.0, 20.0, 90.0, 260.0, 20.0, 20.0, 40.0, 40.0, 70.0, 20.0, 60.0, 0.0, 290.0, 0.0, -25.0, 20.0, 30.0, 110.0, 20.0, 10.0, 40.0, 30.0, 380.0, -30.0, 0.0, 20.0, 30.0, -50.0, 10.0, 30.0, 20.0, 50.0, 10.0, 30.0, 20.0, 0.0, 30.0, 160.0, 80.0, 60.0, 50.0, 40.0, 60.0, 60.0, 40.0, 40.0, 40.0, 40.0, 10.0, 70.0, 40.0, 20.0, 350.0, 20.0, 40.0, 100.0, 30.0, 10.0, 10.0, 20.0, 60.0, 0.0, 120.0, 80.0, 10.0, 40.0, 30.0, 20.0, 80.0, 20.0, 0.0, 40.0, 20.0, 0.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 20.0, 50.0, 20.0, 25.0, 60.0, 40.0, 210.0, -20.0, 20.0, 40.0, 850.0, 80.0, 80.0, 10.0, 0.0, 70.0, 40.0, 40.0, 110.0, 20.0, 20.0, 20.0, 10.0, 40.0, 40.0, 30.0, 40.0, 170.0, 20.0, 80.0, 380.0, 40.0, 70.0, 60.0, 80.0, 20.0, 170.0, 40.0, 190.0, 60.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 40.0, 40.0, 40.0, 30.0, 50.0, 0.0, 30.0, 0.0, 10.0, 10.0, 0.0, 30.0, 20.0, 10.0, 40.0, 10.0, 0.0, 20.0, 40.0, 60.0, 30.0, 10.0, 20.0, 290.0, 0.0, 60.0, 30.0, 370.0, 190.0, 40.0, 50.0, 50.0, 40.0, 40.0, 30.0, 30.0, 30.0, 0.0, 0.0, 50.0, 80.0, 60.0, 20.0, 30.0, 90.0, 20.0, 30.0, 60.0, 230.0, 90.0, 70.0, 10.0, 20.0, 60.0, 150.0, 0.0, 20.0, 30.0, 20.0, 10.0, 20.0, 20.0, 120.0, 190.0, 20.0, 10.0, 0.0, 100.0, 100.0, 0.0, 180.0, 20.0, 50.0, 40.0, 280.0, 50.0, 40.0, 50.0, 560.0, 30.0, 120.0, 0.0, 20.0, 40.0, -35.0, 20.0, 90.0, 40.0, 10.0, 10.0, 70.0, 10.0, 20.0, 10.0, 0.0, 100.0, 0.0, 310.0, 20.0, 170.0, 20.0, 90.0, 10.0, -45.0, 50.0, 10.0, 0.0, 70.0, 40.0, 0.0, 40.0, 10.0, 0.0, 10.0, 40.0, 40.0, 30.0, 20.0, 10.0, -10.0, 40.0, 10.0, 30.0, 20.0, 20.0, 80.0, 120.0, 130.0, 0.0, 10.0, 60.0, 60.0, 40.0, 200.0, 10.0, 500.0, 80.0, 100.0, 290.0, 70.0, 10.0, 30.0, 100.0, 30.0, 60.0, 260.0, 20.0, 10.0, 0.0, 10.0, 40.0, 0.0, 0.0, 30.0, 50.0, 60.0, 90.0, 50.0, 20.0, 30.0, 170.0, 0.0, 190.0, -130.0, 10.0, 20.0, 10.0, 410.0, 0.0, 20.0, 0.0, 0.0, 30.0, 10.0, 0.0, 30.0, 20.0, 20.0, 90.0, 30.0, 40.0, 20.0, 30.0, 30.0, 10.0, 10.0, 0.0, 10.0, 60.0, 30.0, 30.0, 10.0, 0.0, 0.0, 40.0, 170.0, 320.0, 20.0, 80.0, 10.0, 170.0, 100.0, 90.0, 270.0, -150.0, 10.0, 10.0, 80.0, 30.0, 40.0, 20.0, 290.0, 60.0, 30.0, 40.0, 40.0, 0.0, 0.0, -130.0, 30.0, 150.0, 30.0, 0.0, 170.0, 20.0, 70.0, 40.0, 140.0, 0.0, 0.0, 270.0, 60.0, 60.0, 70.0, 0.0, 70.0, -90.0, 170.0, 150.0, 40.0, 210.0, 10.0, -10.0, 640.0, -10.0, 0.0, 370.0, 0.0, 10.0, 160.0, 160.0, 30.0, -40.0, 30.0, 60.0, 20.0, 0.0, 10.0, 40.0, 0.0, 170.0, 20.0, 40.0, 70.0, 10.0, -10.0, 70.0, 180.0, 30.0, 0.0, 250.0, 80.0, 60.0, 20.0, 80.0, 30.0, 60.0, 20.0, 10.0, 650.0, 10.0, 30.0, 0.0, 50.0, 340.0, 40.0, 45.0, 40.0, 520.0, 160.0, 5.0, 0.0, 20.0, 80.0, 80.0, 130.0, 90.0, 250.0, 200.0, 20.0, 60.0, 40.0, 20.0, 440.0, 160.0, 130.0, 0.0, 10.0, 10.0, 80.0, 30.0, 30.0, 10.0, 40.0, 40.0, 0.0, 10.0, -320.0, 70.0, 30.0, -10.0, 570.0, 30.0, 50.0, 30.0, 130.0, 60.0, -30.0, 30.0, 50.0, -50.0, 180.0, 20.0, 460.0, 30.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 70.0, 40.0, 0.0, 20.0, 30.0, 10.0, 40.0, 20.0, 70.0, 10.0, 450.0, 80.0, 10.0, 20.0, 40.0, 10.0, 20.0, 10.0, 80.0, 50.0, 30.0, 0.0, 140.0, 30.0, 50.0, 0.0, 10.0, 260.0, 160.0, 110.0, 40.0, 30.0, 110.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 30.0, 10.0, 260.0, 10.0, 30.0, 70.0, 20.0, 0.0, 210.0, 40.0, 250.0, 30.0, 20.0, 90.0, 390.0, 20.0, 70.0, 30.0, 0.0, 20.0, 20.0, 30.0, 0.0, 20.0, 0.0, 10.0, 50.0, 40.0, 0.0, 10.0, 30.0, 20.0, 160.0, 90.0, 20.0, -100.0, 30.0, 50.0, 10.0, 10.0, 20.0, 120.0, 690.0, -50.0, 90.0, 60.0, 10.0, 60.0, 30.0, 300.0, 10.0, 220.0, 20.0, 60.0, 20.0, 20.0, 40.0, 10.0, 160.0, 0.0, 70.0, 0.0, 20.0, 310.0, 30.0, 80.0, 260.0, 90.0, 0.0, 10.0, 40.0, 30.0, 20.0, 20.0, 190.0, 130.0, 40.0, 20.0, 30.0, 50.0, 30.0, 110.0, 20.0, 0.0, 0.0, 40.0, 80.0, 40.0, 50.0, 0.0, 0.0, 50.0, 20.0, 90.0, 100.0, 40.0, 30.0, 10.0, 70.0, 40.0, 20.0, 30.0, 190.0, 260.0, 70.0, 60.0, 270.0, 250.0, 70.0, -50.0, 50.0, 60.0, 50.0, 30.0, 30.0, 150.0, 90.0, 410.0, 90.0, 180.0, 30.0, 40.0, 50.0, 30.0, 90.0, 190.0, 50.0, 10.0, 60.0, 10.0, 150.0, 40.0, 40.0, -10.0, 50.0, 60.0, 40.0, 80.0, 70.0, 10.0, 170.0, 50.0, 0.0, 40.0, 40.0, 80.0, 0.0, 50.0, 60.0, 150.0, 250.0, 10.0, 20.0, 30.0, 70.0, 40.0, 30.0, 20.0, 10.0, 60.0, 20.0, 60.0, 40.0, 280.0, 20.0, 30.0, -30.0, 30.0, 170.0, 70.0, -10.0, -10.0, 150.0, 70.0, 400.0, 40.0, 100.0, 30.0, 20.0, 10.0, 10.0, -30.0, 0.0, 0.0, 60.0, 40.0, 30.0, 40.0, 100.0, 20.0, 0.0, 180.0, 0.0, 10.0, 10.0, 30.0, 0.0, 160.0, 40.0, 20.0, 20.0, 60.0, 0.0, 150.0, 560.0, 70.0, 70.0, 30.0, -10.0, 20.0, 50.0, 0.0, -100.0, 20.0, 10.0, 20.0, 90.0, 30.0, 0.0, 30.0, 20.0, 10.0, 30.0, 20.0, 90.0, 40.0, 20.0, 20.0, 20.0, 20.0, 30.0, -5.0, 30.0, 770.0, 20.0, 40.0, 20.0, 10.0, 40.0, 30.0, 40.0, 70.0, 0.0, 40.0, 30.0, 10.0, 250.0, 50.0, 40.0, 0.0, 90.0, 40.0, 40.0, 50.0, 100.0, 0.0, 350.0, 50.0, 210.0, 50.0, 0.0, 360.0, 30.0, 30.0, 40.0, 30.0, 40.0, 30.0, 90.0, 10.0, 0.0, 20.0, 60.0, 90.0, 160.0, 50.0, 30.0, 10.0, 160.0, 50.0, 50.0, 170.0, 160.0, 110.0, 20.0, 160.0, 10.0, 0.0, 40.0, 0.0, 20.0, 40.0, 20.0, 40.0, 10.0, 30.0, 30.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0, 40.0, 360.0, 20.0, 30.0, 40.0, 20.0, 140.0, 0.0, 10.0, 10.0, 0.0, 10.0, 30.0, 10.0, 70.0, 40.0, 20.0, 0.0, 0.0, 120.0, 180.0, 400.0, 80.0, 230.0, 110.0, 70.0, 80.0, 120.0, 0.0, 0.0, 60.0, 80.0, 210.0, 10.0, 70.0, 20.0, 20.0, 20.0, 60.0, 20.0, 30.0, 30.0, 170.0, 40.0, 0.0, 30.0, 0.0, 70.0, 90.0, 30.0, 80.0, 190.0, -250.0, 70.0, 130.0, 480.0, 80.0, 110.0, 30.0, 40.0, 30.0, 30.0, 20.0, 150.0, 20.0, 150.0, 40.0, 10.0, 100.0, 140.0, 60.0, 20.0, 70.0, 90.0, 90.0, 10.0, 50.0, 30.0, 10.0, 80.0, 100.0, 650.0, 0.0, -15.0, 0.0, 50.0, 30.0, 20.0, 20.0, 60.0, 20.0, 120.0, 400.0, 160.0, 10.0, 5.0, 70.0, 80.0, 210.0, 20.0, 250.0, 40.0, 10.0, 10.0, 50.0, 60.0, 270.0, 40.0, 170.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4818041452743405, "mean_inference_ms": 1.6880462797976221, "mean_action_processing_ms": 0.43678919182069975, "mean_env_wait_ms": 1.352084677378603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05781197547912598, "StateBufferConnector_ms": 0.009680032730102539, "ViewRequirementAgentConnector_ms": 0.4028291702270508}, "num_episodes": 22, "episode_return_max": 1410.0, "episode_return_min": 150.0, "episode_return_mean": 628.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.395751033758785, "num_env_steps_trained_throughput_per_sec": 36.395751033758785, "timesteps_total": 300000, "num_env_steps_sampled_lifetime": 300000, "num_agent_steps_sampled_lifetime": 3000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3000000, "timers": {"training_iteration_time_ms": 110268.358, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110268.307, "sample_time_ms": 2423.183, "learn_time_ms": 107825.383, "learn_throughput": 37.097, "synch_weights_time_ms": 11.083}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 3000000, "num_agent_steps_trained": 3000000}, "done": false, "training_iteration": 75, "trial_id": "57140_00000", "date": "2024-06-27_01-37-44", "timestamp": 1719466664, "time_this_iter_s": 109.91608905792236, "time_total_s": 8590.616852760315, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18e8c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8590.616852760315, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 15.332692307692305, "ram_util_percent": 78.95705128205128}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0478147777061237, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9847774488349565, "policy_loss": -0.004464336559007835, "vf_loss": 3.987777158272025, "vf_explained_var": 0.006277345417660519, "kl": 0.008679271015665336, "entropy": 0.4433526279097294, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 708945.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "env_runners": {"episode_reward_max": 1410.0, "episode_reward_min": 120.0, "episode_reward_mean": 615.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -320.0}, "policy_reward_max": {"policy_0": 770.0}, "policy_reward_mean": {"policy_0": 61.595}, "custom_metrics": {}, "hist_stats": {"episode_reward": [830.0, 750.0, 210.0, 150.0, 480.0, 900.0, 390.0, 740.0, 450.0, 780.0, 875.0, 280.0, 725.0, 220.0, 210.0, 710.0, 1270.0, 420.0, 490.0, 500.0, 320.0, 190.0, 1080.0, 610.0, 310.0, 710.0, 1180.0, 780.0, 380.0, 760.0, 1200.0, 990.0, 1410.0, 380.0, 460.0, 880.0, 180.0, 740.0, 410.0, 770.0, 390.0, 680.0, 670.0, 340.0, 940.0, 750.0, 400.0, 870.0, 640.0, 280.0, 620.0, 1090.0, 1100.0, 670.0, 520.0, 700.0, 380.0, 700.0, 650.0, 470.0, 350.0, 840.0, 260.0, 285.0, 1040.0, 590.0, 1200.0, 350.0, 930.0, 420.0, 240.0, 660.0, 190.0, 1390.0, 550.0, 480.0, 950.0, 590.0, 570.0, 935.0, 1135.0, 920.0, 490.0, 700.0, 460.0, 325.0, 360.0, 600.0, 430.0, 370.0, 550.0, 795.0, 320.0, 250.0, 270.0, 610.0, 1120.0, 350.0, 120.0, 620.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 10.0, 40.0, 40.0, 30.0, 40.0, 170.0, 20.0, 80.0, 380.0, 40.0, 70.0, 60.0, 80.0, 20.0, 170.0, 40.0, 190.0, 60.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 40.0, 40.0, 40.0, 30.0, 50.0, 0.0, 30.0, 0.0, 10.0, 10.0, 0.0, 30.0, 20.0, 10.0, 40.0, 10.0, 0.0, 20.0, 40.0, 60.0, 30.0, 10.0, 20.0, 290.0, 0.0, 60.0, 30.0, 370.0, 190.0, 40.0, 50.0, 50.0, 40.0, 40.0, 30.0, 30.0, 30.0, 0.0, 0.0, 50.0, 80.0, 60.0, 20.0, 30.0, 90.0, 20.0, 30.0, 60.0, 230.0, 90.0, 70.0, 10.0, 20.0, 60.0, 150.0, 0.0, 20.0, 30.0, 20.0, 10.0, 20.0, 20.0, 120.0, 190.0, 20.0, 10.0, 0.0, 100.0, 100.0, 0.0, 180.0, 20.0, 50.0, 40.0, 280.0, 50.0, 40.0, 50.0, 560.0, 30.0, 120.0, 0.0, 20.0, 40.0, -35.0, 20.0, 90.0, 40.0, 10.0, 10.0, 70.0, 10.0, 20.0, 10.0, 0.0, 100.0, 0.0, 310.0, 20.0, 170.0, 20.0, 90.0, 10.0, -45.0, 50.0, 10.0, 0.0, 70.0, 40.0, 0.0, 40.0, 10.0, 0.0, 10.0, 40.0, 40.0, 30.0, 20.0, 10.0, -10.0, 40.0, 10.0, 30.0, 20.0, 20.0, 80.0, 120.0, 130.0, 0.0, 10.0, 60.0, 60.0, 40.0, 200.0, 10.0, 500.0, 80.0, 100.0, 290.0, 70.0, 10.0, 30.0, 100.0, 30.0, 60.0, 260.0, 20.0, 10.0, 0.0, 10.0, 40.0, 0.0, 0.0, 30.0, 50.0, 60.0, 90.0, 50.0, 20.0, 30.0, 170.0, 0.0, 190.0, -130.0, 10.0, 20.0, 10.0, 410.0, 0.0, 20.0, 0.0, 0.0, 30.0, 10.0, 0.0, 30.0, 20.0, 20.0, 90.0, 30.0, 40.0, 20.0, 30.0, 30.0, 10.0, 10.0, 0.0, 10.0, 60.0, 30.0, 30.0, 10.0, 0.0, 0.0, 40.0, 170.0, 320.0, 20.0, 80.0, 10.0, 170.0, 100.0, 90.0, 270.0, -150.0, 10.0, 10.0, 80.0, 30.0, 40.0, 20.0, 290.0, 60.0, 30.0, 40.0, 40.0, 0.0, 0.0, -130.0, 30.0, 150.0, 30.0, 0.0, 170.0, 20.0, 70.0, 40.0, 140.0, 0.0, 0.0, 270.0, 60.0, 60.0, 70.0, 0.0, 70.0, -90.0, 170.0, 150.0, 40.0, 210.0, 10.0, -10.0, 640.0, -10.0, 0.0, 370.0, 0.0, 10.0, 160.0, 160.0, 30.0, -40.0, 30.0, 60.0, 20.0, 0.0, 10.0, 40.0, 0.0, 170.0, 20.0, 40.0, 70.0, 10.0, -10.0, 70.0, 180.0, 30.0, 0.0, 250.0, 80.0, 60.0, 20.0, 80.0, 30.0, 60.0, 20.0, 10.0, 650.0, 10.0, 30.0, 0.0, 50.0, 340.0, 40.0, 45.0, 40.0, 520.0, 160.0, 5.0, 0.0, 20.0, 80.0, 80.0, 130.0, 90.0, 250.0, 200.0, 20.0, 60.0, 40.0, 20.0, 440.0, 160.0, 130.0, 0.0, 10.0, 10.0, 80.0, 30.0, 30.0, 10.0, 40.0, 40.0, 0.0, 10.0, -320.0, 70.0, 30.0, -10.0, 570.0, 30.0, 50.0, 30.0, 130.0, 60.0, -30.0, 30.0, 50.0, -50.0, 180.0, 20.0, 460.0, 30.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 70.0, 40.0, 0.0, 20.0, 30.0, 10.0, 40.0, 20.0, 70.0, 10.0, 450.0, 80.0, 10.0, 20.0, 40.0, 10.0, 20.0, 10.0, 80.0, 50.0, 30.0, 0.0, 140.0, 30.0, 50.0, 0.0, 10.0, 260.0, 160.0, 110.0, 40.0, 30.0, 110.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 30.0, 10.0, 260.0, 10.0, 30.0, 70.0, 20.0, 0.0, 210.0, 40.0, 250.0, 30.0, 20.0, 90.0, 390.0, 20.0, 70.0, 30.0, 0.0, 20.0, 20.0, 30.0, 0.0, 20.0, 0.0, 10.0, 50.0, 40.0, 0.0, 10.0, 30.0, 20.0, 160.0, 90.0, 20.0, -100.0, 30.0, 50.0, 10.0, 10.0, 20.0, 120.0, 690.0, -50.0, 90.0, 60.0, 10.0, 60.0, 30.0, 300.0, 10.0, 220.0, 20.0, 60.0, 20.0, 20.0, 40.0, 10.0, 160.0, 0.0, 70.0, 0.0, 20.0, 310.0, 30.0, 80.0, 260.0, 90.0, 0.0, 10.0, 40.0, 30.0, 20.0, 20.0, 190.0, 130.0, 40.0, 20.0, 30.0, 50.0, 30.0, 110.0, 20.0, 0.0, 0.0, 40.0, 80.0, 40.0, 50.0, 0.0, 0.0, 50.0, 20.0, 90.0, 100.0, 40.0, 30.0, 10.0, 70.0, 40.0, 20.0, 30.0, 190.0, 260.0, 70.0, 60.0, 270.0, 250.0, 70.0, -50.0, 50.0, 60.0, 50.0, 30.0, 30.0, 150.0, 90.0, 410.0, 90.0, 180.0, 30.0, 40.0, 50.0, 30.0, 90.0, 190.0, 50.0, 10.0, 60.0, 10.0, 150.0, 40.0, 40.0, -10.0, 50.0, 60.0, 40.0, 80.0, 70.0, 10.0, 170.0, 50.0, 0.0, 40.0, 40.0, 80.0, 0.0, 50.0, 60.0, 150.0, 250.0, 10.0, 20.0, 30.0, 70.0, 40.0, 30.0, 20.0, 10.0, 60.0, 20.0, 60.0, 40.0, 280.0, 20.0, 30.0, -30.0, 30.0, 170.0, 70.0, -10.0, -10.0, 150.0, 70.0, 400.0, 40.0, 100.0, 30.0, 20.0, 10.0, 10.0, -30.0, 0.0, 0.0, 60.0, 40.0, 30.0, 40.0, 100.0, 20.0, 0.0, 180.0, 0.0, 10.0, 10.0, 30.0, 0.0, 160.0, 40.0, 20.0, 20.0, 60.0, 0.0, 150.0, 560.0, 70.0, 70.0, 30.0, -10.0, 20.0, 50.0, 0.0, -100.0, 20.0, 10.0, 20.0, 90.0, 30.0, 0.0, 30.0, 20.0, 10.0, 30.0, 20.0, 90.0, 40.0, 20.0, 20.0, 20.0, 20.0, 30.0, -5.0, 30.0, 770.0, 20.0, 40.0, 20.0, 10.0, 40.0, 30.0, 40.0, 70.0, 0.0, 40.0, 30.0, 10.0, 250.0, 50.0, 40.0, 0.0, 90.0, 40.0, 40.0, 50.0, 100.0, 0.0, 350.0, 50.0, 210.0, 50.0, 0.0, 360.0, 30.0, 30.0, 40.0, 30.0, 40.0, 30.0, 90.0, 10.0, 0.0, 20.0, 60.0, 90.0, 160.0, 50.0, 30.0, 10.0, 160.0, 50.0, 50.0, 170.0, 160.0, 110.0, 20.0, 160.0, 10.0, 0.0, 40.0, 0.0, 20.0, 40.0, 20.0, 40.0, 10.0, 30.0, 30.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0, 40.0, 360.0, 20.0, 30.0, 40.0, 20.0, 140.0, 0.0, 10.0, 10.0, 0.0, 10.0, 30.0, 10.0, 70.0, 40.0, 20.0, 0.0, 0.0, 120.0, 180.0, 400.0, 80.0, 230.0, 110.0, 70.0, 80.0, 120.0, 0.0, 0.0, 60.0, 80.0, 210.0, 10.0, 70.0, 20.0, 20.0, 20.0, 60.0, 20.0, 30.0, 30.0, 170.0, 40.0, 0.0, 30.0, 0.0, 70.0, 90.0, 30.0, 80.0, 190.0, -250.0, 70.0, 130.0, 480.0, 80.0, 110.0, 30.0, 40.0, 30.0, 30.0, 20.0, 150.0, 20.0, 150.0, 40.0, 10.0, 100.0, 140.0, 60.0, 20.0, 70.0, 90.0, 90.0, 10.0, 50.0, 30.0, 10.0, 80.0, 100.0, 650.0, 0.0, -15.0, 0.0, 50.0, 30.0, 20.0, 20.0, 60.0, 20.0, 120.0, 400.0, 160.0, 10.0, 5.0, 70.0, 80.0, 210.0, 20.0, 250.0, 40.0, 10.0, 10.0, 50.0, 60.0, 270.0, 40.0, 170.0, 90.0, 0.0, 60.0, 20.0, 130.0, 40.0, 40.0, 20.0, 30.0, 60.0, 10.0, 60.0, 130.0, 50.0, 10.0, 10.0, 80.0, 190.0, 160.0, 0.0, 0.0, 10.0, 170.0, 40.0, 0.0, 30.0, 120.0, 20.0, 0.0, 70.0, 0.0, 30.0, 50.0, 35.0, 30.0, 20.0, 10.0, 70.0, 30.0, 50.0, 40.0, 50.0, 50.0, 40.0, 60.0, 30.0, 50.0, 40.0, 0.0, 0.0, 60.0, 30.0, 0.0, 40.0, 170.0, 80.0, 40.0, 0.0, 170.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 300.0, 0.0, 40.0, 10.0, 10.0, 60.0, 20.0, 70.0, 70.0, 10.0, 90.0, 190.0, 70.0, 20.0, -230.0, 10.0, 0.0, 80.0, 300.0, 20.0, 10.0, 40.0, 40.0, 0.0, 50.0, 510.0, 20.0, 10.0, 10.0, 80.0, 0.0, 70.0, 45.0, 10.0, 40.0, 0.0, 30.0, 40.0, 0.0, 50.0, 20.0, -60.0, 50.0, 10.0, 180.0, 10.0, 20.0, 0.0, 0.0, 110.0, 10.0, 10.0, 20.0, 40.0, 30.0, 20.0, 30.0, 150.0, 50.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 40.0, 10.0, 80.0, 30.0, 280.0, 60.0, 70.0, 20.0, 10.0, 10.0, 20.0, 110.0, 150.0, 60.0, 90.0, 10.0, 50.0, 90.0, 520.0, 20.0, 60.0, 20.0, 60.0, 60.0, 60.0, 40.0, 20.0, 0.0, 30.0, 0.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 20.0, 10.0, 0.0, 20.0, 40.0, 0.0, 50.0, 60.0, 10.0, 90.0, 40.0, 120.0, 190.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4769017834681384, "mean_inference_ms": 1.6793389181658975, "mean_action_processing_ms": 0.43587262014277117, "mean_env_wait_ms": 1.3477553726307698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056824445724487305, "StateBufferConnector_ms": 0.009333610534667969, "ViewRequirementAgentConnector_ms": 0.3960537910461426}, "num_episodes": 18, "episode_return_max": 1410.0, "episode_return_min": 120.0, "episode_return_mean": 615.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.36329927047604, "num_env_steps_trained_throughput_per_sec": 36.36329927047604, "timesteps_total": 304000, "num_env_steps_sampled_lifetime": 304000, "num_agent_steps_sampled_lifetime": 3040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3040000, "timers": {"training_iteration_time_ms": 110247.301, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110247.25, "sample_time_ms": 2427.93, "learn_time_ms": 107799.711, "learn_throughput": 37.106, "synch_weights_time_ms": 11.209}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 3040000, "num_agent_steps_trained": 3040000}, "done": false, "training_iteration": 76, "trial_id": "57140_00000", "date": "2024-06-27_01-39-34", "timestamp": 1719466774, "time_this_iter_s": 110.01123380661011, "time_total_s": 8700.628086566925, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18e8160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8700.628086566925, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 15.696129032258066, "ram_util_percent": 78.60064516129033}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.230893648441988, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9024251040559226, "policy_loss": -0.004271752135213206, "vf_loss": 3.905581495124565, "vf_explained_var": 0.0006799126712405009, "kl": 0.006609538166179063, "entropy": 0.4365715223411148, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 718335.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000}, "env_runners": {"episode_reward_max": 1410.0, "episode_reward_min": -645.0, "episode_reward_mean": 586.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -840.0}, "policy_reward_max": {"policy_0": 770.0}, "policy_reward_mean": {"policy_0": 58.605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [610.0, 310.0, 710.0, 1180.0, 780.0, 380.0, 760.0, 1200.0, 990.0, 1410.0, 380.0, 460.0, 880.0, 180.0, 740.0, 410.0, 770.0, 390.0, 680.0, 670.0, 340.0, 940.0, 750.0, 400.0, 870.0, 640.0, 280.0, 620.0, 1090.0, 1100.0, 670.0, 520.0, 700.0, 380.0, 700.0, 650.0, 470.0, 350.0, 840.0, 260.0, 285.0, 1040.0, 590.0, 1200.0, 350.0, 930.0, 420.0, 240.0, 660.0, 190.0, 1390.0, 550.0, 480.0, 950.0, 590.0, 570.0, 935.0, 1135.0, 920.0, 490.0, 700.0, 460.0, 325.0, 360.0, 600.0, 430.0, 370.0, 550.0, 795.0, 320.0, 250.0, 270.0, 610.0, 1120.0, 350.0, 120.0, 620.0, 220.0, 560.0, -180.0, 730.0, 950.0, 150.0, 190.0, 150.0, 180.0, 325.0, 980.0, 190.0, 570.0, 290.0, 580.0, -645.0, 370.0, 250.0, 450.0, 1180.0, 510.0, 1015.0, 965.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 10.0, 80.0, 30.0, 40.0, 20.0, 290.0, 60.0, 30.0, 40.0, 40.0, 0.0, 0.0, -130.0, 30.0, 150.0, 30.0, 0.0, 170.0, 20.0, 70.0, 40.0, 140.0, 0.0, 0.0, 270.0, 60.0, 60.0, 70.0, 0.0, 70.0, -90.0, 170.0, 150.0, 40.0, 210.0, 10.0, -10.0, 640.0, -10.0, 0.0, 370.0, 0.0, 10.0, 160.0, 160.0, 30.0, -40.0, 30.0, 60.0, 20.0, 0.0, 10.0, 40.0, 0.0, 170.0, 20.0, 40.0, 70.0, 10.0, -10.0, 70.0, 180.0, 30.0, 0.0, 250.0, 80.0, 60.0, 20.0, 80.0, 30.0, 60.0, 20.0, 10.0, 650.0, 10.0, 30.0, 0.0, 50.0, 340.0, 40.0, 45.0, 40.0, 520.0, 160.0, 5.0, 0.0, 20.0, 80.0, 80.0, 130.0, 90.0, 250.0, 200.0, 20.0, 60.0, 40.0, 20.0, 440.0, 160.0, 130.0, 0.0, 10.0, 10.0, 80.0, 30.0, 30.0, 10.0, 40.0, 40.0, 0.0, 10.0, -320.0, 70.0, 30.0, -10.0, 570.0, 30.0, 50.0, 30.0, 130.0, 60.0, -30.0, 30.0, 50.0, -50.0, 180.0, 20.0, 460.0, 30.0, 0.0, 0.0, 20.0, 0.0, 20.0, 10.0, 70.0, 40.0, 0.0, 20.0, 30.0, 10.0, 40.0, 20.0, 70.0, 10.0, 450.0, 80.0, 10.0, 20.0, 40.0, 10.0, 20.0, 10.0, 80.0, 50.0, 30.0, 0.0, 140.0, 30.0, 50.0, 0.0, 10.0, 260.0, 160.0, 110.0, 40.0, 30.0, 110.0, 0.0, 20.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 30.0, 10.0, 260.0, 10.0, 30.0, 70.0, 20.0, 0.0, 210.0, 40.0, 250.0, 30.0, 20.0, 90.0, 390.0, 20.0, 70.0, 30.0, 0.0, 20.0, 20.0, 30.0, 0.0, 20.0, 0.0, 10.0, 50.0, 40.0, 0.0, 10.0, 30.0, 20.0, 160.0, 90.0, 20.0, -100.0, 30.0, 50.0, 10.0, 10.0, 20.0, 120.0, 690.0, -50.0, 90.0, 60.0, 10.0, 60.0, 30.0, 300.0, 10.0, 220.0, 20.0, 60.0, 20.0, 20.0, 40.0, 10.0, 160.0, 0.0, 70.0, 0.0, 20.0, 310.0, 30.0, 80.0, 260.0, 90.0, 0.0, 10.0, 40.0, 30.0, 20.0, 20.0, 190.0, 130.0, 40.0, 20.0, 30.0, 50.0, 30.0, 110.0, 20.0, 0.0, 0.0, 40.0, 80.0, 40.0, 50.0, 0.0, 0.0, 50.0, 20.0, 90.0, 100.0, 40.0, 30.0, 10.0, 70.0, 40.0, 20.0, 30.0, 190.0, 260.0, 70.0, 60.0, 270.0, 250.0, 70.0, -50.0, 50.0, 60.0, 50.0, 30.0, 30.0, 150.0, 90.0, 410.0, 90.0, 180.0, 30.0, 40.0, 50.0, 30.0, 90.0, 190.0, 50.0, 10.0, 60.0, 10.0, 150.0, 40.0, 40.0, -10.0, 50.0, 60.0, 40.0, 80.0, 70.0, 10.0, 170.0, 50.0, 0.0, 40.0, 40.0, 80.0, 0.0, 50.0, 60.0, 150.0, 250.0, 10.0, 20.0, 30.0, 70.0, 40.0, 30.0, 20.0, 10.0, 60.0, 20.0, 60.0, 40.0, 280.0, 20.0, 30.0, -30.0, 30.0, 170.0, 70.0, -10.0, -10.0, 150.0, 70.0, 400.0, 40.0, 100.0, 30.0, 20.0, 10.0, 10.0, -30.0, 0.0, 0.0, 60.0, 40.0, 30.0, 40.0, 100.0, 20.0, 0.0, 180.0, 0.0, 10.0, 10.0, 30.0, 0.0, 160.0, 40.0, 20.0, 20.0, 60.0, 0.0, 150.0, 560.0, 70.0, 70.0, 30.0, -10.0, 20.0, 50.0, 0.0, -100.0, 20.0, 10.0, 20.0, 90.0, 30.0, 0.0, 30.0, 20.0, 10.0, 30.0, 20.0, 90.0, 40.0, 20.0, 20.0, 20.0, 20.0, 30.0, -5.0, 30.0, 770.0, 20.0, 40.0, 20.0, 10.0, 40.0, 30.0, 40.0, 70.0, 0.0, 40.0, 30.0, 10.0, 250.0, 50.0, 40.0, 0.0, 90.0, 40.0, 40.0, 50.0, 100.0, 0.0, 350.0, 50.0, 210.0, 50.0, 0.0, 360.0, 30.0, 30.0, 40.0, 30.0, 40.0, 30.0, 90.0, 10.0, 0.0, 20.0, 60.0, 90.0, 160.0, 50.0, 30.0, 10.0, 160.0, 50.0, 50.0, 170.0, 160.0, 110.0, 20.0, 160.0, 10.0, 0.0, 40.0, 0.0, 20.0, 40.0, 20.0, 40.0, 10.0, 30.0, 30.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0, 40.0, 360.0, 20.0, 30.0, 40.0, 20.0, 140.0, 0.0, 10.0, 10.0, 0.0, 10.0, 30.0, 10.0, 70.0, 40.0, 20.0, 0.0, 0.0, 120.0, 180.0, 400.0, 80.0, 230.0, 110.0, 70.0, 80.0, 120.0, 0.0, 0.0, 60.0, 80.0, 210.0, 10.0, 70.0, 20.0, 20.0, 20.0, 60.0, 20.0, 30.0, 30.0, 170.0, 40.0, 0.0, 30.0, 0.0, 70.0, 90.0, 30.0, 80.0, 190.0, -250.0, 70.0, 130.0, 480.0, 80.0, 110.0, 30.0, 40.0, 30.0, 30.0, 20.0, 150.0, 20.0, 150.0, 40.0, 10.0, 100.0, 140.0, 60.0, 20.0, 70.0, 90.0, 90.0, 10.0, 50.0, 30.0, 10.0, 80.0, 100.0, 650.0, 0.0, -15.0, 0.0, 50.0, 30.0, 20.0, 20.0, 60.0, 20.0, 120.0, 400.0, 160.0, 10.0, 5.0, 70.0, 80.0, 210.0, 20.0, 250.0, 40.0, 10.0, 10.0, 50.0, 60.0, 270.0, 40.0, 170.0, 90.0, 0.0, 60.0, 20.0, 130.0, 40.0, 40.0, 20.0, 30.0, 60.0, 10.0, 60.0, 130.0, 50.0, 10.0, 10.0, 80.0, 190.0, 160.0, 0.0, 0.0, 10.0, 170.0, 40.0, 0.0, 30.0, 120.0, 20.0, 0.0, 70.0, 0.0, 30.0, 50.0, 35.0, 30.0, 20.0, 10.0, 70.0, 30.0, 50.0, 40.0, 50.0, 50.0, 40.0, 60.0, 30.0, 50.0, 40.0, 0.0, 0.0, 60.0, 30.0, 0.0, 40.0, 170.0, 80.0, 40.0, 0.0, 170.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 300.0, 0.0, 40.0, 10.0, 10.0, 60.0, 20.0, 70.0, 70.0, 10.0, 90.0, 190.0, 70.0, 20.0, -230.0, 10.0, 0.0, 80.0, 300.0, 20.0, 10.0, 40.0, 40.0, 0.0, 50.0, 510.0, 20.0, 10.0, 10.0, 80.0, 0.0, 70.0, 45.0, 10.0, 40.0, 0.0, 30.0, 40.0, 0.0, 50.0, 20.0, -60.0, 50.0, 10.0, 180.0, 10.0, 20.0, 0.0, 0.0, 110.0, 10.0, 10.0, 20.0, 40.0, 30.0, 20.0, 30.0, 150.0, 50.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 40.0, 10.0, 80.0, 30.0, 280.0, 60.0, 70.0, 20.0, 10.0, 10.0, 20.0, 110.0, 150.0, 60.0, 90.0, 10.0, 50.0, 90.0, 520.0, 20.0, 60.0, 20.0, 60.0, 60.0, 60.0, 40.0, 20.0, 0.0, 30.0, 0.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 20.0, 10.0, 0.0, 20.0, 40.0, 0.0, 50.0, 60.0, 10.0, 90.0, 40.0, 120.0, 190.0, 20.0, 10.0, 30.0, 40.0, 0.0, 40.0, 10.0, 20.0, 30.0, 20.0, 20.0, 10.0, 0.0, 10.0, 250.0, 160.0, 20.0, 40.0, 30.0, 20.0, 30.0, 20.0, 30.0, -165.0, 20.0, -155.0, 0.0, 0.0, 10.0, 30.0, 40.0, 40.0, 10.0, 40.0, 20.0, 10.0, 20.0, 130.0, 350.0, 70.0, 0.0, 0.0, 10.0, 70.0, 0.0, 760.0, 0.0, 40.0, 70.0, 0.0, 10.0, 20.0, 60.0, 0.0, 30.0, 10.0, 10.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 0.0, 30.0, 0.0, 100.0, 0.0, 10.0, 0.0, 30.0, 10.0, 0.0, 50.0, 30.0, 20.0, 0.0, 0.0, 30.0, 0.0, 20.0, 0.0, 20.0, 30.0, 20.0, 10.0, 10.0, 40.0, 20.0, 10.0, 10.0, 35.0, 160.0, 20.0, 10.0, 0.0, 30.0, 30.0, 30.0, 20.0, 110.0, 20.0, 50.0, 40.0, 40.0, 590.0, 30.0, 50.0, 20.0, 30.0, 30.0, 20.0, 40.0, 10.0, 0.0, 20.0, 20.0, 0.0, 40.0, 300.0, 10.0, 0.0, -50.0, 20.0, 50.0, 40.0, 90.0, 70.0, 0.0, 20.0, 10.0, 150.0, 0.0, 60.0, 30.0, 0.0, 0.0, 20.0, 160.0, 110.0, 40.0, 30.0, 100.0, 30.0, 10.0, 40.0, 10.0, 50.0, 0.0, 0.0, 30.0, 70.0, 5.0, -840.0, 40.0, 30.0, 20.0, 0.0, 20.0, 10.0, 10.0, 70.0, 0.0, 30.0, 180.0, 20.0, 30.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 30.0, 40.0, 40.0, 50.0, 0.0, 220.0, 20.0, 120.0, 20.0, 0.0, 10.0, 20.0, 30.0, 10.0, 20.0, -10.0, 520.0, 30.0, 20.0, -10.0, 60.0, 100.0, 380.0, 70.0, 0.0, 5.0, 70.0, 40.0, 35.0, 0.0, 50.0, 20.0, 40.0, 250.0, 10.0, 40.0, 30.0, 60.0, 50.0, 220.0, -5.0, 570.0, 40.0, 0.0, 110.0, 20.0, 40.0, -5.0, 20.0, 90.0, 60.0, 570.0, 30.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.475112390491415, "mean_inference_ms": 1.677673580236226, "mean_action_processing_ms": 0.4368998865228992, "mean_env_wait_ms": 1.3462333195712721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05786728858947754, "StateBufferConnector_ms": 0.009402990341186523, "ViewRequirementAgentConnector_ms": 0.39443540573120117}, "num_episodes": 23, "episode_return_max": 1410.0, "episode_return_min": -645.0, "episode_return_mean": 586.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.40040596702348, "num_env_steps_trained_throughput_per_sec": 36.40040596702348, "timesteps_total": 308000, "num_env_steps_sampled_lifetime": 308000, "num_agent_steps_sampled_lifetime": 3080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3080000, "timers": {"training_iteration_time_ms": 110284.091, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110284.039, "sample_time_ms": 2427.406, "learn_time_ms": 107837.256, "learn_throughput": 37.093, "synch_weights_time_ms": 10.991}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 3080000, "num_agent_steps_trained": 3080000}, "done": false, "training_iteration": 77, "trial_id": "57140_00000", "date": "2024-06-27_01-41-24", "timestamp": 1719466884, "time_this_iter_s": 109.90187692642212, "time_total_s": 8810.529963493347, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18e1700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8810.529963493347, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 15.396153846153844, "ram_util_percent": 78.95641025641027}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.164587317469021, "cur_kl_coeff": 0.16875, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0034699016595824647, "vf_loss": 4.357537306383395, "vf_explained_var": 0.0007244472305614727, "kl": Infinity, "entropy": 0.4300819940619067, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 727725.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "env_runners": {"episode_reward_max": 1390.0, "episode_reward_min": -645.0, "episode_reward_mean": 556.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -840.0}, "policy_reward_max": {"policy_0": 770.0}, "policy_reward_mean": {"policy_0": 55.665}, "custom_metrics": {}, "hist_stats": {"episode_reward": [680.0, 670.0, 340.0, 940.0, 750.0, 400.0, 870.0, 640.0, 280.0, 620.0, 1090.0, 1100.0, 670.0, 520.0, 700.0, 380.0, 700.0, 650.0, 470.0, 350.0, 840.0, 260.0, 285.0, 1040.0, 590.0, 1200.0, 350.0, 930.0, 420.0, 240.0, 660.0, 190.0, 1390.0, 550.0, 480.0, 950.0, 590.0, 570.0, 935.0, 1135.0, 920.0, 490.0, 700.0, 460.0, 325.0, 360.0, 600.0, 430.0, 370.0, 550.0, 795.0, 320.0, 250.0, 270.0, 610.0, 1120.0, 350.0, 120.0, 620.0, 220.0, 560.0, -180.0, 730.0, 950.0, 150.0, 190.0, 150.0, 180.0, 325.0, 980.0, 190.0, 570.0, 290.0, 580.0, -645.0, 370.0, 250.0, 450.0, 1180.0, 510.0, 1015.0, 965.0, 260.0, 140.0, 1325.0, 380.0, 105.0, 270.0, 360.0, 630.0, 170.0, 620.0, 330.0, 550.0, 970.0, 70.0, 1095.0, 500.0, 1090.0, 735.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 30.0, 70.0, 20.0, 0.0, 210.0, 40.0, 250.0, 30.0, 20.0, 90.0, 390.0, 20.0, 70.0, 30.0, 0.0, 20.0, 20.0, 30.0, 0.0, 20.0, 0.0, 10.0, 50.0, 40.0, 0.0, 10.0, 30.0, 20.0, 160.0, 90.0, 20.0, -100.0, 30.0, 50.0, 10.0, 10.0, 20.0, 120.0, 690.0, -50.0, 90.0, 60.0, 10.0, 60.0, 30.0, 300.0, 10.0, 220.0, 20.0, 60.0, 20.0, 20.0, 40.0, 10.0, 160.0, 0.0, 70.0, 0.0, 20.0, 310.0, 30.0, 80.0, 260.0, 90.0, 0.0, 10.0, 40.0, 30.0, 20.0, 20.0, 190.0, 130.0, 40.0, 20.0, 30.0, 50.0, 30.0, 110.0, 20.0, 0.0, 0.0, 40.0, 80.0, 40.0, 50.0, 0.0, 0.0, 50.0, 20.0, 90.0, 100.0, 40.0, 30.0, 10.0, 70.0, 40.0, 20.0, 30.0, 190.0, 260.0, 70.0, 60.0, 270.0, 250.0, 70.0, -50.0, 50.0, 60.0, 50.0, 30.0, 30.0, 150.0, 90.0, 410.0, 90.0, 180.0, 30.0, 40.0, 50.0, 30.0, 90.0, 190.0, 50.0, 10.0, 60.0, 10.0, 150.0, 40.0, 40.0, -10.0, 50.0, 60.0, 40.0, 80.0, 70.0, 10.0, 170.0, 50.0, 0.0, 40.0, 40.0, 80.0, 0.0, 50.0, 60.0, 150.0, 250.0, 10.0, 20.0, 30.0, 70.0, 40.0, 30.0, 20.0, 10.0, 60.0, 20.0, 60.0, 40.0, 280.0, 20.0, 30.0, -30.0, 30.0, 170.0, 70.0, -10.0, -10.0, 150.0, 70.0, 400.0, 40.0, 100.0, 30.0, 20.0, 10.0, 10.0, -30.0, 0.0, 0.0, 60.0, 40.0, 30.0, 40.0, 100.0, 20.0, 0.0, 180.0, 0.0, 10.0, 10.0, 30.0, 0.0, 160.0, 40.0, 20.0, 20.0, 60.0, 0.0, 150.0, 560.0, 70.0, 70.0, 30.0, -10.0, 20.0, 50.0, 0.0, -100.0, 20.0, 10.0, 20.0, 90.0, 30.0, 0.0, 30.0, 20.0, 10.0, 30.0, 20.0, 90.0, 40.0, 20.0, 20.0, 20.0, 20.0, 30.0, -5.0, 30.0, 770.0, 20.0, 40.0, 20.0, 10.0, 40.0, 30.0, 40.0, 70.0, 0.0, 40.0, 30.0, 10.0, 250.0, 50.0, 40.0, 0.0, 90.0, 40.0, 40.0, 50.0, 100.0, 0.0, 350.0, 50.0, 210.0, 50.0, 0.0, 360.0, 30.0, 30.0, 40.0, 30.0, 40.0, 30.0, 90.0, 10.0, 0.0, 20.0, 60.0, 90.0, 160.0, 50.0, 30.0, 10.0, 160.0, 50.0, 50.0, 170.0, 160.0, 110.0, 20.0, 160.0, 10.0, 0.0, 40.0, 0.0, 20.0, 40.0, 20.0, 40.0, 10.0, 30.0, 30.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0, 40.0, 360.0, 20.0, 30.0, 40.0, 20.0, 140.0, 0.0, 10.0, 10.0, 0.0, 10.0, 30.0, 10.0, 70.0, 40.0, 20.0, 0.0, 0.0, 120.0, 180.0, 400.0, 80.0, 230.0, 110.0, 70.0, 80.0, 120.0, 0.0, 0.0, 60.0, 80.0, 210.0, 10.0, 70.0, 20.0, 20.0, 20.0, 60.0, 20.0, 30.0, 30.0, 170.0, 40.0, 0.0, 30.0, 0.0, 70.0, 90.0, 30.0, 80.0, 190.0, -250.0, 70.0, 130.0, 480.0, 80.0, 110.0, 30.0, 40.0, 30.0, 30.0, 20.0, 150.0, 20.0, 150.0, 40.0, 10.0, 100.0, 140.0, 60.0, 20.0, 70.0, 90.0, 90.0, 10.0, 50.0, 30.0, 10.0, 80.0, 100.0, 650.0, 0.0, -15.0, 0.0, 50.0, 30.0, 20.0, 20.0, 60.0, 20.0, 120.0, 400.0, 160.0, 10.0, 5.0, 70.0, 80.0, 210.0, 20.0, 250.0, 40.0, 10.0, 10.0, 50.0, 60.0, 270.0, 40.0, 170.0, 90.0, 0.0, 60.0, 20.0, 130.0, 40.0, 40.0, 20.0, 30.0, 60.0, 10.0, 60.0, 130.0, 50.0, 10.0, 10.0, 80.0, 190.0, 160.0, 0.0, 0.0, 10.0, 170.0, 40.0, 0.0, 30.0, 120.0, 20.0, 0.0, 70.0, 0.0, 30.0, 50.0, 35.0, 30.0, 20.0, 10.0, 70.0, 30.0, 50.0, 40.0, 50.0, 50.0, 40.0, 60.0, 30.0, 50.0, 40.0, 0.0, 0.0, 60.0, 30.0, 0.0, 40.0, 170.0, 80.0, 40.0, 0.0, 170.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 300.0, 0.0, 40.0, 10.0, 10.0, 60.0, 20.0, 70.0, 70.0, 10.0, 90.0, 190.0, 70.0, 20.0, -230.0, 10.0, 0.0, 80.0, 300.0, 20.0, 10.0, 40.0, 40.0, 0.0, 50.0, 510.0, 20.0, 10.0, 10.0, 80.0, 0.0, 70.0, 45.0, 10.0, 40.0, 0.0, 30.0, 40.0, 0.0, 50.0, 20.0, -60.0, 50.0, 10.0, 180.0, 10.0, 20.0, 0.0, 0.0, 110.0, 10.0, 10.0, 20.0, 40.0, 30.0, 20.0, 30.0, 150.0, 50.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 40.0, 10.0, 80.0, 30.0, 280.0, 60.0, 70.0, 20.0, 10.0, 10.0, 20.0, 110.0, 150.0, 60.0, 90.0, 10.0, 50.0, 90.0, 520.0, 20.0, 60.0, 20.0, 60.0, 60.0, 60.0, 40.0, 20.0, 0.0, 30.0, 0.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 20.0, 10.0, 0.0, 20.0, 40.0, 0.0, 50.0, 60.0, 10.0, 90.0, 40.0, 120.0, 190.0, 20.0, 10.0, 30.0, 40.0, 0.0, 40.0, 10.0, 20.0, 30.0, 20.0, 20.0, 10.0, 0.0, 10.0, 250.0, 160.0, 20.0, 40.0, 30.0, 20.0, 30.0, 20.0, 30.0, -165.0, 20.0, -155.0, 0.0, 0.0, 10.0, 30.0, 40.0, 40.0, 10.0, 40.0, 20.0, 10.0, 20.0, 130.0, 350.0, 70.0, 0.0, 0.0, 10.0, 70.0, 0.0, 760.0, 0.0, 40.0, 70.0, 0.0, 10.0, 20.0, 60.0, 0.0, 30.0, 10.0, 10.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 0.0, 30.0, 0.0, 100.0, 0.0, 10.0, 0.0, 30.0, 10.0, 0.0, 50.0, 30.0, 20.0, 0.0, 0.0, 30.0, 0.0, 20.0, 0.0, 20.0, 30.0, 20.0, 10.0, 10.0, 40.0, 20.0, 10.0, 10.0, 35.0, 160.0, 20.0, 10.0, 0.0, 30.0, 30.0, 30.0, 20.0, 110.0, 20.0, 50.0, 40.0, 40.0, 590.0, 30.0, 50.0, 20.0, 30.0, 30.0, 20.0, 40.0, 10.0, 0.0, 20.0, 20.0, 0.0, 40.0, 300.0, 10.0, 0.0, -50.0, 20.0, 50.0, 40.0, 90.0, 70.0, 0.0, 20.0, 10.0, 150.0, 0.0, 60.0, 30.0, 0.0, 0.0, 20.0, 160.0, 110.0, 40.0, 30.0, 100.0, 30.0, 10.0, 40.0, 10.0, 50.0, 0.0, 0.0, 30.0, 70.0, 5.0, -840.0, 40.0, 30.0, 20.0, 0.0, 20.0, 10.0, 10.0, 70.0, 0.0, 30.0, 180.0, 20.0, 30.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 30.0, 40.0, 40.0, 50.0, 0.0, 220.0, 20.0, 120.0, 20.0, 0.0, 10.0, 20.0, 30.0, 10.0, 20.0, -10.0, 520.0, 30.0, 20.0, -10.0, 60.0, 100.0, 380.0, 70.0, 0.0, 5.0, 70.0, 40.0, 35.0, 0.0, 50.0, 20.0, 40.0, 250.0, 10.0, 40.0, 30.0, 60.0, 50.0, 220.0, -5.0, 570.0, 40.0, 0.0, 110.0, 20.0, 40.0, -5.0, 20.0, 90.0, 60.0, 570.0, 30.0, 30.0, 40.0, 0.0, 10.0, 0.0, 10.0, 10.0, 30.0, 160.0, 0.0, 0.0, 0.0, -350.0, 20.0, 20.0, 50.0, 10.0, 10.0, 60.0, 20.0, 300.0, 580.0, 0.0, 60.0, 70.0, 210.0, 20.0, 20.0, 310.0, 25.0, 30.0, 20.0, 30.0, 30.0, 30.0, 20.0, 40.0, 120.0, 20.0, 10.0, 60.0, 0.0, 20.0, 0.0, 40.0, 20.0, -25.0, 20.0, 20.0, 0.0, 10.0, 30.0, 20.0, 40.0, 20.0, 40.0, 40.0, 10.0, 70.0, 0.0, 0.0, 0.0, 160.0, 20.0, 20.0, 10.0, 10.0, 50.0, 40.0, 30.0, 20.0, 20.0, 150.0, -60.0, 10.0, 160.0, 160.0, 60.0, 70.0, 10.0, 50.0, 20.0, 0.0, 20.0, 10.0, 10.0, 10.0, 30.0, 60.0, 10.0, 0.0, 20.0, 0.0, 70.0, 380.0, 50.0, 20.0, 40.0, 0.0, 40.0, 0.0, 160.0, 20.0, 10.0, 40.0, 40.0, 30.0, 0.0, 30.0, 0.0, 0.0, 10.0, 170.0, 60.0, 40.0, 20.0, 170.0, 40.0, 10.0, 0.0, 30.0, 90.0, 10.0, 510.0, 60.0, 30.0, 30.0, 200.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 0.0, 70.0, 0.0, 50.0, 80.0, 20.0, 10.0, 40.0, 30.0, 760.0, 35.0, 30.0, 60.0, 60.0, 10.0, 30.0, 250.0, 0.0, 0.0, 40.0, 20.0, 510.0, 60.0, 60.0, 310.0, 20.0, 0.0, 30.0, 30.0, 60.0, 10.0, 40.0, 30.0, 90.0, 30.0, 80.0, 0.0, 20.0, 80.0, 15.0, 350.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.47382266665671, "mean_inference_ms": 1.6763165370495625, "mean_action_processing_ms": 0.43772733667286334, "mean_env_wait_ms": 1.3450956667337435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05922365188598633, "StateBufferConnector_ms": 0.009387969970703125, "ViewRequirementAgentConnector_ms": 0.3883371353149414}, "num_episodes": 18, "episode_return_max": 1390.0, "episode_return_min": -645.0, "episode_return_mean": 556.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.44716331428409, "num_env_steps_trained_throughput_per_sec": 36.44716331428409, "timesteps_total": 312000, "num_env_steps_sampled_lifetime": 312000, "num_agent_steps_sampled_lifetime": 3120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3120000, "timers": {"training_iteration_time_ms": 110186.396, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110186.344, "sample_time_ms": 2426.728, "learn_time_ms": 107739.818, "learn_throughput": 37.126, "synch_weights_time_ms": 11.054}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 3120000, "num_agent_steps_trained": 3120000}, "done": false, "training_iteration": 78, "trial_id": "57140_00000", "date": "2024-06-27_01-43-14", "timestamp": 1719466994, "time_this_iter_s": 109.75841999053955, "time_total_s": 8920.288383483887, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b193b040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 8920.288383483887, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 15.310967741935483, "ram_util_percent": 79.18387096774194}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3341769101711125, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004477129928709163, "vf_loss": 4.351517387091542, "vf_explained_var": 0.0008908468059584482, "kl": Infinity, "entropy": 0.4277902975853005, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 737115.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000}, "env_runners": {"episode_reward_max": 1390.0, "episode_reward_min": -645.0, "episode_reward_mean": 554.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -840.0}, "policy_reward_max": {"policy_0": 770.0}, "policy_reward_mean": {"policy_0": 55.46}, "custom_metrics": {}, "hist_stats": {"episode_reward": [470.0, 350.0, 840.0, 260.0, 285.0, 1040.0, 590.0, 1200.0, 350.0, 930.0, 420.0, 240.0, 660.0, 190.0, 1390.0, 550.0, 480.0, 950.0, 590.0, 570.0, 935.0, 1135.0, 920.0, 490.0, 700.0, 460.0, 325.0, 360.0, 600.0, 430.0, 370.0, 550.0, 795.0, 320.0, 250.0, 270.0, 610.0, 1120.0, 350.0, 120.0, 620.0, 220.0, 560.0, -180.0, 730.0, 950.0, 150.0, 190.0, 150.0, 180.0, 325.0, 980.0, 190.0, 570.0, 290.0, 580.0, -645.0, 370.0, 250.0, 450.0, 1180.0, 510.0, 1015.0, 965.0, 260.0, 140.0, 1325.0, 380.0, 105.0, 270.0, 360.0, 630.0, 170.0, 620.0, 330.0, 550.0, 970.0, 70.0, 1095.0, 500.0, 1090.0, 735.0, 420.0, 320.0, 1010.0, 520.0, 550.0, 850.0, 300.0, 1250.0, 300.0, 1290.0, 680.0, 1320.0, 190.0, 350.0, 360.0, 945.0, 520.0, 620.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 60.0, 40.0, 30.0, 40.0, 100.0, 20.0, 0.0, 180.0, 0.0, 10.0, 10.0, 30.0, 0.0, 160.0, 40.0, 20.0, 20.0, 60.0, 0.0, 150.0, 560.0, 70.0, 70.0, 30.0, -10.0, 20.0, 50.0, 0.0, -100.0, 20.0, 10.0, 20.0, 90.0, 30.0, 0.0, 30.0, 20.0, 10.0, 30.0, 20.0, 90.0, 40.0, 20.0, 20.0, 20.0, 20.0, 30.0, -5.0, 30.0, 770.0, 20.0, 40.0, 20.0, 10.0, 40.0, 30.0, 40.0, 70.0, 0.0, 40.0, 30.0, 10.0, 250.0, 50.0, 40.0, 0.0, 90.0, 40.0, 40.0, 50.0, 100.0, 0.0, 350.0, 50.0, 210.0, 50.0, 0.0, 360.0, 30.0, 30.0, 40.0, 30.0, 40.0, 30.0, 90.0, 10.0, 0.0, 20.0, 60.0, 90.0, 160.0, 50.0, 30.0, 10.0, 160.0, 50.0, 50.0, 170.0, 160.0, 110.0, 20.0, 160.0, 10.0, 0.0, 40.0, 0.0, 20.0, 40.0, 20.0, 40.0, 10.0, 30.0, 30.0, 10.0, 30.0, 30.0, 20.0, 30.0, 10.0, 0.0, 40.0, 360.0, 20.0, 30.0, 40.0, 20.0, 140.0, 0.0, 10.0, 10.0, 0.0, 10.0, 30.0, 10.0, 70.0, 40.0, 20.0, 0.0, 0.0, 120.0, 180.0, 400.0, 80.0, 230.0, 110.0, 70.0, 80.0, 120.0, 0.0, 0.0, 60.0, 80.0, 210.0, 10.0, 70.0, 20.0, 20.0, 20.0, 60.0, 20.0, 30.0, 30.0, 170.0, 40.0, 0.0, 30.0, 0.0, 70.0, 90.0, 30.0, 80.0, 190.0, -250.0, 70.0, 130.0, 480.0, 80.0, 110.0, 30.0, 40.0, 30.0, 30.0, 20.0, 150.0, 20.0, 150.0, 40.0, 10.0, 100.0, 140.0, 60.0, 20.0, 70.0, 90.0, 90.0, 10.0, 50.0, 30.0, 10.0, 80.0, 100.0, 650.0, 0.0, -15.0, 0.0, 50.0, 30.0, 20.0, 20.0, 60.0, 20.0, 120.0, 400.0, 160.0, 10.0, 5.0, 70.0, 80.0, 210.0, 20.0, 250.0, 40.0, 10.0, 10.0, 50.0, 60.0, 270.0, 40.0, 170.0, 90.0, 0.0, 60.0, 20.0, 130.0, 40.0, 40.0, 20.0, 30.0, 60.0, 10.0, 60.0, 130.0, 50.0, 10.0, 10.0, 80.0, 190.0, 160.0, 0.0, 0.0, 10.0, 170.0, 40.0, 0.0, 30.0, 120.0, 20.0, 0.0, 70.0, 0.0, 30.0, 50.0, 35.0, 30.0, 20.0, 10.0, 70.0, 30.0, 50.0, 40.0, 50.0, 50.0, 40.0, 60.0, 30.0, 50.0, 40.0, 0.0, 0.0, 60.0, 30.0, 0.0, 40.0, 170.0, 80.0, 40.0, 0.0, 170.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 300.0, 0.0, 40.0, 10.0, 10.0, 60.0, 20.0, 70.0, 70.0, 10.0, 90.0, 190.0, 70.0, 20.0, -230.0, 10.0, 0.0, 80.0, 300.0, 20.0, 10.0, 40.0, 40.0, 0.0, 50.0, 510.0, 20.0, 10.0, 10.0, 80.0, 0.0, 70.0, 45.0, 10.0, 40.0, 0.0, 30.0, 40.0, 0.0, 50.0, 20.0, -60.0, 50.0, 10.0, 180.0, 10.0, 20.0, 0.0, 0.0, 110.0, 10.0, 10.0, 20.0, 40.0, 30.0, 20.0, 30.0, 150.0, 50.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 40.0, 10.0, 80.0, 30.0, 280.0, 60.0, 70.0, 20.0, 10.0, 10.0, 20.0, 110.0, 150.0, 60.0, 90.0, 10.0, 50.0, 90.0, 520.0, 20.0, 60.0, 20.0, 60.0, 60.0, 60.0, 40.0, 20.0, 0.0, 30.0, 0.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 20.0, 10.0, 0.0, 20.0, 40.0, 0.0, 50.0, 60.0, 10.0, 90.0, 40.0, 120.0, 190.0, 20.0, 10.0, 30.0, 40.0, 0.0, 40.0, 10.0, 20.0, 30.0, 20.0, 20.0, 10.0, 0.0, 10.0, 250.0, 160.0, 20.0, 40.0, 30.0, 20.0, 30.0, 20.0, 30.0, -165.0, 20.0, -155.0, 0.0, 0.0, 10.0, 30.0, 40.0, 40.0, 10.0, 40.0, 20.0, 10.0, 20.0, 130.0, 350.0, 70.0, 0.0, 0.0, 10.0, 70.0, 0.0, 760.0, 0.0, 40.0, 70.0, 0.0, 10.0, 20.0, 60.0, 0.0, 30.0, 10.0, 10.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 0.0, 30.0, 0.0, 100.0, 0.0, 10.0, 0.0, 30.0, 10.0, 0.0, 50.0, 30.0, 20.0, 0.0, 0.0, 30.0, 0.0, 20.0, 0.0, 20.0, 30.0, 20.0, 10.0, 10.0, 40.0, 20.0, 10.0, 10.0, 35.0, 160.0, 20.0, 10.0, 0.0, 30.0, 30.0, 30.0, 20.0, 110.0, 20.0, 50.0, 40.0, 40.0, 590.0, 30.0, 50.0, 20.0, 30.0, 30.0, 20.0, 40.0, 10.0, 0.0, 20.0, 20.0, 0.0, 40.0, 300.0, 10.0, 0.0, -50.0, 20.0, 50.0, 40.0, 90.0, 70.0, 0.0, 20.0, 10.0, 150.0, 0.0, 60.0, 30.0, 0.0, 0.0, 20.0, 160.0, 110.0, 40.0, 30.0, 100.0, 30.0, 10.0, 40.0, 10.0, 50.0, 0.0, 0.0, 30.0, 70.0, 5.0, -840.0, 40.0, 30.0, 20.0, 0.0, 20.0, 10.0, 10.0, 70.0, 0.0, 30.0, 180.0, 20.0, 30.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 30.0, 40.0, 40.0, 50.0, 0.0, 220.0, 20.0, 120.0, 20.0, 0.0, 10.0, 20.0, 30.0, 10.0, 20.0, -10.0, 520.0, 30.0, 20.0, -10.0, 60.0, 100.0, 380.0, 70.0, 0.0, 5.0, 70.0, 40.0, 35.0, 0.0, 50.0, 20.0, 40.0, 250.0, 10.0, 40.0, 30.0, 60.0, 50.0, 220.0, -5.0, 570.0, 40.0, 0.0, 110.0, 20.0, 40.0, -5.0, 20.0, 90.0, 60.0, 570.0, 30.0, 30.0, 40.0, 0.0, 10.0, 0.0, 10.0, 10.0, 30.0, 160.0, 0.0, 0.0, 0.0, -350.0, 20.0, 20.0, 50.0, 10.0, 10.0, 60.0, 20.0, 300.0, 580.0, 0.0, 60.0, 70.0, 210.0, 20.0, 20.0, 310.0, 25.0, 30.0, 20.0, 30.0, 30.0, 30.0, 20.0, 40.0, 120.0, 20.0, 10.0, 60.0, 0.0, 20.0, 0.0, 40.0, 20.0, -25.0, 20.0, 20.0, 0.0, 10.0, 30.0, 20.0, 40.0, 20.0, 40.0, 40.0, 10.0, 70.0, 0.0, 0.0, 0.0, 160.0, 20.0, 20.0, 10.0, 10.0, 50.0, 40.0, 30.0, 20.0, 20.0, 150.0, -60.0, 10.0, 160.0, 160.0, 60.0, 70.0, 10.0, 50.0, 20.0, 0.0, 20.0, 10.0, 10.0, 10.0, 30.0, 60.0, 10.0, 0.0, 20.0, 0.0, 70.0, 380.0, 50.0, 20.0, 40.0, 0.0, 40.0, 0.0, 160.0, 20.0, 10.0, 40.0, 40.0, 30.0, 0.0, 30.0, 0.0, 0.0, 10.0, 170.0, 60.0, 40.0, 20.0, 170.0, 40.0, 10.0, 0.0, 30.0, 90.0, 10.0, 510.0, 60.0, 30.0, 30.0, 200.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 0.0, 70.0, 0.0, 50.0, 80.0, 20.0, 10.0, 40.0, 30.0, 760.0, 35.0, 30.0, 60.0, 60.0, 10.0, 30.0, 250.0, 0.0, 0.0, 40.0, 20.0, 510.0, 60.0, 60.0, 310.0, 20.0, 0.0, 30.0, 30.0, 60.0, 10.0, 40.0, 30.0, 90.0, 30.0, 80.0, 0.0, 20.0, 80.0, 15.0, 350.0, 290.0, 30.0, 40.0, 0.0, 40.0, 40.0, -50.0, 30.0, 0.0, 0.0, 10.0, 0.0, 40.0, 160.0, 50.0, 40.0, 0.0, 0.0, 0.0, 20.0, 30.0, 10.0, 60.0, 150.0, 40.0, 180.0, 20.0, 30.0, 450.0, 40.0, 0.0, 40.0, 80.0, 140.0, 40.0, 0.0, 40.0, 100.0, 40.0, 40.0, 30.0, 160.0, 40.0, 0.0, 40.0, 80.0, 50.0, 10.0, 30.0, 110.0, 20.0, 30.0, 40.0, 10.0, 190.0, 370.0, 80.0, 20.0, 70.0, 20.0, 10.0, 30.0, 0.0, 20.0, 90.0, 10.0, 40.0, 10.0, 10.0, 80.0, 270.0, -20.0, 390.0, 30.0, 60.0, 50.0, 160.0, 20.0, 90.0, 200.0, 80.0, 20.0, 30.0, 40.0, 20.0, 60.0, 0.0, 50.0, 0.0, 0.0, 300.0, 80.0, 170.0, 60.0, 50.0, 90.0, 110.0, 220.0, 40.0, 170.0, 150.0, 260.0, 30.0, 40.0, 60.0, 20.0, 60.0, 20.0, 20.0, 20.0, 560.0, 50.0, 120.0, 20.0, 90.0, -40.0, 190.0, 90.0, 160.0, 80.0, 10.0, 20.0, 30.0, 0.0, 10.0, 0.0, 50.0, 10.0, 40.0, 20.0, 0.0, 70.0, 10.0, 160.0, 60.0, 30.0, 0.0, 0.0, 20.0, 0.0, 80.0, 60.0, 60.0, 10.0, 40.0, 30.0, 10.0, 0.0, 60.0, 10.0, 70.0, 100.0, 30.0, 30.0, 30.0, 280.0, 0.0, 20.0, 35.0, 350.0, 10.0, 10.0, 0.0, 30.0, 20.0, 10.0, 0.0, 150.0, 250.0, 40.0, 20.0, 40.0, 20.0, 60.0, 60.0, 200.0, 30.0, -40.0, 170.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4722609399285884, "mean_inference_ms": 1.674593996513362, "mean_action_processing_ms": 0.4372607118303273, "mean_env_wait_ms": 1.343905286984186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058336496353149414, "StateBufferConnector_ms": 0.009218215942382812, "ViewRequirementAgentConnector_ms": 0.3693845272064209}, "num_episodes": 18, "episode_return_max": 1390.0, "episode_return_min": -645.0, "episode_return_mean": 554.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.29677533362012, "num_env_steps_trained_throughput_per_sec": 36.29677533362012, "timesteps_total": 316000, "num_env_steps_sampled_lifetime": 316000, "num_agent_steps_sampled_lifetime": 3160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3160000, "timers": {"training_iteration_time_ms": 110194.643, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110194.592, "sample_time_ms": 2426.226, "learn_time_ms": 107748.751, "learn_throughput": 37.123, "synch_weights_time_ms": 10.752}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 3160000, "num_agent_steps_trained": 3160000}, "done": false, "training_iteration": 79, "trial_id": "57140_00000", "date": "2024-06-27_01-45-04", "timestamp": 1719467104, "time_this_iter_s": 110.2166121006012, "time_total_s": 9030.504995584488, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b193b550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9030.504995584488, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 15.455769230769233, "ram_util_percent": 79.18333333333332}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.229786025636747, "cur_kl_coeff": 0.3796875000000001, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.003996577369707762, "vf_loss": 4.186576812665938, "vf_explained_var": 0.0012949606417593993, "kl": Infinity, "entropy": 0.4040482860054579, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 746505.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "env_runners": {"episode_reward_max": 1325.0, "episode_reward_min": -645.0, "episode_reward_mean": 541.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -840.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 54.185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [920.0, 490.0, 700.0, 460.0, 325.0, 360.0, 600.0, 430.0, 370.0, 550.0, 795.0, 320.0, 250.0, 270.0, 610.0, 1120.0, 350.0, 120.0, 620.0, 220.0, 560.0, -180.0, 730.0, 950.0, 150.0, 190.0, 150.0, 180.0, 325.0, 980.0, 190.0, 570.0, 290.0, 580.0, -645.0, 370.0, 250.0, 450.0, 1180.0, 510.0, 1015.0, 965.0, 260.0, 140.0, 1325.0, 380.0, 105.0, 270.0, 360.0, 630.0, 170.0, 620.0, 330.0, 550.0, 970.0, 70.0, 1095.0, 500.0, 1090.0, 735.0, 420.0, 320.0, 1010.0, 520.0, 550.0, 850.0, 300.0, 1250.0, 300.0, 1290.0, 680.0, 1320.0, 190.0, 350.0, 360.0, 945.0, 520.0, 620.0, 835.0, 550.0, 670.0, 360.0, 575.0, 660.0, 140.0, 270.0, 400.0, 430.0, 330.0, 540.0, 530.0, 410.0, 1030.0, 530.0, 720.0, 1010.0, 660.0, 1030.0, 360.0, 1110.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 250.0, 40.0, 10.0, 10.0, 50.0, 60.0, 270.0, 40.0, 170.0, 90.0, 0.0, 60.0, 20.0, 130.0, 40.0, 40.0, 20.0, 30.0, 60.0, 10.0, 60.0, 130.0, 50.0, 10.0, 10.0, 80.0, 190.0, 160.0, 0.0, 0.0, 10.0, 170.0, 40.0, 0.0, 30.0, 120.0, 20.0, 0.0, 70.0, 0.0, 30.0, 50.0, 35.0, 30.0, 20.0, 10.0, 70.0, 30.0, 50.0, 40.0, 50.0, 50.0, 40.0, 60.0, 30.0, 50.0, 40.0, 0.0, 0.0, 60.0, 30.0, 0.0, 40.0, 170.0, 80.0, 40.0, 0.0, 170.0, 10.0, 20.0, 10.0, 10.0, 20.0, 10.0, 300.0, 0.0, 40.0, 10.0, 10.0, 60.0, 20.0, 70.0, 70.0, 10.0, 90.0, 190.0, 70.0, 20.0, -230.0, 10.0, 0.0, 80.0, 300.0, 20.0, 10.0, 40.0, 40.0, 0.0, 50.0, 510.0, 20.0, 10.0, 10.0, 80.0, 0.0, 70.0, 45.0, 10.0, 40.0, 0.0, 30.0, 40.0, 0.0, 50.0, 20.0, -60.0, 50.0, 10.0, 180.0, 10.0, 20.0, 0.0, 0.0, 110.0, 10.0, 10.0, 20.0, 40.0, 30.0, 20.0, 30.0, 150.0, 50.0, 0.0, 0.0, 0.0, 10.0, 10.0, 0.0, 40.0, 10.0, 80.0, 30.0, 280.0, 60.0, 70.0, 20.0, 10.0, 10.0, 20.0, 110.0, 150.0, 60.0, 90.0, 10.0, 50.0, 90.0, 520.0, 20.0, 60.0, 20.0, 60.0, 60.0, 60.0, 40.0, 20.0, 0.0, 30.0, 0.0, 10.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 20.0, 10.0, 0.0, 20.0, 40.0, 0.0, 50.0, 60.0, 10.0, 90.0, 40.0, 120.0, 190.0, 20.0, 10.0, 30.0, 40.0, 0.0, 40.0, 10.0, 20.0, 30.0, 20.0, 20.0, 10.0, 0.0, 10.0, 250.0, 160.0, 20.0, 40.0, 30.0, 20.0, 30.0, 20.0, 30.0, -165.0, 20.0, -155.0, 0.0, 0.0, 10.0, 30.0, 40.0, 40.0, 10.0, 40.0, 20.0, 10.0, 20.0, 130.0, 350.0, 70.0, 0.0, 0.0, 10.0, 70.0, 0.0, 760.0, 0.0, 40.0, 70.0, 0.0, 10.0, 20.0, 60.0, 0.0, 30.0, 10.0, 10.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 0.0, 30.0, 0.0, 100.0, 0.0, 10.0, 0.0, 30.0, 10.0, 0.0, 50.0, 30.0, 20.0, 0.0, 0.0, 30.0, 0.0, 20.0, 0.0, 20.0, 30.0, 20.0, 10.0, 10.0, 40.0, 20.0, 10.0, 10.0, 35.0, 160.0, 20.0, 10.0, 0.0, 30.0, 30.0, 30.0, 20.0, 110.0, 20.0, 50.0, 40.0, 40.0, 590.0, 30.0, 50.0, 20.0, 30.0, 30.0, 20.0, 40.0, 10.0, 0.0, 20.0, 20.0, 0.0, 40.0, 300.0, 10.0, 0.0, -50.0, 20.0, 50.0, 40.0, 90.0, 70.0, 0.0, 20.0, 10.0, 150.0, 0.0, 60.0, 30.0, 0.0, 0.0, 20.0, 160.0, 110.0, 40.0, 30.0, 100.0, 30.0, 10.0, 40.0, 10.0, 50.0, 0.0, 0.0, 30.0, 70.0, 5.0, -840.0, 40.0, 30.0, 20.0, 0.0, 20.0, 10.0, 10.0, 70.0, 0.0, 30.0, 180.0, 20.0, 30.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 30.0, 40.0, 40.0, 50.0, 0.0, 220.0, 20.0, 120.0, 20.0, 0.0, 10.0, 20.0, 30.0, 10.0, 20.0, -10.0, 520.0, 30.0, 20.0, -10.0, 60.0, 100.0, 380.0, 70.0, 0.0, 5.0, 70.0, 40.0, 35.0, 0.0, 50.0, 20.0, 40.0, 250.0, 10.0, 40.0, 30.0, 60.0, 50.0, 220.0, -5.0, 570.0, 40.0, 0.0, 110.0, 20.0, 40.0, -5.0, 20.0, 90.0, 60.0, 570.0, 30.0, 30.0, 40.0, 0.0, 10.0, 0.0, 10.0, 10.0, 30.0, 160.0, 0.0, 0.0, 0.0, -350.0, 20.0, 20.0, 50.0, 10.0, 10.0, 60.0, 20.0, 300.0, 580.0, 0.0, 60.0, 70.0, 210.0, 20.0, 20.0, 310.0, 25.0, 30.0, 20.0, 30.0, 30.0, 30.0, 20.0, 40.0, 120.0, 20.0, 10.0, 60.0, 0.0, 20.0, 0.0, 40.0, 20.0, -25.0, 20.0, 20.0, 0.0, 10.0, 30.0, 20.0, 40.0, 20.0, 40.0, 40.0, 10.0, 70.0, 0.0, 0.0, 0.0, 160.0, 20.0, 20.0, 10.0, 10.0, 50.0, 40.0, 30.0, 20.0, 20.0, 150.0, -60.0, 10.0, 160.0, 160.0, 60.0, 70.0, 10.0, 50.0, 20.0, 0.0, 20.0, 10.0, 10.0, 10.0, 30.0, 60.0, 10.0, 0.0, 20.0, 0.0, 70.0, 380.0, 50.0, 20.0, 40.0, 0.0, 40.0, 0.0, 160.0, 20.0, 10.0, 40.0, 40.0, 30.0, 0.0, 30.0, 0.0, 0.0, 10.0, 170.0, 60.0, 40.0, 20.0, 170.0, 40.0, 10.0, 0.0, 30.0, 90.0, 10.0, 510.0, 60.0, 30.0, 30.0, 200.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 0.0, 70.0, 0.0, 50.0, 80.0, 20.0, 10.0, 40.0, 30.0, 760.0, 35.0, 30.0, 60.0, 60.0, 10.0, 30.0, 250.0, 0.0, 0.0, 40.0, 20.0, 510.0, 60.0, 60.0, 310.0, 20.0, 0.0, 30.0, 30.0, 60.0, 10.0, 40.0, 30.0, 90.0, 30.0, 80.0, 0.0, 20.0, 80.0, 15.0, 350.0, 290.0, 30.0, 40.0, 0.0, 40.0, 40.0, -50.0, 30.0, 0.0, 0.0, 10.0, 0.0, 40.0, 160.0, 50.0, 40.0, 0.0, 0.0, 0.0, 20.0, 30.0, 10.0, 60.0, 150.0, 40.0, 180.0, 20.0, 30.0, 450.0, 40.0, 0.0, 40.0, 80.0, 140.0, 40.0, 0.0, 40.0, 100.0, 40.0, 40.0, 30.0, 160.0, 40.0, 0.0, 40.0, 80.0, 50.0, 10.0, 30.0, 110.0, 20.0, 30.0, 40.0, 10.0, 190.0, 370.0, 80.0, 20.0, 70.0, 20.0, 10.0, 30.0, 0.0, 20.0, 90.0, 10.0, 40.0, 10.0, 10.0, 80.0, 270.0, -20.0, 390.0, 30.0, 60.0, 50.0, 160.0, 20.0, 90.0, 200.0, 80.0, 20.0, 30.0, 40.0, 20.0, 60.0, 0.0, 50.0, 0.0, 0.0, 300.0, 80.0, 170.0, 60.0, 50.0, 90.0, 110.0, 220.0, 40.0, 170.0, 150.0, 260.0, 30.0, 40.0, 60.0, 20.0, 60.0, 20.0, 20.0, 20.0, 560.0, 50.0, 120.0, 20.0, 90.0, -40.0, 190.0, 90.0, 160.0, 80.0, 10.0, 20.0, 30.0, 0.0, 10.0, 0.0, 50.0, 10.0, 40.0, 20.0, 0.0, 70.0, 10.0, 160.0, 60.0, 30.0, 0.0, 0.0, 20.0, 0.0, 80.0, 60.0, 60.0, 10.0, 40.0, 30.0, 10.0, 0.0, 60.0, 10.0, 70.0, 100.0, 30.0, 30.0, 30.0, 280.0, 0.0, 20.0, 35.0, 350.0, 10.0, 10.0, 0.0, 30.0, 20.0, 10.0, 0.0, 150.0, 250.0, 40.0, 20.0, 40.0, 20.0, 60.0, 60.0, 200.0, 30.0, -40.0, 170.0, 60.0, 40.0, 40.0, 230.0, 0.0, -5.0, 0.0, 350.0, -50.0, -20.0, 250.0, 10.0, 490.0, -30.0, 0.0, 10.0, 0.0, 0.0, 80.0, 0.0, -10.0, 80.0, 0.0, 10.0, 50.0, 0.0, 30.0, 450.0, 20.0, 0.0, 30.0, 40.0, 20.0, 0.0, 50.0, 130.0, 40.0, 40.0, 0.0, 0.0, 40.0, 10.0, 15.0, 10.0, 40.0, 40.0, 30.0, 20.0, 40.0, 370.0, 0.0, 50.0, 120.0, 40.0, 0.0, 160.0, 30.0, 40.0, 30.0, 10.0, 180.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 10.0, 20.0, 10.0, 30.0, 60.0, 30.0, 40.0, 30.0, 20.0, 20.0, 20.0, 0.0, 40.0, 10.0, 20.0, 180.0, 10.0, -20.0, 30.0, 50.0, 0.0, 20.0, 110.0, 0.0, 20.0, 0.0, 150.0, 40.0, 170.0, 0.0, 10.0, 0.0, 30.0, 10.0, 0.0, 160.0, 10.0, 20.0, 20.0, 10.0, 10.0, 80.0, 0.0, 20.0, 0.0, 20.0, 30.0, 0.0, 70.0, 60.0, 60.0, 250.0, 20.0, 30.0, 0.0, 150.0, 220.0, 50.0, 0.0, 30.0, 0.0, 20.0, 20.0, 40.0, 30.0, 10.0, 40.0, 0.0, 80.0, 10.0, 0.0, 0.0, 170.0, 70.0, 0.0, 20.0, 560.0, 50.0, 30.0, 0.0, 300.0, 10.0, 20.0, 40.0, 120.0, 30.0, 150.0, 0.0, 40.0, 10.0, 70.0, 70.0, 40.0, 0.0, 80.0, 30.0, 20.0, 100.0, 140.0, 30.0, 40.0, 250.0, 20.0, 10.0, 30.0, 20.0, 60.0, 90.0, 400.0, 110.0, 150.0, 80.0, 70.0, 0.0, -60.0, 350.0, 10.0, 150.0, 40.0, 20.0, 20.0, 60.0, 70.0, 0.0, 280.0, 290.0, 30.0, 40.0, 60.0, 30.0, 70.0, 80.0, 120.0, 30.0, 250.0, 20.0, -10.0, 40.0, 20.0, 20.0, 10.0, 20.0, -40.0, 30.0, 110.0, 140.0, 60.0, 260.0, 90.0, 60.0, 300.0, 0.0, 70.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4709847724812155, "mean_inference_ms": 1.6724654953347238, "mean_action_processing_ms": 0.4365642808712664, "mean_env_wait_ms": 1.342546064132729, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05838942527770996, "StateBufferConnector_ms": 0.00911712646484375, "ViewRequirementAgentConnector_ms": 0.3698890209197998}, "num_episodes": 22, "episode_return_max": 1325.0, "episode_return_min": -645.0, "episode_return_mean": 541.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.306282983985994, "num_env_steps_trained_throughput_per_sec": 36.306282983985994, "timesteps_total": 320000, "num_env_steps_sampled_lifetime": 320000, "num_agent_steps_sampled_lifetime": 3200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3200000, "timers": {"training_iteration_time_ms": 110072.665, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110072.615, "sample_time_ms": 2457.083, "learn_time_ms": 107596.038, "learn_throughput": 37.176, "synch_weights_time_ms": 10.633}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 3200000, "num_agent_steps_trained": 3200000}, "done": false, "training_iteration": 80, "trial_id": "57140_00000", "date": "2024-06-27_01-46-55", "timestamp": 1719467215, "time_this_iter_s": 110.18518924713135, "time_total_s": 9140.69018483162, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18d4280>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9140.69018483162, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 15.83974358974359, "ram_util_percent": 79.23141025641027}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0965466814807936, "cur_kl_coeff": 0.5695312499999999, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0034777490866962617, "vf_loss": 3.8149468364553076, "vf_explained_var": 0.00045253982940040075, "kl": Infinity, "entropy": 0.4210827030598546, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 755895.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000}, "env_runners": {"episode_reward_max": 1610.0, "episode_reward_min": -645.0, "episode_reward_mean": 539.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -840.0}, "policy_reward_max": {"policy_0": 800.0}, "policy_reward_mean": {"policy_0": 53.91}, "custom_metrics": {}, "hist_stats": {"episode_reward": [620.0, 220.0, 560.0, -180.0, 730.0, 950.0, 150.0, 190.0, 150.0, 180.0, 325.0, 980.0, 190.0, 570.0, 290.0, 580.0, -645.0, 370.0, 250.0, 450.0, 1180.0, 510.0, 1015.0, 965.0, 260.0, 140.0, 1325.0, 380.0, 105.0, 270.0, 360.0, 630.0, 170.0, 620.0, 330.0, 550.0, 970.0, 70.0, 1095.0, 500.0, 1090.0, 735.0, 420.0, 320.0, 1010.0, 520.0, 550.0, 850.0, 300.0, 1250.0, 300.0, 1290.0, 680.0, 1320.0, 190.0, 350.0, 360.0, 945.0, 520.0, 620.0, 835.0, 550.0, 670.0, 360.0, 575.0, 660.0, 140.0, 270.0, 400.0, 430.0, 330.0, 540.0, 530.0, 410.0, 1030.0, 530.0, 720.0, 1010.0, 660.0, 1030.0, 360.0, 1110.0, 1610.0, 150.0, 1060.0, 250.0, 705.0, 360.0, 470.0, 470.0, 310.0, 580.0, 350.0, 380.0, 470.0, 380.0, 390.0, 260.0, 140.0, 430.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 40.0, 0.0, 50.0, 60.0, 10.0, 90.0, 40.0, 120.0, 190.0, 20.0, 10.0, 30.0, 40.0, 0.0, 40.0, 10.0, 20.0, 30.0, 20.0, 20.0, 10.0, 0.0, 10.0, 250.0, 160.0, 20.0, 40.0, 30.0, 20.0, 30.0, 20.0, 30.0, -165.0, 20.0, -155.0, 0.0, 0.0, 10.0, 30.0, 40.0, 40.0, 10.0, 40.0, 20.0, 10.0, 20.0, 130.0, 350.0, 70.0, 0.0, 0.0, 10.0, 70.0, 0.0, 760.0, 0.0, 40.0, 70.0, 0.0, 10.0, 20.0, 60.0, 0.0, 30.0, 10.0, 10.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 0.0, 30.0, 0.0, 100.0, 0.0, 10.0, 0.0, 30.0, 10.0, 0.0, 50.0, 30.0, 20.0, 0.0, 0.0, 30.0, 0.0, 20.0, 0.0, 20.0, 30.0, 20.0, 10.0, 10.0, 40.0, 20.0, 10.0, 10.0, 35.0, 160.0, 20.0, 10.0, 0.0, 30.0, 30.0, 30.0, 20.0, 110.0, 20.0, 50.0, 40.0, 40.0, 590.0, 30.0, 50.0, 20.0, 30.0, 30.0, 20.0, 40.0, 10.0, 0.0, 20.0, 20.0, 0.0, 40.0, 300.0, 10.0, 0.0, -50.0, 20.0, 50.0, 40.0, 90.0, 70.0, 0.0, 20.0, 10.0, 150.0, 0.0, 60.0, 30.0, 0.0, 0.0, 20.0, 160.0, 110.0, 40.0, 30.0, 100.0, 30.0, 10.0, 40.0, 10.0, 50.0, 0.0, 0.0, 30.0, 70.0, 5.0, -840.0, 40.0, 30.0, 20.0, 0.0, 20.0, 10.0, 10.0, 70.0, 0.0, 30.0, 180.0, 20.0, 30.0, 0.0, 10.0, 0.0, 10.0, 20.0, 20.0, 30.0, 30.0, 40.0, 40.0, 50.0, 0.0, 220.0, 20.0, 120.0, 20.0, 0.0, 10.0, 20.0, 30.0, 10.0, 20.0, -10.0, 520.0, 30.0, 20.0, -10.0, 60.0, 100.0, 380.0, 70.0, 0.0, 5.0, 70.0, 40.0, 35.0, 0.0, 50.0, 20.0, 40.0, 250.0, 10.0, 40.0, 30.0, 60.0, 50.0, 220.0, -5.0, 570.0, 40.0, 0.0, 110.0, 20.0, 40.0, -5.0, 20.0, 90.0, 60.0, 570.0, 30.0, 30.0, 40.0, 0.0, 10.0, 0.0, 10.0, 10.0, 30.0, 160.0, 0.0, 0.0, 0.0, -350.0, 20.0, 20.0, 50.0, 10.0, 10.0, 60.0, 20.0, 300.0, 580.0, 0.0, 60.0, 70.0, 210.0, 20.0, 20.0, 310.0, 25.0, 30.0, 20.0, 30.0, 30.0, 30.0, 20.0, 40.0, 120.0, 20.0, 10.0, 60.0, 0.0, 20.0, 0.0, 40.0, 20.0, -25.0, 20.0, 20.0, 0.0, 10.0, 30.0, 20.0, 40.0, 20.0, 40.0, 40.0, 10.0, 70.0, 0.0, 0.0, 0.0, 160.0, 20.0, 20.0, 10.0, 10.0, 50.0, 40.0, 30.0, 20.0, 20.0, 150.0, -60.0, 10.0, 160.0, 160.0, 60.0, 70.0, 10.0, 50.0, 20.0, 0.0, 20.0, 10.0, 10.0, 10.0, 30.0, 60.0, 10.0, 0.0, 20.0, 0.0, 70.0, 380.0, 50.0, 20.0, 40.0, 0.0, 40.0, 0.0, 160.0, 20.0, 10.0, 40.0, 40.0, 30.0, 0.0, 30.0, 0.0, 0.0, 10.0, 170.0, 60.0, 40.0, 20.0, 170.0, 40.0, 10.0, 0.0, 30.0, 90.0, 10.0, 510.0, 60.0, 30.0, 30.0, 200.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 0.0, 70.0, 0.0, 50.0, 80.0, 20.0, 10.0, 40.0, 30.0, 760.0, 35.0, 30.0, 60.0, 60.0, 10.0, 30.0, 250.0, 0.0, 0.0, 40.0, 20.0, 510.0, 60.0, 60.0, 310.0, 20.0, 0.0, 30.0, 30.0, 60.0, 10.0, 40.0, 30.0, 90.0, 30.0, 80.0, 0.0, 20.0, 80.0, 15.0, 350.0, 290.0, 30.0, 40.0, 0.0, 40.0, 40.0, -50.0, 30.0, 0.0, 0.0, 10.0, 0.0, 40.0, 160.0, 50.0, 40.0, 0.0, 0.0, 0.0, 20.0, 30.0, 10.0, 60.0, 150.0, 40.0, 180.0, 20.0, 30.0, 450.0, 40.0, 0.0, 40.0, 80.0, 140.0, 40.0, 0.0, 40.0, 100.0, 40.0, 40.0, 30.0, 160.0, 40.0, 0.0, 40.0, 80.0, 50.0, 10.0, 30.0, 110.0, 20.0, 30.0, 40.0, 10.0, 190.0, 370.0, 80.0, 20.0, 70.0, 20.0, 10.0, 30.0, 0.0, 20.0, 90.0, 10.0, 40.0, 10.0, 10.0, 80.0, 270.0, -20.0, 390.0, 30.0, 60.0, 50.0, 160.0, 20.0, 90.0, 200.0, 80.0, 20.0, 30.0, 40.0, 20.0, 60.0, 0.0, 50.0, 0.0, 0.0, 300.0, 80.0, 170.0, 60.0, 50.0, 90.0, 110.0, 220.0, 40.0, 170.0, 150.0, 260.0, 30.0, 40.0, 60.0, 20.0, 60.0, 20.0, 20.0, 20.0, 560.0, 50.0, 120.0, 20.0, 90.0, -40.0, 190.0, 90.0, 160.0, 80.0, 10.0, 20.0, 30.0, 0.0, 10.0, 0.0, 50.0, 10.0, 40.0, 20.0, 0.0, 70.0, 10.0, 160.0, 60.0, 30.0, 0.0, 0.0, 20.0, 0.0, 80.0, 60.0, 60.0, 10.0, 40.0, 30.0, 10.0, 0.0, 60.0, 10.0, 70.0, 100.0, 30.0, 30.0, 30.0, 280.0, 0.0, 20.0, 35.0, 350.0, 10.0, 10.0, 0.0, 30.0, 20.0, 10.0, 0.0, 150.0, 250.0, 40.0, 20.0, 40.0, 20.0, 60.0, 60.0, 200.0, 30.0, -40.0, 170.0, 60.0, 40.0, 40.0, 230.0, 0.0, -5.0, 0.0, 350.0, -50.0, -20.0, 250.0, 10.0, 490.0, -30.0, 0.0, 10.0, 0.0, 0.0, 80.0, 0.0, -10.0, 80.0, 0.0, 10.0, 50.0, 0.0, 30.0, 450.0, 20.0, 0.0, 30.0, 40.0, 20.0, 0.0, 50.0, 130.0, 40.0, 40.0, 0.0, 0.0, 40.0, 10.0, 15.0, 10.0, 40.0, 40.0, 30.0, 20.0, 40.0, 370.0, 0.0, 50.0, 120.0, 40.0, 0.0, 160.0, 30.0, 40.0, 30.0, 10.0, 180.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 10.0, 20.0, 10.0, 30.0, 60.0, 30.0, 40.0, 30.0, 20.0, 20.0, 20.0, 0.0, 40.0, 10.0, 20.0, 180.0, 10.0, -20.0, 30.0, 50.0, 0.0, 20.0, 110.0, 0.0, 20.0, 0.0, 150.0, 40.0, 170.0, 0.0, 10.0, 0.0, 30.0, 10.0, 0.0, 160.0, 10.0, 20.0, 20.0, 10.0, 10.0, 80.0, 0.0, 20.0, 0.0, 20.0, 30.0, 0.0, 70.0, 60.0, 60.0, 250.0, 20.0, 30.0, 0.0, 150.0, 220.0, 50.0, 0.0, 30.0, 0.0, 20.0, 20.0, 40.0, 30.0, 10.0, 40.0, 0.0, 80.0, 10.0, 0.0, 0.0, 170.0, 70.0, 0.0, 20.0, 560.0, 50.0, 30.0, 0.0, 300.0, 10.0, 20.0, 40.0, 120.0, 30.0, 150.0, 0.0, 40.0, 10.0, 70.0, 70.0, 40.0, 0.0, 80.0, 30.0, 20.0, 100.0, 140.0, 30.0, 40.0, 250.0, 20.0, 10.0, 30.0, 20.0, 60.0, 90.0, 400.0, 110.0, 150.0, 80.0, 70.0, 0.0, -60.0, 350.0, 10.0, 150.0, 40.0, 20.0, 20.0, 60.0, 70.0, 0.0, 280.0, 290.0, 30.0, 40.0, 60.0, 30.0, 70.0, 80.0, 120.0, 30.0, 250.0, 20.0, -10.0, 40.0, 20.0, 20.0, 10.0, 20.0, -40.0, 30.0, 110.0, 140.0, 60.0, 260.0, 90.0, 60.0, 300.0, 0.0, 70.0, 20.0, 20.0, 550.0, 40.0, 20.0, 800.0, -30.0, -20.0, 60.0, 60.0, 110.0, 0.0, 20.0, 30.0, 20.0, 0.0, 0.0, 40.0, 20.0, 10.0, 10.0, -40.0, 0.0, 220.0, 20.0, 60.0, 30.0, 570.0, 20.0, 170.0, 10.0, 20.0, 40.0, 10.0, 10.0, 40.0, 80.0, 0.0, 10.0, 20.0, 20.0, 0.0, 90.0, 40.0, 150.0, 30.0, -15.0, 10.0, 260.0, 70.0, 70.0, 30.0, 10.0, 190.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 0.0, 0.0, 40.0, 50.0, 0.0, 0.0, 30.0, 210.0, 30.0, 10.0, 100.0, 60.0, 20.0, 30.0, 10.0, 20.0, 30.0, 0.0, 80.0, 70.0, 150.0, 0.0, 20.0, 70.0, 80.0, 40.0, 10.0, 20.0, 10.0, 20.0, 40.0, 160.0, 20.0, -40.0, 30.0, 40.0, 0.0, 10.0, 260.0, 40.0, 60.0, 20.0, 50.0, 40.0, 120.0, 30.0, 20.0, 10.0, 40.0, 10.0, 10.0, 20.0, 80.0, 20.0, 90.0, 40.0, 0.0, 30.0, 20.0, 10.0, 70.0, 120.0, 10.0, 160.0, 30.0, 30.0, 30.0, 30.0, 10.0, 10.0, 40.0, 20.0, 80.0, 20.0, 40.0, 30.0, 10.0, 170.0, -10.0, 20.0, 0.0, 0.0, 30.0, 10.0, 30.0, 60.0, 80.0, 40.0, 60.0, 40.0, 40.0, 10.0, 30.0, 40.0, 0.0, 10.0, 20.0, 40.0, 30.0, 0.0, 80.0, 0.0, 10.0, 40.0, 10.0, 30.0, 0.0, 50.0, 0.0, 0.0, 0.0, 20.0, 50.0, 20.0, 30.0, 0.0, 30.0, 190.0, 40.0, 30.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4699825719961093, "mean_inference_ms": 1.6707323385200377, "mean_action_processing_ms": 0.4359979708606792, "mean_env_wait_ms": 1.3413789951260073, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05635333061218262, "StateBufferConnector_ms": 0.009074687957763672, "ViewRequirementAgentConnector_ms": 0.36679959297180176}, "num_episodes": 18, "episode_return_max": 1610.0, "episode_return_min": -645.0, "episode_return_mean": 539.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.370990600831185, "num_env_steps_trained_throughput_per_sec": 36.370990600831185, "timesteps_total": 324000, "num_env_steps_sampled_lifetime": 324000, "num_agent_steps_sampled_lifetime": 3240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3240000, "timers": {"training_iteration_time_ms": 110097.712, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110097.66, "sample_time_ms": 2451.149, "learn_time_ms": 107626.936, "learn_throughput": 37.165, "synch_weights_time_ms": 10.917}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 3240000, "num_agent_steps_trained": 3240000}, "done": false, "training_iteration": 81, "trial_id": "57140_00000", "date": "2024-06-27_01-48-45", "timestamp": 1719467325, "time_this_iter_s": 109.99036383628845, "time_total_s": 9250.680548667908, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b193bca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9250.680548667908, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 15.27935483870968, "ram_util_percent": 79.09548387096775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0358415779341272, "cur_kl_coeff": 0.8542968749999998, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0038601013084702965, "vf_loss": 3.7978302119765925, "vf_explained_var": 6.196261467898108e-05, "kl": Infinity, "entropy": 0.4161242848863236, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 765285.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000}, "env_runners": {"episode_reward_max": 1610.0, "episode_reward_min": 70.0, "episode_reward_mean": 566.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -350.0}, "policy_reward_max": {"policy_0": 800.0}, "policy_reward_mean": {"policy_0": 56.625}, "custom_metrics": {}, "hist_stats": {"episode_reward": [965.0, 260.0, 140.0, 1325.0, 380.0, 105.0, 270.0, 360.0, 630.0, 170.0, 620.0, 330.0, 550.0, 970.0, 70.0, 1095.0, 500.0, 1090.0, 735.0, 420.0, 320.0, 1010.0, 520.0, 550.0, 850.0, 300.0, 1250.0, 300.0, 1290.0, 680.0, 1320.0, 190.0, 350.0, 360.0, 945.0, 520.0, 620.0, 835.0, 550.0, 670.0, 360.0, 575.0, 660.0, 140.0, 270.0, 400.0, 430.0, 330.0, 540.0, 530.0, 410.0, 1030.0, 530.0, 720.0, 1010.0, 660.0, 1030.0, 360.0, 1110.0, 1610.0, 150.0, 1060.0, 250.0, 705.0, 360.0, 470.0, 470.0, 310.0, 580.0, 350.0, 380.0, 470.0, 380.0, 390.0, 260.0, 140.0, 430.0, 190.0, 310.0, 1380.0, 570.0, 400.0, 1095.0, 465.0, 350.0, 590.0, 780.0, 280.0, 160.0, 220.0, 420.0, 240.0, 260.0, 480.0, 1050.0, 770.0, 450.0, 190.0, 630.0, 1070.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [110.0, 20.0, 40.0, -5.0, 20.0, 90.0, 60.0, 570.0, 30.0, 30.0, 40.0, 0.0, 10.0, 0.0, 10.0, 10.0, 30.0, 160.0, 0.0, 0.0, 0.0, -350.0, 20.0, 20.0, 50.0, 10.0, 10.0, 60.0, 20.0, 300.0, 580.0, 0.0, 60.0, 70.0, 210.0, 20.0, 20.0, 310.0, 25.0, 30.0, 20.0, 30.0, 30.0, 30.0, 20.0, 40.0, 120.0, 20.0, 10.0, 60.0, 0.0, 20.0, 0.0, 40.0, 20.0, -25.0, 20.0, 20.0, 0.0, 10.0, 30.0, 20.0, 40.0, 20.0, 40.0, 40.0, 10.0, 70.0, 0.0, 0.0, 0.0, 160.0, 20.0, 20.0, 10.0, 10.0, 50.0, 40.0, 30.0, 20.0, 20.0, 150.0, -60.0, 10.0, 160.0, 160.0, 60.0, 70.0, 10.0, 50.0, 20.0, 0.0, 20.0, 10.0, 10.0, 10.0, 30.0, 60.0, 10.0, 0.0, 20.0, 0.0, 70.0, 380.0, 50.0, 20.0, 40.0, 0.0, 40.0, 0.0, 160.0, 20.0, 10.0, 40.0, 40.0, 30.0, 0.0, 30.0, 0.0, 0.0, 10.0, 170.0, 60.0, 40.0, 20.0, 170.0, 40.0, 10.0, 0.0, 30.0, 90.0, 10.0, 510.0, 60.0, 30.0, 30.0, 200.0, 20.0, 20.0, 0.0, 10.0, 0.0, 0.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 0.0, 70.0, 0.0, 50.0, 80.0, 20.0, 10.0, 40.0, 30.0, 760.0, 35.0, 30.0, 60.0, 60.0, 10.0, 30.0, 250.0, 0.0, 0.0, 40.0, 20.0, 510.0, 60.0, 60.0, 310.0, 20.0, 0.0, 30.0, 30.0, 60.0, 10.0, 40.0, 30.0, 90.0, 30.0, 80.0, 0.0, 20.0, 80.0, 15.0, 350.0, 290.0, 30.0, 40.0, 0.0, 40.0, 40.0, -50.0, 30.0, 0.0, 0.0, 10.0, 0.0, 40.0, 160.0, 50.0, 40.0, 0.0, 0.0, 0.0, 20.0, 30.0, 10.0, 60.0, 150.0, 40.0, 180.0, 20.0, 30.0, 450.0, 40.0, 0.0, 40.0, 80.0, 140.0, 40.0, 0.0, 40.0, 100.0, 40.0, 40.0, 30.0, 160.0, 40.0, 0.0, 40.0, 80.0, 50.0, 10.0, 30.0, 110.0, 20.0, 30.0, 40.0, 10.0, 190.0, 370.0, 80.0, 20.0, 70.0, 20.0, 10.0, 30.0, 0.0, 20.0, 90.0, 10.0, 40.0, 10.0, 10.0, 80.0, 270.0, -20.0, 390.0, 30.0, 60.0, 50.0, 160.0, 20.0, 90.0, 200.0, 80.0, 20.0, 30.0, 40.0, 20.0, 60.0, 0.0, 50.0, 0.0, 0.0, 300.0, 80.0, 170.0, 60.0, 50.0, 90.0, 110.0, 220.0, 40.0, 170.0, 150.0, 260.0, 30.0, 40.0, 60.0, 20.0, 60.0, 20.0, 20.0, 20.0, 560.0, 50.0, 120.0, 20.0, 90.0, -40.0, 190.0, 90.0, 160.0, 80.0, 10.0, 20.0, 30.0, 0.0, 10.0, 0.0, 50.0, 10.0, 40.0, 20.0, 0.0, 70.0, 10.0, 160.0, 60.0, 30.0, 0.0, 0.0, 20.0, 0.0, 80.0, 60.0, 60.0, 10.0, 40.0, 30.0, 10.0, 0.0, 60.0, 10.0, 70.0, 100.0, 30.0, 30.0, 30.0, 280.0, 0.0, 20.0, 35.0, 350.0, 10.0, 10.0, 0.0, 30.0, 20.0, 10.0, 0.0, 150.0, 250.0, 40.0, 20.0, 40.0, 20.0, 60.0, 60.0, 200.0, 30.0, -40.0, 170.0, 60.0, 40.0, 40.0, 230.0, 0.0, -5.0, 0.0, 350.0, -50.0, -20.0, 250.0, 10.0, 490.0, -30.0, 0.0, 10.0, 0.0, 0.0, 80.0, 0.0, -10.0, 80.0, 0.0, 10.0, 50.0, 0.0, 30.0, 450.0, 20.0, 0.0, 30.0, 40.0, 20.0, 0.0, 50.0, 130.0, 40.0, 40.0, 0.0, 0.0, 40.0, 10.0, 15.0, 10.0, 40.0, 40.0, 30.0, 20.0, 40.0, 370.0, 0.0, 50.0, 120.0, 40.0, 0.0, 160.0, 30.0, 40.0, 30.0, 10.0, 180.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 10.0, 20.0, 10.0, 30.0, 60.0, 30.0, 40.0, 30.0, 20.0, 20.0, 20.0, 0.0, 40.0, 10.0, 20.0, 180.0, 10.0, -20.0, 30.0, 50.0, 0.0, 20.0, 110.0, 0.0, 20.0, 0.0, 150.0, 40.0, 170.0, 0.0, 10.0, 0.0, 30.0, 10.0, 0.0, 160.0, 10.0, 20.0, 20.0, 10.0, 10.0, 80.0, 0.0, 20.0, 0.0, 20.0, 30.0, 0.0, 70.0, 60.0, 60.0, 250.0, 20.0, 30.0, 0.0, 150.0, 220.0, 50.0, 0.0, 30.0, 0.0, 20.0, 20.0, 40.0, 30.0, 10.0, 40.0, 0.0, 80.0, 10.0, 0.0, 0.0, 170.0, 70.0, 0.0, 20.0, 560.0, 50.0, 30.0, 0.0, 300.0, 10.0, 20.0, 40.0, 120.0, 30.0, 150.0, 0.0, 40.0, 10.0, 70.0, 70.0, 40.0, 0.0, 80.0, 30.0, 20.0, 100.0, 140.0, 30.0, 40.0, 250.0, 20.0, 10.0, 30.0, 20.0, 60.0, 90.0, 400.0, 110.0, 150.0, 80.0, 70.0, 0.0, -60.0, 350.0, 10.0, 150.0, 40.0, 20.0, 20.0, 60.0, 70.0, 0.0, 280.0, 290.0, 30.0, 40.0, 60.0, 30.0, 70.0, 80.0, 120.0, 30.0, 250.0, 20.0, -10.0, 40.0, 20.0, 20.0, 10.0, 20.0, -40.0, 30.0, 110.0, 140.0, 60.0, 260.0, 90.0, 60.0, 300.0, 0.0, 70.0, 20.0, 20.0, 550.0, 40.0, 20.0, 800.0, -30.0, -20.0, 60.0, 60.0, 110.0, 0.0, 20.0, 30.0, 20.0, 0.0, 0.0, 40.0, 20.0, 10.0, 10.0, -40.0, 0.0, 220.0, 20.0, 60.0, 30.0, 570.0, 20.0, 170.0, 10.0, 20.0, 40.0, 10.0, 10.0, 40.0, 80.0, 0.0, 10.0, 20.0, 20.0, 0.0, 90.0, 40.0, 150.0, 30.0, -15.0, 10.0, 260.0, 70.0, 70.0, 30.0, 10.0, 190.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 0.0, 0.0, 40.0, 50.0, 0.0, 0.0, 30.0, 210.0, 30.0, 10.0, 100.0, 60.0, 20.0, 30.0, 10.0, 20.0, 30.0, 0.0, 80.0, 70.0, 150.0, 0.0, 20.0, 70.0, 80.0, 40.0, 10.0, 20.0, 10.0, 20.0, 40.0, 160.0, 20.0, -40.0, 30.0, 40.0, 0.0, 10.0, 260.0, 40.0, 60.0, 20.0, 50.0, 40.0, 120.0, 30.0, 20.0, 10.0, 40.0, 10.0, 10.0, 20.0, 80.0, 20.0, 90.0, 40.0, 0.0, 30.0, 20.0, 10.0, 70.0, 120.0, 10.0, 160.0, 30.0, 30.0, 30.0, 30.0, 10.0, 10.0, 40.0, 20.0, 80.0, 20.0, 40.0, 30.0, 10.0, 170.0, -10.0, 20.0, 0.0, 0.0, 30.0, 10.0, 30.0, 60.0, 80.0, 40.0, 60.0, 40.0, 40.0, 10.0, 30.0, 40.0, 0.0, 10.0, 20.0, 40.0, 30.0, 0.0, 80.0, 0.0, 10.0, 40.0, 10.0, 30.0, 0.0, 50.0, 0.0, 0.0, 0.0, 20.0, 50.0, 20.0, 30.0, 0.0, 30.0, 190.0, 40.0, 30.0, 20.0, 0.0, 40.0, 0.0, 10.0, 30.0, 30.0, 30.0, 0.0, 20.0, 30.0, 40.0, 30.0, 40.0, 10.0, 0.0, 0.0, 0.0, 160.0, 30.0, 0.0, 160.0, 270.0, 90.0, 40.0, 80.0, 0.0, 60.0, 30.0, 570.0, 80.0, 270.0, 0.0, 60.0, 40.0, 40.0, 40.0, 50.0, 40.0, 30.0, 0.0, 160.0, 40.0, 20.0, 30.0, 20.0, 20.0, 30.0, 70.0, 0.0, 10.0, 10.0, 65.0, 40.0, 10.0, 350.0, 40.0, 210.0, 50.0, 20.0, 300.0, 0.0, 290.0, 10.0, 10.0, 0.0, 30.0, 25.0, 20.0, 40.0, 40.0, 0.0, 30.0, 20.0, 30.0, 60.0, 160.0, 20.0, 10.0, 20.0, 0.0, 80.0, 10.0, 10.0, 250.0, 90.0, 80.0, 20.0, 0.0, 30.0, 20.0, 60.0, 50.0, 30.0, 30.0, 20.0, 70.0, 140.0, 40.0, 40.0, 300.0, 30.0, 20.0, 30.0, 10.0, 10.0, 90.0, 40.0, 0.0, 20.0, 30.0, 30.0, 30.0, -20.0, 20.0, 0.0, 40.0, 30.0, 0.0, 30.0, 0.0, 0.0, 0.0, 10.0, 10.0, 70.0, 40.0, 20.0, 30.0, 30.0, 10.0, 30.0, 50.0, 20.0, 70.0, 30.0, 10.0, 30.0, 10.0, 170.0, 0.0, 0.0, 60.0, 0.0, 0.0, 20.0, 10.0, 10.0, 80.0, 40.0, 20.0, 20.0, 40.0, 10.0, 0.0, 20.0, 80.0, 20.0, 70.0, 0.0, 0.0, 20.0, 30.0, 70.0, 0.0, 40.0, 70.0, 0.0, 50.0, 200.0, 0.0, 0.0, 170.0, 30.0, 580.0, 0.0, 60.0, 110.0, 20.0, 60.0, 20.0, 20.0, 20.0, 50.0, 50.0, 30.0, 20.0, 20.0, 80.0, 30.0, 450.0, 400.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 30.0, 30.0, 20.0, 40.0, 10.0, 0.0, 0.0, 40.0, 60.0, 180.0, 30.0, 190.0, 40.0, 10.0, 0.0, 30.0, 20.0, 70.0, 20.0, 20.0, 30.0, 80.0, 10.0, 130.0, 10.0, 30.0, 460.0, 280.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4685649614862357, "mean_inference_ms": 1.668271468320983, "mean_action_processing_ms": 0.43526062668875376, "mean_env_wait_ms": 1.3398327506404444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056159019470214844, "StateBufferConnector_ms": 0.009000062942504883, "ViewRequirementAgentConnector_ms": 0.3642091751098633}, "num_episodes": 23, "episode_return_max": 1610.0, "episode_return_min": 70.0, "episode_return_mean": 566.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.16422487966707, "num_env_steps_trained_throughput_per_sec": 36.16422487966707, "timesteps_total": 328000, "num_env_steps_sampled_lifetime": 328000, "num_agent_steps_sampled_lifetime": 3280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3280000, "timers": {"training_iteration_time_ms": 110178.54, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110178.489, "sample_time_ms": 2447.912, "learn_time_ms": 107711.07, "learn_throughput": 37.136, "synch_weights_time_ms": 10.962}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 3280000, "num_agent_steps_trained": 3280000}, "done": false, "training_iteration": 82, "trial_id": "57140_00000", "date": "2024-06-27_01-50-35", "timestamp": 1719467435, "time_this_iter_s": 110.62062406539917, "time_total_s": 9361.301172733307, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18cc160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9361.301172733307, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 16.24076433121019, "ram_util_percent": 78.95796178343949}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4550730171612405, "cur_kl_coeff": 1.2814453125000003, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.003925358593345871, "vf_loss": 4.25513493611028, "vf_explained_var": 0.001269997740452028, "kl": Infinity, "entropy": 0.41248130576806075, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 774675.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000}, "env_runners": {"episode_reward_max": 1610.0, "episode_reward_min": 100.0, "episode_reward_mean": 556.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -60.0}, "policy_reward_max": {"policy_0": 800.0}, "policy_reward_mean": {"policy_0": 55.67}, "custom_metrics": {}, "hist_stats": {"episode_reward": [735.0, 420.0, 320.0, 1010.0, 520.0, 550.0, 850.0, 300.0, 1250.0, 300.0, 1290.0, 680.0, 1320.0, 190.0, 350.0, 360.0, 945.0, 520.0, 620.0, 835.0, 550.0, 670.0, 360.0, 575.0, 660.0, 140.0, 270.0, 400.0, 430.0, 330.0, 540.0, 530.0, 410.0, 1030.0, 530.0, 720.0, 1010.0, 660.0, 1030.0, 360.0, 1110.0, 1610.0, 150.0, 1060.0, 250.0, 705.0, 360.0, 470.0, 470.0, 310.0, 580.0, 350.0, 380.0, 470.0, 380.0, 390.0, 260.0, 140.0, 430.0, 190.0, 310.0, 1380.0, 570.0, 400.0, 1095.0, 465.0, 350.0, 590.0, 780.0, 280.0, 160.0, 220.0, 420.0, 240.0, 260.0, 480.0, 1050.0, 770.0, 450.0, 190.0, 630.0, 1070.0, 520.0, 530.0, 220.0, 250.0, 610.0, 350.0, 990.0, 290.0, 410.0, 545.0, 260.0, 100.0, 730.0, 360.0, 260.0, 1010.0, 950.0, 490.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 30.0, 90.0, 30.0, 80.0, 0.0, 20.0, 80.0, 15.0, 350.0, 290.0, 30.0, 40.0, 0.0, 40.0, 40.0, -50.0, 30.0, 0.0, 0.0, 10.0, 0.0, 40.0, 160.0, 50.0, 40.0, 0.0, 0.0, 0.0, 20.0, 30.0, 10.0, 60.0, 150.0, 40.0, 180.0, 20.0, 30.0, 450.0, 40.0, 0.0, 40.0, 80.0, 140.0, 40.0, 0.0, 40.0, 100.0, 40.0, 40.0, 30.0, 160.0, 40.0, 0.0, 40.0, 80.0, 50.0, 10.0, 30.0, 110.0, 20.0, 30.0, 40.0, 10.0, 190.0, 370.0, 80.0, 20.0, 70.0, 20.0, 10.0, 30.0, 0.0, 20.0, 90.0, 10.0, 40.0, 10.0, 10.0, 80.0, 270.0, -20.0, 390.0, 30.0, 60.0, 50.0, 160.0, 20.0, 90.0, 200.0, 80.0, 20.0, 30.0, 40.0, 20.0, 60.0, 0.0, 50.0, 0.0, 0.0, 300.0, 80.0, 170.0, 60.0, 50.0, 90.0, 110.0, 220.0, 40.0, 170.0, 150.0, 260.0, 30.0, 40.0, 60.0, 20.0, 60.0, 20.0, 20.0, 20.0, 560.0, 50.0, 120.0, 20.0, 90.0, -40.0, 190.0, 90.0, 160.0, 80.0, 10.0, 20.0, 30.0, 0.0, 10.0, 0.0, 50.0, 10.0, 40.0, 20.0, 0.0, 70.0, 10.0, 160.0, 60.0, 30.0, 0.0, 0.0, 20.0, 0.0, 80.0, 60.0, 60.0, 10.0, 40.0, 30.0, 10.0, 0.0, 60.0, 10.0, 70.0, 100.0, 30.0, 30.0, 30.0, 280.0, 0.0, 20.0, 35.0, 350.0, 10.0, 10.0, 0.0, 30.0, 20.0, 10.0, 0.0, 150.0, 250.0, 40.0, 20.0, 40.0, 20.0, 60.0, 60.0, 200.0, 30.0, -40.0, 170.0, 60.0, 40.0, 40.0, 230.0, 0.0, -5.0, 0.0, 350.0, -50.0, -20.0, 250.0, 10.0, 490.0, -30.0, 0.0, 10.0, 0.0, 0.0, 80.0, 0.0, -10.0, 80.0, 0.0, 10.0, 50.0, 0.0, 30.0, 450.0, 20.0, 0.0, 30.0, 40.0, 20.0, 0.0, 50.0, 130.0, 40.0, 40.0, 0.0, 0.0, 40.0, 10.0, 15.0, 10.0, 40.0, 40.0, 30.0, 20.0, 40.0, 370.0, 0.0, 50.0, 120.0, 40.0, 0.0, 160.0, 30.0, 40.0, 30.0, 10.0, 180.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 10.0, 20.0, 10.0, 30.0, 60.0, 30.0, 40.0, 30.0, 20.0, 20.0, 20.0, 0.0, 40.0, 10.0, 20.0, 180.0, 10.0, -20.0, 30.0, 50.0, 0.0, 20.0, 110.0, 0.0, 20.0, 0.0, 150.0, 40.0, 170.0, 0.0, 10.0, 0.0, 30.0, 10.0, 0.0, 160.0, 10.0, 20.0, 20.0, 10.0, 10.0, 80.0, 0.0, 20.0, 0.0, 20.0, 30.0, 0.0, 70.0, 60.0, 60.0, 250.0, 20.0, 30.0, 0.0, 150.0, 220.0, 50.0, 0.0, 30.0, 0.0, 20.0, 20.0, 40.0, 30.0, 10.0, 40.0, 0.0, 80.0, 10.0, 0.0, 0.0, 170.0, 70.0, 0.0, 20.0, 560.0, 50.0, 30.0, 0.0, 300.0, 10.0, 20.0, 40.0, 120.0, 30.0, 150.0, 0.0, 40.0, 10.0, 70.0, 70.0, 40.0, 0.0, 80.0, 30.0, 20.0, 100.0, 140.0, 30.0, 40.0, 250.0, 20.0, 10.0, 30.0, 20.0, 60.0, 90.0, 400.0, 110.0, 150.0, 80.0, 70.0, 0.0, -60.0, 350.0, 10.0, 150.0, 40.0, 20.0, 20.0, 60.0, 70.0, 0.0, 280.0, 290.0, 30.0, 40.0, 60.0, 30.0, 70.0, 80.0, 120.0, 30.0, 250.0, 20.0, -10.0, 40.0, 20.0, 20.0, 10.0, 20.0, -40.0, 30.0, 110.0, 140.0, 60.0, 260.0, 90.0, 60.0, 300.0, 0.0, 70.0, 20.0, 20.0, 550.0, 40.0, 20.0, 800.0, -30.0, -20.0, 60.0, 60.0, 110.0, 0.0, 20.0, 30.0, 20.0, 0.0, 0.0, 40.0, 20.0, 10.0, 10.0, -40.0, 0.0, 220.0, 20.0, 60.0, 30.0, 570.0, 20.0, 170.0, 10.0, 20.0, 40.0, 10.0, 10.0, 40.0, 80.0, 0.0, 10.0, 20.0, 20.0, 0.0, 90.0, 40.0, 150.0, 30.0, -15.0, 10.0, 260.0, 70.0, 70.0, 30.0, 10.0, 190.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 0.0, 0.0, 40.0, 50.0, 0.0, 0.0, 30.0, 210.0, 30.0, 10.0, 100.0, 60.0, 20.0, 30.0, 10.0, 20.0, 30.0, 0.0, 80.0, 70.0, 150.0, 0.0, 20.0, 70.0, 80.0, 40.0, 10.0, 20.0, 10.0, 20.0, 40.0, 160.0, 20.0, -40.0, 30.0, 40.0, 0.0, 10.0, 260.0, 40.0, 60.0, 20.0, 50.0, 40.0, 120.0, 30.0, 20.0, 10.0, 40.0, 10.0, 10.0, 20.0, 80.0, 20.0, 90.0, 40.0, 0.0, 30.0, 20.0, 10.0, 70.0, 120.0, 10.0, 160.0, 30.0, 30.0, 30.0, 30.0, 10.0, 10.0, 40.0, 20.0, 80.0, 20.0, 40.0, 30.0, 10.0, 170.0, -10.0, 20.0, 0.0, 0.0, 30.0, 10.0, 30.0, 60.0, 80.0, 40.0, 60.0, 40.0, 40.0, 10.0, 30.0, 40.0, 0.0, 10.0, 20.0, 40.0, 30.0, 0.0, 80.0, 0.0, 10.0, 40.0, 10.0, 30.0, 0.0, 50.0, 0.0, 0.0, 0.0, 20.0, 50.0, 20.0, 30.0, 0.0, 30.0, 190.0, 40.0, 30.0, 20.0, 0.0, 40.0, 0.0, 10.0, 30.0, 30.0, 30.0, 0.0, 20.0, 30.0, 40.0, 30.0, 40.0, 10.0, 0.0, 0.0, 0.0, 160.0, 30.0, 0.0, 160.0, 270.0, 90.0, 40.0, 80.0, 0.0, 60.0, 30.0, 570.0, 80.0, 270.0, 0.0, 60.0, 40.0, 40.0, 40.0, 50.0, 40.0, 30.0, 0.0, 160.0, 40.0, 20.0, 30.0, 20.0, 20.0, 30.0, 70.0, 0.0, 10.0, 10.0, 65.0, 40.0, 10.0, 350.0, 40.0, 210.0, 50.0, 20.0, 300.0, 0.0, 290.0, 10.0, 10.0, 0.0, 30.0, 25.0, 20.0, 40.0, 40.0, 0.0, 30.0, 20.0, 30.0, 60.0, 160.0, 20.0, 10.0, 20.0, 0.0, 80.0, 10.0, 10.0, 250.0, 90.0, 80.0, 20.0, 0.0, 30.0, 20.0, 60.0, 50.0, 30.0, 30.0, 20.0, 70.0, 140.0, 40.0, 40.0, 300.0, 30.0, 20.0, 30.0, 10.0, 10.0, 90.0, 40.0, 0.0, 20.0, 30.0, 30.0, 30.0, -20.0, 20.0, 0.0, 40.0, 30.0, 0.0, 30.0, 0.0, 0.0, 0.0, 10.0, 10.0, 70.0, 40.0, 20.0, 30.0, 30.0, 10.0, 30.0, 50.0, 20.0, 70.0, 30.0, 10.0, 30.0, 10.0, 170.0, 0.0, 0.0, 60.0, 0.0, 0.0, 20.0, 10.0, 10.0, 80.0, 40.0, 20.0, 20.0, 40.0, 10.0, 0.0, 20.0, 80.0, 20.0, 70.0, 0.0, 0.0, 20.0, 30.0, 70.0, 0.0, 40.0, 70.0, 0.0, 50.0, 200.0, 0.0, 0.0, 170.0, 30.0, 580.0, 0.0, 60.0, 110.0, 20.0, 60.0, 20.0, 20.0, 20.0, 50.0, 50.0, 30.0, 20.0, 20.0, 80.0, 30.0, 450.0, 400.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 30.0, 30.0, 20.0, 40.0, 10.0, 0.0, 0.0, 40.0, 60.0, 180.0, 30.0, 190.0, 40.0, 10.0, 0.0, 30.0, 20.0, 70.0, 20.0, 20.0, 30.0, 80.0, 10.0, 130.0, 10.0, 30.0, 460.0, 280.0, 20.0, 180.0, 10.0, 60.0, 50.0, 40.0, 30.0, 90.0, 20.0, 20.0, 0.0, 40.0, 30.0, 30.0, 30.0, 40.0, 0.0, 70.0, 40.0, 250.0, 30.0, 40.0, 40.0, 20.0, 10.0, 0.0, 30.0, 30.0, 10.0, 10.0, 40.0, 40.0, 100.0, 0.0, 10.0, 20.0, 0.0, 0.0, 40.0, 0.0, -30.0, 0.0, 20.0, 50.0, 20.0, 20.0, 50.0, 460.0, 40.0, -20.0, 50.0, 40.0, 80.0, 20.0, 50.0, 0.0, 10.0, 30.0, 50.0, 20.0, 80.0, 90.0, 250.0, 370.0, 10.0, 20.0, 0.0, 90.0, 20.0, 60.0, 40.0, 0.0, 40.0, 40.0, 0.0, 40.0, 60.0, 10.0, 60.0, 0.0, 10.0, 80.0, 50.0, 30.0, 150.0, 30.0, 20.0, 0.0, 30.0, 10.0, 10.0, 160.0, 20.0, 30.0, 15.0, 0.0, 10.0, 60.0, 60.0, 180.0, 10.0, 10.0, 50.0, 80.0, 0.0, 20.0, 20.0, 50.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 90.0, -40.0, 80.0, 70.0, 190.0, 20.0, 30.0, 370.0, 40.0, -30.0, 10.0, -50.0, 40.0, 30.0, 0.0, 0.0, 180.0, 0.0, 0.0, 40.0, 20.0, 50.0, 40.0, 40.0, 0.0, 20.0, 10.0, 40.0, 50.0, 0.0, 60.0, 0.0, 170.0, 20.0, 40.0, 280.0, 80.0, 20.0, -20.0, 30.0, 130.0, 260.0, 170.0, 110.0, 0.0, 20.0, 10.0, 640.0, -50.0, 40.0, -10.0, 20.0, 40.0, 60.0, 40.0, 40.0, 10.0, 20.0, 40.0, 150.0, 20.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.46738547668884, "mean_inference_ms": 1.666394209403021, "mean_action_processing_ms": 0.434647730098151, "mean_env_wait_ms": 1.338671715008927, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05449390411376953, "StateBufferConnector_ms": 0.008924245834350586, "ViewRequirementAgentConnector_ms": 0.36406683921813965}, "num_episodes": 18, "episode_return_max": 1610.0, "episode_return_min": 100.0, "episode_return_mean": 556.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.354468112029366, "num_env_steps_trained_throughput_per_sec": 36.354468112029366, "timesteps_total": 332000, "num_env_steps_sampled_lifetime": 332000, "num_agent_steps_sampled_lifetime": 3320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3320000, "timers": {"training_iteration_time_ms": 110175.533, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110175.483, "sample_time_ms": 2450.899, "learn_time_ms": 107704.931, "learn_throughput": 37.139, "synch_weights_time_ms": 11.034}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 3320000, "num_agent_steps_trained": 3320000}, "done": false, "training_iteration": 83, "trial_id": "57140_00000", "date": "2024-06-27_01-52-25", "timestamp": 1719467545, "time_this_iter_s": 110.0398530960083, "time_total_s": 9471.341025829315, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18e1f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9471.341025829315, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 15.46, "ram_util_percent": 79.18645161290323}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1946053634087246, "cur_kl_coeff": 1.9221679687499995, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.375127204944786, "policy_loss": -0.0035573231592165412, "vf_loss": 4.37663050728738, "vf_explained_var": 0.0009711030636605617, "kl": 0.0010685952394614176, "entropy": 0.4215600315786906, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 784065.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000}, "env_runners": {"episode_reward_max": 1610.0, "episode_reward_min": 100.0, "episode_reward_mean": 553.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 1000.0}, "policy_reward_mean": {"policy_0": 55.36}, "custom_metrics": {}, "hist_stats": {"episode_reward": [620.0, 835.0, 550.0, 670.0, 360.0, 575.0, 660.0, 140.0, 270.0, 400.0, 430.0, 330.0, 540.0, 530.0, 410.0, 1030.0, 530.0, 720.0, 1010.0, 660.0, 1030.0, 360.0, 1110.0, 1610.0, 150.0, 1060.0, 250.0, 705.0, 360.0, 470.0, 470.0, 310.0, 580.0, 350.0, 380.0, 470.0, 380.0, 390.0, 260.0, 140.0, 430.0, 190.0, 310.0, 1380.0, 570.0, 400.0, 1095.0, 465.0, 350.0, 590.0, 780.0, 280.0, 160.0, 220.0, 420.0, 240.0, 260.0, 480.0, 1050.0, 770.0, 450.0, 190.0, 630.0, 1070.0, 520.0, 530.0, 220.0, 250.0, 610.0, 350.0, 990.0, 290.0, 410.0, 545.0, 260.0, 100.0, 730.0, 360.0, 260.0, 1010.0, 950.0, 490.0, 1110.0, 1565.0, 395.0, 1050.0, 720.0, 770.0, 640.0, 195.0, 650.0, 230.0, 570.0, 340.0, 820.0, 710.0, 1020.0, 210.0, 150.0, 455.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 40.0, 20.0, 60.0, 60.0, 200.0, 30.0, -40.0, 170.0, 60.0, 40.0, 40.0, 230.0, 0.0, -5.0, 0.0, 350.0, -50.0, -20.0, 250.0, 10.0, 490.0, -30.0, 0.0, 10.0, 0.0, 0.0, 80.0, 0.0, -10.0, 80.0, 0.0, 10.0, 50.0, 0.0, 30.0, 450.0, 20.0, 0.0, 30.0, 40.0, 20.0, 0.0, 50.0, 130.0, 40.0, 40.0, 0.0, 0.0, 40.0, 10.0, 15.0, 10.0, 40.0, 40.0, 30.0, 20.0, 40.0, 370.0, 0.0, 50.0, 120.0, 40.0, 0.0, 160.0, 30.0, 40.0, 30.0, 10.0, 180.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 10.0, 20.0, 10.0, 30.0, 60.0, 30.0, 40.0, 30.0, 20.0, 20.0, 20.0, 0.0, 40.0, 10.0, 20.0, 180.0, 10.0, -20.0, 30.0, 50.0, 0.0, 20.0, 110.0, 0.0, 20.0, 0.0, 150.0, 40.0, 170.0, 0.0, 10.0, 0.0, 30.0, 10.0, 0.0, 160.0, 10.0, 20.0, 20.0, 10.0, 10.0, 80.0, 0.0, 20.0, 0.0, 20.0, 30.0, 0.0, 70.0, 60.0, 60.0, 250.0, 20.0, 30.0, 0.0, 150.0, 220.0, 50.0, 0.0, 30.0, 0.0, 20.0, 20.0, 40.0, 30.0, 10.0, 40.0, 0.0, 80.0, 10.0, 0.0, 0.0, 170.0, 70.0, 0.0, 20.0, 560.0, 50.0, 30.0, 0.0, 300.0, 10.0, 20.0, 40.0, 120.0, 30.0, 150.0, 0.0, 40.0, 10.0, 70.0, 70.0, 40.0, 0.0, 80.0, 30.0, 20.0, 100.0, 140.0, 30.0, 40.0, 250.0, 20.0, 10.0, 30.0, 20.0, 60.0, 90.0, 400.0, 110.0, 150.0, 80.0, 70.0, 0.0, -60.0, 350.0, 10.0, 150.0, 40.0, 20.0, 20.0, 60.0, 70.0, 0.0, 280.0, 290.0, 30.0, 40.0, 60.0, 30.0, 70.0, 80.0, 120.0, 30.0, 250.0, 20.0, -10.0, 40.0, 20.0, 20.0, 10.0, 20.0, -40.0, 30.0, 110.0, 140.0, 60.0, 260.0, 90.0, 60.0, 300.0, 0.0, 70.0, 20.0, 20.0, 550.0, 40.0, 20.0, 800.0, -30.0, -20.0, 60.0, 60.0, 110.0, 0.0, 20.0, 30.0, 20.0, 0.0, 0.0, 40.0, 20.0, 10.0, 10.0, -40.0, 0.0, 220.0, 20.0, 60.0, 30.0, 570.0, 20.0, 170.0, 10.0, 20.0, 40.0, 10.0, 10.0, 40.0, 80.0, 0.0, 10.0, 20.0, 20.0, 0.0, 90.0, 40.0, 150.0, 30.0, -15.0, 10.0, 260.0, 70.0, 70.0, 30.0, 10.0, 190.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 0.0, 0.0, 40.0, 50.0, 0.0, 0.0, 30.0, 210.0, 30.0, 10.0, 100.0, 60.0, 20.0, 30.0, 10.0, 20.0, 30.0, 0.0, 80.0, 70.0, 150.0, 0.0, 20.0, 70.0, 80.0, 40.0, 10.0, 20.0, 10.0, 20.0, 40.0, 160.0, 20.0, -40.0, 30.0, 40.0, 0.0, 10.0, 260.0, 40.0, 60.0, 20.0, 50.0, 40.0, 120.0, 30.0, 20.0, 10.0, 40.0, 10.0, 10.0, 20.0, 80.0, 20.0, 90.0, 40.0, 0.0, 30.0, 20.0, 10.0, 70.0, 120.0, 10.0, 160.0, 30.0, 30.0, 30.0, 30.0, 10.0, 10.0, 40.0, 20.0, 80.0, 20.0, 40.0, 30.0, 10.0, 170.0, -10.0, 20.0, 0.0, 0.0, 30.0, 10.0, 30.0, 60.0, 80.0, 40.0, 60.0, 40.0, 40.0, 10.0, 30.0, 40.0, 0.0, 10.0, 20.0, 40.0, 30.0, 0.0, 80.0, 0.0, 10.0, 40.0, 10.0, 30.0, 0.0, 50.0, 0.0, 0.0, 0.0, 20.0, 50.0, 20.0, 30.0, 0.0, 30.0, 190.0, 40.0, 30.0, 20.0, 0.0, 40.0, 0.0, 10.0, 30.0, 30.0, 30.0, 0.0, 20.0, 30.0, 40.0, 30.0, 40.0, 10.0, 0.0, 0.0, 0.0, 160.0, 30.0, 0.0, 160.0, 270.0, 90.0, 40.0, 80.0, 0.0, 60.0, 30.0, 570.0, 80.0, 270.0, 0.0, 60.0, 40.0, 40.0, 40.0, 50.0, 40.0, 30.0, 0.0, 160.0, 40.0, 20.0, 30.0, 20.0, 20.0, 30.0, 70.0, 0.0, 10.0, 10.0, 65.0, 40.0, 10.0, 350.0, 40.0, 210.0, 50.0, 20.0, 300.0, 0.0, 290.0, 10.0, 10.0, 0.0, 30.0, 25.0, 20.0, 40.0, 40.0, 0.0, 30.0, 20.0, 30.0, 60.0, 160.0, 20.0, 10.0, 20.0, 0.0, 80.0, 10.0, 10.0, 250.0, 90.0, 80.0, 20.0, 0.0, 30.0, 20.0, 60.0, 50.0, 30.0, 30.0, 20.0, 70.0, 140.0, 40.0, 40.0, 300.0, 30.0, 20.0, 30.0, 10.0, 10.0, 90.0, 40.0, 0.0, 20.0, 30.0, 30.0, 30.0, -20.0, 20.0, 0.0, 40.0, 30.0, 0.0, 30.0, 0.0, 0.0, 0.0, 10.0, 10.0, 70.0, 40.0, 20.0, 30.0, 30.0, 10.0, 30.0, 50.0, 20.0, 70.0, 30.0, 10.0, 30.0, 10.0, 170.0, 0.0, 0.0, 60.0, 0.0, 0.0, 20.0, 10.0, 10.0, 80.0, 40.0, 20.0, 20.0, 40.0, 10.0, 0.0, 20.0, 80.0, 20.0, 70.0, 0.0, 0.0, 20.0, 30.0, 70.0, 0.0, 40.0, 70.0, 0.0, 50.0, 200.0, 0.0, 0.0, 170.0, 30.0, 580.0, 0.0, 60.0, 110.0, 20.0, 60.0, 20.0, 20.0, 20.0, 50.0, 50.0, 30.0, 20.0, 20.0, 80.0, 30.0, 450.0, 400.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 30.0, 30.0, 20.0, 40.0, 10.0, 0.0, 0.0, 40.0, 60.0, 180.0, 30.0, 190.0, 40.0, 10.0, 0.0, 30.0, 20.0, 70.0, 20.0, 20.0, 30.0, 80.0, 10.0, 130.0, 10.0, 30.0, 460.0, 280.0, 20.0, 180.0, 10.0, 60.0, 50.0, 40.0, 30.0, 90.0, 20.0, 20.0, 0.0, 40.0, 30.0, 30.0, 30.0, 40.0, 0.0, 70.0, 40.0, 250.0, 30.0, 40.0, 40.0, 20.0, 10.0, 0.0, 30.0, 30.0, 10.0, 10.0, 40.0, 40.0, 100.0, 0.0, 10.0, 20.0, 0.0, 0.0, 40.0, 0.0, -30.0, 0.0, 20.0, 50.0, 20.0, 20.0, 50.0, 460.0, 40.0, -20.0, 50.0, 40.0, 80.0, 20.0, 50.0, 0.0, 10.0, 30.0, 50.0, 20.0, 80.0, 90.0, 250.0, 370.0, 10.0, 20.0, 0.0, 90.0, 20.0, 60.0, 40.0, 0.0, 40.0, 40.0, 0.0, 40.0, 60.0, 10.0, 60.0, 0.0, 10.0, 80.0, 50.0, 30.0, 150.0, 30.0, 20.0, 0.0, 30.0, 10.0, 10.0, 160.0, 20.0, 30.0, 15.0, 0.0, 10.0, 60.0, 60.0, 180.0, 10.0, 10.0, 50.0, 80.0, 0.0, 20.0, 20.0, 50.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 90.0, -40.0, 80.0, 70.0, 190.0, 20.0, 30.0, 370.0, 40.0, -30.0, 10.0, -50.0, 40.0, 30.0, 0.0, 0.0, 180.0, 0.0, 0.0, 40.0, 20.0, 50.0, 40.0, 40.0, 0.0, 20.0, 10.0, 40.0, 50.0, 0.0, 60.0, 0.0, 170.0, 20.0, 40.0, 280.0, 80.0, 20.0, -20.0, 30.0, 130.0, 260.0, 170.0, 110.0, 0.0, 20.0, 10.0, 640.0, -50.0, 40.0, -10.0, 20.0, 40.0, 60.0, 40.0, 40.0, 10.0, 20.0, 40.0, 150.0, 20.0, 70.0, 40.0, 90.0, 320.0, 20.0, 10.0, 350.0, 10.0, 40.0, 170.0, 60.0, 70.0, 40.0, 330.0, 30.0, 0.0, 1000.0, 10.0, -15.0, 70.0, 30.0, 10.0, 15.0, 20.0, 10.0, 20.0, 350.0, -30.0, 0.0, 0.0, 0.0, -50.0, 250.0, 460.0, 60.0, 40.0, 10.0, 150.0, 0.0, 30.0, 100.0, 50.0, 0.0, 40.0, 190.0, 90.0, 70.0, 40.0, 20.0, 160.0, 60.0, -30.0, 190.0, 50.0, 110.0, 360.0, -20.0, 0.0, 0.0, 50.0, 60.0, 80.0, 160.0, 70.0, 20.0, 20.0, 20.0, 20.0, 70.0, 50.0, 130.0, 10.0, 30.0, 35.0, 20.0, 40.0, 0.0, 20.0, 0.0, 10.0, 30.0, 280.0, -110.0, 30.0, 20.0, 50.0, 290.0, 60.0, 10.0, 10.0, 10.0, 10.0, 10.0, 40.0, 40.0, 20.0, 10.0, 70.0, 20.0, 10.0, 0.0, 30.0, 170.0, 10.0, 0.0, 0.0, 150.0, 20.0, 20.0, 140.0, 30.0, 0.0, 0.0, 60.0, 130.0, 40.0, 20.0, 20.0, 30.0, 20.0, 20.0, -40.0, 170.0, 10.0, 40.0, 20.0, 30.0, 70.0, 30.0, 30.0, 460.0, 20.0, 40.0, 40.0, 260.0, 70.0, 170.0, 30.0, 20.0, 0.0, 60.0, 40.0, 10.0, 30.0, 30.0, 30.0, 200.0, 560.0, 0.0, 50.0, 70.0, 0.0, 10.0, 30.0, 20.0, -40.0, 30.0, 60.0, 30.0, 40.0, 30.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 40.0, 30.0, 30.0, 0.0, 0.0, 30.0, 40.0, 90.0, 30.0, -5.0, 30.0, 30.0, 90.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.466369891487044, "mean_inference_ms": 1.6646857373019963, "mean_action_processing_ms": 0.43404382247737955, "mean_env_wait_ms": 1.337484945180924, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05495762825012207, "StateBufferConnector_ms": 0.008998632431030273, "ViewRequirementAgentConnector_ms": 0.3652927875518799}, "num_episodes": 18, "episode_return_max": 1610.0, "episode_return_min": 100.0, "episode_return_mean": 553.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 35.95961540052159, "num_env_steps_trained_throughput_per_sec": 35.95961540052159, "timesteps_total": 336000, "num_env_steps_sampled_lifetime": 336000, "num_agent_steps_sampled_lifetime": 3360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3360000, "timers": {"training_iteration_time_ms": 110176.522, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110176.472, "sample_time_ms": 2412.091, "learn_time_ms": 107743.713, "learn_throughput": 37.125, "synch_weights_time_ms": 11.128}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 3360000, "num_agent_steps_trained": 3360000}, "done": false, "training_iteration": 84, "trial_id": "57140_00000", "date": "2024-06-27_01-54-17", "timestamp": 1719467657, "time_this_iter_s": 111.27330207824707, "time_total_s": 9582.614327907562, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b193b310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9582.614327907562, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 18.021518987341775, "ram_util_percent": 78.73417721518987}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0333833182835606, "cur_kl_coeff": 0.9610839843749998, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.005102839132253164, "vf_loss": 4.696995065006585, "vf_explained_var": 0.0005380404135162711, "kl": Infinity, "entropy": 0.38589830396655267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 793455.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000}, "env_runners": {"episode_reward_max": 1640.0, "episode_reward_min": 100.0, "episode_reward_mean": 557.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 1000.0}, "policy_reward_mean": {"policy_0": 55.7}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1110.0, 1610.0, 150.0, 1060.0, 250.0, 705.0, 360.0, 470.0, 470.0, 310.0, 580.0, 350.0, 380.0, 470.0, 380.0, 390.0, 260.0, 140.0, 430.0, 190.0, 310.0, 1380.0, 570.0, 400.0, 1095.0, 465.0, 350.0, 590.0, 780.0, 280.0, 160.0, 220.0, 420.0, 240.0, 260.0, 480.0, 1050.0, 770.0, 450.0, 190.0, 630.0, 1070.0, 520.0, 530.0, 220.0, 250.0, 610.0, 350.0, 990.0, 290.0, 410.0, 545.0, 260.0, 100.0, 730.0, 360.0, 260.0, 1010.0, 950.0, 490.0, 1110.0, 1565.0, 395.0, 1050.0, 720.0, 770.0, 640.0, 195.0, 650.0, 230.0, 570.0, 340.0, 820.0, 710.0, 1020.0, 210.0, 150.0, 455.0, 500.0, 380.0, 820.0, 1150.0, 185.0, 1030.0, 160.0, 620.0, 1050.0, 170.0, 670.0, 230.0, 835.0, 1640.0, 670.0, 380.0, 310.0, 430.0, 160.0, 350.0, 580.0, 680.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [110.0, 140.0, 60.0, 260.0, 90.0, 60.0, 300.0, 0.0, 70.0, 20.0, 20.0, 550.0, 40.0, 20.0, 800.0, -30.0, -20.0, 60.0, 60.0, 110.0, 0.0, 20.0, 30.0, 20.0, 0.0, 0.0, 40.0, 20.0, 10.0, 10.0, -40.0, 0.0, 220.0, 20.0, 60.0, 30.0, 570.0, 20.0, 170.0, 10.0, 20.0, 40.0, 10.0, 10.0, 40.0, 80.0, 0.0, 10.0, 20.0, 20.0, 0.0, 90.0, 40.0, 150.0, 30.0, -15.0, 10.0, 260.0, 70.0, 70.0, 30.0, 10.0, 190.0, 10.0, 20.0, 30.0, 40.0, 10.0, 20.0, 0.0, 0.0, 40.0, 50.0, 0.0, 0.0, 30.0, 210.0, 30.0, 10.0, 100.0, 60.0, 20.0, 30.0, 10.0, 20.0, 30.0, 0.0, 80.0, 70.0, 150.0, 0.0, 20.0, 70.0, 80.0, 40.0, 10.0, 20.0, 10.0, 20.0, 40.0, 160.0, 20.0, -40.0, 30.0, 40.0, 0.0, 10.0, 260.0, 40.0, 60.0, 20.0, 50.0, 40.0, 120.0, 30.0, 20.0, 10.0, 40.0, 10.0, 10.0, 20.0, 80.0, 20.0, 90.0, 40.0, 0.0, 30.0, 20.0, 10.0, 70.0, 120.0, 10.0, 160.0, 30.0, 30.0, 30.0, 30.0, 10.0, 10.0, 40.0, 20.0, 80.0, 20.0, 40.0, 30.0, 10.0, 170.0, -10.0, 20.0, 0.0, 0.0, 30.0, 10.0, 30.0, 60.0, 80.0, 40.0, 60.0, 40.0, 40.0, 10.0, 30.0, 40.0, 0.0, 10.0, 20.0, 40.0, 30.0, 0.0, 80.0, 0.0, 10.0, 40.0, 10.0, 30.0, 0.0, 50.0, 0.0, 0.0, 0.0, 20.0, 50.0, 20.0, 30.0, 0.0, 30.0, 190.0, 40.0, 30.0, 20.0, 0.0, 40.0, 0.0, 10.0, 30.0, 30.0, 30.0, 0.0, 20.0, 30.0, 40.0, 30.0, 40.0, 10.0, 0.0, 0.0, 0.0, 160.0, 30.0, 0.0, 160.0, 270.0, 90.0, 40.0, 80.0, 0.0, 60.0, 30.0, 570.0, 80.0, 270.0, 0.0, 60.0, 40.0, 40.0, 40.0, 50.0, 40.0, 30.0, 0.0, 160.0, 40.0, 20.0, 30.0, 20.0, 20.0, 30.0, 70.0, 0.0, 10.0, 10.0, 65.0, 40.0, 10.0, 350.0, 40.0, 210.0, 50.0, 20.0, 300.0, 0.0, 290.0, 10.0, 10.0, 0.0, 30.0, 25.0, 20.0, 40.0, 40.0, 0.0, 30.0, 20.0, 30.0, 60.0, 160.0, 20.0, 10.0, 20.0, 0.0, 80.0, 10.0, 10.0, 250.0, 90.0, 80.0, 20.0, 0.0, 30.0, 20.0, 60.0, 50.0, 30.0, 30.0, 20.0, 70.0, 140.0, 40.0, 40.0, 300.0, 30.0, 20.0, 30.0, 10.0, 10.0, 90.0, 40.0, 0.0, 20.0, 30.0, 30.0, 30.0, -20.0, 20.0, 0.0, 40.0, 30.0, 0.0, 30.0, 0.0, 0.0, 0.0, 10.0, 10.0, 70.0, 40.0, 20.0, 30.0, 30.0, 10.0, 30.0, 50.0, 20.0, 70.0, 30.0, 10.0, 30.0, 10.0, 170.0, 0.0, 0.0, 60.0, 0.0, 0.0, 20.0, 10.0, 10.0, 80.0, 40.0, 20.0, 20.0, 40.0, 10.0, 0.0, 20.0, 80.0, 20.0, 70.0, 0.0, 0.0, 20.0, 30.0, 70.0, 0.0, 40.0, 70.0, 0.0, 50.0, 200.0, 0.0, 0.0, 170.0, 30.0, 580.0, 0.0, 60.0, 110.0, 20.0, 60.0, 20.0, 20.0, 20.0, 50.0, 50.0, 30.0, 20.0, 20.0, 80.0, 30.0, 450.0, 400.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 30.0, 30.0, 20.0, 40.0, 10.0, 0.0, 0.0, 40.0, 60.0, 180.0, 30.0, 190.0, 40.0, 10.0, 0.0, 30.0, 20.0, 70.0, 20.0, 20.0, 30.0, 80.0, 10.0, 130.0, 10.0, 30.0, 460.0, 280.0, 20.0, 180.0, 10.0, 60.0, 50.0, 40.0, 30.0, 90.0, 20.0, 20.0, 0.0, 40.0, 30.0, 30.0, 30.0, 40.0, 0.0, 70.0, 40.0, 250.0, 30.0, 40.0, 40.0, 20.0, 10.0, 0.0, 30.0, 30.0, 10.0, 10.0, 40.0, 40.0, 100.0, 0.0, 10.0, 20.0, 0.0, 0.0, 40.0, 0.0, -30.0, 0.0, 20.0, 50.0, 20.0, 20.0, 50.0, 460.0, 40.0, -20.0, 50.0, 40.0, 80.0, 20.0, 50.0, 0.0, 10.0, 30.0, 50.0, 20.0, 80.0, 90.0, 250.0, 370.0, 10.0, 20.0, 0.0, 90.0, 20.0, 60.0, 40.0, 0.0, 40.0, 40.0, 0.0, 40.0, 60.0, 10.0, 60.0, 0.0, 10.0, 80.0, 50.0, 30.0, 150.0, 30.0, 20.0, 0.0, 30.0, 10.0, 10.0, 160.0, 20.0, 30.0, 15.0, 0.0, 10.0, 60.0, 60.0, 180.0, 10.0, 10.0, 50.0, 80.0, 0.0, 20.0, 20.0, 50.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 90.0, -40.0, 80.0, 70.0, 190.0, 20.0, 30.0, 370.0, 40.0, -30.0, 10.0, -50.0, 40.0, 30.0, 0.0, 0.0, 180.0, 0.0, 0.0, 40.0, 20.0, 50.0, 40.0, 40.0, 0.0, 20.0, 10.0, 40.0, 50.0, 0.0, 60.0, 0.0, 170.0, 20.0, 40.0, 280.0, 80.0, 20.0, -20.0, 30.0, 130.0, 260.0, 170.0, 110.0, 0.0, 20.0, 10.0, 640.0, -50.0, 40.0, -10.0, 20.0, 40.0, 60.0, 40.0, 40.0, 10.0, 20.0, 40.0, 150.0, 20.0, 70.0, 40.0, 90.0, 320.0, 20.0, 10.0, 350.0, 10.0, 40.0, 170.0, 60.0, 70.0, 40.0, 330.0, 30.0, 0.0, 1000.0, 10.0, -15.0, 70.0, 30.0, 10.0, 15.0, 20.0, 10.0, 20.0, 350.0, -30.0, 0.0, 0.0, 0.0, -50.0, 250.0, 460.0, 60.0, 40.0, 10.0, 150.0, 0.0, 30.0, 100.0, 50.0, 0.0, 40.0, 190.0, 90.0, 70.0, 40.0, 20.0, 160.0, 60.0, -30.0, 190.0, 50.0, 110.0, 360.0, -20.0, 0.0, 0.0, 50.0, 60.0, 80.0, 160.0, 70.0, 20.0, 20.0, 20.0, 20.0, 70.0, 50.0, 130.0, 10.0, 30.0, 35.0, 20.0, 40.0, 0.0, 20.0, 0.0, 10.0, 30.0, 280.0, -110.0, 30.0, 20.0, 50.0, 290.0, 60.0, 10.0, 10.0, 10.0, 10.0, 10.0, 40.0, 40.0, 20.0, 10.0, 70.0, 20.0, 10.0, 0.0, 30.0, 170.0, 10.0, 0.0, 0.0, 150.0, 20.0, 20.0, 140.0, 30.0, 0.0, 0.0, 60.0, 130.0, 40.0, 20.0, 20.0, 30.0, 20.0, 20.0, -40.0, 170.0, 10.0, 40.0, 20.0, 30.0, 70.0, 30.0, 30.0, 460.0, 20.0, 40.0, 40.0, 260.0, 70.0, 170.0, 30.0, 20.0, 0.0, 60.0, 40.0, 10.0, 30.0, 30.0, 30.0, 200.0, 560.0, 0.0, 50.0, 70.0, 0.0, 10.0, 30.0, 20.0, -40.0, 30.0, 60.0, 30.0, 40.0, 30.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 40.0, 30.0, 30.0, 0.0, 0.0, 30.0, 40.0, 90.0, 30.0, -5.0, 30.0, 30.0, 90.0, 120.0, 30.0, 10.0, 10.0, 10.0, 10.0, 30.0, 140.0, 40.0, 40.0, 180.0, 0.0, 20.0, 10.0, 90.0, 70.0, 30.0, 0.0, 80.0, 40.0, 40.0, 40.0, 70.0, 170.0, 370.0, -90.0, 50.0, 60.0, 10.0, -50.0, 190.0, 80.0, 50.0, 110.0, 120.0, -30.0, 110.0, 10.0, 470.0, 150.0, 80.0, 0.0, 20.0, 30.0, 30.0, 20.0, 25.0, 0.0, 30.0, 30.0, 0.0, 200.0, 60.0, 120.0, 180.0, 0.0, 80.0, 350.0, 0.0, 60.0, -20.0, 20.0, 30.0, 30.0, 40.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 30.0, 200.0, 20.0, 10.0, 10.0, 0.0, 40.0, 260.0, 20.0, 30.0, 0.0, 580.0, 70.0, 150.0, 30.0, 50.0, 40.0, 30.0, 90.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 20.0, 20.0, 40.0, 40.0, 0.0, 360.0, 50.0, 10.0, 20.0, 60.0, 60.0, 30.0, 10.0, 30.0, 30.0, 0.0, 20.0, 60.0, 0.0, 40.0, 40.0, 0.0, -50.0, 130.0, 370.0, 40.0, 90.0, 50.0, 75.0, 160.0, -40.0, 10.0, 90.0, 110.0, -20.0, 940.0, 170.0, 180.0, 170.0, 10.0, -10.0, 0.0, 0.0, 10.0, 30.0, 10.0, 30.0, 20.0, 170.0, 10.0, 30.0, 360.0, 90.0, 10.0, 10.0, 70.0, 20.0, 20.0, 30.0, 30.0, 20.0, 80.0, 20.0, 40.0, 0.0, 30.0, 20.0, 30.0, 60.0, 0.0, 70.0, 40.0, 40.0, 10.0, 20.0, 90.0, 0.0, 0.0, 40.0, 0.0, 50.0, 180.0, 60.0, 0.0, 30.0, 30.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 30.0, 70.0, 30.0, 40.0, 90.0, 50.0, 20.0, 0.0, 80.0, 90.0, 0.0, 30.0, 30.0, 10.0, 0.0, 320.0, 10.0, 10.0, 30.0, 20.0, 50.0, 50.0, 0.0, 30.0, 40.0, 270.0, -70.0, 260.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4647393451558848, "mean_inference_ms": 1.6630066462194681, "mean_action_processing_ms": 0.4333655075949045, "mean_env_wait_ms": 1.3361186882457747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056954383850097656, "StateBufferConnector_ms": 0.013030052185058594, "ViewRequirementAgentConnector_ms": 0.3708975315093994}, "num_episodes": 22, "episode_return_max": 1640.0, "episode_return_min": 100.0, "episode_return_mean": 557.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.22643329408066, "num_env_steps_trained_throughput_per_sec": 36.22643329408066, "timesteps_total": 340000, "num_env_steps_sampled_lifetime": 340000, "num_agent_steps_sampled_lifetime": 3400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3400000, "timers": {"training_iteration_time_ms": 110227.889, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110227.839, "sample_time_ms": 2423.861, "learn_time_ms": 107783.251, "learn_throughput": 37.112, "synch_weights_time_ms": 11.065}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 3400000, "num_agent_steps_trained": 3400000}, "done": false, "training_iteration": 85, "trial_id": "57140_00000", "date": "2024-06-27_01-56-07", "timestamp": 1719467767, "time_this_iter_s": 110.4285180568695, "time_total_s": 9693.042845964432, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18cbc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9693.042845964432, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 17.78653846153846, "ram_util_percent": 78.9173076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0645411824519897, "cur_kl_coeff": 1.4416259765625, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004014581568287219, "vf_loss": 4.462213859365137, "vf_explained_var": 0.0007209662113961574, "kl": Infinity, "entropy": 0.41698257264237815, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 802845.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000}, "env_runners": {"episode_reward_max": 1640.0, "episode_reward_min": 100.0, "episode_reward_mean": 571.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 1000.0}, "policy_reward_mean": {"policy_0": 57.175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [430.0, 190.0, 310.0, 1380.0, 570.0, 400.0, 1095.0, 465.0, 350.0, 590.0, 780.0, 280.0, 160.0, 220.0, 420.0, 240.0, 260.0, 480.0, 1050.0, 770.0, 450.0, 190.0, 630.0, 1070.0, 520.0, 530.0, 220.0, 250.0, 610.0, 350.0, 990.0, 290.0, 410.0, 545.0, 260.0, 100.0, 730.0, 360.0, 260.0, 1010.0, 950.0, 490.0, 1110.0, 1565.0, 395.0, 1050.0, 720.0, 770.0, 640.0, 195.0, 650.0, 230.0, 570.0, 340.0, 820.0, 710.0, 1020.0, 210.0, 150.0, 455.0, 500.0, 380.0, 820.0, 1150.0, 185.0, 1030.0, 160.0, 620.0, 1050.0, 170.0, 670.0, 230.0, 835.0, 1640.0, 670.0, 380.0, 310.0, 430.0, 160.0, 350.0, 580.0, 680.0, 460.0, 940.0, 575.0, 380.0, 420.0, 570.0, 360.0, 390.0, 830.0, 550.0, 260.0, 1030.0, 1100.0, 370.0, 395.0, 1320.0, 460.0, 510.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 50.0, 20.0, 30.0, 0.0, 30.0, 190.0, 40.0, 30.0, 20.0, 0.0, 40.0, 0.0, 10.0, 30.0, 30.0, 30.0, 0.0, 20.0, 30.0, 40.0, 30.0, 40.0, 10.0, 0.0, 0.0, 0.0, 160.0, 30.0, 0.0, 160.0, 270.0, 90.0, 40.0, 80.0, 0.0, 60.0, 30.0, 570.0, 80.0, 270.0, 0.0, 60.0, 40.0, 40.0, 40.0, 50.0, 40.0, 30.0, 0.0, 160.0, 40.0, 20.0, 30.0, 20.0, 20.0, 30.0, 70.0, 0.0, 10.0, 10.0, 65.0, 40.0, 10.0, 350.0, 40.0, 210.0, 50.0, 20.0, 300.0, 0.0, 290.0, 10.0, 10.0, 0.0, 30.0, 25.0, 20.0, 40.0, 40.0, 0.0, 30.0, 20.0, 30.0, 60.0, 160.0, 20.0, 10.0, 20.0, 0.0, 80.0, 10.0, 10.0, 250.0, 90.0, 80.0, 20.0, 0.0, 30.0, 20.0, 60.0, 50.0, 30.0, 30.0, 20.0, 70.0, 140.0, 40.0, 40.0, 300.0, 30.0, 20.0, 30.0, 10.0, 10.0, 90.0, 40.0, 0.0, 20.0, 30.0, 30.0, 30.0, -20.0, 20.0, 0.0, 40.0, 30.0, 0.0, 30.0, 0.0, 0.0, 0.0, 10.0, 10.0, 70.0, 40.0, 20.0, 30.0, 30.0, 10.0, 30.0, 50.0, 20.0, 70.0, 30.0, 10.0, 30.0, 10.0, 170.0, 0.0, 0.0, 60.0, 0.0, 0.0, 20.0, 10.0, 10.0, 80.0, 40.0, 20.0, 20.0, 40.0, 10.0, 0.0, 20.0, 80.0, 20.0, 70.0, 0.0, 0.0, 20.0, 30.0, 70.0, 0.0, 40.0, 70.0, 0.0, 50.0, 200.0, 0.0, 0.0, 170.0, 30.0, 580.0, 0.0, 60.0, 110.0, 20.0, 60.0, 20.0, 20.0, 20.0, 50.0, 50.0, 30.0, 20.0, 20.0, 80.0, 30.0, 450.0, 400.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 30.0, 30.0, 20.0, 40.0, 10.0, 0.0, 0.0, 40.0, 60.0, 180.0, 30.0, 190.0, 40.0, 10.0, 0.0, 30.0, 20.0, 70.0, 20.0, 20.0, 30.0, 80.0, 10.0, 130.0, 10.0, 30.0, 460.0, 280.0, 20.0, 180.0, 10.0, 60.0, 50.0, 40.0, 30.0, 90.0, 20.0, 20.0, 0.0, 40.0, 30.0, 30.0, 30.0, 40.0, 0.0, 70.0, 40.0, 250.0, 30.0, 40.0, 40.0, 20.0, 10.0, 0.0, 30.0, 30.0, 10.0, 10.0, 40.0, 40.0, 100.0, 0.0, 10.0, 20.0, 0.0, 0.0, 40.0, 0.0, -30.0, 0.0, 20.0, 50.0, 20.0, 20.0, 50.0, 460.0, 40.0, -20.0, 50.0, 40.0, 80.0, 20.0, 50.0, 0.0, 10.0, 30.0, 50.0, 20.0, 80.0, 90.0, 250.0, 370.0, 10.0, 20.0, 0.0, 90.0, 20.0, 60.0, 40.0, 0.0, 40.0, 40.0, 0.0, 40.0, 60.0, 10.0, 60.0, 0.0, 10.0, 80.0, 50.0, 30.0, 150.0, 30.0, 20.0, 0.0, 30.0, 10.0, 10.0, 160.0, 20.0, 30.0, 15.0, 0.0, 10.0, 60.0, 60.0, 180.0, 10.0, 10.0, 50.0, 80.0, 0.0, 20.0, 20.0, 50.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 90.0, -40.0, 80.0, 70.0, 190.0, 20.0, 30.0, 370.0, 40.0, -30.0, 10.0, -50.0, 40.0, 30.0, 0.0, 0.0, 180.0, 0.0, 0.0, 40.0, 20.0, 50.0, 40.0, 40.0, 0.0, 20.0, 10.0, 40.0, 50.0, 0.0, 60.0, 0.0, 170.0, 20.0, 40.0, 280.0, 80.0, 20.0, -20.0, 30.0, 130.0, 260.0, 170.0, 110.0, 0.0, 20.0, 10.0, 640.0, -50.0, 40.0, -10.0, 20.0, 40.0, 60.0, 40.0, 40.0, 10.0, 20.0, 40.0, 150.0, 20.0, 70.0, 40.0, 90.0, 320.0, 20.0, 10.0, 350.0, 10.0, 40.0, 170.0, 60.0, 70.0, 40.0, 330.0, 30.0, 0.0, 1000.0, 10.0, -15.0, 70.0, 30.0, 10.0, 15.0, 20.0, 10.0, 20.0, 350.0, -30.0, 0.0, 0.0, 0.0, -50.0, 250.0, 460.0, 60.0, 40.0, 10.0, 150.0, 0.0, 30.0, 100.0, 50.0, 0.0, 40.0, 190.0, 90.0, 70.0, 40.0, 20.0, 160.0, 60.0, -30.0, 190.0, 50.0, 110.0, 360.0, -20.0, 0.0, 0.0, 50.0, 60.0, 80.0, 160.0, 70.0, 20.0, 20.0, 20.0, 20.0, 70.0, 50.0, 130.0, 10.0, 30.0, 35.0, 20.0, 40.0, 0.0, 20.0, 0.0, 10.0, 30.0, 280.0, -110.0, 30.0, 20.0, 50.0, 290.0, 60.0, 10.0, 10.0, 10.0, 10.0, 10.0, 40.0, 40.0, 20.0, 10.0, 70.0, 20.0, 10.0, 0.0, 30.0, 170.0, 10.0, 0.0, 0.0, 150.0, 20.0, 20.0, 140.0, 30.0, 0.0, 0.0, 60.0, 130.0, 40.0, 20.0, 20.0, 30.0, 20.0, 20.0, -40.0, 170.0, 10.0, 40.0, 20.0, 30.0, 70.0, 30.0, 30.0, 460.0, 20.0, 40.0, 40.0, 260.0, 70.0, 170.0, 30.0, 20.0, 0.0, 60.0, 40.0, 10.0, 30.0, 30.0, 30.0, 200.0, 560.0, 0.0, 50.0, 70.0, 0.0, 10.0, 30.0, 20.0, -40.0, 30.0, 60.0, 30.0, 40.0, 30.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 40.0, 30.0, 30.0, 0.0, 0.0, 30.0, 40.0, 90.0, 30.0, -5.0, 30.0, 30.0, 90.0, 120.0, 30.0, 10.0, 10.0, 10.0, 10.0, 30.0, 140.0, 40.0, 40.0, 180.0, 0.0, 20.0, 10.0, 90.0, 70.0, 30.0, 0.0, 80.0, 40.0, 40.0, 40.0, 70.0, 170.0, 370.0, -90.0, 50.0, 60.0, 10.0, -50.0, 190.0, 80.0, 50.0, 110.0, 120.0, -30.0, 110.0, 10.0, 470.0, 150.0, 80.0, 0.0, 20.0, 30.0, 30.0, 20.0, 25.0, 0.0, 30.0, 30.0, 0.0, 200.0, 60.0, 120.0, 180.0, 0.0, 80.0, 350.0, 0.0, 60.0, -20.0, 20.0, 30.0, 30.0, 40.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 30.0, 200.0, 20.0, 10.0, 10.0, 0.0, 40.0, 260.0, 20.0, 30.0, 0.0, 580.0, 70.0, 150.0, 30.0, 50.0, 40.0, 30.0, 90.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 20.0, 20.0, 40.0, 40.0, 0.0, 360.0, 50.0, 10.0, 20.0, 60.0, 60.0, 30.0, 10.0, 30.0, 30.0, 0.0, 20.0, 60.0, 0.0, 40.0, 40.0, 0.0, -50.0, 130.0, 370.0, 40.0, 90.0, 50.0, 75.0, 160.0, -40.0, 10.0, 90.0, 110.0, -20.0, 940.0, 170.0, 180.0, 170.0, 10.0, -10.0, 0.0, 0.0, 10.0, 30.0, 10.0, 30.0, 20.0, 170.0, 10.0, 30.0, 360.0, 90.0, 10.0, 10.0, 70.0, 20.0, 20.0, 30.0, 30.0, 20.0, 80.0, 20.0, 40.0, 0.0, 30.0, 20.0, 30.0, 60.0, 0.0, 70.0, 40.0, 40.0, 10.0, 20.0, 90.0, 0.0, 0.0, 40.0, 0.0, 50.0, 180.0, 60.0, 0.0, 30.0, 30.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 30.0, 70.0, 30.0, 40.0, 90.0, 50.0, 20.0, 0.0, 80.0, 90.0, 0.0, 30.0, 30.0, 10.0, 0.0, 320.0, 10.0, 10.0, 30.0, 20.0, 50.0, 50.0, 0.0, 30.0, 40.0, 270.0, -70.0, 260.0, 50.0, 0.0, 40.0, 20.0, 0.0, 170.0, 10.0, 40.0, 100.0, 30.0, 90.0, 20.0, 40.0, 120.0, 20.0, 420.0, 180.0, 10.0, 40.0, 0.0, 20.0, 15.0, -10.0, 0.0, 10.0, 30.0, 110.0, 120.0, 20.0, 260.0, 0.0, 80.0, 50.0, 20.0, 160.0, 10.0, 10.0, 0.0, 20.0, 30.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 30.0, 80.0, 130.0, 110.0, 120.0, 80.0, 80.0, 10.0, 0.0, 0.0, 50.0, 10.0, 40.0, 180.0, 10.0, 40.0, 10.0, 10.0, 30.0, 50.0, 160.0, 0.0, 20.0, 30.0, 20.0, 10.0, 40.0, 0.0, 30.0, 160.0, 70.0, 0.0, 20.0, 40.0, 10.0, 360.0, 150.0, 40.0, 80.0, 60.0, -10.0, 40.0, 70.0, 30.0, 170.0, 100.0, -40.0, 20.0, 10.0, 150.0, 20.0, 20.0, 40.0, 60.0, 40.0, 0.0, 70.0, 30.0, 20.0, 0.0, 20.0, 40.0, 20.0, 20.0, 350.0, 0.0, 10.0, -20.0, 280.0, 40.0, 160.0, 70.0, 50.0, 90.0, 20.0, 30.0, 0.0, 50.0, 20.0, 380.0, 400.0, 40.0, 130.0, 30.0, 0.0, 0.0, 90.0, 30.0, 20.0, 10.0, 60.0, 70.0, 80.0, 10.0, 70.0, -5.0, 20.0, 10.0, 10.0, 0.0, 220.0, 20.0, 10.0, 40.0, 20.0, 360.0, 120.0, 50.0, 110.0, 30.0, 80.0, 50.0, 470.0, 30.0, 0.0, 80.0, 10.0, 30.0, 0.0, 110.0, 170.0, 20.0, 40.0, 0.0, 80.0, 10.0, 160.0, 10.0, 80.0, 20.0, 70.0, 40.0, 30.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4634344518271296, "mean_inference_ms": 1.6617240282744783, "mean_action_processing_ms": 0.43284866235622027, "mean_env_wait_ms": 1.3350206341673694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.057533979415893555, "StateBufferConnector_ms": 0.013193130493164062, "ViewRequirementAgentConnector_ms": 0.3734927177429199}, "num_episodes": 18, "episode_return_max": 1640.0, "episode_return_min": 100.0, "episode_return_mean": 571.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.34941216323679, "num_env_steps_trained_throughput_per_sec": 36.34941216323679, "timesteps_total": 344000, "num_env_steps_sampled_lifetime": 344000, "num_agent_steps_sampled_lifetime": 3440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3440000, "timers": {"training_iteration_time_ms": 110232.092, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110232.042, "sample_time_ms": 2416.361, "learn_time_ms": 107794.984, "learn_throughput": 37.107, "synch_weights_time_ms": 10.884}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 3440000, "num_agent_steps_trained": 3440000}, "done": false, "training_iteration": 86, "trial_id": "57140_00000", "date": "2024-06-27_01-57-57", "timestamp": 1719467877, "time_this_iter_s": 110.05767297744751, "time_total_s": 9803.10051894188, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18e1670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9803.10051894188, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 16.602580645161293, "ram_util_percent": 79.19612903225807}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0798419141763063, "cur_kl_coeff": 2.1624389648437505, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0029543153921050974, "vf_loss": 3.8761703023768335, "vf_explained_var": 0.0004433461144582405, "kl": Infinity, "entropy": 0.4074724367314888, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 812235.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000}, "env_runners": {"episode_reward_max": 1640.0, "episode_reward_min": 70.0, "episode_reward_mean": 585.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 1000.0}, "policy_reward_mean": {"policy_0": 58.585}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1070.0, 520.0, 530.0, 220.0, 250.0, 610.0, 350.0, 990.0, 290.0, 410.0, 545.0, 260.0, 100.0, 730.0, 360.0, 260.0, 1010.0, 950.0, 490.0, 1110.0, 1565.0, 395.0, 1050.0, 720.0, 770.0, 640.0, 195.0, 650.0, 230.0, 570.0, 340.0, 820.0, 710.0, 1020.0, 210.0, 150.0, 455.0, 500.0, 380.0, 820.0, 1150.0, 185.0, 1030.0, 160.0, 620.0, 1050.0, 170.0, 670.0, 230.0, 835.0, 1640.0, 670.0, 380.0, 310.0, 430.0, 160.0, 350.0, 580.0, 680.0, 460.0, 940.0, 575.0, 380.0, 420.0, 570.0, 360.0, 390.0, 830.0, 550.0, 260.0, 1030.0, 1100.0, 370.0, 395.0, 1320.0, 460.0, 510.0, 70.0, 290.0, 950.0, 380.0, 430.0, 1140.0, 110.0, 1380.0, 1240.0, 260.0, 420.0, 460.0, 410.0, 740.0, 390.0, 120.0, 500.0, 650.0, 510.0, 1100.0, 250.0, 900.0, 420.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 20.0, 30.0, 80.0, 10.0, 130.0, 10.0, 30.0, 460.0, 280.0, 20.0, 180.0, 10.0, 60.0, 50.0, 40.0, 30.0, 90.0, 20.0, 20.0, 0.0, 40.0, 30.0, 30.0, 30.0, 40.0, 0.0, 70.0, 40.0, 250.0, 30.0, 40.0, 40.0, 20.0, 10.0, 0.0, 30.0, 30.0, 10.0, 10.0, 40.0, 40.0, 100.0, 0.0, 10.0, 20.0, 0.0, 0.0, 40.0, 0.0, -30.0, 0.0, 20.0, 50.0, 20.0, 20.0, 50.0, 460.0, 40.0, -20.0, 50.0, 40.0, 80.0, 20.0, 50.0, 0.0, 10.0, 30.0, 50.0, 20.0, 80.0, 90.0, 250.0, 370.0, 10.0, 20.0, 0.0, 90.0, 20.0, 60.0, 40.0, 0.0, 40.0, 40.0, 0.0, 40.0, 60.0, 10.0, 60.0, 0.0, 10.0, 80.0, 50.0, 30.0, 150.0, 30.0, 20.0, 0.0, 30.0, 10.0, 10.0, 160.0, 20.0, 30.0, 15.0, 0.0, 10.0, 60.0, 60.0, 180.0, 10.0, 10.0, 50.0, 80.0, 0.0, 20.0, 20.0, 50.0, 10.0, 10.0, 20.0, 0.0, 10.0, 0.0, 10.0, 0.0, 0.0, 10.0, 90.0, -40.0, 80.0, 70.0, 190.0, 20.0, 30.0, 370.0, 40.0, -30.0, 10.0, -50.0, 40.0, 30.0, 0.0, 0.0, 180.0, 0.0, 0.0, 40.0, 20.0, 50.0, 40.0, 40.0, 0.0, 20.0, 10.0, 40.0, 50.0, 0.0, 60.0, 0.0, 170.0, 20.0, 40.0, 280.0, 80.0, 20.0, -20.0, 30.0, 130.0, 260.0, 170.0, 110.0, 0.0, 20.0, 10.0, 640.0, -50.0, 40.0, -10.0, 20.0, 40.0, 60.0, 40.0, 40.0, 10.0, 20.0, 40.0, 150.0, 20.0, 70.0, 40.0, 90.0, 320.0, 20.0, 10.0, 350.0, 10.0, 40.0, 170.0, 60.0, 70.0, 40.0, 330.0, 30.0, 0.0, 1000.0, 10.0, -15.0, 70.0, 30.0, 10.0, 15.0, 20.0, 10.0, 20.0, 350.0, -30.0, 0.0, 0.0, 0.0, -50.0, 250.0, 460.0, 60.0, 40.0, 10.0, 150.0, 0.0, 30.0, 100.0, 50.0, 0.0, 40.0, 190.0, 90.0, 70.0, 40.0, 20.0, 160.0, 60.0, -30.0, 190.0, 50.0, 110.0, 360.0, -20.0, 0.0, 0.0, 50.0, 60.0, 80.0, 160.0, 70.0, 20.0, 20.0, 20.0, 20.0, 70.0, 50.0, 130.0, 10.0, 30.0, 35.0, 20.0, 40.0, 0.0, 20.0, 0.0, 10.0, 30.0, 280.0, -110.0, 30.0, 20.0, 50.0, 290.0, 60.0, 10.0, 10.0, 10.0, 10.0, 10.0, 40.0, 40.0, 20.0, 10.0, 70.0, 20.0, 10.0, 0.0, 30.0, 170.0, 10.0, 0.0, 0.0, 150.0, 20.0, 20.0, 140.0, 30.0, 0.0, 0.0, 60.0, 130.0, 40.0, 20.0, 20.0, 30.0, 20.0, 20.0, -40.0, 170.0, 10.0, 40.0, 20.0, 30.0, 70.0, 30.0, 30.0, 460.0, 20.0, 40.0, 40.0, 260.0, 70.0, 170.0, 30.0, 20.0, 0.0, 60.0, 40.0, 10.0, 30.0, 30.0, 30.0, 200.0, 560.0, 0.0, 50.0, 70.0, 0.0, 10.0, 30.0, 20.0, -40.0, 30.0, 60.0, 30.0, 40.0, 30.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 40.0, 30.0, 30.0, 0.0, 0.0, 30.0, 40.0, 90.0, 30.0, -5.0, 30.0, 30.0, 90.0, 120.0, 30.0, 10.0, 10.0, 10.0, 10.0, 30.0, 140.0, 40.0, 40.0, 180.0, 0.0, 20.0, 10.0, 90.0, 70.0, 30.0, 0.0, 80.0, 40.0, 40.0, 40.0, 70.0, 170.0, 370.0, -90.0, 50.0, 60.0, 10.0, -50.0, 190.0, 80.0, 50.0, 110.0, 120.0, -30.0, 110.0, 10.0, 470.0, 150.0, 80.0, 0.0, 20.0, 30.0, 30.0, 20.0, 25.0, 0.0, 30.0, 30.0, 0.0, 200.0, 60.0, 120.0, 180.0, 0.0, 80.0, 350.0, 0.0, 60.0, -20.0, 20.0, 30.0, 30.0, 40.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 30.0, 200.0, 20.0, 10.0, 10.0, 0.0, 40.0, 260.0, 20.0, 30.0, 0.0, 580.0, 70.0, 150.0, 30.0, 50.0, 40.0, 30.0, 90.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 20.0, 20.0, 40.0, 40.0, 0.0, 360.0, 50.0, 10.0, 20.0, 60.0, 60.0, 30.0, 10.0, 30.0, 30.0, 0.0, 20.0, 60.0, 0.0, 40.0, 40.0, 0.0, -50.0, 130.0, 370.0, 40.0, 90.0, 50.0, 75.0, 160.0, -40.0, 10.0, 90.0, 110.0, -20.0, 940.0, 170.0, 180.0, 170.0, 10.0, -10.0, 0.0, 0.0, 10.0, 30.0, 10.0, 30.0, 20.0, 170.0, 10.0, 30.0, 360.0, 90.0, 10.0, 10.0, 70.0, 20.0, 20.0, 30.0, 30.0, 20.0, 80.0, 20.0, 40.0, 0.0, 30.0, 20.0, 30.0, 60.0, 0.0, 70.0, 40.0, 40.0, 10.0, 20.0, 90.0, 0.0, 0.0, 40.0, 0.0, 50.0, 180.0, 60.0, 0.0, 30.0, 30.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 30.0, 70.0, 30.0, 40.0, 90.0, 50.0, 20.0, 0.0, 80.0, 90.0, 0.0, 30.0, 30.0, 10.0, 0.0, 320.0, 10.0, 10.0, 30.0, 20.0, 50.0, 50.0, 0.0, 30.0, 40.0, 270.0, -70.0, 260.0, 50.0, 0.0, 40.0, 20.0, 0.0, 170.0, 10.0, 40.0, 100.0, 30.0, 90.0, 20.0, 40.0, 120.0, 20.0, 420.0, 180.0, 10.0, 40.0, 0.0, 20.0, 15.0, -10.0, 0.0, 10.0, 30.0, 110.0, 120.0, 20.0, 260.0, 0.0, 80.0, 50.0, 20.0, 160.0, 10.0, 10.0, 0.0, 20.0, 30.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 30.0, 80.0, 130.0, 110.0, 120.0, 80.0, 80.0, 10.0, 0.0, 0.0, 50.0, 10.0, 40.0, 180.0, 10.0, 40.0, 10.0, 10.0, 30.0, 50.0, 160.0, 0.0, 20.0, 30.0, 20.0, 10.0, 40.0, 0.0, 30.0, 160.0, 70.0, 0.0, 20.0, 40.0, 10.0, 360.0, 150.0, 40.0, 80.0, 60.0, -10.0, 40.0, 70.0, 30.0, 170.0, 100.0, -40.0, 20.0, 10.0, 150.0, 20.0, 20.0, 40.0, 60.0, 40.0, 0.0, 70.0, 30.0, 20.0, 0.0, 20.0, 40.0, 20.0, 20.0, 350.0, 0.0, 10.0, -20.0, 280.0, 40.0, 160.0, 70.0, 50.0, 90.0, 20.0, 30.0, 0.0, 50.0, 20.0, 380.0, 400.0, 40.0, 130.0, 30.0, 0.0, 0.0, 90.0, 30.0, 20.0, 10.0, 60.0, 70.0, 80.0, 10.0, 70.0, -5.0, 20.0, 10.0, 10.0, 0.0, 220.0, 20.0, 10.0, 40.0, 20.0, 360.0, 120.0, 50.0, 110.0, 30.0, 80.0, 50.0, 470.0, 30.0, 0.0, 80.0, 10.0, 30.0, 0.0, 110.0, 170.0, 20.0, 40.0, 0.0, 80.0, 10.0, 160.0, 10.0, 80.0, 20.0, 70.0, 40.0, 30.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 20.0, 70.0, 40.0, 80.0, 40.0, 0.0, 360.0, 30.0, 40.0, 10.0, 210.0, 30.0, 40.0, 30.0, 30.0, 170.0, 30.0, 10.0, 0.0, 30.0, 30.0, 180.0, 60.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 170.0, 80.0, 0.0, 60.0, 20.0, 50.0, 200.0, 40.0, 170.0, 380.0, 10.0, 110.0, 50.0, 30.0, 120.0, 30.0, 10.0, 0.0, 0.0, 10.0, 20.0, 40.0, 0.0, 0.0, 0.0, 30.0, 20.0, 20.0, 60.0, 30.0, -10.0, 30.0, 750.0, 80.0, 40.0, 360.0, 50.0, 80.0, 50.0, 50.0, 50.0, 310.0, 60.0, 80.0, 460.0, 50.0, 20.0, 40.0, 0.0, 30.0, 10.0, 20.0, 0.0, 130.0, 0.0, 10.0, 40.0, -80.0, 190.0, 10.0, 20.0, 20.0, 10.0, 40.0, 10.0, 160.0, 40.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 200.0, 60.0, 20.0, 60.0, 0.0, 10.0, 20.0, 40.0, 50.0, 160.0, 0.0, 30.0, 40.0, 360.0, 150.0, 0.0, -20.0, 170.0, 20.0, 40.0, 30.0, 20.0, -30.0, 10.0, 10.0, 60.0, 10.0, 70.0, 0.0, 70.0, 40.0, 80.0, 40.0, 10.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, 10.0, 10.0, 0.0, 50.0, 0.0, 40.0, 40.0, 30.0, 0.0, 20.0, 20.0, 270.0, 30.0, 70.0, 50.0, 20.0, 30.0, 20.0, 150.0, 180.0, 10.0, 80.0, 40.0, 60.0, 40.0, 30.0, 180.0, 35.0, 100.0, 60.0, 0.0, 5.0, 0.0, 30.0, 50.0, 60.0, 250.0, -40.0, 0.0, 0.0, 120.0, 590.0, 40.0, 30.0, 10.0, 20.0, 20.0, 10.0, 10.0, 0.0, 130.0, 10.0, 10.0, 60.0, 40.0, 460.0, 160.0, 70.0, 0.0, 40.0, 40.0, 30.0, 0.0, 30.0, 60.0, 200.0, 60.0, 10.0, 10.0, 0.0, 20.0, 20.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4619521600123766, "mean_inference_ms": 1.6603504693948627, "mean_action_processing_ms": 0.43223790317294347, "mean_env_wait_ms": 1.3336862096764144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0600128173828125, "StateBufferConnector_ms": 0.01349186897277832, "ViewRequirementAgentConnector_ms": 0.3776416778564453}, "num_episodes": 23, "episode_return_max": 1640.0, "episode_return_min": 70.0, "episode_return_mean": 585.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 35.923145747723616, "num_env_steps_trained_throughput_per_sec": 35.923145747723616, "timesteps_total": 348000, "num_env_steps_sampled_lifetime": 348000, "num_agent_steps_sampled_lifetime": 3480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3480000, "timers": {"training_iteration_time_ms": 110378.086, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110378.037, "sample_time_ms": 2420.472, "learn_time_ms": 107936.587, "learn_throughput": 37.059, "synch_weights_time_ms": 11.132}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 3480000, "num_agent_steps_trained": 3480000}, "done": false, "training_iteration": 87, "trial_id": "57140_00000", "date": "2024-06-27_01-59-48", "timestamp": 1719467988, "time_this_iter_s": 111.3637068271637, "time_total_s": 9914.464225769043, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18e8a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 9914.464225769043, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 16.680379746835442, "ram_util_percent": 78.75443037974682}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.661260942468882, "cur_kl_coeff": 3.243658447265624, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0028217317239669993, "vf_loss": 4.155320538956517, "vf_explained_var": 0.0004331627973733238, "kl": Infinity, "entropy": 0.3906003466524636, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 821625.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000}, "env_runners": {"episode_reward_max": 1640.0, "episode_reward_min": 70.0, "episode_reward_mean": 581.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -110.0}, "policy_reward_max": {"policy_0": 1000.0}, "policy_reward_mean": {"policy_0": 58.13}, "custom_metrics": {}, "hist_stats": {"episode_reward": [490.0, 1110.0, 1565.0, 395.0, 1050.0, 720.0, 770.0, 640.0, 195.0, 650.0, 230.0, 570.0, 340.0, 820.0, 710.0, 1020.0, 210.0, 150.0, 455.0, 500.0, 380.0, 820.0, 1150.0, 185.0, 1030.0, 160.0, 620.0, 1050.0, 170.0, 670.0, 230.0, 835.0, 1640.0, 670.0, 380.0, 310.0, 430.0, 160.0, 350.0, 580.0, 680.0, 460.0, 940.0, 575.0, 380.0, 420.0, 570.0, 360.0, 390.0, 830.0, 550.0, 260.0, 1030.0, 1100.0, 370.0, 395.0, 1320.0, 460.0, 510.0, 70.0, 290.0, 950.0, 380.0, 430.0, 1140.0, 110.0, 1380.0, 1240.0, 260.0, 420.0, 460.0, 410.0, 740.0, 390.0, 120.0, 500.0, 650.0, 510.0, 1100.0, 250.0, 900.0, 420.0, 310.0, 350.0, 680.0, 1185.0, 310.0, 430.0, 910.0, 180.0, 1040.0, 410.0, 390.0, 360.0, 350.0, 300.0, 235.0, 160.0, 840.0, 560.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 60.0, 40.0, 40.0, 10.0, 20.0, 40.0, 150.0, 20.0, 70.0, 40.0, 90.0, 320.0, 20.0, 10.0, 350.0, 10.0, 40.0, 170.0, 60.0, 70.0, 40.0, 330.0, 30.0, 0.0, 1000.0, 10.0, -15.0, 70.0, 30.0, 10.0, 15.0, 20.0, 10.0, 20.0, 350.0, -30.0, 0.0, 0.0, 0.0, -50.0, 250.0, 460.0, 60.0, 40.0, 10.0, 150.0, 0.0, 30.0, 100.0, 50.0, 0.0, 40.0, 190.0, 90.0, 70.0, 40.0, 20.0, 160.0, 60.0, -30.0, 190.0, 50.0, 110.0, 360.0, -20.0, 0.0, 0.0, 50.0, 60.0, 80.0, 160.0, 70.0, 20.0, 20.0, 20.0, 20.0, 70.0, 50.0, 130.0, 10.0, 30.0, 35.0, 20.0, 40.0, 0.0, 20.0, 0.0, 10.0, 30.0, 280.0, -110.0, 30.0, 20.0, 50.0, 290.0, 60.0, 10.0, 10.0, 10.0, 10.0, 10.0, 40.0, 40.0, 20.0, 10.0, 70.0, 20.0, 10.0, 0.0, 30.0, 170.0, 10.0, 0.0, 0.0, 150.0, 20.0, 20.0, 140.0, 30.0, 0.0, 0.0, 60.0, 130.0, 40.0, 20.0, 20.0, 30.0, 20.0, 20.0, -40.0, 170.0, 10.0, 40.0, 20.0, 30.0, 70.0, 30.0, 30.0, 460.0, 20.0, 40.0, 40.0, 260.0, 70.0, 170.0, 30.0, 20.0, 0.0, 60.0, 40.0, 10.0, 30.0, 30.0, 30.0, 200.0, 560.0, 0.0, 50.0, 70.0, 0.0, 10.0, 30.0, 20.0, -40.0, 30.0, 60.0, 30.0, 40.0, 30.0, 10.0, 10.0, 0.0, 20.0, 0.0, 10.0, 40.0, 30.0, 30.0, 0.0, 0.0, 30.0, 40.0, 90.0, 30.0, -5.0, 30.0, 30.0, 90.0, 120.0, 30.0, 10.0, 10.0, 10.0, 10.0, 30.0, 140.0, 40.0, 40.0, 180.0, 0.0, 20.0, 10.0, 90.0, 70.0, 30.0, 0.0, 80.0, 40.0, 40.0, 40.0, 70.0, 170.0, 370.0, -90.0, 50.0, 60.0, 10.0, -50.0, 190.0, 80.0, 50.0, 110.0, 120.0, -30.0, 110.0, 10.0, 470.0, 150.0, 80.0, 0.0, 20.0, 30.0, 30.0, 20.0, 25.0, 0.0, 30.0, 30.0, 0.0, 200.0, 60.0, 120.0, 180.0, 0.0, 80.0, 350.0, 0.0, 60.0, -20.0, 20.0, 30.0, 30.0, 40.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 30.0, 200.0, 20.0, 10.0, 10.0, 0.0, 40.0, 260.0, 20.0, 30.0, 0.0, 580.0, 70.0, 150.0, 30.0, 50.0, 40.0, 30.0, 90.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 20.0, 20.0, 40.0, 40.0, 0.0, 360.0, 50.0, 10.0, 20.0, 60.0, 60.0, 30.0, 10.0, 30.0, 30.0, 0.0, 20.0, 60.0, 0.0, 40.0, 40.0, 0.0, -50.0, 130.0, 370.0, 40.0, 90.0, 50.0, 75.0, 160.0, -40.0, 10.0, 90.0, 110.0, -20.0, 940.0, 170.0, 180.0, 170.0, 10.0, -10.0, 0.0, 0.0, 10.0, 30.0, 10.0, 30.0, 20.0, 170.0, 10.0, 30.0, 360.0, 90.0, 10.0, 10.0, 70.0, 20.0, 20.0, 30.0, 30.0, 20.0, 80.0, 20.0, 40.0, 0.0, 30.0, 20.0, 30.0, 60.0, 0.0, 70.0, 40.0, 40.0, 10.0, 20.0, 90.0, 0.0, 0.0, 40.0, 0.0, 50.0, 180.0, 60.0, 0.0, 30.0, 30.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 30.0, 70.0, 30.0, 40.0, 90.0, 50.0, 20.0, 0.0, 80.0, 90.0, 0.0, 30.0, 30.0, 10.0, 0.0, 320.0, 10.0, 10.0, 30.0, 20.0, 50.0, 50.0, 0.0, 30.0, 40.0, 270.0, -70.0, 260.0, 50.0, 0.0, 40.0, 20.0, 0.0, 170.0, 10.0, 40.0, 100.0, 30.0, 90.0, 20.0, 40.0, 120.0, 20.0, 420.0, 180.0, 10.0, 40.0, 0.0, 20.0, 15.0, -10.0, 0.0, 10.0, 30.0, 110.0, 120.0, 20.0, 260.0, 0.0, 80.0, 50.0, 20.0, 160.0, 10.0, 10.0, 0.0, 20.0, 30.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 30.0, 80.0, 130.0, 110.0, 120.0, 80.0, 80.0, 10.0, 0.0, 0.0, 50.0, 10.0, 40.0, 180.0, 10.0, 40.0, 10.0, 10.0, 30.0, 50.0, 160.0, 0.0, 20.0, 30.0, 20.0, 10.0, 40.0, 0.0, 30.0, 160.0, 70.0, 0.0, 20.0, 40.0, 10.0, 360.0, 150.0, 40.0, 80.0, 60.0, -10.0, 40.0, 70.0, 30.0, 170.0, 100.0, -40.0, 20.0, 10.0, 150.0, 20.0, 20.0, 40.0, 60.0, 40.0, 0.0, 70.0, 30.0, 20.0, 0.0, 20.0, 40.0, 20.0, 20.0, 350.0, 0.0, 10.0, -20.0, 280.0, 40.0, 160.0, 70.0, 50.0, 90.0, 20.0, 30.0, 0.0, 50.0, 20.0, 380.0, 400.0, 40.0, 130.0, 30.0, 0.0, 0.0, 90.0, 30.0, 20.0, 10.0, 60.0, 70.0, 80.0, 10.0, 70.0, -5.0, 20.0, 10.0, 10.0, 0.0, 220.0, 20.0, 10.0, 40.0, 20.0, 360.0, 120.0, 50.0, 110.0, 30.0, 80.0, 50.0, 470.0, 30.0, 0.0, 80.0, 10.0, 30.0, 0.0, 110.0, 170.0, 20.0, 40.0, 0.0, 80.0, 10.0, 160.0, 10.0, 80.0, 20.0, 70.0, 40.0, 30.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 20.0, 70.0, 40.0, 80.0, 40.0, 0.0, 360.0, 30.0, 40.0, 10.0, 210.0, 30.0, 40.0, 30.0, 30.0, 170.0, 30.0, 10.0, 0.0, 30.0, 30.0, 180.0, 60.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 170.0, 80.0, 0.0, 60.0, 20.0, 50.0, 200.0, 40.0, 170.0, 380.0, 10.0, 110.0, 50.0, 30.0, 120.0, 30.0, 10.0, 0.0, 0.0, 10.0, 20.0, 40.0, 0.0, 0.0, 0.0, 30.0, 20.0, 20.0, 60.0, 30.0, -10.0, 30.0, 750.0, 80.0, 40.0, 360.0, 50.0, 80.0, 50.0, 50.0, 50.0, 310.0, 60.0, 80.0, 460.0, 50.0, 20.0, 40.0, 0.0, 30.0, 10.0, 20.0, 0.0, 130.0, 0.0, 10.0, 40.0, -80.0, 190.0, 10.0, 20.0, 20.0, 10.0, 40.0, 10.0, 160.0, 40.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 200.0, 60.0, 20.0, 60.0, 0.0, 10.0, 20.0, 40.0, 50.0, 160.0, 0.0, 30.0, 40.0, 360.0, 150.0, 0.0, -20.0, 170.0, 20.0, 40.0, 30.0, 20.0, -30.0, 10.0, 10.0, 60.0, 10.0, 70.0, 0.0, 70.0, 40.0, 80.0, 40.0, 10.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, 10.0, 10.0, 0.0, 50.0, 0.0, 40.0, 40.0, 30.0, 0.0, 20.0, 20.0, 270.0, 30.0, 70.0, 50.0, 20.0, 30.0, 20.0, 150.0, 180.0, 10.0, 80.0, 40.0, 60.0, 40.0, 30.0, 180.0, 35.0, 100.0, 60.0, 0.0, 5.0, 0.0, 30.0, 50.0, 60.0, 250.0, -40.0, 0.0, 0.0, 120.0, 590.0, 40.0, 30.0, 10.0, 20.0, 20.0, 10.0, 10.0, 0.0, 130.0, 10.0, 10.0, 60.0, 40.0, 460.0, 160.0, 70.0, 0.0, 40.0, 40.0, 30.0, 0.0, 30.0, 60.0, 200.0, 60.0, 10.0, 10.0, 0.0, 20.0, 20.0, 10.0, 60.0, 150.0, 10.0, 40.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 100.0, 30.0, 0.0, 70.0, 10.0, 10.0, 0.0, 40.0, 0.0, 90.0, 10.0, 50.0, 20.0, 180.0, 290.0, 40.0, 10.0, 50.0, 0.0, 30.0, 50.0, 60.0, 60.0, -85.0, 560.0, 180.0, 130.0, 130.0, 70.0, 30.0, 90.0, 10.0, 0.0, 60.0, 20.0, 60.0, 40.0, 0.0, 10.0, 20.0, 160.0, 20.0, 30.0, 20.0, 30.0, 90.0, 10.0, 0.0, 0.0, 70.0, 40.0, 50.0, 20.0, 20.0, 20.0, 40.0, 20.0, 50.0, 30.0, 620.0, 0.0, 10.0, 30.0, 40.0, 0.0, 20.0, 50.0, 20.0, 0.0, 10.0, 40.0, 100.0, 390.0, 60.0, 270.0, 100.0, 30.0, 30.0, 10.0, 10.0, 30.0, 170.0, 0.0, 10.0, 80.0, 40.0, 40.0, 0.0, 10.0, 30.0, 10.0, 20.0, 80.0, 20.0, 50.0, 80.0, 20.0, 20.0, 30.0, 60.0, 40.0, 20.0, -40.0, 10.0, 40.0, 50.0, 30.0, -10.0, 180.0, 40.0, 0.0, 20.0, 260.0, 0.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 40.0, 10.0, 0.0, 50.0, 10.0, 150.0, 10.0, 0.0, 0.0, 30.0, 0.0, 30.0, 90.0, 10.0, 10.0, 20.0, 0.0, 30.0, 5.0, 40.0, 0.0, 50.0, 20.0, 0.0, 0.0, 10.0, 10.0, 30.0, 40.0, 0.0, 200.0, 50.0, 100.0, 0.0, -20.0, 80.0, 70.0, 10.0, 0.0, 350.0, 70.0, 130.0, 0.0, 0.0, 30.0, 10.0, 0.0, 60.0, 260.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.460636097672886, "mean_inference_ms": 1.6590937363946572, "mean_action_processing_ms": 0.43178171960095485, "mean_env_wait_ms": 1.332632871706552, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06017136573791504, "StateBufferConnector_ms": 0.013523340225219727, "ViewRequirementAgentConnector_ms": 0.3777308464050293}, "num_episodes": 18, "episode_return_max": 1640.0, "episode_return_min": 70.0, "episode_return_mean": 581.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.32210105925439, "num_env_steps_trained_throughput_per_sec": 36.32210105925439, "timesteps_total": 352000, "num_env_steps_sampled_lifetime": 352000, "num_agent_steps_sampled_lifetime": 3520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3520000, "timers": {"training_iteration_time_ms": 110415.874, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110415.824, "sample_time_ms": 2411.789, "learn_time_ms": 107983.21, "learn_throughput": 37.043, "synch_weights_time_ms": 11.145}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 3520000, "num_agent_steps_trained": 3520000}, "done": false, "training_iteration": 88, "trial_id": "57140_00000", "date": "2024-06-27_02-01-39", "timestamp": 1719468099, "time_this_iter_s": 110.13857793807983, "time_total_s": 10024.602803707123, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af4040d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10024.602803707123, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 15.373076923076923, "ram_util_percent": 78.95641025641024}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5084865608344824, "cur_kl_coeff": 4.865487670898437, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.442885762307083, "policy_loss": -0.0024459947230635534, "vf_loss": 4.4429364028957075, "vf_explained_var": -5.501070723366052e-05, "kl": 0.0004923158125643454, "entropy": 0.3873940201105274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 831015.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000}, "env_runners": {"episode_reward_max": 1640.0, "episode_reward_min": 70.0, "episode_reward_mean": 600.4, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 940.0}, "policy_reward_mean": {"policy_0": 60.04}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1150.0, 185.0, 1030.0, 160.0, 620.0, 1050.0, 170.0, 670.0, 230.0, 835.0, 1640.0, 670.0, 380.0, 310.0, 430.0, 160.0, 350.0, 580.0, 680.0, 460.0, 940.0, 575.0, 380.0, 420.0, 570.0, 360.0, 390.0, 830.0, 550.0, 260.0, 1030.0, 1100.0, 370.0, 395.0, 1320.0, 460.0, 510.0, 70.0, 290.0, 950.0, 380.0, 430.0, 1140.0, 110.0, 1380.0, 1240.0, 260.0, 420.0, 460.0, 410.0, 740.0, 390.0, 120.0, 500.0, 650.0, 510.0, 1100.0, 250.0, 900.0, 420.0, 310.0, 350.0, 680.0, 1185.0, 310.0, 430.0, 910.0, 180.0, 1040.0, 410.0, 390.0, 360.0, 350.0, 300.0, 235.0, 160.0, 840.0, 560.0, 1140.0, 880.0, 1270.0, 300.0, 240.0, 990.0, 930.0, 540.0, 650.0, 850.0, 730.0, 1480.0, 810.0, 1225.0, 440.0, 530.0, 775.0, 190.0, 430.0, 180.0, 670.0, 450.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 50.0, 110.0, 120.0, -30.0, 110.0, 10.0, 470.0, 150.0, 80.0, 0.0, 20.0, 30.0, 30.0, 20.0, 25.0, 0.0, 30.0, 30.0, 0.0, 200.0, 60.0, 120.0, 180.0, 0.0, 80.0, 350.0, 0.0, 60.0, -20.0, 20.0, 30.0, 30.0, 40.0, 0.0, 0.0, 20.0, 0.0, 10.0, 10.0, 30.0, 200.0, 20.0, 10.0, 10.0, 0.0, 40.0, 260.0, 20.0, 30.0, 0.0, 580.0, 70.0, 150.0, 30.0, 50.0, 40.0, 30.0, 90.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 20.0, 20.0, 40.0, 40.0, 0.0, 360.0, 50.0, 10.0, 20.0, 60.0, 60.0, 30.0, 10.0, 30.0, 30.0, 0.0, 20.0, 60.0, 0.0, 40.0, 40.0, 0.0, -50.0, 130.0, 370.0, 40.0, 90.0, 50.0, 75.0, 160.0, -40.0, 10.0, 90.0, 110.0, -20.0, 940.0, 170.0, 180.0, 170.0, 10.0, -10.0, 0.0, 0.0, 10.0, 30.0, 10.0, 30.0, 20.0, 170.0, 10.0, 30.0, 360.0, 90.0, 10.0, 10.0, 70.0, 20.0, 20.0, 30.0, 30.0, 20.0, 80.0, 20.0, 40.0, 0.0, 30.0, 20.0, 30.0, 60.0, 0.0, 70.0, 40.0, 40.0, 10.0, 20.0, 90.0, 0.0, 0.0, 40.0, 0.0, 50.0, 180.0, 60.0, 0.0, 30.0, 30.0, 0.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 30.0, 70.0, 30.0, 40.0, 90.0, 50.0, 20.0, 0.0, 80.0, 90.0, 0.0, 30.0, 30.0, 10.0, 0.0, 320.0, 10.0, 10.0, 30.0, 20.0, 50.0, 50.0, 0.0, 30.0, 40.0, 270.0, -70.0, 260.0, 50.0, 0.0, 40.0, 20.0, 0.0, 170.0, 10.0, 40.0, 100.0, 30.0, 90.0, 20.0, 40.0, 120.0, 20.0, 420.0, 180.0, 10.0, 40.0, 0.0, 20.0, 15.0, -10.0, 0.0, 10.0, 30.0, 110.0, 120.0, 20.0, 260.0, 0.0, 80.0, 50.0, 20.0, 160.0, 10.0, 10.0, 0.0, 20.0, 30.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 30.0, 80.0, 130.0, 110.0, 120.0, 80.0, 80.0, 10.0, 0.0, 0.0, 50.0, 10.0, 40.0, 180.0, 10.0, 40.0, 10.0, 10.0, 30.0, 50.0, 160.0, 0.0, 20.0, 30.0, 20.0, 10.0, 40.0, 0.0, 30.0, 160.0, 70.0, 0.0, 20.0, 40.0, 10.0, 360.0, 150.0, 40.0, 80.0, 60.0, -10.0, 40.0, 70.0, 30.0, 170.0, 100.0, -40.0, 20.0, 10.0, 150.0, 20.0, 20.0, 40.0, 60.0, 40.0, 0.0, 70.0, 30.0, 20.0, 0.0, 20.0, 40.0, 20.0, 20.0, 350.0, 0.0, 10.0, -20.0, 280.0, 40.0, 160.0, 70.0, 50.0, 90.0, 20.0, 30.0, 0.0, 50.0, 20.0, 380.0, 400.0, 40.0, 130.0, 30.0, 0.0, 0.0, 90.0, 30.0, 20.0, 10.0, 60.0, 70.0, 80.0, 10.0, 70.0, -5.0, 20.0, 10.0, 10.0, 0.0, 220.0, 20.0, 10.0, 40.0, 20.0, 360.0, 120.0, 50.0, 110.0, 30.0, 80.0, 50.0, 470.0, 30.0, 0.0, 80.0, 10.0, 30.0, 0.0, 110.0, 170.0, 20.0, 40.0, 0.0, 80.0, 10.0, 160.0, 10.0, 80.0, 20.0, 70.0, 40.0, 30.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 20.0, 70.0, 40.0, 80.0, 40.0, 0.0, 360.0, 30.0, 40.0, 10.0, 210.0, 30.0, 40.0, 30.0, 30.0, 170.0, 30.0, 10.0, 0.0, 30.0, 30.0, 180.0, 60.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 170.0, 80.0, 0.0, 60.0, 20.0, 50.0, 200.0, 40.0, 170.0, 380.0, 10.0, 110.0, 50.0, 30.0, 120.0, 30.0, 10.0, 0.0, 0.0, 10.0, 20.0, 40.0, 0.0, 0.0, 0.0, 30.0, 20.0, 20.0, 60.0, 30.0, -10.0, 30.0, 750.0, 80.0, 40.0, 360.0, 50.0, 80.0, 50.0, 50.0, 50.0, 310.0, 60.0, 80.0, 460.0, 50.0, 20.0, 40.0, 0.0, 30.0, 10.0, 20.0, 0.0, 130.0, 0.0, 10.0, 40.0, -80.0, 190.0, 10.0, 20.0, 20.0, 10.0, 40.0, 10.0, 160.0, 40.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 200.0, 60.0, 20.0, 60.0, 0.0, 10.0, 20.0, 40.0, 50.0, 160.0, 0.0, 30.0, 40.0, 360.0, 150.0, 0.0, -20.0, 170.0, 20.0, 40.0, 30.0, 20.0, -30.0, 10.0, 10.0, 60.0, 10.0, 70.0, 0.0, 70.0, 40.0, 80.0, 40.0, 10.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, 10.0, 10.0, 0.0, 50.0, 0.0, 40.0, 40.0, 30.0, 0.0, 20.0, 20.0, 270.0, 30.0, 70.0, 50.0, 20.0, 30.0, 20.0, 150.0, 180.0, 10.0, 80.0, 40.0, 60.0, 40.0, 30.0, 180.0, 35.0, 100.0, 60.0, 0.0, 5.0, 0.0, 30.0, 50.0, 60.0, 250.0, -40.0, 0.0, 0.0, 120.0, 590.0, 40.0, 30.0, 10.0, 20.0, 20.0, 10.0, 10.0, 0.0, 130.0, 10.0, 10.0, 60.0, 40.0, 460.0, 160.0, 70.0, 0.0, 40.0, 40.0, 30.0, 0.0, 30.0, 60.0, 200.0, 60.0, 10.0, 10.0, 0.0, 20.0, 20.0, 10.0, 60.0, 150.0, 10.0, 40.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 100.0, 30.0, 0.0, 70.0, 10.0, 10.0, 0.0, 40.0, 0.0, 90.0, 10.0, 50.0, 20.0, 180.0, 290.0, 40.0, 10.0, 50.0, 0.0, 30.0, 50.0, 60.0, 60.0, -85.0, 560.0, 180.0, 130.0, 130.0, 70.0, 30.0, 90.0, 10.0, 0.0, 60.0, 20.0, 60.0, 40.0, 0.0, 10.0, 20.0, 160.0, 20.0, 30.0, 20.0, 30.0, 90.0, 10.0, 0.0, 0.0, 70.0, 40.0, 50.0, 20.0, 20.0, 20.0, 40.0, 20.0, 50.0, 30.0, 620.0, 0.0, 10.0, 30.0, 40.0, 0.0, 20.0, 50.0, 20.0, 0.0, 10.0, 40.0, 100.0, 390.0, 60.0, 270.0, 100.0, 30.0, 30.0, 10.0, 10.0, 30.0, 170.0, 0.0, 10.0, 80.0, 40.0, 40.0, 0.0, 10.0, 30.0, 10.0, 20.0, 80.0, 20.0, 50.0, 80.0, 20.0, 20.0, 30.0, 60.0, 40.0, 20.0, -40.0, 10.0, 40.0, 50.0, 30.0, -10.0, 180.0, 40.0, 0.0, 20.0, 260.0, 0.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 40.0, 10.0, 0.0, 50.0, 10.0, 150.0, 10.0, 0.0, 0.0, 30.0, 0.0, 30.0, 90.0, 10.0, 10.0, 20.0, 0.0, 30.0, 5.0, 40.0, 0.0, 50.0, 20.0, 0.0, 0.0, 10.0, 10.0, 30.0, 40.0, 0.0, 200.0, 50.0, 100.0, 0.0, -20.0, 80.0, 70.0, 10.0, 0.0, 350.0, 70.0, 130.0, 0.0, 0.0, 30.0, 10.0, 0.0, 60.0, 260.0, 0.0, 30.0, 80.0, 80.0, 40.0, 60.0, 20.0, 70.0, 450.0, 60.0, 250.0, 80.0, -50.0, 20.0, 390.0, 30.0, 210.0, 150.0, -30.0, 90.0, -10.0, 40.0, 60.0, 580.0, 280.0, 30.0, 0.0, 60.0, 70.0, 80.0, 70.0, 20.0, 20.0, 30.0, 0.0, 70.0, 10.0, 10.0, 100.0, 40.0, 0.0, 10.0, 90.0, 20.0, 40.0, 0.0, 0.0, 10.0, 60.0, 0.0, 10.0, -10.0, 20.0, 660.0, 50.0, 20.0, -10.0, 40.0, 0.0, 40.0, 180.0, 20.0, 10.0, 20.0, 260.0, 20.0, 60.0, 370.0, 80.0, 80.0, 10.0, 0.0, 60.0, 40.0, 310.0, 40.0, 20.0, 0.0, 40.0, 30.0, 0.0, 40.0, 0.0, 70.0, 20.0, 20.0, 50.0, 100.0, 20.0, 0.0, 330.0, 30.0, 10.0, 100.0, 170.0, 20.0, 40.0, 20.0, 0.0, 40.0, 420.0, 370.0, 30.0, 60.0, -40.0, 60.0, 190.0, 0.0, 30.0, -20.0, 50.0, -10.0, 60.0, 20.0, 50.0, 570.0, 70.0, 290.0, 0.0, 370.0, 60.0, 160.0, -40.0, 40.0, 40.0, 60.0, 40.0, 20.0, 20.0, 0.0, 470.0, 10.0, 160.0, 450.0, 170.0, 220.0, 100.0, -40.0, 40.0, 105.0, 10.0, 20.0, 0.0, 20.0, 40.0, 40.0, 40.0, 10.0, 20.0, 200.0, 50.0, 20.0, 30.0, 0.0, 80.0, 0.0, 20.0, 90.0, 110.0, 30.0, 150.0, 120.0, 10.0, 0.0, 20.0, 40.0, 155.0, 90.0, 70.0, 100.0, 170.0, 40.0, 0.0, 20.0, 50.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 0.0, 20.0, 0.0, 100.0, 30.0, 90.0, 130.0, 10.0, 30.0, 20.0, 10.0, 30.0, 0.0, 60.0, 20.0, 0.0, 0.0, 30.0, 0.0, 30.0, 20.0, 20.0, 30.0, 30.0, 10.0, 40.0, 190.0, 270.0, 40.0, 20.0, 30.0, 20.0, 30.0, 20.0, 160.0, 70.0, 30.0, 0.0, 60.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4624375436386783, "mean_inference_ms": 1.664645562618719, "mean_action_processing_ms": 0.43288372955632587, "mean_env_wait_ms": 1.334370151177062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05930209159851074, "StateBufferConnector_ms": 0.013418197631835938, "ViewRequirementAgentConnector_ms": 0.38022303581237793}, "num_episodes": 22, "episode_return_max": 1640.0, "episode_return_min": 70.0, "episode_return_mean": 600.4}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.145821046634204, "num_env_steps_trained_throughput_per_sec": 36.145821046634204, "timesteps_total": 356000, "num_env_steps_sampled_lifetime": 356000, "num_agent_steps_sampled_lifetime": 3560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3560000, "timers": {"training_iteration_time_ms": 110461.897, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110461.848, "sample_time_ms": 2410.536, "learn_time_ms": 108030.359, "learn_throughput": 37.027, "synch_weights_time_ms": 11.329}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 3560000, "num_agent_steps_trained": 3560000}, "done": false, "training_iteration": 89, "trial_id": "57140_00000", "date": "2024-06-27_02-03-29", "timestamp": 1719468209, "time_this_iter_s": 110.67519402503967, "time_total_s": 10135.277997732162, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18e1790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10135.277997732162, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 15.612179487179487, "ram_util_percent": 78.9897435897436}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.319638434373025, "cur_kl_coeff": 2.4327438354492186, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.4758063567586093, "policy_loss": -0.0030244631592097025, "vf_loss": 3.4766257822957916, "vf_explained_var": 0.00048816663007766675, "kl": 0.0009063982501026418, "entropy": 0.419922161584718, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 840405.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000}, "env_runners": {"episode_reward_max": 1480.0, "episode_reward_min": 60.0, "episode_reward_mean": 579.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 57.985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [680.0, 460.0, 940.0, 575.0, 380.0, 420.0, 570.0, 360.0, 390.0, 830.0, 550.0, 260.0, 1030.0, 1100.0, 370.0, 395.0, 1320.0, 460.0, 510.0, 70.0, 290.0, 950.0, 380.0, 430.0, 1140.0, 110.0, 1380.0, 1240.0, 260.0, 420.0, 460.0, 410.0, 740.0, 390.0, 120.0, 500.0, 650.0, 510.0, 1100.0, 250.0, 900.0, 420.0, 310.0, 350.0, 680.0, 1185.0, 310.0, 430.0, 910.0, 180.0, 1040.0, 410.0, 390.0, 360.0, 350.0, 300.0, 235.0, 160.0, 840.0, 560.0, 1140.0, 880.0, 1270.0, 300.0, 240.0, 990.0, 930.0, 540.0, 650.0, 850.0, 730.0, 1480.0, 810.0, 1225.0, 440.0, 530.0, 775.0, 190.0, 430.0, 180.0, 670.0, 450.0, 240.0, 380.0, 265.0, 250.0, 240.0, 530.0, 210.0, 850.0, 620.0, 440.0, 940.0, 840.0, 580.0, 450.0, 420.0, 630.0, 620.0, 60.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 20.0, 50.0, 50.0, 0.0, 30.0, 40.0, 270.0, -70.0, 260.0, 50.0, 0.0, 40.0, 20.0, 0.0, 170.0, 10.0, 40.0, 100.0, 30.0, 90.0, 20.0, 40.0, 120.0, 20.0, 420.0, 180.0, 10.0, 40.0, 0.0, 20.0, 15.0, -10.0, 0.0, 10.0, 30.0, 110.0, 120.0, 20.0, 260.0, 0.0, 80.0, 50.0, 20.0, 160.0, 10.0, 10.0, 0.0, 20.0, 30.0, 10.0, 0.0, 0.0, 10.0, 20.0, 30.0, 30.0, 80.0, 130.0, 110.0, 120.0, 80.0, 80.0, 10.0, 0.0, 0.0, 50.0, 10.0, 40.0, 180.0, 10.0, 40.0, 10.0, 10.0, 30.0, 50.0, 160.0, 0.0, 20.0, 30.0, 20.0, 10.0, 40.0, 0.0, 30.0, 160.0, 70.0, 0.0, 20.0, 40.0, 10.0, 360.0, 150.0, 40.0, 80.0, 60.0, -10.0, 40.0, 70.0, 30.0, 170.0, 100.0, -40.0, 20.0, 10.0, 150.0, 20.0, 20.0, 40.0, 60.0, 40.0, 0.0, 70.0, 30.0, 20.0, 0.0, 20.0, 40.0, 20.0, 20.0, 350.0, 0.0, 10.0, -20.0, 280.0, 40.0, 160.0, 70.0, 50.0, 90.0, 20.0, 30.0, 0.0, 50.0, 20.0, 380.0, 400.0, 40.0, 130.0, 30.0, 0.0, 0.0, 90.0, 30.0, 20.0, 10.0, 60.0, 70.0, 80.0, 10.0, 70.0, -5.0, 20.0, 10.0, 10.0, 0.0, 220.0, 20.0, 10.0, 40.0, 20.0, 360.0, 120.0, 50.0, 110.0, 30.0, 80.0, 50.0, 470.0, 30.0, 0.0, 80.0, 10.0, 30.0, 0.0, 110.0, 170.0, 20.0, 40.0, 0.0, 80.0, 10.0, 160.0, 10.0, 80.0, 20.0, 70.0, 40.0, 30.0, 10.0, 10.0, 0.0, 20.0, 0.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 20.0, 70.0, 40.0, 80.0, 40.0, 0.0, 360.0, 30.0, 40.0, 10.0, 210.0, 30.0, 40.0, 30.0, 30.0, 170.0, 30.0, 10.0, 0.0, 30.0, 30.0, 180.0, 60.0, 0.0, 20.0, 20.0, 10.0, 10.0, 10.0, 20.0, 170.0, 80.0, 0.0, 60.0, 20.0, 50.0, 200.0, 40.0, 170.0, 380.0, 10.0, 110.0, 50.0, 30.0, 120.0, 30.0, 10.0, 0.0, 0.0, 10.0, 20.0, 40.0, 0.0, 0.0, 0.0, 30.0, 20.0, 20.0, 60.0, 30.0, -10.0, 30.0, 750.0, 80.0, 40.0, 360.0, 50.0, 80.0, 50.0, 50.0, 50.0, 310.0, 60.0, 80.0, 460.0, 50.0, 20.0, 40.0, 0.0, 30.0, 10.0, 20.0, 0.0, 130.0, 0.0, 10.0, 40.0, -80.0, 190.0, 10.0, 20.0, 20.0, 10.0, 40.0, 10.0, 160.0, 40.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 200.0, 60.0, 20.0, 60.0, 0.0, 10.0, 20.0, 40.0, 50.0, 160.0, 0.0, 30.0, 40.0, 360.0, 150.0, 0.0, -20.0, 170.0, 20.0, 40.0, 30.0, 20.0, -30.0, 10.0, 10.0, 60.0, 10.0, 70.0, 0.0, 70.0, 40.0, 80.0, 40.0, 10.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, 10.0, 10.0, 0.0, 50.0, 0.0, 40.0, 40.0, 30.0, 0.0, 20.0, 20.0, 270.0, 30.0, 70.0, 50.0, 20.0, 30.0, 20.0, 150.0, 180.0, 10.0, 80.0, 40.0, 60.0, 40.0, 30.0, 180.0, 35.0, 100.0, 60.0, 0.0, 5.0, 0.0, 30.0, 50.0, 60.0, 250.0, -40.0, 0.0, 0.0, 120.0, 590.0, 40.0, 30.0, 10.0, 20.0, 20.0, 10.0, 10.0, 0.0, 130.0, 10.0, 10.0, 60.0, 40.0, 460.0, 160.0, 70.0, 0.0, 40.0, 40.0, 30.0, 0.0, 30.0, 60.0, 200.0, 60.0, 10.0, 10.0, 0.0, 20.0, 20.0, 10.0, 60.0, 150.0, 10.0, 40.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 100.0, 30.0, 0.0, 70.0, 10.0, 10.0, 0.0, 40.0, 0.0, 90.0, 10.0, 50.0, 20.0, 180.0, 290.0, 40.0, 10.0, 50.0, 0.0, 30.0, 50.0, 60.0, 60.0, -85.0, 560.0, 180.0, 130.0, 130.0, 70.0, 30.0, 90.0, 10.0, 0.0, 60.0, 20.0, 60.0, 40.0, 0.0, 10.0, 20.0, 160.0, 20.0, 30.0, 20.0, 30.0, 90.0, 10.0, 0.0, 0.0, 70.0, 40.0, 50.0, 20.0, 20.0, 20.0, 40.0, 20.0, 50.0, 30.0, 620.0, 0.0, 10.0, 30.0, 40.0, 0.0, 20.0, 50.0, 20.0, 0.0, 10.0, 40.0, 100.0, 390.0, 60.0, 270.0, 100.0, 30.0, 30.0, 10.0, 10.0, 30.0, 170.0, 0.0, 10.0, 80.0, 40.0, 40.0, 0.0, 10.0, 30.0, 10.0, 20.0, 80.0, 20.0, 50.0, 80.0, 20.0, 20.0, 30.0, 60.0, 40.0, 20.0, -40.0, 10.0, 40.0, 50.0, 30.0, -10.0, 180.0, 40.0, 0.0, 20.0, 260.0, 0.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 40.0, 10.0, 0.0, 50.0, 10.0, 150.0, 10.0, 0.0, 0.0, 30.0, 0.0, 30.0, 90.0, 10.0, 10.0, 20.0, 0.0, 30.0, 5.0, 40.0, 0.0, 50.0, 20.0, 0.0, 0.0, 10.0, 10.0, 30.0, 40.0, 0.0, 200.0, 50.0, 100.0, 0.0, -20.0, 80.0, 70.0, 10.0, 0.0, 350.0, 70.0, 130.0, 0.0, 0.0, 30.0, 10.0, 0.0, 60.0, 260.0, 0.0, 30.0, 80.0, 80.0, 40.0, 60.0, 20.0, 70.0, 450.0, 60.0, 250.0, 80.0, -50.0, 20.0, 390.0, 30.0, 210.0, 150.0, -30.0, 90.0, -10.0, 40.0, 60.0, 580.0, 280.0, 30.0, 0.0, 60.0, 70.0, 80.0, 70.0, 20.0, 20.0, 30.0, 0.0, 70.0, 10.0, 10.0, 100.0, 40.0, 0.0, 10.0, 90.0, 20.0, 40.0, 0.0, 0.0, 10.0, 60.0, 0.0, 10.0, -10.0, 20.0, 660.0, 50.0, 20.0, -10.0, 40.0, 0.0, 40.0, 180.0, 20.0, 10.0, 20.0, 260.0, 20.0, 60.0, 370.0, 80.0, 80.0, 10.0, 0.0, 60.0, 40.0, 310.0, 40.0, 20.0, 0.0, 40.0, 30.0, 0.0, 40.0, 0.0, 70.0, 20.0, 20.0, 50.0, 100.0, 20.0, 0.0, 330.0, 30.0, 10.0, 100.0, 170.0, 20.0, 40.0, 20.0, 0.0, 40.0, 420.0, 370.0, 30.0, 60.0, -40.0, 60.0, 190.0, 0.0, 30.0, -20.0, 50.0, -10.0, 60.0, 20.0, 50.0, 570.0, 70.0, 290.0, 0.0, 370.0, 60.0, 160.0, -40.0, 40.0, 40.0, 60.0, 40.0, 20.0, 20.0, 0.0, 470.0, 10.0, 160.0, 450.0, 170.0, 220.0, 100.0, -40.0, 40.0, 105.0, 10.0, 20.0, 0.0, 20.0, 40.0, 40.0, 40.0, 10.0, 20.0, 200.0, 50.0, 20.0, 30.0, 0.0, 80.0, 0.0, 20.0, 90.0, 110.0, 30.0, 150.0, 120.0, 10.0, 0.0, 20.0, 40.0, 155.0, 90.0, 70.0, 100.0, 170.0, 40.0, 0.0, 20.0, 50.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 0.0, 20.0, 0.0, 100.0, 30.0, 90.0, 130.0, 10.0, 30.0, 20.0, 10.0, 30.0, 0.0, 60.0, 20.0, 0.0, 0.0, 30.0, 0.0, 30.0, 20.0, 20.0, 30.0, 30.0, 10.0, 40.0, 190.0, 270.0, 40.0, 20.0, 30.0, 20.0, 30.0, 20.0, 160.0, 70.0, 30.0, 0.0, 60.0, 30.0, 10.0, 40.0, 0.0, 40.0, 10.0, 40.0, 0.0, 70.0, 30.0, 0.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 70.0, 250.0, -50.0, 20.0, 20.0, 0.0, 5.0, 30.0, 0.0, 30.0, 150.0, 0.0, 30.0, 0.0, 20.0, 40.0, 10.0, 20.0, 30.0, 10.0, 30.0, 40.0, 10.0, 40.0, 40.0, 20.0, 0.0, 70.0, 20.0, 0.0, 40.0, 20.0, 10.0, 20.0, 20.0, 40.0, 40.0, 40.0, 10.0, 180.0, 90.0, 40.0, 30.0, 40.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 140.0, 10.0, 10.0, 60.0, 40.0, 80.0, 40.0, -20.0, 60.0, 450.0, 80.0, 50.0, 10.0, 450.0, -30.0, 50.0, 0.0, 0.0, 40.0, 40.0, 70.0, 0.0, 0.0, 230.0, 0.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 70.0, 30.0, 60.0, 30.0, 100.0, -50.0, 30.0, 320.0, 160.0, 30.0, 260.0, 0.0, 10.0, 80.0, 40.0, 250.0, 80.0, 40.0, 10.0, 60.0, 20.0, 250.0, 20.0, 100.0, 30.0, 30.0, 0.0, 190.0, 70.0, 50.0, 70.0, 20.0, 10.0, 160.0, 70.0, 80.0, 0.0, 0.0, 20.0, 20.0, 30.0, 60.0, 50.0, 0.0, 40.0, 60.0, 0.0, 170.0, 40.0, 10.0, 20.0, 30.0, 50.0, 170.0, 170.0, 20.0, 10.0, 80.0, 40.0, 50.0, 40.0, 0.0, 50.0, 90.0, 350.0, 40.0, -10.0, 50.0, -40.0, 40.0, 30.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4573522172638547, "mean_inference_ms": 1.6560305097603247, "mean_action_processing_ms": 0.4307382727461064, "mean_env_wait_ms": 1.3303316881037701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05661201477050781, "StateBufferConnector_ms": 0.009413003921508789, "ViewRequirementAgentConnector_ms": 0.37443017959594727}, "num_episodes": 18, "episode_return_max": 1480.0, "episode_return_min": 60.0, "episode_return_mean": 579.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.25168622081834, "num_env_steps_trained_throughput_per_sec": 36.25168622081834, "timesteps_total": 360000, "num_env_steps_sampled_lifetime": 360000, "num_agent_steps_sampled_lifetime": 3600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3600000, "timers": {"training_iteration_time_ms": 110478.49, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110478.441, "sample_time_ms": 2380.343, "learn_time_ms": 108077.324, "learn_throughput": 37.011, "synch_weights_time_ms": 11.128}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 3600000, "num_agent_steps_trained": 3600000}, "done": false, "training_iteration": 90, "trial_id": "57140_00000", "date": "2024-06-27_02-05-20", "timestamp": 1719468320, "time_this_iter_s": 110.35417795181274, "time_total_s": 10245.632175683975, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23a79d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10245.632175683975, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 15.921153846153844, "ram_util_percent": 78.87564102564103}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.151552154807745, "cur_kl_coeff": 1.2163719177246093, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.299030190458693, "policy_loss": -0.0036783922177018387, "vf_loss": 4.300902074492904, "vf_explained_var": 0.00159186074655023, "kl": 0.0014851606253184315, "entropy": 0.40305673492411837, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 849795.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000}, "env_runners": {"episode_reward_max": 1480.0, "episode_reward_min": 60.0, "episode_reward_mean": 571.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 57.16}, "custom_metrics": {}, "hist_stats": {"episode_reward": [430.0, 1140.0, 110.0, 1380.0, 1240.0, 260.0, 420.0, 460.0, 410.0, 740.0, 390.0, 120.0, 500.0, 650.0, 510.0, 1100.0, 250.0, 900.0, 420.0, 310.0, 350.0, 680.0, 1185.0, 310.0, 430.0, 910.0, 180.0, 1040.0, 410.0, 390.0, 360.0, 350.0, 300.0, 235.0, 160.0, 840.0, 560.0, 1140.0, 880.0, 1270.0, 300.0, 240.0, 990.0, 930.0, 540.0, 650.0, 850.0, 730.0, 1480.0, 810.0, 1225.0, 440.0, 530.0, 775.0, 190.0, 430.0, 180.0, 670.0, 450.0, 240.0, 380.0, 265.0, 250.0, 240.0, 530.0, 210.0, 850.0, 620.0, 440.0, 940.0, 840.0, 580.0, 450.0, 420.0, 630.0, 620.0, 60.0, 820.0, 210.0, 160.0, 510.0, 720.0, 810.0, 240.0, 1200.0, 990.0, 800.0, 435.0, 250.0, 680.0, 210.0, 155.0, 500.0, 620.0, 680.0, 220.0, 1125.0, 310.0, 540.0, 280.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 10.0, 10.0, 20.0, 170.0, 80.0, 0.0, 60.0, 20.0, 50.0, 200.0, 40.0, 170.0, 380.0, 10.0, 110.0, 50.0, 30.0, 120.0, 30.0, 10.0, 0.0, 0.0, 10.0, 20.0, 40.0, 0.0, 0.0, 0.0, 30.0, 20.0, 20.0, 60.0, 30.0, -10.0, 30.0, 750.0, 80.0, 40.0, 360.0, 50.0, 80.0, 50.0, 50.0, 50.0, 310.0, 60.0, 80.0, 460.0, 50.0, 20.0, 40.0, 0.0, 30.0, 10.0, 20.0, 0.0, 130.0, 0.0, 10.0, 40.0, -80.0, 190.0, 10.0, 20.0, 20.0, 10.0, 40.0, 10.0, 160.0, 40.0, 20.0, 30.0, 20.0, 10.0, 30.0, 30.0, 200.0, 60.0, 20.0, 60.0, 0.0, 10.0, 20.0, 40.0, 50.0, 160.0, 0.0, 30.0, 40.0, 360.0, 150.0, 0.0, -20.0, 170.0, 20.0, 40.0, 30.0, 20.0, -30.0, 10.0, 10.0, 60.0, 10.0, 70.0, 0.0, 70.0, 40.0, 80.0, 40.0, 10.0, 10.0, 0.0, 0.0, 20.0, 30.0, 30.0, 10.0, 10.0, 0.0, 50.0, 0.0, 40.0, 40.0, 30.0, 0.0, 20.0, 20.0, 270.0, 30.0, 70.0, 50.0, 20.0, 30.0, 20.0, 150.0, 180.0, 10.0, 80.0, 40.0, 60.0, 40.0, 30.0, 180.0, 35.0, 100.0, 60.0, 0.0, 5.0, 0.0, 30.0, 50.0, 60.0, 250.0, -40.0, 0.0, 0.0, 120.0, 590.0, 40.0, 30.0, 10.0, 20.0, 20.0, 10.0, 10.0, 0.0, 130.0, 10.0, 10.0, 60.0, 40.0, 460.0, 160.0, 70.0, 0.0, 40.0, 40.0, 30.0, 0.0, 30.0, 60.0, 200.0, 60.0, 10.0, 10.0, 0.0, 20.0, 20.0, 10.0, 60.0, 150.0, 10.0, 40.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 100.0, 30.0, 0.0, 70.0, 10.0, 10.0, 0.0, 40.0, 0.0, 90.0, 10.0, 50.0, 20.0, 180.0, 290.0, 40.0, 10.0, 50.0, 0.0, 30.0, 50.0, 60.0, 60.0, -85.0, 560.0, 180.0, 130.0, 130.0, 70.0, 30.0, 90.0, 10.0, 0.0, 60.0, 20.0, 60.0, 40.0, 0.0, 10.0, 20.0, 160.0, 20.0, 30.0, 20.0, 30.0, 90.0, 10.0, 0.0, 0.0, 70.0, 40.0, 50.0, 20.0, 20.0, 20.0, 40.0, 20.0, 50.0, 30.0, 620.0, 0.0, 10.0, 30.0, 40.0, 0.0, 20.0, 50.0, 20.0, 0.0, 10.0, 40.0, 100.0, 390.0, 60.0, 270.0, 100.0, 30.0, 30.0, 10.0, 10.0, 30.0, 170.0, 0.0, 10.0, 80.0, 40.0, 40.0, 0.0, 10.0, 30.0, 10.0, 20.0, 80.0, 20.0, 50.0, 80.0, 20.0, 20.0, 30.0, 60.0, 40.0, 20.0, -40.0, 10.0, 40.0, 50.0, 30.0, -10.0, 180.0, 40.0, 0.0, 20.0, 260.0, 0.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 40.0, 10.0, 0.0, 50.0, 10.0, 150.0, 10.0, 0.0, 0.0, 30.0, 0.0, 30.0, 90.0, 10.0, 10.0, 20.0, 0.0, 30.0, 5.0, 40.0, 0.0, 50.0, 20.0, 0.0, 0.0, 10.0, 10.0, 30.0, 40.0, 0.0, 200.0, 50.0, 100.0, 0.0, -20.0, 80.0, 70.0, 10.0, 0.0, 350.0, 70.0, 130.0, 0.0, 0.0, 30.0, 10.0, 0.0, 60.0, 260.0, 0.0, 30.0, 80.0, 80.0, 40.0, 60.0, 20.0, 70.0, 450.0, 60.0, 250.0, 80.0, -50.0, 20.0, 390.0, 30.0, 210.0, 150.0, -30.0, 90.0, -10.0, 40.0, 60.0, 580.0, 280.0, 30.0, 0.0, 60.0, 70.0, 80.0, 70.0, 20.0, 20.0, 30.0, 0.0, 70.0, 10.0, 10.0, 100.0, 40.0, 0.0, 10.0, 90.0, 20.0, 40.0, 0.0, 0.0, 10.0, 60.0, 0.0, 10.0, -10.0, 20.0, 660.0, 50.0, 20.0, -10.0, 40.0, 0.0, 40.0, 180.0, 20.0, 10.0, 20.0, 260.0, 20.0, 60.0, 370.0, 80.0, 80.0, 10.0, 0.0, 60.0, 40.0, 310.0, 40.0, 20.0, 0.0, 40.0, 30.0, 0.0, 40.0, 0.0, 70.0, 20.0, 20.0, 50.0, 100.0, 20.0, 0.0, 330.0, 30.0, 10.0, 100.0, 170.0, 20.0, 40.0, 20.0, 0.0, 40.0, 420.0, 370.0, 30.0, 60.0, -40.0, 60.0, 190.0, 0.0, 30.0, -20.0, 50.0, -10.0, 60.0, 20.0, 50.0, 570.0, 70.0, 290.0, 0.0, 370.0, 60.0, 160.0, -40.0, 40.0, 40.0, 60.0, 40.0, 20.0, 20.0, 0.0, 470.0, 10.0, 160.0, 450.0, 170.0, 220.0, 100.0, -40.0, 40.0, 105.0, 10.0, 20.0, 0.0, 20.0, 40.0, 40.0, 40.0, 10.0, 20.0, 200.0, 50.0, 20.0, 30.0, 0.0, 80.0, 0.0, 20.0, 90.0, 110.0, 30.0, 150.0, 120.0, 10.0, 0.0, 20.0, 40.0, 155.0, 90.0, 70.0, 100.0, 170.0, 40.0, 0.0, 20.0, 50.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 0.0, 20.0, 0.0, 100.0, 30.0, 90.0, 130.0, 10.0, 30.0, 20.0, 10.0, 30.0, 0.0, 60.0, 20.0, 0.0, 0.0, 30.0, 0.0, 30.0, 20.0, 20.0, 30.0, 30.0, 10.0, 40.0, 190.0, 270.0, 40.0, 20.0, 30.0, 20.0, 30.0, 20.0, 160.0, 70.0, 30.0, 0.0, 60.0, 30.0, 10.0, 40.0, 0.0, 40.0, 10.0, 40.0, 0.0, 70.0, 30.0, 0.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 70.0, 250.0, -50.0, 20.0, 20.0, 0.0, 5.0, 30.0, 0.0, 30.0, 150.0, 0.0, 30.0, 0.0, 20.0, 40.0, 10.0, 20.0, 30.0, 10.0, 30.0, 40.0, 10.0, 40.0, 40.0, 20.0, 0.0, 70.0, 20.0, 0.0, 40.0, 20.0, 10.0, 20.0, 20.0, 40.0, 40.0, 40.0, 10.0, 180.0, 90.0, 40.0, 30.0, 40.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 140.0, 10.0, 10.0, 60.0, 40.0, 80.0, 40.0, -20.0, 60.0, 450.0, 80.0, 50.0, 10.0, 450.0, -30.0, 50.0, 0.0, 0.0, 40.0, 40.0, 70.0, 0.0, 0.0, 230.0, 0.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 70.0, 30.0, 60.0, 30.0, 100.0, -50.0, 30.0, 320.0, 160.0, 30.0, 260.0, 0.0, 10.0, 80.0, 40.0, 250.0, 80.0, 40.0, 10.0, 60.0, 20.0, 250.0, 20.0, 100.0, 30.0, 30.0, 0.0, 190.0, 70.0, 50.0, 70.0, 20.0, 10.0, 160.0, 70.0, 80.0, 0.0, 0.0, 20.0, 20.0, 30.0, 60.0, 50.0, 0.0, 40.0, 60.0, 0.0, 170.0, 40.0, 10.0, 20.0, 30.0, 50.0, 170.0, 170.0, 20.0, 10.0, 80.0, 40.0, 50.0, 40.0, 0.0, 50.0, 90.0, 350.0, 40.0, -10.0, 50.0, -40.0, 40.0, 30.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 20.0, 20.0, 0.0, 400.0, 190.0, 40.0, 20.0, 0.0, 70.0, 50.0, 30.0, 20.0, 70.0, 0.0, 0.0, 30.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, 60.0, 10.0, 10.0, 0.0, 30.0, 40.0, 40.0, 10.0, 40.0, 20.0, 180.0, 120.0, 20.0, 10.0, 30.0, 100.0, 70.0, 0.0, 30.0, 50.0, 160.0, 40.0, 170.0, 80.0, 20.0, 10.0, 100.0, 40.0, 10.0, 30.0, 260.0, 30.0, 10.0, 230.0, 90.0, 10.0, 0.0, 80.0, 0.0, 30.0, 40.0, 20.0, 40.0, 0.0, 20.0, 10.0, 100.0, 50.0, 0.0, 380.0, 50.0, 40.0, 20.0, 490.0, 60.0, -30.0, 750.0, 20.0, 40.0, 90.0, 0.0, 10.0, 70.0, 30.0, 10.0, 60.0, 260.0, 10.0, 70.0, 10.0, 40.0, 60.0, 70.0, 160.0, 60.0, -5.0, 40.0, 290.0, 20.0, 10.0, 0.0, 70.0, 0.0, 10.0, 0.0, 50.0, 30.0, 30.0, 30.0, 0.0, 50.0, 0.0, 30.0, 30.0, 0.0, 20.0, 50.0, 40.0, 120.0, 50.0, 80.0, 60.0, 20.0, 240.0, 0.0, 0.0, 30.0, 80.0, 30.0, 30.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 15.0, 30.0, 40.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 70.0, 30.0, 30.0, 10.0, -50.0, 250.0, 70.0, 0.0, 30.0, 60.0, 0.0, 30.0, 70.0, 150.0, 150.0, 70.0, 10.0, 30.0, 30.0, 80.0, 60.0, 0.0, 80.0, 380.0, 20.0, 40.0, 60.0, 0.0, 40.0, 0.0, 10.0, 40.0, 30.0, 30.0, 10.0, 0.0, 40.0, 30.0, 30.0, 0.0, 40.0, 100.0, 180.0, 20.0, 160.0, 55.0, 60.0, 390.0, 20.0, 100.0, 0.0, 10.0, 20.0, 20.0, 20.0, 0.0, 30.0, 20.0, 20.0, 170.0, 20.0, 40.0, 100.0, 20.0, 160.0, 90.0, 40.0, 30.0, 0.0, 40.0, 10.0, 10.0, 40.0, 20.0, 60.0, 30.0, 40.0, 40.0, 30.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4554692963341822, "mean_inference_ms": 1.6486859466418522, "mean_action_processing_ms": 0.42988029442435655, "mean_env_wait_ms": 1.3276938782217889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05712580680847168, "StateBufferConnector_ms": 0.009211301803588867, "ViewRequirementAgentConnector_ms": 0.3737027645111084}, "num_episodes": 23, "episode_return_max": 1480.0, "episode_return_min": 60.0, "episode_return_mean": 571.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.49361862902833, "num_env_steps_trained_throughput_per_sec": 36.49361862902833, "timesteps_total": 364000, "num_env_steps_sampled_lifetime": 364000, "num_agent_steps_sampled_lifetime": 3640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3640000, "timers": {"training_iteration_time_ms": 110441.534, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110441.487, "sample_time_ms": 2388.497, "learn_time_ms": 108032.559, "learn_throughput": 37.026, "synch_weights_time_ms": 10.867}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 3640000, "num_agent_steps_trained": 3640000}, "done": false, "training_iteration": 91, "trial_id": "57140_00000", "date": "2024-06-27_02-07-09", "timestamp": 1719468429, "time_this_iter_s": 109.62211418151855, "time_total_s": 10355.254289865494, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b193bca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10355.254289865494, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 15.62516129032258, "ram_util_percent": 78.66387096774193}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0712859497632716, "cur_kl_coeff": 0.6081859588623046, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.003977817025457641, "vf_loss": 4.606048881664824, "vf_explained_var": 0.0003234000124743444, "kl": Infinity, "entropy": 0.38478606160138995, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 859185.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000}, "env_runners": {"episode_reward_max": 1750.0, "episode_reward_min": 0.0, "episode_reward_mean": 572.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -970.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 57.25}, "custom_metrics": {}, "hist_stats": {"episode_reward": [420.0, 310.0, 350.0, 680.0, 1185.0, 310.0, 430.0, 910.0, 180.0, 1040.0, 410.0, 390.0, 360.0, 350.0, 300.0, 235.0, 160.0, 840.0, 560.0, 1140.0, 880.0, 1270.0, 300.0, 240.0, 990.0, 930.0, 540.0, 650.0, 850.0, 730.0, 1480.0, 810.0, 1225.0, 440.0, 530.0, 775.0, 190.0, 430.0, 180.0, 670.0, 450.0, 240.0, 380.0, 265.0, 250.0, 240.0, 530.0, 210.0, 850.0, 620.0, 440.0, 940.0, 840.0, 580.0, 450.0, 420.0, 630.0, 620.0, 60.0, 820.0, 210.0, 160.0, 510.0, 720.0, 810.0, 240.0, 1200.0, 990.0, 800.0, 435.0, 250.0, 680.0, 210.0, 155.0, 500.0, 620.0, 680.0, 220.0, 1125.0, 310.0, 540.0, 280.0, 390.0, 350.0, 340.0, 1050.0, 1240.0, 1750.0, 1020.0, 1020.0, 370.0, 200.0, 0.0, 620.0, 390.0, 630.0, 640.0, 160.0, 90.0, 840.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 60.0, 200.0, 60.0, 10.0, 10.0, 0.0, 20.0, 20.0, 10.0, 60.0, 150.0, 10.0, 40.0, 20.0, 0.0, 0.0, 20.0, 0.0, 10.0, 100.0, 30.0, 0.0, 70.0, 10.0, 10.0, 0.0, 40.0, 0.0, 90.0, 10.0, 50.0, 20.0, 180.0, 290.0, 40.0, 10.0, 50.0, 0.0, 30.0, 50.0, 60.0, 60.0, -85.0, 560.0, 180.0, 130.0, 130.0, 70.0, 30.0, 90.0, 10.0, 0.0, 60.0, 20.0, 60.0, 40.0, 0.0, 10.0, 20.0, 160.0, 20.0, 30.0, 20.0, 30.0, 90.0, 10.0, 0.0, 0.0, 70.0, 40.0, 50.0, 20.0, 20.0, 20.0, 40.0, 20.0, 50.0, 30.0, 620.0, 0.0, 10.0, 30.0, 40.0, 0.0, 20.0, 50.0, 20.0, 0.0, 10.0, 40.0, 100.0, 390.0, 60.0, 270.0, 100.0, 30.0, 30.0, 10.0, 10.0, 30.0, 170.0, 0.0, 10.0, 80.0, 40.0, 40.0, 0.0, 10.0, 30.0, 10.0, 20.0, 80.0, 20.0, 50.0, 80.0, 20.0, 20.0, 30.0, 60.0, 40.0, 20.0, -40.0, 10.0, 40.0, 50.0, 30.0, -10.0, 180.0, 40.0, 0.0, 20.0, 260.0, 0.0, 20.0, 20.0, 20.0, 0.0, 10.0, 0.0, 40.0, 10.0, 0.0, 50.0, 10.0, 150.0, 10.0, 0.0, 0.0, 30.0, 0.0, 30.0, 90.0, 10.0, 10.0, 20.0, 0.0, 30.0, 5.0, 40.0, 0.0, 50.0, 20.0, 0.0, 0.0, 10.0, 10.0, 30.0, 40.0, 0.0, 200.0, 50.0, 100.0, 0.0, -20.0, 80.0, 70.0, 10.0, 0.0, 350.0, 70.0, 130.0, 0.0, 0.0, 30.0, 10.0, 0.0, 60.0, 260.0, 0.0, 30.0, 80.0, 80.0, 40.0, 60.0, 20.0, 70.0, 450.0, 60.0, 250.0, 80.0, -50.0, 20.0, 390.0, 30.0, 210.0, 150.0, -30.0, 90.0, -10.0, 40.0, 60.0, 580.0, 280.0, 30.0, 0.0, 60.0, 70.0, 80.0, 70.0, 20.0, 20.0, 30.0, 0.0, 70.0, 10.0, 10.0, 100.0, 40.0, 0.0, 10.0, 90.0, 20.0, 40.0, 0.0, 0.0, 10.0, 60.0, 0.0, 10.0, -10.0, 20.0, 660.0, 50.0, 20.0, -10.0, 40.0, 0.0, 40.0, 180.0, 20.0, 10.0, 20.0, 260.0, 20.0, 60.0, 370.0, 80.0, 80.0, 10.0, 0.0, 60.0, 40.0, 310.0, 40.0, 20.0, 0.0, 40.0, 30.0, 0.0, 40.0, 0.0, 70.0, 20.0, 20.0, 50.0, 100.0, 20.0, 0.0, 330.0, 30.0, 10.0, 100.0, 170.0, 20.0, 40.0, 20.0, 0.0, 40.0, 420.0, 370.0, 30.0, 60.0, -40.0, 60.0, 190.0, 0.0, 30.0, -20.0, 50.0, -10.0, 60.0, 20.0, 50.0, 570.0, 70.0, 290.0, 0.0, 370.0, 60.0, 160.0, -40.0, 40.0, 40.0, 60.0, 40.0, 20.0, 20.0, 0.0, 470.0, 10.0, 160.0, 450.0, 170.0, 220.0, 100.0, -40.0, 40.0, 105.0, 10.0, 20.0, 0.0, 20.0, 40.0, 40.0, 40.0, 10.0, 20.0, 200.0, 50.0, 20.0, 30.0, 0.0, 80.0, 0.0, 20.0, 90.0, 110.0, 30.0, 150.0, 120.0, 10.0, 0.0, 20.0, 40.0, 155.0, 90.0, 70.0, 100.0, 170.0, 40.0, 0.0, 20.0, 50.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 0.0, 20.0, 0.0, 100.0, 30.0, 90.0, 130.0, 10.0, 30.0, 20.0, 10.0, 30.0, 0.0, 60.0, 20.0, 0.0, 0.0, 30.0, 0.0, 30.0, 20.0, 20.0, 30.0, 30.0, 10.0, 40.0, 190.0, 270.0, 40.0, 20.0, 30.0, 20.0, 30.0, 20.0, 160.0, 70.0, 30.0, 0.0, 60.0, 30.0, 10.0, 40.0, 0.0, 40.0, 10.0, 40.0, 0.0, 70.0, 30.0, 0.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 70.0, 250.0, -50.0, 20.0, 20.0, 0.0, 5.0, 30.0, 0.0, 30.0, 150.0, 0.0, 30.0, 0.0, 20.0, 40.0, 10.0, 20.0, 30.0, 10.0, 30.0, 40.0, 10.0, 40.0, 40.0, 20.0, 0.0, 70.0, 20.0, 0.0, 40.0, 20.0, 10.0, 20.0, 20.0, 40.0, 40.0, 40.0, 10.0, 180.0, 90.0, 40.0, 30.0, 40.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 140.0, 10.0, 10.0, 60.0, 40.0, 80.0, 40.0, -20.0, 60.0, 450.0, 80.0, 50.0, 10.0, 450.0, -30.0, 50.0, 0.0, 0.0, 40.0, 40.0, 70.0, 0.0, 0.0, 230.0, 0.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 70.0, 30.0, 60.0, 30.0, 100.0, -50.0, 30.0, 320.0, 160.0, 30.0, 260.0, 0.0, 10.0, 80.0, 40.0, 250.0, 80.0, 40.0, 10.0, 60.0, 20.0, 250.0, 20.0, 100.0, 30.0, 30.0, 0.0, 190.0, 70.0, 50.0, 70.0, 20.0, 10.0, 160.0, 70.0, 80.0, 0.0, 0.0, 20.0, 20.0, 30.0, 60.0, 50.0, 0.0, 40.0, 60.0, 0.0, 170.0, 40.0, 10.0, 20.0, 30.0, 50.0, 170.0, 170.0, 20.0, 10.0, 80.0, 40.0, 50.0, 40.0, 0.0, 50.0, 90.0, 350.0, 40.0, -10.0, 50.0, -40.0, 40.0, 30.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 20.0, 20.0, 0.0, 400.0, 190.0, 40.0, 20.0, 0.0, 70.0, 50.0, 30.0, 20.0, 70.0, 0.0, 0.0, 30.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, 60.0, 10.0, 10.0, 0.0, 30.0, 40.0, 40.0, 10.0, 40.0, 20.0, 180.0, 120.0, 20.0, 10.0, 30.0, 100.0, 70.0, 0.0, 30.0, 50.0, 160.0, 40.0, 170.0, 80.0, 20.0, 10.0, 100.0, 40.0, 10.0, 30.0, 260.0, 30.0, 10.0, 230.0, 90.0, 10.0, 0.0, 80.0, 0.0, 30.0, 40.0, 20.0, 40.0, 0.0, 20.0, 10.0, 100.0, 50.0, 0.0, 380.0, 50.0, 40.0, 20.0, 490.0, 60.0, -30.0, 750.0, 20.0, 40.0, 90.0, 0.0, 10.0, 70.0, 30.0, 10.0, 60.0, 260.0, 10.0, 70.0, 10.0, 40.0, 60.0, 70.0, 160.0, 60.0, -5.0, 40.0, 290.0, 20.0, 10.0, 0.0, 70.0, 0.0, 10.0, 0.0, 50.0, 30.0, 30.0, 30.0, 0.0, 50.0, 0.0, 30.0, 30.0, 0.0, 20.0, 50.0, 40.0, 120.0, 50.0, 80.0, 60.0, 20.0, 240.0, 0.0, 0.0, 30.0, 80.0, 30.0, 30.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 15.0, 30.0, 40.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 70.0, 30.0, 30.0, 10.0, -50.0, 250.0, 70.0, 0.0, 30.0, 60.0, 0.0, 30.0, 70.0, 150.0, 150.0, 70.0, 10.0, 30.0, 30.0, 80.0, 60.0, 0.0, 80.0, 380.0, 20.0, 40.0, 60.0, 0.0, 40.0, 0.0, 10.0, 40.0, 30.0, 30.0, 10.0, 0.0, 40.0, 30.0, 30.0, 0.0, 40.0, 100.0, 180.0, 20.0, 160.0, 55.0, 60.0, 390.0, 20.0, 100.0, 0.0, 10.0, 20.0, 20.0, 20.0, 0.0, 30.0, 20.0, 20.0, 170.0, 20.0, 40.0, 100.0, 20.0, 160.0, 90.0, 40.0, 30.0, 0.0, 40.0, 10.0, 10.0, 40.0, 20.0, 60.0, 30.0, 40.0, 40.0, 30.0, 0.0, 0.0, 30.0, 250.0, 30.0, 50.0, 0.0, 10.0, 0.0, 10.0, 10.0, 80.0, 0.0, 30.0, 10.0, 10.0, 0.0, 0.0, 30.0, 20.0, 170.0, 90.0, 20.0, 30.0, 100.0, 40.0, 40.0, 0.0, 0.0, 20.0, 0.0, 500.0, 70.0, 30.0, 70.0, 80.0, 150.0, 30.0, 40.0, 60.0, 20.0, 20.0, 270.0, 40.0, 0.0, 100.0, 50.0, -50.0, 690.0, 120.0, 0.0, 70.0, 230.0, 150.0, 90.0, 60.0, 170.0, 510.0, 70.0, 370.0, 30.0, 30.0, 20.0, 50.0, -30.0, 200.0, 200.0, 50.0, 110.0, 380.0, 10.0, 140.0, -50.0, 270.0, 110.0, 80.0, 60.0, 30.0, 40.0, 50.0, 290.0, 30.0, 80.0, 10.0, 30.0, 80.0, 40.0, 20.0, 60.0, 0.0, 20.0, 10.0, 10.0, 0.0, 40.0, 50.0, 20.0, 0.0, 20.0, 10.0, 40.0, 20.0, 10.0, 30.0, 30.0, 50.0, 160.0, -970.0, 160.0, 50.0, 460.0, 370.0, 20.0, 90.0, 30.0, 50.0, 30.0, 10.0, 0.0, -10.0, 30.0, 0.0, 270.0, 10.0, 10.0, 20.0, 0.0, 20.0, 0.0, 40.0, 20.0, 20.0, 0.0, 20.0, 20.0, 130.0, 40.0, 70.0, 310.0, 10.0, 10.0, 0.0, 60.0, 450.0, 10.0, -10.0, -50.0, -10.0, 120.0, 40.0, 30.0, 20.0, 30.0, 20.0, 30.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 30.0, 20.0, 0.0, 10.0, 120.0, 40.0, -180.0, 10.0, 40.0, 0.0, 290.0, 0.0, -30.0, 50.0, 20.0, 30.0, 30.0, 50.0, 40.0, 360.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4539905571628162, "mean_inference_ms": 1.65286603635507, "mean_action_processing_ms": 0.429618466599116, "mean_env_wait_ms": 1.3279892076528959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.054186105728149414, "StateBufferConnector_ms": 0.008992195129394531, "ViewRequirementAgentConnector_ms": 0.369429349899292}, "num_episodes": 18, "episode_return_max": 1750.0, "episode_return_min": 0.0, "episode_return_mean": 572.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.42786837749901, "num_env_steps_trained_throughput_per_sec": 36.42786837749901, "timesteps_total": 368000, "num_env_steps_sampled_lifetime": 368000, "num_agent_steps_sampled_lifetime": 3680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3680000, "timers": {"training_iteration_time_ms": 110361.484, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110361.437, "sample_time_ms": 2396.061, "learn_time_ms": 107944.877, "learn_throughput": 37.056, "synch_weights_time_ms": 10.855}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 3680000, "num_agent_steps_trained": 3680000}, "done": false, "training_iteration": 92, "trial_id": "57140_00000", "date": "2024-06-27_02-08-59", "timestamp": 1719468539, "time_this_iter_s": 109.81934809684753, "time_total_s": 10465.073637962341, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23a7550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10465.073637962341, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 15.710256410256411, "ram_util_percent": 78.79615384615384}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.160550615131157, "cur_kl_coeff": 0.9122789382934572, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002947412623430744, "vf_loss": 4.149153098460839, "vf_explained_var": 0.0008761539245946719, "kl": Infinity, "entropy": 0.4033351788378625, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 868575.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000}, "env_runners": {"episode_reward_max": 1750.0, "episode_reward_min": 0.0, "episode_reward_mean": 581.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -970.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 58.145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [560.0, 1140.0, 880.0, 1270.0, 300.0, 240.0, 990.0, 930.0, 540.0, 650.0, 850.0, 730.0, 1480.0, 810.0, 1225.0, 440.0, 530.0, 775.0, 190.0, 430.0, 180.0, 670.0, 450.0, 240.0, 380.0, 265.0, 250.0, 240.0, 530.0, 210.0, 850.0, 620.0, 440.0, 940.0, 840.0, 580.0, 450.0, 420.0, 630.0, 620.0, 60.0, 820.0, 210.0, 160.0, 510.0, 720.0, 810.0, 240.0, 1200.0, 990.0, 800.0, 435.0, 250.0, 680.0, 210.0, 155.0, 500.0, 620.0, 680.0, 220.0, 1125.0, 310.0, 540.0, 280.0, 390.0, 350.0, 340.0, 1050.0, 1240.0, 1750.0, 1020.0, 1020.0, 370.0, 200.0, 0.0, 620.0, 390.0, 630.0, 640.0, 160.0, 90.0, 840.0, 290.0, 220.0, 180.0, 1160.0, 830.0, 775.0, 320.0, 640.0, 530.0, 560.0, 790.0, 1320.0, 590.0, 250.0, 220.0, 210.0, 350.0, 520.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 130.0, 0.0, 0.0, 30.0, 10.0, 0.0, 60.0, 260.0, 0.0, 30.0, 80.0, 80.0, 40.0, 60.0, 20.0, 70.0, 450.0, 60.0, 250.0, 80.0, -50.0, 20.0, 390.0, 30.0, 210.0, 150.0, -30.0, 90.0, -10.0, 40.0, 60.0, 580.0, 280.0, 30.0, 0.0, 60.0, 70.0, 80.0, 70.0, 20.0, 20.0, 30.0, 0.0, 70.0, 10.0, 10.0, 100.0, 40.0, 0.0, 10.0, 90.0, 20.0, 40.0, 0.0, 0.0, 10.0, 60.0, 0.0, 10.0, -10.0, 20.0, 660.0, 50.0, 20.0, -10.0, 40.0, 0.0, 40.0, 180.0, 20.0, 10.0, 20.0, 260.0, 20.0, 60.0, 370.0, 80.0, 80.0, 10.0, 0.0, 60.0, 40.0, 310.0, 40.0, 20.0, 0.0, 40.0, 30.0, 0.0, 40.0, 0.0, 70.0, 20.0, 20.0, 50.0, 100.0, 20.0, 0.0, 330.0, 30.0, 10.0, 100.0, 170.0, 20.0, 40.0, 20.0, 0.0, 40.0, 420.0, 370.0, 30.0, 60.0, -40.0, 60.0, 190.0, 0.0, 30.0, -20.0, 50.0, -10.0, 60.0, 20.0, 50.0, 570.0, 70.0, 290.0, 0.0, 370.0, 60.0, 160.0, -40.0, 40.0, 40.0, 60.0, 40.0, 20.0, 20.0, 0.0, 470.0, 10.0, 160.0, 450.0, 170.0, 220.0, 100.0, -40.0, 40.0, 105.0, 10.0, 20.0, 0.0, 20.0, 40.0, 40.0, 40.0, 10.0, 20.0, 200.0, 50.0, 20.0, 30.0, 0.0, 80.0, 0.0, 20.0, 90.0, 110.0, 30.0, 150.0, 120.0, 10.0, 0.0, 20.0, 40.0, 155.0, 90.0, 70.0, 100.0, 170.0, 40.0, 0.0, 20.0, 50.0, 20.0, 10.0, 10.0, 0.0, 10.0, 30.0, 0.0, 20.0, 0.0, 100.0, 30.0, 90.0, 130.0, 10.0, 30.0, 20.0, 10.0, 30.0, 0.0, 60.0, 20.0, 0.0, 0.0, 30.0, 0.0, 30.0, 20.0, 20.0, 30.0, 30.0, 10.0, 40.0, 190.0, 270.0, 40.0, 20.0, 30.0, 20.0, 30.0, 20.0, 160.0, 70.0, 30.0, 0.0, 60.0, 30.0, 10.0, 40.0, 0.0, 40.0, 10.0, 40.0, 0.0, 70.0, 30.0, 0.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 70.0, 250.0, -50.0, 20.0, 20.0, 0.0, 5.0, 30.0, 0.0, 30.0, 150.0, 0.0, 30.0, 0.0, 20.0, 40.0, 10.0, 20.0, 30.0, 10.0, 30.0, 40.0, 10.0, 40.0, 40.0, 20.0, 0.0, 70.0, 20.0, 0.0, 40.0, 20.0, 10.0, 20.0, 20.0, 40.0, 40.0, 40.0, 10.0, 180.0, 90.0, 40.0, 30.0, 40.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 140.0, 10.0, 10.0, 60.0, 40.0, 80.0, 40.0, -20.0, 60.0, 450.0, 80.0, 50.0, 10.0, 450.0, -30.0, 50.0, 0.0, 0.0, 40.0, 40.0, 70.0, 0.0, 0.0, 230.0, 0.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 70.0, 30.0, 60.0, 30.0, 100.0, -50.0, 30.0, 320.0, 160.0, 30.0, 260.0, 0.0, 10.0, 80.0, 40.0, 250.0, 80.0, 40.0, 10.0, 60.0, 20.0, 250.0, 20.0, 100.0, 30.0, 30.0, 0.0, 190.0, 70.0, 50.0, 70.0, 20.0, 10.0, 160.0, 70.0, 80.0, 0.0, 0.0, 20.0, 20.0, 30.0, 60.0, 50.0, 0.0, 40.0, 60.0, 0.0, 170.0, 40.0, 10.0, 20.0, 30.0, 50.0, 170.0, 170.0, 20.0, 10.0, 80.0, 40.0, 50.0, 40.0, 0.0, 50.0, 90.0, 350.0, 40.0, -10.0, 50.0, -40.0, 40.0, 30.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 20.0, 20.0, 0.0, 400.0, 190.0, 40.0, 20.0, 0.0, 70.0, 50.0, 30.0, 20.0, 70.0, 0.0, 0.0, 30.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, 60.0, 10.0, 10.0, 0.0, 30.0, 40.0, 40.0, 10.0, 40.0, 20.0, 180.0, 120.0, 20.0, 10.0, 30.0, 100.0, 70.0, 0.0, 30.0, 50.0, 160.0, 40.0, 170.0, 80.0, 20.0, 10.0, 100.0, 40.0, 10.0, 30.0, 260.0, 30.0, 10.0, 230.0, 90.0, 10.0, 0.0, 80.0, 0.0, 30.0, 40.0, 20.0, 40.0, 0.0, 20.0, 10.0, 100.0, 50.0, 0.0, 380.0, 50.0, 40.0, 20.0, 490.0, 60.0, -30.0, 750.0, 20.0, 40.0, 90.0, 0.0, 10.0, 70.0, 30.0, 10.0, 60.0, 260.0, 10.0, 70.0, 10.0, 40.0, 60.0, 70.0, 160.0, 60.0, -5.0, 40.0, 290.0, 20.0, 10.0, 0.0, 70.0, 0.0, 10.0, 0.0, 50.0, 30.0, 30.0, 30.0, 0.0, 50.0, 0.0, 30.0, 30.0, 0.0, 20.0, 50.0, 40.0, 120.0, 50.0, 80.0, 60.0, 20.0, 240.0, 0.0, 0.0, 30.0, 80.0, 30.0, 30.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 15.0, 30.0, 40.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 70.0, 30.0, 30.0, 10.0, -50.0, 250.0, 70.0, 0.0, 30.0, 60.0, 0.0, 30.0, 70.0, 150.0, 150.0, 70.0, 10.0, 30.0, 30.0, 80.0, 60.0, 0.0, 80.0, 380.0, 20.0, 40.0, 60.0, 0.0, 40.0, 0.0, 10.0, 40.0, 30.0, 30.0, 10.0, 0.0, 40.0, 30.0, 30.0, 0.0, 40.0, 100.0, 180.0, 20.0, 160.0, 55.0, 60.0, 390.0, 20.0, 100.0, 0.0, 10.0, 20.0, 20.0, 20.0, 0.0, 30.0, 20.0, 20.0, 170.0, 20.0, 40.0, 100.0, 20.0, 160.0, 90.0, 40.0, 30.0, 0.0, 40.0, 10.0, 10.0, 40.0, 20.0, 60.0, 30.0, 40.0, 40.0, 30.0, 0.0, 0.0, 30.0, 250.0, 30.0, 50.0, 0.0, 10.0, 0.0, 10.0, 10.0, 80.0, 0.0, 30.0, 10.0, 10.0, 0.0, 0.0, 30.0, 20.0, 170.0, 90.0, 20.0, 30.0, 100.0, 40.0, 40.0, 0.0, 0.0, 20.0, 0.0, 500.0, 70.0, 30.0, 70.0, 80.0, 150.0, 30.0, 40.0, 60.0, 20.0, 20.0, 270.0, 40.0, 0.0, 100.0, 50.0, -50.0, 690.0, 120.0, 0.0, 70.0, 230.0, 150.0, 90.0, 60.0, 170.0, 510.0, 70.0, 370.0, 30.0, 30.0, 20.0, 50.0, -30.0, 200.0, 200.0, 50.0, 110.0, 380.0, 10.0, 140.0, -50.0, 270.0, 110.0, 80.0, 60.0, 30.0, 40.0, 50.0, 290.0, 30.0, 80.0, 10.0, 30.0, 80.0, 40.0, 20.0, 60.0, 0.0, 20.0, 10.0, 10.0, 0.0, 40.0, 50.0, 20.0, 0.0, 20.0, 10.0, 40.0, 20.0, 10.0, 30.0, 30.0, 50.0, 160.0, -970.0, 160.0, 50.0, 460.0, 370.0, 20.0, 90.0, 30.0, 50.0, 30.0, 10.0, 0.0, -10.0, 30.0, 0.0, 270.0, 10.0, 10.0, 20.0, 0.0, 20.0, 0.0, 40.0, 20.0, 20.0, 0.0, 20.0, 20.0, 130.0, 40.0, 70.0, 310.0, 10.0, 10.0, 0.0, 60.0, 450.0, 10.0, -10.0, -50.0, -10.0, 120.0, 40.0, 30.0, 20.0, 30.0, 20.0, 30.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 30.0, 20.0, 0.0, 10.0, 120.0, 40.0, -180.0, 10.0, 40.0, 0.0, 290.0, 0.0, -30.0, 50.0, 20.0, 30.0, 30.0, 50.0, 40.0, 360.0, 20.0, 120.0, 0.0, 0.0, 0.0, 40.0, 60.0, 20.0, 20.0, 10.0, 0.0, 10.0, 40.0, 20.0, 60.0, 30.0, 0.0, 10.0, 40.0, 10.0, 10.0, 10.0, 10.0, 30.0, 30.0, 10.0, 30.0, 20.0, 30.0, 0.0, 30.0, 400.0, 410.0, 0.0, 60.0, 50.0, 90.0, 0.0, 110.0, 10.0, 90.0, 50.0, 40.0, 40.0, 450.0, 10.0, 20.0, 20.0, 30.0, 80.0, -30.0, 40.0, 170.0, 270.0, 250.0, 10.0, 20.0, 10.0, -5.0, 40.0, 20.0, 0.0, 20.0, 0.0, 30.0, 0.0, 260.0, 10.0, -20.0, 0.0, 30.0, 0.0, 210.0, 180.0, 80.0, 40.0, 40.0, 20.0, 30.0, 10.0, 0.0, 10.0, 60.0, 30.0, 80.0, 40.0, 90.0, 10.0, 50.0, 160.0, 20.0, 10.0, 280.0, 70.0, -10.0, 50.0, 20.0, 20.0, 0.0, 100.0, 60.0, 260.0, 5.0, 5.0, 70.0, 60.0, 10.0, 90.0, 50.0, 180.0, 0.0, 60.0, 540.0, 20.0, 50.0, 0.0, 280.0, 30.0, 30.0, 310.0, -40.0, -50.0, 40.0, 30.0, 20.0, 30.0, 130.0, 10.0, 40.0, 380.0, 90.0, 30.0, 20.0, 0.0, 50.0, 10.0, 10.0, 20.0, 0.0, 20.0, 40.0, 20.0, 30.0, 30.0, 40.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 80.0, 50.0, 40.0, 40.0, 0.0, 20.0, 0.0, 40.0, 10.0, 120.0, 20.0, 60.0, 10.0, 10.0, 10.0, 0.0, 50.0, 140.0, 0.0, 180.0, 80.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4527108791307746, "mean_inference_ms": 1.6517571724594406, "mean_action_processing_ms": 0.42913193923081266, "mean_env_wait_ms": 1.327003261706098, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05514645576477051, "StateBufferConnector_ms": 0.008981943130493164, "ViewRequirementAgentConnector_ms": 0.3748152256011963}, "num_episodes": 18, "episode_return_max": 1750.0, "episode_return_min": 0.0, "episode_return_mean": 581.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.23880221226345, "num_env_steps_trained_throughput_per_sec": 36.23880221226345, "timesteps_total": 372000, "num_env_steps_sampled_lifetime": 372000, "num_agent_steps_sampled_lifetime": 3720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3720000, "timers": {"training_iteration_time_ms": 110396.602, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110396.555, "sample_time_ms": 2398.866, "learn_time_ms": 107977.218, "learn_throughput": 37.045, "synch_weights_time_ms": 10.923}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 3720000, "num_agent_steps_trained": 3720000}, "done": false, "training_iteration": 93, "trial_id": "57140_00000", "date": "2024-06-27_02-10-50", "timestamp": 1719468650, "time_this_iter_s": 110.39305806159973, "time_total_s": 10575.466696023941, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23a7160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10575.466696023941, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 15.603846153846153, "ram_util_percent": 77.89807692307693}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.543488169874881, "cur_kl_coeff": 1.3684184074401853, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0047015634308597894, "vf_loss": 4.836284507704746, "vf_explained_var": 0.0008024932604374342, "kl": Infinity, "entropy": 0.36508017490053585, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 877965.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000}, "env_runners": {"episode_reward_max": 1750.0, "episode_reward_min": 0.0, "episode_reward_mean": 579.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -970.0}, "policy_reward_max": {"policy_0": 930.0}, "policy_reward_mean": {"policy_0": 57.93}, "custom_metrics": {}, "hist_stats": {"episode_reward": [450.0, 240.0, 380.0, 265.0, 250.0, 240.0, 530.0, 210.0, 850.0, 620.0, 440.0, 940.0, 840.0, 580.0, 450.0, 420.0, 630.0, 620.0, 60.0, 820.0, 210.0, 160.0, 510.0, 720.0, 810.0, 240.0, 1200.0, 990.0, 800.0, 435.0, 250.0, 680.0, 210.0, 155.0, 500.0, 620.0, 680.0, 220.0, 1125.0, 310.0, 540.0, 280.0, 390.0, 350.0, 340.0, 1050.0, 1240.0, 1750.0, 1020.0, 1020.0, 370.0, 200.0, 0.0, 620.0, 390.0, 630.0, 640.0, 160.0, 90.0, 840.0, 290.0, 220.0, 180.0, 1160.0, 830.0, 775.0, 320.0, 640.0, 530.0, 560.0, 790.0, 1320.0, 590.0, 250.0, 220.0, 210.0, 350.0, 520.0, 230.0, 460.0, 480.0, 1620.0, 540.0, 845.0, 400.0, 570.0, 130.0, 340.0, 530.0, 390.0, 1265.0, 330.0, 750.0, 1300.0, 1470.0, 650.0, 370.0, 660.0, 1305.0, 960.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 20.0, 30.0, 20.0, 160.0, 70.0, 30.0, 0.0, 60.0, 30.0, 10.0, 40.0, 0.0, 40.0, 10.0, 40.0, 0.0, 70.0, 30.0, 0.0, 10.0, 30.0, 30.0, 20.0, 0.0, 0.0, 70.0, 250.0, -50.0, 20.0, 20.0, 0.0, 5.0, 30.0, 0.0, 30.0, 150.0, 0.0, 30.0, 0.0, 20.0, 40.0, 10.0, 20.0, 30.0, 10.0, 30.0, 40.0, 10.0, 40.0, 40.0, 20.0, 0.0, 70.0, 20.0, 0.0, 40.0, 20.0, 10.0, 20.0, 20.0, 40.0, 40.0, 40.0, 10.0, 180.0, 90.0, 40.0, 30.0, 40.0, 20.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 140.0, 10.0, 10.0, 60.0, 40.0, 80.0, 40.0, -20.0, 60.0, 450.0, 80.0, 50.0, 10.0, 450.0, -30.0, 50.0, 0.0, 0.0, 40.0, 40.0, 70.0, 0.0, 0.0, 230.0, 0.0, 20.0, 10.0, 20.0, 10.0, 30.0, 20.0, 70.0, 30.0, 60.0, 30.0, 100.0, -50.0, 30.0, 320.0, 160.0, 30.0, 260.0, 0.0, 10.0, 80.0, 40.0, 250.0, 80.0, 40.0, 10.0, 60.0, 20.0, 250.0, 20.0, 100.0, 30.0, 30.0, 0.0, 190.0, 70.0, 50.0, 70.0, 20.0, 10.0, 160.0, 70.0, 80.0, 0.0, 0.0, 20.0, 20.0, 30.0, 60.0, 50.0, 0.0, 40.0, 60.0, 0.0, 170.0, 40.0, 10.0, 20.0, 30.0, 50.0, 170.0, 170.0, 20.0, 10.0, 80.0, 40.0, 50.0, 40.0, 0.0, 50.0, 90.0, 350.0, 40.0, -10.0, 50.0, -40.0, 40.0, 30.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 20.0, 20.0, 0.0, 400.0, 190.0, 40.0, 20.0, 0.0, 70.0, 50.0, 30.0, 20.0, 70.0, 0.0, 0.0, 30.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, 60.0, 10.0, 10.0, 0.0, 30.0, 40.0, 40.0, 10.0, 40.0, 20.0, 180.0, 120.0, 20.0, 10.0, 30.0, 100.0, 70.0, 0.0, 30.0, 50.0, 160.0, 40.0, 170.0, 80.0, 20.0, 10.0, 100.0, 40.0, 10.0, 30.0, 260.0, 30.0, 10.0, 230.0, 90.0, 10.0, 0.0, 80.0, 0.0, 30.0, 40.0, 20.0, 40.0, 0.0, 20.0, 10.0, 100.0, 50.0, 0.0, 380.0, 50.0, 40.0, 20.0, 490.0, 60.0, -30.0, 750.0, 20.0, 40.0, 90.0, 0.0, 10.0, 70.0, 30.0, 10.0, 60.0, 260.0, 10.0, 70.0, 10.0, 40.0, 60.0, 70.0, 160.0, 60.0, -5.0, 40.0, 290.0, 20.0, 10.0, 0.0, 70.0, 0.0, 10.0, 0.0, 50.0, 30.0, 30.0, 30.0, 0.0, 50.0, 0.0, 30.0, 30.0, 0.0, 20.0, 50.0, 40.0, 120.0, 50.0, 80.0, 60.0, 20.0, 240.0, 0.0, 0.0, 30.0, 80.0, 30.0, 30.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 15.0, 30.0, 40.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 70.0, 30.0, 30.0, 10.0, -50.0, 250.0, 70.0, 0.0, 30.0, 60.0, 0.0, 30.0, 70.0, 150.0, 150.0, 70.0, 10.0, 30.0, 30.0, 80.0, 60.0, 0.0, 80.0, 380.0, 20.0, 40.0, 60.0, 0.0, 40.0, 0.0, 10.0, 40.0, 30.0, 30.0, 10.0, 0.0, 40.0, 30.0, 30.0, 0.0, 40.0, 100.0, 180.0, 20.0, 160.0, 55.0, 60.0, 390.0, 20.0, 100.0, 0.0, 10.0, 20.0, 20.0, 20.0, 0.0, 30.0, 20.0, 20.0, 170.0, 20.0, 40.0, 100.0, 20.0, 160.0, 90.0, 40.0, 30.0, 0.0, 40.0, 10.0, 10.0, 40.0, 20.0, 60.0, 30.0, 40.0, 40.0, 30.0, 0.0, 0.0, 30.0, 250.0, 30.0, 50.0, 0.0, 10.0, 0.0, 10.0, 10.0, 80.0, 0.0, 30.0, 10.0, 10.0, 0.0, 0.0, 30.0, 20.0, 170.0, 90.0, 20.0, 30.0, 100.0, 40.0, 40.0, 0.0, 0.0, 20.0, 0.0, 500.0, 70.0, 30.0, 70.0, 80.0, 150.0, 30.0, 40.0, 60.0, 20.0, 20.0, 270.0, 40.0, 0.0, 100.0, 50.0, -50.0, 690.0, 120.0, 0.0, 70.0, 230.0, 150.0, 90.0, 60.0, 170.0, 510.0, 70.0, 370.0, 30.0, 30.0, 20.0, 50.0, -30.0, 200.0, 200.0, 50.0, 110.0, 380.0, 10.0, 140.0, -50.0, 270.0, 110.0, 80.0, 60.0, 30.0, 40.0, 50.0, 290.0, 30.0, 80.0, 10.0, 30.0, 80.0, 40.0, 20.0, 60.0, 0.0, 20.0, 10.0, 10.0, 0.0, 40.0, 50.0, 20.0, 0.0, 20.0, 10.0, 40.0, 20.0, 10.0, 30.0, 30.0, 50.0, 160.0, -970.0, 160.0, 50.0, 460.0, 370.0, 20.0, 90.0, 30.0, 50.0, 30.0, 10.0, 0.0, -10.0, 30.0, 0.0, 270.0, 10.0, 10.0, 20.0, 0.0, 20.0, 0.0, 40.0, 20.0, 20.0, 0.0, 20.0, 20.0, 130.0, 40.0, 70.0, 310.0, 10.0, 10.0, 0.0, 60.0, 450.0, 10.0, -10.0, -50.0, -10.0, 120.0, 40.0, 30.0, 20.0, 30.0, 20.0, 30.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 30.0, 20.0, 0.0, 10.0, 120.0, 40.0, -180.0, 10.0, 40.0, 0.0, 290.0, 0.0, -30.0, 50.0, 20.0, 30.0, 30.0, 50.0, 40.0, 360.0, 20.0, 120.0, 0.0, 0.0, 0.0, 40.0, 60.0, 20.0, 20.0, 10.0, 0.0, 10.0, 40.0, 20.0, 60.0, 30.0, 0.0, 10.0, 40.0, 10.0, 10.0, 10.0, 10.0, 30.0, 30.0, 10.0, 30.0, 20.0, 30.0, 0.0, 30.0, 400.0, 410.0, 0.0, 60.0, 50.0, 90.0, 0.0, 110.0, 10.0, 90.0, 50.0, 40.0, 40.0, 450.0, 10.0, 20.0, 20.0, 30.0, 80.0, -30.0, 40.0, 170.0, 270.0, 250.0, 10.0, 20.0, 10.0, -5.0, 40.0, 20.0, 0.0, 20.0, 0.0, 30.0, 0.0, 260.0, 10.0, -20.0, 0.0, 30.0, 0.0, 210.0, 180.0, 80.0, 40.0, 40.0, 20.0, 30.0, 10.0, 0.0, 10.0, 60.0, 30.0, 80.0, 40.0, 90.0, 10.0, 50.0, 160.0, 20.0, 10.0, 280.0, 70.0, -10.0, 50.0, 20.0, 20.0, 0.0, 100.0, 60.0, 260.0, 5.0, 5.0, 70.0, 60.0, 10.0, 90.0, 50.0, 180.0, 0.0, 60.0, 540.0, 20.0, 50.0, 0.0, 280.0, 30.0, 30.0, 310.0, -40.0, -50.0, 40.0, 30.0, 20.0, 30.0, 130.0, 10.0, 40.0, 380.0, 90.0, 30.0, 20.0, 0.0, 50.0, 10.0, 10.0, 20.0, 0.0, 20.0, 40.0, 20.0, 30.0, 30.0, 40.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 80.0, 50.0, 40.0, 40.0, 0.0, 20.0, 0.0, 40.0, 10.0, 120.0, 20.0, 60.0, 10.0, 10.0, 10.0, 0.0, 50.0, 140.0, 0.0, 180.0, 80.0, 40.0, 0.0, 30.0, 30.0, 10.0, 20.0, 20.0, 20.0, 40.0, 40.0, 20.0, 40.0, 30.0, 30.0, 40.0, 0.0, 160.0, 20.0, 50.0, 10.0, 80.0, 20.0, 20.0, 270.0, 70.0, 0.0, 0.0, 10.0, 30.0, 30.0, 30.0, 70.0, 20.0, 40.0, 190.0, 930.0, 90.0, 190.0, 70.0, 30.0, -10.0, 60.0, 180.0, 10.0, 20.0, 30.0, 30.0, 10.0, 160.0, 10.0, 30.0, 110.0, 150.0, 110.0, 40.0, 10.0, 0.0, 320.0, 25.0, 60.0, 20.0, 40.0, -30.0, 350.0, 20.0, 30.0, 0.0, 20.0, 0.0, 20.0, -50.0, 40.0, 40.0, 150.0, 20.0, 60.0, 10.0, 20.0, 20.0, 210.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 50.0, 20.0, 20.0, 30.0, 20.0, 10.0, 180.0, 20.0, 0.0, 40.0, 20.0, 0.0, 50.0, 40.0, 60.0, 0.0, 60.0, 160.0, 20.0, 80.0, 30.0, 30.0, 0.0, 20.0, 40.0, 10.0, 60.0, 40.0, 20.0, 100.0, 40.0, 60.0, 190.0, 645.0, 30.0, 0.0, 10.0, 60.0, -40.0, 60.0, 160.0, 150.0, 20.0, 30.0, 30.0, 150.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, -5.0, 0.0, 50.0, 260.0, 110.0, 5.0, 50.0, 150.0, 50.0, 80.0, 220.0, 30.0, 400.0, 10.0, 30.0, 0.0, 70.0, 240.0, 180.0, 120.0, 60.0, 170.0, 360.0, 90.0, 350.0, 30.0, -10.0, 70.0, 350.0, 0.0, 60.0, 0.0, 30.0, 360.0, 20.0, 10.0, 10.0, 100.0, 40.0, 20.0, 20.0, 80.0, 10.0, 0.0, 0.0, 10.0, 210.0, -10.0, 20.0, 30.0, 30.0, 60.0, 60.0, 150.0, 10.0, 0.0, 170.0, 90.0, 80.0, 10.0, 30.0, 460.0, 60.0, 440.0, 140.0, 20.0, 40.0, 15.0, 40.0, 60.0, 50.0, 30.0, 30.0, 580.0, 30.0, 20.0, 50.0, 0.0, 80.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4514112897331233, "mean_inference_ms": 1.6504819642787714, "mean_action_processing_ms": 0.4285822581246697, "mean_env_wait_ms": 1.3258850503048947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056534767150878906, "StateBufferConnector_ms": 0.009231805801391602, "ViewRequirementAgentConnector_ms": 0.3770263195037842}, "num_episodes": 22, "episode_return_max": 1750.0, "episode_return_min": 0.0, "episode_return_mean": 579.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.155744849333814, "num_env_steps_trained_throughput_per_sec": 36.155744849333814, "timesteps_total": 376000, "num_env_steps_sampled_lifetime": 376000, "num_agent_steps_sampled_lifetime": 3760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3760000, "timers": {"training_iteration_time_ms": 110336.261, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110336.215, "sample_time_ms": 2401.572, "learn_time_ms": 107915.116, "learn_throughput": 37.066, "synch_weights_time_ms": 10.814}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 3760000, "num_agent_steps_trained": 3760000}, "done": false, "training_iteration": 94, "trial_id": "57140_00000", "date": "2024-06-27_02-12-40", "timestamp": 1719468760, "time_this_iter_s": 110.64689803123474, "time_total_s": 10686.113594055176, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23a63a0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10686.113594055176, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 16.28397435897436, "ram_util_percent": 79.1051282051282}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4307865175068444, "cur_kl_coeff": 2.0526276111602786, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.003154944003057786, "vf_loss": 4.724420244422076, "vf_explained_var": 0.0006375091715742605, "kl": Infinity, "entropy": 0.35220698097897285, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 887355.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000}, "env_runners": {"episode_reward_max": 1750.0, "episode_reward_min": 0.0, "episode_reward_mean": 585.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -970.0}, "policy_reward_max": {"policy_0": 930.0}, "policy_reward_mean": {"policy_0": 58.53}, "custom_metrics": {}, "hist_stats": {"episode_reward": [60.0, 820.0, 210.0, 160.0, 510.0, 720.0, 810.0, 240.0, 1200.0, 990.0, 800.0, 435.0, 250.0, 680.0, 210.0, 155.0, 500.0, 620.0, 680.0, 220.0, 1125.0, 310.0, 540.0, 280.0, 390.0, 350.0, 340.0, 1050.0, 1240.0, 1750.0, 1020.0, 1020.0, 370.0, 200.0, 0.0, 620.0, 390.0, 630.0, 640.0, 160.0, 90.0, 840.0, 290.0, 220.0, 180.0, 1160.0, 830.0, 775.0, 320.0, 640.0, 530.0, 560.0, 790.0, 1320.0, 590.0, 250.0, 220.0, 210.0, 350.0, 520.0, 230.0, 460.0, 480.0, 1620.0, 540.0, 845.0, 400.0, 570.0, 130.0, 340.0, 530.0, 390.0, 1265.0, 330.0, 750.0, 1300.0, 1470.0, 650.0, 370.0, 660.0, 1305.0, 960.0, 390.0, 340.0, 1380.0, 330.0, 120.0, 435.0, 235.0, 340.0, 280.0, 420.0, 1100.0, 300.0, 820.0, 910.0, 740.0, 450.0, 230.0, 735.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 0.0, 0.0, 0.0, 0.0, 0.0, 30.0, 0.0, 0.0, 20.0, 20.0, 0.0, 400.0, 190.0, 40.0, 20.0, 0.0, 70.0, 50.0, 30.0, 20.0, 70.0, 0.0, 0.0, 30.0, 20.0, 30.0, 10.0, 20.0, 10.0, 0.0, 20.0, 0.0, 30.0, 0.0, 60.0, 10.0, 10.0, 0.0, 30.0, 40.0, 40.0, 10.0, 40.0, 20.0, 180.0, 120.0, 20.0, 10.0, 30.0, 100.0, 70.0, 0.0, 30.0, 50.0, 160.0, 40.0, 170.0, 80.0, 20.0, 10.0, 100.0, 40.0, 10.0, 30.0, 260.0, 30.0, 10.0, 230.0, 90.0, 10.0, 0.0, 80.0, 0.0, 30.0, 40.0, 20.0, 40.0, 0.0, 20.0, 10.0, 100.0, 50.0, 0.0, 380.0, 50.0, 40.0, 20.0, 490.0, 60.0, -30.0, 750.0, 20.0, 40.0, 90.0, 0.0, 10.0, 70.0, 30.0, 10.0, 60.0, 260.0, 10.0, 70.0, 10.0, 40.0, 60.0, 70.0, 160.0, 60.0, -5.0, 40.0, 290.0, 20.0, 10.0, 0.0, 70.0, 0.0, 10.0, 0.0, 50.0, 30.0, 30.0, 30.0, 0.0, 50.0, 0.0, 30.0, 30.0, 0.0, 20.0, 50.0, 40.0, 120.0, 50.0, 80.0, 60.0, 20.0, 240.0, 0.0, 0.0, 30.0, 80.0, 30.0, 30.0, 0.0, 30.0, 0.0, 0.0, 10.0, 20.0, 15.0, 30.0, 40.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 70.0, 30.0, 30.0, 10.0, -50.0, 250.0, 70.0, 0.0, 30.0, 60.0, 0.0, 30.0, 70.0, 150.0, 150.0, 70.0, 10.0, 30.0, 30.0, 80.0, 60.0, 0.0, 80.0, 380.0, 20.0, 40.0, 60.0, 0.0, 40.0, 0.0, 10.0, 40.0, 30.0, 30.0, 10.0, 0.0, 40.0, 30.0, 30.0, 0.0, 40.0, 100.0, 180.0, 20.0, 160.0, 55.0, 60.0, 390.0, 20.0, 100.0, 0.0, 10.0, 20.0, 20.0, 20.0, 0.0, 30.0, 20.0, 20.0, 170.0, 20.0, 40.0, 100.0, 20.0, 160.0, 90.0, 40.0, 30.0, 0.0, 40.0, 10.0, 10.0, 40.0, 20.0, 60.0, 30.0, 40.0, 40.0, 30.0, 0.0, 0.0, 30.0, 250.0, 30.0, 50.0, 0.0, 10.0, 0.0, 10.0, 10.0, 80.0, 0.0, 30.0, 10.0, 10.0, 0.0, 0.0, 30.0, 20.0, 170.0, 90.0, 20.0, 30.0, 100.0, 40.0, 40.0, 0.0, 0.0, 20.0, 0.0, 500.0, 70.0, 30.0, 70.0, 80.0, 150.0, 30.0, 40.0, 60.0, 20.0, 20.0, 270.0, 40.0, 0.0, 100.0, 50.0, -50.0, 690.0, 120.0, 0.0, 70.0, 230.0, 150.0, 90.0, 60.0, 170.0, 510.0, 70.0, 370.0, 30.0, 30.0, 20.0, 50.0, -30.0, 200.0, 200.0, 50.0, 110.0, 380.0, 10.0, 140.0, -50.0, 270.0, 110.0, 80.0, 60.0, 30.0, 40.0, 50.0, 290.0, 30.0, 80.0, 10.0, 30.0, 80.0, 40.0, 20.0, 60.0, 0.0, 20.0, 10.0, 10.0, 0.0, 40.0, 50.0, 20.0, 0.0, 20.0, 10.0, 40.0, 20.0, 10.0, 30.0, 30.0, 50.0, 160.0, -970.0, 160.0, 50.0, 460.0, 370.0, 20.0, 90.0, 30.0, 50.0, 30.0, 10.0, 0.0, -10.0, 30.0, 0.0, 270.0, 10.0, 10.0, 20.0, 0.0, 20.0, 0.0, 40.0, 20.0, 20.0, 0.0, 20.0, 20.0, 130.0, 40.0, 70.0, 310.0, 10.0, 10.0, 0.0, 60.0, 450.0, 10.0, -10.0, -50.0, -10.0, 120.0, 40.0, 30.0, 20.0, 30.0, 20.0, 30.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 30.0, 20.0, 0.0, 10.0, 120.0, 40.0, -180.0, 10.0, 40.0, 0.0, 290.0, 0.0, -30.0, 50.0, 20.0, 30.0, 30.0, 50.0, 40.0, 360.0, 20.0, 120.0, 0.0, 0.0, 0.0, 40.0, 60.0, 20.0, 20.0, 10.0, 0.0, 10.0, 40.0, 20.0, 60.0, 30.0, 0.0, 10.0, 40.0, 10.0, 10.0, 10.0, 10.0, 30.0, 30.0, 10.0, 30.0, 20.0, 30.0, 0.0, 30.0, 400.0, 410.0, 0.0, 60.0, 50.0, 90.0, 0.0, 110.0, 10.0, 90.0, 50.0, 40.0, 40.0, 450.0, 10.0, 20.0, 20.0, 30.0, 80.0, -30.0, 40.0, 170.0, 270.0, 250.0, 10.0, 20.0, 10.0, -5.0, 40.0, 20.0, 0.0, 20.0, 0.0, 30.0, 0.0, 260.0, 10.0, -20.0, 0.0, 30.0, 0.0, 210.0, 180.0, 80.0, 40.0, 40.0, 20.0, 30.0, 10.0, 0.0, 10.0, 60.0, 30.0, 80.0, 40.0, 90.0, 10.0, 50.0, 160.0, 20.0, 10.0, 280.0, 70.0, -10.0, 50.0, 20.0, 20.0, 0.0, 100.0, 60.0, 260.0, 5.0, 5.0, 70.0, 60.0, 10.0, 90.0, 50.0, 180.0, 0.0, 60.0, 540.0, 20.0, 50.0, 0.0, 280.0, 30.0, 30.0, 310.0, -40.0, -50.0, 40.0, 30.0, 20.0, 30.0, 130.0, 10.0, 40.0, 380.0, 90.0, 30.0, 20.0, 0.0, 50.0, 10.0, 10.0, 20.0, 0.0, 20.0, 40.0, 20.0, 30.0, 30.0, 40.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 80.0, 50.0, 40.0, 40.0, 0.0, 20.0, 0.0, 40.0, 10.0, 120.0, 20.0, 60.0, 10.0, 10.0, 10.0, 0.0, 50.0, 140.0, 0.0, 180.0, 80.0, 40.0, 0.0, 30.0, 30.0, 10.0, 20.0, 20.0, 20.0, 40.0, 40.0, 20.0, 40.0, 30.0, 30.0, 40.0, 0.0, 160.0, 20.0, 50.0, 10.0, 80.0, 20.0, 20.0, 270.0, 70.0, 0.0, 0.0, 10.0, 30.0, 30.0, 30.0, 70.0, 20.0, 40.0, 190.0, 930.0, 90.0, 190.0, 70.0, 30.0, -10.0, 60.0, 180.0, 10.0, 20.0, 30.0, 30.0, 10.0, 160.0, 10.0, 30.0, 110.0, 150.0, 110.0, 40.0, 10.0, 0.0, 320.0, 25.0, 60.0, 20.0, 40.0, -30.0, 350.0, 20.0, 30.0, 0.0, 20.0, 0.0, 20.0, -50.0, 40.0, 40.0, 150.0, 20.0, 60.0, 10.0, 20.0, 20.0, 210.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 50.0, 20.0, 20.0, 30.0, 20.0, 10.0, 180.0, 20.0, 0.0, 40.0, 20.0, 0.0, 50.0, 40.0, 60.0, 0.0, 60.0, 160.0, 20.0, 80.0, 30.0, 30.0, 0.0, 20.0, 40.0, 10.0, 60.0, 40.0, 20.0, 100.0, 40.0, 60.0, 190.0, 645.0, 30.0, 0.0, 10.0, 60.0, -40.0, 60.0, 160.0, 150.0, 20.0, 30.0, 30.0, 150.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, -5.0, 0.0, 50.0, 260.0, 110.0, 5.0, 50.0, 150.0, 50.0, 80.0, 220.0, 30.0, 400.0, 10.0, 30.0, 0.0, 70.0, 240.0, 180.0, 120.0, 60.0, 170.0, 360.0, 90.0, 350.0, 30.0, -10.0, 70.0, 350.0, 0.0, 60.0, 0.0, 30.0, 360.0, 20.0, 10.0, 10.0, 100.0, 40.0, 20.0, 20.0, 80.0, 10.0, 0.0, 0.0, 10.0, 210.0, -10.0, 20.0, 30.0, 30.0, 60.0, 60.0, 150.0, 10.0, 0.0, 170.0, 90.0, 80.0, 10.0, 30.0, 460.0, 60.0, 440.0, 140.0, 20.0, 40.0, 15.0, 40.0, 60.0, 50.0, 30.0, 30.0, 580.0, 30.0, 20.0, 50.0, 0.0, 80.0, 90.0, 0.0, -80.0, 10.0, 20.0, 220.0, 20.0, 10.0, 10.0, 160.0, 20.0, 0.0, 30.0, 10.0, 10.0, 20.0, 20.0, 70.0, 110.0, 40.0, 30.0, 10.0, 50.0, 370.0, 0.0, 670.0, 50.0, 270.0, -50.0, -30.0, 40.0, 70.0, 10.0, 100.0, 70.0, 20.0, 0.0, 20.0, 30.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 40.0, 10.0, 40.0, 0.0, 5.0, 30.0, 40.0, 40.0, 0.0, 0.0, 100.0, 20.0, 30.0, 170.0, 10.0, 30.0, 10.0, -25.0, 40.0, 0.0, 30.0, 20.0, 100.0, 20.0, 0.0, 30.0, 0.0, 30.0, 80.0, 60.0, 30.0, 20.0, 40.0, 50.0, 50.0, 30.0, 20.0, 60.0, 10.0, 0.0, 0.0, 40.0, 70.0, 0.0, 50.0, 60.0, 20.0, 30.0, 160.0, 30.0, 0.0, 40.0, 0.0, 30.0, 20.0, 20.0, 30.0, 0.0, 750.0, 10.0, 170.0, 50.0, 10.0, 40.0, 60.0, 60.0, 0.0, 50.0, 30.0, 20.0, 40.0, 40.0, 0.0, 0.0, 190.0, 20.0, 130.0, 260.0, 50.0, 10.0, 170.0, 50.0, 40.0, -100.0, 280.0, 110.0, 10.0, -40.0, 170.0, 230.0, 60.0, 40.0, 40.0, 10.0, 20.0, 10.0, 50.0, 190.0, 0.0, 50.0, 180.0, 0.0, 0.0, 240.0, 10.0, 30.0, 10.0, 40.0, 20.0, 0.0, 40.0, -40.0, 260.0, 80.0, 30.0, 30.0, 50.0, 40.0, 30.0, 20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 70.0, 0.0, -5.0, 20.0, 20.0, 0.0, 40.0, 320.0, 260.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4502336014498765, "mean_inference_ms": 1.6492434464157422, "mean_action_processing_ms": 0.4281216684045481, "mean_env_wait_ms": 1.3249110243787368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05733370780944824, "StateBufferConnector_ms": 0.009314775466918945, "ViewRequirementAgentConnector_ms": 0.3763997554779053}, "num_episodes": 18, "episode_return_max": 1750.0, "episode_return_min": 0.0, "episode_return_mean": 585.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.245651234074, "num_env_steps_trained_throughput_per_sec": 36.245651234074, "timesteps_total": 380000, "num_env_steps_sampled_lifetime": 380000, "num_agent_steps_sampled_lifetime": 3800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3800000, "timers": {"training_iteration_time_ms": 110330.407, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110330.361, "sample_time_ms": 2386.591, "learn_time_ms": 107924.314, "learn_throughput": 37.063, "synch_weights_time_ms": 10.956}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 3800000, "num_agent_steps_trained": 3800000}, "done": false, "training_iteration": 95, "trial_id": "57140_00000", "date": "2024-06-27_02-14-31", "timestamp": 1719468871, "time_this_iter_s": 110.36579990386963, "time_total_s": 10796.479393959045, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18cb8b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10796.479393959045, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 15.60833333333333, "ram_util_percent": 78.89615384615384}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5670266973959626, "cur_kl_coeff": 3.0789414167404177, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.00292854358541806, "vf_loss": 4.4435780331984365, "vf_explained_var": 0.001334089973864083, "kl": Infinity, "entropy": 0.3687179788883629, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 896745.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000}, "env_runners": {"episode_reward_max": 1870.0, "episode_reward_min": 0.0, "episode_reward_mean": 622.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -970.0}, "policy_reward_max": {"policy_0": 930.0}, "policy_reward_mean": {"policy_0": 62.27}, "custom_metrics": {}, "hist_stats": {"episode_reward": [280.0, 390.0, 350.0, 340.0, 1050.0, 1240.0, 1750.0, 1020.0, 1020.0, 370.0, 200.0, 0.0, 620.0, 390.0, 630.0, 640.0, 160.0, 90.0, 840.0, 290.0, 220.0, 180.0, 1160.0, 830.0, 775.0, 320.0, 640.0, 530.0, 560.0, 790.0, 1320.0, 590.0, 250.0, 220.0, 210.0, 350.0, 520.0, 230.0, 460.0, 480.0, 1620.0, 540.0, 845.0, 400.0, 570.0, 130.0, 340.0, 530.0, 390.0, 1265.0, 330.0, 750.0, 1300.0, 1470.0, 650.0, 370.0, 660.0, 1305.0, 960.0, 390.0, 340.0, 1380.0, 330.0, 120.0, 435.0, 235.0, 340.0, 280.0, 420.0, 1100.0, 300.0, 820.0, 910.0, 740.0, 450.0, 230.0, 735.0, 310.0, 380.0, 530.0, 330.0, 660.0, 1200.0, 1270.0, 580.0, 875.0, 950.0, 490.0, 1295.0, 220.0, 390.0, 1870.0, 190.0, 600.0, 365.0, 750.0, 800.0, 690.0, 560.0, 680.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 10.0, 40.0, 20.0, 60.0, 30.0, 40.0, 40.0, 30.0, 0.0, 0.0, 30.0, 250.0, 30.0, 50.0, 0.0, 10.0, 0.0, 10.0, 10.0, 80.0, 0.0, 30.0, 10.0, 10.0, 0.0, 0.0, 30.0, 20.0, 170.0, 90.0, 20.0, 30.0, 100.0, 40.0, 40.0, 0.0, 0.0, 20.0, 0.0, 500.0, 70.0, 30.0, 70.0, 80.0, 150.0, 30.0, 40.0, 60.0, 20.0, 20.0, 270.0, 40.0, 0.0, 100.0, 50.0, -50.0, 690.0, 120.0, 0.0, 70.0, 230.0, 150.0, 90.0, 60.0, 170.0, 510.0, 70.0, 370.0, 30.0, 30.0, 20.0, 50.0, -30.0, 200.0, 200.0, 50.0, 110.0, 380.0, 10.0, 140.0, -50.0, 270.0, 110.0, 80.0, 60.0, 30.0, 40.0, 50.0, 290.0, 30.0, 80.0, 10.0, 30.0, 80.0, 40.0, 20.0, 60.0, 0.0, 20.0, 10.0, 10.0, 0.0, 40.0, 50.0, 20.0, 0.0, 20.0, 10.0, 40.0, 20.0, 10.0, 30.0, 30.0, 50.0, 160.0, -970.0, 160.0, 50.0, 460.0, 370.0, 20.0, 90.0, 30.0, 50.0, 30.0, 10.0, 0.0, -10.0, 30.0, 0.0, 270.0, 10.0, 10.0, 20.0, 0.0, 20.0, 0.0, 40.0, 20.0, 20.0, 0.0, 20.0, 20.0, 130.0, 40.0, 70.0, 310.0, 10.0, 10.0, 0.0, 60.0, 450.0, 10.0, -10.0, -50.0, -10.0, 120.0, 40.0, 30.0, 20.0, 30.0, 20.0, 30.0, 0.0, 10.0, 20.0, 20.0, 10.0, 0.0, 30.0, 20.0, 0.0, 10.0, 120.0, 40.0, -180.0, 10.0, 40.0, 0.0, 290.0, 0.0, -30.0, 50.0, 20.0, 30.0, 30.0, 50.0, 40.0, 360.0, 20.0, 120.0, 0.0, 0.0, 0.0, 40.0, 60.0, 20.0, 20.0, 10.0, 0.0, 10.0, 40.0, 20.0, 60.0, 30.0, 0.0, 10.0, 40.0, 10.0, 10.0, 10.0, 10.0, 30.0, 30.0, 10.0, 30.0, 20.0, 30.0, 0.0, 30.0, 400.0, 410.0, 0.0, 60.0, 50.0, 90.0, 0.0, 110.0, 10.0, 90.0, 50.0, 40.0, 40.0, 450.0, 10.0, 20.0, 20.0, 30.0, 80.0, -30.0, 40.0, 170.0, 270.0, 250.0, 10.0, 20.0, 10.0, -5.0, 40.0, 20.0, 0.0, 20.0, 0.0, 30.0, 0.0, 260.0, 10.0, -20.0, 0.0, 30.0, 0.0, 210.0, 180.0, 80.0, 40.0, 40.0, 20.0, 30.0, 10.0, 0.0, 10.0, 60.0, 30.0, 80.0, 40.0, 90.0, 10.0, 50.0, 160.0, 20.0, 10.0, 280.0, 70.0, -10.0, 50.0, 20.0, 20.0, 0.0, 100.0, 60.0, 260.0, 5.0, 5.0, 70.0, 60.0, 10.0, 90.0, 50.0, 180.0, 0.0, 60.0, 540.0, 20.0, 50.0, 0.0, 280.0, 30.0, 30.0, 310.0, -40.0, -50.0, 40.0, 30.0, 20.0, 30.0, 130.0, 10.0, 40.0, 380.0, 90.0, 30.0, 20.0, 0.0, 50.0, 10.0, 10.0, 20.0, 0.0, 20.0, 40.0, 20.0, 30.0, 30.0, 40.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 80.0, 50.0, 40.0, 40.0, 0.0, 20.0, 0.0, 40.0, 10.0, 120.0, 20.0, 60.0, 10.0, 10.0, 10.0, 0.0, 50.0, 140.0, 0.0, 180.0, 80.0, 40.0, 0.0, 30.0, 30.0, 10.0, 20.0, 20.0, 20.0, 40.0, 40.0, 20.0, 40.0, 30.0, 30.0, 40.0, 0.0, 160.0, 20.0, 50.0, 10.0, 80.0, 20.0, 20.0, 270.0, 70.0, 0.0, 0.0, 10.0, 30.0, 30.0, 30.0, 70.0, 20.0, 40.0, 190.0, 930.0, 90.0, 190.0, 70.0, 30.0, -10.0, 60.0, 180.0, 10.0, 20.0, 30.0, 30.0, 10.0, 160.0, 10.0, 30.0, 110.0, 150.0, 110.0, 40.0, 10.0, 0.0, 320.0, 25.0, 60.0, 20.0, 40.0, -30.0, 350.0, 20.0, 30.0, 0.0, 20.0, 0.0, 20.0, -50.0, 40.0, 40.0, 150.0, 20.0, 60.0, 10.0, 20.0, 20.0, 210.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 50.0, 20.0, 20.0, 30.0, 20.0, 10.0, 180.0, 20.0, 0.0, 40.0, 20.0, 0.0, 50.0, 40.0, 60.0, 0.0, 60.0, 160.0, 20.0, 80.0, 30.0, 30.0, 0.0, 20.0, 40.0, 10.0, 60.0, 40.0, 20.0, 100.0, 40.0, 60.0, 190.0, 645.0, 30.0, 0.0, 10.0, 60.0, -40.0, 60.0, 160.0, 150.0, 20.0, 30.0, 30.0, 150.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, -5.0, 0.0, 50.0, 260.0, 110.0, 5.0, 50.0, 150.0, 50.0, 80.0, 220.0, 30.0, 400.0, 10.0, 30.0, 0.0, 70.0, 240.0, 180.0, 120.0, 60.0, 170.0, 360.0, 90.0, 350.0, 30.0, -10.0, 70.0, 350.0, 0.0, 60.0, 0.0, 30.0, 360.0, 20.0, 10.0, 10.0, 100.0, 40.0, 20.0, 20.0, 80.0, 10.0, 0.0, 0.0, 10.0, 210.0, -10.0, 20.0, 30.0, 30.0, 60.0, 60.0, 150.0, 10.0, 0.0, 170.0, 90.0, 80.0, 10.0, 30.0, 460.0, 60.0, 440.0, 140.0, 20.0, 40.0, 15.0, 40.0, 60.0, 50.0, 30.0, 30.0, 580.0, 30.0, 20.0, 50.0, 0.0, 80.0, 90.0, 0.0, -80.0, 10.0, 20.0, 220.0, 20.0, 10.0, 10.0, 160.0, 20.0, 0.0, 30.0, 10.0, 10.0, 20.0, 20.0, 70.0, 110.0, 40.0, 30.0, 10.0, 50.0, 370.0, 0.0, 670.0, 50.0, 270.0, -50.0, -30.0, 40.0, 70.0, 10.0, 100.0, 70.0, 20.0, 0.0, 20.0, 30.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 40.0, 10.0, 40.0, 0.0, 5.0, 30.0, 40.0, 40.0, 0.0, 0.0, 100.0, 20.0, 30.0, 170.0, 10.0, 30.0, 10.0, -25.0, 40.0, 0.0, 30.0, 20.0, 100.0, 20.0, 0.0, 30.0, 0.0, 30.0, 80.0, 60.0, 30.0, 20.0, 40.0, 50.0, 50.0, 30.0, 20.0, 60.0, 10.0, 0.0, 0.0, 40.0, 70.0, 0.0, 50.0, 60.0, 20.0, 30.0, 160.0, 30.0, 0.0, 40.0, 0.0, 30.0, 20.0, 20.0, 30.0, 0.0, 750.0, 10.0, 170.0, 50.0, 10.0, 40.0, 60.0, 60.0, 0.0, 50.0, 30.0, 20.0, 40.0, 40.0, 0.0, 0.0, 190.0, 20.0, 130.0, 260.0, 50.0, 10.0, 170.0, 50.0, 40.0, -100.0, 280.0, 110.0, 10.0, -40.0, 170.0, 230.0, 60.0, 40.0, 40.0, 10.0, 20.0, 10.0, 50.0, 190.0, 0.0, 50.0, 180.0, 0.0, 0.0, 240.0, 10.0, 30.0, 10.0, 40.0, 20.0, 0.0, 40.0, -40.0, 260.0, 80.0, 30.0, 30.0, 50.0, 40.0, 30.0, 20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 70.0, 0.0, -5.0, 20.0, 20.0, 0.0, 40.0, 320.0, 260.0, 40.0, 0.0, 40.0, 50.0, 40.0, 30.0, 40.0, 0.0, 40.0, 30.0, 30.0, 10.0, 30.0, 40.0, 10.0, 20.0, 0.0, 0.0, 170.0, 70.0, 0.0, 310.0, 30.0, 0.0, 60.0, 20.0, 30.0, 20.0, 40.0, 20.0, 90.0, 10.0, 10.0, 10.0, 60.0, 30.0, 80.0, 50.0, 40.0, -50.0, 60.0, 50.0, 170.0, 40.0, 50.0, 20.0, 20.0, 20.0, 120.0, 110.0, 110.0, 0.0, 510.0, 40.0, 60.0, 170.0, 60.0, 20.0, 50.0, 180.0, 60.0, 120.0, -20.0, 460.0, 240.0, 40.0, 200.0, 10.0, 40.0, 120.0, 40.0, -10.0, 30.0, 20.0, 0.0, 270.0, 20.0, 0.0, 30.0, 180.0, 150.0, 0.0, 30.0, 30.0, 20.0, 170.0, 180.0, 0.0, 50.0, 245.0, -50.0, 360.0, 20.0, -30.0, 30.0, 10.0, 450.0, 110.0, 30.0, 20.0, 60.0, 0.0, 260.0, 0.0, 40.0, 10.0, 50.0, 40.0, 20.0, 10.0, 120.0, -185.0, 120.0, 580.0, 110.0, 180.0, 60.0, 100.0, 190.0, 20.0, 30.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 20.0, 0.0, 60.0, 10.0, 20.0, 0.0, 30.0, 70.0, 0.0, 0.0, 60.0, 40.0, 160.0, 50.0, 560.0, -10.0, 70.0, 250.0, 100.0, 170.0, 430.0, 40.0, 210.0, 20.0, 20.0, 0.0, 40.0, 30.0, 20.0, 0.0, 40.0, 0.0, 20.0, 160.0, 70.0, 80.0, 30.0, 40.0, 30.0, 80.0, 30.0, 60.0, 20.0, 80.0, 5.0, 40.0, 10.0, 30.0, 60.0, -40.0, 140.0, 10.0, 30.0, -30.0, 20.0, 20.0, 470.0, 50.0, 20.0, 10.0, 130.0, 20.0, 40.0, 0.0, 210.0, 30.0, 20.0, 40.0, 10.0, 120.0, 190.0, 20.0, 160.0, 80.0, 200.0, 50.0, 30.0, 0.0, 70.0, 10.0, 180.0, 20.0, 50.0, 0.0, 0.0, 40.0, 20.0, 170.0, 360.0, 0.0, 20.0, 0.0, -50.0, 100.0, 20.0, 40.0, 40.0, 60.0, 10.0, 40.0, 0.0, 360.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4487276480477544, "mean_inference_ms": 1.6477532901385896, "mean_action_processing_ms": 0.42757491852991064, "mean_env_wait_ms": 1.3235875635227592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056227684020996094, "StateBufferConnector_ms": 0.009371280670166016, "ViewRequirementAgentConnector_ms": 0.37998151779174805}, "num_episodes": 23, "episode_return_max": 1870.0, "episode_return_min": 0.0, "episode_return_mean": 622.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.57625414429982, "num_env_steps_trained_throughput_per_sec": 36.57625414429982, "timesteps_total": 384000, "num_env_steps_sampled_lifetime": 384000, "num_agent_steps_sampled_lifetime": 3840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3840000, "timers": {"training_iteration_time_ms": 110262.16, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110262.113, "sample_time_ms": 2390.349, "learn_time_ms": 107852.142, "learn_throughput": 37.088, "synch_weights_time_ms": 11.008}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 3840000, "num_agent_steps_trained": 3840000}, "done": false, "training_iteration": 96, "trial_id": "57140_00000", "date": "2024-06-27_02-16-20", "timestamp": 1719468980, "time_this_iter_s": 109.37373280525208, "time_total_s": 10905.853126764297, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af43ab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 10905.853126764297, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 15.479354838709678, "ram_util_percent": 79.33032258064516}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9648764860579253, "cur_kl_coeff": 4.618412125110625, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002956982951286954, "vf_loss": 4.623374011747626, "vf_explained_var": 0.0004023549719232594, "kl": Infinity, "entropy": 0.3722784057672158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 906135.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000}, "env_runners": {"episode_reward_max": 1870.0, "episode_reward_min": 100.0, "episode_reward_mean": 642.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -185.0}, "policy_reward_max": {"policy_0": 930.0}, "policy_reward_mean": {"policy_0": 64.215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [840.0, 290.0, 220.0, 180.0, 1160.0, 830.0, 775.0, 320.0, 640.0, 530.0, 560.0, 790.0, 1320.0, 590.0, 250.0, 220.0, 210.0, 350.0, 520.0, 230.0, 460.0, 480.0, 1620.0, 540.0, 845.0, 400.0, 570.0, 130.0, 340.0, 530.0, 390.0, 1265.0, 330.0, 750.0, 1300.0, 1470.0, 650.0, 370.0, 660.0, 1305.0, 960.0, 390.0, 340.0, 1380.0, 330.0, 120.0, 435.0, 235.0, 340.0, 280.0, 420.0, 1100.0, 300.0, 820.0, 910.0, 740.0, 450.0, 230.0, 735.0, 310.0, 380.0, 530.0, 330.0, 660.0, 1200.0, 1270.0, 580.0, 875.0, 950.0, 490.0, 1295.0, 220.0, 390.0, 1870.0, 190.0, 600.0, 365.0, 750.0, 800.0, 690.0, 560.0, 680.0, 470.0, 655.0, 320.0, 1060.0, 270.0, 210.0, 1060.0, 1100.0, 1190.0, 460.0, 600.0, 100.0, 940.0, 360.0, 1300.0, 1460.0, 700.0, 230.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [290.0, 0.0, -30.0, 50.0, 20.0, 30.0, 30.0, 50.0, 40.0, 360.0, 20.0, 120.0, 0.0, 0.0, 0.0, 40.0, 60.0, 20.0, 20.0, 10.0, 0.0, 10.0, 40.0, 20.0, 60.0, 30.0, 0.0, 10.0, 40.0, 10.0, 10.0, 10.0, 10.0, 30.0, 30.0, 10.0, 30.0, 20.0, 30.0, 0.0, 30.0, 400.0, 410.0, 0.0, 60.0, 50.0, 90.0, 0.0, 110.0, 10.0, 90.0, 50.0, 40.0, 40.0, 450.0, 10.0, 20.0, 20.0, 30.0, 80.0, -30.0, 40.0, 170.0, 270.0, 250.0, 10.0, 20.0, 10.0, -5.0, 40.0, 20.0, 0.0, 20.0, 0.0, 30.0, 0.0, 260.0, 10.0, -20.0, 0.0, 30.0, 0.0, 210.0, 180.0, 80.0, 40.0, 40.0, 20.0, 30.0, 10.0, 0.0, 10.0, 60.0, 30.0, 80.0, 40.0, 90.0, 10.0, 50.0, 160.0, 20.0, 10.0, 280.0, 70.0, -10.0, 50.0, 20.0, 20.0, 0.0, 100.0, 60.0, 260.0, 5.0, 5.0, 70.0, 60.0, 10.0, 90.0, 50.0, 180.0, 0.0, 60.0, 540.0, 20.0, 50.0, 0.0, 280.0, 30.0, 30.0, 310.0, -40.0, -50.0, 40.0, 30.0, 20.0, 30.0, 130.0, 10.0, 40.0, 380.0, 90.0, 30.0, 20.0, 0.0, 50.0, 10.0, 10.0, 20.0, 0.0, 20.0, 40.0, 20.0, 30.0, 30.0, 40.0, 20.0, 10.0, 20.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 10.0, 10.0, 10.0, 0.0, 80.0, 50.0, 40.0, 40.0, 0.0, 20.0, 0.0, 40.0, 10.0, 120.0, 20.0, 60.0, 10.0, 10.0, 10.0, 0.0, 50.0, 140.0, 0.0, 180.0, 80.0, 40.0, 0.0, 30.0, 30.0, 10.0, 20.0, 20.0, 20.0, 40.0, 40.0, 20.0, 40.0, 30.0, 30.0, 40.0, 0.0, 160.0, 20.0, 50.0, 10.0, 80.0, 20.0, 20.0, 270.0, 70.0, 0.0, 0.0, 10.0, 30.0, 30.0, 30.0, 70.0, 20.0, 40.0, 190.0, 930.0, 90.0, 190.0, 70.0, 30.0, -10.0, 60.0, 180.0, 10.0, 20.0, 30.0, 30.0, 10.0, 160.0, 10.0, 30.0, 110.0, 150.0, 110.0, 40.0, 10.0, 0.0, 320.0, 25.0, 60.0, 20.0, 40.0, -30.0, 350.0, 20.0, 30.0, 0.0, 20.0, 0.0, 20.0, -50.0, 40.0, 40.0, 150.0, 20.0, 60.0, 10.0, 20.0, 20.0, 210.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 50.0, 20.0, 20.0, 30.0, 20.0, 10.0, 180.0, 20.0, 0.0, 40.0, 20.0, 0.0, 50.0, 40.0, 60.0, 0.0, 60.0, 160.0, 20.0, 80.0, 30.0, 30.0, 0.0, 20.0, 40.0, 10.0, 60.0, 40.0, 20.0, 100.0, 40.0, 60.0, 190.0, 645.0, 30.0, 0.0, 10.0, 60.0, -40.0, 60.0, 160.0, 150.0, 20.0, 30.0, 30.0, 150.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, -5.0, 0.0, 50.0, 260.0, 110.0, 5.0, 50.0, 150.0, 50.0, 80.0, 220.0, 30.0, 400.0, 10.0, 30.0, 0.0, 70.0, 240.0, 180.0, 120.0, 60.0, 170.0, 360.0, 90.0, 350.0, 30.0, -10.0, 70.0, 350.0, 0.0, 60.0, 0.0, 30.0, 360.0, 20.0, 10.0, 10.0, 100.0, 40.0, 20.0, 20.0, 80.0, 10.0, 0.0, 0.0, 10.0, 210.0, -10.0, 20.0, 30.0, 30.0, 60.0, 60.0, 150.0, 10.0, 0.0, 170.0, 90.0, 80.0, 10.0, 30.0, 460.0, 60.0, 440.0, 140.0, 20.0, 40.0, 15.0, 40.0, 60.0, 50.0, 30.0, 30.0, 580.0, 30.0, 20.0, 50.0, 0.0, 80.0, 90.0, 0.0, -80.0, 10.0, 20.0, 220.0, 20.0, 10.0, 10.0, 160.0, 20.0, 0.0, 30.0, 10.0, 10.0, 20.0, 20.0, 70.0, 110.0, 40.0, 30.0, 10.0, 50.0, 370.0, 0.0, 670.0, 50.0, 270.0, -50.0, -30.0, 40.0, 70.0, 10.0, 100.0, 70.0, 20.0, 0.0, 20.0, 30.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 40.0, 10.0, 40.0, 0.0, 5.0, 30.0, 40.0, 40.0, 0.0, 0.0, 100.0, 20.0, 30.0, 170.0, 10.0, 30.0, 10.0, -25.0, 40.0, 0.0, 30.0, 20.0, 100.0, 20.0, 0.0, 30.0, 0.0, 30.0, 80.0, 60.0, 30.0, 20.0, 40.0, 50.0, 50.0, 30.0, 20.0, 60.0, 10.0, 0.0, 0.0, 40.0, 70.0, 0.0, 50.0, 60.0, 20.0, 30.0, 160.0, 30.0, 0.0, 40.0, 0.0, 30.0, 20.0, 20.0, 30.0, 0.0, 750.0, 10.0, 170.0, 50.0, 10.0, 40.0, 60.0, 60.0, 0.0, 50.0, 30.0, 20.0, 40.0, 40.0, 0.0, 0.0, 190.0, 20.0, 130.0, 260.0, 50.0, 10.0, 170.0, 50.0, 40.0, -100.0, 280.0, 110.0, 10.0, -40.0, 170.0, 230.0, 60.0, 40.0, 40.0, 10.0, 20.0, 10.0, 50.0, 190.0, 0.0, 50.0, 180.0, 0.0, 0.0, 240.0, 10.0, 30.0, 10.0, 40.0, 20.0, 0.0, 40.0, -40.0, 260.0, 80.0, 30.0, 30.0, 50.0, 40.0, 30.0, 20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 70.0, 0.0, -5.0, 20.0, 20.0, 0.0, 40.0, 320.0, 260.0, 40.0, 0.0, 40.0, 50.0, 40.0, 30.0, 40.0, 0.0, 40.0, 30.0, 30.0, 10.0, 30.0, 40.0, 10.0, 20.0, 0.0, 0.0, 170.0, 70.0, 0.0, 310.0, 30.0, 0.0, 60.0, 20.0, 30.0, 20.0, 40.0, 20.0, 90.0, 10.0, 10.0, 10.0, 60.0, 30.0, 80.0, 50.0, 40.0, -50.0, 60.0, 50.0, 170.0, 40.0, 50.0, 20.0, 20.0, 20.0, 120.0, 110.0, 110.0, 0.0, 510.0, 40.0, 60.0, 170.0, 60.0, 20.0, 50.0, 180.0, 60.0, 120.0, -20.0, 460.0, 240.0, 40.0, 200.0, 10.0, 40.0, 120.0, 40.0, -10.0, 30.0, 20.0, 0.0, 270.0, 20.0, 0.0, 30.0, 180.0, 150.0, 0.0, 30.0, 30.0, 20.0, 170.0, 180.0, 0.0, 50.0, 245.0, -50.0, 360.0, 20.0, -30.0, 30.0, 10.0, 450.0, 110.0, 30.0, 20.0, 60.0, 0.0, 260.0, 0.0, 40.0, 10.0, 50.0, 40.0, 20.0, 10.0, 120.0, -185.0, 120.0, 580.0, 110.0, 180.0, 60.0, 100.0, 190.0, 20.0, 30.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 20.0, 0.0, 60.0, 10.0, 20.0, 0.0, 30.0, 70.0, 0.0, 0.0, 60.0, 40.0, 160.0, 50.0, 560.0, -10.0, 70.0, 250.0, 100.0, 170.0, 430.0, 40.0, 210.0, 20.0, 20.0, 0.0, 40.0, 30.0, 20.0, 0.0, 40.0, 0.0, 20.0, 160.0, 70.0, 80.0, 30.0, 40.0, 30.0, 80.0, 30.0, 60.0, 20.0, 80.0, 5.0, 40.0, 10.0, 30.0, 60.0, -40.0, 140.0, 10.0, 30.0, -30.0, 20.0, 20.0, 470.0, 50.0, 20.0, 10.0, 130.0, 20.0, 40.0, 0.0, 210.0, 30.0, 20.0, 40.0, 10.0, 120.0, 190.0, 20.0, 160.0, 80.0, 200.0, 50.0, 30.0, 0.0, 70.0, 10.0, 180.0, 20.0, 50.0, 0.0, 0.0, 40.0, 20.0, 170.0, 360.0, 0.0, 20.0, 0.0, -50.0, 100.0, 20.0, 40.0, 40.0, 60.0, 10.0, 40.0, 0.0, 360.0, 10.0, 220.0, 60.0, 0.0, 40.0, 40.0, 40.0, 20.0, 20.0, 0.0, 30.0, 0.0, -30.0, 10.0, 35.0, 10.0, 380.0, 100.0, -40.0, 70.0, 120.0, 0.0, 190.0, 50.0, 30.0, 30.0, 0.0, 0.0, 0.0, 20.0, 0.0, 50.0, 60.0, 150.0, 380.0, -50.0, 20.0, 130.0, 220.0, 0.0, 100.0, 40.0, 10.0, 0.0, 0.0, 10.0, 70.0, 40.0, 30.0, 50.0, 20.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 30.0, 20.0, 70.0, 10.0, 280.0, 30.0, 60.0, 150.0, 100.0, 30.0, 10.0, 80.0, 70.0, 250.0, 0.0, 60.0, 10.0, 10.0, 150.0, 40.0, 10.0, 20.0, 750.0, 50.0, 50.0, 70.0, 480.0, 170.0, 240.0, 100.0, 20.0, 10.0, 30.0, 20.0, 10.0, 20.0, 0.0, 0.0, 230.0, 140.0, 0.0, 40.0, 10.0, 10.0, 0.0, 270.0, 50.0, 110.0, 0.0, 0.0, 50.0, 10.0, 70.0, 40.0, 0.0, 0.0, 0.0, 10.0, 10.0, 40.0, 0.0, 10.0, 10.0, 20.0, 0.0, 30.0, 400.0, 10.0, 70.0, 40.0, 250.0, 80.0, 40.0, 20.0, 0.0, 40.0, 20.0, 0.0, 170.0, 10.0, 40.0, 20.0, 50.0, 10.0, 0.0, 20.0, 200.0, 30.0, 360.0, 30.0, 360.0, 30.0, 110.0, 160.0, 210.0, 320.0, 510.0, 40.0, 20.0, 80.0, 40.0, 240.0, 0.0, 0.0, 0.0, 40.0, 20.0, 10.0, 50.0, 30.0, 440.0, 80.0, 10.0, 20.0, 10.0, 20.0, 80.0, 10.0, 70.0, 0.0, 30.0, 0.0, 0.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4475201089875165, "mean_inference_ms": 1.6465984844578412, "mean_action_processing_ms": 0.42717833653755777, "mean_env_wait_ms": 1.3226696588288331, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.057686805725097656, "StateBufferConnector_ms": 0.009300470352172852, "ViewRequirementAgentConnector_ms": 0.38033342361450195}, "num_episodes": 18, "episode_return_max": 1870.0, "episode_return_min": 100.0, "episode_return_mean": 642.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.3325881671817, "num_env_steps_trained_throughput_per_sec": 36.3325881671817, "timesteps_total": 388000, "num_env_steps_sampled_lifetime": 388000, "num_agent_steps_sampled_lifetime": 3880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3880000, "timers": {"training_iteration_time_ms": 110136.678, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110136.63, "sample_time_ms": 2389.504, "learn_time_ms": 107727.475, "learn_throughput": 37.131, "synch_weights_time_ms": 10.953}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 3880000, "num_agent_steps_trained": 3880000}, "done": false, "training_iteration": 97, "trial_id": "57140_00000", "date": "2024-06-27_02-18-10", "timestamp": 1719469090, "time_this_iter_s": 110.1123161315918, "time_total_s": 11015.96544289589, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23a7040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11015.96544289589, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 16.080000000000002, "ram_util_percent": 79.7141935483871}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.055520995946738, "cur_kl_coeff": 6.927618187665941, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002731194044798077, "vf_loss": 4.054101956715853, "vf_explained_var": 0.0012347674153991147, "kl": Infinity, "entropy": 0.40596539919940045, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 915525.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000}, "env_runners": {"episode_reward_max": 1870.0, "episode_reward_min": 100.0, "episode_reward_mean": 650.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -185.0}, "policy_reward_max": {"policy_0": 930.0}, "policy_reward_mean": {"policy_0": 65.06}, "custom_metrics": {}, "hist_stats": {"episode_reward": [520.0, 230.0, 460.0, 480.0, 1620.0, 540.0, 845.0, 400.0, 570.0, 130.0, 340.0, 530.0, 390.0, 1265.0, 330.0, 750.0, 1300.0, 1470.0, 650.0, 370.0, 660.0, 1305.0, 960.0, 390.0, 340.0, 1380.0, 330.0, 120.0, 435.0, 235.0, 340.0, 280.0, 420.0, 1100.0, 300.0, 820.0, 910.0, 740.0, 450.0, 230.0, 735.0, 310.0, 380.0, 530.0, 330.0, 660.0, 1200.0, 1270.0, 580.0, 875.0, 950.0, 490.0, 1295.0, 220.0, 390.0, 1870.0, 190.0, 600.0, 365.0, 750.0, 800.0, 690.0, 560.0, 680.0, 470.0, 655.0, 320.0, 1060.0, 270.0, 210.0, 1060.0, 1100.0, 1190.0, 460.0, 600.0, 100.0, 940.0, 360.0, 1300.0, 1460.0, 700.0, 230.0, 605.0, 970.0, 780.0, 330.0, 415.0, 870.0, 700.0, 1070.0, 380.0, 500.0, 680.0, 780.0, 120.0, 460.0, 530.0, 720.0, 500.0, 510.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 10.0, 10.0, 0.0, 50.0, 140.0, 0.0, 180.0, 80.0, 40.0, 0.0, 30.0, 30.0, 10.0, 20.0, 20.0, 20.0, 40.0, 40.0, 20.0, 40.0, 30.0, 30.0, 40.0, 0.0, 160.0, 20.0, 50.0, 10.0, 80.0, 20.0, 20.0, 270.0, 70.0, 0.0, 0.0, 10.0, 30.0, 30.0, 30.0, 70.0, 20.0, 40.0, 190.0, 930.0, 90.0, 190.0, 70.0, 30.0, -10.0, 60.0, 180.0, 10.0, 20.0, 30.0, 30.0, 10.0, 160.0, 10.0, 30.0, 110.0, 150.0, 110.0, 40.0, 10.0, 0.0, 320.0, 25.0, 60.0, 20.0, 40.0, -30.0, 350.0, 20.0, 30.0, 0.0, 20.0, 0.0, 20.0, -50.0, 40.0, 40.0, 150.0, 20.0, 60.0, 10.0, 20.0, 20.0, 210.0, 0.0, 0.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 50.0, 20.0, 20.0, 30.0, 20.0, 10.0, 180.0, 20.0, 0.0, 40.0, 20.0, 0.0, 50.0, 40.0, 60.0, 0.0, 60.0, 160.0, 20.0, 80.0, 30.0, 30.0, 0.0, 20.0, 40.0, 10.0, 60.0, 40.0, 20.0, 100.0, 40.0, 60.0, 190.0, 645.0, 30.0, 0.0, 10.0, 60.0, -40.0, 60.0, 160.0, 150.0, 20.0, 30.0, 30.0, 150.0, 10.0, 20.0, 20.0, 20.0, 10.0, 20.0, -5.0, 0.0, 50.0, 260.0, 110.0, 5.0, 50.0, 150.0, 50.0, 80.0, 220.0, 30.0, 400.0, 10.0, 30.0, 0.0, 70.0, 240.0, 180.0, 120.0, 60.0, 170.0, 360.0, 90.0, 350.0, 30.0, -10.0, 70.0, 350.0, 0.0, 60.0, 0.0, 30.0, 360.0, 20.0, 10.0, 10.0, 100.0, 40.0, 20.0, 20.0, 80.0, 10.0, 0.0, 0.0, 10.0, 210.0, -10.0, 20.0, 30.0, 30.0, 60.0, 60.0, 150.0, 10.0, 0.0, 170.0, 90.0, 80.0, 10.0, 30.0, 460.0, 60.0, 440.0, 140.0, 20.0, 40.0, 15.0, 40.0, 60.0, 50.0, 30.0, 30.0, 580.0, 30.0, 20.0, 50.0, 0.0, 80.0, 90.0, 0.0, -80.0, 10.0, 20.0, 220.0, 20.0, 10.0, 10.0, 160.0, 20.0, 0.0, 30.0, 10.0, 10.0, 20.0, 20.0, 70.0, 110.0, 40.0, 30.0, 10.0, 50.0, 370.0, 0.0, 670.0, 50.0, 270.0, -50.0, -30.0, 40.0, 70.0, 10.0, 100.0, 70.0, 20.0, 0.0, 20.0, 30.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 40.0, 10.0, 40.0, 0.0, 5.0, 30.0, 40.0, 40.0, 0.0, 0.0, 100.0, 20.0, 30.0, 170.0, 10.0, 30.0, 10.0, -25.0, 40.0, 0.0, 30.0, 20.0, 100.0, 20.0, 0.0, 30.0, 0.0, 30.0, 80.0, 60.0, 30.0, 20.0, 40.0, 50.0, 50.0, 30.0, 20.0, 60.0, 10.0, 0.0, 0.0, 40.0, 70.0, 0.0, 50.0, 60.0, 20.0, 30.0, 160.0, 30.0, 0.0, 40.0, 0.0, 30.0, 20.0, 20.0, 30.0, 0.0, 750.0, 10.0, 170.0, 50.0, 10.0, 40.0, 60.0, 60.0, 0.0, 50.0, 30.0, 20.0, 40.0, 40.0, 0.0, 0.0, 190.0, 20.0, 130.0, 260.0, 50.0, 10.0, 170.0, 50.0, 40.0, -100.0, 280.0, 110.0, 10.0, -40.0, 170.0, 230.0, 60.0, 40.0, 40.0, 10.0, 20.0, 10.0, 50.0, 190.0, 0.0, 50.0, 180.0, 0.0, 0.0, 240.0, 10.0, 30.0, 10.0, 40.0, 20.0, 0.0, 40.0, -40.0, 260.0, 80.0, 30.0, 30.0, 50.0, 40.0, 30.0, 20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 70.0, 0.0, -5.0, 20.0, 20.0, 0.0, 40.0, 320.0, 260.0, 40.0, 0.0, 40.0, 50.0, 40.0, 30.0, 40.0, 0.0, 40.0, 30.0, 30.0, 10.0, 30.0, 40.0, 10.0, 20.0, 0.0, 0.0, 170.0, 70.0, 0.0, 310.0, 30.0, 0.0, 60.0, 20.0, 30.0, 20.0, 40.0, 20.0, 90.0, 10.0, 10.0, 10.0, 60.0, 30.0, 80.0, 50.0, 40.0, -50.0, 60.0, 50.0, 170.0, 40.0, 50.0, 20.0, 20.0, 20.0, 120.0, 110.0, 110.0, 0.0, 510.0, 40.0, 60.0, 170.0, 60.0, 20.0, 50.0, 180.0, 60.0, 120.0, -20.0, 460.0, 240.0, 40.0, 200.0, 10.0, 40.0, 120.0, 40.0, -10.0, 30.0, 20.0, 0.0, 270.0, 20.0, 0.0, 30.0, 180.0, 150.0, 0.0, 30.0, 30.0, 20.0, 170.0, 180.0, 0.0, 50.0, 245.0, -50.0, 360.0, 20.0, -30.0, 30.0, 10.0, 450.0, 110.0, 30.0, 20.0, 60.0, 0.0, 260.0, 0.0, 40.0, 10.0, 50.0, 40.0, 20.0, 10.0, 120.0, -185.0, 120.0, 580.0, 110.0, 180.0, 60.0, 100.0, 190.0, 20.0, 30.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 20.0, 0.0, 60.0, 10.0, 20.0, 0.0, 30.0, 70.0, 0.0, 0.0, 60.0, 40.0, 160.0, 50.0, 560.0, -10.0, 70.0, 250.0, 100.0, 170.0, 430.0, 40.0, 210.0, 20.0, 20.0, 0.0, 40.0, 30.0, 20.0, 0.0, 40.0, 0.0, 20.0, 160.0, 70.0, 80.0, 30.0, 40.0, 30.0, 80.0, 30.0, 60.0, 20.0, 80.0, 5.0, 40.0, 10.0, 30.0, 60.0, -40.0, 140.0, 10.0, 30.0, -30.0, 20.0, 20.0, 470.0, 50.0, 20.0, 10.0, 130.0, 20.0, 40.0, 0.0, 210.0, 30.0, 20.0, 40.0, 10.0, 120.0, 190.0, 20.0, 160.0, 80.0, 200.0, 50.0, 30.0, 0.0, 70.0, 10.0, 180.0, 20.0, 50.0, 0.0, 0.0, 40.0, 20.0, 170.0, 360.0, 0.0, 20.0, 0.0, -50.0, 100.0, 20.0, 40.0, 40.0, 60.0, 10.0, 40.0, 0.0, 360.0, 10.0, 220.0, 60.0, 0.0, 40.0, 40.0, 40.0, 20.0, 20.0, 0.0, 30.0, 0.0, -30.0, 10.0, 35.0, 10.0, 380.0, 100.0, -40.0, 70.0, 120.0, 0.0, 190.0, 50.0, 30.0, 30.0, 0.0, 0.0, 0.0, 20.0, 0.0, 50.0, 60.0, 150.0, 380.0, -50.0, 20.0, 130.0, 220.0, 0.0, 100.0, 40.0, 10.0, 0.0, 0.0, 10.0, 70.0, 40.0, 30.0, 50.0, 20.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 30.0, 20.0, 70.0, 10.0, 280.0, 30.0, 60.0, 150.0, 100.0, 30.0, 10.0, 80.0, 70.0, 250.0, 0.0, 60.0, 10.0, 10.0, 150.0, 40.0, 10.0, 20.0, 750.0, 50.0, 50.0, 70.0, 480.0, 170.0, 240.0, 100.0, 20.0, 10.0, 30.0, 20.0, 10.0, 20.0, 0.0, 0.0, 230.0, 140.0, 0.0, 40.0, 10.0, 10.0, 0.0, 270.0, 50.0, 110.0, 0.0, 0.0, 50.0, 10.0, 70.0, 40.0, 0.0, 0.0, 0.0, 10.0, 10.0, 40.0, 0.0, 10.0, 10.0, 20.0, 0.0, 30.0, 400.0, 10.0, 70.0, 40.0, 250.0, 80.0, 40.0, 20.0, 0.0, 40.0, 20.0, 0.0, 170.0, 10.0, 40.0, 20.0, 50.0, 10.0, 0.0, 20.0, 200.0, 30.0, 360.0, 30.0, 360.0, 30.0, 110.0, 160.0, 210.0, 320.0, 510.0, 40.0, 20.0, 80.0, 40.0, 240.0, 0.0, 0.0, 0.0, 40.0, 20.0, 10.0, 50.0, 30.0, 440.0, 80.0, 10.0, 20.0, 10.0, 20.0, 80.0, 10.0, 70.0, 0.0, 30.0, 0.0, 0.0, 10.0, 50.0, 20.0, 10.0, 15.0, 70.0, 40.0, 10.0, 210.0, 180.0, 0.0, 15.0, 70.0, 80.0, 160.0, 245.0, 40.0, 30.0, 20.0, 40.0, 270.0, 30.0, 20.0, 10.0, 520.0, 60.0, 60.0, 20.0, 20.0, 30.0, 10.0, 160.0, 20.0, 0.0, 10.0, 0.0, 10.0, 40.0, -30.0, 70.0, 50.0, 40.0, 0.0, 15.0, 40.0, 0.0, 70.0, 10.0, 40.0, 160.0, 40.0, 20.0, 80.0, 370.0, 250.0, 40.0, 40.0, 20.0, 30.0, 30.0, -10.0, 30.0, 80.0, 40.0, 20.0, 30.0, 30.0, 290.0, 160.0, 20.0, 0.0, 20.0, 90.0, 210.0, 170.0, 70.0, 80.0, 80.0, 40.0, 270.0, 40.0, 0.0, 190.0, 30.0, 40.0, 40.0, 20.0, 10.0, 30.0, 20.0, 0.0, 150.0, 0.0, 10.0, 40.0, 0.0, 60.0, 170.0, 0.0, 40.0, 30.0, 100.0, 470.0, 20.0, 0.0, 30.0, 20.0, 10.0, 20.0, 10.0, 0.0, 80.0, 30.0, 30.0, 30.0, 360.0, 160.0, 20.0, 30.0, 10.0, 30.0, 10.0, 0.0, 20.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 180.0, 0.0, 30.0, 0.0, 10.0, 90.0, 30.0, 90.0, 30.0, 0.0, 70.0, 40.0, 70.0, 130.0, 10.0, 10.0, 30.0, 120.0, 40.0, 10.0, 360.0, 100.0, 30.0, 0.0, 110.0, 10.0, 60.0, 50.0, 0.0, 0.0, 190.0, 60.0, 20.0, 0.0, 20.0, 50.0, 20.0, 40.0, 40.0, 60.0, 250.0, 10.0, 10.0, 30.0, 60.0, 30.0, 20.0, 10.0, 70.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4463978005917293, "mean_inference_ms": 1.6455033103900696, "mean_action_processing_ms": 0.4268095662559908, "mean_env_wait_ms": 1.321878945043235, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056571006774902344, "StateBufferConnector_ms": 0.009203910827636719, "ViewRequirementAgentConnector_ms": 0.37055492401123047}, "num_episodes": 18, "episode_return_max": 1870.0, "episode_return_min": 100.0, "episode_return_mean": 650.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.66805725337988, "num_env_steps_trained_throughput_per_sec": 36.66805725337988, "timesteps_total": 392000, "num_env_steps_sampled_lifetime": 392000, "num_agent_steps_sampled_lifetime": 3920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3920000, "timers": {"training_iteration_time_ms": 110032.776, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110032.727, "sample_time_ms": 2408.658, "learn_time_ms": 107604.56, "learn_throughput": 37.173, "synch_weights_time_ms": 10.894}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 3920000, "num_agent_steps_trained": 3920000}, "done": false, "training_iteration": 98, "trial_id": "57140_00000", "date": "2024-06-27_02-19-59", "timestamp": 1719469199, "time_this_iter_s": 109.09991812705994, "time_total_s": 11125.06536102295, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b25c2dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11125.06536102295, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 15.373548387096776, "ram_util_percent": 79.41612903225807}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.980843762899486, "cur_kl_coeff": 10.39142728149891, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.9310357489778847, "policy_loss": -0.0017427780793402522, "vf_loss": 3.9305430266803825, "vf_explained_var": 0.0014045013152499295, "kl": 0.00021512911227416346, "entropy": 0.4145980921701882, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 924915.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000}, "env_runners": {"episode_reward_max": 1870.0, "episode_reward_min": 95.0, "episode_reward_mean": 608.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -185.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 60.83}, "custom_metrics": {}, "hist_stats": {"episode_reward": [960.0, 390.0, 340.0, 1380.0, 330.0, 120.0, 435.0, 235.0, 340.0, 280.0, 420.0, 1100.0, 300.0, 820.0, 910.0, 740.0, 450.0, 230.0, 735.0, 310.0, 380.0, 530.0, 330.0, 660.0, 1200.0, 1270.0, 580.0, 875.0, 950.0, 490.0, 1295.0, 220.0, 390.0, 1870.0, 190.0, 600.0, 365.0, 750.0, 800.0, 690.0, 560.0, 680.0, 470.0, 655.0, 320.0, 1060.0, 270.0, 210.0, 1060.0, 1100.0, 1190.0, 460.0, 600.0, 100.0, 940.0, 360.0, 1300.0, 1460.0, 700.0, 230.0, 605.0, 970.0, 780.0, 330.0, 415.0, 870.0, 700.0, 1070.0, 380.0, 500.0, 680.0, 780.0, 120.0, 460.0, 530.0, 720.0, 500.0, 510.0, 270.0, 680.0, 320.0, 265.0, 270.0, 650.0, 1180.0, 290.0, 255.0, 95.0, 310.0, 380.0, 490.0, 530.0, 950.0, 770.0, 340.0, 700.0, 190.0, 550.0, 400.0, 1040.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 30.0, 30.0, 580.0, 30.0, 20.0, 50.0, 0.0, 80.0, 90.0, 0.0, -80.0, 10.0, 20.0, 220.0, 20.0, 10.0, 10.0, 160.0, 20.0, 0.0, 30.0, 10.0, 10.0, 20.0, 20.0, 70.0, 110.0, 40.0, 30.0, 10.0, 50.0, 370.0, 0.0, 670.0, 50.0, 270.0, -50.0, -30.0, 40.0, 70.0, 10.0, 100.0, 70.0, 20.0, 0.0, 20.0, 30.0, 0.0, 10.0, 0.0, 30.0, 0.0, 0.0, 0.0, 0.0, 40.0, 10.0, 40.0, 0.0, 5.0, 30.0, 40.0, 40.0, 0.0, 0.0, 100.0, 20.0, 30.0, 170.0, 10.0, 30.0, 10.0, -25.0, 40.0, 0.0, 30.0, 20.0, 100.0, 20.0, 0.0, 30.0, 0.0, 30.0, 80.0, 60.0, 30.0, 20.0, 40.0, 50.0, 50.0, 30.0, 20.0, 60.0, 10.0, 0.0, 0.0, 40.0, 70.0, 0.0, 50.0, 60.0, 20.0, 30.0, 160.0, 30.0, 0.0, 40.0, 0.0, 30.0, 20.0, 20.0, 30.0, 0.0, 750.0, 10.0, 170.0, 50.0, 10.0, 40.0, 60.0, 60.0, 0.0, 50.0, 30.0, 20.0, 40.0, 40.0, 0.0, 0.0, 190.0, 20.0, 130.0, 260.0, 50.0, 10.0, 170.0, 50.0, 40.0, -100.0, 280.0, 110.0, 10.0, -40.0, 170.0, 230.0, 60.0, 40.0, 40.0, 10.0, 20.0, 10.0, 50.0, 190.0, 0.0, 50.0, 180.0, 0.0, 0.0, 240.0, 10.0, 30.0, 10.0, 40.0, 20.0, 0.0, 40.0, -40.0, 260.0, 80.0, 30.0, 30.0, 50.0, 40.0, 30.0, 20.0, 0.0, 20.0, 10.0, 0.0, 10.0, 70.0, 0.0, -5.0, 20.0, 20.0, 0.0, 40.0, 320.0, 260.0, 40.0, 0.0, 40.0, 50.0, 40.0, 30.0, 40.0, 0.0, 40.0, 30.0, 30.0, 10.0, 30.0, 40.0, 10.0, 20.0, 0.0, 0.0, 170.0, 70.0, 0.0, 310.0, 30.0, 0.0, 60.0, 20.0, 30.0, 20.0, 40.0, 20.0, 90.0, 10.0, 10.0, 10.0, 60.0, 30.0, 80.0, 50.0, 40.0, -50.0, 60.0, 50.0, 170.0, 40.0, 50.0, 20.0, 20.0, 20.0, 120.0, 110.0, 110.0, 0.0, 510.0, 40.0, 60.0, 170.0, 60.0, 20.0, 50.0, 180.0, 60.0, 120.0, -20.0, 460.0, 240.0, 40.0, 200.0, 10.0, 40.0, 120.0, 40.0, -10.0, 30.0, 20.0, 0.0, 270.0, 20.0, 0.0, 30.0, 180.0, 150.0, 0.0, 30.0, 30.0, 20.0, 170.0, 180.0, 0.0, 50.0, 245.0, -50.0, 360.0, 20.0, -30.0, 30.0, 10.0, 450.0, 110.0, 30.0, 20.0, 60.0, 0.0, 260.0, 0.0, 40.0, 10.0, 50.0, 40.0, 20.0, 10.0, 120.0, -185.0, 120.0, 580.0, 110.0, 180.0, 60.0, 100.0, 190.0, 20.0, 30.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 20.0, 0.0, 60.0, 10.0, 20.0, 0.0, 30.0, 70.0, 0.0, 0.0, 60.0, 40.0, 160.0, 50.0, 560.0, -10.0, 70.0, 250.0, 100.0, 170.0, 430.0, 40.0, 210.0, 20.0, 20.0, 0.0, 40.0, 30.0, 20.0, 0.0, 40.0, 0.0, 20.0, 160.0, 70.0, 80.0, 30.0, 40.0, 30.0, 80.0, 30.0, 60.0, 20.0, 80.0, 5.0, 40.0, 10.0, 30.0, 60.0, -40.0, 140.0, 10.0, 30.0, -30.0, 20.0, 20.0, 470.0, 50.0, 20.0, 10.0, 130.0, 20.0, 40.0, 0.0, 210.0, 30.0, 20.0, 40.0, 10.0, 120.0, 190.0, 20.0, 160.0, 80.0, 200.0, 50.0, 30.0, 0.0, 70.0, 10.0, 180.0, 20.0, 50.0, 0.0, 0.0, 40.0, 20.0, 170.0, 360.0, 0.0, 20.0, 0.0, -50.0, 100.0, 20.0, 40.0, 40.0, 60.0, 10.0, 40.0, 0.0, 360.0, 10.0, 220.0, 60.0, 0.0, 40.0, 40.0, 40.0, 20.0, 20.0, 0.0, 30.0, 0.0, -30.0, 10.0, 35.0, 10.0, 380.0, 100.0, -40.0, 70.0, 120.0, 0.0, 190.0, 50.0, 30.0, 30.0, 0.0, 0.0, 0.0, 20.0, 0.0, 50.0, 60.0, 150.0, 380.0, -50.0, 20.0, 130.0, 220.0, 0.0, 100.0, 40.0, 10.0, 0.0, 0.0, 10.0, 70.0, 40.0, 30.0, 50.0, 20.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 30.0, 20.0, 70.0, 10.0, 280.0, 30.0, 60.0, 150.0, 100.0, 30.0, 10.0, 80.0, 70.0, 250.0, 0.0, 60.0, 10.0, 10.0, 150.0, 40.0, 10.0, 20.0, 750.0, 50.0, 50.0, 70.0, 480.0, 170.0, 240.0, 100.0, 20.0, 10.0, 30.0, 20.0, 10.0, 20.0, 0.0, 0.0, 230.0, 140.0, 0.0, 40.0, 10.0, 10.0, 0.0, 270.0, 50.0, 110.0, 0.0, 0.0, 50.0, 10.0, 70.0, 40.0, 0.0, 0.0, 0.0, 10.0, 10.0, 40.0, 0.0, 10.0, 10.0, 20.0, 0.0, 30.0, 400.0, 10.0, 70.0, 40.0, 250.0, 80.0, 40.0, 20.0, 0.0, 40.0, 20.0, 0.0, 170.0, 10.0, 40.0, 20.0, 50.0, 10.0, 0.0, 20.0, 200.0, 30.0, 360.0, 30.0, 360.0, 30.0, 110.0, 160.0, 210.0, 320.0, 510.0, 40.0, 20.0, 80.0, 40.0, 240.0, 0.0, 0.0, 0.0, 40.0, 20.0, 10.0, 50.0, 30.0, 440.0, 80.0, 10.0, 20.0, 10.0, 20.0, 80.0, 10.0, 70.0, 0.0, 30.0, 0.0, 0.0, 10.0, 50.0, 20.0, 10.0, 15.0, 70.0, 40.0, 10.0, 210.0, 180.0, 0.0, 15.0, 70.0, 80.0, 160.0, 245.0, 40.0, 30.0, 20.0, 40.0, 270.0, 30.0, 20.0, 10.0, 520.0, 60.0, 60.0, 20.0, 20.0, 30.0, 10.0, 160.0, 20.0, 0.0, 10.0, 0.0, 10.0, 40.0, -30.0, 70.0, 50.0, 40.0, 0.0, 15.0, 40.0, 0.0, 70.0, 10.0, 40.0, 160.0, 40.0, 20.0, 80.0, 370.0, 250.0, 40.0, 40.0, 20.0, 30.0, 30.0, -10.0, 30.0, 80.0, 40.0, 20.0, 30.0, 30.0, 290.0, 160.0, 20.0, 0.0, 20.0, 90.0, 210.0, 170.0, 70.0, 80.0, 80.0, 40.0, 270.0, 40.0, 0.0, 190.0, 30.0, 40.0, 40.0, 20.0, 10.0, 30.0, 20.0, 0.0, 150.0, 0.0, 10.0, 40.0, 0.0, 60.0, 170.0, 0.0, 40.0, 30.0, 100.0, 470.0, 20.0, 0.0, 30.0, 20.0, 10.0, 20.0, 10.0, 0.0, 80.0, 30.0, 30.0, 30.0, 360.0, 160.0, 20.0, 30.0, 10.0, 30.0, 10.0, 0.0, 20.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 180.0, 0.0, 30.0, 0.0, 10.0, 90.0, 30.0, 90.0, 30.0, 0.0, 70.0, 40.0, 70.0, 130.0, 10.0, 10.0, 30.0, 120.0, 40.0, 10.0, 360.0, 100.0, 30.0, 0.0, 110.0, 10.0, 60.0, 50.0, 0.0, 0.0, 190.0, 60.0, 20.0, 0.0, 20.0, 50.0, 20.0, 40.0, 40.0, 60.0, 250.0, 10.0, 10.0, 30.0, 60.0, 30.0, 20.0, 10.0, 70.0, 20.0, 40.0, 0.0, 10.0, 0.0, 40.0, 0.0, 50.0, 100.0, 0.0, 30.0, 80.0, 60.0, 50.0, 30.0, 170.0, 20.0, 20.0, 180.0, 50.0, 20.0, 100.0, 0.0, 10.0, 0.0, 10.0, 40.0, 110.0, 0.0, 0.0, 50.0, 0.0, -5.0, 70.0, 10.0, 10.0, 160.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 170.0, 20.0, 10.0, 30.0, 0.0, 40.0, 40.0, 20.0, 10.0, 200.0, 20.0, 70.0, 20.0, 30.0, 200.0, 50.0, 30.0, 10.0, 70.0, 570.0, 50.0, 90.0, 0.0, 260.0, 50.0, 20.0, 30.0, 20.0, 150.0, 0.0, 20.0, 0.0, 30.0, 0.0, 20.0, -5.0, 40.0, 20.0, 40.0, 0.0, 0.0, 120.0, 40.0, 0.0, 0.0, 5.0, 0.0, 10.0, 30.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 150.0, 0.0, 0.0, 40.0, 10.0, 10.0, 70.0, 0.0, 30.0, 0.0, 40.0, 20.0, 60.0, 100.0, 10.0, 20.0, 20.0, 0.0, 40.0, 70.0, 190.0, 200.0, 0.0, 0.0, 10.0, 10.0, 10.0, 40.0, 0.0, 30.0, 0.0, 30.0, 160.0, 40.0, 30.0, 0.0, 10.0, 70.0, 80.0, 110.0, 10.0, 40.0, 160.0, 10.0, 180.0, 60.0, 70.0, 50.0, 10.0, 360.0, 40.0, 350.0, 50.0, 40.0, -20.0, 60.0, 30.0, 160.0, 10.0, 50.0, 30.0, 30.0, 50.0, 50.0, 0.0, 40.0, 100.0, 10.0, 0.0, 30.0, 60.0, 40.0, 20.0, 170.0, 130.0, 30.0, 150.0, 30.0, 40.0, 30.0, 20.0, 30.0, 20.0, 0.0, 0.0, 20.0, 40.0, 0.0, 40.0, 20.0, 10.0, 10.0, 90.0, 270.0, 20.0, 20.0, 80.0, 20.0, 0.0, 30.0, 30.0, -150.0, 10.0, 40.0, 40.0, 30.0, 230.0, 0.0, 100.0, 70.0, 70.0, 60.0, 200.0, 30.0, 470.0, -40.0, 170.0, -10.0, 10.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4449956505616341, "mean_inference_ms": 1.6442103115814712, "mean_action_processing_ms": 0.4263746564535562, "mean_env_wait_ms": 1.3209330176340117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.057718515396118164, "StateBufferConnector_ms": 0.009164571762084961, "ViewRequirementAgentConnector_ms": 0.3802797794342041}, "num_episodes": 22, "episode_return_max": 1870.0, "episode_return_min": 95.0, "episode_return_mean": 608.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.47153674723058, "num_env_steps_trained_throughput_per_sec": 36.47153674723058, "timesteps_total": 396000, "num_env_steps_sampled_lifetime": 396000, "num_agent_steps_sampled_lifetime": 3960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 3960000, "timers": {"training_iteration_time_ms": 109933.947, "restore_workers_time_ms": 0.012, "training_step_time_ms": 109933.898, "sample_time_ms": 2414.72, "learn_time_ms": 107499.728, "learn_throughput": 37.209, "synch_weights_time_ms": 10.792}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 3960000, "num_agent_steps_trained": 3960000}, "done": false, "training_iteration": 99, "trial_id": "57140_00000", "date": "2024-06-27_02-21-49", "timestamp": 1719469309, "time_this_iter_s": 109.68632793426514, "time_total_s": 11234.751688957214, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23a7ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11234.751688957214, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 15.810967741935483, "ram_util_percent": 79.07612903225807}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5737710126228355, "cur_kl_coeff": 5.195713640749455, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.391715504947943, "policy_loss": -0.001983162782381113, "vf_loss": 4.391679669340578, "vf_explained_var": 0.0002800198345265576, "kl": 0.00038858892803982477, "entropy": 0.39551423066340313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 934305.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000}, "env_runners": {"episode_reward_max": 1870.0, "episode_reward_min": 95.0, "episode_reward_mean": 616.05, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -185.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 61.605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [735.0, 310.0, 380.0, 530.0, 330.0, 660.0, 1200.0, 1270.0, 580.0, 875.0, 950.0, 490.0, 1295.0, 220.0, 390.0, 1870.0, 190.0, 600.0, 365.0, 750.0, 800.0, 690.0, 560.0, 680.0, 470.0, 655.0, 320.0, 1060.0, 270.0, 210.0, 1060.0, 1100.0, 1190.0, 460.0, 600.0, 100.0, 940.0, 360.0, 1300.0, 1460.0, 700.0, 230.0, 605.0, 970.0, 780.0, 330.0, 415.0, 870.0, 700.0, 1070.0, 380.0, 500.0, 680.0, 780.0, 120.0, 460.0, 530.0, 720.0, 500.0, 510.0, 270.0, 680.0, 320.0, 265.0, 270.0, 650.0, 1180.0, 290.0, 255.0, 95.0, 310.0, 380.0, 490.0, 530.0, 950.0, 770.0, 340.0, 700.0, 190.0, 550.0, 400.0, 1040.0, 670.0, 440.0, 380.0, 290.0, 790.0, 1110.0, 850.0, 1140.0, 100.0, 290.0, 815.0, 470.0, 1045.0, 945.0, 370.0, 190.0, 110.0, 550.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 70.0, 0.0, -5.0, 20.0, 20.0, 0.0, 40.0, 320.0, 260.0, 40.0, 0.0, 40.0, 50.0, 40.0, 30.0, 40.0, 0.0, 40.0, 30.0, 30.0, 10.0, 30.0, 40.0, 10.0, 20.0, 0.0, 0.0, 170.0, 70.0, 0.0, 310.0, 30.0, 0.0, 60.0, 20.0, 30.0, 20.0, 40.0, 20.0, 90.0, 10.0, 10.0, 10.0, 60.0, 30.0, 80.0, 50.0, 40.0, -50.0, 60.0, 50.0, 170.0, 40.0, 50.0, 20.0, 20.0, 20.0, 120.0, 110.0, 110.0, 0.0, 510.0, 40.0, 60.0, 170.0, 60.0, 20.0, 50.0, 180.0, 60.0, 120.0, -20.0, 460.0, 240.0, 40.0, 200.0, 10.0, 40.0, 120.0, 40.0, -10.0, 30.0, 20.0, 0.0, 270.0, 20.0, 0.0, 30.0, 180.0, 150.0, 0.0, 30.0, 30.0, 20.0, 170.0, 180.0, 0.0, 50.0, 245.0, -50.0, 360.0, 20.0, -30.0, 30.0, 10.0, 450.0, 110.0, 30.0, 20.0, 60.0, 0.0, 260.0, 0.0, 40.0, 10.0, 50.0, 40.0, 20.0, 10.0, 120.0, -185.0, 120.0, 580.0, 110.0, 180.0, 60.0, 100.0, 190.0, 20.0, 30.0, 20.0, 40.0, 0.0, 20.0, 10.0, 20.0, 20.0, 0.0, 60.0, 10.0, 20.0, 0.0, 30.0, 70.0, 0.0, 0.0, 60.0, 40.0, 160.0, 50.0, 560.0, -10.0, 70.0, 250.0, 100.0, 170.0, 430.0, 40.0, 210.0, 20.0, 20.0, 0.0, 40.0, 30.0, 20.0, 0.0, 40.0, 0.0, 20.0, 160.0, 70.0, 80.0, 30.0, 40.0, 30.0, 80.0, 30.0, 60.0, 20.0, 80.0, 5.0, 40.0, 10.0, 30.0, 60.0, -40.0, 140.0, 10.0, 30.0, -30.0, 20.0, 20.0, 470.0, 50.0, 20.0, 10.0, 130.0, 20.0, 40.0, 0.0, 210.0, 30.0, 20.0, 40.0, 10.0, 120.0, 190.0, 20.0, 160.0, 80.0, 200.0, 50.0, 30.0, 0.0, 70.0, 10.0, 180.0, 20.0, 50.0, 0.0, 0.0, 40.0, 20.0, 170.0, 360.0, 0.0, 20.0, 0.0, -50.0, 100.0, 20.0, 40.0, 40.0, 60.0, 10.0, 40.0, 0.0, 360.0, 10.0, 220.0, 60.0, 0.0, 40.0, 40.0, 40.0, 20.0, 20.0, 0.0, 30.0, 0.0, -30.0, 10.0, 35.0, 10.0, 380.0, 100.0, -40.0, 70.0, 120.0, 0.0, 190.0, 50.0, 30.0, 30.0, 0.0, 0.0, 0.0, 20.0, 0.0, 50.0, 60.0, 150.0, 380.0, -50.0, 20.0, 130.0, 220.0, 0.0, 100.0, 40.0, 10.0, 0.0, 0.0, 10.0, 70.0, 40.0, 30.0, 50.0, 20.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 30.0, 20.0, 70.0, 10.0, 280.0, 30.0, 60.0, 150.0, 100.0, 30.0, 10.0, 80.0, 70.0, 250.0, 0.0, 60.0, 10.0, 10.0, 150.0, 40.0, 10.0, 20.0, 750.0, 50.0, 50.0, 70.0, 480.0, 170.0, 240.0, 100.0, 20.0, 10.0, 30.0, 20.0, 10.0, 20.0, 0.0, 0.0, 230.0, 140.0, 0.0, 40.0, 10.0, 10.0, 0.0, 270.0, 50.0, 110.0, 0.0, 0.0, 50.0, 10.0, 70.0, 40.0, 0.0, 0.0, 0.0, 10.0, 10.0, 40.0, 0.0, 10.0, 10.0, 20.0, 0.0, 30.0, 400.0, 10.0, 70.0, 40.0, 250.0, 80.0, 40.0, 20.0, 0.0, 40.0, 20.0, 0.0, 170.0, 10.0, 40.0, 20.0, 50.0, 10.0, 0.0, 20.0, 200.0, 30.0, 360.0, 30.0, 360.0, 30.0, 110.0, 160.0, 210.0, 320.0, 510.0, 40.0, 20.0, 80.0, 40.0, 240.0, 0.0, 0.0, 0.0, 40.0, 20.0, 10.0, 50.0, 30.0, 440.0, 80.0, 10.0, 20.0, 10.0, 20.0, 80.0, 10.0, 70.0, 0.0, 30.0, 0.0, 0.0, 10.0, 50.0, 20.0, 10.0, 15.0, 70.0, 40.0, 10.0, 210.0, 180.0, 0.0, 15.0, 70.0, 80.0, 160.0, 245.0, 40.0, 30.0, 20.0, 40.0, 270.0, 30.0, 20.0, 10.0, 520.0, 60.0, 60.0, 20.0, 20.0, 30.0, 10.0, 160.0, 20.0, 0.0, 10.0, 0.0, 10.0, 40.0, -30.0, 70.0, 50.0, 40.0, 0.0, 15.0, 40.0, 0.0, 70.0, 10.0, 40.0, 160.0, 40.0, 20.0, 80.0, 370.0, 250.0, 40.0, 40.0, 20.0, 30.0, 30.0, -10.0, 30.0, 80.0, 40.0, 20.0, 30.0, 30.0, 290.0, 160.0, 20.0, 0.0, 20.0, 90.0, 210.0, 170.0, 70.0, 80.0, 80.0, 40.0, 270.0, 40.0, 0.0, 190.0, 30.0, 40.0, 40.0, 20.0, 10.0, 30.0, 20.0, 0.0, 150.0, 0.0, 10.0, 40.0, 0.0, 60.0, 170.0, 0.0, 40.0, 30.0, 100.0, 470.0, 20.0, 0.0, 30.0, 20.0, 10.0, 20.0, 10.0, 0.0, 80.0, 30.0, 30.0, 30.0, 360.0, 160.0, 20.0, 30.0, 10.0, 30.0, 10.0, 0.0, 20.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 180.0, 0.0, 30.0, 0.0, 10.0, 90.0, 30.0, 90.0, 30.0, 0.0, 70.0, 40.0, 70.0, 130.0, 10.0, 10.0, 30.0, 120.0, 40.0, 10.0, 360.0, 100.0, 30.0, 0.0, 110.0, 10.0, 60.0, 50.0, 0.0, 0.0, 190.0, 60.0, 20.0, 0.0, 20.0, 50.0, 20.0, 40.0, 40.0, 60.0, 250.0, 10.0, 10.0, 30.0, 60.0, 30.0, 20.0, 10.0, 70.0, 20.0, 40.0, 0.0, 10.0, 0.0, 40.0, 0.0, 50.0, 100.0, 0.0, 30.0, 80.0, 60.0, 50.0, 30.0, 170.0, 20.0, 20.0, 180.0, 50.0, 20.0, 100.0, 0.0, 10.0, 0.0, 10.0, 40.0, 110.0, 0.0, 0.0, 50.0, 0.0, -5.0, 70.0, 10.0, 10.0, 160.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 170.0, 20.0, 10.0, 30.0, 0.0, 40.0, 40.0, 20.0, 10.0, 200.0, 20.0, 70.0, 20.0, 30.0, 200.0, 50.0, 30.0, 10.0, 70.0, 570.0, 50.0, 90.0, 0.0, 260.0, 50.0, 20.0, 30.0, 20.0, 150.0, 0.0, 20.0, 0.0, 30.0, 0.0, 20.0, -5.0, 40.0, 20.0, 40.0, 0.0, 0.0, 120.0, 40.0, 0.0, 0.0, 5.0, 0.0, 10.0, 30.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 150.0, 0.0, 0.0, 40.0, 10.0, 10.0, 70.0, 0.0, 30.0, 0.0, 40.0, 20.0, 60.0, 100.0, 10.0, 20.0, 20.0, 0.0, 40.0, 70.0, 190.0, 200.0, 0.0, 0.0, 10.0, 10.0, 10.0, 40.0, 0.0, 30.0, 0.0, 30.0, 160.0, 40.0, 30.0, 0.0, 10.0, 70.0, 80.0, 110.0, 10.0, 40.0, 160.0, 10.0, 180.0, 60.0, 70.0, 50.0, 10.0, 360.0, 40.0, 350.0, 50.0, 40.0, -20.0, 60.0, 30.0, 160.0, 10.0, 50.0, 30.0, 30.0, 50.0, 50.0, 0.0, 40.0, 100.0, 10.0, 0.0, 30.0, 60.0, 40.0, 20.0, 170.0, 130.0, 30.0, 150.0, 30.0, 40.0, 30.0, 20.0, 30.0, 20.0, 0.0, 0.0, 20.0, 40.0, 0.0, 40.0, 20.0, 10.0, 10.0, 90.0, 270.0, 20.0, 20.0, 80.0, 20.0, 0.0, 30.0, 30.0, -150.0, 10.0, 40.0, 40.0, 30.0, 230.0, 0.0, 100.0, 70.0, 70.0, 60.0, 200.0, 30.0, 470.0, -40.0, 170.0, -10.0, 10.0, 80.0, 0.0, 160.0, 10.0, 70.0, 80.0, 90.0, 200.0, 30.0, 20.0, 10.0, 10.0, 10.0, 30.0, 20.0, 30.0, 0.0, 50.0, 160.0, 60.0, 70.0, 10.0, 20.0, 260.0, 0.0, 0.0, 20.0, 30.0, 0.0, 10.0, 30.0, 20.0, 60.0, 40.0, 0.0, 20.0, 40.0, 0.0, 60.0, 40.0, 10.0, 60.0, 80.0, 10.0, 30.0, 450.0, 90.0, 10.0, 10.0, 10.0, 40.0, 150.0, 270.0, 0.0, 40.0, 40.0, 10.0, 370.0, 50.0, 180.0, 0.0, 70.0, 380.0, 0.0, 20.0, 40.0, -10.0, 30.0, 30.0, 200.0, 90.0, 480.0, 20.0, 45.0, 270.0, 280.0, 30.0, -20.0, 30.0, 80.0, -75.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 40.0, 20.0, 0.0, 0.0, 0.0, 160.0, 10.0, 60.0, 0.0, 40.0, 0.0, 20.0, 100.0, 170.0, 5.0, -20.0, 200.0, 20.0, 50.0, 20.0, 250.0, 120.0, 0.0, 80.0, 80.0, 40.0, 40.0, 20.0, 10.0, 80.0, 0.0, 590.0, -25.0, 250.0, 20.0, 150.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 160.0, 40.0, 10.0, 600.0, 5.0, 50.0, 20.0, 50.0, 30.0, 30.0, 70.0, 30.0, 10.0, 20.0, 100.0, 0.0, 50.0, 30.0, 30.0, 0.0, 20.0, 30.0, 10.0, 20.0, 30.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 0.0, 40.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 160.0, 50.0, 0.0, 150.0, 120.0, 20.0, 0.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4438776464437078, "mean_inference_ms": 1.6432635431163534, "mean_action_processing_ms": 0.4260529901674641, "mean_env_wait_ms": 1.320165090215999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05701112747192383, "StateBufferConnector_ms": 0.009093284606933594, "ViewRequirementAgentConnector_ms": 0.37660670280456543}, "num_episodes": 18, "episode_return_max": 1870.0, "episode_return_min": 95.0, "episode_return_mean": 616.05}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.595811207116434, "num_env_steps_trained_throughput_per_sec": 36.595811207116434, "timesteps_total": 400000, "num_env_steps_sampled_lifetime": 400000, "num_agent_steps_sampled_lifetime": 4000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000000, "timers": {"training_iteration_time_ms": 109830.19, "restore_workers_time_ms": 0.012, "training_step_time_ms": 109830.141, "sample_time_ms": 2411.632, "learn_time_ms": 107399.034, "learn_throughput": 37.244, "synch_weights_time_ms": 10.881}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 4000000, "num_agent_steps_trained": 4000000}, "done": false, "training_iteration": 100, "trial_id": "57140_00000", "date": "2024-06-27_02-23-38", "timestamp": 1719469418, "time_this_iter_s": 109.31684589385986, "time_total_s": 11344.068534851074, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af404c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11344.068534851074, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 15.294805194805196, "ram_util_percent": 79.05844155844156}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.133409578065141, "cur_kl_coeff": 2.5978568203747274, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.003041011163978753, "vf_loss": 3.824178988991962, "vf_explained_var": 0.0004989570131697975, "kl": Infinity, "entropy": 0.38569406808311313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 943695.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000}, "env_runners": {"episode_reward_max": 1460.0, "episode_reward_min": 90.0, "episode_reward_mean": 577.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -170.0}, "policy_reward_max": {"policy_0": 750.0}, "policy_reward_mean": {"policy_0": 57.78}, "custom_metrics": {}, "hist_stats": {"episode_reward": [680.0, 470.0, 655.0, 320.0, 1060.0, 270.0, 210.0, 1060.0, 1100.0, 1190.0, 460.0, 600.0, 100.0, 940.0, 360.0, 1300.0, 1460.0, 700.0, 230.0, 605.0, 970.0, 780.0, 330.0, 415.0, 870.0, 700.0, 1070.0, 380.0, 500.0, 680.0, 780.0, 120.0, 460.0, 530.0, 720.0, 500.0, 510.0, 270.0, 680.0, 320.0, 265.0, 270.0, 650.0, 1180.0, 290.0, 255.0, 95.0, 310.0, 380.0, 490.0, 530.0, 950.0, 770.0, 340.0, 700.0, 190.0, 550.0, 400.0, 1040.0, 670.0, 440.0, 380.0, 290.0, 790.0, 1110.0, 850.0, 1140.0, 100.0, 290.0, 815.0, 470.0, 1045.0, 945.0, 370.0, 190.0, 110.0, 550.0, 600.0, 310.0, 530.0, 450.0, 1030.0, 140.0, 300.0, 220.0, 360.0, 1150.0, 90.0, 1430.0, 1050.0, 350.0, 770.0, 470.0, 640.0, 415.0, 510.0, 530.0, 300.0, 400.0, 170.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 20.0, 40.0, 40.0, 60.0, 10.0, 40.0, 0.0, 360.0, 10.0, 220.0, 60.0, 0.0, 40.0, 40.0, 40.0, 20.0, 20.0, 0.0, 30.0, 0.0, -30.0, 10.0, 35.0, 10.0, 380.0, 100.0, -40.0, 70.0, 120.0, 0.0, 190.0, 50.0, 30.0, 30.0, 0.0, 0.0, 0.0, 20.0, 0.0, 50.0, 60.0, 150.0, 380.0, -50.0, 20.0, 130.0, 220.0, 0.0, 100.0, 40.0, 10.0, 0.0, 0.0, 10.0, 70.0, 40.0, 30.0, 50.0, 20.0, 0.0, 0.0, 10.0, 20.0, 20.0, 30.0, 30.0, 20.0, 70.0, 10.0, 280.0, 30.0, 60.0, 150.0, 100.0, 30.0, 10.0, 80.0, 70.0, 250.0, 0.0, 60.0, 10.0, 10.0, 150.0, 40.0, 10.0, 20.0, 750.0, 50.0, 50.0, 70.0, 480.0, 170.0, 240.0, 100.0, 20.0, 10.0, 30.0, 20.0, 10.0, 20.0, 0.0, 0.0, 230.0, 140.0, 0.0, 40.0, 10.0, 10.0, 0.0, 270.0, 50.0, 110.0, 0.0, 0.0, 50.0, 10.0, 70.0, 40.0, 0.0, 0.0, 0.0, 10.0, 10.0, 40.0, 0.0, 10.0, 10.0, 20.0, 0.0, 30.0, 400.0, 10.0, 70.0, 40.0, 250.0, 80.0, 40.0, 20.0, 0.0, 40.0, 20.0, 0.0, 170.0, 10.0, 40.0, 20.0, 50.0, 10.0, 0.0, 20.0, 200.0, 30.0, 360.0, 30.0, 360.0, 30.0, 110.0, 160.0, 210.0, 320.0, 510.0, 40.0, 20.0, 80.0, 40.0, 240.0, 0.0, 0.0, 0.0, 40.0, 20.0, 10.0, 50.0, 30.0, 440.0, 80.0, 10.0, 20.0, 10.0, 20.0, 80.0, 10.0, 70.0, 0.0, 30.0, 0.0, 0.0, 10.0, 50.0, 20.0, 10.0, 15.0, 70.0, 40.0, 10.0, 210.0, 180.0, 0.0, 15.0, 70.0, 80.0, 160.0, 245.0, 40.0, 30.0, 20.0, 40.0, 270.0, 30.0, 20.0, 10.0, 520.0, 60.0, 60.0, 20.0, 20.0, 30.0, 10.0, 160.0, 20.0, 0.0, 10.0, 0.0, 10.0, 40.0, -30.0, 70.0, 50.0, 40.0, 0.0, 15.0, 40.0, 0.0, 70.0, 10.0, 40.0, 160.0, 40.0, 20.0, 80.0, 370.0, 250.0, 40.0, 40.0, 20.0, 30.0, 30.0, -10.0, 30.0, 80.0, 40.0, 20.0, 30.0, 30.0, 290.0, 160.0, 20.0, 0.0, 20.0, 90.0, 210.0, 170.0, 70.0, 80.0, 80.0, 40.0, 270.0, 40.0, 0.0, 190.0, 30.0, 40.0, 40.0, 20.0, 10.0, 30.0, 20.0, 0.0, 150.0, 0.0, 10.0, 40.0, 0.0, 60.0, 170.0, 0.0, 40.0, 30.0, 100.0, 470.0, 20.0, 0.0, 30.0, 20.0, 10.0, 20.0, 10.0, 0.0, 80.0, 30.0, 30.0, 30.0, 360.0, 160.0, 20.0, 30.0, 10.0, 30.0, 10.0, 0.0, 20.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 180.0, 0.0, 30.0, 0.0, 10.0, 90.0, 30.0, 90.0, 30.0, 0.0, 70.0, 40.0, 70.0, 130.0, 10.0, 10.0, 30.0, 120.0, 40.0, 10.0, 360.0, 100.0, 30.0, 0.0, 110.0, 10.0, 60.0, 50.0, 0.0, 0.0, 190.0, 60.0, 20.0, 0.0, 20.0, 50.0, 20.0, 40.0, 40.0, 60.0, 250.0, 10.0, 10.0, 30.0, 60.0, 30.0, 20.0, 10.0, 70.0, 20.0, 40.0, 0.0, 10.0, 0.0, 40.0, 0.0, 50.0, 100.0, 0.0, 30.0, 80.0, 60.0, 50.0, 30.0, 170.0, 20.0, 20.0, 180.0, 50.0, 20.0, 100.0, 0.0, 10.0, 0.0, 10.0, 40.0, 110.0, 0.0, 0.0, 50.0, 0.0, -5.0, 70.0, 10.0, 10.0, 160.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 170.0, 20.0, 10.0, 30.0, 0.0, 40.0, 40.0, 20.0, 10.0, 200.0, 20.0, 70.0, 20.0, 30.0, 200.0, 50.0, 30.0, 10.0, 70.0, 570.0, 50.0, 90.0, 0.0, 260.0, 50.0, 20.0, 30.0, 20.0, 150.0, 0.0, 20.0, 0.0, 30.0, 0.0, 20.0, -5.0, 40.0, 20.0, 40.0, 0.0, 0.0, 120.0, 40.0, 0.0, 0.0, 5.0, 0.0, 10.0, 30.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 150.0, 0.0, 0.0, 40.0, 10.0, 10.0, 70.0, 0.0, 30.0, 0.0, 40.0, 20.0, 60.0, 100.0, 10.0, 20.0, 20.0, 0.0, 40.0, 70.0, 190.0, 200.0, 0.0, 0.0, 10.0, 10.0, 10.0, 40.0, 0.0, 30.0, 0.0, 30.0, 160.0, 40.0, 30.0, 0.0, 10.0, 70.0, 80.0, 110.0, 10.0, 40.0, 160.0, 10.0, 180.0, 60.0, 70.0, 50.0, 10.0, 360.0, 40.0, 350.0, 50.0, 40.0, -20.0, 60.0, 30.0, 160.0, 10.0, 50.0, 30.0, 30.0, 50.0, 50.0, 0.0, 40.0, 100.0, 10.0, 0.0, 30.0, 60.0, 40.0, 20.0, 170.0, 130.0, 30.0, 150.0, 30.0, 40.0, 30.0, 20.0, 30.0, 20.0, 0.0, 0.0, 20.0, 40.0, 0.0, 40.0, 20.0, 10.0, 10.0, 90.0, 270.0, 20.0, 20.0, 80.0, 20.0, 0.0, 30.0, 30.0, -150.0, 10.0, 40.0, 40.0, 30.0, 230.0, 0.0, 100.0, 70.0, 70.0, 60.0, 200.0, 30.0, 470.0, -40.0, 170.0, -10.0, 10.0, 80.0, 0.0, 160.0, 10.0, 70.0, 80.0, 90.0, 200.0, 30.0, 20.0, 10.0, 10.0, 10.0, 30.0, 20.0, 30.0, 0.0, 50.0, 160.0, 60.0, 70.0, 10.0, 20.0, 260.0, 0.0, 0.0, 20.0, 30.0, 0.0, 10.0, 30.0, 20.0, 60.0, 40.0, 0.0, 20.0, 40.0, 0.0, 60.0, 40.0, 10.0, 60.0, 80.0, 10.0, 30.0, 450.0, 90.0, 10.0, 10.0, 10.0, 40.0, 150.0, 270.0, 0.0, 40.0, 40.0, 10.0, 370.0, 50.0, 180.0, 0.0, 70.0, 380.0, 0.0, 20.0, 40.0, -10.0, 30.0, 30.0, 200.0, 90.0, 480.0, 20.0, 45.0, 270.0, 280.0, 30.0, -20.0, 30.0, 80.0, -75.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 40.0, 20.0, 0.0, 0.0, 0.0, 160.0, 10.0, 60.0, 0.0, 40.0, 0.0, 20.0, 100.0, 170.0, 5.0, -20.0, 200.0, 20.0, 50.0, 20.0, 250.0, 120.0, 0.0, 80.0, 80.0, 40.0, 40.0, 20.0, 10.0, 80.0, 0.0, 590.0, -25.0, 250.0, 20.0, 150.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 160.0, 40.0, 10.0, 600.0, 5.0, 50.0, 20.0, 50.0, 30.0, 30.0, 70.0, 30.0, 10.0, 20.0, 100.0, 0.0, 50.0, 30.0, 30.0, 0.0, 20.0, 30.0, 10.0, 20.0, 30.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 0.0, 40.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 160.0, 50.0, 0.0, 150.0, 120.0, 20.0, 0.0, 40.0, 40.0, 10.0, 0.0, 20.0, 40.0, 20.0, 170.0, 10.0, 290.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 40.0, 0.0, 0.0, 180.0, 40.0, 0.0, 80.0, 20.0, 120.0, 10.0, 50.0, 20.0, 40.0, 20.0, 170.0, 30.0, 280.0, 20.0, 0.0, 50.0, 20.0, 0.0, 30.0, 10.0, 10.0, 20.0, 20.0, 70.0, 270.0, 20.0, 70.0, 10.0, 30.0, 330.0, 190.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 30.0, 60.0, 40.0, 0.0, 0.0, 30.0, 20.0, 30.0, -170.0, 30.0, 40.0, 280.0, 40.0, 10.0, 10.0, 40.0, 40.0, 0.0, 50.0, 0.0, 20.0, 10.0, 20.0, 60.0, 160.0, 0.0, 0.0, 30.0, 10.0, 60.0, 0.0, 20.0, 100.0, 160.0, 230.0, 60.0, 40.0, 220.0, 0.0, -10.0, 280.0, 70.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 80.0, 450.0, -20.0, 70.0, 70.0, 510.0, 90.0, 20.0, 80.0, 80.0, 120.0, 180.0, 80.0, 30.0, 20.0, 160.0, 130.0, 20.0, 280.0, 30.0, 40.0, 60.0, 50.0, 10.0, 10.0, 0.0, 0.0, 60.0, 120.0, 0.0, 40.0, 100.0, 90.0, 350.0, 100.0, 0.0, 20.0, 10.0, 30.0, 30.0, 0.0, 60.0, 0.0, 30.0, -40.0, 90.0, 170.0, 90.0, 30.0, 40.0, 40.0, 150.0, 370.0, 0.0, 0.0, -20.0, 40.0, 40.0, 10.0, 10.0, 30.0, 40.0, 0.0, 20.0, 15.0, 0.0, 10.0, 60.0, 70.0, 170.0, 30.0, 250.0, 20.0, 20.0, 40.0, 40.0, 30.0, 60.0, 10.0, 10.0, 80.0, 250.0, 50.0, 10.0, 0.0, 0.0, 30.0, 10.0, 10.0, 90.0, 20.0, 0.0, 30.0, 0.0, 20.0, 20.0, 40.0, 10.0, 60.0, 100.0, 40.0, 180.0, 80.0, 30.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 20.0, 0.0, 70.0, 0.0, 20.0, 10.0, 20.0, 10.0, 10.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4423662643023991, "mean_inference_ms": 1.6420193792739701, "mean_action_processing_ms": 0.42561578452159493, "mean_env_wait_ms": 1.31920619639715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05770421028137207, "StateBufferConnector_ms": 0.009300470352172852, "ViewRequirementAgentConnector_ms": 0.3920571804046631}, "num_episodes": 23, "episode_return_max": 1460.0, "episode_return_min": 90.0, "episode_return_mean": 577.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.27610872659784, "num_env_steps_trained_throughput_per_sec": 36.27610872659784, "timesteps_total": 404000, "num_env_steps_sampled_lifetime": 404000, "num_agent_steps_sampled_lifetime": 4040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4040000, "timers": {"training_iteration_time_ms": 109895.91, "restore_workers_time_ms": 0.013, "training_step_time_ms": 109895.861, "sample_time_ms": 2406.534, "learn_time_ms": 107469.473, "learn_throughput": 37.22, "synch_weights_time_ms": 11.024}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 4040000, "num_agent_steps_trained": 4040000}, "done": false, "training_iteration": 101, "trial_id": "57140_00000", "date": "2024-06-27_02-25-29", "timestamp": 1719469529, "time_this_iter_s": 110.27600312232971, "time_total_s": 11454.344537973404, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b25c2e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11454.344537973404, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 17.040384615384617, "ram_util_percent": 79.00192307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3811429588717266, "cur_kl_coeff": 3.8967852305620903, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0024281672741354892, "vf_loss": 4.115463218394432, "vf_explained_var": 0.00044205367755585206, "kl": Infinity, "entropy": 0.37325748681101684, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 953085.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000}, "env_runners": {"episode_reward_max": 1430.0, "episode_reward_min": 90.0, "episode_reward_mean": 559.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -170.0}, "policy_reward_max": {"policy_0": 670.0}, "policy_reward_mean": {"policy_0": 55.965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [230.0, 605.0, 970.0, 780.0, 330.0, 415.0, 870.0, 700.0, 1070.0, 380.0, 500.0, 680.0, 780.0, 120.0, 460.0, 530.0, 720.0, 500.0, 510.0, 270.0, 680.0, 320.0, 265.0, 270.0, 650.0, 1180.0, 290.0, 255.0, 95.0, 310.0, 380.0, 490.0, 530.0, 950.0, 770.0, 340.0, 700.0, 190.0, 550.0, 400.0, 1040.0, 670.0, 440.0, 380.0, 290.0, 790.0, 1110.0, 850.0, 1140.0, 100.0, 290.0, 815.0, 470.0, 1045.0, 945.0, 370.0, 190.0, 110.0, 550.0, 600.0, 310.0, 530.0, 450.0, 1030.0, 140.0, 300.0, 220.0, 360.0, 1150.0, 90.0, 1430.0, 1050.0, 350.0, 770.0, 470.0, 640.0, 415.0, 510.0, 530.0, 300.0, 400.0, 170.0, 600.0, 1030.0, 480.0, 1030.0, 540.0, 230.0, 650.0, 370.0, 840.0, 150.0, 350.0, 1080.0, 1280.0, 720.0, 160.0, 530.0, 360.0, 720.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 20.0, 80.0, 10.0, 70.0, 0.0, 30.0, 0.0, 0.0, 10.0, 50.0, 20.0, 10.0, 15.0, 70.0, 40.0, 10.0, 210.0, 180.0, 0.0, 15.0, 70.0, 80.0, 160.0, 245.0, 40.0, 30.0, 20.0, 40.0, 270.0, 30.0, 20.0, 10.0, 520.0, 60.0, 60.0, 20.0, 20.0, 30.0, 10.0, 160.0, 20.0, 0.0, 10.0, 0.0, 10.0, 40.0, -30.0, 70.0, 50.0, 40.0, 0.0, 15.0, 40.0, 0.0, 70.0, 10.0, 40.0, 160.0, 40.0, 20.0, 80.0, 370.0, 250.0, 40.0, 40.0, 20.0, 30.0, 30.0, -10.0, 30.0, 80.0, 40.0, 20.0, 30.0, 30.0, 290.0, 160.0, 20.0, 0.0, 20.0, 90.0, 210.0, 170.0, 70.0, 80.0, 80.0, 40.0, 270.0, 40.0, 0.0, 190.0, 30.0, 40.0, 40.0, 20.0, 10.0, 30.0, 20.0, 0.0, 150.0, 0.0, 10.0, 40.0, 0.0, 60.0, 170.0, 0.0, 40.0, 30.0, 100.0, 470.0, 20.0, 0.0, 30.0, 20.0, 10.0, 20.0, 10.0, 0.0, 80.0, 30.0, 30.0, 30.0, 360.0, 160.0, 20.0, 30.0, 10.0, 30.0, 10.0, 0.0, 20.0, 20.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 180.0, 0.0, 30.0, 0.0, 10.0, 90.0, 30.0, 90.0, 30.0, 0.0, 70.0, 40.0, 70.0, 130.0, 10.0, 10.0, 30.0, 120.0, 40.0, 10.0, 360.0, 100.0, 30.0, 0.0, 110.0, 10.0, 60.0, 50.0, 0.0, 0.0, 190.0, 60.0, 20.0, 0.0, 20.0, 50.0, 20.0, 40.0, 40.0, 60.0, 250.0, 10.0, 10.0, 30.0, 60.0, 30.0, 20.0, 10.0, 70.0, 20.0, 40.0, 0.0, 10.0, 0.0, 40.0, 0.0, 50.0, 100.0, 0.0, 30.0, 80.0, 60.0, 50.0, 30.0, 170.0, 20.0, 20.0, 180.0, 50.0, 20.0, 100.0, 0.0, 10.0, 0.0, 10.0, 40.0, 110.0, 0.0, 0.0, 50.0, 0.0, -5.0, 70.0, 10.0, 10.0, 160.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 170.0, 20.0, 10.0, 30.0, 0.0, 40.0, 40.0, 20.0, 10.0, 200.0, 20.0, 70.0, 20.0, 30.0, 200.0, 50.0, 30.0, 10.0, 70.0, 570.0, 50.0, 90.0, 0.0, 260.0, 50.0, 20.0, 30.0, 20.0, 150.0, 0.0, 20.0, 0.0, 30.0, 0.0, 20.0, -5.0, 40.0, 20.0, 40.0, 0.0, 0.0, 120.0, 40.0, 0.0, 0.0, 5.0, 0.0, 10.0, 30.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 150.0, 0.0, 0.0, 40.0, 10.0, 10.0, 70.0, 0.0, 30.0, 0.0, 40.0, 20.0, 60.0, 100.0, 10.0, 20.0, 20.0, 0.0, 40.0, 70.0, 190.0, 200.0, 0.0, 0.0, 10.0, 10.0, 10.0, 40.0, 0.0, 30.0, 0.0, 30.0, 160.0, 40.0, 30.0, 0.0, 10.0, 70.0, 80.0, 110.0, 10.0, 40.0, 160.0, 10.0, 180.0, 60.0, 70.0, 50.0, 10.0, 360.0, 40.0, 350.0, 50.0, 40.0, -20.0, 60.0, 30.0, 160.0, 10.0, 50.0, 30.0, 30.0, 50.0, 50.0, 0.0, 40.0, 100.0, 10.0, 0.0, 30.0, 60.0, 40.0, 20.0, 170.0, 130.0, 30.0, 150.0, 30.0, 40.0, 30.0, 20.0, 30.0, 20.0, 0.0, 0.0, 20.0, 40.0, 0.0, 40.0, 20.0, 10.0, 10.0, 90.0, 270.0, 20.0, 20.0, 80.0, 20.0, 0.0, 30.0, 30.0, -150.0, 10.0, 40.0, 40.0, 30.0, 230.0, 0.0, 100.0, 70.0, 70.0, 60.0, 200.0, 30.0, 470.0, -40.0, 170.0, -10.0, 10.0, 80.0, 0.0, 160.0, 10.0, 70.0, 80.0, 90.0, 200.0, 30.0, 20.0, 10.0, 10.0, 10.0, 30.0, 20.0, 30.0, 0.0, 50.0, 160.0, 60.0, 70.0, 10.0, 20.0, 260.0, 0.0, 0.0, 20.0, 30.0, 0.0, 10.0, 30.0, 20.0, 60.0, 40.0, 0.0, 20.0, 40.0, 0.0, 60.0, 40.0, 10.0, 60.0, 80.0, 10.0, 30.0, 450.0, 90.0, 10.0, 10.0, 10.0, 40.0, 150.0, 270.0, 0.0, 40.0, 40.0, 10.0, 370.0, 50.0, 180.0, 0.0, 70.0, 380.0, 0.0, 20.0, 40.0, -10.0, 30.0, 30.0, 200.0, 90.0, 480.0, 20.0, 45.0, 270.0, 280.0, 30.0, -20.0, 30.0, 80.0, -75.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 40.0, 20.0, 0.0, 0.0, 0.0, 160.0, 10.0, 60.0, 0.0, 40.0, 0.0, 20.0, 100.0, 170.0, 5.0, -20.0, 200.0, 20.0, 50.0, 20.0, 250.0, 120.0, 0.0, 80.0, 80.0, 40.0, 40.0, 20.0, 10.0, 80.0, 0.0, 590.0, -25.0, 250.0, 20.0, 150.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 160.0, 40.0, 10.0, 600.0, 5.0, 50.0, 20.0, 50.0, 30.0, 30.0, 70.0, 30.0, 10.0, 20.0, 100.0, 0.0, 50.0, 30.0, 30.0, 0.0, 20.0, 30.0, 10.0, 20.0, 30.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 0.0, 40.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 160.0, 50.0, 0.0, 150.0, 120.0, 20.0, 0.0, 40.0, 40.0, 10.0, 0.0, 20.0, 40.0, 20.0, 170.0, 10.0, 290.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 40.0, 0.0, 0.0, 180.0, 40.0, 0.0, 80.0, 20.0, 120.0, 10.0, 50.0, 20.0, 40.0, 20.0, 170.0, 30.0, 280.0, 20.0, 0.0, 50.0, 20.0, 0.0, 30.0, 10.0, 10.0, 20.0, 20.0, 70.0, 270.0, 20.0, 70.0, 10.0, 30.0, 330.0, 190.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 30.0, 60.0, 40.0, 0.0, 0.0, 30.0, 20.0, 30.0, -170.0, 30.0, 40.0, 280.0, 40.0, 10.0, 10.0, 40.0, 40.0, 0.0, 50.0, 0.0, 20.0, 10.0, 20.0, 60.0, 160.0, 0.0, 0.0, 30.0, 10.0, 60.0, 0.0, 20.0, 100.0, 160.0, 230.0, 60.0, 40.0, 220.0, 0.0, -10.0, 280.0, 70.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 80.0, 450.0, -20.0, 70.0, 70.0, 510.0, 90.0, 20.0, 80.0, 80.0, 120.0, 180.0, 80.0, 30.0, 20.0, 160.0, 130.0, 20.0, 280.0, 30.0, 40.0, 60.0, 50.0, 10.0, 10.0, 0.0, 0.0, 60.0, 120.0, 0.0, 40.0, 100.0, 90.0, 350.0, 100.0, 0.0, 20.0, 10.0, 30.0, 30.0, 0.0, 60.0, 0.0, 30.0, -40.0, 90.0, 170.0, 90.0, 30.0, 40.0, 40.0, 150.0, 370.0, 0.0, 0.0, -20.0, 40.0, 40.0, 10.0, 10.0, 30.0, 40.0, 0.0, 20.0, 15.0, 0.0, 10.0, 60.0, 70.0, 170.0, 30.0, 250.0, 20.0, 20.0, 40.0, 40.0, 30.0, 60.0, 10.0, 10.0, 80.0, 250.0, 50.0, 10.0, 0.0, 0.0, 30.0, 10.0, 10.0, 90.0, 20.0, 0.0, 30.0, 0.0, 20.0, 20.0, 40.0, 10.0, 60.0, 100.0, 40.0, 180.0, 80.0, 30.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 20.0, 0.0, 70.0, 0.0, 20.0, 10.0, 20.0, 10.0, 10.0, 10.0, 30.0, 0.0, 60.0, 0.0, 140.0, 20.0, 90.0, 30.0, 160.0, 70.0, 0.0, 70.0, 10.0, 150.0, 210.0, 100.0, 30.0, 400.0, 50.0, 10.0, 30.0, 0.0, 70.0, 50.0, 30.0, 30.0, 30.0, 20.0, 180.0, 40.0, 30.0, 120.0, 670.0, -30.0, -30.0, 20.0, 80.0, 90.0, -30.0, 110.0, 20.0, 0.0, 360.0, 30.0, 80.0, 0.0, 0.0, 0.0, 40.0, 10.0, 70.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 20.0, 70.0, 10.0, 0.0, 20.0, 40.0, 380.0, 10.0, 10.0, 10.0, 150.0, 0.0, 30.0, 70.0, 0.0, 50.0, 60.0, 20.0, 30.0, 70.0, 0.0, 40.0, 30.0, 30.0, 30.0, 80.0, 440.0, 30.0, 40.0, 40.0, 110.0, 20.0, 20.0, 20.0, 20.0, 0.0, 30.0, 0.0, 30.0, 10.0, 0.0, 30.0, 10.0, 30.0, 30.0, 0.0, 10.0, 0.0, 20.0, 30.0, 40.0, 110.0, 80.0, 0.0, 20.0, 30.0, 10.0, 460.0, 60.0, 30.0, 50.0, 350.0, 70.0, -20.0, 40.0, 50.0, 170.0, 20.0, 470.0, 500.0, -30.0, 70.0, 10.0, 0.0, 10.0, 0.0, 0.0, 510.0, 110.0, 0.0, 10.0, 20.0, 60.0, 20.0, 0.0, 40.0, 20.0, 30.0, 10.0, 0.0, 10.0, 20.0, 10.0, 30.0, 380.0, 0.0, 20.0, 10.0, 20.0, 20.0, 10.0, 0.0, 40.0, 30.0, 10.0, 10.0, 10.0, 10.0, 210.0, 10.0, 10.0, 10.0, 50.0, 0.0, 0.0, 20.0, 40.0, 40.0, 570.0, 10.0, -30.0, 40.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4413865594318214, "mean_inference_ms": 1.6411288036522658, "mean_action_processing_ms": 0.42530323366499523, "mean_env_wait_ms": 1.3185275305849555, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05730009078979492, "StateBufferConnector_ms": 0.009743928909301758, "ViewRequirementAgentConnector_ms": 0.3954956531524658}, "num_episodes": 18, "episode_return_max": 1430.0, "episode_return_min": 90.0, "episode_return_mean": 559.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 35.776179697566654, "num_env_steps_trained_throughput_per_sec": 35.776179697566654, "timesteps_total": 408000, "num_env_steps_sampled_lifetime": 408000, "num_agent_steps_sampled_lifetime": 4080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4080000, "timers": {"training_iteration_time_ms": 110095.929, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110095.881, "sample_time_ms": 2417.026, "learn_time_ms": 107658.807, "learn_throughput": 37.154, "synch_weights_time_ms": 11.263}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 4080000, "num_agent_steps_trained": 4080000}, "done": false, "training_iteration": 102, "trial_id": "57140_00000", "date": "2024-06-27_02-27-20", "timestamp": 1719469640, "time_this_iter_s": 111.82074189186096, "time_total_s": 11566.165279865265, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23a7ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11566.165279865265, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 20.467088607594935, "ram_util_percent": 78.92025316455695}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5027398369563656, "cur_kl_coeff": 5.845177845843138, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002342855626247581, "vf_loss": 3.8514356473510385, "vf_explained_var": 0.00012151377396588635, "kl": Infinity, "entropy": 0.4020021807652312, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 962475.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000}, "env_runners": {"episode_reward_max": 1430.0, "episode_reward_min": 50.0, "episode_reward_mean": 555.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -185.0}, "policy_reward_max": {"policy_0": 670.0}, "policy_reward_mean": {"policy_0": 55.56}, "custom_metrics": {}, "hist_stats": {"episode_reward": [265.0, 270.0, 650.0, 1180.0, 290.0, 255.0, 95.0, 310.0, 380.0, 490.0, 530.0, 950.0, 770.0, 340.0, 700.0, 190.0, 550.0, 400.0, 1040.0, 670.0, 440.0, 380.0, 290.0, 790.0, 1110.0, 850.0, 1140.0, 100.0, 290.0, 815.0, 470.0, 1045.0, 945.0, 370.0, 190.0, 110.0, 550.0, 600.0, 310.0, 530.0, 450.0, 1030.0, 140.0, 300.0, 220.0, 360.0, 1150.0, 90.0, 1430.0, 1050.0, 350.0, 770.0, 470.0, 640.0, 415.0, 510.0, 530.0, 300.0, 400.0, 170.0, 600.0, 1030.0, 480.0, 1030.0, 540.0, 230.0, 650.0, 370.0, 840.0, 150.0, 350.0, 1080.0, 1280.0, 720.0, 160.0, 530.0, 360.0, 720.0, 760.0, 230.0, 680.0, 800.0, 375.0, 980.0, 410.0, 890.0, 960.0, 950.0, 530.0, 430.0, 550.0, 380.0, 540.0, 330.0, 440.0, 350.0, 520.0, 50.0, 660.0, 200.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, -5.0, 70.0, 10.0, 10.0, 160.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 30.0, 10.0, 0.0, 170.0, 20.0, 10.0, 30.0, 0.0, 40.0, 40.0, 20.0, 10.0, 200.0, 20.0, 70.0, 20.0, 30.0, 200.0, 50.0, 30.0, 10.0, 70.0, 570.0, 50.0, 90.0, 0.0, 260.0, 50.0, 20.0, 30.0, 20.0, 150.0, 0.0, 20.0, 0.0, 30.0, 0.0, 20.0, -5.0, 40.0, 20.0, 40.0, 0.0, 0.0, 120.0, 40.0, 0.0, 0.0, 5.0, 0.0, 10.0, 30.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 150.0, 0.0, 0.0, 40.0, 10.0, 10.0, 70.0, 0.0, 30.0, 0.0, 40.0, 20.0, 60.0, 100.0, 10.0, 20.0, 20.0, 0.0, 40.0, 70.0, 190.0, 200.0, 0.0, 0.0, 10.0, 10.0, 10.0, 40.0, 0.0, 30.0, 0.0, 30.0, 160.0, 40.0, 30.0, 0.0, 10.0, 70.0, 80.0, 110.0, 10.0, 40.0, 160.0, 10.0, 180.0, 60.0, 70.0, 50.0, 10.0, 360.0, 40.0, 350.0, 50.0, 40.0, -20.0, 60.0, 30.0, 160.0, 10.0, 50.0, 30.0, 30.0, 50.0, 50.0, 0.0, 40.0, 100.0, 10.0, 0.0, 30.0, 60.0, 40.0, 20.0, 170.0, 130.0, 30.0, 150.0, 30.0, 40.0, 30.0, 20.0, 30.0, 20.0, 0.0, 0.0, 20.0, 40.0, 0.0, 40.0, 20.0, 10.0, 10.0, 90.0, 270.0, 20.0, 20.0, 80.0, 20.0, 0.0, 30.0, 30.0, -150.0, 10.0, 40.0, 40.0, 30.0, 230.0, 0.0, 100.0, 70.0, 70.0, 60.0, 200.0, 30.0, 470.0, -40.0, 170.0, -10.0, 10.0, 80.0, 0.0, 160.0, 10.0, 70.0, 80.0, 90.0, 200.0, 30.0, 20.0, 10.0, 10.0, 10.0, 30.0, 20.0, 30.0, 0.0, 50.0, 160.0, 60.0, 70.0, 10.0, 20.0, 260.0, 0.0, 0.0, 20.0, 30.0, 0.0, 10.0, 30.0, 20.0, 60.0, 40.0, 0.0, 20.0, 40.0, 0.0, 60.0, 40.0, 10.0, 60.0, 80.0, 10.0, 30.0, 450.0, 90.0, 10.0, 10.0, 10.0, 40.0, 150.0, 270.0, 0.0, 40.0, 40.0, 10.0, 370.0, 50.0, 180.0, 0.0, 70.0, 380.0, 0.0, 20.0, 40.0, -10.0, 30.0, 30.0, 200.0, 90.0, 480.0, 20.0, 45.0, 270.0, 280.0, 30.0, -20.0, 30.0, 80.0, -75.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 40.0, 20.0, 0.0, 0.0, 0.0, 160.0, 10.0, 60.0, 0.0, 40.0, 0.0, 20.0, 100.0, 170.0, 5.0, -20.0, 200.0, 20.0, 50.0, 20.0, 250.0, 120.0, 0.0, 80.0, 80.0, 40.0, 40.0, 20.0, 10.0, 80.0, 0.0, 590.0, -25.0, 250.0, 20.0, 150.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 160.0, 40.0, 10.0, 600.0, 5.0, 50.0, 20.0, 50.0, 30.0, 30.0, 70.0, 30.0, 10.0, 20.0, 100.0, 0.0, 50.0, 30.0, 30.0, 0.0, 20.0, 30.0, 10.0, 20.0, 30.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 0.0, 40.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 160.0, 50.0, 0.0, 150.0, 120.0, 20.0, 0.0, 40.0, 40.0, 10.0, 0.0, 20.0, 40.0, 20.0, 170.0, 10.0, 290.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 40.0, 0.0, 0.0, 180.0, 40.0, 0.0, 80.0, 20.0, 120.0, 10.0, 50.0, 20.0, 40.0, 20.0, 170.0, 30.0, 280.0, 20.0, 0.0, 50.0, 20.0, 0.0, 30.0, 10.0, 10.0, 20.0, 20.0, 70.0, 270.0, 20.0, 70.0, 10.0, 30.0, 330.0, 190.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 30.0, 60.0, 40.0, 0.0, 0.0, 30.0, 20.0, 30.0, -170.0, 30.0, 40.0, 280.0, 40.0, 10.0, 10.0, 40.0, 40.0, 0.0, 50.0, 0.0, 20.0, 10.0, 20.0, 60.0, 160.0, 0.0, 0.0, 30.0, 10.0, 60.0, 0.0, 20.0, 100.0, 160.0, 230.0, 60.0, 40.0, 220.0, 0.0, -10.0, 280.0, 70.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 80.0, 450.0, -20.0, 70.0, 70.0, 510.0, 90.0, 20.0, 80.0, 80.0, 120.0, 180.0, 80.0, 30.0, 20.0, 160.0, 130.0, 20.0, 280.0, 30.0, 40.0, 60.0, 50.0, 10.0, 10.0, 0.0, 0.0, 60.0, 120.0, 0.0, 40.0, 100.0, 90.0, 350.0, 100.0, 0.0, 20.0, 10.0, 30.0, 30.0, 0.0, 60.0, 0.0, 30.0, -40.0, 90.0, 170.0, 90.0, 30.0, 40.0, 40.0, 150.0, 370.0, 0.0, 0.0, -20.0, 40.0, 40.0, 10.0, 10.0, 30.0, 40.0, 0.0, 20.0, 15.0, 0.0, 10.0, 60.0, 70.0, 170.0, 30.0, 250.0, 20.0, 20.0, 40.0, 40.0, 30.0, 60.0, 10.0, 10.0, 80.0, 250.0, 50.0, 10.0, 0.0, 0.0, 30.0, 10.0, 10.0, 90.0, 20.0, 0.0, 30.0, 0.0, 20.0, 20.0, 40.0, 10.0, 60.0, 100.0, 40.0, 180.0, 80.0, 30.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 20.0, 0.0, 70.0, 0.0, 20.0, 10.0, 20.0, 10.0, 10.0, 10.0, 30.0, 0.0, 60.0, 0.0, 140.0, 20.0, 90.0, 30.0, 160.0, 70.0, 0.0, 70.0, 10.0, 150.0, 210.0, 100.0, 30.0, 400.0, 50.0, 10.0, 30.0, 0.0, 70.0, 50.0, 30.0, 30.0, 30.0, 20.0, 180.0, 40.0, 30.0, 120.0, 670.0, -30.0, -30.0, 20.0, 80.0, 90.0, -30.0, 110.0, 20.0, 0.0, 360.0, 30.0, 80.0, 0.0, 0.0, 0.0, 40.0, 10.0, 70.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 20.0, 70.0, 10.0, 0.0, 20.0, 40.0, 380.0, 10.0, 10.0, 10.0, 150.0, 0.0, 30.0, 70.0, 0.0, 50.0, 60.0, 20.0, 30.0, 70.0, 0.0, 40.0, 30.0, 30.0, 30.0, 80.0, 440.0, 30.0, 40.0, 40.0, 110.0, 20.0, 20.0, 20.0, 20.0, 0.0, 30.0, 0.0, 30.0, 10.0, 0.0, 30.0, 10.0, 30.0, 30.0, 0.0, 10.0, 0.0, 20.0, 30.0, 40.0, 110.0, 80.0, 0.0, 20.0, 30.0, 10.0, 460.0, 60.0, 30.0, 50.0, 350.0, 70.0, -20.0, 40.0, 50.0, 170.0, 20.0, 470.0, 500.0, -30.0, 70.0, 10.0, 0.0, 10.0, 0.0, 0.0, 510.0, 110.0, 0.0, 10.0, 20.0, 60.0, 20.0, 0.0, 40.0, 20.0, 30.0, 10.0, 0.0, 10.0, 20.0, 10.0, 30.0, 380.0, 0.0, 20.0, 10.0, 20.0, 20.0, 10.0, 0.0, 40.0, 30.0, 10.0, 10.0, 10.0, 10.0, 210.0, 10.0, 10.0, 10.0, 50.0, 0.0, 0.0, 20.0, 40.0, 40.0, 570.0, 10.0, -30.0, 40.0, 30.0, 70.0, 50.0, 10.0, 10.0, 10.0, 0.0, 70.0, 20.0, 480.0, 40.0, 20.0, 50.0, 0.0, 20.0, 40.0, 10.0, 40.0, 40.0, 10.0, 0.0, 20.0, 60.0, 120.0, 120.0, 40.0, 170.0, 30.0, 70.0, 20.0, 30.0, 50.0, 30.0, 50.0, 30.0, 370.0, 70.0, 0.0, 90.0, 30.0, 80.0, 5.0, 20.0, 0.0, 30.0, 0.0, 0.0, 220.0, 20.0, 70.0, 10.0, 10.0, 140.0, 0.0, 250.0, 410.0, 20.0, 20.0, 40.0, 30.0, 60.0, 40.0, 80.0, 70.0, 30.0, 0.0, 50.0, 80.0, 10.0, 30.0, 20.0, 40.0, 100.0, 60.0, 80.0, 0.0, 20.0, 490.0, 50.0, 20.0, 30.0, 80.0, 100.0, 110.0, 30.0, 0.0, 20.0, 450.0, 20.0, 110.0, 40.0, 90.0, 170.0, 310.0, 70.0, 30.0, 10.0, 20.0, 170.0, 30.0, 50.0, 250.0, 20.0, 0.0, 150.0, 30.0, 40.0, 0.0, 20.0, 20.0, 0.0, 20.0, 0.0, 0.0, 90.0, 10.0, -50.0, -40.0, 360.0, 0.0, 40.0, 50.0, 40.0, 10.0, 0.0, 360.0, 20.0, 0.0, 30.0, 30.0, 10.0, 10.0, 30.0, 0.0, 40.0, 30.0, 10.0, 20.0, 20.0, 0.0, 220.0, 40.0, 40.0, 60.0, 150.0, 0.0, 10.0, 10.0, 190.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 20.0, 40.0, 90.0, 30.0, 150.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, 60.0, 40.0, 70.0, 190.0, 10.0, 10.0, 150.0, 20.0, 60.0, 30.0, 10.0, 0.0, 40.0, 20.0, 10.0, 30.0, 40.0, 10.0, 10.0, 0.0, 10.0, 380.0, 0.0, 20.0, 20.0, -185.0, 90.0, -25.0, 180.0, 40.0, 10.0, 40.0, 0.0, -80.0, -20.0, 10.0, 40.0, 60.0, 100.0, 0.0, 30.0, 60.0, 80.0, 10.0, 270.0, 0.0, 10.0, 30.0, 30.0, 30.0, 10.0, 30.0, 0.0, 30.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4435812703443356, "mean_inference_ms": 1.6472671308823106, "mean_action_processing_ms": 0.4265685023451369, "mean_env_wait_ms": 1.3206537954673063, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05765867233276367, "StateBufferConnector_ms": 0.009898900985717773, "ViewRequirementAgentConnector_ms": 0.395815372467041}, "num_episodes": 22, "episode_return_max": 1430.0, "episode_return_min": 50.0, "episode_return_mean": 555.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.16510773031286, "num_env_steps_trained_throughput_per_sec": 36.16510773031286, "timesteps_total": 412000, "num_env_steps_sampled_lifetime": 412000, "num_agent_steps_sampled_lifetime": 4120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4120000, "timers": {"training_iteration_time_ms": 110118.422, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110118.373, "sample_time_ms": 2423.067, "learn_time_ms": 107675.283, "learn_throughput": 37.149, "synch_weights_time_ms": 11.354}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 4120000, "num_agent_steps_trained": 4120000}, "done": false, "training_iteration": 103, "trial_id": "57140_00000", "date": "2024-06-27_02-29-11", "timestamp": 1719469751, "time_this_iter_s": 110.6158390045166, "time_total_s": 11676.781118869781, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b25c2d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11676.781118869781, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 16.202547770700637, "ram_util_percent": 79.4592356687898}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2306347070347132, "cur_kl_coeff": 8.767766768764703, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0024965684396151305, "vf_loss": 4.709991667090386, "vf_explained_var": 0.0006446101921942795, "kl": Infinity, "entropy": 0.34619894266382445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 971865.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000}, "env_runners": {"episode_reward_max": 1610.0, "episode_reward_min": 50.0, "episode_reward_mean": 592.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -185.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 59.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1040.0, 670.0, 440.0, 380.0, 290.0, 790.0, 1110.0, 850.0, 1140.0, 100.0, 290.0, 815.0, 470.0, 1045.0, 945.0, 370.0, 190.0, 110.0, 550.0, 600.0, 310.0, 530.0, 450.0, 1030.0, 140.0, 300.0, 220.0, 360.0, 1150.0, 90.0, 1430.0, 1050.0, 350.0, 770.0, 470.0, 640.0, 415.0, 510.0, 530.0, 300.0, 400.0, 170.0, 600.0, 1030.0, 480.0, 1030.0, 540.0, 230.0, 650.0, 370.0, 840.0, 150.0, 350.0, 1080.0, 1280.0, 720.0, 160.0, 530.0, 360.0, 720.0, 760.0, 230.0, 680.0, 800.0, 375.0, 980.0, 410.0, 890.0, 960.0, 950.0, 530.0, 430.0, 550.0, 380.0, 540.0, 330.0, 440.0, 350.0, 520.0, 50.0, 660.0, 200.0, 630.0, 200.0, 280.0, 760.0, 940.0, 640.0, 440.0, 570.0, 390.0, 750.0, 570.0, 80.0, 1610.0, 590.0, 1070.0, 760.0, 1280.0, 760.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 60.0, 200.0, 30.0, 470.0, -40.0, 170.0, -10.0, 10.0, 80.0, 0.0, 160.0, 10.0, 70.0, 80.0, 90.0, 200.0, 30.0, 20.0, 10.0, 10.0, 10.0, 30.0, 20.0, 30.0, 0.0, 50.0, 160.0, 60.0, 70.0, 10.0, 20.0, 260.0, 0.0, 0.0, 20.0, 30.0, 0.0, 10.0, 30.0, 20.0, 60.0, 40.0, 0.0, 20.0, 40.0, 0.0, 60.0, 40.0, 10.0, 60.0, 80.0, 10.0, 30.0, 450.0, 90.0, 10.0, 10.0, 10.0, 40.0, 150.0, 270.0, 0.0, 40.0, 40.0, 10.0, 370.0, 50.0, 180.0, 0.0, 70.0, 380.0, 0.0, 20.0, 40.0, -10.0, 30.0, 30.0, 200.0, 90.0, 480.0, 20.0, 45.0, 270.0, 280.0, 30.0, -20.0, 30.0, 80.0, -75.0, 20.0, 0.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 40.0, 20.0, 0.0, 0.0, 0.0, 160.0, 10.0, 60.0, 0.0, 40.0, 0.0, 20.0, 100.0, 170.0, 5.0, -20.0, 200.0, 20.0, 50.0, 20.0, 250.0, 120.0, 0.0, 80.0, 80.0, 40.0, 40.0, 20.0, 10.0, 80.0, 0.0, 590.0, -25.0, 250.0, 20.0, 150.0, 20.0, 10.0, 10.0, 10.0, 10.0, 10.0, 0.0, 160.0, 40.0, 10.0, 600.0, 5.0, 50.0, 20.0, 50.0, 30.0, 30.0, 70.0, 30.0, 10.0, 20.0, 100.0, 0.0, 50.0, 30.0, 30.0, 0.0, 20.0, 30.0, 10.0, 20.0, 30.0, 20.0, 20.0, 10.0, 20.0, 10.0, 10.0, 0.0, 40.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 10.0, 160.0, 50.0, 0.0, 150.0, 120.0, 20.0, 0.0, 40.0, 40.0, 10.0, 0.0, 20.0, 40.0, 20.0, 170.0, 10.0, 290.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 40.0, 0.0, 0.0, 180.0, 40.0, 0.0, 80.0, 20.0, 120.0, 10.0, 50.0, 20.0, 40.0, 20.0, 170.0, 30.0, 280.0, 20.0, 0.0, 50.0, 20.0, 0.0, 30.0, 10.0, 10.0, 20.0, 20.0, 70.0, 270.0, 20.0, 70.0, 10.0, 30.0, 330.0, 190.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 30.0, 60.0, 40.0, 0.0, 0.0, 30.0, 20.0, 30.0, -170.0, 30.0, 40.0, 280.0, 40.0, 10.0, 10.0, 40.0, 40.0, 0.0, 50.0, 0.0, 20.0, 10.0, 20.0, 60.0, 160.0, 0.0, 0.0, 30.0, 10.0, 60.0, 0.0, 20.0, 100.0, 160.0, 230.0, 60.0, 40.0, 220.0, 0.0, -10.0, 280.0, 70.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 80.0, 450.0, -20.0, 70.0, 70.0, 510.0, 90.0, 20.0, 80.0, 80.0, 120.0, 180.0, 80.0, 30.0, 20.0, 160.0, 130.0, 20.0, 280.0, 30.0, 40.0, 60.0, 50.0, 10.0, 10.0, 0.0, 0.0, 60.0, 120.0, 0.0, 40.0, 100.0, 90.0, 350.0, 100.0, 0.0, 20.0, 10.0, 30.0, 30.0, 0.0, 60.0, 0.0, 30.0, -40.0, 90.0, 170.0, 90.0, 30.0, 40.0, 40.0, 150.0, 370.0, 0.0, 0.0, -20.0, 40.0, 40.0, 10.0, 10.0, 30.0, 40.0, 0.0, 20.0, 15.0, 0.0, 10.0, 60.0, 70.0, 170.0, 30.0, 250.0, 20.0, 20.0, 40.0, 40.0, 30.0, 60.0, 10.0, 10.0, 80.0, 250.0, 50.0, 10.0, 0.0, 0.0, 30.0, 10.0, 10.0, 90.0, 20.0, 0.0, 30.0, 0.0, 20.0, 20.0, 40.0, 10.0, 60.0, 100.0, 40.0, 180.0, 80.0, 30.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 20.0, 0.0, 70.0, 0.0, 20.0, 10.0, 20.0, 10.0, 10.0, 10.0, 30.0, 0.0, 60.0, 0.0, 140.0, 20.0, 90.0, 30.0, 160.0, 70.0, 0.0, 70.0, 10.0, 150.0, 210.0, 100.0, 30.0, 400.0, 50.0, 10.0, 30.0, 0.0, 70.0, 50.0, 30.0, 30.0, 30.0, 20.0, 180.0, 40.0, 30.0, 120.0, 670.0, -30.0, -30.0, 20.0, 80.0, 90.0, -30.0, 110.0, 20.0, 0.0, 360.0, 30.0, 80.0, 0.0, 0.0, 0.0, 40.0, 10.0, 70.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 20.0, 70.0, 10.0, 0.0, 20.0, 40.0, 380.0, 10.0, 10.0, 10.0, 150.0, 0.0, 30.0, 70.0, 0.0, 50.0, 60.0, 20.0, 30.0, 70.0, 0.0, 40.0, 30.0, 30.0, 30.0, 80.0, 440.0, 30.0, 40.0, 40.0, 110.0, 20.0, 20.0, 20.0, 20.0, 0.0, 30.0, 0.0, 30.0, 10.0, 0.0, 30.0, 10.0, 30.0, 30.0, 0.0, 10.0, 0.0, 20.0, 30.0, 40.0, 110.0, 80.0, 0.0, 20.0, 30.0, 10.0, 460.0, 60.0, 30.0, 50.0, 350.0, 70.0, -20.0, 40.0, 50.0, 170.0, 20.0, 470.0, 500.0, -30.0, 70.0, 10.0, 0.0, 10.0, 0.0, 0.0, 510.0, 110.0, 0.0, 10.0, 20.0, 60.0, 20.0, 0.0, 40.0, 20.0, 30.0, 10.0, 0.0, 10.0, 20.0, 10.0, 30.0, 380.0, 0.0, 20.0, 10.0, 20.0, 20.0, 10.0, 0.0, 40.0, 30.0, 10.0, 10.0, 10.0, 10.0, 210.0, 10.0, 10.0, 10.0, 50.0, 0.0, 0.0, 20.0, 40.0, 40.0, 570.0, 10.0, -30.0, 40.0, 30.0, 70.0, 50.0, 10.0, 10.0, 10.0, 0.0, 70.0, 20.0, 480.0, 40.0, 20.0, 50.0, 0.0, 20.0, 40.0, 10.0, 40.0, 40.0, 10.0, 0.0, 20.0, 60.0, 120.0, 120.0, 40.0, 170.0, 30.0, 70.0, 20.0, 30.0, 50.0, 30.0, 50.0, 30.0, 370.0, 70.0, 0.0, 90.0, 30.0, 80.0, 5.0, 20.0, 0.0, 30.0, 0.0, 0.0, 220.0, 20.0, 70.0, 10.0, 10.0, 140.0, 0.0, 250.0, 410.0, 20.0, 20.0, 40.0, 30.0, 60.0, 40.0, 80.0, 70.0, 30.0, 0.0, 50.0, 80.0, 10.0, 30.0, 20.0, 40.0, 100.0, 60.0, 80.0, 0.0, 20.0, 490.0, 50.0, 20.0, 30.0, 80.0, 100.0, 110.0, 30.0, 0.0, 20.0, 450.0, 20.0, 110.0, 40.0, 90.0, 170.0, 310.0, 70.0, 30.0, 10.0, 20.0, 170.0, 30.0, 50.0, 250.0, 20.0, 0.0, 150.0, 30.0, 40.0, 0.0, 20.0, 20.0, 0.0, 20.0, 0.0, 0.0, 90.0, 10.0, -50.0, -40.0, 360.0, 0.0, 40.0, 50.0, 40.0, 10.0, 0.0, 360.0, 20.0, 0.0, 30.0, 30.0, 10.0, 10.0, 30.0, 0.0, 40.0, 30.0, 10.0, 20.0, 20.0, 0.0, 220.0, 40.0, 40.0, 60.0, 150.0, 0.0, 10.0, 10.0, 190.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 20.0, 40.0, 90.0, 30.0, 150.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, 60.0, 40.0, 70.0, 190.0, 10.0, 10.0, 150.0, 20.0, 60.0, 30.0, 10.0, 0.0, 40.0, 20.0, 10.0, 30.0, 40.0, 10.0, 10.0, 0.0, 10.0, 380.0, 0.0, 20.0, 20.0, -185.0, 90.0, -25.0, 180.0, 40.0, 10.0, 40.0, 0.0, -80.0, -20.0, 10.0, 40.0, 60.0, 100.0, 0.0, 30.0, 60.0, 80.0, 10.0, 270.0, 0.0, 10.0, 30.0, 30.0, 30.0, 10.0, 30.0, 0.0, 30.0, 30.0, 50.0, 20.0, 90.0, 20.0, 50.0, 20.0, 10.0, 250.0, 70.0, 50.0, -40.0, 0.0, 60.0, 160.0, 0.0, 0.0, 20.0, -30.0, 30.0, 0.0, 0.0, 0.0, 40.0, 0.0, 70.0, 10.0, 20.0, 10.0, 50.0, 80.0, 20.0, 40.0, 60.0, 200.0, 30.0, 40.0, 90.0, 20.0, 240.0, 20.0, 50.0, 10.0, 100.0, 40.0, 10.0, 0.0, 50.0, 40.0, 110.0, 530.0, 20.0, 20.0, 70.0, 300.0, 20.0, 10.0, 0.0, 160.0, 0.0, 40.0, 10.0, 10.0, 20.0, 40.0, 70.0, 110.0, 60.0, 40.0, 40.0, 40.0, 20.0, 70.0, 60.0, 40.0, 30.0, 20.0, 60.0, 20.0, 200.0, 50.0, 0.0, 90.0, 40.0, 180.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 210.0, 170.0, 60.0, 10.0, 180.0, 20.0, 10.0, 50.0, 40.0, 0.0, 40.0, 0.0, -10.0, 0.0, 360.0, 0.0, 20.0, 20.0, 110.0, 30.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 220.0, 550.0, 100.0, 500.0, 20.0, 10.0, 50.0, 110.0, 20.0, 30.0, 90.0, 20.0, 10.0, 40.0, 0.0, 30.0, 50.0, 50.0, 10.0, 290.0, 30.0, 60.0, 0.0, 80.0, 30.0, 700.0, 110.0, 20.0, 0.0, 40.0, 90.0, 10.0, 40.0, -50.0, 460.0, 160.0, -20.0, 0.0, 20.0, 50.0, 0.0, 270.0, 130.0, 670.0, 80.0, 10.0, 20.0, 40.0, -10.0, 70.0, 100.0, 0.0, 10.0, 200.0, 40.0, 0.0, 40.0, 310.0, 20.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4391905954500956, "mean_inference_ms": 1.6393699037075742, "mean_action_processing_ms": 0.42464705129359925, "mean_env_wait_ms": 1.317099924365518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.057492971420288086, "StateBufferConnector_ms": 0.009894609451293945, "ViewRequirementAgentConnector_ms": 0.3833787441253662}, "num_episodes": 18, "episode_return_max": 1610.0, "episode_return_min": 50.0, "episode_return_mean": 592.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 35.90621043622132, "num_env_steps_trained_throughput_per_sec": 35.90621043622132, "timesteps_total": 416000, "num_env_steps_sampled_lifetime": 416000, "num_agent_steps_sampled_lifetime": 4160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4160000, "timers": {"training_iteration_time_ms": 110195.307, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110195.258, "sample_time_ms": 2428.312, "learn_time_ms": 107746.664, "learn_throughput": 37.124, "synch_weights_time_ms": 11.631}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 4160000, "num_agent_steps_trained": 4160000}, "done": false, "training_iteration": 104, "trial_id": "57140_00000", "date": "2024-06-27_02-31-03", "timestamp": 1719469863, "time_this_iter_s": 111.4147219657898, "time_total_s": 11788.195840835571, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af404ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11788.195840835571, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 17.061146496815283, "ram_util_percent": 79.36878980891721}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.311541618801915, "cur_kl_coeff": 13.151650153147054, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0017256805864663614, "vf_loss": 4.064128465215746, "vf_explained_var": 0.0004344631434756473, "kl": Infinity, "entropy": 0.3862011226284872, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 981255.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000}, "env_runners": {"episode_reward_max": 1610.0, "episode_reward_min": 50.0, "episode_reward_mean": 568.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -185.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 56.82}, "custom_metrics": {}, "hist_stats": {"episode_reward": [550.0, 600.0, 310.0, 530.0, 450.0, 1030.0, 140.0, 300.0, 220.0, 360.0, 1150.0, 90.0, 1430.0, 1050.0, 350.0, 770.0, 470.0, 640.0, 415.0, 510.0, 530.0, 300.0, 400.0, 170.0, 600.0, 1030.0, 480.0, 1030.0, 540.0, 230.0, 650.0, 370.0, 840.0, 150.0, 350.0, 1080.0, 1280.0, 720.0, 160.0, 530.0, 360.0, 720.0, 760.0, 230.0, 680.0, 800.0, 375.0, 980.0, 410.0, 890.0, 960.0, 950.0, 530.0, 430.0, 550.0, 380.0, 540.0, 330.0, 440.0, 350.0, 520.0, 50.0, 660.0, 200.0, 630.0, 200.0, 280.0, 760.0, 940.0, 640.0, 440.0, 570.0, 390.0, 750.0, 570.0, 80.0, 1610.0, 590.0, 1070.0, 760.0, 1280.0, 760.0, 240.0, 200.0, 415.0, 455.0, 450.0, 740.0, 240.0, 160.0, 430.0, 250.0, 370.0, 1070.0, 500.0, 580.0, 1130.0, 690.0, 390.0, 290.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 10.0, 160.0, 50.0, 0.0, 150.0, 120.0, 20.0, 0.0, 40.0, 40.0, 10.0, 0.0, 20.0, 40.0, 20.0, 170.0, 10.0, 290.0, 0.0, 0.0, 10.0, 0.0, 20.0, 20.0, 40.0, 0.0, 0.0, 180.0, 40.0, 0.0, 80.0, 20.0, 120.0, 10.0, 50.0, 20.0, 40.0, 20.0, 170.0, 30.0, 280.0, 20.0, 0.0, 50.0, 20.0, 0.0, 30.0, 10.0, 10.0, 20.0, 20.0, 70.0, 270.0, 20.0, 70.0, 10.0, 30.0, 330.0, 190.0, 0.0, 0.0, 10.0, 0.0, 0.0, 20.0, 0.0, 20.0, 30.0, 60.0, 40.0, 0.0, 0.0, 30.0, 20.0, 30.0, -170.0, 30.0, 40.0, 280.0, 40.0, 10.0, 10.0, 40.0, 40.0, 0.0, 50.0, 0.0, 20.0, 10.0, 20.0, 60.0, 160.0, 0.0, 0.0, 30.0, 10.0, 60.0, 0.0, 20.0, 100.0, 160.0, 230.0, 60.0, 40.0, 220.0, 0.0, -10.0, 280.0, 70.0, 10.0, 0.0, 20.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 80.0, 450.0, -20.0, 70.0, 70.0, 510.0, 90.0, 20.0, 80.0, 80.0, 120.0, 180.0, 80.0, 30.0, 20.0, 160.0, 130.0, 20.0, 280.0, 30.0, 40.0, 60.0, 50.0, 10.0, 10.0, 0.0, 0.0, 60.0, 120.0, 0.0, 40.0, 100.0, 90.0, 350.0, 100.0, 0.0, 20.0, 10.0, 30.0, 30.0, 0.0, 60.0, 0.0, 30.0, -40.0, 90.0, 170.0, 90.0, 30.0, 40.0, 40.0, 150.0, 370.0, 0.0, 0.0, -20.0, 40.0, 40.0, 10.0, 10.0, 30.0, 40.0, 0.0, 20.0, 15.0, 0.0, 10.0, 60.0, 70.0, 170.0, 30.0, 250.0, 20.0, 20.0, 40.0, 40.0, 30.0, 60.0, 10.0, 10.0, 80.0, 250.0, 50.0, 10.0, 0.0, 0.0, 30.0, 10.0, 10.0, 90.0, 20.0, 0.0, 30.0, 0.0, 20.0, 20.0, 40.0, 10.0, 60.0, 100.0, 40.0, 180.0, 80.0, 30.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 20.0, 0.0, 70.0, 0.0, 20.0, 10.0, 20.0, 10.0, 10.0, 10.0, 30.0, 0.0, 60.0, 0.0, 140.0, 20.0, 90.0, 30.0, 160.0, 70.0, 0.0, 70.0, 10.0, 150.0, 210.0, 100.0, 30.0, 400.0, 50.0, 10.0, 30.0, 0.0, 70.0, 50.0, 30.0, 30.0, 30.0, 20.0, 180.0, 40.0, 30.0, 120.0, 670.0, -30.0, -30.0, 20.0, 80.0, 90.0, -30.0, 110.0, 20.0, 0.0, 360.0, 30.0, 80.0, 0.0, 0.0, 0.0, 40.0, 10.0, 70.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 20.0, 70.0, 10.0, 0.0, 20.0, 40.0, 380.0, 10.0, 10.0, 10.0, 150.0, 0.0, 30.0, 70.0, 0.0, 50.0, 60.0, 20.0, 30.0, 70.0, 0.0, 40.0, 30.0, 30.0, 30.0, 80.0, 440.0, 30.0, 40.0, 40.0, 110.0, 20.0, 20.0, 20.0, 20.0, 0.0, 30.0, 0.0, 30.0, 10.0, 0.0, 30.0, 10.0, 30.0, 30.0, 0.0, 10.0, 0.0, 20.0, 30.0, 40.0, 110.0, 80.0, 0.0, 20.0, 30.0, 10.0, 460.0, 60.0, 30.0, 50.0, 350.0, 70.0, -20.0, 40.0, 50.0, 170.0, 20.0, 470.0, 500.0, -30.0, 70.0, 10.0, 0.0, 10.0, 0.0, 0.0, 510.0, 110.0, 0.0, 10.0, 20.0, 60.0, 20.0, 0.0, 40.0, 20.0, 30.0, 10.0, 0.0, 10.0, 20.0, 10.0, 30.0, 380.0, 0.0, 20.0, 10.0, 20.0, 20.0, 10.0, 0.0, 40.0, 30.0, 10.0, 10.0, 10.0, 10.0, 210.0, 10.0, 10.0, 10.0, 50.0, 0.0, 0.0, 20.0, 40.0, 40.0, 570.0, 10.0, -30.0, 40.0, 30.0, 70.0, 50.0, 10.0, 10.0, 10.0, 0.0, 70.0, 20.0, 480.0, 40.0, 20.0, 50.0, 0.0, 20.0, 40.0, 10.0, 40.0, 40.0, 10.0, 0.0, 20.0, 60.0, 120.0, 120.0, 40.0, 170.0, 30.0, 70.0, 20.0, 30.0, 50.0, 30.0, 50.0, 30.0, 370.0, 70.0, 0.0, 90.0, 30.0, 80.0, 5.0, 20.0, 0.0, 30.0, 0.0, 0.0, 220.0, 20.0, 70.0, 10.0, 10.0, 140.0, 0.0, 250.0, 410.0, 20.0, 20.0, 40.0, 30.0, 60.0, 40.0, 80.0, 70.0, 30.0, 0.0, 50.0, 80.0, 10.0, 30.0, 20.0, 40.0, 100.0, 60.0, 80.0, 0.0, 20.0, 490.0, 50.0, 20.0, 30.0, 80.0, 100.0, 110.0, 30.0, 0.0, 20.0, 450.0, 20.0, 110.0, 40.0, 90.0, 170.0, 310.0, 70.0, 30.0, 10.0, 20.0, 170.0, 30.0, 50.0, 250.0, 20.0, 0.0, 150.0, 30.0, 40.0, 0.0, 20.0, 20.0, 0.0, 20.0, 0.0, 0.0, 90.0, 10.0, -50.0, -40.0, 360.0, 0.0, 40.0, 50.0, 40.0, 10.0, 0.0, 360.0, 20.0, 0.0, 30.0, 30.0, 10.0, 10.0, 30.0, 0.0, 40.0, 30.0, 10.0, 20.0, 20.0, 0.0, 220.0, 40.0, 40.0, 60.0, 150.0, 0.0, 10.0, 10.0, 190.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 20.0, 40.0, 90.0, 30.0, 150.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, 60.0, 40.0, 70.0, 190.0, 10.0, 10.0, 150.0, 20.0, 60.0, 30.0, 10.0, 0.0, 40.0, 20.0, 10.0, 30.0, 40.0, 10.0, 10.0, 0.0, 10.0, 380.0, 0.0, 20.0, 20.0, -185.0, 90.0, -25.0, 180.0, 40.0, 10.0, 40.0, 0.0, -80.0, -20.0, 10.0, 40.0, 60.0, 100.0, 0.0, 30.0, 60.0, 80.0, 10.0, 270.0, 0.0, 10.0, 30.0, 30.0, 30.0, 10.0, 30.0, 0.0, 30.0, 30.0, 50.0, 20.0, 90.0, 20.0, 50.0, 20.0, 10.0, 250.0, 70.0, 50.0, -40.0, 0.0, 60.0, 160.0, 0.0, 0.0, 20.0, -30.0, 30.0, 0.0, 0.0, 0.0, 40.0, 0.0, 70.0, 10.0, 20.0, 10.0, 50.0, 80.0, 20.0, 40.0, 60.0, 200.0, 30.0, 40.0, 90.0, 20.0, 240.0, 20.0, 50.0, 10.0, 100.0, 40.0, 10.0, 0.0, 50.0, 40.0, 110.0, 530.0, 20.0, 20.0, 70.0, 300.0, 20.0, 10.0, 0.0, 160.0, 0.0, 40.0, 10.0, 10.0, 20.0, 40.0, 70.0, 110.0, 60.0, 40.0, 40.0, 40.0, 20.0, 70.0, 60.0, 40.0, 30.0, 20.0, 60.0, 20.0, 200.0, 50.0, 0.0, 90.0, 40.0, 180.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 210.0, 170.0, 60.0, 10.0, 180.0, 20.0, 10.0, 50.0, 40.0, 0.0, 40.0, 0.0, -10.0, 0.0, 360.0, 0.0, 20.0, 20.0, 110.0, 30.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 220.0, 550.0, 100.0, 500.0, 20.0, 10.0, 50.0, 110.0, 20.0, 30.0, 90.0, 20.0, 10.0, 40.0, 0.0, 30.0, 50.0, 50.0, 10.0, 290.0, 30.0, 60.0, 0.0, 80.0, 30.0, 700.0, 110.0, 20.0, 0.0, 40.0, 90.0, 10.0, 40.0, -50.0, 460.0, 160.0, -20.0, 0.0, 20.0, 50.0, 0.0, 270.0, 130.0, 670.0, 80.0, 10.0, 20.0, 40.0, -10.0, 70.0, 100.0, 0.0, 10.0, 200.0, 40.0, 0.0, 40.0, 310.0, 20.0, 40.0, 10.0, 20.0, 80.0, 10.0, 10.0, 10.0, 20.0, 0.0, 40.0, 40.0, 10.0, 20.0, 20.0, 40.0, 20.0, 10.0, 40.0, 10.0, 30.0, 0.0, 20.0, 40.0, 40.0, 0.0, 10.0, 0.0, 20.0, -5.0, 290.0, 0.0, 160.0, -5.0, 60.0, -10.0, 70.0, 40.0, 20.0, 20.0, 40.0, 60.0, 0.0, 0.0, 60.0, 20.0, 30.0, 40.0, 30.0, 40.0, 160.0, 70.0, 20.0, 20.0, 0.0, 60.0, 40.0, 20.0, 190.0, 20.0, 350.0, 20.0, 0.0, 0.0, 50.0, 0.0, 10.0, 160.0, 10.0, 0.0, 10.0, 0.0, 50.0, 20.0, 30.0, 20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 60.0, 20.0, -70.0, 20.0, 10.0, 40.0, 10.0, 170.0, 170.0, 0.0, 30.0, 30.0, 0.0, 0.0, 10.0, 30.0, 40.0, 40.0, 10.0, 60.0, 30.0, 10.0, 30.0, 40.0, 190.0, 20.0, 30.0, 10.0, 0.0, 10.0, 40.0, 80.0, 50.0, 180.0, 30.0, 80.0, 90.0, 160.0, 360.0, 0.0, 20.0, 0.0, 20.0, 20.0, -50.0, 30.0, 0.0, -30.0, 30.0, 460.0, 70.0, 250.0, 40.0, 40.0, 10.0, 20.0, 0.0, 30.0, 60.0, 60.0, 50.0, 100.0, 490.0, 30.0, 40.0, 40.0, 0.0, 270.0, 50.0, 60.0, 0.0, 10.0, 80.0, 20.0, -40.0, 0.0, -30.0, 10.0, -20.0, 660.0, 0.0, 30.0, 20.0, -100.0, -50.0, 0.0, 0.0, 0.0, 30.0, 460.0, 0.0, 40.0, 40.0, 60.0, 10.0, 30.0, 70.0, 10.0, 10.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4383141740412566, "mean_inference_ms": 1.6385271524599367, "mean_action_processing_ms": 0.42433640706662856, "mean_env_wait_ms": 1.316466901450875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05634164810180664, "StateBufferConnector_ms": 0.009887933731079102, "ViewRequirementAgentConnector_ms": 0.38025355339050293}, "num_episodes": 18, "episode_return_max": 1610.0, "episode_return_min": 50.0, "episode_return_mean": 568.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.12152825680027, "num_env_steps_trained_throughput_per_sec": 36.12152825680027, "timesteps_total": 420000, "num_env_steps_sampled_lifetime": 420000, "num_agent_steps_sampled_lifetime": 4200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4200000, "timers": {"training_iteration_time_ms": 110233.229, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110233.18, "sample_time_ms": 2423.287, "learn_time_ms": 107789.302, "learn_throughput": 37.109, "synch_weights_time_ms": 11.911}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 4200000, "num_agent_steps_trained": 4200000}, "done": false, "training_iteration": 105, "trial_id": "57140_00000", "date": "2024-06-27_02-32-53", "timestamp": 1719469973, "time_this_iter_s": 110.75158905982971, "time_total_s": 11898.947429895401, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b25c24c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11898.947429895401, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 15.756050955414015, "ram_util_percent": 79.31910828025478}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.225000441740877, "cur_kl_coeff": 19.72747522972059, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0010719967820295813, "vf_loss": 3.8160911502675634, "vf_explained_var": 0.0005223989296264161, "kl": Infinity, "entropy": 0.37809921510684225, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 990645.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000}, "env_runners": {"episode_reward_max": 1610.0, "episode_reward_min": 50.0, "episode_reward_mean": 570.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -185.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 57.015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [170.0, 600.0, 1030.0, 480.0, 1030.0, 540.0, 230.0, 650.0, 370.0, 840.0, 150.0, 350.0, 1080.0, 1280.0, 720.0, 160.0, 530.0, 360.0, 720.0, 760.0, 230.0, 680.0, 800.0, 375.0, 980.0, 410.0, 890.0, 960.0, 950.0, 530.0, 430.0, 550.0, 380.0, 540.0, 330.0, 440.0, 350.0, 520.0, 50.0, 660.0, 200.0, 630.0, 200.0, 280.0, 760.0, 940.0, 640.0, 440.0, 570.0, 390.0, 750.0, 570.0, 80.0, 1610.0, 590.0, 1070.0, 760.0, 1280.0, 760.0, 240.0, 200.0, 415.0, 455.0, 450.0, 740.0, 240.0, 160.0, 430.0, 250.0, 370.0, 1070.0, 500.0, 580.0, 1130.0, 690.0, 390.0, 290.0, 420.0, 1140.0, 1080.0, 1240.0, 150.0, 370.0, 140.0, 580.0, 510.0, 555.0, 550.0, 1270.0, 300.0, 310.0, 585.0, 260.0, 140.0, 460.0, 150.0, 270.0, 920.0, 490.0, 900.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 0.0, 70.0, 0.0, 20.0, 10.0, 20.0, 10.0, 10.0, 10.0, 30.0, 0.0, 60.0, 0.0, 140.0, 20.0, 90.0, 30.0, 160.0, 70.0, 0.0, 70.0, 10.0, 150.0, 210.0, 100.0, 30.0, 400.0, 50.0, 10.0, 30.0, 0.0, 70.0, 50.0, 30.0, 30.0, 30.0, 20.0, 180.0, 40.0, 30.0, 120.0, 670.0, -30.0, -30.0, 20.0, 80.0, 90.0, -30.0, 110.0, 20.0, 0.0, 360.0, 30.0, 80.0, 0.0, 0.0, 0.0, 40.0, 10.0, 70.0, 10.0, 0.0, 0.0, 10.0, 10.0, 30.0, 20.0, 70.0, 10.0, 0.0, 20.0, 40.0, 380.0, 10.0, 10.0, 10.0, 150.0, 0.0, 30.0, 70.0, 0.0, 50.0, 60.0, 20.0, 30.0, 70.0, 0.0, 40.0, 30.0, 30.0, 30.0, 80.0, 440.0, 30.0, 40.0, 40.0, 110.0, 20.0, 20.0, 20.0, 20.0, 0.0, 30.0, 0.0, 30.0, 10.0, 0.0, 30.0, 10.0, 30.0, 30.0, 0.0, 10.0, 0.0, 20.0, 30.0, 40.0, 110.0, 80.0, 0.0, 20.0, 30.0, 10.0, 460.0, 60.0, 30.0, 50.0, 350.0, 70.0, -20.0, 40.0, 50.0, 170.0, 20.0, 470.0, 500.0, -30.0, 70.0, 10.0, 0.0, 10.0, 0.0, 0.0, 510.0, 110.0, 0.0, 10.0, 20.0, 60.0, 20.0, 0.0, 40.0, 20.0, 30.0, 10.0, 0.0, 10.0, 20.0, 10.0, 30.0, 380.0, 0.0, 20.0, 10.0, 20.0, 20.0, 10.0, 0.0, 40.0, 30.0, 10.0, 10.0, 10.0, 10.0, 210.0, 10.0, 10.0, 10.0, 50.0, 0.0, 0.0, 20.0, 40.0, 40.0, 570.0, 10.0, -30.0, 40.0, 30.0, 70.0, 50.0, 10.0, 10.0, 10.0, 0.0, 70.0, 20.0, 480.0, 40.0, 20.0, 50.0, 0.0, 20.0, 40.0, 10.0, 40.0, 40.0, 10.0, 0.0, 20.0, 60.0, 120.0, 120.0, 40.0, 170.0, 30.0, 70.0, 20.0, 30.0, 50.0, 30.0, 50.0, 30.0, 370.0, 70.0, 0.0, 90.0, 30.0, 80.0, 5.0, 20.0, 0.0, 30.0, 0.0, 0.0, 220.0, 20.0, 70.0, 10.0, 10.0, 140.0, 0.0, 250.0, 410.0, 20.0, 20.0, 40.0, 30.0, 60.0, 40.0, 80.0, 70.0, 30.0, 0.0, 50.0, 80.0, 10.0, 30.0, 20.0, 40.0, 100.0, 60.0, 80.0, 0.0, 20.0, 490.0, 50.0, 20.0, 30.0, 80.0, 100.0, 110.0, 30.0, 0.0, 20.0, 450.0, 20.0, 110.0, 40.0, 90.0, 170.0, 310.0, 70.0, 30.0, 10.0, 20.0, 170.0, 30.0, 50.0, 250.0, 20.0, 0.0, 150.0, 30.0, 40.0, 0.0, 20.0, 20.0, 0.0, 20.0, 0.0, 0.0, 90.0, 10.0, -50.0, -40.0, 360.0, 0.0, 40.0, 50.0, 40.0, 10.0, 0.0, 360.0, 20.0, 0.0, 30.0, 30.0, 10.0, 10.0, 30.0, 0.0, 40.0, 30.0, 10.0, 20.0, 20.0, 0.0, 220.0, 40.0, 40.0, 60.0, 150.0, 0.0, 10.0, 10.0, 190.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 20.0, 40.0, 90.0, 30.0, 150.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, 60.0, 40.0, 70.0, 190.0, 10.0, 10.0, 150.0, 20.0, 60.0, 30.0, 10.0, 0.0, 40.0, 20.0, 10.0, 30.0, 40.0, 10.0, 10.0, 0.0, 10.0, 380.0, 0.0, 20.0, 20.0, -185.0, 90.0, -25.0, 180.0, 40.0, 10.0, 40.0, 0.0, -80.0, -20.0, 10.0, 40.0, 60.0, 100.0, 0.0, 30.0, 60.0, 80.0, 10.0, 270.0, 0.0, 10.0, 30.0, 30.0, 30.0, 10.0, 30.0, 0.0, 30.0, 30.0, 50.0, 20.0, 90.0, 20.0, 50.0, 20.0, 10.0, 250.0, 70.0, 50.0, -40.0, 0.0, 60.0, 160.0, 0.0, 0.0, 20.0, -30.0, 30.0, 0.0, 0.0, 0.0, 40.0, 0.0, 70.0, 10.0, 20.0, 10.0, 50.0, 80.0, 20.0, 40.0, 60.0, 200.0, 30.0, 40.0, 90.0, 20.0, 240.0, 20.0, 50.0, 10.0, 100.0, 40.0, 10.0, 0.0, 50.0, 40.0, 110.0, 530.0, 20.0, 20.0, 70.0, 300.0, 20.0, 10.0, 0.0, 160.0, 0.0, 40.0, 10.0, 10.0, 20.0, 40.0, 70.0, 110.0, 60.0, 40.0, 40.0, 40.0, 20.0, 70.0, 60.0, 40.0, 30.0, 20.0, 60.0, 20.0, 200.0, 50.0, 0.0, 90.0, 40.0, 180.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 210.0, 170.0, 60.0, 10.0, 180.0, 20.0, 10.0, 50.0, 40.0, 0.0, 40.0, 0.0, -10.0, 0.0, 360.0, 0.0, 20.0, 20.0, 110.0, 30.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 220.0, 550.0, 100.0, 500.0, 20.0, 10.0, 50.0, 110.0, 20.0, 30.0, 90.0, 20.0, 10.0, 40.0, 0.0, 30.0, 50.0, 50.0, 10.0, 290.0, 30.0, 60.0, 0.0, 80.0, 30.0, 700.0, 110.0, 20.0, 0.0, 40.0, 90.0, 10.0, 40.0, -50.0, 460.0, 160.0, -20.0, 0.0, 20.0, 50.0, 0.0, 270.0, 130.0, 670.0, 80.0, 10.0, 20.0, 40.0, -10.0, 70.0, 100.0, 0.0, 10.0, 200.0, 40.0, 0.0, 40.0, 310.0, 20.0, 40.0, 10.0, 20.0, 80.0, 10.0, 10.0, 10.0, 20.0, 0.0, 40.0, 40.0, 10.0, 20.0, 20.0, 40.0, 20.0, 10.0, 40.0, 10.0, 30.0, 0.0, 20.0, 40.0, 40.0, 0.0, 10.0, 0.0, 20.0, -5.0, 290.0, 0.0, 160.0, -5.0, 60.0, -10.0, 70.0, 40.0, 20.0, 20.0, 40.0, 60.0, 0.0, 0.0, 60.0, 20.0, 30.0, 40.0, 30.0, 40.0, 160.0, 70.0, 20.0, 20.0, 0.0, 60.0, 40.0, 20.0, 190.0, 20.0, 350.0, 20.0, 0.0, 0.0, 50.0, 0.0, 10.0, 160.0, 10.0, 0.0, 10.0, 0.0, 50.0, 20.0, 30.0, 20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 60.0, 20.0, -70.0, 20.0, 10.0, 40.0, 10.0, 170.0, 170.0, 0.0, 30.0, 30.0, 0.0, 0.0, 10.0, 30.0, 40.0, 40.0, 10.0, 60.0, 30.0, 10.0, 30.0, 40.0, 190.0, 20.0, 30.0, 10.0, 0.0, 10.0, 40.0, 80.0, 50.0, 180.0, 30.0, 80.0, 90.0, 160.0, 360.0, 0.0, 20.0, 0.0, 20.0, 20.0, -50.0, 30.0, 0.0, -30.0, 30.0, 460.0, 70.0, 250.0, 40.0, 40.0, 10.0, 20.0, 0.0, 30.0, 60.0, 60.0, 50.0, 100.0, 490.0, 30.0, 40.0, 40.0, 0.0, 270.0, 50.0, 60.0, 0.0, 10.0, 80.0, 20.0, -40.0, 0.0, -30.0, 10.0, -20.0, 660.0, 0.0, 30.0, 20.0, -100.0, -50.0, 0.0, 0.0, 0.0, 30.0, 460.0, 0.0, 40.0, 40.0, 60.0, 10.0, 30.0, 70.0, 10.0, 10.0, 20.0, 30.0, 20.0, 120.0, 10.0, 110.0, 30.0, 20.0, 0.0, 40.0, 40.0, 20.0, 40.0, 160.0, 50.0, 160.0, 0.0, 210.0, 30.0, 310.0, 160.0, 170.0, 450.0, 90.0, 180.0, 30.0, 30.0, 40.0, 20.0, 10.0, 60.0, 320.0, 20.0, 120.0, 20.0, 20.0, 600.0, 10.0, 60.0, 0.0, 70.0, 40.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 40.0, 30.0, 20.0, 10.0, 10.0, 120.0, 30.0, 0.0, 30.0, 10.0, 30.0, 110.0, 0.0, 0.0, 10.0, 10.0, 40.0, 20.0, 10.0, 30.0, 0.0, 20.0, 10.0, 260.0, 30.0, 10.0, 100.0, 0.0, 20.0, 120.0, 0.0, 30.0, 20.0, 20.0, 10.0, 20.0, 60.0, 70.0, 0.0, 110.0, 240.0, -40.0, 30.0, 10.0, 70.0, 40.0, 30.0, 200.0, 50.0, 60.0, 80.0, -15.0, 140.0, 0.0, 10.0, 20.0, 10.0, 180.0, 180.0, 10.0, 30.0, -30.0, 100.0, 300.0, 460.0, 40.0, 90.0, 40.0, 30.0, 10.0, 180.0, 20.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 0.0, 190.0, 40.0, 10.0, 10.0, 40.0, 170.0, 0.0, 10.0, 20.0, 50.0, 0.0, 10.0, 0.0, 20.0, 0.0, 40.0, 20.0, 60.0, 150.0, 250.0, 20.0, 5.0, 20.0, 0.0, 60.0, 30.0, 0.0, 60.0, 10.0, 30.0, 30.0, 20.0, 20.0, 0.0, 10.0, 40.0, 20.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, 60.0, 0.0, 50.0, 20.0, 180.0, 0.0, 50.0, 10.0, 40.0, 50.0, 0.0, 40.0, 20.0, 40.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 100.0, 0.0, 30.0, 80.0, 20.0, 200.0, 60.0, 0.0, 0.0, -10.0, 280.0, 60.0, 290.0, 20.0, 20.0, 40.0, 10.0, 90.0, 0.0, 30.0, 0.0, 190.0, 40.0, 40.0, 50.0, 70.0, 80.0, 40.0, 160.0, 0.0, 80.0, 0.0, 60.0, 370.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4372991149070042, "mean_inference_ms": 1.6375286404648426, "mean_action_processing_ms": 0.42397071222901384, "mean_env_wait_ms": 1.3156923522153314, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05693769454956055, "StateBufferConnector_ms": 0.009907722473144531, "ViewRequirementAgentConnector_ms": 0.3703925609588623}, "num_episodes": 23, "episode_return_max": 1610.0, "episode_return_min": 50.0, "episode_return_mean": 570.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.20228938414363, "num_env_steps_trained_throughput_per_sec": 36.20228938414363, "timesteps_total": 424000, "num_env_steps_sampled_lifetime": 424000, "num_agent_steps_sampled_lifetime": 4240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4240000, "timers": {"training_iteration_time_ms": 110346.197, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110346.146, "sample_time_ms": 2423.67, "learn_time_ms": 107901.888, "learn_throughput": 37.071, "synch_weights_time_ms": 12.073}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 4240000, "num_agent_steps_trained": 4240000}, "done": false, "training_iteration": 106, "trial_id": "57140_00000", "date": "2024-06-27_02-34-44", "timestamp": 1719470084, "time_this_iter_s": 110.50377869606018, "time_total_s": 12009.451208591461, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b193b040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12009.451208591461, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 15.625641025641025, "ram_util_percent": 78.59935897435898}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.706357179872525, "cur_kl_coeff": 29.59121284458087, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.0330147715549245, "policy_loss": -0.0009617251460068523, "vf_loss": 4.031872819305355, "vf_explained_var": 0.0003178282731130354, "kl": 7.10910534213428e-05, "entropy": 0.3695380095523386, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1000035.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000}, "env_runners": {"episode_reward_max": 1610.0, "episode_reward_min": -290.0, "episode_reward_mean": 560.25, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -910.0}, "policy_reward_max": {"policy_0": 700.0}, "policy_reward_mean": {"policy_0": 56.025}, "custom_metrics": {}, "hist_stats": {"episode_reward": [720.0, 760.0, 230.0, 680.0, 800.0, 375.0, 980.0, 410.0, 890.0, 960.0, 950.0, 530.0, 430.0, 550.0, 380.0, 540.0, 330.0, 440.0, 350.0, 520.0, 50.0, 660.0, 200.0, 630.0, 200.0, 280.0, 760.0, 940.0, 640.0, 440.0, 570.0, 390.0, 750.0, 570.0, 80.0, 1610.0, 590.0, 1070.0, 760.0, 1280.0, 760.0, 240.0, 200.0, 415.0, 455.0, 450.0, 740.0, 240.0, 160.0, 430.0, 250.0, 370.0, 1070.0, 500.0, 580.0, 1130.0, 690.0, 390.0, 290.0, 420.0, 1140.0, 1080.0, 1240.0, 150.0, 370.0, 140.0, 580.0, 510.0, 555.0, 550.0, 1270.0, 300.0, 310.0, 585.0, 260.0, 140.0, 460.0, 150.0, 270.0, 920.0, 490.0, 900.0, 280.0, 700.0, 600.0, 210.0, -290.0, 220.0, 720.0, 560.0, 480.0, 955.0, 550.0, 580.0, 330.0, 710.0, 220.0, 905.0, 1150.0, 700.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 20.0, 40.0, 40.0, 570.0, 10.0, -30.0, 40.0, 30.0, 70.0, 50.0, 10.0, 10.0, 10.0, 0.0, 70.0, 20.0, 480.0, 40.0, 20.0, 50.0, 0.0, 20.0, 40.0, 10.0, 40.0, 40.0, 10.0, 0.0, 20.0, 60.0, 120.0, 120.0, 40.0, 170.0, 30.0, 70.0, 20.0, 30.0, 50.0, 30.0, 50.0, 30.0, 370.0, 70.0, 0.0, 90.0, 30.0, 80.0, 5.0, 20.0, 0.0, 30.0, 0.0, 0.0, 220.0, 20.0, 70.0, 10.0, 10.0, 140.0, 0.0, 250.0, 410.0, 20.0, 20.0, 40.0, 30.0, 60.0, 40.0, 80.0, 70.0, 30.0, 0.0, 50.0, 80.0, 10.0, 30.0, 20.0, 40.0, 100.0, 60.0, 80.0, 0.0, 20.0, 490.0, 50.0, 20.0, 30.0, 80.0, 100.0, 110.0, 30.0, 0.0, 20.0, 450.0, 20.0, 110.0, 40.0, 90.0, 170.0, 310.0, 70.0, 30.0, 10.0, 20.0, 170.0, 30.0, 50.0, 250.0, 20.0, 0.0, 150.0, 30.0, 40.0, 0.0, 20.0, 20.0, 0.0, 20.0, 0.0, 0.0, 90.0, 10.0, -50.0, -40.0, 360.0, 0.0, 40.0, 50.0, 40.0, 10.0, 0.0, 360.0, 20.0, 0.0, 30.0, 30.0, 10.0, 10.0, 30.0, 0.0, 40.0, 30.0, 10.0, 20.0, 20.0, 0.0, 220.0, 40.0, 40.0, 60.0, 150.0, 0.0, 10.0, 10.0, 190.0, 0.0, 40.0, 0.0, 0.0, 0.0, 0.0, 20.0, 40.0, 90.0, 30.0, 150.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, 60.0, 40.0, 70.0, 190.0, 10.0, 10.0, 150.0, 20.0, 60.0, 30.0, 10.0, 0.0, 40.0, 20.0, 10.0, 30.0, 40.0, 10.0, 10.0, 0.0, 10.0, 380.0, 0.0, 20.0, 20.0, -185.0, 90.0, -25.0, 180.0, 40.0, 10.0, 40.0, 0.0, -80.0, -20.0, 10.0, 40.0, 60.0, 100.0, 0.0, 30.0, 60.0, 80.0, 10.0, 270.0, 0.0, 10.0, 30.0, 30.0, 30.0, 10.0, 30.0, 0.0, 30.0, 30.0, 50.0, 20.0, 90.0, 20.0, 50.0, 20.0, 10.0, 250.0, 70.0, 50.0, -40.0, 0.0, 60.0, 160.0, 0.0, 0.0, 20.0, -30.0, 30.0, 0.0, 0.0, 0.0, 40.0, 0.0, 70.0, 10.0, 20.0, 10.0, 50.0, 80.0, 20.0, 40.0, 60.0, 200.0, 30.0, 40.0, 90.0, 20.0, 240.0, 20.0, 50.0, 10.0, 100.0, 40.0, 10.0, 0.0, 50.0, 40.0, 110.0, 530.0, 20.0, 20.0, 70.0, 300.0, 20.0, 10.0, 0.0, 160.0, 0.0, 40.0, 10.0, 10.0, 20.0, 40.0, 70.0, 110.0, 60.0, 40.0, 40.0, 40.0, 20.0, 70.0, 60.0, 40.0, 30.0, 20.0, 60.0, 20.0, 200.0, 50.0, 0.0, 90.0, 40.0, 180.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 210.0, 170.0, 60.0, 10.0, 180.0, 20.0, 10.0, 50.0, 40.0, 0.0, 40.0, 0.0, -10.0, 0.0, 360.0, 0.0, 20.0, 20.0, 110.0, 30.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 220.0, 550.0, 100.0, 500.0, 20.0, 10.0, 50.0, 110.0, 20.0, 30.0, 90.0, 20.0, 10.0, 40.0, 0.0, 30.0, 50.0, 50.0, 10.0, 290.0, 30.0, 60.0, 0.0, 80.0, 30.0, 700.0, 110.0, 20.0, 0.0, 40.0, 90.0, 10.0, 40.0, -50.0, 460.0, 160.0, -20.0, 0.0, 20.0, 50.0, 0.0, 270.0, 130.0, 670.0, 80.0, 10.0, 20.0, 40.0, -10.0, 70.0, 100.0, 0.0, 10.0, 200.0, 40.0, 0.0, 40.0, 310.0, 20.0, 40.0, 10.0, 20.0, 80.0, 10.0, 10.0, 10.0, 20.0, 0.0, 40.0, 40.0, 10.0, 20.0, 20.0, 40.0, 20.0, 10.0, 40.0, 10.0, 30.0, 0.0, 20.0, 40.0, 40.0, 0.0, 10.0, 0.0, 20.0, -5.0, 290.0, 0.0, 160.0, -5.0, 60.0, -10.0, 70.0, 40.0, 20.0, 20.0, 40.0, 60.0, 0.0, 0.0, 60.0, 20.0, 30.0, 40.0, 30.0, 40.0, 160.0, 70.0, 20.0, 20.0, 0.0, 60.0, 40.0, 20.0, 190.0, 20.0, 350.0, 20.0, 0.0, 0.0, 50.0, 0.0, 10.0, 160.0, 10.0, 0.0, 10.0, 0.0, 50.0, 20.0, 30.0, 20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 60.0, 20.0, -70.0, 20.0, 10.0, 40.0, 10.0, 170.0, 170.0, 0.0, 30.0, 30.0, 0.0, 0.0, 10.0, 30.0, 40.0, 40.0, 10.0, 60.0, 30.0, 10.0, 30.0, 40.0, 190.0, 20.0, 30.0, 10.0, 0.0, 10.0, 40.0, 80.0, 50.0, 180.0, 30.0, 80.0, 90.0, 160.0, 360.0, 0.0, 20.0, 0.0, 20.0, 20.0, -50.0, 30.0, 0.0, -30.0, 30.0, 460.0, 70.0, 250.0, 40.0, 40.0, 10.0, 20.0, 0.0, 30.0, 60.0, 60.0, 50.0, 100.0, 490.0, 30.0, 40.0, 40.0, 0.0, 270.0, 50.0, 60.0, 0.0, 10.0, 80.0, 20.0, -40.0, 0.0, -30.0, 10.0, -20.0, 660.0, 0.0, 30.0, 20.0, -100.0, -50.0, 0.0, 0.0, 0.0, 30.0, 460.0, 0.0, 40.0, 40.0, 60.0, 10.0, 30.0, 70.0, 10.0, 10.0, 20.0, 30.0, 20.0, 120.0, 10.0, 110.0, 30.0, 20.0, 0.0, 40.0, 40.0, 20.0, 40.0, 160.0, 50.0, 160.0, 0.0, 210.0, 30.0, 310.0, 160.0, 170.0, 450.0, 90.0, 180.0, 30.0, 30.0, 40.0, 20.0, 10.0, 60.0, 320.0, 20.0, 120.0, 20.0, 20.0, 600.0, 10.0, 60.0, 0.0, 70.0, 40.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 40.0, 30.0, 20.0, 10.0, 10.0, 120.0, 30.0, 0.0, 30.0, 10.0, 30.0, 110.0, 0.0, 0.0, 10.0, 10.0, 40.0, 20.0, 10.0, 30.0, 0.0, 20.0, 10.0, 260.0, 30.0, 10.0, 100.0, 0.0, 20.0, 120.0, 0.0, 30.0, 20.0, 20.0, 10.0, 20.0, 60.0, 70.0, 0.0, 110.0, 240.0, -40.0, 30.0, 10.0, 70.0, 40.0, 30.0, 200.0, 50.0, 60.0, 80.0, -15.0, 140.0, 0.0, 10.0, 20.0, 10.0, 180.0, 180.0, 10.0, 30.0, -30.0, 100.0, 300.0, 460.0, 40.0, 90.0, 40.0, 30.0, 10.0, 180.0, 20.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 0.0, 190.0, 40.0, 10.0, 10.0, 40.0, 170.0, 0.0, 10.0, 20.0, 50.0, 0.0, 10.0, 0.0, 20.0, 0.0, 40.0, 20.0, 60.0, 150.0, 250.0, 20.0, 5.0, 20.0, 0.0, 60.0, 30.0, 0.0, 60.0, 10.0, 30.0, 30.0, 20.0, 20.0, 0.0, 10.0, 40.0, 20.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, 60.0, 0.0, 50.0, 20.0, 180.0, 0.0, 50.0, 10.0, 40.0, 50.0, 0.0, 40.0, 20.0, 40.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 100.0, 0.0, 30.0, 80.0, 20.0, 200.0, 60.0, 0.0, 0.0, -10.0, 280.0, 60.0, 290.0, 20.0, 20.0, 40.0, 10.0, 90.0, 0.0, 30.0, 0.0, 190.0, 40.0, 40.0, 50.0, 70.0, 80.0, 40.0, 160.0, 0.0, 80.0, 0.0, 60.0, 370.0, 40.0, 0.0, 90.0, 10.0, 30.0, 20.0, 30.0, 30.0, 40.0, 20.0, 10.0, 450.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 50.0, 10.0, 70.0, 20.0, 40.0, 20.0, 10.0, 360.0, 20.0, 40.0, 30.0, 50.0, 10.0, 0.0, 10.0, 20.0, 10.0, 40.0, 0.0, 70.0, 40.0, 0.0, 20.0, 20.0, 0.0, 0.0, 220.0, 20.0, 100.0, 190.0, 50.0, -910.0, 20.0, 10.0, 10.0, 10.0, 20.0, 40.0, 70.0, 10.0, 30.0, 0.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 10.0, 50.0, 70.0, 460.0, 20.0, 0.0, 250.0, 10.0, 10.0, 50.0, 30.0, 0.0, 160.0, 40.0, 10.0, 20.0, 10.0, 30.0, 20.0, 0.0, 160.0, 60.0, 0.0, 160.0, 20.0, 80.0, 100.0, -10.0, 30.0, -20.0, 5.0, 620.0, 0.0, 160.0, -10.0, 0.0, 0.0, 370.0, 30.0, 40.0, 0.0, 0.0, 40.0, 10.0, 60.0, 160.0, 170.0, 20.0, 20.0, 60.0, 30.0, 30.0, 30.0, 40.0, 20.0, 0.0, 10.0, 160.0, 20.0, 10.0, -10.0, 20.0, 30.0, 50.0, 40.0, 40.0, 20.0, 20.0, 0.0, 0.0, 80.0, 120.0, 270.0, 20.0, 140.0, 10.0, 20.0, 40.0, 10.0, 10.0, 10.0, 60.0, 10.0, 10.0, 40.0, 60.0, 0.0, 100.0, -5.0, 110.0, 20.0, 500.0, 20.0, 20.0, 80.0, 190.0, 170.0, 160.0, 60.0, 170.0, 0.0, 0.0, 290.0, 50.0, 60.0, 40.0, 50.0, 210.0, 40.0, 0.0, 180.0, 70.0, 0.0, 60.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4362971613247908, "mean_inference_ms": 1.6367035631833209, "mean_action_processing_ms": 0.4236625245555484, "mean_env_wait_ms": 1.3150119125898865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05617690086364746, "StateBufferConnector_ms": 0.009577751159667969, "ViewRequirementAgentConnector_ms": 0.37058138847351074}, "num_episodes": 18, "episode_return_max": 1610.0, "episode_return_min": -290.0, "episode_return_mean": 560.25}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 35.92264932485003, "num_env_steps_trained_throughput_per_sec": 35.92264932485003, "timesteps_total": 428000, "num_env_steps_sampled_lifetime": 428000, "num_agent_steps_sampled_lifetime": 4280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4280000, "timers": {"training_iteration_time_ms": 110471.833, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110471.782, "sample_time_ms": 2416.856, "learn_time_ms": 108034.302, "learn_throughput": 37.025, "synch_weights_time_ms": 12.13}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 4280000, "num_agent_steps_trained": 4280000}, "done": false, "training_iteration": 107, "trial_id": "57140_00000", "date": "2024-06-27_02-36-35", "timestamp": 1719470195, "time_this_iter_s": 111.36253619194031, "time_total_s": 12120.813744783401, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b25ba430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12120.813744783401, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 16.480379746835442, "ram_util_percent": 77.52025316455696}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.805585421248874, "cur_kl_coeff": 14.795606422290435, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.486928613117328, "policy_loss": -0.0013860482856665002, "vf_loss": 3.48653339948644, "vf_explained_var": -2.0125314704399392e-05, "kl": 0.00012039128989314384, "entropy": 0.3639025197274134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1009425.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000}, "env_runners": {"episode_reward_max": 1610.0, "episode_reward_min": -290.0, "episode_reward_mean": 559.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -910.0}, "policy_reward_max": {"policy_0": 780.0}, "policy_reward_mean": {"policy_0": 55.975}, "custom_metrics": {}, "hist_stats": {"episode_reward": [200.0, 630.0, 200.0, 280.0, 760.0, 940.0, 640.0, 440.0, 570.0, 390.0, 750.0, 570.0, 80.0, 1610.0, 590.0, 1070.0, 760.0, 1280.0, 760.0, 240.0, 200.0, 415.0, 455.0, 450.0, 740.0, 240.0, 160.0, 430.0, 250.0, 370.0, 1070.0, 500.0, 580.0, 1130.0, 690.0, 390.0, 290.0, 420.0, 1140.0, 1080.0, 1240.0, 150.0, 370.0, 140.0, 580.0, 510.0, 555.0, 550.0, 1270.0, 300.0, 310.0, 585.0, 260.0, 140.0, 460.0, 150.0, 270.0, 920.0, 490.0, 900.0, 280.0, 700.0, 600.0, 210.0, -290.0, 220.0, 720.0, 560.0, 480.0, 955.0, 550.0, 580.0, 330.0, 710.0, 220.0, 905.0, 1150.0, 700.0, 160.0, 140.0, 740.0, 470.0, 450.0, 680.0, 880.0, 340.0, 440.0, 1490.0, 1005.0, 600.0, 610.0, 190.0, 670.0, 690.0, 370.0, 400.0, 920.0, 870.0, 230.0, 140.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 10.0, 30.0, 30.0, 30.0, 10.0, 30.0, 0.0, 30.0, 30.0, 50.0, 20.0, 90.0, 20.0, 50.0, 20.0, 10.0, 250.0, 70.0, 50.0, -40.0, 0.0, 60.0, 160.0, 0.0, 0.0, 20.0, -30.0, 30.0, 0.0, 0.0, 0.0, 40.0, 0.0, 70.0, 10.0, 20.0, 10.0, 50.0, 80.0, 20.0, 40.0, 60.0, 200.0, 30.0, 40.0, 90.0, 20.0, 240.0, 20.0, 50.0, 10.0, 100.0, 40.0, 10.0, 0.0, 50.0, 40.0, 110.0, 530.0, 20.0, 20.0, 70.0, 300.0, 20.0, 10.0, 0.0, 160.0, 0.0, 40.0, 10.0, 10.0, 20.0, 40.0, 70.0, 110.0, 60.0, 40.0, 40.0, 40.0, 20.0, 70.0, 60.0, 40.0, 30.0, 20.0, 60.0, 20.0, 200.0, 50.0, 0.0, 90.0, 40.0, 180.0, 20.0, 20.0, 20.0, 20.0, 0.0, 0.0, 210.0, 170.0, 60.0, 10.0, 180.0, 20.0, 10.0, 50.0, 40.0, 0.0, 40.0, 0.0, -10.0, 0.0, 360.0, 0.0, 20.0, 20.0, 110.0, 30.0, 0.0, 10.0, 30.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 10.0, 220.0, 550.0, 100.0, 500.0, 20.0, 10.0, 50.0, 110.0, 20.0, 30.0, 90.0, 20.0, 10.0, 40.0, 0.0, 30.0, 50.0, 50.0, 10.0, 290.0, 30.0, 60.0, 0.0, 80.0, 30.0, 700.0, 110.0, 20.0, 0.0, 40.0, 90.0, 10.0, 40.0, -50.0, 460.0, 160.0, -20.0, 0.0, 20.0, 50.0, 0.0, 270.0, 130.0, 670.0, 80.0, 10.0, 20.0, 40.0, -10.0, 70.0, 100.0, 0.0, 10.0, 200.0, 40.0, 0.0, 40.0, 310.0, 20.0, 40.0, 10.0, 20.0, 80.0, 10.0, 10.0, 10.0, 20.0, 0.0, 40.0, 40.0, 10.0, 20.0, 20.0, 40.0, 20.0, 10.0, 40.0, 10.0, 30.0, 0.0, 20.0, 40.0, 40.0, 0.0, 10.0, 0.0, 20.0, -5.0, 290.0, 0.0, 160.0, -5.0, 60.0, -10.0, 70.0, 40.0, 20.0, 20.0, 40.0, 60.0, 0.0, 0.0, 60.0, 20.0, 30.0, 40.0, 30.0, 40.0, 160.0, 70.0, 20.0, 20.0, 0.0, 60.0, 40.0, 20.0, 190.0, 20.0, 350.0, 20.0, 0.0, 0.0, 50.0, 0.0, 10.0, 160.0, 10.0, 0.0, 10.0, 0.0, 50.0, 20.0, 30.0, 20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 60.0, 20.0, -70.0, 20.0, 10.0, 40.0, 10.0, 170.0, 170.0, 0.0, 30.0, 30.0, 0.0, 0.0, 10.0, 30.0, 40.0, 40.0, 10.0, 60.0, 30.0, 10.0, 30.0, 40.0, 190.0, 20.0, 30.0, 10.0, 0.0, 10.0, 40.0, 80.0, 50.0, 180.0, 30.0, 80.0, 90.0, 160.0, 360.0, 0.0, 20.0, 0.0, 20.0, 20.0, -50.0, 30.0, 0.0, -30.0, 30.0, 460.0, 70.0, 250.0, 40.0, 40.0, 10.0, 20.0, 0.0, 30.0, 60.0, 60.0, 50.0, 100.0, 490.0, 30.0, 40.0, 40.0, 0.0, 270.0, 50.0, 60.0, 0.0, 10.0, 80.0, 20.0, -40.0, 0.0, -30.0, 10.0, -20.0, 660.0, 0.0, 30.0, 20.0, -100.0, -50.0, 0.0, 0.0, 0.0, 30.0, 460.0, 0.0, 40.0, 40.0, 60.0, 10.0, 30.0, 70.0, 10.0, 10.0, 20.0, 30.0, 20.0, 120.0, 10.0, 110.0, 30.0, 20.0, 0.0, 40.0, 40.0, 20.0, 40.0, 160.0, 50.0, 160.0, 0.0, 210.0, 30.0, 310.0, 160.0, 170.0, 450.0, 90.0, 180.0, 30.0, 30.0, 40.0, 20.0, 10.0, 60.0, 320.0, 20.0, 120.0, 20.0, 20.0, 600.0, 10.0, 60.0, 0.0, 70.0, 40.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 40.0, 30.0, 20.0, 10.0, 10.0, 120.0, 30.0, 0.0, 30.0, 10.0, 30.0, 110.0, 0.0, 0.0, 10.0, 10.0, 40.0, 20.0, 10.0, 30.0, 0.0, 20.0, 10.0, 260.0, 30.0, 10.0, 100.0, 0.0, 20.0, 120.0, 0.0, 30.0, 20.0, 20.0, 10.0, 20.0, 60.0, 70.0, 0.0, 110.0, 240.0, -40.0, 30.0, 10.0, 70.0, 40.0, 30.0, 200.0, 50.0, 60.0, 80.0, -15.0, 140.0, 0.0, 10.0, 20.0, 10.0, 180.0, 180.0, 10.0, 30.0, -30.0, 100.0, 300.0, 460.0, 40.0, 90.0, 40.0, 30.0, 10.0, 180.0, 20.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 0.0, 190.0, 40.0, 10.0, 10.0, 40.0, 170.0, 0.0, 10.0, 20.0, 50.0, 0.0, 10.0, 0.0, 20.0, 0.0, 40.0, 20.0, 60.0, 150.0, 250.0, 20.0, 5.0, 20.0, 0.0, 60.0, 30.0, 0.0, 60.0, 10.0, 30.0, 30.0, 20.0, 20.0, 0.0, 10.0, 40.0, 20.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, 60.0, 0.0, 50.0, 20.0, 180.0, 0.0, 50.0, 10.0, 40.0, 50.0, 0.0, 40.0, 20.0, 40.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 100.0, 0.0, 30.0, 80.0, 20.0, 200.0, 60.0, 0.0, 0.0, -10.0, 280.0, 60.0, 290.0, 20.0, 20.0, 40.0, 10.0, 90.0, 0.0, 30.0, 0.0, 190.0, 40.0, 40.0, 50.0, 70.0, 80.0, 40.0, 160.0, 0.0, 80.0, 0.0, 60.0, 370.0, 40.0, 0.0, 90.0, 10.0, 30.0, 20.0, 30.0, 30.0, 40.0, 20.0, 10.0, 450.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 50.0, 10.0, 70.0, 20.0, 40.0, 20.0, 10.0, 360.0, 20.0, 40.0, 30.0, 50.0, 10.0, 0.0, 10.0, 20.0, 10.0, 40.0, 0.0, 70.0, 40.0, 0.0, 20.0, 20.0, 0.0, 0.0, 220.0, 20.0, 100.0, 190.0, 50.0, -910.0, 20.0, 10.0, 10.0, 10.0, 20.0, 40.0, 70.0, 10.0, 30.0, 0.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 10.0, 50.0, 70.0, 460.0, 20.0, 0.0, 250.0, 10.0, 10.0, 50.0, 30.0, 0.0, 160.0, 40.0, 10.0, 20.0, 10.0, 30.0, 20.0, 0.0, 160.0, 60.0, 0.0, 160.0, 20.0, 80.0, 100.0, -10.0, 30.0, -20.0, 5.0, 620.0, 0.0, 160.0, -10.0, 0.0, 0.0, 370.0, 30.0, 40.0, 0.0, 0.0, 40.0, 10.0, 60.0, 160.0, 170.0, 20.0, 20.0, 60.0, 30.0, 30.0, 30.0, 40.0, 20.0, 0.0, 10.0, 160.0, 20.0, 10.0, -10.0, 20.0, 30.0, 50.0, 40.0, 40.0, 20.0, 20.0, 0.0, 0.0, 80.0, 120.0, 270.0, 20.0, 140.0, 10.0, 20.0, 40.0, 10.0, 10.0, 10.0, 60.0, 10.0, 10.0, 40.0, 60.0, 0.0, 100.0, -5.0, 110.0, 20.0, 500.0, 20.0, 20.0, 80.0, 190.0, 170.0, 160.0, 60.0, 170.0, 0.0, 0.0, 290.0, 50.0, 60.0, 40.0, 50.0, 210.0, 40.0, 0.0, 180.0, 70.0, 0.0, 60.0, 50.0, 20.0, 0.0, 30.0, 10.0, 0.0, 20.0, 30.0, 20.0, 30.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 40.0, 10.0, 20.0, 20.0, 220.0, 50.0, 90.0, 20.0, 30.0, 20.0, 190.0, 80.0, 20.0, 80.0, 40.0, 40.0, 0.0, 30.0, 170.0, 40.0, 30.0, 0.0, 40.0, 40.0, 180.0, 30.0, 0.0, 0.0, 30.0, 110.0, 0.0, 10.0, 50.0, 20.0, 20.0, 30.0, 10.0, 20.0, 50.0, 10.0, 460.0, 30.0, 30.0, 100.0, 0.0, 460.0, 160.0, 50.0, 10.0, 30.0, 20.0, 40.0, 10.0, 20.0, 40.0, 10.0, 60.0, 0.0, 160.0, 20.0, 10.0, 10.0, 10.0, 80.0, 40.0, 70.0, 170.0, 30.0, 10.0, 0.0, 20.0, 0.0, 20.0, 50.0, 10.0, 770.0, 40.0, 290.0, 50.0, 160.0, 30.0, 40.0, 50.0, 60.0, 5.0, 20.0, 10.0, 20.0, 20.0, 10.0, 10.0, 70.0, 780.0, 0.0, 30.0, 20.0, 370.0, -70.0, 160.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 40.0, 70.0, 60.0, 80.0, 250.0, 0.0, 30.0, 40.0, 0.0, 40.0, 0.0, 20.0, 0.0, 20.0, 30.0, 40.0, 20.0, 20.0, 40.0, 370.0, 20.0, 20.0, 100.0, 0.0, 60.0, 10.0, 40.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 180.0, 80.0, 40.0, 370.0, 20.0, 40.0, 20.0, 0.0, 140.0, 30.0, 30.0, 40.0, 20.0, 30.0, 0.0, 20.0, 10.0, 50.0, 0.0, 160.0, 50.0, 40.0, 30.0, 40.0, 0.0, 90.0, 50.0, 30.0, 30.0, 0.0, 10.0, 10.0, 90.0, 610.0, 90.0, 30.0, 40.0, 40.0, 0.0, 20.0, 470.0, 150.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 40.0, 90.0, 0.0, 0.0, 20.0, 30.0, 30.0, 0.0, 0.0, 0.0, 20.0, 10.0, 40.0, 0.0, 30.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4350864690514877, "mean_inference_ms": 1.6354104848070632, "mean_action_processing_ms": 0.4232652256573177, "mean_env_wait_ms": 1.3140955826950134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05978512763977051, "StateBufferConnector_ms": 0.009511947631835938, "ViewRequirementAgentConnector_ms": 0.3787248134613037}, "num_episodes": 22, "episode_return_max": 1610.0, "episode_return_min": -290.0, "episode_return_mean": 559.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.376749225733455, "num_env_steps_trained_throughput_per_sec": 36.376749225733455, "timesteps_total": 432000, "num_env_steps_sampled_lifetime": 432000, "num_agent_steps_sampled_lifetime": 4320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4320000, "timers": {"training_iteration_time_ms": 110559.191, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110559.14, "sample_time_ms": 2397.511, "learn_time_ms": 108140.978, "learn_throughput": 36.989, "synch_weights_time_ms": 12.244}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 4320000, "num_agent_steps_trained": 4320000}, "done": false, "training_iteration": 108, "trial_id": "57140_00000", "date": "2024-06-27_02-38-25", "timestamp": 1719470305, "time_this_iter_s": 109.97434306144714, "time_total_s": 12230.788087844849, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b193b0d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12230.788087844849, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 15.290967741935484, "ram_util_percent": 77.25548387096774}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.0372928730088176, "cur_kl_coeff": 7.397803211145217, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.161751670959277, "policy_loss": -0.0019576879895636386, "vf_loss": 5.161344589846838, "vf_explained_var": 3.5389023213086926e-05, "kl": 0.0003196584958728648, "entropy": 0.3409484926392984, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1018815.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000}, "env_runners": {"episode_reward_max": 1490.0, "episode_reward_min": -290.0, "episode_reward_mean": 569.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -910.0}, "policy_reward_max": {"policy_0": 780.0}, "policy_reward_mean": {"policy_0": 56.965}, "custom_metrics": {}, "hist_stats": {"episode_reward": [760.0, 240.0, 200.0, 415.0, 455.0, 450.0, 740.0, 240.0, 160.0, 430.0, 250.0, 370.0, 1070.0, 500.0, 580.0, 1130.0, 690.0, 390.0, 290.0, 420.0, 1140.0, 1080.0, 1240.0, 150.0, 370.0, 140.0, 580.0, 510.0, 555.0, 550.0, 1270.0, 300.0, 310.0, 585.0, 260.0, 140.0, 460.0, 150.0, 270.0, 920.0, 490.0, 900.0, 280.0, 700.0, 600.0, 210.0, -290.0, 220.0, 720.0, 560.0, 480.0, 955.0, 550.0, 580.0, 330.0, 710.0, 220.0, 905.0, 1150.0, 700.0, 160.0, 140.0, 740.0, 470.0, 450.0, 680.0, 880.0, 340.0, 440.0, 1490.0, 1005.0, 600.0, 610.0, 190.0, 670.0, 690.0, 370.0, 400.0, 920.0, 870.0, 230.0, 140.0, 340.0, 1310.0, 1440.0, 500.0, 150.0, 150.0, 320.0, 960.0, 200.0, 980.0, 730.0, 520.0, 1090.0, 1120.0, 1010.0, 660.0, 750.0, 520.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 0.0, 10.0, 200.0, 40.0, 0.0, 40.0, 310.0, 20.0, 40.0, 10.0, 20.0, 80.0, 10.0, 10.0, 10.0, 20.0, 0.0, 40.0, 40.0, 10.0, 20.0, 20.0, 40.0, 20.0, 10.0, 40.0, 10.0, 30.0, 0.0, 20.0, 40.0, 40.0, 0.0, 10.0, 0.0, 20.0, -5.0, 290.0, 0.0, 160.0, -5.0, 60.0, -10.0, 70.0, 40.0, 20.0, 20.0, 40.0, 60.0, 0.0, 0.0, 60.0, 20.0, 30.0, 40.0, 30.0, 40.0, 160.0, 70.0, 20.0, 20.0, 0.0, 60.0, 40.0, 20.0, 190.0, 20.0, 350.0, 20.0, 0.0, 0.0, 50.0, 0.0, 10.0, 160.0, 10.0, 0.0, 10.0, 0.0, 50.0, 20.0, 30.0, 20.0, 0.0, 0.0, 0.0, 20.0, 0.0, 20.0, 60.0, 20.0, -70.0, 20.0, 10.0, 40.0, 10.0, 170.0, 170.0, 0.0, 30.0, 30.0, 0.0, 0.0, 10.0, 30.0, 40.0, 40.0, 10.0, 60.0, 30.0, 10.0, 30.0, 40.0, 190.0, 20.0, 30.0, 10.0, 0.0, 10.0, 40.0, 80.0, 50.0, 180.0, 30.0, 80.0, 90.0, 160.0, 360.0, 0.0, 20.0, 0.0, 20.0, 20.0, -50.0, 30.0, 0.0, -30.0, 30.0, 460.0, 70.0, 250.0, 40.0, 40.0, 10.0, 20.0, 0.0, 30.0, 60.0, 60.0, 50.0, 100.0, 490.0, 30.0, 40.0, 40.0, 0.0, 270.0, 50.0, 60.0, 0.0, 10.0, 80.0, 20.0, -40.0, 0.0, -30.0, 10.0, -20.0, 660.0, 0.0, 30.0, 20.0, -100.0, -50.0, 0.0, 0.0, 0.0, 30.0, 460.0, 0.0, 40.0, 40.0, 60.0, 10.0, 30.0, 70.0, 10.0, 10.0, 20.0, 30.0, 20.0, 120.0, 10.0, 110.0, 30.0, 20.0, 0.0, 40.0, 40.0, 20.0, 40.0, 160.0, 50.0, 160.0, 0.0, 210.0, 30.0, 310.0, 160.0, 170.0, 450.0, 90.0, 180.0, 30.0, 30.0, 40.0, 20.0, 10.0, 60.0, 320.0, 20.0, 120.0, 20.0, 20.0, 600.0, 10.0, 60.0, 0.0, 70.0, 40.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 40.0, 30.0, 20.0, 10.0, 10.0, 120.0, 30.0, 0.0, 30.0, 10.0, 30.0, 110.0, 0.0, 0.0, 10.0, 10.0, 40.0, 20.0, 10.0, 30.0, 0.0, 20.0, 10.0, 260.0, 30.0, 10.0, 100.0, 0.0, 20.0, 120.0, 0.0, 30.0, 20.0, 20.0, 10.0, 20.0, 60.0, 70.0, 0.0, 110.0, 240.0, -40.0, 30.0, 10.0, 70.0, 40.0, 30.0, 200.0, 50.0, 60.0, 80.0, -15.0, 140.0, 0.0, 10.0, 20.0, 10.0, 180.0, 180.0, 10.0, 30.0, -30.0, 100.0, 300.0, 460.0, 40.0, 90.0, 40.0, 30.0, 10.0, 180.0, 20.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 0.0, 190.0, 40.0, 10.0, 10.0, 40.0, 170.0, 0.0, 10.0, 20.0, 50.0, 0.0, 10.0, 0.0, 20.0, 0.0, 40.0, 20.0, 60.0, 150.0, 250.0, 20.0, 5.0, 20.0, 0.0, 60.0, 30.0, 0.0, 60.0, 10.0, 30.0, 30.0, 20.0, 20.0, 0.0, 10.0, 40.0, 20.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, 60.0, 0.0, 50.0, 20.0, 180.0, 0.0, 50.0, 10.0, 40.0, 50.0, 0.0, 40.0, 20.0, 40.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 100.0, 0.0, 30.0, 80.0, 20.0, 200.0, 60.0, 0.0, 0.0, -10.0, 280.0, 60.0, 290.0, 20.0, 20.0, 40.0, 10.0, 90.0, 0.0, 30.0, 0.0, 190.0, 40.0, 40.0, 50.0, 70.0, 80.0, 40.0, 160.0, 0.0, 80.0, 0.0, 60.0, 370.0, 40.0, 0.0, 90.0, 10.0, 30.0, 20.0, 30.0, 30.0, 40.0, 20.0, 10.0, 450.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 50.0, 10.0, 70.0, 20.0, 40.0, 20.0, 10.0, 360.0, 20.0, 40.0, 30.0, 50.0, 10.0, 0.0, 10.0, 20.0, 10.0, 40.0, 0.0, 70.0, 40.0, 0.0, 20.0, 20.0, 0.0, 0.0, 220.0, 20.0, 100.0, 190.0, 50.0, -910.0, 20.0, 10.0, 10.0, 10.0, 20.0, 40.0, 70.0, 10.0, 30.0, 0.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 10.0, 50.0, 70.0, 460.0, 20.0, 0.0, 250.0, 10.0, 10.0, 50.0, 30.0, 0.0, 160.0, 40.0, 10.0, 20.0, 10.0, 30.0, 20.0, 0.0, 160.0, 60.0, 0.0, 160.0, 20.0, 80.0, 100.0, -10.0, 30.0, -20.0, 5.0, 620.0, 0.0, 160.0, -10.0, 0.0, 0.0, 370.0, 30.0, 40.0, 0.0, 0.0, 40.0, 10.0, 60.0, 160.0, 170.0, 20.0, 20.0, 60.0, 30.0, 30.0, 30.0, 40.0, 20.0, 0.0, 10.0, 160.0, 20.0, 10.0, -10.0, 20.0, 30.0, 50.0, 40.0, 40.0, 20.0, 20.0, 0.0, 0.0, 80.0, 120.0, 270.0, 20.0, 140.0, 10.0, 20.0, 40.0, 10.0, 10.0, 10.0, 60.0, 10.0, 10.0, 40.0, 60.0, 0.0, 100.0, -5.0, 110.0, 20.0, 500.0, 20.0, 20.0, 80.0, 190.0, 170.0, 160.0, 60.0, 170.0, 0.0, 0.0, 290.0, 50.0, 60.0, 40.0, 50.0, 210.0, 40.0, 0.0, 180.0, 70.0, 0.0, 60.0, 50.0, 20.0, 0.0, 30.0, 10.0, 0.0, 20.0, 30.0, 20.0, 30.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 40.0, 10.0, 20.0, 20.0, 220.0, 50.0, 90.0, 20.0, 30.0, 20.0, 190.0, 80.0, 20.0, 80.0, 40.0, 40.0, 0.0, 30.0, 170.0, 40.0, 30.0, 0.0, 40.0, 40.0, 180.0, 30.0, 0.0, 0.0, 30.0, 110.0, 0.0, 10.0, 50.0, 20.0, 20.0, 30.0, 10.0, 20.0, 50.0, 10.0, 460.0, 30.0, 30.0, 100.0, 0.0, 460.0, 160.0, 50.0, 10.0, 30.0, 20.0, 40.0, 10.0, 20.0, 40.0, 10.0, 60.0, 0.0, 160.0, 20.0, 10.0, 10.0, 10.0, 80.0, 40.0, 70.0, 170.0, 30.0, 10.0, 0.0, 20.0, 0.0, 20.0, 50.0, 10.0, 770.0, 40.0, 290.0, 50.0, 160.0, 30.0, 40.0, 50.0, 60.0, 5.0, 20.0, 10.0, 20.0, 20.0, 10.0, 10.0, 70.0, 780.0, 0.0, 30.0, 20.0, 370.0, -70.0, 160.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 40.0, 70.0, 60.0, 80.0, 250.0, 0.0, 30.0, 40.0, 0.0, 40.0, 0.0, 20.0, 0.0, 20.0, 30.0, 40.0, 20.0, 20.0, 40.0, 370.0, 20.0, 20.0, 100.0, 0.0, 60.0, 10.0, 40.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 180.0, 80.0, 40.0, 370.0, 20.0, 40.0, 20.0, 0.0, 140.0, 30.0, 30.0, 40.0, 20.0, 30.0, 0.0, 20.0, 10.0, 50.0, 0.0, 160.0, 50.0, 40.0, 30.0, 40.0, 0.0, 90.0, 50.0, 30.0, 30.0, 0.0, 10.0, 10.0, 90.0, 610.0, 90.0, 30.0, 40.0, 40.0, 0.0, 20.0, 470.0, 150.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 40.0, 90.0, 0.0, 0.0, 20.0, 30.0, 30.0, 0.0, 0.0, 0.0, 20.0, 10.0, 40.0, 0.0, 30.0, 10.0, 30.0, 90.0, 0.0, 40.0, 30.0, 40.0, 30.0, 40.0, 10.0, 30.0, 90.0, 170.0, 210.0, 160.0, 60.0, 290.0, 40.0, 190.0, 70.0, 30.0, 40.0, 120.0, -10.0, 40.0, 80.0, 90.0, 330.0, 30.0, 70.0, 650.0, 20.0, 30.0, 0.0, 90.0, 30.0, 20.0, 260.0, 0.0, 40.0, 10.0, 0.0, 20.0, 0.0, 30.0, 30.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 50.0, 30.0, 0.0, 10.0, 20.0, 20.0, 0.0, 20.0, 0.0, 40.0, 30.0, 10.0, 0.0, 50.0, 30.0, 60.0, 30.0, 40.0, 30.0, 370.0, 10.0, 50.0, 40.0, 30.0, 30.0, 290.0, 70.0, 30.0, 40.0, 30.0, 20.0, 20.0, 0.0, 80.0, 0.0, 0.0, 0.0, 10.0, 40.0, 140.0, 40.0, 90.0, 400.0, 50.0, 80.0, 30.0, 70.0, 40.0, 40.0, 20.0, 0.0, 30.0, 350.0, -50.0, 190.0, 30.0, 30.0, 40.0, 90.0, 20.0, 10.0, 40.0, 170.0, 20.0, 30.0, 170.0, 20.0, 40.0, 0.0, 170.0, 70.0, 20.0, 670.0, 20.0, 30.0, 50.0, 40.0, 20.0, 0.0, -50.0, 350.0, 10.0, 100.0, 40.0, 40.0, 60.0, 110.0, 90.0, 370.0, 240.0, 30.0, -60.0, 150.0, 50.0, 10.0, 10.0, 20.0, 0.0, 560.0, 40.0, 150.0, 20.0, 30.0, 150.0, 40.0, 100.0, 40.0, 10.0, 80.0, 30.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 570.0, 20.0, 70.0, 0.0, 80.0, 10.0, 30.0, 70.0, 280.0, 0.0, 20.0, 0.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4340490778880175, "mean_inference_ms": 1.6343577882842073, "mean_action_processing_ms": 0.4229372668174114, "mean_env_wait_ms": 1.3133649375300829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05996346473693848, "StateBufferConnector_ms": 0.009518861770629883, "ViewRequirementAgentConnector_ms": 0.38536810874938965}, "num_episodes": 18, "episode_return_max": 1490.0, "episode_return_min": -290.0, "episode_return_mean": 569.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.40805351052568, "num_env_steps_trained_throughput_per_sec": 36.40805351052568, "timesteps_total": 436000, "num_env_steps_sampled_lifetime": 436000, "num_agent_steps_sampled_lifetime": 4360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4360000, "timers": {"training_iteration_time_ms": 110578.314, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110578.263, "sample_time_ms": 2399.088, "learn_time_ms": 108158.643, "learn_throughput": 36.983, "synch_weights_time_ms": 12.2}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 4360000, "num_agent_steps_trained": 4360000}, "done": false, "training_iteration": 109, "trial_id": "57140_00000", "date": "2024-06-27_02-40-15", "timestamp": 1719470415, "time_this_iter_s": 109.87905311584473, "time_total_s": 12340.667140960693, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b25baa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12340.667140960693, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 15.242307692307694, "ram_util_percent": 77.41217948717949}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4229829057337, "cur_kl_coeff": 3.6989016055726087, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002541383940982409, "vf_loss": 4.223740544283606, "vf_explained_var": 0.000648589782948438, "kl": Infinity, "entropy": 0.3599468134192867, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1028205.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000}, "env_runners": {"episode_reward_max": 1530.0, "episode_reward_min": -290.0, "episode_reward_mean": 602.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -910.0}, "policy_reward_max": {"policy_0": 780.0}, "policy_reward_mean": {"policy_0": 60.215}, "custom_metrics": {}, "hist_stats": {"episode_reward": [290.0, 420.0, 1140.0, 1080.0, 1240.0, 150.0, 370.0, 140.0, 580.0, 510.0, 555.0, 550.0, 1270.0, 300.0, 310.0, 585.0, 260.0, 140.0, 460.0, 150.0, 270.0, 920.0, 490.0, 900.0, 280.0, 700.0, 600.0, 210.0, -290.0, 220.0, 720.0, 560.0, 480.0, 955.0, 550.0, 580.0, 330.0, 710.0, 220.0, 905.0, 1150.0, 700.0, 160.0, 140.0, 740.0, 470.0, 450.0, 680.0, 880.0, 340.0, 440.0, 1490.0, 1005.0, 600.0, 610.0, 190.0, 670.0, 690.0, 370.0, 400.0, 920.0, 870.0, 230.0, 140.0, 340.0, 1310.0, 1440.0, 500.0, 150.0, 150.0, 320.0, 960.0, 200.0, 980.0, 730.0, 520.0, 1090.0, 1120.0, 1010.0, 660.0, 750.0, 520.0, 400.0, 1050.0, 800.0, 290.0, 380.0, 595.0, 400.0, 440.0, 1530.0, 290.0, 1060.0, 310.0, 1375.0, 1050.0, 1020.0, 275.0, 905.0, 150.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 40.0, 40.0, 60.0, 10.0, 30.0, 70.0, 10.0, 10.0, 20.0, 30.0, 20.0, 120.0, 10.0, 110.0, 30.0, 20.0, 0.0, 40.0, 40.0, 20.0, 40.0, 160.0, 50.0, 160.0, 0.0, 210.0, 30.0, 310.0, 160.0, 170.0, 450.0, 90.0, 180.0, 30.0, 30.0, 40.0, 20.0, 10.0, 60.0, 320.0, 20.0, 120.0, 20.0, 20.0, 600.0, 10.0, 60.0, 0.0, 70.0, 40.0, 20.0, 10.0, 0.0, 0.0, 10.0, 0.0, 0.0, 40.0, 30.0, 20.0, 10.0, 10.0, 120.0, 30.0, 0.0, 30.0, 10.0, 30.0, 110.0, 0.0, 0.0, 10.0, 10.0, 40.0, 20.0, 10.0, 30.0, 0.0, 20.0, 10.0, 260.0, 30.0, 10.0, 100.0, 0.0, 20.0, 120.0, 0.0, 30.0, 20.0, 20.0, 10.0, 20.0, 60.0, 70.0, 0.0, 110.0, 240.0, -40.0, 30.0, 10.0, 70.0, 40.0, 30.0, 200.0, 50.0, 60.0, 80.0, -15.0, 140.0, 0.0, 10.0, 20.0, 10.0, 180.0, 180.0, 10.0, 30.0, -30.0, 100.0, 300.0, 460.0, 40.0, 90.0, 40.0, 30.0, 10.0, 180.0, 20.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 0.0, 190.0, 40.0, 10.0, 10.0, 40.0, 170.0, 0.0, 10.0, 20.0, 50.0, 0.0, 10.0, 0.0, 20.0, 0.0, 40.0, 20.0, 60.0, 150.0, 250.0, 20.0, 5.0, 20.0, 0.0, 60.0, 30.0, 0.0, 60.0, 10.0, 30.0, 30.0, 20.0, 20.0, 0.0, 10.0, 40.0, 20.0, 20.0, 0.0, 10.0, 20.0, 20.0, 0.0, 60.0, 0.0, 50.0, 20.0, 180.0, 0.0, 50.0, 10.0, 40.0, 50.0, 0.0, 40.0, 20.0, 40.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 0.0, 0.0, 10.0, 20.0, 10.0, 100.0, 0.0, 30.0, 80.0, 20.0, 200.0, 60.0, 0.0, 0.0, -10.0, 280.0, 60.0, 290.0, 20.0, 20.0, 40.0, 10.0, 90.0, 0.0, 30.0, 0.0, 190.0, 40.0, 40.0, 50.0, 70.0, 80.0, 40.0, 160.0, 0.0, 80.0, 0.0, 60.0, 370.0, 40.0, 0.0, 90.0, 10.0, 30.0, 20.0, 30.0, 30.0, 40.0, 20.0, 10.0, 450.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 50.0, 10.0, 70.0, 20.0, 40.0, 20.0, 10.0, 360.0, 20.0, 40.0, 30.0, 50.0, 10.0, 0.0, 10.0, 20.0, 10.0, 40.0, 0.0, 70.0, 40.0, 0.0, 20.0, 20.0, 0.0, 0.0, 220.0, 20.0, 100.0, 190.0, 50.0, -910.0, 20.0, 10.0, 10.0, 10.0, 20.0, 40.0, 70.0, 10.0, 30.0, 0.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 10.0, 50.0, 70.0, 460.0, 20.0, 0.0, 250.0, 10.0, 10.0, 50.0, 30.0, 0.0, 160.0, 40.0, 10.0, 20.0, 10.0, 30.0, 20.0, 0.0, 160.0, 60.0, 0.0, 160.0, 20.0, 80.0, 100.0, -10.0, 30.0, -20.0, 5.0, 620.0, 0.0, 160.0, -10.0, 0.0, 0.0, 370.0, 30.0, 40.0, 0.0, 0.0, 40.0, 10.0, 60.0, 160.0, 170.0, 20.0, 20.0, 60.0, 30.0, 30.0, 30.0, 40.0, 20.0, 0.0, 10.0, 160.0, 20.0, 10.0, -10.0, 20.0, 30.0, 50.0, 40.0, 40.0, 20.0, 20.0, 0.0, 0.0, 80.0, 120.0, 270.0, 20.0, 140.0, 10.0, 20.0, 40.0, 10.0, 10.0, 10.0, 60.0, 10.0, 10.0, 40.0, 60.0, 0.0, 100.0, -5.0, 110.0, 20.0, 500.0, 20.0, 20.0, 80.0, 190.0, 170.0, 160.0, 60.0, 170.0, 0.0, 0.0, 290.0, 50.0, 60.0, 40.0, 50.0, 210.0, 40.0, 0.0, 180.0, 70.0, 0.0, 60.0, 50.0, 20.0, 0.0, 30.0, 10.0, 0.0, 20.0, 30.0, 20.0, 30.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 40.0, 10.0, 20.0, 20.0, 220.0, 50.0, 90.0, 20.0, 30.0, 20.0, 190.0, 80.0, 20.0, 80.0, 40.0, 40.0, 0.0, 30.0, 170.0, 40.0, 30.0, 0.0, 40.0, 40.0, 180.0, 30.0, 0.0, 0.0, 30.0, 110.0, 0.0, 10.0, 50.0, 20.0, 20.0, 30.0, 10.0, 20.0, 50.0, 10.0, 460.0, 30.0, 30.0, 100.0, 0.0, 460.0, 160.0, 50.0, 10.0, 30.0, 20.0, 40.0, 10.0, 20.0, 40.0, 10.0, 60.0, 0.0, 160.0, 20.0, 10.0, 10.0, 10.0, 80.0, 40.0, 70.0, 170.0, 30.0, 10.0, 0.0, 20.0, 0.0, 20.0, 50.0, 10.0, 770.0, 40.0, 290.0, 50.0, 160.0, 30.0, 40.0, 50.0, 60.0, 5.0, 20.0, 10.0, 20.0, 20.0, 10.0, 10.0, 70.0, 780.0, 0.0, 30.0, 20.0, 370.0, -70.0, 160.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 40.0, 70.0, 60.0, 80.0, 250.0, 0.0, 30.0, 40.0, 0.0, 40.0, 0.0, 20.0, 0.0, 20.0, 30.0, 40.0, 20.0, 20.0, 40.0, 370.0, 20.0, 20.0, 100.0, 0.0, 60.0, 10.0, 40.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 180.0, 80.0, 40.0, 370.0, 20.0, 40.0, 20.0, 0.0, 140.0, 30.0, 30.0, 40.0, 20.0, 30.0, 0.0, 20.0, 10.0, 50.0, 0.0, 160.0, 50.0, 40.0, 30.0, 40.0, 0.0, 90.0, 50.0, 30.0, 30.0, 0.0, 10.0, 10.0, 90.0, 610.0, 90.0, 30.0, 40.0, 40.0, 0.0, 20.0, 470.0, 150.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 40.0, 90.0, 0.0, 0.0, 20.0, 30.0, 30.0, 0.0, 0.0, 0.0, 20.0, 10.0, 40.0, 0.0, 30.0, 10.0, 30.0, 90.0, 0.0, 40.0, 30.0, 40.0, 30.0, 40.0, 10.0, 30.0, 90.0, 170.0, 210.0, 160.0, 60.0, 290.0, 40.0, 190.0, 70.0, 30.0, 40.0, 120.0, -10.0, 40.0, 80.0, 90.0, 330.0, 30.0, 70.0, 650.0, 20.0, 30.0, 0.0, 90.0, 30.0, 20.0, 260.0, 0.0, 40.0, 10.0, 0.0, 20.0, 0.0, 30.0, 30.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 50.0, 30.0, 0.0, 10.0, 20.0, 20.0, 0.0, 20.0, 0.0, 40.0, 30.0, 10.0, 0.0, 50.0, 30.0, 60.0, 30.0, 40.0, 30.0, 370.0, 10.0, 50.0, 40.0, 30.0, 30.0, 290.0, 70.0, 30.0, 40.0, 30.0, 20.0, 20.0, 0.0, 80.0, 0.0, 0.0, 0.0, 10.0, 40.0, 140.0, 40.0, 90.0, 400.0, 50.0, 80.0, 30.0, 70.0, 40.0, 40.0, 20.0, 0.0, 30.0, 350.0, -50.0, 190.0, 30.0, 30.0, 40.0, 90.0, 20.0, 10.0, 40.0, 170.0, 20.0, 30.0, 170.0, 20.0, 40.0, 0.0, 170.0, 70.0, 20.0, 670.0, 20.0, 30.0, 50.0, 40.0, 20.0, 0.0, -50.0, 350.0, 10.0, 100.0, 40.0, 40.0, 60.0, 110.0, 90.0, 370.0, 240.0, 30.0, -60.0, 150.0, 50.0, 10.0, 10.0, 20.0, 0.0, 560.0, 40.0, 150.0, 20.0, 30.0, 150.0, 40.0, 100.0, 40.0, 10.0, 80.0, 30.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 570.0, 20.0, 70.0, 0.0, 80.0, 10.0, 30.0, 70.0, 280.0, 0.0, 20.0, 0.0, 30.0, 0.0, 0.0, 20.0, 10.0, 40.0, 10.0, 30.0, 250.0, 10.0, 30.0, 20.0, 310.0, 0.0, 40.0, 60.0, 70.0, 40.0, 10.0, 450.0, 50.0, 20.0, 50.0, 360.0, 30.0, 40.0, 40.0, 200.0, 30.0, 30.0, 0.0, 30.0, 0.0, 10.0, 10.0, 50.0, 20.0, 0.0, 150.0, 20.0, 0.0, 60.0, 70.0, 20.0, 20.0, 150.0, 0.0, 20.0, 0.0, 10.0, 30.0, -5.0, 30.0, 20.0, 170.0, 170.0, 30.0, 0.0, 0.0, 120.0, 60.0, 60.0, 50.0, 20.0, 10.0, 20.0, 30.0, 20.0, 150.0, 40.0, 0.0, 80.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, 130.0, 120.0, 50.0, 30.0, 170.0, 390.0, 590.0, 160.0, 50.0, 80.0, 50.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 160.0, 10.0, 0.0, 30.0, 20.0, 30.0, 90.0, 30.0, 10.0, 50.0, 190.0, 10.0, 50.0, 30.0, 40.0, 560.0, 0.0, 40.0, 140.0, 70.0, 10.0, 0.0, 20.0, 10.0, 20.0, 0.0, 30.0, 10.0, 170.0, 560.0, 35.0, 40.0, 300.0, 20.0, 110.0, 100.0, 60.0, 260.0, 80.0, 60.0, 80.0, 20.0, 160.0, 30.0, 40.0, 260.0, 20.0, 270.0, 50.0, 150.0, 30.0, 350.0, 60.0, 60.0, 30.0, 0.0, -45.0, 0.0, 120.0, 20.0, 20.0, 10.0, 30.0, 100.0, 30.0, -10.0, 180.0, 60.0, 10.0, 10.0, 35.0, 30.0, 60.0, 30.0, 460.0, 30.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 70.0, 10.0, 10.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4330587315492012, "mean_inference_ms": 1.6334004326185936, "mean_action_processing_ms": 0.4226270273775826, "mean_env_wait_ms": 1.312721455072336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05957937240600586, "StateBufferConnector_ms": 0.009506464004516602, "ViewRequirementAgentConnector_ms": 0.3849470615386963}, "num_episodes": 18, "episode_return_max": 1530.0, "episode_return_min": -290.0, "episode_return_mean": 602.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.31641577206761, "num_env_steps_trained_throughput_per_sec": 36.31641577206761, "timesteps_total": 440000, "num_env_steps_sampled_lifetime": 440000, "num_agent_steps_sampled_lifetime": 4400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4400000, "timers": {"training_iteration_time_ms": 110662.404, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110662.353, "sample_time_ms": 2406.271, "learn_time_ms": 108235.25, "learn_throughput": 36.957, "synch_weights_time_ms": 12.116}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 4400000, "num_agent_steps_trained": 4400000}, "done": false, "training_iteration": 110, "trial_id": "57140_00000", "date": "2024-06-27_02-42-05", "timestamp": 1719470525, "time_this_iter_s": 110.15482330322266, "time_total_s": 12450.821964263916, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b25c2e50>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12450.821964263916, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 15.374358974358975, "ram_util_percent": 77.7275641025641}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5628285977215812, "cur_kl_coeff": 5.548352408358914, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.334637334831734, "policy_loss": -0.002716986017919833, "vf_loss": 4.335283560214586, "vf_explained_var": 0.0007720202175826945, "kl": 0.00037322064290961, "entropy": 0.3420464814566195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1037595.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000}, "env_runners": {"episode_reward_max": 1530.0, "episode_reward_min": -290.0, "episode_reward_mean": 631.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -910.0}, "policy_reward_max": {"policy_0": 1090.0}, "policy_reward_mean": {"policy_0": 63.135}, "custom_metrics": {}, "hist_stats": {"episode_reward": [900.0, 280.0, 700.0, 600.0, 210.0, -290.0, 220.0, 720.0, 560.0, 480.0, 955.0, 550.0, 580.0, 330.0, 710.0, 220.0, 905.0, 1150.0, 700.0, 160.0, 140.0, 740.0, 470.0, 450.0, 680.0, 880.0, 340.0, 440.0, 1490.0, 1005.0, 600.0, 610.0, 190.0, 670.0, 690.0, 370.0, 400.0, 920.0, 870.0, 230.0, 140.0, 340.0, 1310.0, 1440.0, 500.0, 150.0, 150.0, 320.0, 960.0, 200.0, 980.0, 730.0, 520.0, 1090.0, 1120.0, 1010.0, 660.0, 750.0, 520.0, 400.0, 1050.0, 800.0, 290.0, 380.0, 595.0, 400.0, 440.0, 1530.0, 290.0, 1060.0, 310.0, 1375.0, 1050.0, 1020.0, 275.0, 905.0, 150.0, 700.0, 300.0, 950.0, 650.0, 460.0, 900.0, 740.0, 230.0, 1140.0, 870.0, 325.0, 1460.0, 520.0, 190.0, 535.0, 1130.0, 720.0, 190.0, 330.0, 1130.0, 240.0, 770.0, 620.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 80.0, 40.0, 160.0, 0.0, 80.0, 0.0, 60.0, 370.0, 40.0, 0.0, 90.0, 10.0, 30.0, 20.0, 30.0, 30.0, 40.0, 20.0, 10.0, 450.0, 20.0, 20.0, 20.0, 10.0, 20.0, 30.0, 50.0, 10.0, 70.0, 20.0, 40.0, 20.0, 10.0, 360.0, 20.0, 40.0, 30.0, 50.0, 10.0, 0.0, 10.0, 20.0, 10.0, 40.0, 0.0, 70.0, 40.0, 0.0, 20.0, 20.0, 0.0, 0.0, 220.0, 20.0, 100.0, 190.0, 50.0, -910.0, 20.0, 10.0, 10.0, 10.0, 20.0, 40.0, 70.0, 10.0, 30.0, 0.0, 20.0, 20.0, 30.0, 20.0, 10.0, 30.0, 10.0, 50.0, 70.0, 460.0, 20.0, 0.0, 250.0, 10.0, 10.0, 50.0, 30.0, 0.0, 160.0, 40.0, 10.0, 20.0, 10.0, 30.0, 20.0, 0.0, 160.0, 60.0, 0.0, 160.0, 20.0, 80.0, 100.0, -10.0, 30.0, -20.0, 5.0, 620.0, 0.0, 160.0, -10.0, 0.0, 0.0, 370.0, 30.0, 40.0, 0.0, 0.0, 40.0, 10.0, 60.0, 160.0, 170.0, 20.0, 20.0, 60.0, 30.0, 30.0, 30.0, 40.0, 20.0, 0.0, 10.0, 160.0, 20.0, 10.0, -10.0, 20.0, 30.0, 50.0, 40.0, 40.0, 20.0, 20.0, 0.0, 0.0, 80.0, 120.0, 270.0, 20.0, 140.0, 10.0, 20.0, 40.0, 10.0, 10.0, 10.0, 60.0, 10.0, 10.0, 40.0, 60.0, 0.0, 100.0, -5.0, 110.0, 20.0, 500.0, 20.0, 20.0, 80.0, 190.0, 170.0, 160.0, 60.0, 170.0, 0.0, 0.0, 290.0, 50.0, 60.0, 40.0, 50.0, 210.0, 40.0, 0.0, 180.0, 70.0, 0.0, 60.0, 50.0, 20.0, 0.0, 30.0, 10.0, 0.0, 20.0, 30.0, 20.0, 30.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 40.0, 10.0, 20.0, 20.0, 220.0, 50.0, 90.0, 20.0, 30.0, 20.0, 190.0, 80.0, 20.0, 80.0, 40.0, 40.0, 0.0, 30.0, 170.0, 40.0, 30.0, 0.0, 40.0, 40.0, 180.0, 30.0, 0.0, 0.0, 30.0, 110.0, 0.0, 10.0, 50.0, 20.0, 20.0, 30.0, 10.0, 20.0, 50.0, 10.0, 460.0, 30.0, 30.0, 100.0, 0.0, 460.0, 160.0, 50.0, 10.0, 30.0, 20.0, 40.0, 10.0, 20.0, 40.0, 10.0, 60.0, 0.0, 160.0, 20.0, 10.0, 10.0, 10.0, 80.0, 40.0, 70.0, 170.0, 30.0, 10.0, 0.0, 20.0, 0.0, 20.0, 50.0, 10.0, 770.0, 40.0, 290.0, 50.0, 160.0, 30.0, 40.0, 50.0, 60.0, 5.0, 20.0, 10.0, 20.0, 20.0, 10.0, 10.0, 70.0, 780.0, 0.0, 30.0, 20.0, 370.0, -70.0, 160.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 40.0, 70.0, 60.0, 80.0, 250.0, 0.0, 30.0, 40.0, 0.0, 40.0, 0.0, 20.0, 0.0, 20.0, 30.0, 40.0, 20.0, 20.0, 40.0, 370.0, 20.0, 20.0, 100.0, 0.0, 60.0, 10.0, 40.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 180.0, 80.0, 40.0, 370.0, 20.0, 40.0, 20.0, 0.0, 140.0, 30.0, 30.0, 40.0, 20.0, 30.0, 0.0, 20.0, 10.0, 50.0, 0.0, 160.0, 50.0, 40.0, 30.0, 40.0, 0.0, 90.0, 50.0, 30.0, 30.0, 0.0, 10.0, 10.0, 90.0, 610.0, 90.0, 30.0, 40.0, 40.0, 0.0, 20.0, 470.0, 150.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 40.0, 90.0, 0.0, 0.0, 20.0, 30.0, 30.0, 0.0, 0.0, 0.0, 20.0, 10.0, 40.0, 0.0, 30.0, 10.0, 30.0, 90.0, 0.0, 40.0, 30.0, 40.0, 30.0, 40.0, 10.0, 30.0, 90.0, 170.0, 210.0, 160.0, 60.0, 290.0, 40.0, 190.0, 70.0, 30.0, 40.0, 120.0, -10.0, 40.0, 80.0, 90.0, 330.0, 30.0, 70.0, 650.0, 20.0, 30.0, 0.0, 90.0, 30.0, 20.0, 260.0, 0.0, 40.0, 10.0, 0.0, 20.0, 0.0, 30.0, 30.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 50.0, 30.0, 0.0, 10.0, 20.0, 20.0, 0.0, 20.0, 0.0, 40.0, 30.0, 10.0, 0.0, 50.0, 30.0, 60.0, 30.0, 40.0, 30.0, 370.0, 10.0, 50.0, 40.0, 30.0, 30.0, 290.0, 70.0, 30.0, 40.0, 30.0, 20.0, 20.0, 0.0, 80.0, 0.0, 0.0, 0.0, 10.0, 40.0, 140.0, 40.0, 90.0, 400.0, 50.0, 80.0, 30.0, 70.0, 40.0, 40.0, 20.0, 0.0, 30.0, 350.0, -50.0, 190.0, 30.0, 30.0, 40.0, 90.0, 20.0, 10.0, 40.0, 170.0, 20.0, 30.0, 170.0, 20.0, 40.0, 0.0, 170.0, 70.0, 20.0, 670.0, 20.0, 30.0, 50.0, 40.0, 20.0, 0.0, -50.0, 350.0, 10.0, 100.0, 40.0, 40.0, 60.0, 110.0, 90.0, 370.0, 240.0, 30.0, -60.0, 150.0, 50.0, 10.0, 10.0, 20.0, 0.0, 560.0, 40.0, 150.0, 20.0, 30.0, 150.0, 40.0, 100.0, 40.0, 10.0, 80.0, 30.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 570.0, 20.0, 70.0, 0.0, 80.0, 10.0, 30.0, 70.0, 280.0, 0.0, 20.0, 0.0, 30.0, 0.0, 0.0, 20.0, 10.0, 40.0, 10.0, 30.0, 250.0, 10.0, 30.0, 20.0, 310.0, 0.0, 40.0, 60.0, 70.0, 40.0, 10.0, 450.0, 50.0, 20.0, 50.0, 360.0, 30.0, 40.0, 40.0, 200.0, 30.0, 30.0, 0.0, 30.0, 0.0, 10.0, 10.0, 50.0, 20.0, 0.0, 150.0, 20.0, 0.0, 60.0, 70.0, 20.0, 20.0, 150.0, 0.0, 20.0, 0.0, 10.0, 30.0, -5.0, 30.0, 20.0, 170.0, 170.0, 30.0, 0.0, 0.0, 120.0, 60.0, 60.0, 50.0, 20.0, 10.0, 20.0, 30.0, 20.0, 150.0, 40.0, 0.0, 80.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, 130.0, 120.0, 50.0, 30.0, 170.0, 390.0, 590.0, 160.0, 50.0, 80.0, 50.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 160.0, 10.0, 0.0, 30.0, 20.0, 30.0, 90.0, 30.0, 10.0, 50.0, 190.0, 10.0, 50.0, 30.0, 40.0, 560.0, 0.0, 40.0, 140.0, 70.0, 10.0, 0.0, 20.0, 10.0, 20.0, 0.0, 30.0, 10.0, 170.0, 560.0, 35.0, 40.0, 300.0, 20.0, 110.0, 100.0, 60.0, 260.0, 80.0, 60.0, 80.0, 20.0, 160.0, 30.0, 40.0, 260.0, 20.0, 270.0, 50.0, 150.0, 30.0, 350.0, 60.0, 60.0, 30.0, 0.0, -45.0, 0.0, 120.0, 20.0, 20.0, 10.0, 30.0, 100.0, 30.0, -10.0, 180.0, 60.0, 10.0, 10.0, 35.0, 30.0, 60.0, 30.0, 460.0, 30.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 70.0, 10.0, 10.0, 10.0, 150.0, 20.0, 300.0, 70.0, 0.0, 0.0, 60.0, 40.0, 0.0, 60.0, 0.0, 30.0, 40.0, 20.0, 30.0, 40.0, 60.0, 0.0, 40.0, 40.0, 20.0, 40.0, 70.0, 270.0, 160.0, 40.0, 170.0, 60.0, 70.0, 50.0, 60.0, 180.0, 10.0, 10.0, 150.0, 30.0, 30.0, 10.0, 0.0, 170.0, 20.0, 30.0, 40.0, 260.0, 0.0, 20.0, 70.0, 0.0, 0.0, 20.0, 0.0, 40.0, 0.0, 790.0, 10.0, 0.0, -70.0, 100.0, 20.0, 10.0, 20.0, 10.0, 40.0, 10.0, 0.0, 20.0, 60.0, 560.0, 20.0, 0.0, 30.0, 20.0, 30.0, 30.0, 0.0, 20.0, 30.0, 0.0, 10.0, 60.0, -10.0, 1090.0, -40.0, 30.0, 10.0, 0.0, -20.0, 10.0, 70.0, 0.0, 290.0, 100.0, 210.0, 30.0, 70.0, 50.0, 90.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 30.0, 50.0, 90.0, 15.0, 40.0, 90.0, 320.0, 20.0, 70.0, 480.0, 0.0, 190.0, 10.0, 130.0, 70.0, 170.0, 20.0, 80.0, 20.0, 20.0, 170.0, 0.0, 20.0, 0.0, 10.0, 180.0, 30.0, 20.0, 20.0, 0.0, 10.0, 10.0, 30.0, 40.0, 20.0, 10.0, 0.0, 100.0, 15.0, 30.0, 30.0, 180.0, 90.0, 50.0, 10.0, 30.0, 30.0, 10.0, 580.0, 80.0, 30.0, 0.0, 190.0, 80.0, 10.0, 120.0, 20.0, 10.0, -80.0, 30.0, 80.0, 40.0, 50.0, 120.0, 450.0, 0.0, 10.0, 50.0, 20.0, 10.0, 10.0, 10.0, 20.0, 30.0, 30.0, 0.0, 20.0, 190.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 30.0, 20.0, 30.0, 170.0, 130.0, 190.0, 180.0, 90.0, 30.0, 160.0, 100.0, 50.0, 60.0, 0.0, 0.0, 0.0, 10.0, 30.0, 40.0, 40.0, 40.0, 20.0, 0.0, 70.0, 0.0, 70.0, 0.0, 190.0, 160.0, 100.0, 150.0, 30.0, 10.0, 60.0, 40.0, 50.0, 100.0, 40.0, 60.0, 50.0, 30.0, 180.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4317457588279103, "mean_inference_ms": 1.6322848374035552, "mean_action_processing_ms": 0.4222932096243834, "mean_env_wait_ms": 1.3119852817745334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.060324668884277344, "StateBufferConnector_ms": 0.009702444076538086, "ViewRequirementAgentConnector_ms": 0.38297200202941895}, "num_episodes": 23, "episode_return_max": 1530.0, "episode_return_min": -290.0, "episode_return_mean": 631.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.31669570976398, "num_env_steps_trained_throughput_per_sec": 36.31669570976398, "timesteps_total": 444000, "num_env_steps_sampled_lifetime": 444000, "num_agent_steps_sampled_lifetime": 4440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4440000, "timers": {"training_iteration_time_ms": 110650.081, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110650.031, "sample_time_ms": 2416.047, "learn_time_ms": 108213.471, "learn_throughput": 36.964, "synch_weights_time_ms": 11.935}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 4440000, "num_agent_steps_trained": 4440000}, "done": false, "training_iteration": 111, "trial_id": "57140_00000", "date": "2024-06-27_02-43-55", "timestamp": 1719470635, "time_this_iter_s": 110.1572790145874, "time_total_s": 12560.979243278503, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b239e160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12560.979243278503, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 15.776774193548388, "ram_util_percent": 76.76516129032258}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5553892829992013, "cur_kl_coeff": 2.774176204179457, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002898463927949774, "vf_loss": 4.1576009138196675, "vf_explained_var": 0.0012925897606899436, "kl": Infinity, "entropy": 0.35696033984581377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1046985.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000}, "env_runners": {"episode_reward_max": 1530.0, "episode_reward_min": 140.0, "episode_reward_mean": 621.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -80.0}, "policy_reward_max": {"policy_0": 1090.0}, "policy_reward_mean": {"policy_0": 62.1}, "custom_metrics": {}, "hist_stats": {"episode_reward": [700.0, 160.0, 140.0, 740.0, 470.0, 450.0, 680.0, 880.0, 340.0, 440.0, 1490.0, 1005.0, 600.0, 610.0, 190.0, 670.0, 690.0, 370.0, 400.0, 920.0, 870.0, 230.0, 140.0, 340.0, 1310.0, 1440.0, 500.0, 150.0, 150.0, 320.0, 960.0, 200.0, 980.0, 730.0, 520.0, 1090.0, 1120.0, 1010.0, 660.0, 750.0, 520.0, 400.0, 1050.0, 800.0, 290.0, 380.0, 595.0, 400.0, 440.0, 1530.0, 290.0, 1060.0, 310.0, 1375.0, 1050.0, 1020.0, 275.0, 905.0, 150.0, 700.0, 300.0, 950.0, 650.0, 460.0, 900.0, 740.0, 230.0, 1140.0, 870.0, 325.0, 1460.0, 520.0, 190.0, 535.0, 1130.0, 720.0, 190.0, 330.0, 1130.0, 240.0, 770.0, 620.0, 290.0, 280.0, 340.0, 330.0, 930.0, 650.0, 300.0, 1080.0, 990.0, 280.0, 240.0, 500.0, 230.0, 250.0, 710.0, 325.0, 290.0, 730.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, 50.0, 210.0, 40.0, 0.0, 180.0, 70.0, 0.0, 60.0, 50.0, 20.0, 0.0, 30.0, 10.0, 0.0, 20.0, 30.0, 20.0, 30.0, 0.0, 30.0, 0.0, 0.0, 10.0, 10.0, 0.0, 20.0, 40.0, 10.0, 20.0, 20.0, 220.0, 50.0, 90.0, 20.0, 30.0, 20.0, 190.0, 80.0, 20.0, 80.0, 40.0, 40.0, 0.0, 30.0, 170.0, 40.0, 30.0, 0.0, 40.0, 40.0, 180.0, 30.0, 0.0, 0.0, 30.0, 110.0, 0.0, 10.0, 50.0, 20.0, 20.0, 30.0, 10.0, 20.0, 50.0, 10.0, 460.0, 30.0, 30.0, 100.0, 0.0, 460.0, 160.0, 50.0, 10.0, 30.0, 20.0, 40.0, 10.0, 20.0, 40.0, 10.0, 60.0, 0.0, 160.0, 20.0, 10.0, 10.0, 10.0, 80.0, 40.0, 70.0, 170.0, 30.0, 10.0, 0.0, 20.0, 0.0, 20.0, 50.0, 10.0, 770.0, 40.0, 290.0, 50.0, 160.0, 30.0, 40.0, 50.0, 60.0, 5.0, 20.0, 10.0, 20.0, 20.0, 10.0, 10.0, 70.0, 780.0, 0.0, 30.0, 20.0, 370.0, -70.0, 160.0, 30.0, 20.0, 20.0, 20.0, 20.0, 20.0, 40.0, 70.0, 60.0, 80.0, 250.0, 0.0, 30.0, 40.0, 0.0, 40.0, 0.0, 20.0, 0.0, 20.0, 30.0, 40.0, 20.0, 20.0, 40.0, 370.0, 20.0, 20.0, 100.0, 0.0, 60.0, 10.0, 40.0, 10.0, 0.0, 0.0, 10.0, 0.0, 10.0, 0.0, 180.0, 80.0, 40.0, 370.0, 20.0, 40.0, 20.0, 0.0, 140.0, 30.0, 30.0, 40.0, 20.0, 30.0, 0.0, 20.0, 10.0, 50.0, 0.0, 160.0, 50.0, 40.0, 30.0, 40.0, 0.0, 90.0, 50.0, 30.0, 30.0, 0.0, 10.0, 10.0, 90.0, 610.0, 90.0, 30.0, 40.0, 40.0, 0.0, 20.0, 470.0, 150.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 40.0, 90.0, 0.0, 0.0, 20.0, 30.0, 30.0, 0.0, 0.0, 0.0, 20.0, 10.0, 40.0, 0.0, 30.0, 10.0, 30.0, 90.0, 0.0, 40.0, 30.0, 40.0, 30.0, 40.0, 10.0, 30.0, 90.0, 170.0, 210.0, 160.0, 60.0, 290.0, 40.0, 190.0, 70.0, 30.0, 40.0, 120.0, -10.0, 40.0, 80.0, 90.0, 330.0, 30.0, 70.0, 650.0, 20.0, 30.0, 0.0, 90.0, 30.0, 20.0, 260.0, 0.0, 40.0, 10.0, 0.0, 20.0, 0.0, 30.0, 30.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 50.0, 30.0, 0.0, 10.0, 20.0, 20.0, 0.0, 20.0, 0.0, 40.0, 30.0, 10.0, 0.0, 50.0, 30.0, 60.0, 30.0, 40.0, 30.0, 370.0, 10.0, 50.0, 40.0, 30.0, 30.0, 290.0, 70.0, 30.0, 40.0, 30.0, 20.0, 20.0, 0.0, 80.0, 0.0, 0.0, 0.0, 10.0, 40.0, 140.0, 40.0, 90.0, 400.0, 50.0, 80.0, 30.0, 70.0, 40.0, 40.0, 20.0, 0.0, 30.0, 350.0, -50.0, 190.0, 30.0, 30.0, 40.0, 90.0, 20.0, 10.0, 40.0, 170.0, 20.0, 30.0, 170.0, 20.0, 40.0, 0.0, 170.0, 70.0, 20.0, 670.0, 20.0, 30.0, 50.0, 40.0, 20.0, 0.0, -50.0, 350.0, 10.0, 100.0, 40.0, 40.0, 60.0, 110.0, 90.0, 370.0, 240.0, 30.0, -60.0, 150.0, 50.0, 10.0, 10.0, 20.0, 0.0, 560.0, 40.0, 150.0, 20.0, 30.0, 150.0, 40.0, 100.0, 40.0, 10.0, 80.0, 30.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 570.0, 20.0, 70.0, 0.0, 80.0, 10.0, 30.0, 70.0, 280.0, 0.0, 20.0, 0.0, 30.0, 0.0, 0.0, 20.0, 10.0, 40.0, 10.0, 30.0, 250.0, 10.0, 30.0, 20.0, 310.0, 0.0, 40.0, 60.0, 70.0, 40.0, 10.0, 450.0, 50.0, 20.0, 50.0, 360.0, 30.0, 40.0, 40.0, 200.0, 30.0, 30.0, 0.0, 30.0, 0.0, 10.0, 10.0, 50.0, 20.0, 0.0, 150.0, 20.0, 0.0, 60.0, 70.0, 20.0, 20.0, 150.0, 0.0, 20.0, 0.0, 10.0, 30.0, -5.0, 30.0, 20.0, 170.0, 170.0, 30.0, 0.0, 0.0, 120.0, 60.0, 60.0, 50.0, 20.0, 10.0, 20.0, 30.0, 20.0, 150.0, 40.0, 0.0, 80.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, 130.0, 120.0, 50.0, 30.0, 170.0, 390.0, 590.0, 160.0, 50.0, 80.0, 50.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 160.0, 10.0, 0.0, 30.0, 20.0, 30.0, 90.0, 30.0, 10.0, 50.0, 190.0, 10.0, 50.0, 30.0, 40.0, 560.0, 0.0, 40.0, 140.0, 70.0, 10.0, 0.0, 20.0, 10.0, 20.0, 0.0, 30.0, 10.0, 170.0, 560.0, 35.0, 40.0, 300.0, 20.0, 110.0, 100.0, 60.0, 260.0, 80.0, 60.0, 80.0, 20.0, 160.0, 30.0, 40.0, 260.0, 20.0, 270.0, 50.0, 150.0, 30.0, 350.0, 60.0, 60.0, 30.0, 0.0, -45.0, 0.0, 120.0, 20.0, 20.0, 10.0, 30.0, 100.0, 30.0, -10.0, 180.0, 60.0, 10.0, 10.0, 35.0, 30.0, 60.0, 30.0, 460.0, 30.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 70.0, 10.0, 10.0, 10.0, 150.0, 20.0, 300.0, 70.0, 0.0, 0.0, 60.0, 40.0, 0.0, 60.0, 0.0, 30.0, 40.0, 20.0, 30.0, 40.0, 60.0, 0.0, 40.0, 40.0, 20.0, 40.0, 70.0, 270.0, 160.0, 40.0, 170.0, 60.0, 70.0, 50.0, 60.0, 180.0, 10.0, 10.0, 150.0, 30.0, 30.0, 10.0, 0.0, 170.0, 20.0, 30.0, 40.0, 260.0, 0.0, 20.0, 70.0, 0.0, 0.0, 20.0, 0.0, 40.0, 0.0, 790.0, 10.0, 0.0, -70.0, 100.0, 20.0, 10.0, 20.0, 10.0, 40.0, 10.0, 0.0, 20.0, 60.0, 560.0, 20.0, 0.0, 30.0, 20.0, 30.0, 30.0, 0.0, 20.0, 30.0, 0.0, 10.0, 60.0, -10.0, 1090.0, -40.0, 30.0, 10.0, 0.0, -20.0, 10.0, 70.0, 0.0, 290.0, 100.0, 210.0, 30.0, 70.0, 50.0, 90.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 30.0, 50.0, 90.0, 15.0, 40.0, 90.0, 320.0, 20.0, 70.0, 480.0, 0.0, 190.0, 10.0, 130.0, 70.0, 170.0, 20.0, 80.0, 20.0, 20.0, 170.0, 0.0, 20.0, 0.0, 10.0, 180.0, 30.0, 20.0, 20.0, 0.0, 10.0, 10.0, 30.0, 40.0, 20.0, 10.0, 0.0, 100.0, 15.0, 30.0, 30.0, 180.0, 90.0, 50.0, 10.0, 30.0, 30.0, 10.0, 580.0, 80.0, 30.0, 0.0, 190.0, 80.0, 10.0, 120.0, 20.0, 10.0, -80.0, 30.0, 80.0, 40.0, 50.0, 120.0, 450.0, 0.0, 10.0, 50.0, 20.0, 10.0, 10.0, 10.0, 20.0, 30.0, 30.0, 0.0, 20.0, 190.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 30.0, 20.0, 30.0, 170.0, 130.0, 190.0, 180.0, 90.0, 30.0, 160.0, 100.0, 50.0, 60.0, 0.0, 0.0, 0.0, 10.0, 30.0, 40.0, 40.0, 40.0, 20.0, 0.0, 70.0, 0.0, 70.0, 0.0, 190.0, 160.0, 100.0, 150.0, 30.0, 10.0, 60.0, 40.0, 50.0, 100.0, 40.0, 60.0, 50.0, 30.0, 180.0, 30.0, 20.0, 80.0, 20.0, 40.0, 0.0, 10.0, 0.0, 0.0, 90.0, 40.0, 30.0, 10.0, 30.0, 0.0, 20.0, 30.0, 30.0, 90.0, 0.0, 30.0, 40.0, 40.0, 150.0, 0.0, 40.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 60.0, 30.0, 20.0, 30.0, 20.0, 60.0, 0.0, 80.0, 310.0, 40.0, 40.0, 270.0, 60.0, 30.0, 70.0, 40.0, 10.0, 60.0, 20.0, 20.0, 250.0, 10.0, 220.0, 30.0, 20.0, 30.0, 10.0, 40.0, 90.0, 0.0, 10.0, 30.0, 20.0, 10.0, 0.0, 30.0, 20.0, 90.0, -50.0, 350.0, 160.0, 30.0, 40.0, 20.0, 480.0, 20.0, 30.0, 0.0, 50.0, 80.0, 30.0, 20.0, 20.0, 30.0, 360.0, 380.0, -30.0, 50.0, 0.0, 30.0, 20.0, 60.0, 30.0, 20.0, 40.0, 40.0, 30.0, 10.0, 150.0, 10.0, 0.0, 0.0, -10.0, 30.0, 40.0, 0.0, 0.0, 20.0, 60.0, 40.0, 10.0, 20.0, 20.0, 260.0, 40.0, 10.0, 40.0, 0.0, 0.0, 90.0, 0.0, 30.0, 0.0, 10.0, 20.0, 20.0, 50.0, 10.0, 0.0, 10.0, 20.0, 10.0, 90.0, 20.0, 0.0, 50.0, 20.0, 30.0, 30.0, 30.0, 0.0, 550.0, 0.0, -30.0, 90.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 5.0, 40.0, 20.0, 150.0, 10.0, 50.0, 30.0, 120.0, 0.0, 0.0, 20.0, 30.0, 10.0, 30.0, 10.0, 40.0, 30.0, 40.0, 260.0, 40.0, 20.0, 60.0, 40.0, 50.0, 40.0, 30.0, 150.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.430735039383667, "mean_inference_ms": 1.6314651427266857, "mean_action_processing_ms": 0.4220307159236276, "mean_env_wait_ms": 1.3114189679962485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.060796260833740234, "StateBufferConnector_ms": 0.009662151336669922, "ViewRequirementAgentConnector_ms": 0.3870387077331543}, "num_episodes": 18, "episode_return_max": 1530.0, "episode_return_min": 140.0, "episode_return_mean": 621.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.24683219684907, "num_env_steps_trained_throughput_per_sec": 36.24683219684907, "timesteps_total": 448000, "num_env_steps_sampled_lifetime": 448000, "num_agent_steps_sampled_lifetime": 4480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4480000, "timers": {"training_iteration_time_ms": 110504.905, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110504.854, "sample_time_ms": 2399.09, "learn_time_ms": 108085.755, "learn_throughput": 37.008, "synch_weights_time_ms": 11.49}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 4480000, "num_agent_steps_trained": 4480000}, "done": false, "training_iteration": 112, "trial_id": "57140_00000", "date": "2024-06-27_02-45-46", "timestamp": 1719470746, "time_this_iter_s": 110.36924004554749, "time_total_s": 12671.34848332405, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b193bca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12671.34848332405, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 15.410897435897436, "ram_util_percent": 75.93076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6549071767904, "cur_kl_coeff": 4.161264306269187, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0026450717936768826, "vf_loss": 4.578710457412834, "vf_explained_var": 0.0005684535851239904, "kl": Infinity, "entropy": 0.36503772270470003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1056375.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000}, "env_runners": {"episode_reward_max": 1530.0, "episode_reward_min": 140.0, "episode_reward_mean": 635.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 1090.0}, "policy_reward_mean": {"policy_0": 63.56}, "custom_metrics": {}, "hist_stats": {"episode_reward": [140.0, 340.0, 1310.0, 1440.0, 500.0, 150.0, 150.0, 320.0, 960.0, 200.0, 980.0, 730.0, 520.0, 1090.0, 1120.0, 1010.0, 660.0, 750.0, 520.0, 400.0, 1050.0, 800.0, 290.0, 380.0, 595.0, 400.0, 440.0, 1530.0, 290.0, 1060.0, 310.0, 1375.0, 1050.0, 1020.0, 275.0, 905.0, 150.0, 700.0, 300.0, 950.0, 650.0, 460.0, 900.0, 740.0, 230.0, 1140.0, 870.0, 325.0, 1460.0, 520.0, 190.0, 535.0, 1130.0, 720.0, 190.0, 330.0, 1130.0, 240.0, 770.0, 620.0, 290.0, 280.0, 340.0, 330.0, 930.0, 650.0, 300.0, 1080.0, 990.0, 280.0, 240.0, 500.0, 230.0, 250.0, 710.0, 325.0, 290.0, 730.0, 970.0, 680.0, 1190.0, 800.0, 660.0, 620.0, 150.0, 890.0, 190.0, 440.0, 380.0, 250.0, 600.0, 210.0, 400.0, 530.0, 430.0, 1045.0, 790.0, 1400.0, 700.0, 1180.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 0.0, 0.0, 0.0, 20.0, 10.0, 40.0, 0.0, 30.0, 10.0, 30.0, 90.0, 0.0, 40.0, 30.0, 40.0, 30.0, 40.0, 10.0, 30.0, 90.0, 170.0, 210.0, 160.0, 60.0, 290.0, 40.0, 190.0, 70.0, 30.0, 40.0, 120.0, -10.0, 40.0, 80.0, 90.0, 330.0, 30.0, 70.0, 650.0, 20.0, 30.0, 0.0, 90.0, 30.0, 20.0, 260.0, 0.0, 40.0, 10.0, 0.0, 20.0, 0.0, 30.0, 30.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 50.0, 30.0, 0.0, 10.0, 20.0, 20.0, 0.0, 20.0, 0.0, 40.0, 30.0, 10.0, 0.0, 50.0, 30.0, 60.0, 30.0, 40.0, 30.0, 370.0, 10.0, 50.0, 40.0, 30.0, 30.0, 290.0, 70.0, 30.0, 40.0, 30.0, 20.0, 20.0, 0.0, 80.0, 0.0, 0.0, 0.0, 10.0, 40.0, 140.0, 40.0, 90.0, 400.0, 50.0, 80.0, 30.0, 70.0, 40.0, 40.0, 20.0, 0.0, 30.0, 350.0, -50.0, 190.0, 30.0, 30.0, 40.0, 90.0, 20.0, 10.0, 40.0, 170.0, 20.0, 30.0, 170.0, 20.0, 40.0, 0.0, 170.0, 70.0, 20.0, 670.0, 20.0, 30.0, 50.0, 40.0, 20.0, 0.0, -50.0, 350.0, 10.0, 100.0, 40.0, 40.0, 60.0, 110.0, 90.0, 370.0, 240.0, 30.0, -60.0, 150.0, 50.0, 10.0, 10.0, 20.0, 0.0, 560.0, 40.0, 150.0, 20.0, 30.0, 150.0, 40.0, 100.0, 40.0, 10.0, 80.0, 30.0, 20.0, 0.0, 10.0, 20.0, 10.0, 0.0, 570.0, 20.0, 70.0, 0.0, 80.0, 10.0, 30.0, 70.0, 280.0, 0.0, 20.0, 0.0, 30.0, 0.0, 0.0, 20.0, 10.0, 40.0, 10.0, 30.0, 250.0, 10.0, 30.0, 20.0, 310.0, 0.0, 40.0, 60.0, 70.0, 40.0, 10.0, 450.0, 50.0, 20.0, 50.0, 360.0, 30.0, 40.0, 40.0, 200.0, 30.0, 30.0, 0.0, 30.0, 0.0, 10.0, 10.0, 50.0, 20.0, 0.0, 150.0, 20.0, 0.0, 60.0, 70.0, 20.0, 20.0, 150.0, 0.0, 20.0, 0.0, 10.0, 30.0, -5.0, 30.0, 20.0, 170.0, 170.0, 30.0, 0.0, 0.0, 120.0, 60.0, 60.0, 50.0, 20.0, 10.0, 20.0, 30.0, 20.0, 150.0, 40.0, 0.0, 80.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, 130.0, 120.0, 50.0, 30.0, 170.0, 390.0, 590.0, 160.0, 50.0, 80.0, 50.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 160.0, 10.0, 0.0, 30.0, 20.0, 30.0, 90.0, 30.0, 10.0, 50.0, 190.0, 10.0, 50.0, 30.0, 40.0, 560.0, 0.0, 40.0, 140.0, 70.0, 10.0, 0.0, 20.0, 10.0, 20.0, 0.0, 30.0, 10.0, 170.0, 560.0, 35.0, 40.0, 300.0, 20.0, 110.0, 100.0, 60.0, 260.0, 80.0, 60.0, 80.0, 20.0, 160.0, 30.0, 40.0, 260.0, 20.0, 270.0, 50.0, 150.0, 30.0, 350.0, 60.0, 60.0, 30.0, 0.0, -45.0, 0.0, 120.0, 20.0, 20.0, 10.0, 30.0, 100.0, 30.0, -10.0, 180.0, 60.0, 10.0, 10.0, 35.0, 30.0, 60.0, 30.0, 460.0, 30.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 70.0, 10.0, 10.0, 10.0, 150.0, 20.0, 300.0, 70.0, 0.0, 0.0, 60.0, 40.0, 0.0, 60.0, 0.0, 30.0, 40.0, 20.0, 30.0, 40.0, 60.0, 0.0, 40.0, 40.0, 20.0, 40.0, 70.0, 270.0, 160.0, 40.0, 170.0, 60.0, 70.0, 50.0, 60.0, 180.0, 10.0, 10.0, 150.0, 30.0, 30.0, 10.0, 0.0, 170.0, 20.0, 30.0, 40.0, 260.0, 0.0, 20.0, 70.0, 0.0, 0.0, 20.0, 0.0, 40.0, 0.0, 790.0, 10.0, 0.0, -70.0, 100.0, 20.0, 10.0, 20.0, 10.0, 40.0, 10.0, 0.0, 20.0, 60.0, 560.0, 20.0, 0.0, 30.0, 20.0, 30.0, 30.0, 0.0, 20.0, 30.0, 0.0, 10.0, 60.0, -10.0, 1090.0, -40.0, 30.0, 10.0, 0.0, -20.0, 10.0, 70.0, 0.0, 290.0, 100.0, 210.0, 30.0, 70.0, 50.0, 90.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 30.0, 50.0, 90.0, 15.0, 40.0, 90.0, 320.0, 20.0, 70.0, 480.0, 0.0, 190.0, 10.0, 130.0, 70.0, 170.0, 20.0, 80.0, 20.0, 20.0, 170.0, 0.0, 20.0, 0.0, 10.0, 180.0, 30.0, 20.0, 20.0, 0.0, 10.0, 10.0, 30.0, 40.0, 20.0, 10.0, 0.0, 100.0, 15.0, 30.0, 30.0, 180.0, 90.0, 50.0, 10.0, 30.0, 30.0, 10.0, 580.0, 80.0, 30.0, 0.0, 190.0, 80.0, 10.0, 120.0, 20.0, 10.0, -80.0, 30.0, 80.0, 40.0, 50.0, 120.0, 450.0, 0.0, 10.0, 50.0, 20.0, 10.0, 10.0, 10.0, 20.0, 30.0, 30.0, 0.0, 20.0, 190.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 30.0, 20.0, 30.0, 170.0, 130.0, 190.0, 180.0, 90.0, 30.0, 160.0, 100.0, 50.0, 60.0, 0.0, 0.0, 0.0, 10.0, 30.0, 40.0, 40.0, 40.0, 20.0, 0.0, 70.0, 0.0, 70.0, 0.0, 190.0, 160.0, 100.0, 150.0, 30.0, 10.0, 60.0, 40.0, 50.0, 100.0, 40.0, 60.0, 50.0, 30.0, 180.0, 30.0, 20.0, 80.0, 20.0, 40.0, 0.0, 10.0, 0.0, 0.0, 90.0, 40.0, 30.0, 10.0, 30.0, 0.0, 20.0, 30.0, 30.0, 90.0, 0.0, 30.0, 40.0, 40.0, 150.0, 0.0, 40.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 60.0, 30.0, 20.0, 30.0, 20.0, 60.0, 0.0, 80.0, 310.0, 40.0, 40.0, 270.0, 60.0, 30.0, 70.0, 40.0, 10.0, 60.0, 20.0, 20.0, 250.0, 10.0, 220.0, 30.0, 20.0, 30.0, 10.0, 40.0, 90.0, 0.0, 10.0, 30.0, 20.0, 10.0, 0.0, 30.0, 20.0, 90.0, -50.0, 350.0, 160.0, 30.0, 40.0, 20.0, 480.0, 20.0, 30.0, 0.0, 50.0, 80.0, 30.0, 20.0, 20.0, 30.0, 360.0, 380.0, -30.0, 50.0, 0.0, 30.0, 20.0, 60.0, 30.0, 20.0, 40.0, 40.0, 30.0, 10.0, 150.0, 10.0, 0.0, 0.0, -10.0, 30.0, 40.0, 0.0, 0.0, 20.0, 60.0, 40.0, 10.0, 20.0, 20.0, 260.0, 40.0, 10.0, 40.0, 0.0, 0.0, 90.0, 0.0, 30.0, 0.0, 10.0, 20.0, 20.0, 50.0, 10.0, 0.0, 10.0, 20.0, 10.0, 90.0, 20.0, 0.0, 50.0, 20.0, 30.0, 30.0, 30.0, 0.0, 550.0, 0.0, -30.0, 90.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 5.0, 40.0, 20.0, 150.0, 10.0, 50.0, 30.0, 120.0, 0.0, 0.0, 20.0, 30.0, 10.0, 30.0, 10.0, 40.0, 30.0, 40.0, 260.0, 40.0, 20.0, 60.0, 40.0, 50.0, 40.0, 30.0, 150.0, 30.0, 60.0, 220.0, 490.0, 0.0, 0.0, 10.0, 30.0, 40.0, 90.0, -30.0, -70.0, 30.0, 260.0, 170.0, -30.0, 0.0, 390.0, 20.0, -60.0, 20.0, 190.0, 30.0, 200.0, 130.0, 90.0, 60.0, 440.0, 20.0, 10.0, 460.0, 10.0, 0.0, 30.0, 30.0, 80.0, 150.0, 0.0, 20.0, 20.0, 0.0, 30.0, 160.0, 30.0, 50.0, 20.0, 250.0, 40.0, 40.0, 40.0, 60.0, 20.0, 20.0, 370.0, 110.0, 0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 10.0, 30.0, 20.0, 0.0, 30.0, 10.0, 10.0, 10.0, 10.0, 50.0, 250.0, 160.0, 40.0, 10.0, 210.0, 90.0, 80.0, 30.0, -30.0, 40.0, 0.0, 20.0, 10.0, 50.0, 20.0, 30.0, 0.0, 10.0, 10.0, 40.0, 10.0, 30.0, 0.0, 100.0, 20.0, 100.0, 110.0, 20.0, 10.0, 50.0, 10.0, 30.0, 20.0, 190.0, 10.0, 30.0, 10.0, 30.0, 0.0, 180.0, 0.0, 0.0, 0.0, 0.0, -40.0, 50.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 20.0, 20.0, 60.0, 70.0, 170.0, 160.0, 30.0, 0.0, 10.0, 0.0, -20.0, 10.0, 30.0, 40.0, 20.0, 100.0, 20.0, 30.0, 180.0, 20.0, 20.0, 0.0, 0.0, 40.0, 10.0, 60.0, 40.0, 20.0, 40.0, 70.0, 30.0, 10.0, 10.0, 370.0, 20.0, 10.0, -50.0, 20.0, 10.0, 10.0, 0.0, 30.0, 300.0, 60.0, 0.0, 0.0, 0.0, 180.0, 160.0, 50.0, 10.0, 35.0, 40.0, 10.0, 350.0, 40.0, 170.0, 40.0, 40.0, 450.0, 30.0, 20.0, 0.0, 10.0, 40.0, 100.0, 60.0, 30.0, 20.0, 490.0, 50.0, 210.0, 20.0, 60.0, 280.0, 70.0, 170.0, 280.0, -150.0, 30.0, 110.0, 680.0, -100.0, 40.0, -60.0, 10.0, -140.0, 20.0, 10.0, 20.0, 80.0, 760.0, 20.0, 160.0, 60.0, 20.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4294835054074992, "mean_inference_ms": 1.6303496897285459, "mean_action_processing_ms": 0.42174484635712955, "mean_env_wait_ms": 1.3106923391230305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05911827087402344, "StateBufferConnector_ms": 0.009770870208740234, "ViewRequirementAgentConnector_ms": 0.386538028717041}, "num_episodes": 22, "episode_return_max": 1530.0, "episode_return_min": 140.0, "episode_return_mean": 635.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.63518133516373, "num_env_steps_trained_throughput_per_sec": 36.63518133516373, "timesteps_total": 452000, "num_env_steps_sampled_lifetime": 452000, "num_agent_steps_sampled_lifetime": 4520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4520000, "timers": {"training_iteration_time_ms": 110362.987, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110362.935, "sample_time_ms": 2385.608, "learn_time_ms": 107957.602, "learn_throughput": 37.052, "synch_weights_time_ms": 11.085}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 4520000, "num_agent_steps_trained": 4520000}, "done": false, "training_iteration": 113, "trial_id": "57140_00000", "date": "2024-06-27_02-47-35", "timestamp": 1719470855, "time_this_iter_s": 109.19775629043579, "time_total_s": 12780.546239614487, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18cb310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12780.546239614487, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 15.15935483870968, "ram_util_percent": 77.41677419354838}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4160121482432966, "cur_kl_coeff": 6.241896459403778, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002176831172421154, "vf_loss": 4.116409441609733, "vf_explained_var": 0.0005414194001938207, "kl": Infinity, "entropy": 0.38600879215553036, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1065765.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000}, "env_runners": {"episode_reward_max": 1530.0, "episode_reward_min": 150.0, "episode_reward_mean": 622.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 1090.0}, "policy_reward_mean": {"policy_0": 62.23}, "custom_metrics": {}, "hist_stats": {"episode_reward": [520.0, 400.0, 1050.0, 800.0, 290.0, 380.0, 595.0, 400.0, 440.0, 1530.0, 290.0, 1060.0, 310.0, 1375.0, 1050.0, 1020.0, 275.0, 905.0, 150.0, 700.0, 300.0, 950.0, 650.0, 460.0, 900.0, 740.0, 230.0, 1140.0, 870.0, 325.0, 1460.0, 520.0, 190.0, 535.0, 1130.0, 720.0, 190.0, 330.0, 1130.0, 240.0, 770.0, 620.0, 290.0, 280.0, 340.0, 330.0, 930.0, 650.0, 300.0, 1080.0, 990.0, 280.0, 240.0, 500.0, 230.0, 250.0, 710.0, 325.0, 290.0, 730.0, 970.0, 680.0, 1190.0, 800.0, 660.0, 620.0, 150.0, 890.0, 190.0, 440.0, 380.0, 250.0, 600.0, 210.0, 400.0, 530.0, 430.0, 1045.0, 790.0, 1400.0, 700.0, 1180.0, 290.0, 700.0, 230.0, 160.0, 950.0, 770.0, 470.0, 230.0, 1210.0, 1010.0, 280.0, 980.0, 1140.0, 1240.0, 380.0, 330.0, 490.0, 180.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 80.0, 10.0, 30.0, 70.0, 280.0, 0.0, 20.0, 0.0, 30.0, 0.0, 0.0, 20.0, 10.0, 40.0, 10.0, 30.0, 250.0, 10.0, 30.0, 20.0, 310.0, 0.0, 40.0, 60.0, 70.0, 40.0, 10.0, 450.0, 50.0, 20.0, 50.0, 360.0, 30.0, 40.0, 40.0, 200.0, 30.0, 30.0, 0.0, 30.0, 0.0, 10.0, 10.0, 50.0, 20.0, 0.0, 150.0, 20.0, 0.0, 60.0, 70.0, 20.0, 20.0, 150.0, 0.0, 20.0, 0.0, 10.0, 30.0, -5.0, 30.0, 20.0, 170.0, 170.0, 30.0, 0.0, 0.0, 120.0, 60.0, 60.0, 50.0, 20.0, 10.0, 20.0, 30.0, 20.0, 150.0, 40.0, 0.0, 80.0, 10.0, 10.0, 0.0, 20.0, 0.0, 20.0, 130.0, 120.0, 50.0, 30.0, 170.0, 390.0, 590.0, 160.0, 50.0, 80.0, 50.0, 0.0, 10.0, 10.0, 20.0, 0.0, 10.0, 160.0, 10.0, 0.0, 30.0, 20.0, 30.0, 90.0, 30.0, 10.0, 50.0, 190.0, 10.0, 50.0, 30.0, 40.0, 560.0, 0.0, 40.0, 140.0, 70.0, 10.0, 0.0, 20.0, 10.0, 20.0, 0.0, 30.0, 10.0, 170.0, 560.0, 35.0, 40.0, 300.0, 20.0, 110.0, 100.0, 60.0, 260.0, 80.0, 60.0, 80.0, 20.0, 160.0, 30.0, 40.0, 260.0, 20.0, 270.0, 50.0, 150.0, 30.0, 350.0, 60.0, 60.0, 30.0, 0.0, -45.0, 0.0, 120.0, 20.0, 20.0, 10.0, 30.0, 100.0, 30.0, -10.0, 180.0, 60.0, 10.0, 10.0, 35.0, 30.0, 60.0, 30.0, 460.0, 30.0, 10.0, 0.0, 0.0, 20.0, 20.0, 0.0, 70.0, 10.0, 10.0, 10.0, 150.0, 20.0, 300.0, 70.0, 0.0, 0.0, 60.0, 40.0, 0.0, 60.0, 0.0, 30.0, 40.0, 20.0, 30.0, 40.0, 60.0, 0.0, 40.0, 40.0, 20.0, 40.0, 70.0, 270.0, 160.0, 40.0, 170.0, 60.0, 70.0, 50.0, 60.0, 180.0, 10.0, 10.0, 150.0, 30.0, 30.0, 10.0, 0.0, 170.0, 20.0, 30.0, 40.0, 260.0, 0.0, 20.0, 70.0, 0.0, 0.0, 20.0, 0.0, 40.0, 0.0, 790.0, 10.0, 0.0, -70.0, 100.0, 20.0, 10.0, 20.0, 10.0, 40.0, 10.0, 0.0, 20.0, 60.0, 560.0, 20.0, 0.0, 30.0, 20.0, 30.0, 30.0, 0.0, 20.0, 30.0, 0.0, 10.0, 60.0, -10.0, 1090.0, -40.0, 30.0, 10.0, 0.0, -20.0, 10.0, 70.0, 0.0, 290.0, 100.0, 210.0, 30.0, 70.0, 50.0, 90.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 30.0, 50.0, 90.0, 15.0, 40.0, 90.0, 320.0, 20.0, 70.0, 480.0, 0.0, 190.0, 10.0, 130.0, 70.0, 170.0, 20.0, 80.0, 20.0, 20.0, 170.0, 0.0, 20.0, 0.0, 10.0, 180.0, 30.0, 20.0, 20.0, 0.0, 10.0, 10.0, 30.0, 40.0, 20.0, 10.0, 0.0, 100.0, 15.0, 30.0, 30.0, 180.0, 90.0, 50.0, 10.0, 30.0, 30.0, 10.0, 580.0, 80.0, 30.0, 0.0, 190.0, 80.0, 10.0, 120.0, 20.0, 10.0, -80.0, 30.0, 80.0, 40.0, 50.0, 120.0, 450.0, 0.0, 10.0, 50.0, 20.0, 10.0, 10.0, 10.0, 20.0, 30.0, 30.0, 0.0, 20.0, 190.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 30.0, 20.0, 30.0, 170.0, 130.0, 190.0, 180.0, 90.0, 30.0, 160.0, 100.0, 50.0, 60.0, 0.0, 0.0, 0.0, 10.0, 30.0, 40.0, 40.0, 40.0, 20.0, 0.0, 70.0, 0.0, 70.0, 0.0, 190.0, 160.0, 100.0, 150.0, 30.0, 10.0, 60.0, 40.0, 50.0, 100.0, 40.0, 60.0, 50.0, 30.0, 180.0, 30.0, 20.0, 80.0, 20.0, 40.0, 0.0, 10.0, 0.0, 0.0, 90.0, 40.0, 30.0, 10.0, 30.0, 0.0, 20.0, 30.0, 30.0, 90.0, 0.0, 30.0, 40.0, 40.0, 150.0, 0.0, 40.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 60.0, 30.0, 20.0, 30.0, 20.0, 60.0, 0.0, 80.0, 310.0, 40.0, 40.0, 270.0, 60.0, 30.0, 70.0, 40.0, 10.0, 60.0, 20.0, 20.0, 250.0, 10.0, 220.0, 30.0, 20.0, 30.0, 10.0, 40.0, 90.0, 0.0, 10.0, 30.0, 20.0, 10.0, 0.0, 30.0, 20.0, 90.0, -50.0, 350.0, 160.0, 30.0, 40.0, 20.0, 480.0, 20.0, 30.0, 0.0, 50.0, 80.0, 30.0, 20.0, 20.0, 30.0, 360.0, 380.0, -30.0, 50.0, 0.0, 30.0, 20.0, 60.0, 30.0, 20.0, 40.0, 40.0, 30.0, 10.0, 150.0, 10.0, 0.0, 0.0, -10.0, 30.0, 40.0, 0.0, 0.0, 20.0, 60.0, 40.0, 10.0, 20.0, 20.0, 260.0, 40.0, 10.0, 40.0, 0.0, 0.0, 90.0, 0.0, 30.0, 0.0, 10.0, 20.0, 20.0, 50.0, 10.0, 0.0, 10.0, 20.0, 10.0, 90.0, 20.0, 0.0, 50.0, 20.0, 30.0, 30.0, 30.0, 0.0, 550.0, 0.0, -30.0, 90.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 5.0, 40.0, 20.0, 150.0, 10.0, 50.0, 30.0, 120.0, 0.0, 0.0, 20.0, 30.0, 10.0, 30.0, 10.0, 40.0, 30.0, 40.0, 260.0, 40.0, 20.0, 60.0, 40.0, 50.0, 40.0, 30.0, 150.0, 30.0, 60.0, 220.0, 490.0, 0.0, 0.0, 10.0, 30.0, 40.0, 90.0, -30.0, -70.0, 30.0, 260.0, 170.0, -30.0, 0.0, 390.0, 20.0, -60.0, 20.0, 190.0, 30.0, 200.0, 130.0, 90.0, 60.0, 440.0, 20.0, 10.0, 460.0, 10.0, 0.0, 30.0, 30.0, 80.0, 150.0, 0.0, 20.0, 20.0, 0.0, 30.0, 160.0, 30.0, 50.0, 20.0, 250.0, 40.0, 40.0, 40.0, 60.0, 20.0, 20.0, 370.0, 110.0, 0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 10.0, 30.0, 20.0, 0.0, 30.0, 10.0, 10.0, 10.0, 10.0, 50.0, 250.0, 160.0, 40.0, 10.0, 210.0, 90.0, 80.0, 30.0, -30.0, 40.0, 0.0, 20.0, 10.0, 50.0, 20.0, 30.0, 0.0, 10.0, 10.0, 40.0, 10.0, 30.0, 0.0, 100.0, 20.0, 100.0, 110.0, 20.0, 10.0, 50.0, 10.0, 30.0, 20.0, 190.0, 10.0, 30.0, 10.0, 30.0, 0.0, 180.0, 0.0, 0.0, 0.0, 0.0, -40.0, 50.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 20.0, 20.0, 60.0, 70.0, 170.0, 160.0, 30.0, 0.0, 10.0, 0.0, -20.0, 10.0, 30.0, 40.0, 20.0, 100.0, 20.0, 30.0, 180.0, 20.0, 20.0, 0.0, 0.0, 40.0, 10.0, 60.0, 40.0, 20.0, 40.0, 70.0, 30.0, 10.0, 10.0, 370.0, 20.0, 10.0, -50.0, 20.0, 10.0, 10.0, 0.0, 30.0, 300.0, 60.0, 0.0, 0.0, 0.0, 180.0, 160.0, 50.0, 10.0, 35.0, 40.0, 10.0, 350.0, 40.0, 170.0, 40.0, 40.0, 450.0, 30.0, 20.0, 0.0, 10.0, 40.0, 100.0, 60.0, 30.0, 20.0, 490.0, 50.0, 210.0, 20.0, 60.0, 280.0, 70.0, 170.0, 280.0, -150.0, 30.0, 110.0, 680.0, -100.0, 40.0, -60.0, 10.0, -140.0, 20.0, 10.0, 20.0, 80.0, 760.0, 20.0, 160.0, 60.0, 20.0, 30.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 30.0, 200.0, -50.0, 20.0, 60.0, 40.0, 70.0, -100.0, 660.0, 30.0, 20.0, -50.0, 20.0, 40.0, 40.0, 40.0, 0.0, 20.0, 20.0, 10.0, 0.0, 40.0, 0.0, 0.0, 20.0, 0.0, 30.0, 20.0, 30.0, 20.0, 10.0, 30.0, 20.0, 0.0, 60.0, 320.0, 90.0, 70.0, 270.0, 20.0, 80.0, 20.0, 30.0, 0.0, 10.0, 50.0, 470.0, 20.0, 40.0, 110.0, 10.0, 30.0, 0.0, 30.0, 20.0, 40.0, 0.0, 70.0, 150.0, 110.0, 0.0, 50.0, 0.0, 10.0, 50.0, 40.0, 0.0, 0.0, 70.0, 0.0, 20.0, 40.0, -40.0, 40.0, 310.0, 750.0, 60.0, 60.0, 50.0, -10.0, -50.0, 40.0, 90.0, 20.0, 90.0, 90.0, 30.0, 270.0, 50.0, 310.0, 20.0, 40.0, 0.0, 0.0, 10.0, 120.0, 70.0, 0.0, 40.0, 20.0, 10.0, 10.0, 10.0, 30.0, 100.0, 60.0, 160.0, 190.0, -30.0, 350.0, 40.0, 70.0, 50.0, 30.0, 60.0, 30.0, 30.0, 40.0, 150.0, 380.0, 40.0, 330.0, 310.0, 80.0, 110.0, 50.0, 20.0, 100.0, 150.0, 230.0, 170.0, 20.0, 10.0, 40.0, 20.0, 40.0, 40.0, 150.0, 0.0, 10.0, 70.0, 0.0, 0.0, 0.0, 30.0, 150.0, 30.0, 40.0, 30.0, 20.0, 0.0, 30.0, -130.0, 150.0, 160.0, 170.0, 20.0, 40.0, 20.0, 40.0, 0.0, 20.0, 0.0, 20.0, 20.0, 0.0, 40.0, 20.0, 0.0, 30.0, 10.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4284679475174658, "mean_inference_ms": 1.6293815930279911, "mean_action_processing_ms": 0.42151748262462163, "mean_env_wait_ms": 1.3100584399928759, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05642104148864746, "StateBufferConnector_ms": 0.009609699249267578, "ViewRequirementAgentConnector_ms": 0.37706828117370605}, "num_episodes": 18, "episode_return_max": 1530.0, "episode_return_min": 150.0, "episode_return_mean": 622.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.418071095386445, "num_env_steps_trained_throughput_per_sec": 36.418071095386445, "timesteps_total": 456000, "num_env_steps_sampled_lifetime": 456000, "num_agent_steps_sampled_lifetime": 4560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4560000, "timers": {"training_iteration_time_ms": 110206.411, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110206.359, "sample_time_ms": 2374.534, "learn_time_ms": 107812.365, "learn_throughput": 37.101, "synch_weights_time_ms": 10.847}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 4560000, "num_agent_steps_trained": 4560000}, "done": false, "training_iteration": 114, "trial_id": "57140_00000", "date": "2024-06-27_02-49-25", "timestamp": 1719470965, "time_this_iter_s": 109.85118317604065, "time_total_s": 12890.397422790527, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b257fa60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12890.397422790527, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 15.301290322580646, "ram_util_percent": 76.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8862588770663775, "cur_kl_coeff": 9.362844689105668, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002085997372433242, "vf_loss": 4.270388526657519, "vf_explained_var": 0.0004889303947282167, "kl": Infinity, "entropy": 0.37381578164772233, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1075155.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000}, "env_runners": {"episode_reward_max": 1680.0, "episode_reward_min": 150.0, "episode_reward_mean": 611.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 1090.0}, "policy_reward_mean": {"policy_0": 61.185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [460.0, 900.0, 740.0, 230.0, 1140.0, 870.0, 325.0, 1460.0, 520.0, 190.0, 535.0, 1130.0, 720.0, 190.0, 330.0, 1130.0, 240.0, 770.0, 620.0, 290.0, 280.0, 340.0, 330.0, 930.0, 650.0, 300.0, 1080.0, 990.0, 280.0, 240.0, 500.0, 230.0, 250.0, 710.0, 325.0, 290.0, 730.0, 970.0, 680.0, 1190.0, 800.0, 660.0, 620.0, 150.0, 890.0, 190.0, 440.0, 380.0, 250.0, 600.0, 210.0, 400.0, 530.0, 430.0, 1045.0, 790.0, 1400.0, 700.0, 1180.0, 290.0, 700.0, 230.0, 160.0, 950.0, 770.0, 470.0, 230.0, 1210.0, 1010.0, 280.0, 980.0, 1140.0, 1240.0, 380.0, 330.0, 490.0, 180.0, 430.0, 1050.0, 270.0, 1100.0, 220.0, 780.0, 260.0, 460.0, 350.0, 335.0, 170.0, 960.0, 1080.0, 270.0, 870.0, 290.0, 1130.0, 545.0, 360.0, 905.0, 300.0, 580.0, 1680.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 30.0, 40.0, 260.0, 0.0, 20.0, 70.0, 0.0, 0.0, 20.0, 0.0, 40.0, 0.0, 790.0, 10.0, 0.0, -70.0, 100.0, 20.0, 10.0, 20.0, 10.0, 40.0, 10.0, 0.0, 20.0, 60.0, 560.0, 20.0, 0.0, 30.0, 20.0, 30.0, 30.0, 0.0, 20.0, 30.0, 0.0, 10.0, 60.0, -10.0, 1090.0, -40.0, 30.0, 10.0, 0.0, -20.0, 10.0, 70.0, 0.0, 290.0, 100.0, 210.0, 30.0, 70.0, 50.0, 90.0, 10.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 30.0, 50.0, 90.0, 15.0, 40.0, 90.0, 320.0, 20.0, 70.0, 480.0, 0.0, 190.0, 10.0, 130.0, 70.0, 170.0, 20.0, 80.0, 20.0, 20.0, 170.0, 0.0, 20.0, 0.0, 10.0, 180.0, 30.0, 20.0, 20.0, 0.0, 10.0, 10.0, 30.0, 40.0, 20.0, 10.0, 0.0, 100.0, 15.0, 30.0, 30.0, 180.0, 90.0, 50.0, 10.0, 30.0, 30.0, 10.0, 580.0, 80.0, 30.0, 0.0, 190.0, 80.0, 10.0, 120.0, 20.0, 10.0, -80.0, 30.0, 80.0, 40.0, 50.0, 120.0, 450.0, 0.0, 10.0, 50.0, 20.0, 10.0, 10.0, 10.0, 20.0, 30.0, 30.0, 0.0, 20.0, 190.0, 0.0, 10.0, 10.0, 10.0, 20.0, 20.0, 30.0, 20.0, 30.0, 170.0, 130.0, 190.0, 180.0, 90.0, 30.0, 160.0, 100.0, 50.0, 60.0, 0.0, 0.0, 0.0, 10.0, 30.0, 40.0, 40.0, 40.0, 20.0, 0.0, 70.0, 0.0, 70.0, 0.0, 190.0, 160.0, 100.0, 150.0, 30.0, 10.0, 60.0, 40.0, 50.0, 100.0, 40.0, 60.0, 50.0, 30.0, 180.0, 30.0, 20.0, 80.0, 20.0, 40.0, 0.0, 10.0, 0.0, 0.0, 90.0, 40.0, 30.0, 10.0, 30.0, 0.0, 20.0, 30.0, 30.0, 90.0, 0.0, 30.0, 40.0, 40.0, 150.0, 0.0, 40.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 60.0, 30.0, 20.0, 30.0, 20.0, 60.0, 0.0, 80.0, 310.0, 40.0, 40.0, 270.0, 60.0, 30.0, 70.0, 40.0, 10.0, 60.0, 20.0, 20.0, 250.0, 10.0, 220.0, 30.0, 20.0, 30.0, 10.0, 40.0, 90.0, 0.0, 10.0, 30.0, 20.0, 10.0, 0.0, 30.0, 20.0, 90.0, -50.0, 350.0, 160.0, 30.0, 40.0, 20.0, 480.0, 20.0, 30.0, 0.0, 50.0, 80.0, 30.0, 20.0, 20.0, 30.0, 360.0, 380.0, -30.0, 50.0, 0.0, 30.0, 20.0, 60.0, 30.0, 20.0, 40.0, 40.0, 30.0, 10.0, 150.0, 10.0, 0.0, 0.0, -10.0, 30.0, 40.0, 0.0, 0.0, 20.0, 60.0, 40.0, 10.0, 20.0, 20.0, 260.0, 40.0, 10.0, 40.0, 0.0, 0.0, 90.0, 0.0, 30.0, 0.0, 10.0, 20.0, 20.0, 50.0, 10.0, 0.0, 10.0, 20.0, 10.0, 90.0, 20.0, 0.0, 50.0, 20.0, 30.0, 30.0, 30.0, 0.0, 550.0, 0.0, -30.0, 90.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 5.0, 40.0, 20.0, 150.0, 10.0, 50.0, 30.0, 120.0, 0.0, 0.0, 20.0, 30.0, 10.0, 30.0, 10.0, 40.0, 30.0, 40.0, 260.0, 40.0, 20.0, 60.0, 40.0, 50.0, 40.0, 30.0, 150.0, 30.0, 60.0, 220.0, 490.0, 0.0, 0.0, 10.0, 30.0, 40.0, 90.0, -30.0, -70.0, 30.0, 260.0, 170.0, -30.0, 0.0, 390.0, 20.0, -60.0, 20.0, 190.0, 30.0, 200.0, 130.0, 90.0, 60.0, 440.0, 20.0, 10.0, 460.0, 10.0, 0.0, 30.0, 30.0, 80.0, 150.0, 0.0, 20.0, 20.0, 0.0, 30.0, 160.0, 30.0, 50.0, 20.0, 250.0, 40.0, 40.0, 40.0, 60.0, 20.0, 20.0, 370.0, 110.0, 0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 10.0, 30.0, 20.0, 0.0, 30.0, 10.0, 10.0, 10.0, 10.0, 50.0, 250.0, 160.0, 40.0, 10.0, 210.0, 90.0, 80.0, 30.0, -30.0, 40.0, 0.0, 20.0, 10.0, 50.0, 20.0, 30.0, 0.0, 10.0, 10.0, 40.0, 10.0, 30.0, 0.0, 100.0, 20.0, 100.0, 110.0, 20.0, 10.0, 50.0, 10.0, 30.0, 20.0, 190.0, 10.0, 30.0, 10.0, 30.0, 0.0, 180.0, 0.0, 0.0, 0.0, 0.0, -40.0, 50.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 20.0, 20.0, 60.0, 70.0, 170.0, 160.0, 30.0, 0.0, 10.0, 0.0, -20.0, 10.0, 30.0, 40.0, 20.0, 100.0, 20.0, 30.0, 180.0, 20.0, 20.0, 0.0, 0.0, 40.0, 10.0, 60.0, 40.0, 20.0, 40.0, 70.0, 30.0, 10.0, 10.0, 370.0, 20.0, 10.0, -50.0, 20.0, 10.0, 10.0, 0.0, 30.0, 300.0, 60.0, 0.0, 0.0, 0.0, 180.0, 160.0, 50.0, 10.0, 35.0, 40.0, 10.0, 350.0, 40.0, 170.0, 40.0, 40.0, 450.0, 30.0, 20.0, 0.0, 10.0, 40.0, 100.0, 60.0, 30.0, 20.0, 490.0, 50.0, 210.0, 20.0, 60.0, 280.0, 70.0, 170.0, 280.0, -150.0, 30.0, 110.0, 680.0, -100.0, 40.0, -60.0, 10.0, -140.0, 20.0, 10.0, 20.0, 80.0, 760.0, 20.0, 160.0, 60.0, 20.0, 30.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 30.0, 200.0, -50.0, 20.0, 60.0, 40.0, 70.0, -100.0, 660.0, 30.0, 20.0, -50.0, 20.0, 40.0, 40.0, 40.0, 0.0, 20.0, 20.0, 10.0, 0.0, 40.0, 0.0, 0.0, 20.0, 0.0, 30.0, 20.0, 30.0, 20.0, 10.0, 30.0, 20.0, 0.0, 60.0, 320.0, 90.0, 70.0, 270.0, 20.0, 80.0, 20.0, 30.0, 0.0, 10.0, 50.0, 470.0, 20.0, 40.0, 110.0, 10.0, 30.0, 0.0, 30.0, 20.0, 40.0, 0.0, 70.0, 150.0, 110.0, 0.0, 50.0, 0.0, 10.0, 50.0, 40.0, 0.0, 0.0, 70.0, 0.0, 20.0, 40.0, -40.0, 40.0, 310.0, 750.0, 60.0, 60.0, 50.0, -10.0, -50.0, 40.0, 90.0, 20.0, 90.0, 90.0, 30.0, 270.0, 50.0, 310.0, 20.0, 40.0, 0.0, 0.0, 10.0, 120.0, 70.0, 0.0, 40.0, 20.0, 10.0, 10.0, 10.0, 30.0, 100.0, 60.0, 160.0, 190.0, -30.0, 350.0, 40.0, 70.0, 50.0, 30.0, 60.0, 30.0, 30.0, 40.0, 150.0, 380.0, 40.0, 330.0, 310.0, 80.0, 110.0, 50.0, 20.0, 100.0, 150.0, 230.0, 170.0, 20.0, 10.0, 40.0, 20.0, 40.0, 40.0, 150.0, 0.0, 10.0, 70.0, 0.0, 0.0, 0.0, 30.0, 150.0, 30.0, 40.0, 30.0, 20.0, 0.0, 30.0, -130.0, 150.0, 160.0, 170.0, 20.0, 40.0, 20.0, 40.0, 0.0, 20.0, 0.0, 20.0, 20.0, 0.0, 40.0, 20.0, 0.0, 30.0, 10.0, 40.0, 20.0, 90.0, 30.0, 70.0, 0.0, 20.0, 40.0, 0.0, 130.0, 30.0, 20.0, 30.0, 80.0, 50.0, 150.0, -50.0, 40.0, 650.0, 50.0, 30.0, 0.0, 20.0, 170.0, 0.0, 20.0, 0.0, 10.0, 10.0, 30.0, 10.0, -40.0, 280.0, -50.0, 40.0, 370.0, 80.0, 60.0, 110.0, 130.0, 120.0, 30.0, 20.0, 40.0, 40.0, 0.0, 0.0, 20.0, 0.0, 40.0, 30.0, 30.0, 30.0, 70.0, 180.0, 60.0, 50.0, 180.0, 20.0, 0.0, 160.0, 30.0, 50.0, 50.0, 20.0, 0.0, 70.0, 0.0, 40.0, 0.0, 0.0, 20.0, 20.0, 10.0, 50.0, 250.0, 0.0, 50.0, 50.0, 0.0, 10.0, 50.0, 30.0, 40.0, 80.0, 30.0, 40.0, 30.0, 30.0, 0.0, 20.0, 0.0, 30.0, -5.0, 0.0, 10.0, 40.0, 10.0, 50.0, 10.0, 190.0, 0.0, 0.0, 30.0, 40.0, 10.0, 0.0, 20.0, 50.0, 0.0, 20.0, 30.0, 330.0, 10.0, 10.0, 350.0, 80.0, 10.0, 20.0, 20.0, 100.0, 40.0, 60.0, 40.0, 100.0, 670.0, 10.0, 30.0, 20.0, 70.0, 40.0, 0.0, 0.0, 40.0, 90.0, 20.0, 20.0, 10.0, 40.0, 30.0, 20.0, 10.0, 0.0, 0.0, 160.0, 380.0, 80.0, 40.0, 40.0, 60.0, 100.0, 0.0, 90.0, 40.0, 30.0, 20.0, 0.0, 30.0, 40.0, 0.0, 40.0, 130.0, 50.0, 10.0, 260.0, 200.0, 160.0, 180.0, 10.0, 30.0, 100.0, 0.0, 260.0, 120.0, 10.0, 20.0, 40.0, 15.0, 10.0, 50.0, 20.0, 0.0, 10.0, 50.0, 0.0, 110.0, 20.0, 20.0, 30.0, 20.0, 100.0, 30.0, 10.0, 70.0, 245.0, 0.0, 20.0, 40.0, 450.0, 10.0, 30.0, 10.0, 20.0, 30.0, 10.0, 70.0, 10.0, 20.0, 0.0, 0.0, 130.0, 90.0, 80.0, 10.0, 60.0, 0.0, 80.0, 10.0, 20.0, 50.0, 180.0, 60.0, 10.0, 20.0, 20.0, 790.0, 310.0, 60.0, 360.0, 10.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4271452470307373, "mean_inference_ms": 1.6224078780204696, "mean_action_processing_ms": 0.4209971350638092, "mean_env_wait_ms": 1.3077928614651058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05667448043823242, "StateBufferConnector_ms": 0.009522676467895508, "ViewRequirementAgentConnector_ms": 0.37095141410827637}, "num_episodes": 23, "episode_return_max": 1680.0, "episode_return_min": 150.0, "episode_return_mean": 611.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.336645203609855, "num_env_steps_trained_throughput_per_sec": 36.336645203609855, "timesteps_total": 460000, "num_env_steps_sampled_lifetime": 460000, "num_agent_steps_sampled_lifetime": 4600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4600000, "timers": {"training_iteration_time_ms": 110140.853, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110140.801, "sample_time_ms": 2375.463, "learn_time_ms": 107746.356, "learn_throughput": 37.124, "synch_weights_time_ms": 10.209}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 4600000, "num_agent_steps_trained": 4600000}, "done": false, "training_iteration": 115, "trial_id": "57140_00000", "date": "2024-06-27_02-51-15", "timestamp": 1719471075, "time_this_iter_s": 110.0951681137085, "time_total_s": 13000.492590904236, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23a7700>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13000.492590904236, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 15.977564102564102, "ram_util_percent": 76.77884615384616}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.891196009716668, "cur_kl_coeff": 14.044267033658507, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.875802708281496, "policy_loss": -0.0014534807884004424, "vf_loss": 3.875202795644157, "vf_explained_var": 0.0002979866485880079, "kl": 0.0001462086700560758, "entropy": 0.35142341949466194, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1084545.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000}, "env_runners": {"episode_reward_max": 1680.0, "episode_reward_min": 150.0, "episode_reward_mean": 587.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 790.0}, "policy_reward_mean": {"policy_0": 58.76}, "custom_metrics": {}, "hist_stats": {"episode_reward": [620.0, 290.0, 280.0, 340.0, 330.0, 930.0, 650.0, 300.0, 1080.0, 990.0, 280.0, 240.0, 500.0, 230.0, 250.0, 710.0, 325.0, 290.0, 730.0, 970.0, 680.0, 1190.0, 800.0, 660.0, 620.0, 150.0, 890.0, 190.0, 440.0, 380.0, 250.0, 600.0, 210.0, 400.0, 530.0, 430.0, 1045.0, 790.0, 1400.0, 700.0, 1180.0, 290.0, 700.0, 230.0, 160.0, 950.0, 770.0, 470.0, 230.0, 1210.0, 1010.0, 280.0, 980.0, 1140.0, 1240.0, 380.0, 330.0, 490.0, 180.0, 430.0, 1050.0, 270.0, 1100.0, 220.0, 780.0, 260.0, 460.0, 350.0, 335.0, 170.0, 960.0, 1080.0, 270.0, 870.0, 290.0, 1130.0, 545.0, 360.0, 905.0, 300.0, 580.0, 1680.0, 600.0, 450.0, 580.0, 660.0, 240.0, 150.0, 690.0, 380.0, 500.0, 560.0, 730.0, 450.0, 350.0, 805.0, 750.0, 540.0, 330.0, 690.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 60.0, 40.0, 50.0, 100.0, 40.0, 60.0, 50.0, 30.0, 180.0, 30.0, 20.0, 80.0, 20.0, 40.0, 0.0, 10.0, 0.0, 0.0, 90.0, 40.0, 30.0, 10.0, 30.0, 0.0, 20.0, 30.0, 30.0, 90.0, 0.0, 30.0, 40.0, 40.0, 150.0, 0.0, 40.0, 0.0, 20.0, 10.0, 10.0, 0.0, 30.0, 60.0, 30.0, 20.0, 30.0, 20.0, 60.0, 0.0, 80.0, 310.0, 40.0, 40.0, 270.0, 60.0, 30.0, 70.0, 40.0, 10.0, 60.0, 20.0, 20.0, 250.0, 10.0, 220.0, 30.0, 20.0, 30.0, 10.0, 40.0, 90.0, 0.0, 10.0, 30.0, 20.0, 10.0, 0.0, 30.0, 20.0, 90.0, -50.0, 350.0, 160.0, 30.0, 40.0, 20.0, 480.0, 20.0, 30.0, 0.0, 50.0, 80.0, 30.0, 20.0, 20.0, 30.0, 360.0, 380.0, -30.0, 50.0, 0.0, 30.0, 20.0, 60.0, 30.0, 20.0, 40.0, 40.0, 30.0, 10.0, 150.0, 10.0, 0.0, 0.0, -10.0, 30.0, 40.0, 0.0, 0.0, 20.0, 60.0, 40.0, 10.0, 20.0, 20.0, 260.0, 40.0, 10.0, 40.0, 0.0, 0.0, 90.0, 0.0, 30.0, 0.0, 10.0, 20.0, 20.0, 50.0, 10.0, 0.0, 10.0, 20.0, 10.0, 90.0, 20.0, 0.0, 50.0, 20.0, 30.0, 30.0, 30.0, 0.0, 550.0, 0.0, -30.0, 90.0, 10.0, 20.0, 10.0, 20.0, 0.0, 0.0, 5.0, 40.0, 20.0, 150.0, 10.0, 50.0, 30.0, 120.0, 0.0, 0.0, 20.0, 30.0, 10.0, 30.0, 10.0, 40.0, 30.0, 40.0, 260.0, 40.0, 20.0, 60.0, 40.0, 50.0, 40.0, 30.0, 150.0, 30.0, 60.0, 220.0, 490.0, 0.0, 0.0, 10.0, 30.0, 40.0, 90.0, -30.0, -70.0, 30.0, 260.0, 170.0, -30.0, 0.0, 390.0, 20.0, -60.0, 20.0, 190.0, 30.0, 200.0, 130.0, 90.0, 60.0, 440.0, 20.0, 10.0, 460.0, 10.0, 0.0, 30.0, 30.0, 80.0, 150.0, 0.0, 20.0, 20.0, 0.0, 30.0, 160.0, 30.0, 50.0, 20.0, 250.0, 40.0, 40.0, 40.0, 60.0, 20.0, 20.0, 370.0, 110.0, 0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 10.0, 30.0, 20.0, 0.0, 30.0, 10.0, 10.0, 10.0, 10.0, 50.0, 250.0, 160.0, 40.0, 10.0, 210.0, 90.0, 80.0, 30.0, -30.0, 40.0, 0.0, 20.0, 10.0, 50.0, 20.0, 30.0, 0.0, 10.0, 10.0, 40.0, 10.0, 30.0, 0.0, 100.0, 20.0, 100.0, 110.0, 20.0, 10.0, 50.0, 10.0, 30.0, 20.0, 190.0, 10.0, 30.0, 10.0, 30.0, 0.0, 180.0, 0.0, 0.0, 0.0, 0.0, -40.0, 50.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 20.0, 20.0, 60.0, 70.0, 170.0, 160.0, 30.0, 0.0, 10.0, 0.0, -20.0, 10.0, 30.0, 40.0, 20.0, 100.0, 20.0, 30.0, 180.0, 20.0, 20.0, 0.0, 0.0, 40.0, 10.0, 60.0, 40.0, 20.0, 40.0, 70.0, 30.0, 10.0, 10.0, 370.0, 20.0, 10.0, -50.0, 20.0, 10.0, 10.0, 0.0, 30.0, 300.0, 60.0, 0.0, 0.0, 0.0, 180.0, 160.0, 50.0, 10.0, 35.0, 40.0, 10.0, 350.0, 40.0, 170.0, 40.0, 40.0, 450.0, 30.0, 20.0, 0.0, 10.0, 40.0, 100.0, 60.0, 30.0, 20.0, 490.0, 50.0, 210.0, 20.0, 60.0, 280.0, 70.0, 170.0, 280.0, -150.0, 30.0, 110.0, 680.0, -100.0, 40.0, -60.0, 10.0, -140.0, 20.0, 10.0, 20.0, 80.0, 760.0, 20.0, 160.0, 60.0, 20.0, 30.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 30.0, 200.0, -50.0, 20.0, 60.0, 40.0, 70.0, -100.0, 660.0, 30.0, 20.0, -50.0, 20.0, 40.0, 40.0, 40.0, 0.0, 20.0, 20.0, 10.0, 0.0, 40.0, 0.0, 0.0, 20.0, 0.0, 30.0, 20.0, 30.0, 20.0, 10.0, 30.0, 20.0, 0.0, 60.0, 320.0, 90.0, 70.0, 270.0, 20.0, 80.0, 20.0, 30.0, 0.0, 10.0, 50.0, 470.0, 20.0, 40.0, 110.0, 10.0, 30.0, 0.0, 30.0, 20.0, 40.0, 0.0, 70.0, 150.0, 110.0, 0.0, 50.0, 0.0, 10.0, 50.0, 40.0, 0.0, 0.0, 70.0, 0.0, 20.0, 40.0, -40.0, 40.0, 310.0, 750.0, 60.0, 60.0, 50.0, -10.0, -50.0, 40.0, 90.0, 20.0, 90.0, 90.0, 30.0, 270.0, 50.0, 310.0, 20.0, 40.0, 0.0, 0.0, 10.0, 120.0, 70.0, 0.0, 40.0, 20.0, 10.0, 10.0, 10.0, 30.0, 100.0, 60.0, 160.0, 190.0, -30.0, 350.0, 40.0, 70.0, 50.0, 30.0, 60.0, 30.0, 30.0, 40.0, 150.0, 380.0, 40.0, 330.0, 310.0, 80.0, 110.0, 50.0, 20.0, 100.0, 150.0, 230.0, 170.0, 20.0, 10.0, 40.0, 20.0, 40.0, 40.0, 150.0, 0.0, 10.0, 70.0, 0.0, 0.0, 0.0, 30.0, 150.0, 30.0, 40.0, 30.0, 20.0, 0.0, 30.0, -130.0, 150.0, 160.0, 170.0, 20.0, 40.0, 20.0, 40.0, 0.0, 20.0, 0.0, 20.0, 20.0, 0.0, 40.0, 20.0, 0.0, 30.0, 10.0, 40.0, 20.0, 90.0, 30.0, 70.0, 0.0, 20.0, 40.0, 0.0, 130.0, 30.0, 20.0, 30.0, 80.0, 50.0, 150.0, -50.0, 40.0, 650.0, 50.0, 30.0, 0.0, 20.0, 170.0, 0.0, 20.0, 0.0, 10.0, 10.0, 30.0, 10.0, -40.0, 280.0, -50.0, 40.0, 370.0, 80.0, 60.0, 110.0, 130.0, 120.0, 30.0, 20.0, 40.0, 40.0, 0.0, 0.0, 20.0, 0.0, 40.0, 30.0, 30.0, 30.0, 70.0, 180.0, 60.0, 50.0, 180.0, 20.0, 0.0, 160.0, 30.0, 50.0, 50.0, 20.0, 0.0, 70.0, 0.0, 40.0, 0.0, 0.0, 20.0, 20.0, 10.0, 50.0, 250.0, 0.0, 50.0, 50.0, 0.0, 10.0, 50.0, 30.0, 40.0, 80.0, 30.0, 40.0, 30.0, 30.0, 0.0, 20.0, 0.0, 30.0, -5.0, 0.0, 10.0, 40.0, 10.0, 50.0, 10.0, 190.0, 0.0, 0.0, 30.0, 40.0, 10.0, 0.0, 20.0, 50.0, 0.0, 20.0, 30.0, 330.0, 10.0, 10.0, 350.0, 80.0, 10.0, 20.0, 20.0, 100.0, 40.0, 60.0, 40.0, 100.0, 670.0, 10.0, 30.0, 20.0, 70.0, 40.0, 0.0, 0.0, 40.0, 90.0, 20.0, 20.0, 10.0, 40.0, 30.0, 20.0, 10.0, 0.0, 0.0, 160.0, 380.0, 80.0, 40.0, 40.0, 60.0, 100.0, 0.0, 90.0, 40.0, 30.0, 20.0, 0.0, 30.0, 40.0, 0.0, 40.0, 130.0, 50.0, 10.0, 260.0, 200.0, 160.0, 180.0, 10.0, 30.0, 100.0, 0.0, 260.0, 120.0, 10.0, 20.0, 40.0, 15.0, 10.0, 50.0, 20.0, 0.0, 10.0, 50.0, 0.0, 110.0, 20.0, 20.0, 30.0, 20.0, 100.0, 30.0, 10.0, 70.0, 245.0, 0.0, 20.0, 40.0, 450.0, 10.0, 30.0, 10.0, 20.0, 30.0, 10.0, 70.0, 10.0, 20.0, 0.0, 0.0, 130.0, 90.0, 80.0, 10.0, 60.0, 0.0, 80.0, 10.0, 20.0, 50.0, 180.0, 60.0, 10.0, 20.0, 20.0, 790.0, 310.0, 60.0, 360.0, 10.0, 40.0, 10.0, 60.0, 80.0, 20.0, 150.0, 20.0, 10.0, 10.0, 210.0, 30.0, 80.0, 20.0, 40.0, 150.0, 10.0, 40.0, 40.0, 10.0, 40.0, 20.0, 20.0, 10.0, 50.0, 40.0, 30.0, 20.0, 130.0, 0.0, 260.0, 20.0, 60.0, 20.0, 10.0, 60.0, 60.0, 70.0, 0.0, 600.0, -70.0, -150.0, 30.0, 40.0, 0.0, 30.0, 40.0, 50.0, 10.0, 0.0, 10.0, 30.0, 0.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 40.0, 10.0, 0.0, 30.0, 30.0, 70.0, 140.0, 30.0, 0.0, 20.0, 30.0, 300.0, 40.0, 90.0, 30.0, 60.0, 30.0, 20.0, 10.0, 20.0, 90.0, 20.0, 10.0, 40.0, 70.0, 30.0, 40.0, 10.0, 10.0, 10.0, 20.0, 10.0, 260.0, 30.0, 50.0, 20.0, 30.0, 10.0, 20.0, 80.0, 90.0, 150.0, 80.0, 10.0, 50.0, -50.0, 240.0, 30.0, 100.0, 0.0, 40.0, 40.0, 270.0, 90.0, 0.0, 20.0, 20.0, 0.0, 70.0, 50.0, 30.0, 20.0, 150.0, 20.0, 20.0, 20.0, 60.0, 0.0, 20.0, 0.0, 30.0, 20.0, 160.0, 30.0, 10.0, 20.0, 30.0, 0.0, 100.0, 0.0, 60.0, 455.0, 100.0, 20.0, 45.0, 30.0, 30.0, 20.0, 15.0, 40.0, 100.0, 350.0, 100.0, 10.0, 10.0, 50.0, 180.0, 0.0, 0.0, 200.0, 20.0, 40.0, 30.0, 20.0, 20.0, 10.0, 30.0, 30.0, 30.0, 160.0, 0.0, 20.0, 10.0, 260.0, 0.0, 20.0, 20.0, 10.0, 150.0, 0.0, 180.0, 0.0, 50.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4262338977328768, "mean_inference_ms": 1.6267735878013945, "mean_action_processing_ms": 0.4209556373157902, "mean_env_wait_ms": 1.3085232066265562, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05452585220336914, "StateBufferConnector_ms": 0.009031534194946289, "ViewRequirementAgentConnector_ms": 0.3636758327484131}, "num_episodes": 18, "episode_return_max": 1680.0, "episode_return_min": 150.0, "episode_return_mean": 587.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.445311026138704, "num_env_steps_trained_throughput_per_sec": 36.445311026138704, "timesteps_total": 464000, "num_env_steps_sampled_lifetime": 464000, "num_agent_steps_sampled_lifetime": 4640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4640000, "timers": {"training_iteration_time_ms": 110067.177, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110067.127, "sample_time_ms": 2369.467, "learn_time_ms": 107678.804, "learn_throughput": 37.148, "synch_weights_time_ms": 10.13}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 4640000, "num_agent_steps_trained": 4640000}, "done": false, "training_iteration": 116, "trial_id": "57140_00000", "date": "2024-06-27_02-53-05", "timestamp": 1719471185, "time_this_iter_s": 109.76628613471985, "time_total_s": 13110.258877038956, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b25c8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13110.258877038956, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 15.174193548387096, "ram_util_percent": 77.9090322580645}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6598326143682702, "cur_kl_coeff": 7.022133516829253, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002096717207294842, "vf_loss": 4.310533473590692, "vf_explained_var": -0.0001588279002517684, "kl": Infinity, "entropy": 0.37046073984128597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1093935.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000}, "env_runners": {"episode_reward_max": 1940.0, "episode_reward_min": 70.0, "episode_reward_mean": 593.0, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 800.0}, "policy_reward_mean": {"policy_0": 59.3}, "custom_metrics": {}, "hist_stats": {"episode_reward": [800.0, 660.0, 620.0, 150.0, 890.0, 190.0, 440.0, 380.0, 250.0, 600.0, 210.0, 400.0, 530.0, 430.0, 1045.0, 790.0, 1400.0, 700.0, 1180.0, 290.0, 700.0, 230.0, 160.0, 950.0, 770.0, 470.0, 230.0, 1210.0, 1010.0, 280.0, 980.0, 1140.0, 1240.0, 380.0, 330.0, 490.0, 180.0, 430.0, 1050.0, 270.0, 1100.0, 220.0, 780.0, 260.0, 460.0, 350.0, 335.0, 170.0, 960.0, 1080.0, 270.0, 870.0, 290.0, 1130.0, 545.0, 360.0, 905.0, 300.0, 580.0, 1680.0, 600.0, 450.0, 580.0, 660.0, 240.0, 150.0, 690.0, 380.0, 500.0, 560.0, 730.0, 450.0, 350.0, 805.0, 750.0, 540.0, 330.0, 690.0, 200.0, 575.0, 790.0, 360.0, 210.0, 220.0, 70.0, 705.0, 640.0, 1940.0, 540.0, 1160.0, 740.0, 670.0, 110.0, 400.0, 760.0, 750.0, 180.0, 190.0, 1125.0, 410.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [460.0, 10.0, 0.0, 30.0, 30.0, 80.0, 150.0, 0.0, 20.0, 20.0, 0.0, 30.0, 160.0, 30.0, 50.0, 20.0, 250.0, 40.0, 40.0, 40.0, 60.0, 20.0, 20.0, 370.0, 110.0, 0.0, 0.0, 20.0, 20.0, 0.0, 20.0, 10.0, 30.0, 20.0, 0.0, 30.0, 10.0, 10.0, 10.0, 10.0, 50.0, 250.0, 160.0, 40.0, 10.0, 210.0, 90.0, 80.0, 30.0, -30.0, 40.0, 0.0, 20.0, 10.0, 50.0, 20.0, 30.0, 0.0, 10.0, 10.0, 40.0, 10.0, 30.0, 0.0, 100.0, 20.0, 100.0, 110.0, 20.0, 10.0, 50.0, 10.0, 30.0, 20.0, 190.0, 10.0, 30.0, 10.0, 30.0, 0.0, 180.0, 0.0, 0.0, 0.0, 0.0, -40.0, 50.0, 20.0, 20.0, 20.0, 30.0, 30.0, 10.0, 20.0, 20.0, 60.0, 70.0, 170.0, 160.0, 30.0, 0.0, 10.0, 0.0, -20.0, 10.0, 30.0, 40.0, 20.0, 100.0, 20.0, 30.0, 180.0, 20.0, 20.0, 0.0, 0.0, 40.0, 10.0, 60.0, 40.0, 20.0, 40.0, 70.0, 30.0, 10.0, 10.0, 370.0, 20.0, 10.0, -50.0, 20.0, 10.0, 10.0, 0.0, 30.0, 300.0, 60.0, 0.0, 0.0, 0.0, 180.0, 160.0, 50.0, 10.0, 35.0, 40.0, 10.0, 350.0, 40.0, 170.0, 40.0, 40.0, 450.0, 30.0, 20.0, 0.0, 10.0, 40.0, 100.0, 60.0, 30.0, 20.0, 490.0, 50.0, 210.0, 20.0, 60.0, 280.0, 70.0, 170.0, 280.0, -150.0, 30.0, 110.0, 680.0, -100.0, 40.0, -60.0, 10.0, -140.0, 20.0, 10.0, 20.0, 80.0, 760.0, 20.0, 160.0, 60.0, 20.0, 30.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 30.0, 200.0, -50.0, 20.0, 60.0, 40.0, 70.0, -100.0, 660.0, 30.0, 20.0, -50.0, 20.0, 40.0, 40.0, 40.0, 0.0, 20.0, 20.0, 10.0, 0.0, 40.0, 0.0, 0.0, 20.0, 0.0, 30.0, 20.0, 30.0, 20.0, 10.0, 30.0, 20.0, 0.0, 60.0, 320.0, 90.0, 70.0, 270.0, 20.0, 80.0, 20.0, 30.0, 0.0, 10.0, 50.0, 470.0, 20.0, 40.0, 110.0, 10.0, 30.0, 0.0, 30.0, 20.0, 40.0, 0.0, 70.0, 150.0, 110.0, 0.0, 50.0, 0.0, 10.0, 50.0, 40.0, 0.0, 0.0, 70.0, 0.0, 20.0, 40.0, -40.0, 40.0, 310.0, 750.0, 60.0, 60.0, 50.0, -10.0, -50.0, 40.0, 90.0, 20.0, 90.0, 90.0, 30.0, 270.0, 50.0, 310.0, 20.0, 40.0, 0.0, 0.0, 10.0, 120.0, 70.0, 0.0, 40.0, 20.0, 10.0, 10.0, 10.0, 30.0, 100.0, 60.0, 160.0, 190.0, -30.0, 350.0, 40.0, 70.0, 50.0, 30.0, 60.0, 30.0, 30.0, 40.0, 150.0, 380.0, 40.0, 330.0, 310.0, 80.0, 110.0, 50.0, 20.0, 100.0, 150.0, 230.0, 170.0, 20.0, 10.0, 40.0, 20.0, 40.0, 40.0, 150.0, 0.0, 10.0, 70.0, 0.0, 0.0, 0.0, 30.0, 150.0, 30.0, 40.0, 30.0, 20.0, 0.0, 30.0, -130.0, 150.0, 160.0, 170.0, 20.0, 40.0, 20.0, 40.0, 0.0, 20.0, 0.0, 20.0, 20.0, 0.0, 40.0, 20.0, 0.0, 30.0, 10.0, 40.0, 20.0, 90.0, 30.0, 70.0, 0.0, 20.0, 40.0, 0.0, 130.0, 30.0, 20.0, 30.0, 80.0, 50.0, 150.0, -50.0, 40.0, 650.0, 50.0, 30.0, 0.0, 20.0, 170.0, 0.0, 20.0, 0.0, 10.0, 10.0, 30.0, 10.0, -40.0, 280.0, -50.0, 40.0, 370.0, 80.0, 60.0, 110.0, 130.0, 120.0, 30.0, 20.0, 40.0, 40.0, 0.0, 0.0, 20.0, 0.0, 40.0, 30.0, 30.0, 30.0, 70.0, 180.0, 60.0, 50.0, 180.0, 20.0, 0.0, 160.0, 30.0, 50.0, 50.0, 20.0, 0.0, 70.0, 0.0, 40.0, 0.0, 0.0, 20.0, 20.0, 10.0, 50.0, 250.0, 0.0, 50.0, 50.0, 0.0, 10.0, 50.0, 30.0, 40.0, 80.0, 30.0, 40.0, 30.0, 30.0, 0.0, 20.0, 0.0, 30.0, -5.0, 0.0, 10.0, 40.0, 10.0, 50.0, 10.0, 190.0, 0.0, 0.0, 30.0, 40.0, 10.0, 0.0, 20.0, 50.0, 0.0, 20.0, 30.0, 330.0, 10.0, 10.0, 350.0, 80.0, 10.0, 20.0, 20.0, 100.0, 40.0, 60.0, 40.0, 100.0, 670.0, 10.0, 30.0, 20.0, 70.0, 40.0, 0.0, 0.0, 40.0, 90.0, 20.0, 20.0, 10.0, 40.0, 30.0, 20.0, 10.0, 0.0, 0.0, 160.0, 380.0, 80.0, 40.0, 40.0, 60.0, 100.0, 0.0, 90.0, 40.0, 30.0, 20.0, 0.0, 30.0, 40.0, 0.0, 40.0, 130.0, 50.0, 10.0, 260.0, 200.0, 160.0, 180.0, 10.0, 30.0, 100.0, 0.0, 260.0, 120.0, 10.0, 20.0, 40.0, 15.0, 10.0, 50.0, 20.0, 0.0, 10.0, 50.0, 0.0, 110.0, 20.0, 20.0, 30.0, 20.0, 100.0, 30.0, 10.0, 70.0, 245.0, 0.0, 20.0, 40.0, 450.0, 10.0, 30.0, 10.0, 20.0, 30.0, 10.0, 70.0, 10.0, 20.0, 0.0, 0.0, 130.0, 90.0, 80.0, 10.0, 60.0, 0.0, 80.0, 10.0, 20.0, 50.0, 180.0, 60.0, 10.0, 20.0, 20.0, 790.0, 310.0, 60.0, 360.0, 10.0, 40.0, 10.0, 60.0, 80.0, 20.0, 150.0, 20.0, 10.0, 10.0, 210.0, 30.0, 80.0, 20.0, 40.0, 150.0, 10.0, 40.0, 40.0, 10.0, 40.0, 20.0, 20.0, 10.0, 50.0, 40.0, 30.0, 20.0, 130.0, 0.0, 260.0, 20.0, 60.0, 20.0, 10.0, 60.0, 60.0, 70.0, 0.0, 600.0, -70.0, -150.0, 30.0, 40.0, 0.0, 30.0, 40.0, 50.0, 10.0, 0.0, 10.0, 30.0, 0.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 40.0, 10.0, 0.0, 30.0, 30.0, 70.0, 140.0, 30.0, 0.0, 20.0, 30.0, 300.0, 40.0, 90.0, 30.0, 60.0, 30.0, 20.0, 10.0, 20.0, 90.0, 20.0, 10.0, 40.0, 70.0, 30.0, 40.0, 10.0, 10.0, 10.0, 20.0, 10.0, 260.0, 30.0, 50.0, 20.0, 30.0, 10.0, 20.0, 80.0, 90.0, 150.0, 80.0, 10.0, 50.0, -50.0, 240.0, 30.0, 100.0, 0.0, 40.0, 40.0, 270.0, 90.0, 0.0, 20.0, 20.0, 0.0, 70.0, 50.0, 30.0, 20.0, 150.0, 20.0, 20.0, 20.0, 60.0, 0.0, 20.0, 0.0, 30.0, 20.0, 160.0, 30.0, 10.0, 20.0, 30.0, 0.0, 100.0, 0.0, 60.0, 455.0, 100.0, 20.0, 45.0, 30.0, 30.0, 20.0, 15.0, 40.0, 100.0, 350.0, 100.0, 10.0, 10.0, 50.0, 180.0, 0.0, 0.0, 200.0, 20.0, 40.0, 30.0, 20.0, 20.0, 10.0, 30.0, 30.0, 30.0, 160.0, 0.0, 20.0, 10.0, 260.0, 0.0, 20.0, 20.0, 10.0, 150.0, 0.0, 180.0, 0.0, 50.0, 30.0, 20.0, 0.0, 40.0, 0.0, 0.0, 80.0, 10.0, 20.0, 0.0, 30.0, 60.0, 10.0, 20.0, 60.0, 20.0, 270.0, 90.0, 15.0, 0.0, 0.0, -30.0, 10.0, 40.0, 40.0, 0.0, 40.0, 90.0, 20.0, 580.0, 30.0, 70.0, 40.0, 40.0, 10.0, 40.0, 0.0, 40.0, 30.0, 60.0, 10.0, 40.0, 70.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 20.0, 60.0, 0.0, 50.0, 10.0, 0.0, 10.0, 40.0, 30.0, 0.0, 20.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -5.0, 30.0, 40.0, 40.0, 120.0, 0.0, 210.0, 170.0, 50.0, 50.0, 30.0, 0.0, 0.0, 100.0, 170.0, 270.0, 0.0, 50.0, 10.0, 10.0, 100.0, 50.0, -20.0, 370.0, 270.0, 10.0, 180.0, 800.0, 130.0, 50.0, 20.0, 60.0, 30.0, 10.0, 80.0, 250.0, 0.0, 10.0, 50.0, 30.0, 30.0, -100.0, 190.0, 660.0, 30.0, 50.0, 90.0, 30.0, 70.0, 110.0, 370.0, 40.0, 20.0, 30.0, 0.0, 60.0, 30.0, 150.0, 10.0, 30.0, 370.0, 50.0, 130.0, -10.0, 30.0, -10.0, 0.0, 70.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 50.0, 20.0, 0.0, 20.0, 0.0, 50.0, 20.0, 0.0, 280.0, 10.0, 20.0, 0.0, 0.0, 10.0, 10.0, 50.0, 200.0, 20.0, 20.0, 70.0, 150.0, 30.0, 10.0, 180.0, 30.0, 40.0, 90.0, 0.0, 10.0, 20.0, 10.0, 10.0, 370.0, 160.0, 40.0, 70.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 0.0, 80.0, 10.0, 10.0, 10.0, 0.0, 40.0, 50.0, 10.0, 130.0, 140.0, 60.0, 100.0, 10.0, 370.0, 260.0, -5.0, 10.0, 10.0, 30.0, 50.0, 10.0, 60.0, 40.0, 30.0, 170.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4288039032583149, "mean_inference_ms": 1.6325221248681188, "mean_action_processing_ms": 0.42228210419626605, "mean_env_wait_ms": 1.3106946227840615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0589139461517334, "StateBufferConnector_ms": 0.009220361709594727, "ViewRequirementAgentConnector_ms": 0.38132333755493164}, "num_episodes": 22, "episode_return_max": 1940.0, "episode_return_min": 70.0, "episode_return_mean": 593.0}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.04593441202141, "num_env_steps_trained_throughput_per_sec": 36.04593441202141, "timesteps_total": 468000, "num_env_steps_sampled_lifetime": 468000, "num_agent_steps_sampled_lifetime": 4680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4680000, "timers": {"training_iteration_time_ms": 110029.092, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110029.044, "sample_time_ms": 2379.849, "learn_time_ms": 107630.233, "learn_throughput": 37.164, "synch_weights_time_ms": 10.404}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 4680000, "num_agent_steps_trained": 4680000}, "done": false, "training_iteration": 117, "trial_id": "57140_00000", "date": "2024-06-27_02-54-56", "timestamp": 1719471296, "time_this_iter_s": 110.98359084129333, "time_total_s": 13221.242467880249, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23a79d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13221.242467880249, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 17.32229299363057, "ram_util_percent": 77.78789808917197}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.630781552931879, "cur_kl_coeff": 10.533200275243875, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0017910881855161076, "vf_loss": 3.989794715169393, "vf_explained_var": -7.577913637740162e-05, "kl": Infinity, "entropy": 0.372444455316082, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1103325.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000}, "env_runners": {"episode_reward_max": 1940.0, "episode_reward_min": 70.0, "episode_reward_mean": 580.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 800.0}, "policy_reward_mean": {"policy_0": 58.095}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1180.0, 290.0, 700.0, 230.0, 160.0, 950.0, 770.0, 470.0, 230.0, 1210.0, 1010.0, 280.0, 980.0, 1140.0, 1240.0, 380.0, 330.0, 490.0, 180.0, 430.0, 1050.0, 270.0, 1100.0, 220.0, 780.0, 260.0, 460.0, 350.0, 335.0, 170.0, 960.0, 1080.0, 270.0, 870.0, 290.0, 1130.0, 545.0, 360.0, 905.0, 300.0, 580.0, 1680.0, 600.0, 450.0, 580.0, 660.0, 240.0, 150.0, 690.0, 380.0, 500.0, 560.0, 730.0, 450.0, 350.0, 805.0, 750.0, 540.0, 330.0, 690.0, 200.0, 575.0, 790.0, 360.0, 210.0, 220.0, 70.0, 705.0, 640.0, 1940.0, 540.0, 1160.0, 740.0, 670.0, 110.0, 400.0, 760.0, 750.0, 180.0, 190.0, 1125.0, 410.0, 950.0, 400.0, 730.0, 170.0, 940.0, 200.0, 270.0, 170.0, 140.0, 910.0, 70.0, 900.0, 810.0, 150.0, 1250.0, 480.0, 260.0, 480.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 10.0, 20.0, 80.0, 760.0, 20.0, 160.0, 60.0, 20.0, 30.0, 0.0, 0.0, 10.0, 10.0, 10.0, 20.0, 10.0, 0.0, 30.0, 200.0, -50.0, 20.0, 60.0, 40.0, 70.0, -100.0, 660.0, 30.0, 20.0, -50.0, 20.0, 40.0, 40.0, 40.0, 0.0, 20.0, 20.0, 10.0, 0.0, 40.0, 0.0, 0.0, 20.0, 0.0, 30.0, 20.0, 30.0, 20.0, 10.0, 30.0, 20.0, 0.0, 60.0, 320.0, 90.0, 70.0, 270.0, 20.0, 80.0, 20.0, 30.0, 0.0, 10.0, 50.0, 470.0, 20.0, 40.0, 110.0, 10.0, 30.0, 0.0, 30.0, 20.0, 40.0, 0.0, 70.0, 150.0, 110.0, 0.0, 50.0, 0.0, 10.0, 50.0, 40.0, 0.0, 0.0, 70.0, 0.0, 20.0, 40.0, -40.0, 40.0, 310.0, 750.0, 60.0, 60.0, 50.0, -10.0, -50.0, 40.0, 90.0, 20.0, 90.0, 90.0, 30.0, 270.0, 50.0, 310.0, 20.0, 40.0, 0.0, 0.0, 10.0, 120.0, 70.0, 0.0, 40.0, 20.0, 10.0, 10.0, 10.0, 30.0, 100.0, 60.0, 160.0, 190.0, -30.0, 350.0, 40.0, 70.0, 50.0, 30.0, 60.0, 30.0, 30.0, 40.0, 150.0, 380.0, 40.0, 330.0, 310.0, 80.0, 110.0, 50.0, 20.0, 100.0, 150.0, 230.0, 170.0, 20.0, 10.0, 40.0, 20.0, 40.0, 40.0, 150.0, 0.0, 10.0, 70.0, 0.0, 0.0, 0.0, 30.0, 150.0, 30.0, 40.0, 30.0, 20.0, 0.0, 30.0, -130.0, 150.0, 160.0, 170.0, 20.0, 40.0, 20.0, 40.0, 0.0, 20.0, 0.0, 20.0, 20.0, 0.0, 40.0, 20.0, 0.0, 30.0, 10.0, 40.0, 20.0, 90.0, 30.0, 70.0, 0.0, 20.0, 40.0, 0.0, 130.0, 30.0, 20.0, 30.0, 80.0, 50.0, 150.0, -50.0, 40.0, 650.0, 50.0, 30.0, 0.0, 20.0, 170.0, 0.0, 20.0, 0.0, 10.0, 10.0, 30.0, 10.0, -40.0, 280.0, -50.0, 40.0, 370.0, 80.0, 60.0, 110.0, 130.0, 120.0, 30.0, 20.0, 40.0, 40.0, 0.0, 0.0, 20.0, 0.0, 40.0, 30.0, 30.0, 30.0, 70.0, 180.0, 60.0, 50.0, 180.0, 20.0, 0.0, 160.0, 30.0, 50.0, 50.0, 20.0, 0.0, 70.0, 0.0, 40.0, 0.0, 0.0, 20.0, 20.0, 10.0, 50.0, 250.0, 0.0, 50.0, 50.0, 0.0, 10.0, 50.0, 30.0, 40.0, 80.0, 30.0, 40.0, 30.0, 30.0, 0.0, 20.0, 0.0, 30.0, -5.0, 0.0, 10.0, 40.0, 10.0, 50.0, 10.0, 190.0, 0.0, 0.0, 30.0, 40.0, 10.0, 0.0, 20.0, 50.0, 0.0, 20.0, 30.0, 330.0, 10.0, 10.0, 350.0, 80.0, 10.0, 20.0, 20.0, 100.0, 40.0, 60.0, 40.0, 100.0, 670.0, 10.0, 30.0, 20.0, 70.0, 40.0, 0.0, 0.0, 40.0, 90.0, 20.0, 20.0, 10.0, 40.0, 30.0, 20.0, 10.0, 0.0, 0.0, 160.0, 380.0, 80.0, 40.0, 40.0, 60.0, 100.0, 0.0, 90.0, 40.0, 30.0, 20.0, 0.0, 30.0, 40.0, 0.0, 40.0, 130.0, 50.0, 10.0, 260.0, 200.0, 160.0, 180.0, 10.0, 30.0, 100.0, 0.0, 260.0, 120.0, 10.0, 20.0, 40.0, 15.0, 10.0, 50.0, 20.0, 0.0, 10.0, 50.0, 0.0, 110.0, 20.0, 20.0, 30.0, 20.0, 100.0, 30.0, 10.0, 70.0, 245.0, 0.0, 20.0, 40.0, 450.0, 10.0, 30.0, 10.0, 20.0, 30.0, 10.0, 70.0, 10.0, 20.0, 0.0, 0.0, 130.0, 90.0, 80.0, 10.0, 60.0, 0.0, 80.0, 10.0, 20.0, 50.0, 180.0, 60.0, 10.0, 20.0, 20.0, 790.0, 310.0, 60.0, 360.0, 10.0, 40.0, 10.0, 60.0, 80.0, 20.0, 150.0, 20.0, 10.0, 10.0, 210.0, 30.0, 80.0, 20.0, 40.0, 150.0, 10.0, 40.0, 40.0, 10.0, 40.0, 20.0, 20.0, 10.0, 50.0, 40.0, 30.0, 20.0, 130.0, 0.0, 260.0, 20.0, 60.0, 20.0, 10.0, 60.0, 60.0, 70.0, 0.0, 600.0, -70.0, -150.0, 30.0, 40.0, 0.0, 30.0, 40.0, 50.0, 10.0, 0.0, 10.0, 30.0, 0.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 40.0, 10.0, 0.0, 30.0, 30.0, 70.0, 140.0, 30.0, 0.0, 20.0, 30.0, 300.0, 40.0, 90.0, 30.0, 60.0, 30.0, 20.0, 10.0, 20.0, 90.0, 20.0, 10.0, 40.0, 70.0, 30.0, 40.0, 10.0, 10.0, 10.0, 20.0, 10.0, 260.0, 30.0, 50.0, 20.0, 30.0, 10.0, 20.0, 80.0, 90.0, 150.0, 80.0, 10.0, 50.0, -50.0, 240.0, 30.0, 100.0, 0.0, 40.0, 40.0, 270.0, 90.0, 0.0, 20.0, 20.0, 0.0, 70.0, 50.0, 30.0, 20.0, 150.0, 20.0, 20.0, 20.0, 60.0, 0.0, 20.0, 0.0, 30.0, 20.0, 160.0, 30.0, 10.0, 20.0, 30.0, 0.0, 100.0, 0.0, 60.0, 455.0, 100.0, 20.0, 45.0, 30.0, 30.0, 20.0, 15.0, 40.0, 100.0, 350.0, 100.0, 10.0, 10.0, 50.0, 180.0, 0.0, 0.0, 200.0, 20.0, 40.0, 30.0, 20.0, 20.0, 10.0, 30.0, 30.0, 30.0, 160.0, 0.0, 20.0, 10.0, 260.0, 0.0, 20.0, 20.0, 10.0, 150.0, 0.0, 180.0, 0.0, 50.0, 30.0, 20.0, 0.0, 40.0, 0.0, 0.0, 80.0, 10.0, 20.0, 0.0, 30.0, 60.0, 10.0, 20.0, 60.0, 20.0, 270.0, 90.0, 15.0, 0.0, 0.0, -30.0, 10.0, 40.0, 40.0, 0.0, 40.0, 90.0, 20.0, 580.0, 30.0, 70.0, 40.0, 40.0, 10.0, 40.0, 0.0, 40.0, 30.0, 60.0, 10.0, 40.0, 70.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 20.0, 60.0, 0.0, 50.0, 10.0, 0.0, 10.0, 40.0, 30.0, 0.0, 20.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -5.0, 30.0, 40.0, 40.0, 120.0, 0.0, 210.0, 170.0, 50.0, 50.0, 30.0, 0.0, 0.0, 100.0, 170.0, 270.0, 0.0, 50.0, 10.0, 10.0, 100.0, 50.0, -20.0, 370.0, 270.0, 10.0, 180.0, 800.0, 130.0, 50.0, 20.0, 60.0, 30.0, 10.0, 80.0, 250.0, 0.0, 10.0, 50.0, 30.0, 30.0, -100.0, 190.0, 660.0, 30.0, 50.0, 90.0, 30.0, 70.0, 110.0, 370.0, 40.0, 20.0, 30.0, 0.0, 60.0, 30.0, 150.0, 10.0, 30.0, 370.0, 50.0, 130.0, -10.0, 30.0, -10.0, 0.0, 70.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 50.0, 20.0, 0.0, 20.0, 0.0, 50.0, 20.0, 0.0, 280.0, 10.0, 20.0, 0.0, 0.0, 10.0, 10.0, 50.0, 200.0, 20.0, 20.0, 70.0, 150.0, 30.0, 10.0, 180.0, 30.0, 40.0, 90.0, 0.0, 10.0, 20.0, 10.0, 10.0, 370.0, 160.0, 40.0, 70.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 0.0, 80.0, 10.0, 10.0, 10.0, 0.0, 40.0, 50.0, 10.0, 130.0, 140.0, 60.0, 100.0, 10.0, 370.0, 260.0, -5.0, 10.0, 10.0, 30.0, 50.0, 10.0, 60.0, 40.0, 30.0, 170.0, 0.0, 30.0, 160.0, 20.0, 0.0, 40.0, 50.0, 360.0, 190.0, 80.0, 20.0, 0.0, 40.0, 0.0, 30.0, 30.0, 0.0, 10.0, 30.0, 10.0, 250.0, 150.0, 0.0, 30.0, 0.0, 350.0, 0.0, 20.0, 170.0, 10.0, 0.0, 40.0, 0.0, 0.0, 10.0, 10.0, 40.0, 0.0, 20.0, 40.0, 10.0, 50.0, 600.0, -30.0, 0.0, 90.0, 10.0, 170.0, 40.0, -10.0, 20.0, 70.0, 40.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 40.0, 40.0, 10.0, 60.0, 10.0, 20.0, 20.0, 0.0, 40.0, 50.0, 20.0, 30.0, 10.0, 0.0, 20.0, 0.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 40.0, 0.0, 30.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 60.0, 30.0, 570.0, 0.0, 10.0, 50.0, 30.0, 0.0, 120.0, 40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 20.0, -10.0, -40.0, 70.0, 70.0, 60.0, 40.0, 20.0, 180.0, 20.0, 490.0, 50.0, 60.0, 60.0, 10.0, 20.0, 370.0, 150.0, 40.0, 40.0, 10.0, 0.0, 0.0, 30.0, 0.0, 20.0, 40.0, 0.0, 30.0, 0.0, 30.0, 80.0, 30.0, 60.0, 60.0, 190.0, 320.0, 40.0, 80.0, 360.0, 30.0, 50.0, 200.0, 90.0, 0.0, 70.0, 40.0, 20.0, 10.0, 0.0, 0.0, 40.0, 20.0, 70.0, 20.0, 40.0, 0.0, 10.0, 10.0, 10.0, 40.0, 20.0, 10.0, 40.0, 10.0, 40.0, 70.0, -10.0, 150.0, 80.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4246941505617587, "mean_inference_ms": 1.6244335483996182, "mean_action_processing_ms": 0.42036675877391444, "mean_env_wait_ms": 1.3071905053311303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05869650840759277, "StateBufferConnector_ms": 0.009193658828735352, "ViewRequirementAgentConnector_ms": 0.3850677013397217}, "num_episodes": 18, "episode_return_max": 1940.0, "episode_return_min": 70.0, "episode_return_mean": 580.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.2449295855333, "num_env_steps_trained_throughput_per_sec": 36.2449295855333, "timesteps_total": 472000, "num_env_steps_sampled_lifetime": 472000, "num_agent_steps_sampled_lifetime": 4720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4720000, "timers": {"training_iteration_time_ms": 110069.084, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110069.035, "sample_time_ms": 2391.328, "learn_time_ms": 107658.731, "learn_throughput": 37.154, "synch_weights_time_ms": 10.463}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 4720000, "num_agent_steps_trained": 4720000}, "done": false, "training_iteration": 118, "trial_id": "57140_00000", "date": "2024-06-27_02-56-46", "timestamp": 1719471406, "time_this_iter_s": 110.37217998504639, "time_total_s": 13331.614647865295, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23fd820>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13331.614647865295, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 16.965384615384618, "ram_util_percent": 76.85448717948718}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.97656740997546, "cur_kl_coeff": 15.799800412865814, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0013959104978282072, "vf_loss": 4.287707123030235, "vf_explained_var": 0.0009302281406613839, "kl": Infinity, "entropy": 0.390354778423223, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1112715.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000}, "env_runners": {"episode_reward_max": 1940.0, "episode_reward_min": 70.0, "episode_reward_mean": 571.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 800.0}, "policy_reward_mean": {"policy_0": 57.155}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.0, 430.0, 1050.0, 270.0, 1100.0, 220.0, 780.0, 260.0, 460.0, 350.0, 335.0, 170.0, 960.0, 1080.0, 270.0, 870.0, 290.0, 1130.0, 545.0, 360.0, 905.0, 300.0, 580.0, 1680.0, 600.0, 450.0, 580.0, 660.0, 240.0, 150.0, 690.0, 380.0, 500.0, 560.0, 730.0, 450.0, 350.0, 805.0, 750.0, 540.0, 330.0, 690.0, 200.0, 575.0, 790.0, 360.0, 210.0, 220.0, 70.0, 705.0, 640.0, 1940.0, 540.0, 1160.0, 740.0, 670.0, 110.0, 400.0, 760.0, 750.0, 180.0, 190.0, 1125.0, 410.0, 950.0, 400.0, 730.0, 170.0, 940.0, 200.0, 270.0, 170.0, 140.0, 910.0, 70.0, 900.0, 810.0, 150.0, 1250.0, 480.0, 260.0, 480.0, 770.0, 250.0, 340.0, 260.0, 890.0, 260.0, 400.0, 290.0, 830.0, 230.0, 880.0, 1150.0, 890.0, 940.0, 180.0, 1210.0, 560.0, 770.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 20.0, 20.0, 0.0, 40.0, 20.0, 0.0, 30.0, 10.0, 40.0, 20.0, 90.0, 30.0, 70.0, 0.0, 20.0, 40.0, 0.0, 130.0, 30.0, 20.0, 30.0, 80.0, 50.0, 150.0, -50.0, 40.0, 650.0, 50.0, 30.0, 0.0, 20.0, 170.0, 0.0, 20.0, 0.0, 10.0, 10.0, 30.0, 10.0, -40.0, 280.0, -50.0, 40.0, 370.0, 80.0, 60.0, 110.0, 130.0, 120.0, 30.0, 20.0, 40.0, 40.0, 0.0, 0.0, 20.0, 0.0, 40.0, 30.0, 30.0, 30.0, 70.0, 180.0, 60.0, 50.0, 180.0, 20.0, 0.0, 160.0, 30.0, 50.0, 50.0, 20.0, 0.0, 70.0, 0.0, 40.0, 0.0, 0.0, 20.0, 20.0, 10.0, 50.0, 250.0, 0.0, 50.0, 50.0, 0.0, 10.0, 50.0, 30.0, 40.0, 80.0, 30.0, 40.0, 30.0, 30.0, 0.0, 20.0, 0.0, 30.0, -5.0, 0.0, 10.0, 40.0, 10.0, 50.0, 10.0, 190.0, 0.0, 0.0, 30.0, 40.0, 10.0, 0.0, 20.0, 50.0, 0.0, 20.0, 30.0, 330.0, 10.0, 10.0, 350.0, 80.0, 10.0, 20.0, 20.0, 100.0, 40.0, 60.0, 40.0, 100.0, 670.0, 10.0, 30.0, 20.0, 70.0, 40.0, 0.0, 0.0, 40.0, 90.0, 20.0, 20.0, 10.0, 40.0, 30.0, 20.0, 10.0, 0.0, 0.0, 160.0, 380.0, 80.0, 40.0, 40.0, 60.0, 100.0, 0.0, 90.0, 40.0, 30.0, 20.0, 0.0, 30.0, 40.0, 0.0, 40.0, 130.0, 50.0, 10.0, 260.0, 200.0, 160.0, 180.0, 10.0, 30.0, 100.0, 0.0, 260.0, 120.0, 10.0, 20.0, 40.0, 15.0, 10.0, 50.0, 20.0, 0.0, 10.0, 50.0, 0.0, 110.0, 20.0, 20.0, 30.0, 20.0, 100.0, 30.0, 10.0, 70.0, 245.0, 0.0, 20.0, 40.0, 450.0, 10.0, 30.0, 10.0, 20.0, 30.0, 10.0, 70.0, 10.0, 20.0, 0.0, 0.0, 130.0, 90.0, 80.0, 10.0, 60.0, 0.0, 80.0, 10.0, 20.0, 50.0, 180.0, 60.0, 10.0, 20.0, 20.0, 790.0, 310.0, 60.0, 360.0, 10.0, 40.0, 10.0, 60.0, 80.0, 20.0, 150.0, 20.0, 10.0, 10.0, 210.0, 30.0, 80.0, 20.0, 40.0, 150.0, 10.0, 40.0, 40.0, 10.0, 40.0, 20.0, 20.0, 10.0, 50.0, 40.0, 30.0, 20.0, 130.0, 0.0, 260.0, 20.0, 60.0, 20.0, 10.0, 60.0, 60.0, 70.0, 0.0, 600.0, -70.0, -150.0, 30.0, 40.0, 0.0, 30.0, 40.0, 50.0, 10.0, 0.0, 10.0, 30.0, 0.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 40.0, 10.0, 0.0, 30.0, 30.0, 70.0, 140.0, 30.0, 0.0, 20.0, 30.0, 300.0, 40.0, 90.0, 30.0, 60.0, 30.0, 20.0, 10.0, 20.0, 90.0, 20.0, 10.0, 40.0, 70.0, 30.0, 40.0, 10.0, 10.0, 10.0, 20.0, 10.0, 260.0, 30.0, 50.0, 20.0, 30.0, 10.0, 20.0, 80.0, 90.0, 150.0, 80.0, 10.0, 50.0, -50.0, 240.0, 30.0, 100.0, 0.0, 40.0, 40.0, 270.0, 90.0, 0.0, 20.0, 20.0, 0.0, 70.0, 50.0, 30.0, 20.0, 150.0, 20.0, 20.0, 20.0, 60.0, 0.0, 20.0, 0.0, 30.0, 20.0, 160.0, 30.0, 10.0, 20.0, 30.0, 0.0, 100.0, 0.0, 60.0, 455.0, 100.0, 20.0, 45.0, 30.0, 30.0, 20.0, 15.0, 40.0, 100.0, 350.0, 100.0, 10.0, 10.0, 50.0, 180.0, 0.0, 0.0, 200.0, 20.0, 40.0, 30.0, 20.0, 20.0, 10.0, 30.0, 30.0, 30.0, 160.0, 0.0, 20.0, 10.0, 260.0, 0.0, 20.0, 20.0, 10.0, 150.0, 0.0, 180.0, 0.0, 50.0, 30.0, 20.0, 0.0, 40.0, 0.0, 0.0, 80.0, 10.0, 20.0, 0.0, 30.0, 60.0, 10.0, 20.0, 60.0, 20.0, 270.0, 90.0, 15.0, 0.0, 0.0, -30.0, 10.0, 40.0, 40.0, 0.0, 40.0, 90.0, 20.0, 580.0, 30.0, 70.0, 40.0, 40.0, 10.0, 40.0, 0.0, 40.0, 30.0, 60.0, 10.0, 40.0, 70.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 20.0, 60.0, 0.0, 50.0, 10.0, 0.0, 10.0, 40.0, 30.0, 0.0, 20.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -5.0, 30.0, 40.0, 40.0, 120.0, 0.0, 210.0, 170.0, 50.0, 50.0, 30.0, 0.0, 0.0, 100.0, 170.0, 270.0, 0.0, 50.0, 10.0, 10.0, 100.0, 50.0, -20.0, 370.0, 270.0, 10.0, 180.0, 800.0, 130.0, 50.0, 20.0, 60.0, 30.0, 10.0, 80.0, 250.0, 0.0, 10.0, 50.0, 30.0, 30.0, -100.0, 190.0, 660.0, 30.0, 50.0, 90.0, 30.0, 70.0, 110.0, 370.0, 40.0, 20.0, 30.0, 0.0, 60.0, 30.0, 150.0, 10.0, 30.0, 370.0, 50.0, 130.0, -10.0, 30.0, -10.0, 0.0, 70.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 50.0, 20.0, 0.0, 20.0, 0.0, 50.0, 20.0, 0.0, 280.0, 10.0, 20.0, 0.0, 0.0, 10.0, 10.0, 50.0, 200.0, 20.0, 20.0, 70.0, 150.0, 30.0, 10.0, 180.0, 30.0, 40.0, 90.0, 0.0, 10.0, 20.0, 10.0, 10.0, 370.0, 160.0, 40.0, 70.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 0.0, 80.0, 10.0, 10.0, 10.0, 0.0, 40.0, 50.0, 10.0, 130.0, 140.0, 60.0, 100.0, 10.0, 370.0, 260.0, -5.0, 10.0, 10.0, 30.0, 50.0, 10.0, 60.0, 40.0, 30.0, 170.0, 0.0, 30.0, 160.0, 20.0, 0.0, 40.0, 50.0, 360.0, 190.0, 80.0, 20.0, 0.0, 40.0, 0.0, 30.0, 30.0, 0.0, 10.0, 30.0, 10.0, 250.0, 150.0, 0.0, 30.0, 0.0, 350.0, 0.0, 20.0, 170.0, 10.0, 0.0, 40.0, 0.0, 0.0, 10.0, 10.0, 40.0, 0.0, 20.0, 40.0, 10.0, 50.0, 600.0, -30.0, 0.0, 90.0, 10.0, 170.0, 40.0, -10.0, 20.0, 70.0, 40.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 40.0, 40.0, 10.0, 60.0, 10.0, 20.0, 20.0, 0.0, 40.0, 50.0, 20.0, 30.0, 10.0, 0.0, 20.0, 0.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 40.0, 0.0, 30.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 60.0, 30.0, 570.0, 0.0, 10.0, 50.0, 30.0, 0.0, 120.0, 40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 20.0, -10.0, -40.0, 70.0, 70.0, 60.0, 40.0, 20.0, 180.0, 20.0, 490.0, 50.0, 60.0, 60.0, 10.0, 20.0, 370.0, 150.0, 40.0, 40.0, 10.0, 0.0, 0.0, 30.0, 0.0, 20.0, 40.0, 0.0, 30.0, 0.0, 30.0, 80.0, 30.0, 60.0, 60.0, 190.0, 320.0, 40.0, 80.0, 360.0, 30.0, 50.0, 200.0, 90.0, 0.0, 70.0, 40.0, 20.0, 10.0, 0.0, 0.0, 40.0, 20.0, 70.0, 20.0, 40.0, 0.0, 10.0, 10.0, 10.0, 40.0, 20.0, 10.0, 40.0, 10.0, 40.0, 70.0, -10.0, 150.0, 80.0, 70.0, 170.0, 30.0, 10.0, 30.0, 0.0, 20.0, 30.0, 260.0, 190.0, 30.0, 70.0, 0.0, 40.0, 0.0, 0.0, 40.0, 60.0, 40.0, 0.0, 0.0, 10.0, 60.0, 10.0, 30.0, 40.0, 20.0, 40.0, 30.0, 20.0, 80.0, 40.0, 30.0, 10.0, 20.0, 70.0, 10.0, 0.0, 30.0, 0.0, 50.0, 0.0, 80.0, 20.0, 30.0, 150.0, 20.0, 200.0, 50.0, 270.0, 70.0, 0.0, 10.0, 40.0, 30.0, 20.0, 30.0, 20.0, 40.0, 50.0, 20.0, 0.0, 0.0, 260.0, 0.0, 20.0, 40.0, -10.0, 70.0, 20.0, 0.0, 10.0, 0.0, 30.0, 0.0, 40.0, 0.0, 20.0, 70.0, 10.0, 110.0, 270.0, 10.0, 290.0, -10.0, 100.0, 60.0, 10.0, 100.0, -30.0, 30.0, 0.0, 0.0, 30.0, 10.0, 20.0, 20.0, 50.0, 0.0, 30.0, 70.0, 280.0, 100.0, 130.0, 190.0, 20.0, 10.0, 20.0, 30.0, 20.0, 80.0, 90.0, 120.0, 120.0, 0.0, 30.0, 70.0, 60.0, 280.0, 370.0, 10.0, -5.0, 40.0, 210.0, 60.0, 10.0, 5.0, 650.0, -35.0, 10.0, -55.0, 120.0, 230.0, 10.0, 40.0, 390.0, 30.0, 30.0, 20.0, 20.0, 50.0, 30.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 40.0, 30.0, 40.0, 290.0, 580.0, 130.0, -90.0, 70.0, 80.0, 30.0, 0.0, 70.0, 50.0, 10.0, 20.0, 10.0, 90.0, 10.0, 280.0, 20.0, 30.0, 50.0, 40.0, 210.0, 20.0, 60.0, 80.0, 60.0, 20.0, 60.0, 30.0, 50.0, 180.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4240202134776183, "mean_inference_ms": 1.6234784755570204, "mean_action_processing_ms": 0.4201049141455772, "mean_env_wait_ms": 1.3065813053686426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05849814414978027, "StateBufferConnector_ms": 0.009190559387207031, "ViewRequirementAgentConnector_ms": 0.37985658645629883}, "num_episodes": 18, "episode_return_max": 1940.0, "episode_return_min": 70.0, "episode_return_mean": 571.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.57867203387069, "num_env_steps_trained_throughput_per_sec": 36.57867203387069, "timesteps_total": 476000, "num_env_steps_sampled_lifetime": 476000, "num_agent_steps_sampled_lifetime": 4760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4760000, "timers": {"training_iteration_time_ms": 110017.837, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110017.79, "sample_time_ms": 2380.443, "learn_time_ms": 107618.182, "learn_throughput": 37.168, "synch_weights_time_ms": 10.501}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 4760000, "num_agent_steps_trained": 4760000}, "done": false, "training_iteration": 119, "trial_id": "57140_00000", "date": "2024-06-27_02-58-36", "timestamp": 1719471516, "time_this_iter_s": 109.3645350933075, "time_total_s": 13440.979182958603, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b25c29d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13440.979182958603, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 15.550322580645162, "ram_util_percent": 77.30387096774193}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6928278730192376, "cur_kl_coeff": 23.699700619298717, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0011046471633364202, "vf_loss": 3.8585051413415212, "vf_explained_var": 0.0008205908682907478, "kl": Infinity, "entropy": 0.3761659260359181, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1122105.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000}, "env_runners": {"episode_reward_max": 1940.0, "episode_reward_min": 70.0, "episode_reward_mean": 593.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -150.0}, "policy_reward_max": {"policy_0": 980.0}, "policy_reward_mean": {"policy_0": 59.39}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1680.0, 600.0, 450.0, 580.0, 660.0, 240.0, 150.0, 690.0, 380.0, 500.0, 560.0, 730.0, 450.0, 350.0, 805.0, 750.0, 540.0, 330.0, 690.0, 200.0, 575.0, 790.0, 360.0, 210.0, 220.0, 70.0, 705.0, 640.0, 1940.0, 540.0, 1160.0, 740.0, 670.0, 110.0, 400.0, 760.0, 750.0, 180.0, 190.0, 1125.0, 410.0, 950.0, 400.0, 730.0, 170.0, 940.0, 200.0, 270.0, 170.0, 140.0, 910.0, 70.0, 900.0, 810.0, 150.0, 1250.0, 480.0, 260.0, 480.0, 770.0, 250.0, 340.0, 260.0, 890.0, 260.0, 400.0, 290.0, 830.0, 230.0, 880.0, 1150.0, 890.0, 940.0, 180.0, 1210.0, 560.0, 770.0, 1490.0, 190.0, 355.0, 160.0, 200.0, 670.0, 1890.0, 190.0, 490.0, 160.0, 1180.0, 1080.0, 940.0, 420.0, 940.0, 630.0, 380.0, 275.0, 230.0, 1180.0, 420.0, 350.0, 1310.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [60.0, 10.0, 20.0, 20.0, 790.0, 310.0, 60.0, 360.0, 10.0, 40.0, 10.0, 60.0, 80.0, 20.0, 150.0, 20.0, 10.0, 10.0, 210.0, 30.0, 80.0, 20.0, 40.0, 150.0, 10.0, 40.0, 40.0, 10.0, 40.0, 20.0, 20.0, 10.0, 50.0, 40.0, 30.0, 20.0, 130.0, 0.0, 260.0, 20.0, 60.0, 20.0, 10.0, 60.0, 60.0, 70.0, 0.0, 600.0, -70.0, -150.0, 30.0, 40.0, 0.0, 30.0, 40.0, 50.0, 10.0, 0.0, 10.0, 30.0, 0.0, 20.0, 20.0, 30.0, 0.0, 10.0, 20.0, 40.0, 10.0, 0.0, 30.0, 30.0, 70.0, 140.0, 30.0, 0.0, 20.0, 30.0, 300.0, 40.0, 90.0, 30.0, 60.0, 30.0, 20.0, 10.0, 20.0, 90.0, 20.0, 10.0, 40.0, 70.0, 30.0, 40.0, 10.0, 10.0, 10.0, 20.0, 10.0, 260.0, 30.0, 50.0, 20.0, 30.0, 10.0, 20.0, 80.0, 90.0, 150.0, 80.0, 10.0, 50.0, -50.0, 240.0, 30.0, 100.0, 0.0, 40.0, 40.0, 270.0, 90.0, 0.0, 20.0, 20.0, 0.0, 70.0, 50.0, 30.0, 20.0, 150.0, 20.0, 20.0, 20.0, 60.0, 0.0, 20.0, 0.0, 30.0, 20.0, 160.0, 30.0, 10.0, 20.0, 30.0, 0.0, 100.0, 0.0, 60.0, 455.0, 100.0, 20.0, 45.0, 30.0, 30.0, 20.0, 15.0, 40.0, 100.0, 350.0, 100.0, 10.0, 10.0, 50.0, 180.0, 0.0, 0.0, 200.0, 20.0, 40.0, 30.0, 20.0, 20.0, 10.0, 30.0, 30.0, 30.0, 160.0, 0.0, 20.0, 10.0, 260.0, 0.0, 20.0, 20.0, 10.0, 150.0, 0.0, 180.0, 0.0, 50.0, 30.0, 20.0, 0.0, 40.0, 0.0, 0.0, 80.0, 10.0, 20.0, 0.0, 30.0, 60.0, 10.0, 20.0, 60.0, 20.0, 270.0, 90.0, 15.0, 0.0, 0.0, -30.0, 10.0, 40.0, 40.0, 0.0, 40.0, 90.0, 20.0, 580.0, 30.0, 70.0, 40.0, 40.0, 10.0, 40.0, 0.0, 40.0, 30.0, 60.0, 10.0, 40.0, 70.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 20.0, 60.0, 0.0, 50.0, 10.0, 0.0, 10.0, 40.0, 30.0, 0.0, 20.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -5.0, 30.0, 40.0, 40.0, 120.0, 0.0, 210.0, 170.0, 50.0, 50.0, 30.0, 0.0, 0.0, 100.0, 170.0, 270.0, 0.0, 50.0, 10.0, 10.0, 100.0, 50.0, -20.0, 370.0, 270.0, 10.0, 180.0, 800.0, 130.0, 50.0, 20.0, 60.0, 30.0, 10.0, 80.0, 250.0, 0.0, 10.0, 50.0, 30.0, 30.0, -100.0, 190.0, 660.0, 30.0, 50.0, 90.0, 30.0, 70.0, 110.0, 370.0, 40.0, 20.0, 30.0, 0.0, 60.0, 30.0, 150.0, 10.0, 30.0, 370.0, 50.0, 130.0, -10.0, 30.0, -10.0, 0.0, 70.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 50.0, 20.0, 0.0, 20.0, 0.0, 50.0, 20.0, 0.0, 280.0, 10.0, 20.0, 0.0, 0.0, 10.0, 10.0, 50.0, 200.0, 20.0, 20.0, 70.0, 150.0, 30.0, 10.0, 180.0, 30.0, 40.0, 90.0, 0.0, 10.0, 20.0, 10.0, 10.0, 370.0, 160.0, 40.0, 70.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 0.0, 80.0, 10.0, 10.0, 10.0, 0.0, 40.0, 50.0, 10.0, 130.0, 140.0, 60.0, 100.0, 10.0, 370.0, 260.0, -5.0, 10.0, 10.0, 30.0, 50.0, 10.0, 60.0, 40.0, 30.0, 170.0, 0.0, 30.0, 160.0, 20.0, 0.0, 40.0, 50.0, 360.0, 190.0, 80.0, 20.0, 0.0, 40.0, 0.0, 30.0, 30.0, 0.0, 10.0, 30.0, 10.0, 250.0, 150.0, 0.0, 30.0, 0.0, 350.0, 0.0, 20.0, 170.0, 10.0, 0.0, 40.0, 0.0, 0.0, 10.0, 10.0, 40.0, 0.0, 20.0, 40.0, 10.0, 50.0, 600.0, -30.0, 0.0, 90.0, 10.0, 170.0, 40.0, -10.0, 20.0, 70.0, 40.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 40.0, 40.0, 10.0, 60.0, 10.0, 20.0, 20.0, 0.0, 40.0, 50.0, 20.0, 30.0, 10.0, 0.0, 20.0, 0.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 40.0, 0.0, 30.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 60.0, 30.0, 570.0, 0.0, 10.0, 50.0, 30.0, 0.0, 120.0, 40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 20.0, -10.0, -40.0, 70.0, 70.0, 60.0, 40.0, 20.0, 180.0, 20.0, 490.0, 50.0, 60.0, 60.0, 10.0, 20.0, 370.0, 150.0, 40.0, 40.0, 10.0, 0.0, 0.0, 30.0, 0.0, 20.0, 40.0, 0.0, 30.0, 0.0, 30.0, 80.0, 30.0, 60.0, 60.0, 190.0, 320.0, 40.0, 80.0, 360.0, 30.0, 50.0, 200.0, 90.0, 0.0, 70.0, 40.0, 20.0, 10.0, 0.0, 0.0, 40.0, 20.0, 70.0, 20.0, 40.0, 0.0, 10.0, 10.0, 10.0, 40.0, 20.0, 10.0, 40.0, 10.0, 40.0, 70.0, -10.0, 150.0, 80.0, 70.0, 170.0, 30.0, 10.0, 30.0, 0.0, 20.0, 30.0, 260.0, 190.0, 30.0, 70.0, 0.0, 40.0, 0.0, 0.0, 40.0, 60.0, 40.0, 0.0, 0.0, 10.0, 60.0, 10.0, 30.0, 40.0, 20.0, 40.0, 30.0, 20.0, 80.0, 40.0, 30.0, 10.0, 20.0, 70.0, 10.0, 0.0, 30.0, 0.0, 50.0, 0.0, 80.0, 20.0, 30.0, 150.0, 20.0, 200.0, 50.0, 270.0, 70.0, 0.0, 10.0, 40.0, 30.0, 20.0, 30.0, 20.0, 40.0, 50.0, 20.0, 0.0, 0.0, 260.0, 0.0, 20.0, 40.0, -10.0, 70.0, 20.0, 0.0, 10.0, 0.0, 30.0, 0.0, 40.0, 0.0, 20.0, 70.0, 10.0, 110.0, 270.0, 10.0, 290.0, -10.0, 100.0, 60.0, 10.0, 100.0, -30.0, 30.0, 0.0, 0.0, 30.0, 10.0, 20.0, 20.0, 50.0, 0.0, 30.0, 70.0, 280.0, 100.0, 130.0, 190.0, 20.0, 10.0, 20.0, 30.0, 20.0, 80.0, 90.0, 120.0, 120.0, 0.0, 30.0, 70.0, 60.0, 280.0, 370.0, 10.0, -5.0, 40.0, 210.0, 60.0, 10.0, 5.0, 650.0, -35.0, 10.0, -55.0, 120.0, 230.0, 10.0, 40.0, 390.0, 30.0, 30.0, 20.0, 20.0, 50.0, 30.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 40.0, 30.0, 40.0, 290.0, 580.0, 130.0, -90.0, 70.0, 80.0, 30.0, 0.0, 70.0, 50.0, 10.0, 20.0, 10.0, 90.0, 10.0, 280.0, 20.0, 30.0, 50.0, 40.0, 210.0, 20.0, 60.0, 80.0, 60.0, 20.0, 60.0, 30.0, 50.0, 180.0, 30.0, 980.0, 250.0, 30.0, 10.0, 90.0, 20.0, 60.0, 60.0, -40.0, 10.0, 50.0, 0.0, 20.0, 0.0, 20.0, 30.0, 30.0, 30.0, 0.0, 15.0, 40.0, 20.0, 0.0, 20.0, 0.0, 0.0, 70.0, 30.0, 160.0, 20.0, 40.0, 10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 30.0, 30.0, 10.0, 0.0, 80.0, 20.0, 20.0, 20.0, 0.0, 20.0, 0.0, 0.0, 20.0, 90.0, 20.0, 10.0, 390.0, 50.0, 40.0, 0.0, 50.0, 310.0, 60.0, -10.0, 40.0, 150.0, 20.0, 580.0, 50.0, 40.0, 650.0, 0.0, 100.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 30.0, 40.0, 50.0, 20.0, 10.0, 40.0, 0.0, 210.0, 30.0, 40.0, 50.0, 10.0, 10.0, 30.0, 10.0, 0.0, 20.0, 20.0, 10.0, 20.0, 30.0, 50.0, 200.0, 220.0, 290.0, 20.0, 120.0, 10.0, 160.0, 80.0, 30.0, 130.0, 490.0, 50.0, 40.0, 150.0, 20.0, 0.0, 70.0, 40.0, 90.0, 290.0, 80.0, 20.0, 30.0, 40.0, 20.0, 0.0, 90.0, 350.0, 20.0, 10.0, 80.0, 160.0, 20.0, 20.0, 40.0, 40.0, 10.0, 0.0, 40.0, 270.0, 60.0, 100.0, 10.0, 30.0, 10.0, 60.0, 90.0, 280.0, 30.0, 0.0, 380.0, 120.0, 10.0, 20.0, 20.0, 30.0, 40.0, 10.0, 0.0, 40.0, 20.0, 30.0, 0.0, 10.0, 170.0, 30.0, 40.0, 20.0, 20.0, 40.0, -5.0, 0.0, 10.0, 150.0, 0.0, 10.0, 30.0, 20.0, 20.0, 30.0, 40.0, 30.0, 0.0, 10.0, 20.0, 10.0, 0.0, 30.0, 60.0, 20.0, 30.0, 30.0, 30.0, 170.0, 30.0, 160.0, 90.0, 40.0, 580.0, 60.0, 10.0, 0.0, 70.0, 0.0, 30.0, 0.0, 150.0, 60.0, 40.0, 0.0, 20.0, 170.0, 10.0, 10.0, 10.0, 40.0, 30.0, 60.0, 0.0, 20.0, 790.0, 30.0, 60.0, 40.0, 180.0, 20.0, 20.0, 50.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.423125005109269, "mean_inference_ms": 1.6224597782499937, "mean_action_processing_ms": 0.4198184577964122, "mean_env_wait_ms": 1.305809894457715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058011531829833984, "StateBufferConnector_ms": 0.009268045425415039, "ViewRequirementAgentConnector_ms": 0.3914058208465576}, "num_episodes": 23, "episode_return_max": 1940.0, "episode_return_min": 70.0, "episode_return_mean": 593.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.35881093911382, "num_env_steps_trained_throughput_per_sec": 36.35881093911382, "timesteps_total": 480000, "num_env_steps_sampled_lifetime": 480000, "num_agent_steps_sampled_lifetime": 4800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4800000, "timers": {"training_iteration_time_ms": 110004.995, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110004.947, "sample_time_ms": 2377.566, "learn_time_ms": 107608.342, "learn_throughput": 37.172, "synch_weights_time_ms": 10.63}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 4800000, "num_agent_steps_trained": 4800000}, "done": false, "training_iteration": 120, "trial_id": "57140_00000", "date": "2024-06-27_03-00-26", "timestamp": 1719471626, "time_this_iter_s": 110.02519607543945, "time_total_s": 13551.004379034042, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b25c8ee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13551.004379034042, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 16.499358974358977, "ram_util_percent": 77.02307692307691}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.365523174966867, "cur_kl_coeff": 35.54955092894808, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.137030855814616, "policy_loss": -0.0009968512093239683, "vf_loss": 4.135576909951889, "vf_explained_var": 0.00030795432889042573, "kl": 6.894018501702462e-05, "entropy": 0.3844700048208491, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1131495.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000}, "env_runners": {"episode_reward_max": 1940.0, "episode_reward_min": 70.0, "episode_reward_mean": 592.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -100.0}, "policy_reward_max": {"policy_0": 980.0}, "policy_reward_mean": {"policy_0": 59.265}, "custom_metrics": {}, "hist_stats": {"episode_reward": [690.0, 200.0, 575.0, 790.0, 360.0, 210.0, 220.0, 70.0, 705.0, 640.0, 1940.0, 540.0, 1160.0, 740.0, 670.0, 110.0, 400.0, 760.0, 750.0, 180.0, 190.0, 1125.0, 410.0, 950.0, 400.0, 730.0, 170.0, 940.0, 200.0, 270.0, 170.0, 140.0, 910.0, 70.0, 900.0, 810.0, 150.0, 1250.0, 480.0, 260.0, 480.0, 770.0, 250.0, 340.0, 260.0, 890.0, 260.0, 400.0, 290.0, 830.0, 230.0, 880.0, 1150.0, 890.0, 940.0, 180.0, 1210.0, 560.0, 770.0, 1490.0, 190.0, 355.0, 160.0, 200.0, 670.0, 1890.0, 190.0, 490.0, 160.0, 1180.0, 1080.0, 940.0, 420.0, 940.0, 630.0, 380.0, 275.0, 230.0, 1180.0, 420.0, 350.0, 1310.0, 660.0, 160.0, 310.0, 780.0, 430.0, 1390.0, 700.0, 560.0, 1120.0, 370.0, 610.0, 770.0, 430.0, 345.0, 515.0, 500.0, 170.0, 500.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [260.0, 0.0, 20.0, 20.0, 10.0, 150.0, 0.0, 180.0, 0.0, 50.0, 30.0, 20.0, 0.0, 40.0, 0.0, 0.0, 80.0, 10.0, 20.0, 0.0, 30.0, 60.0, 10.0, 20.0, 60.0, 20.0, 270.0, 90.0, 15.0, 0.0, 0.0, -30.0, 10.0, 40.0, 40.0, 0.0, 40.0, 90.0, 20.0, 580.0, 30.0, 70.0, 40.0, 40.0, 10.0, 40.0, 0.0, 40.0, 30.0, 60.0, 10.0, 40.0, 70.0, 40.0, 0.0, 10.0, 0.0, 20.0, 0.0, 20.0, 0.0, 20.0, 60.0, 0.0, 50.0, 10.0, 0.0, 10.0, 40.0, 30.0, 0.0, 20.0, 20.0, 10.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, -5.0, 30.0, 40.0, 40.0, 120.0, 0.0, 210.0, 170.0, 50.0, 50.0, 30.0, 0.0, 0.0, 100.0, 170.0, 270.0, 0.0, 50.0, 10.0, 10.0, 100.0, 50.0, -20.0, 370.0, 270.0, 10.0, 180.0, 800.0, 130.0, 50.0, 20.0, 60.0, 30.0, 10.0, 80.0, 250.0, 0.0, 10.0, 50.0, 30.0, 30.0, -100.0, 190.0, 660.0, 30.0, 50.0, 90.0, 30.0, 70.0, 110.0, 370.0, 40.0, 20.0, 30.0, 0.0, 60.0, 30.0, 150.0, 10.0, 30.0, 370.0, 50.0, 130.0, -10.0, 30.0, -10.0, 0.0, 70.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 20.0, 50.0, 20.0, 0.0, 20.0, 0.0, 50.0, 20.0, 0.0, 280.0, 10.0, 20.0, 0.0, 0.0, 10.0, 10.0, 50.0, 200.0, 20.0, 20.0, 70.0, 150.0, 30.0, 10.0, 180.0, 30.0, 40.0, 90.0, 0.0, 10.0, 20.0, 10.0, 10.0, 370.0, 160.0, 40.0, 70.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 10.0, 20.0, 20.0, 10.0, 20.0, 10.0, 0.0, 80.0, 10.0, 10.0, 10.0, 0.0, 40.0, 50.0, 10.0, 130.0, 140.0, 60.0, 100.0, 10.0, 370.0, 260.0, -5.0, 10.0, 10.0, 30.0, 50.0, 10.0, 60.0, 40.0, 30.0, 170.0, 0.0, 30.0, 160.0, 20.0, 0.0, 40.0, 50.0, 360.0, 190.0, 80.0, 20.0, 0.0, 40.0, 0.0, 30.0, 30.0, 0.0, 10.0, 30.0, 10.0, 250.0, 150.0, 0.0, 30.0, 0.0, 350.0, 0.0, 20.0, 170.0, 10.0, 0.0, 40.0, 0.0, 0.0, 10.0, 10.0, 40.0, 0.0, 20.0, 40.0, 10.0, 50.0, 600.0, -30.0, 0.0, 90.0, 10.0, 170.0, 40.0, -10.0, 20.0, 70.0, 40.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 40.0, 40.0, 10.0, 60.0, 10.0, 20.0, 20.0, 0.0, 40.0, 50.0, 20.0, 30.0, 10.0, 0.0, 20.0, 0.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 40.0, 0.0, 30.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 60.0, 30.0, 570.0, 0.0, 10.0, 50.0, 30.0, 0.0, 120.0, 40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 20.0, -10.0, -40.0, 70.0, 70.0, 60.0, 40.0, 20.0, 180.0, 20.0, 490.0, 50.0, 60.0, 60.0, 10.0, 20.0, 370.0, 150.0, 40.0, 40.0, 10.0, 0.0, 0.0, 30.0, 0.0, 20.0, 40.0, 0.0, 30.0, 0.0, 30.0, 80.0, 30.0, 60.0, 60.0, 190.0, 320.0, 40.0, 80.0, 360.0, 30.0, 50.0, 200.0, 90.0, 0.0, 70.0, 40.0, 20.0, 10.0, 0.0, 0.0, 40.0, 20.0, 70.0, 20.0, 40.0, 0.0, 10.0, 10.0, 10.0, 40.0, 20.0, 10.0, 40.0, 10.0, 40.0, 70.0, -10.0, 150.0, 80.0, 70.0, 170.0, 30.0, 10.0, 30.0, 0.0, 20.0, 30.0, 260.0, 190.0, 30.0, 70.0, 0.0, 40.0, 0.0, 0.0, 40.0, 60.0, 40.0, 0.0, 0.0, 10.0, 60.0, 10.0, 30.0, 40.0, 20.0, 40.0, 30.0, 20.0, 80.0, 40.0, 30.0, 10.0, 20.0, 70.0, 10.0, 0.0, 30.0, 0.0, 50.0, 0.0, 80.0, 20.0, 30.0, 150.0, 20.0, 200.0, 50.0, 270.0, 70.0, 0.0, 10.0, 40.0, 30.0, 20.0, 30.0, 20.0, 40.0, 50.0, 20.0, 0.0, 0.0, 260.0, 0.0, 20.0, 40.0, -10.0, 70.0, 20.0, 0.0, 10.0, 0.0, 30.0, 0.0, 40.0, 0.0, 20.0, 70.0, 10.0, 110.0, 270.0, 10.0, 290.0, -10.0, 100.0, 60.0, 10.0, 100.0, -30.0, 30.0, 0.0, 0.0, 30.0, 10.0, 20.0, 20.0, 50.0, 0.0, 30.0, 70.0, 280.0, 100.0, 130.0, 190.0, 20.0, 10.0, 20.0, 30.0, 20.0, 80.0, 90.0, 120.0, 120.0, 0.0, 30.0, 70.0, 60.0, 280.0, 370.0, 10.0, -5.0, 40.0, 210.0, 60.0, 10.0, 5.0, 650.0, -35.0, 10.0, -55.0, 120.0, 230.0, 10.0, 40.0, 390.0, 30.0, 30.0, 20.0, 20.0, 50.0, 30.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 40.0, 30.0, 40.0, 290.0, 580.0, 130.0, -90.0, 70.0, 80.0, 30.0, 0.0, 70.0, 50.0, 10.0, 20.0, 10.0, 90.0, 10.0, 280.0, 20.0, 30.0, 50.0, 40.0, 210.0, 20.0, 60.0, 80.0, 60.0, 20.0, 60.0, 30.0, 50.0, 180.0, 30.0, 980.0, 250.0, 30.0, 10.0, 90.0, 20.0, 60.0, 60.0, -40.0, 10.0, 50.0, 0.0, 20.0, 0.0, 20.0, 30.0, 30.0, 30.0, 0.0, 15.0, 40.0, 20.0, 0.0, 20.0, 0.0, 0.0, 70.0, 30.0, 160.0, 20.0, 40.0, 10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 30.0, 30.0, 10.0, 0.0, 80.0, 20.0, 20.0, 20.0, 0.0, 20.0, 0.0, 0.0, 20.0, 90.0, 20.0, 10.0, 390.0, 50.0, 40.0, 0.0, 50.0, 310.0, 60.0, -10.0, 40.0, 150.0, 20.0, 580.0, 50.0, 40.0, 650.0, 0.0, 100.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 30.0, 40.0, 50.0, 20.0, 10.0, 40.0, 0.0, 210.0, 30.0, 40.0, 50.0, 10.0, 10.0, 30.0, 10.0, 0.0, 20.0, 20.0, 10.0, 20.0, 30.0, 50.0, 200.0, 220.0, 290.0, 20.0, 120.0, 10.0, 160.0, 80.0, 30.0, 130.0, 490.0, 50.0, 40.0, 150.0, 20.0, 0.0, 70.0, 40.0, 90.0, 290.0, 80.0, 20.0, 30.0, 40.0, 20.0, 0.0, 90.0, 350.0, 20.0, 10.0, 80.0, 160.0, 20.0, 20.0, 40.0, 40.0, 10.0, 0.0, 40.0, 270.0, 60.0, 100.0, 10.0, 30.0, 10.0, 60.0, 90.0, 280.0, 30.0, 0.0, 380.0, 120.0, 10.0, 20.0, 20.0, 30.0, 40.0, 10.0, 0.0, 40.0, 20.0, 30.0, 0.0, 10.0, 170.0, 30.0, 40.0, 20.0, 20.0, 40.0, -5.0, 0.0, 10.0, 150.0, 0.0, 10.0, 30.0, 20.0, 20.0, 30.0, 40.0, 30.0, 0.0, 10.0, 20.0, 10.0, 0.0, 30.0, 60.0, 20.0, 30.0, 30.0, 30.0, 170.0, 30.0, 160.0, 90.0, 40.0, 580.0, 60.0, 10.0, 0.0, 70.0, 0.0, 30.0, 0.0, 150.0, 60.0, 40.0, 0.0, 20.0, 170.0, 10.0, 10.0, 10.0, 40.0, 30.0, 60.0, 0.0, 20.0, 790.0, 30.0, 60.0, 40.0, 180.0, 20.0, 20.0, 50.0, 100.0, 200.0, 20.0, 30.0, 60.0, 30.0, 20.0, 60.0, 70.0, 150.0, 20.0, 0.0, 0.0, 0.0, 40.0, 0.0, 30.0, 30.0, 40.0, 0.0, 20.0, 10.0, 40.0, 20.0, 100.0, 10.0, 10.0, 0.0, 40.0, 0.0, 80.0, 80.0, 10.0, 30.0, 190.0, 0.0, 10.0, 100.0, 170.0, 170.0, 20.0, 20.0, 20.0, 40.0, 10.0, 10.0, 260.0, 10.0, 20.0, 40.0, 0.0, 920.0, 180.0, 20.0, 50.0, 80.0, 20.0, 30.0, -40.0, 70.0, 60.0, 30.0, 0.0, 20.0, 0.0, 70.0, 140.0, 20.0, 70.0, 170.0, 180.0, 10.0, -10.0, 350.0, 110.0, 20.0, 0.0, 0.0, 20.0, 30.0, 30.0, 20.0, 80.0, 70.0, 60.0, 20.0, 150.0, 370.0, 60.0, 30.0, 260.0, 30.0, 20.0, 0.0, 130.0, 90.0, 10.0, 60.0, 0.0, 10.0, 20.0, 60.0, 10.0, 90.0, 10.0, 40.0, 0.0, 0.0, 80.0, 20.0, 300.0, 460.0, 10.0, 20.0, 30.0, 20.0, 40.0, 20.0, 150.0, 20.0, 0.0, 50.0, 30.0, 0.0, 50.0, 40.0, 30.0, 70.0, 30.0, 20.0, 110.0, 0.0, 20.0, 30.0, -10.0, 40.0, 40.0, 10.0, 260.0, 0.0, -45.0, 350.0, 20.0, 10.0, 70.0, 20.0, -5.0, 30.0, 40.0, 20.0, -40.0, 0.0, 10.0, 10.0, 30.0, 0.0, 10.0, 230.0, 170.0, 20.0, 20.0, 10.0, 10.0, 30.0, 10.0, 20.0, 0.0, 20.0, 0.0, 30.0, 40.0, 20.0, 10.0, 40.0, 10.0, 270.0, 40.0, 50.0, 20.0, 20.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.422482339378548, "mean_inference_ms": 1.6217356419215536, "mean_action_processing_ms": 0.41959823041604666, "mean_env_wait_ms": 1.3052061758884974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05856895446777344, "StateBufferConnector_ms": 0.009337663650512695, "ViewRequirementAgentConnector_ms": 0.3970625400543213}, "num_episodes": 18, "episode_return_max": 1940.0, "episode_return_min": 70.0, "episode_return_mean": 592.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.419604693670955, "num_env_steps_trained_throughput_per_sec": 36.419604693670955, "timesteps_total": 484000, "num_env_steps_sampled_lifetime": 484000, "num_agent_steps_sampled_lifetime": 4840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4840000, "timers": {"training_iteration_time_ms": 109973.873, "restore_workers_time_ms": 0.011, "training_step_time_ms": 109973.825, "sample_time_ms": 2368.89, "learn_time_ms": 107585.653, "learn_throughput": 37.18, "synch_weights_time_ms": 11.003}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 4840000, "num_agent_steps_trained": 4840000}, "done": false, "training_iteration": 121, "trial_id": "57140_00000", "date": "2024-06-27_03-02-16", "timestamp": 1719471736, "time_this_iter_s": 109.84422993659973, "time_total_s": 13660.848608970642, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23fd430>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13660.848608970642, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 23.679354838709678, "ram_util_percent": 77.75290322580646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.9515620912543246, "cur_kl_coeff": 17.77477546447404, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.561198715889415, "policy_loss": -0.001600067624281715, "vf_loss": 4.560746765517579, "vf_explained_var": 0.00031329873905649075, "kl": 0.00011544511118149953, "entropy": 0.3667537208499746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1140885.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000}, "env_runners": {"episode_reward_max": 1890.0, "episode_reward_min": 70.0, "episode_reward_mean": 615.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -90.0}, "policy_reward_max": {"policy_0": 980.0}, "policy_reward_mean": {"policy_0": 61.545}, "custom_metrics": {}, "hist_stats": {"episode_reward": [410.0, 950.0, 400.0, 730.0, 170.0, 940.0, 200.0, 270.0, 170.0, 140.0, 910.0, 70.0, 900.0, 810.0, 150.0, 1250.0, 480.0, 260.0, 480.0, 770.0, 250.0, 340.0, 260.0, 890.0, 260.0, 400.0, 290.0, 830.0, 230.0, 880.0, 1150.0, 890.0, 940.0, 180.0, 1210.0, 560.0, 770.0, 1490.0, 190.0, 355.0, 160.0, 200.0, 670.0, 1890.0, 190.0, 490.0, 160.0, 1180.0, 1080.0, 940.0, 420.0, 940.0, 630.0, 380.0, 275.0, 230.0, 1180.0, 420.0, 350.0, 1310.0, 660.0, 160.0, 310.0, 780.0, 430.0, 1390.0, 700.0, 560.0, 1120.0, 370.0, 610.0, 770.0, 430.0, 345.0, 515.0, 500.0, 170.0, 500.0, 130.0, 940.0, 400.0, 800.0, 400.0, 1490.0, 960.0, 380.0, 820.0, 925.0, 800.0, 580.0, 770.0, 540.0, 710.0, 340.0, 710.0, 580.0, 680.0, 680.0, 720.0, 950.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 10.0, 30.0, 50.0, 10.0, 60.0, 40.0, 30.0, 170.0, 0.0, 30.0, 160.0, 20.0, 0.0, 40.0, 50.0, 360.0, 190.0, 80.0, 20.0, 0.0, 40.0, 0.0, 30.0, 30.0, 0.0, 10.0, 30.0, 10.0, 250.0, 150.0, 0.0, 30.0, 0.0, 350.0, 0.0, 20.0, 170.0, 10.0, 0.0, 40.0, 0.0, 0.0, 10.0, 10.0, 40.0, 0.0, 20.0, 40.0, 10.0, 50.0, 600.0, -30.0, 0.0, 90.0, 10.0, 170.0, 40.0, -10.0, 20.0, 70.0, 40.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 40.0, 40.0, 10.0, 60.0, 10.0, 20.0, 20.0, 0.0, 40.0, 50.0, 20.0, 30.0, 10.0, 0.0, 20.0, 0.0, 20.0, 20.0, 20.0, 30.0, 20.0, 20.0, 40.0, 0.0, 30.0, 20.0, 10.0, 0.0, 10.0, 10.0, 0.0, 60.0, 30.0, 570.0, 0.0, 10.0, 50.0, 30.0, 0.0, 120.0, 40.0, 0.0, 10.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 10.0, 20.0, -10.0, -40.0, 70.0, 70.0, 60.0, 40.0, 20.0, 180.0, 20.0, 490.0, 50.0, 60.0, 60.0, 10.0, 20.0, 370.0, 150.0, 40.0, 40.0, 10.0, 0.0, 0.0, 30.0, 0.0, 20.0, 40.0, 0.0, 30.0, 0.0, 30.0, 80.0, 30.0, 60.0, 60.0, 190.0, 320.0, 40.0, 80.0, 360.0, 30.0, 50.0, 200.0, 90.0, 0.0, 70.0, 40.0, 20.0, 10.0, 0.0, 0.0, 40.0, 20.0, 70.0, 20.0, 40.0, 0.0, 10.0, 10.0, 10.0, 40.0, 20.0, 10.0, 40.0, 10.0, 40.0, 70.0, -10.0, 150.0, 80.0, 70.0, 170.0, 30.0, 10.0, 30.0, 0.0, 20.0, 30.0, 260.0, 190.0, 30.0, 70.0, 0.0, 40.0, 0.0, 0.0, 40.0, 60.0, 40.0, 0.0, 0.0, 10.0, 60.0, 10.0, 30.0, 40.0, 20.0, 40.0, 30.0, 20.0, 80.0, 40.0, 30.0, 10.0, 20.0, 70.0, 10.0, 0.0, 30.0, 0.0, 50.0, 0.0, 80.0, 20.0, 30.0, 150.0, 20.0, 200.0, 50.0, 270.0, 70.0, 0.0, 10.0, 40.0, 30.0, 20.0, 30.0, 20.0, 40.0, 50.0, 20.0, 0.0, 0.0, 260.0, 0.0, 20.0, 40.0, -10.0, 70.0, 20.0, 0.0, 10.0, 0.0, 30.0, 0.0, 40.0, 0.0, 20.0, 70.0, 10.0, 110.0, 270.0, 10.0, 290.0, -10.0, 100.0, 60.0, 10.0, 100.0, -30.0, 30.0, 0.0, 0.0, 30.0, 10.0, 20.0, 20.0, 50.0, 0.0, 30.0, 70.0, 280.0, 100.0, 130.0, 190.0, 20.0, 10.0, 20.0, 30.0, 20.0, 80.0, 90.0, 120.0, 120.0, 0.0, 30.0, 70.0, 60.0, 280.0, 370.0, 10.0, -5.0, 40.0, 210.0, 60.0, 10.0, 5.0, 650.0, -35.0, 10.0, -55.0, 120.0, 230.0, 10.0, 40.0, 390.0, 30.0, 30.0, 20.0, 20.0, 50.0, 30.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 40.0, 30.0, 40.0, 290.0, 580.0, 130.0, -90.0, 70.0, 80.0, 30.0, 0.0, 70.0, 50.0, 10.0, 20.0, 10.0, 90.0, 10.0, 280.0, 20.0, 30.0, 50.0, 40.0, 210.0, 20.0, 60.0, 80.0, 60.0, 20.0, 60.0, 30.0, 50.0, 180.0, 30.0, 980.0, 250.0, 30.0, 10.0, 90.0, 20.0, 60.0, 60.0, -40.0, 10.0, 50.0, 0.0, 20.0, 0.0, 20.0, 30.0, 30.0, 30.0, 0.0, 15.0, 40.0, 20.0, 0.0, 20.0, 0.0, 0.0, 70.0, 30.0, 160.0, 20.0, 40.0, 10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 30.0, 30.0, 10.0, 0.0, 80.0, 20.0, 20.0, 20.0, 0.0, 20.0, 0.0, 0.0, 20.0, 90.0, 20.0, 10.0, 390.0, 50.0, 40.0, 0.0, 50.0, 310.0, 60.0, -10.0, 40.0, 150.0, 20.0, 580.0, 50.0, 40.0, 650.0, 0.0, 100.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 30.0, 40.0, 50.0, 20.0, 10.0, 40.0, 0.0, 210.0, 30.0, 40.0, 50.0, 10.0, 10.0, 30.0, 10.0, 0.0, 20.0, 20.0, 10.0, 20.0, 30.0, 50.0, 200.0, 220.0, 290.0, 20.0, 120.0, 10.0, 160.0, 80.0, 30.0, 130.0, 490.0, 50.0, 40.0, 150.0, 20.0, 0.0, 70.0, 40.0, 90.0, 290.0, 80.0, 20.0, 30.0, 40.0, 20.0, 0.0, 90.0, 350.0, 20.0, 10.0, 80.0, 160.0, 20.0, 20.0, 40.0, 40.0, 10.0, 0.0, 40.0, 270.0, 60.0, 100.0, 10.0, 30.0, 10.0, 60.0, 90.0, 280.0, 30.0, 0.0, 380.0, 120.0, 10.0, 20.0, 20.0, 30.0, 40.0, 10.0, 0.0, 40.0, 20.0, 30.0, 0.0, 10.0, 170.0, 30.0, 40.0, 20.0, 20.0, 40.0, -5.0, 0.0, 10.0, 150.0, 0.0, 10.0, 30.0, 20.0, 20.0, 30.0, 40.0, 30.0, 0.0, 10.0, 20.0, 10.0, 0.0, 30.0, 60.0, 20.0, 30.0, 30.0, 30.0, 170.0, 30.0, 160.0, 90.0, 40.0, 580.0, 60.0, 10.0, 0.0, 70.0, 0.0, 30.0, 0.0, 150.0, 60.0, 40.0, 0.0, 20.0, 170.0, 10.0, 10.0, 10.0, 40.0, 30.0, 60.0, 0.0, 20.0, 790.0, 30.0, 60.0, 40.0, 180.0, 20.0, 20.0, 50.0, 100.0, 200.0, 20.0, 30.0, 60.0, 30.0, 20.0, 60.0, 70.0, 150.0, 20.0, 0.0, 0.0, 0.0, 40.0, 0.0, 30.0, 30.0, 40.0, 0.0, 20.0, 10.0, 40.0, 20.0, 100.0, 10.0, 10.0, 0.0, 40.0, 0.0, 80.0, 80.0, 10.0, 30.0, 190.0, 0.0, 10.0, 100.0, 170.0, 170.0, 20.0, 20.0, 20.0, 40.0, 10.0, 10.0, 260.0, 10.0, 20.0, 40.0, 0.0, 920.0, 180.0, 20.0, 50.0, 80.0, 20.0, 30.0, -40.0, 70.0, 60.0, 30.0, 0.0, 20.0, 0.0, 70.0, 140.0, 20.0, 70.0, 170.0, 180.0, 10.0, -10.0, 350.0, 110.0, 20.0, 0.0, 0.0, 20.0, 30.0, 30.0, 20.0, 80.0, 70.0, 60.0, 20.0, 150.0, 370.0, 60.0, 30.0, 260.0, 30.0, 20.0, 0.0, 130.0, 90.0, 10.0, 60.0, 0.0, 10.0, 20.0, 60.0, 10.0, 90.0, 10.0, 40.0, 0.0, 0.0, 80.0, 20.0, 300.0, 460.0, 10.0, 20.0, 30.0, 20.0, 40.0, 20.0, 150.0, 20.0, 0.0, 50.0, 30.0, 0.0, 50.0, 40.0, 30.0, 70.0, 30.0, 20.0, 110.0, 0.0, 20.0, 30.0, -10.0, 40.0, 40.0, 10.0, 260.0, 0.0, -45.0, 350.0, 20.0, 10.0, 70.0, 20.0, -5.0, 30.0, 40.0, 20.0, -40.0, 0.0, 10.0, 10.0, 30.0, 0.0, 10.0, 230.0, 170.0, 20.0, 20.0, 10.0, 10.0, 30.0, 10.0, 20.0, 0.0, 20.0, 0.0, 30.0, 40.0, 20.0, 10.0, 40.0, 10.0, 270.0, 40.0, 50.0, 20.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 60.0, 40.0, 0.0, 10.0, 80.0, 20.0, 20.0, 0.0, 70.0, 310.0, 40.0, 90.0, 30.0, 280.0, 30.0, 40.0, 20.0, 10.0, 90.0, 70.0, 20.0, 60.0, 20.0, 40.0, 380.0, 20.0, 100.0, 50.0, 0.0, 10.0, 80.0, 40.0, 40.0, 80.0, 0.0, 20.0, 30.0, 0.0, 50.0, 10.0, 10.0, 250.0, 10.0, 20.0, 30.0, 40.0, 560.0, 0.0, 30.0, 70.0, 190.0, 20.0, 70.0, 480.0, 30.0, 0.0, 30.0, 0.0, 60.0, 10.0, 710.0, 30.0, 70.0, 20.0, 30.0, 160.0, 50.0, 30.0, 0.0, 0.0, 40.0, 50.0, 20.0, 0.0, 20.0, 300.0, 40.0, 40.0, 160.0, 170.0, 60.0, 20.0, 0.0, 10.0, 0.0, 20.0, 0.0, 160.0, 50.0, 0.0, 70.0, -5.0, 50.0, 580.0, 60.0, 380.0, 40.0, 0.0, 70.0, 40.0, 120.0, 40.0, 30.0, 20.0, 190.0, 70.0, 90.0, 30.0, 20.0, 40.0, 60.0, 30.0, 0.0, 50.0, 90.0, 70.0, 70.0, 0.0, 40.0, 180.0, 250.0, 30.0, 0.0, 40.0, 60.0, 130.0, 10.0, 170.0, 60.0, 40.0, 0.0, 20.0, 50.0, 0.0, 470.0, 0.0, 0.0, -50.0, 60.0, 50.0, 140.0, 40.0, 30.0, -30.0, 0.0, 40.0, 0.0, 40.0, 60.0, 130.0, 0.0, 10.0, 60.0, 0.0, 70.0, 40.0, 40.0, 20.0, 300.0, 20.0, 30.0, 110.0, 80.0, 0.0, 190.0, 40.0, 0.0, 40.0, 60.0, 10.0, 0.0, 0.0, 70.0, 170.0, 80.0, 20.0, 90.0, 120.0, 290.0, 40.0, -50.0, 10.0, 40.0, 40.0, 30.0, 10.0, 10.0, 20.0, 560.0, 60.0, 30.0, -85.0, 70.0, -25.0, 250.0, 250.0, -10.0, 40.0, 20.0, 20.0, 0.0, 40.0, 40.0, 70.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 30.0, 40.0, 40.0, 760.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4214115843397042, "mean_inference_ms": 1.6208454987271887, "mean_action_processing_ms": 0.41931863628979243, "mean_env_wait_ms": 1.3044422365230142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.054718732833862305, "StateBufferConnector_ms": 0.009312152862548828, "ViewRequirementAgentConnector_ms": 0.3866922855377197}, "num_episodes": 22, "episode_return_max": 1890.0, "episode_return_min": 70.0, "episode_return_mean": 615.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.25309052429257, "num_env_steps_trained_throughput_per_sec": 36.25309052429257, "timesteps_total": 488000, "num_env_steps_sampled_lifetime": 488000, "num_agent_steps_sampled_lifetime": 4880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4880000, "timers": {"training_iteration_time_ms": 109971.968, "restore_workers_time_ms": 0.011, "training_step_time_ms": 109971.919, "sample_time_ms": 2379.151, "learn_time_ms": 107573.216, "learn_throughput": 37.184, "synch_weights_time_ms": 11.211}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 4880000, "num_agent_steps_trained": 4880000}, "done": false, "training_iteration": 122, "trial_id": "57140_00000", "date": "2024-06-27_03-04-06", "timestamp": 1719471846, "time_this_iter_s": 110.3479278087616, "time_total_s": 13771.196536779404, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b25c84c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13771.196536779404, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 20.703205128205127, "ram_util_percent": 78.21923076923078}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7656275740224587, "cur_kl_coeff": 8.88738773223702, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.00193213565635601, "vf_loss": 4.641608300655921, "vf_explained_var": -0.0004893031491004367, "kl": Infinity, "entropy": 0.35025355148271, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1150275.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000}, "env_runners": {"episode_reward_max": 1890.0, "episode_reward_min": 130.0, "episode_reward_mean": 633.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -90.0}, "policy_reward_max": {"policy_0": 980.0}, "policy_reward_mean": {"policy_0": 63.32}, "custom_metrics": {}, "hist_stats": {"episode_reward": [480.0, 770.0, 250.0, 340.0, 260.0, 890.0, 260.0, 400.0, 290.0, 830.0, 230.0, 880.0, 1150.0, 890.0, 940.0, 180.0, 1210.0, 560.0, 770.0, 1490.0, 190.0, 355.0, 160.0, 200.0, 670.0, 1890.0, 190.0, 490.0, 160.0, 1180.0, 1080.0, 940.0, 420.0, 940.0, 630.0, 380.0, 275.0, 230.0, 1180.0, 420.0, 350.0, 1310.0, 660.0, 160.0, 310.0, 780.0, 430.0, 1390.0, 700.0, 560.0, 1120.0, 370.0, 610.0, 770.0, 430.0, 345.0, 515.0, 500.0, 170.0, 500.0, 130.0, 940.0, 400.0, 800.0, 400.0, 1490.0, 960.0, 380.0, 820.0, 925.0, 800.0, 580.0, 770.0, 540.0, 710.0, 340.0, 710.0, 580.0, 680.0, 680.0, 720.0, 950.0, 970.0, 190.0, 220.0, 350.0, 360.0, 600.0, 580.0, 680.0, 800.0, 770.0, 780.0, 490.0, 280.0, 710.0, 850.0, 885.0, 1050.0, 420.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 10.0, 40.0, 10.0, 40.0, 70.0, -10.0, 150.0, 80.0, 70.0, 170.0, 30.0, 10.0, 30.0, 0.0, 20.0, 30.0, 260.0, 190.0, 30.0, 70.0, 0.0, 40.0, 0.0, 0.0, 40.0, 60.0, 40.0, 0.0, 0.0, 10.0, 60.0, 10.0, 30.0, 40.0, 20.0, 40.0, 30.0, 20.0, 80.0, 40.0, 30.0, 10.0, 20.0, 70.0, 10.0, 0.0, 30.0, 0.0, 50.0, 0.0, 80.0, 20.0, 30.0, 150.0, 20.0, 200.0, 50.0, 270.0, 70.0, 0.0, 10.0, 40.0, 30.0, 20.0, 30.0, 20.0, 40.0, 50.0, 20.0, 0.0, 0.0, 260.0, 0.0, 20.0, 40.0, -10.0, 70.0, 20.0, 0.0, 10.0, 0.0, 30.0, 0.0, 40.0, 0.0, 20.0, 70.0, 10.0, 110.0, 270.0, 10.0, 290.0, -10.0, 100.0, 60.0, 10.0, 100.0, -30.0, 30.0, 0.0, 0.0, 30.0, 10.0, 20.0, 20.0, 50.0, 0.0, 30.0, 70.0, 280.0, 100.0, 130.0, 190.0, 20.0, 10.0, 20.0, 30.0, 20.0, 80.0, 90.0, 120.0, 120.0, 0.0, 30.0, 70.0, 60.0, 280.0, 370.0, 10.0, -5.0, 40.0, 210.0, 60.0, 10.0, 5.0, 650.0, -35.0, 10.0, -55.0, 120.0, 230.0, 10.0, 40.0, 390.0, 30.0, 30.0, 20.0, 20.0, 50.0, 30.0, 0.0, 10.0, 10.0, 0.0, 10.0, 10.0, 40.0, 30.0, 40.0, 290.0, 580.0, 130.0, -90.0, 70.0, 80.0, 30.0, 0.0, 70.0, 50.0, 10.0, 20.0, 10.0, 90.0, 10.0, 280.0, 20.0, 30.0, 50.0, 40.0, 210.0, 20.0, 60.0, 80.0, 60.0, 20.0, 60.0, 30.0, 50.0, 180.0, 30.0, 980.0, 250.0, 30.0, 10.0, 90.0, 20.0, 60.0, 60.0, -40.0, 10.0, 50.0, 0.0, 20.0, 0.0, 20.0, 30.0, 30.0, 30.0, 0.0, 15.0, 40.0, 20.0, 0.0, 20.0, 0.0, 0.0, 70.0, 30.0, 160.0, 20.0, 40.0, 10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 30.0, 30.0, 10.0, 0.0, 80.0, 20.0, 20.0, 20.0, 0.0, 20.0, 0.0, 0.0, 20.0, 90.0, 20.0, 10.0, 390.0, 50.0, 40.0, 0.0, 50.0, 310.0, 60.0, -10.0, 40.0, 150.0, 20.0, 580.0, 50.0, 40.0, 650.0, 0.0, 100.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 30.0, 40.0, 50.0, 20.0, 10.0, 40.0, 0.0, 210.0, 30.0, 40.0, 50.0, 10.0, 10.0, 30.0, 10.0, 0.0, 20.0, 20.0, 10.0, 20.0, 30.0, 50.0, 200.0, 220.0, 290.0, 20.0, 120.0, 10.0, 160.0, 80.0, 30.0, 130.0, 490.0, 50.0, 40.0, 150.0, 20.0, 0.0, 70.0, 40.0, 90.0, 290.0, 80.0, 20.0, 30.0, 40.0, 20.0, 0.0, 90.0, 350.0, 20.0, 10.0, 80.0, 160.0, 20.0, 20.0, 40.0, 40.0, 10.0, 0.0, 40.0, 270.0, 60.0, 100.0, 10.0, 30.0, 10.0, 60.0, 90.0, 280.0, 30.0, 0.0, 380.0, 120.0, 10.0, 20.0, 20.0, 30.0, 40.0, 10.0, 0.0, 40.0, 20.0, 30.0, 0.0, 10.0, 170.0, 30.0, 40.0, 20.0, 20.0, 40.0, -5.0, 0.0, 10.0, 150.0, 0.0, 10.0, 30.0, 20.0, 20.0, 30.0, 40.0, 30.0, 0.0, 10.0, 20.0, 10.0, 0.0, 30.0, 60.0, 20.0, 30.0, 30.0, 30.0, 170.0, 30.0, 160.0, 90.0, 40.0, 580.0, 60.0, 10.0, 0.0, 70.0, 0.0, 30.0, 0.0, 150.0, 60.0, 40.0, 0.0, 20.0, 170.0, 10.0, 10.0, 10.0, 40.0, 30.0, 60.0, 0.0, 20.0, 790.0, 30.0, 60.0, 40.0, 180.0, 20.0, 20.0, 50.0, 100.0, 200.0, 20.0, 30.0, 60.0, 30.0, 20.0, 60.0, 70.0, 150.0, 20.0, 0.0, 0.0, 0.0, 40.0, 0.0, 30.0, 30.0, 40.0, 0.0, 20.0, 10.0, 40.0, 20.0, 100.0, 10.0, 10.0, 0.0, 40.0, 0.0, 80.0, 80.0, 10.0, 30.0, 190.0, 0.0, 10.0, 100.0, 170.0, 170.0, 20.0, 20.0, 20.0, 40.0, 10.0, 10.0, 260.0, 10.0, 20.0, 40.0, 0.0, 920.0, 180.0, 20.0, 50.0, 80.0, 20.0, 30.0, -40.0, 70.0, 60.0, 30.0, 0.0, 20.0, 0.0, 70.0, 140.0, 20.0, 70.0, 170.0, 180.0, 10.0, -10.0, 350.0, 110.0, 20.0, 0.0, 0.0, 20.0, 30.0, 30.0, 20.0, 80.0, 70.0, 60.0, 20.0, 150.0, 370.0, 60.0, 30.0, 260.0, 30.0, 20.0, 0.0, 130.0, 90.0, 10.0, 60.0, 0.0, 10.0, 20.0, 60.0, 10.0, 90.0, 10.0, 40.0, 0.0, 0.0, 80.0, 20.0, 300.0, 460.0, 10.0, 20.0, 30.0, 20.0, 40.0, 20.0, 150.0, 20.0, 0.0, 50.0, 30.0, 0.0, 50.0, 40.0, 30.0, 70.0, 30.0, 20.0, 110.0, 0.0, 20.0, 30.0, -10.0, 40.0, 40.0, 10.0, 260.0, 0.0, -45.0, 350.0, 20.0, 10.0, 70.0, 20.0, -5.0, 30.0, 40.0, 20.0, -40.0, 0.0, 10.0, 10.0, 30.0, 0.0, 10.0, 230.0, 170.0, 20.0, 20.0, 10.0, 10.0, 30.0, 10.0, 20.0, 0.0, 20.0, 0.0, 30.0, 40.0, 20.0, 10.0, 40.0, 10.0, 270.0, 40.0, 50.0, 20.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 60.0, 40.0, 0.0, 10.0, 80.0, 20.0, 20.0, 0.0, 70.0, 310.0, 40.0, 90.0, 30.0, 280.0, 30.0, 40.0, 20.0, 10.0, 90.0, 70.0, 20.0, 60.0, 20.0, 40.0, 380.0, 20.0, 100.0, 50.0, 0.0, 10.0, 80.0, 40.0, 40.0, 80.0, 0.0, 20.0, 30.0, 0.0, 50.0, 10.0, 10.0, 250.0, 10.0, 20.0, 30.0, 40.0, 560.0, 0.0, 30.0, 70.0, 190.0, 20.0, 70.0, 480.0, 30.0, 0.0, 30.0, 0.0, 60.0, 10.0, 710.0, 30.0, 70.0, 20.0, 30.0, 160.0, 50.0, 30.0, 0.0, 0.0, 40.0, 50.0, 20.0, 0.0, 20.0, 300.0, 40.0, 40.0, 160.0, 170.0, 60.0, 20.0, 0.0, 10.0, 0.0, 20.0, 0.0, 160.0, 50.0, 0.0, 70.0, -5.0, 50.0, 580.0, 60.0, 380.0, 40.0, 0.0, 70.0, 40.0, 120.0, 40.0, 30.0, 20.0, 190.0, 70.0, 90.0, 30.0, 20.0, 40.0, 60.0, 30.0, 0.0, 50.0, 90.0, 70.0, 70.0, 0.0, 40.0, 180.0, 250.0, 30.0, 0.0, 40.0, 60.0, 130.0, 10.0, 170.0, 60.0, 40.0, 0.0, 20.0, 50.0, 0.0, 470.0, 0.0, 0.0, -50.0, 60.0, 50.0, 140.0, 40.0, 30.0, -30.0, 0.0, 40.0, 0.0, 40.0, 60.0, 130.0, 0.0, 10.0, 60.0, 0.0, 70.0, 40.0, 40.0, 20.0, 300.0, 20.0, 30.0, 110.0, 80.0, 0.0, 190.0, 40.0, 0.0, 40.0, 60.0, 10.0, 0.0, 0.0, 70.0, 170.0, 80.0, 20.0, 90.0, 120.0, 290.0, 40.0, -50.0, 10.0, 40.0, 40.0, 30.0, 10.0, 10.0, 20.0, 560.0, 60.0, 30.0, -85.0, 70.0, -25.0, 250.0, 250.0, -10.0, 40.0, 20.0, 20.0, 0.0, 40.0, 40.0, 70.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 30.0, 40.0, 40.0, 760.0, 40.0, 160.0, 160.0, 50.0, 150.0, 80.0, 90.0, 80.0, 90.0, 70.0, 30.0, 10.0, 10.0, 0.0, 30.0, 20.0, 10.0, 10.0, 70.0, 0.0, 30.0, 10.0, 60.0, 10.0, 0.0, 20.0, 30.0, 10.0, 30.0, 20.0, 0.0, 20.0, 90.0, 40.0, 40.0, 70.0, 10.0, 0.0, 80.0, 0.0, 80.0, 20.0, 0.0, 10.0, 40.0, 0.0, 50.0, 0.0, 90.0, 70.0, 0.0, 250.0, 0.0, 30.0, 160.0, 50.0, 10.0, -50.0, 30.0, 120.0, 70.0, 0.0, 350.0, 70.0, 10.0, 0.0, 10.0, 0.0, 40.0, 30.0, 50.0, 0.0, -30.0, 60.0, 30.0, 0.0, 0.0, 410.0, 120.0, 40.0, 20.0, 0.0, 40.0, 80.0, 40.0, 570.0, 30.0, 0.0, 0.0, 20.0, 280.0, 20.0, 10.0, 40.0, 300.0, 30.0, 10.0, 0.0, 10.0, 70.0, 60.0, 30.0, 20.0, 10.0, 180.0, 160.0, 50.0, 0.0, 20.0, 250.0, 30.0, 20.0, 10.0, 20.0, 10.0, 250.0, 60.0, 20.0, 10.0, 60.0, 10.0, 10.0, 10.0, 10.0, 30.0, 10.0, 150.0, 40.0, 10.0, 0.0, -10.0, 370.0, -40.0, 20.0, 350.0, 0.0, 50.0, -40.0, 20.0, -10.0, 150.0, 80.0, -10.0, 40.0, 250.0, 70.0, 150.0, 80.0, 30.0, 10.0, 100.0, 30.0, 350.0, 270.0, 120.0, 20.0, 35.0, 10.0, -40.0, -10.0, 70.0, 70.0, 20.0, 160.0, 160.0, 20.0, 20.0, 20.0, 30.0, 480.0, 0.0, 30.0, 30.0, 0.0, 0.0, 70.0, 10.0, 40.0, 170.0, 70.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.42080993876374, "mean_inference_ms": 1.6206463623629128, "mean_action_processing_ms": 0.41995455246208907, "mean_env_wait_ms": 1.304116964630077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05878949165344238, "StateBufferConnector_ms": 0.009507179260253906, "ViewRequirementAgentConnector_ms": 0.4008486270904541}, "num_episodes": 18, "episode_return_max": 1890.0, "episode_return_min": 130.0, "episode_return_mean": 633.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 35.987555677621806, "num_env_steps_trained_throughput_per_sec": 35.987555677621806, "timesteps_total": 492000, "num_env_steps_sampled_lifetime": 492000, "num_agent_steps_sampled_lifetime": 4920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4920000, "timers": {"training_iteration_time_ms": 110168.454, "restore_workers_time_ms": 0.011, "training_step_time_ms": 110168.407, "sample_time_ms": 2461.56, "learn_time_ms": 107687.109, "learn_throughput": 37.145, "synch_weights_time_ms": 11.28}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 4920000, "num_agent_steps_trained": 4920000}, "done": false, "training_iteration": 123, "trial_id": "57140_00000", "date": "2024-06-27_03-05-57", "timestamp": 1719471957, "time_this_iter_s": 111.16054391860962, "time_total_s": 13882.357080698013, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b25c2940>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13882.357080698013, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 20.494904458598725, "ram_util_percent": 78.36433121019108}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.385753492488902, "cur_kl_coeff": 13.331081598355526, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0013534655988898775, "vf_loss": 4.570456134752471, "vf_explained_var": -0.0004797578111878091, "kl": Infinity, "entropy": 0.3818065095760317, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1159665.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000}, "env_runners": {"episode_reward_max": 1890.0, "episode_reward_min": 120.0, "episode_reward_mean": 637.15, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -85.0}, "policy_reward_max": {"policy_0": 980.0}, "policy_reward_mean": {"policy_0": 63.715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [770.0, 1490.0, 190.0, 355.0, 160.0, 200.0, 670.0, 1890.0, 190.0, 490.0, 160.0, 1180.0, 1080.0, 940.0, 420.0, 940.0, 630.0, 380.0, 275.0, 230.0, 1180.0, 420.0, 350.0, 1310.0, 660.0, 160.0, 310.0, 780.0, 430.0, 1390.0, 700.0, 560.0, 1120.0, 370.0, 610.0, 770.0, 430.0, 345.0, 515.0, 500.0, 170.0, 500.0, 130.0, 940.0, 400.0, 800.0, 400.0, 1490.0, 960.0, 380.0, 820.0, 925.0, 800.0, 580.0, 770.0, 540.0, 710.0, 340.0, 710.0, 580.0, 680.0, 680.0, 720.0, 950.0, 970.0, 190.0, 220.0, 350.0, 360.0, 600.0, 580.0, 680.0, 800.0, 770.0, 780.0, 490.0, 280.0, 710.0, 850.0, 885.0, 1050.0, 420.0, 655.0, 440.0, 120.0, 370.0, 360.0, 600.0, 380.0, 600.0, 790.0, 1470.0, 1230.0, 440.0, 370.0, 250.0, 620.0, 1230.0, 650.0, 630.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [210.0, 20.0, 60.0, 80.0, 60.0, 20.0, 60.0, 30.0, 50.0, 180.0, 30.0, 980.0, 250.0, 30.0, 10.0, 90.0, 20.0, 60.0, 60.0, -40.0, 10.0, 50.0, 0.0, 20.0, 0.0, 20.0, 30.0, 30.0, 30.0, 0.0, 15.0, 40.0, 20.0, 0.0, 20.0, 0.0, 0.0, 70.0, 30.0, 160.0, 20.0, 40.0, 10.0, 10.0, 0.0, 10.0, 20.0, 10.0, 10.0, 30.0, 30.0, 10.0, 0.0, 80.0, 20.0, 20.0, 20.0, 0.0, 20.0, 0.0, 0.0, 20.0, 90.0, 20.0, 10.0, 390.0, 50.0, 40.0, 0.0, 50.0, 310.0, 60.0, -10.0, 40.0, 150.0, 20.0, 580.0, 50.0, 40.0, 650.0, 0.0, 100.0, 10.0, 10.0, 10.0, 0.0, 20.0, 10.0, 0.0, 30.0, 40.0, 50.0, 20.0, 10.0, 40.0, 0.0, 210.0, 30.0, 40.0, 50.0, 10.0, 10.0, 30.0, 10.0, 0.0, 20.0, 20.0, 10.0, 20.0, 30.0, 50.0, 200.0, 220.0, 290.0, 20.0, 120.0, 10.0, 160.0, 80.0, 30.0, 130.0, 490.0, 50.0, 40.0, 150.0, 20.0, 0.0, 70.0, 40.0, 90.0, 290.0, 80.0, 20.0, 30.0, 40.0, 20.0, 0.0, 90.0, 350.0, 20.0, 10.0, 80.0, 160.0, 20.0, 20.0, 40.0, 40.0, 10.0, 0.0, 40.0, 270.0, 60.0, 100.0, 10.0, 30.0, 10.0, 60.0, 90.0, 280.0, 30.0, 0.0, 380.0, 120.0, 10.0, 20.0, 20.0, 30.0, 40.0, 10.0, 0.0, 40.0, 20.0, 30.0, 0.0, 10.0, 170.0, 30.0, 40.0, 20.0, 20.0, 40.0, -5.0, 0.0, 10.0, 150.0, 0.0, 10.0, 30.0, 20.0, 20.0, 30.0, 40.0, 30.0, 0.0, 10.0, 20.0, 10.0, 0.0, 30.0, 60.0, 20.0, 30.0, 30.0, 30.0, 170.0, 30.0, 160.0, 90.0, 40.0, 580.0, 60.0, 10.0, 0.0, 70.0, 0.0, 30.0, 0.0, 150.0, 60.0, 40.0, 0.0, 20.0, 170.0, 10.0, 10.0, 10.0, 40.0, 30.0, 60.0, 0.0, 20.0, 790.0, 30.0, 60.0, 40.0, 180.0, 20.0, 20.0, 50.0, 100.0, 200.0, 20.0, 30.0, 60.0, 30.0, 20.0, 60.0, 70.0, 150.0, 20.0, 0.0, 0.0, 0.0, 40.0, 0.0, 30.0, 30.0, 40.0, 0.0, 20.0, 10.0, 40.0, 20.0, 100.0, 10.0, 10.0, 0.0, 40.0, 0.0, 80.0, 80.0, 10.0, 30.0, 190.0, 0.0, 10.0, 100.0, 170.0, 170.0, 20.0, 20.0, 20.0, 40.0, 10.0, 10.0, 260.0, 10.0, 20.0, 40.0, 0.0, 920.0, 180.0, 20.0, 50.0, 80.0, 20.0, 30.0, -40.0, 70.0, 60.0, 30.0, 0.0, 20.0, 0.0, 70.0, 140.0, 20.0, 70.0, 170.0, 180.0, 10.0, -10.0, 350.0, 110.0, 20.0, 0.0, 0.0, 20.0, 30.0, 30.0, 20.0, 80.0, 70.0, 60.0, 20.0, 150.0, 370.0, 60.0, 30.0, 260.0, 30.0, 20.0, 0.0, 130.0, 90.0, 10.0, 60.0, 0.0, 10.0, 20.0, 60.0, 10.0, 90.0, 10.0, 40.0, 0.0, 0.0, 80.0, 20.0, 300.0, 460.0, 10.0, 20.0, 30.0, 20.0, 40.0, 20.0, 150.0, 20.0, 0.0, 50.0, 30.0, 0.0, 50.0, 40.0, 30.0, 70.0, 30.0, 20.0, 110.0, 0.0, 20.0, 30.0, -10.0, 40.0, 40.0, 10.0, 260.0, 0.0, -45.0, 350.0, 20.0, 10.0, 70.0, 20.0, -5.0, 30.0, 40.0, 20.0, -40.0, 0.0, 10.0, 10.0, 30.0, 0.0, 10.0, 230.0, 170.0, 20.0, 20.0, 10.0, 10.0, 30.0, 10.0, 20.0, 0.0, 20.0, 0.0, 30.0, 40.0, 20.0, 10.0, 40.0, 10.0, 270.0, 40.0, 50.0, 20.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 60.0, 40.0, 0.0, 10.0, 80.0, 20.0, 20.0, 0.0, 70.0, 310.0, 40.0, 90.0, 30.0, 280.0, 30.0, 40.0, 20.0, 10.0, 90.0, 70.0, 20.0, 60.0, 20.0, 40.0, 380.0, 20.0, 100.0, 50.0, 0.0, 10.0, 80.0, 40.0, 40.0, 80.0, 0.0, 20.0, 30.0, 0.0, 50.0, 10.0, 10.0, 250.0, 10.0, 20.0, 30.0, 40.0, 560.0, 0.0, 30.0, 70.0, 190.0, 20.0, 70.0, 480.0, 30.0, 0.0, 30.0, 0.0, 60.0, 10.0, 710.0, 30.0, 70.0, 20.0, 30.0, 160.0, 50.0, 30.0, 0.0, 0.0, 40.0, 50.0, 20.0, 0.0, 20.0, 300.0, 40.0, 40.0, 160.0, 170.0, 60.0, 20.0, 0.0, 10.0, 0.0, 20.0, 0.0, 160.0, 50.0, 0.0, 70.0, -5.0, 50.0, 580.0, 60.0, 380.0, 40.0, 0.0, 70.0, 40.0, 120.0, 40.0, 30.0, 20.0, 190.0, 70.0, 90.0, 30.0, 20.0, 40.0, 60.0, 30.0, 0.0, 50.0, 90.0, 70.0, 70.0, 0.0, 40.0, 180.0, 250.0, 30.0, 0.0, 40.0, 60.0, 130.0, 10.0, 170.0, 60.0, 40.0, 0.0, 20.0, 50.0, 0.0, 470.0, 0.0, 0.0, -50.0, 60.0, 50.0, 140.0, 40.0, 30.0, -30.0, 0.0, 40.0, 0.0, 40.0, 60.0, 130.0, 0.0, 10.0, 60.0, 0.0, 70.0, 40.0, 40.0, 20.0, 300.0, 20.0, 30.0, 110.0, 80.0, 0.0, 190.0, 40.0, 0.0, 40.0, 60.0, 10.0, 0.0, 0.0, 70.0, 170.0, 80.0, 20.0, 90.0, 120.0, 290.0, 40.0, -50.0, 10.0, 40.0, 40.0, 30.0, 10.0, 10.0, 20.0, 560.0, 60.0, 30.0, -85.0, 70.0, -25.0, 250.0, 250.0, -10.0, 40.0, 20.0, 20.0, 0.0, 40.0, 40.0, 70.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 30.0, 40.0, 40.0, 760.0, 40.0, 160.0, 160.0, 50.0, 150.0, 80.0, 90.0, 80.0, 90.0, 70.0, 30.0, 10.0, 10.0, 0.0, 30.0, 20.0, 10.0, 10.0, 70.0, 0.0, 30.0, 10.0, 60.0, 10.0, 0.0, 20.0, 30.0, 10.0, 30.0, 20.0, 0.0, 20.0, 90.0, 40.0, 40.0, 70.0, 10.0, 0.0, 80.0, 0.0, 80.0, 20.0, 0.0, 10.0, 40.0, 0.0, 50.0, 0.0, 90.0, 70.0, 0.0, 250.0, 0.0, 30.0, 160.0, 50.0, 10.0, -50.0, 30.0, 120.0, 70.0, 0.0, 350.0, 70.0, 10.0, 0.0, 10.0, 0.0, 40.0, 30.0, 50.0, 0.0, -30.0, 60.0, 30.0, 0.0, 0.0, 410.0, 120.0, 40.0, 20.0, 0.0, 40.0, 80.0, 40.0, 570.0, 30.0, 0.0, 0.0, 20.0, 280.0, 20.0, 10.0, 40.0, 300.0, 30.0, 10.0, 0.0, 10.0, 70.0, 60.0, 30.0, 20.0, 10.0, 180.0, 160.0, 50.0, 0.0, 20.0, 250.0, 30.0, 20.0, 10.0, 20.0, 10.0, 250.0, 60.0, 20.0, 10.0, 60.0, 10.0, 10.0, 10.0, 10.0, 30.0, 10.0, 150.0, 40.0, 10.0, 0.0, -10.0, 370.0, -40.0, 20.0, 350.0, 0.0, 50.0, -40.0, 20.0, -10.0, 150.0, 80.0, -10.0, 40.0, 250.0, 70.0, 150.0, 80.0, 30.0, 10.0, 100.0, 30.0, 350.0, 270.0, 120.0, 20.0, 35.0, 10.0, -40.0, -10.0, 70.0, 70.0, 20.0, 160.0, 160.0, 20.0, 20.0, 20.0, 30.0, 480.0, 0.0, 30.0, 30.0, 0.0, 0.0, 70.0, 10.0, 40.0, 170.0, 70.0, 0.0, 0.0, 30.0, 5.0, 30.0, 10.0, 30.0, 30.0, 360.0, 160.0, 20.0, 40.0, 20.0, 160.0, 30.0, 20.0, 10.0, 20.0, 40.0, 80.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 10.0, 20.0, 30.0, 20.0, 40.0, 20.0, 40.0, 40.0, 110.0, 30.0, 40.0, 10.0, 20.0, 40.0, 30.0, 10.0, 20.0, 30.0, 10.0, 80.0, 40.0, 20.0, 80.0, 160.0, 20.0, 0.0, 50.0, 30.0, 20.0, 100.0, 30.0, 180.0, 10.0, 10.0, 10.0, 30.0, 0.0, 40.0, 50.0, 20.0, 150.0, 40.0, 30.0, 20.0, 30.0, 40.0, 80.0, 20.0, 0.0, 10.0, 210.0, 170.0, 20.0, 0.0, 20.0, 50.0, -50.0, 270.0, 50.0, 350.0, 60.0, -20.0, 60.0, 50.0, 30.0, 90.0, 100.0, 0.0, 490.0, 20.0, 200.0, 420.0, 70.0, 360.0, 30.0, 170.0, 110.0, 180.0, 10.0, 60.0, 250.0, 40.0, 20.0, 150.0, 30.0, 30.0, 0.0, 170.0, 10.0, 10.0, 0.0, 0.0, 40.0, 10.0, 20.0, 170.0, 0.0, 70.0, 40.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 30.0, 140.0, 20.0, 40.0, 0.0, 0.0, 20.0, 0.0, 100.0, 50.0, 30.0, 0.0, -10.0, 50.0, 260.0, 90.0, 30.0, 20.0, 50.0, 150.0, 110.0, 20.0, 50.0, 80.0, 60.0, 40.0, 460.0, 210.0, 100.0, 40.0, 110.0, 60.0, 100.0, 20.0, 70.0, 0.0, 110.0, 40.0, 10.0, 30.0, 380.0, 10.0, 30.0, 90.0, 40.0, 0.0, 0.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4202470900388806, "mean_inference_ms": 1.6204420123383283, "mean_action_processing_ms": 0.42057838204416065, "mean_env_wait_ms": 1.303828931699839, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058919429779052734, "StateBufferConnector_ms": 0.009541511535644531, "ViewRequirementAgentConnector_ms": 0.40052318572998047}, "num_episodes": 18, "episode_return_max": 1890.0, "episode_return_min": 120.0, "episode_return_mean": 637.15}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.53268665235193, "num_env_steps_trained_throughput_per_sec": 36.53268665235193, "timesteps_total": 496000, "num_env_steps_sampled_lifetime": 496000, "num_agent_steps_sampled_lifetime": 4960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4960000, "timers": {"training_iteration_time_ms": 110133.995, "restore_workers_time_ms": 0.011, "training_step_time_ms": 110133.948, "sample_time_ms": 2458.168, "learn_time_ms": 107656.024, "learn_throughput": 37.155, "synch_weights_time_ms": 11.36}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 4960000, "num_agent_steps_trained": 4960000}, "done": false, "training_iteration": 124, "trial_id": "57140_00000", "date": "2024-06-27_03-07-47", "timestamp": 1719472067, "time_this_iter_s": 109.50416302680969, "time_total_s": 13991.861243724823, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23a7d30>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13991.861243724823, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 15.72451612903226, "ram_util_percent": 78.36903225806452}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.340682703542252, "cur_kl_coeff": 19.996622397533297, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.41688839591984, "policy_loss": -0.0013312590571816641, "vf_loss": 4.416115526701061, "vf_explained_var": 0.00048648994951583325, "kl": 0.00010522425597003484, "entropy": 0.37951780523672396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1169055.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000}, "env_runners": {"episode_reward_max": 1490.0, "episode_reward_min": 120.0, "episode_reward_mean": 642.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -620.0}, "policy_reward_max": {"policy_0": 980.0}, "policy_reward_mean": {"policy_0": 64.295}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1310.0, 660.0, 160.0, 310.0, 780.0, 430.0, 1390.0, 700.0, 560.0, 1120.0, 370.0, 610.0, 770.0, 430.0, 345.0, 515.0, 500.0, 170.0, 500.0, 130.0, 940.0, 400.0, 800.0, 400.0, 1490.0, 960.0, 380.0, 820.0, 925.0, 800.0, 580.0, 770.0, 540.0, 710.0, 340.0, 710.0, 580.0, 680.0, 680.0, 720.0, 950.0, 970.0, 190.0, 220.0, 350.0, 360.0, 600.0, 580.0, 680.0, 800.0, 770.0, 780.0, 490.0, 280.0, 710.0, 850.0, 885.0, 1050.0, 420.0, 655.0, 440.0, 120.0, 370.0, 360.0, 600.0, 380.0, 600.0, 790.0, 1470.0, 1230.0, 440.0, 370.0, 250.0, 620.0, 1230.0, 650.0, 630.0, 470.0, 360.0, 340.0, 760.0, 470.0, 1150.0, 745.0, 530.0, 1105.0, 850.0, 500.0, 1310.0, 520.0, 360.0, 305.0, 195.0, 250.0, 1090.0, 450.0, 1460.0, 280.0, 540.0, 1130.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 790.0, 30.0, 60.0, 40.0, 180.0, 20.0, 20.0, 50.0, 100.0, 200.0, 20.0, 30.0, 60.0, 30.0, 20.0, 60.0, 70.0, 150.0, 20.0, 0.0, 0.0, 0.0, 40.0, 0.0, 30.0, 30.0, 40.0, 0.0, 20.0, 10.0, 40.0, 20.0, 100.0, 10.0, 10.0, 0.0, 40.0, 0.0, 80.0, 80.0, 10.0, 30.0, 190.0, 0.0, 10.0, 100.0, 170.0, 170.0, 20.0, 20.0, 20.0, 40.0, 10.0, 10.0, 260.0, 10.0, 20.0, 40.0, 0.0, 920.0, 180.0, 20.0, 50.0, 80.0, 20.0, 30.0, -40.0, 70.0, 60.0, 30.0, 0.0, 20.0, 0.0, 70.0, 140.0, 20.0, 70.0, 170.0, 180.0, 10.0, -10.0, 350.0, 110.0, 20.0, 0.0, 0.0, 20.0, 30.0, 30.0, 20.0, 80.0, 70.0, 60.0, 20.0, 150.0, 370.0, 60.0, 30.0, 260.0, 30.0, 20.0, 0.0, 130.0, 90.0, 10.0, 60.0, 0.0, 10.0, 20.0, 60.0, 10.0, 90.0, 10.0, 40.0, 0.0, 0.0, 80.0, 20.0, 300.0, 460.0, 10.0, 20.0, 30.0, 20.0, 40.0, 20.0, 150.0, 20.0, 0.0, 50.0, 30.0, 0.0, 50.0, 40.0, 30.0, 70.0, 30.0, 20.0, 110.0, 0.0, 20.0, 30.0, -10.0, 40.0, 40.0, 10.0, 260.0, 0.0, -45.0, 350.0, 20.0, 10.0, 70.0, 20.0, -5.0, 30.0, 40.0, 20.0, -40.0, 0.0, 10.0, 10.0, 30.0, 0.0, 10.0, 230.0, 170.0, 20.0, 20.0, 10.0, 10.0, 30.0, 10.0, 20.0, 0.0, 20.0, 0.0, 30.0, 40.0, 20.0, 10.0, 40.0, 10.0, 270.0, 40.0, 50.0, 20.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 60.0, 40.0, 0.0, 10.0, 80.0, 20.0, 20.0, 0.0, 70.0, 310.0, 40.0, 90.0, 30.0, 280.0, 30.0, 40.0, 20.0, 10.0, 90.0, 70.0, 20.0, 60.0, 20.0, 40.0, 380.0, 20.0, 100.0, 50.0, 0.0, 10.0, 80.0, 40.0, 40.0, 80.0, 0.0, 20.0, 30.0, 0.0, 50.0, 10.0, 10.0, 250.0, 10.0, 20.0, 30.0, 40.0, 560.0, 0.0, 30.0, 70.0, 190.0, 20.0, 70.0, 480.0, 30.0, 0.0, 30.0, 0.0, 60.0, 10.0, 710.0, 30.0, 70.0, 20.0, 30.0, 160.0, 50.0, 30.0, 0.0, 0.0, 40.0, 50.0, 20.0, 0.0, 20.0, 300.0, 40.0, 40.0, 160.0, 170.0, 60.0, 20.0, 0.0, 10.0, 0.0, 20.0, 0.0, 160.0, 50.0, 0.0, 70.0, -5.0, 50.0, 580.0, 60.0, 380.0, 40.0, 0.0, 70.0, 40.0, 120.0, 40.0, 30.0, 20.0, 190.0, 70.0, 90.0, 30.0, 20.0, 40.0, 60.0, 30.0, 0.0, 50.0, 90.0, 70.0, 70.0, 0.0, 40.0, 180.0, 250.0, 30.0, 0.0, 40.0, 60.0, 130.0, 10.0, 170.0, 60.0, 40.0, 0.0, 20.0, 50.0, 0.0, 470.0, 0.0, 0.0, -50.0, 60.0, 50.0, 140.0, 40.0, 30.0, -30.0, 0.0, 40.0, 0.0, 40.0, 60.0, 130.0, 0.0, 10.0, 60.0, 0.0, 70.0, 40.0, 40.0, 20.0, 300.0, 20.0, 30.0, 110.0, 80.0, 0.0, 190.0, 40.0, 0.0, 40.0, 60.0, 10.0, 0.0, 0.0, 70.0, 170.0, 80.0, 20.0, 90.0, 120.0, 290.0, 40.0, -50.0, 10.0, 40.0, 40.0, 30.0, 10.0, 10.0, 20.0, 560.0, 60.0, 30.0, -85.0, 70.0, -25.0, 250.0, 250.0, -10.0, 40.0, 20.0, 20.0, 0.0, 40.0, 40.0, 70.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 30.0, 40.0, 40.0, 760.0, 40.0, 160.0, 160.0, 50.0, 150.0, 80.0, 90.0, 80.0, 90.0, 70.0, 30.0, 10.0, 10.0, 0.0, 30.0, 20.0, 10.0, 10.0, 70.0, 0.0, 30.0, 10.0, 60.0, 10.0, 0.0, 20.0, 30.0, 10.0, 30.0, 20.0, 0.0, 20.0, 90.0, 40.0, 40.0, 70.0, 10.0, 0.0, 80.0, 0.0, 80.0, 20.0, 0.0, 10.0, 40.0, 0.0, 50.0, 0.0, 90.0, 70.0, 0.0, 250.0, 0.0, 30.0, 160.0, 50.0, 10.0, -50.0, 30.0, 120.0, 70.0, 0.0, 350.0, 70.0, 10.0, 0.0, 10.0, 0.0, 40.0, 30.0, 50.0, 0.0, -30.0, 60.0, 30.0, 0.0, 0.0, 410.0, 120.0, 40.0, 20.0, 0.0, 40.0, 80.0, 40.0, 570.0, 30.0, 0.0, 0.0, 20.0, 280.0, 20.0, 10.0, 40.0, 300.0, 30.0, 10.0, 0.0, 10.0, 70.0, 60.0, 30.0, 20.0, 10.0, 180.0, 160.0, 50.0, 0.0, 20.0, 250.0, 30.0, 20.0, 10.0, 20.0, 10.0, 250.0, 60.0, 20.0, 10.0, 60.0, 10.0, 10.0, 10.0, 10.0, 30.0, 10.0, 150.0, 40.0, 10.0, 0.0, -10.0, 370.0, -40.0, 20.0, 350.0, 0.0, 50.0, -40.0, 20.0, -10.0, 150.0, 80.0, -10.0, 40.0, 250.0, 70.0, 150.0, 80.0, 30.0, 10.0, 100.0, 30.0, 350.0, 270.0, 120.0, 20.0, 35.0, 10.0, -40.0, -10.0, 70.0, 70.0, 20.0, 160.0, 160.0, 20.0, 20.0, 20.0, 30.0, 480.0, 0.0, 30.0, 30.0, 0.0, 0.0, 70.0, 10.0, 40.0, 170.0, 70.0, 0.0, 0.0, 30.0, 5.0, 30.0, 10.0, 30.0, 30.0, 360.0, 160.0, 20.0, 40.0, 20.0, 160.0, 30.0, 20.0, 10.0, 20.0, 40.0, 80.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 10.0, 20.0, 30.0, 20.0, 40.0, 20.0, 40.0, 40.0, 110.0, 30.0, 40.0, 10.0, 20.0, 40.0, 30.0, 10.0, 20.0, 30.0, 10.0, 80.0, 40.0, 20.0, 80.0, 160.0, 20.0, 0.0, 50.0, 30.0, 20.0, 100.0, 30.0, 180.0, 10.0, 10.0, 10.0, 30.0, 0.0, 40.0, 50.0, 20.0, 150.0, 40.0, 30.0, 20.0, 30.0, 40.0, 80.0, 20.0, 0.0, 10.0, 210.0, 170.0, 20.0, 0.0, 20.0, 50.0, -50.0, 270.0, 50.0, 350.0, 60.0, -20.0, 60.0, 50.0, 30.0, 90.0, 100.0, 0.0, 490.0, 20.0, 200.0, 420.0, 70.0, 360.0, 30.0, 170.0, 110.0, 180.0, 10.0, 60.0, 250.0, 40.0, 20.0, 150.0, 30.0, 30.0, 0.0, 170.0, 10.0, 10.0, 0.0, 0.0, 40.0, 10.0, 20.0, 170.0, 0.0, 70.0, 40.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 30.0, 140.0, 20.0, 40.0, 0.0, 0.0, 20.0, 0.0, 100.0, 50.0, 30.0, 0.0, -10.0, 50.0, 260.0, 90.0, 30.0, 20.0, 50.0, 150.0, 110.0, 20.0, 50.0, 80.0, 60.0, 40.0, 460.0, 210.0, 100.0, 40.0, 110.0, 60.0, 100.0, 20.0, 70.0, 0.0, 110.0, 40.0, 10.0, 30.0, 380.0, 10.0, 30.0, 90.0, 40.0, 0.0, 0.0, 40.0, 10.0, 40.0, 0.0, 40.0, 20.0, 40.0, 30.0, 10.0, 250.0, 30.0, 40.0, 0.0, 0.0, 20.0, 0.0, 10.0, 70.0, 0.0, 40.0, 180.0, 10.0, 0.0, 0.0, 10.0, 50.0, 50.0, 160.0, 20.0, 40.0, 0.0, 70.0, 10.0, 10.0, 100.0, 190.0, 10.0, 50.0, 20.0, 30.0, 270.0, 40.0, 40.0, 10.0, 50.0, 40.0, 160.0, 10.0, 20.0, 20.0, 80.0, 20.0, -40.0, 140.0, 40.0, 70.0, -10.0, 820.0, 0.0, 30.0, 80.0, 20.0, 20.0, 260.0, 130.0, 0.0, 35.0, 40.0, 80.0, 10.0, 150.0, 70.0, 0.0, 90.0, 0.0, 150.0, 20.0, 20.0, 20.0, 30.0, 130.0, -130.0, 40.0, 30.0, 25.0, 770.0, 160.0, 20.0, 50.0, 70.0, 70.0, 20.0, 40.0, 30.0, 10.0, 10.0, 360.0, 120.0, 80.0, 110.0, 70.0, 10.0, 30.0, 0.0, 110.0, 30.0, 10.0, 60.0, 60.0, 20.0, 170.0, 60.0, -10.0, 50.0, 140.0, 80.0, 0.0, 10.0, 20.0, 580.0, 380.0, 80.0, 110.0, 10.0, 70.0, 210.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 40.0, 0.0, 20.0, 60.0, 90.0, 60.0, 20.0, 0.0, 40.0, 50.0, 0.0, 30.0, 170.0, 145.0, 0.0, -620.0, 70.0, 410.0, 50.0, 0.0, 10.0, 70.0, 10.0, 5.0, 40.0, 0.0, 40.0, 10.0, 10.0, 30.0, 10.0, 0.0, 60.0, 40.0, 20.0, 0.0, 30.0, 30.0, 30.0, 50.0, 40.0, 70.0, 10.0, 180.0, 0.0, 80.0, 660.0, 110.0, -110.0, 40.0, 30.0, 10.0, 10.0, 170.0, 150.0, -30.0, 30.0, 40.0, 0.0, 20.0, 20.0, 50.0, 980.0, 10.0, 80.0, 20.0, 40.0, 40.0, 200.0, 0.0, 40.0, 100.0, 20.0, 20.0, 20.0, 10.0, 40.0, 20.0, 10.0, 10.0, 160.0, 30.0, 40.0, 0.0, 40.0, 0.0, 180.0, 30.0, 50.0, 360.0, 30.0, 40.0, 20.0, 30.0, 40.0, 480.0, 90.0, 20.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4195442504235334, "mean_inference_ms": 1.6201411568147817, "mean_action_processing_ms": 0.421357939052158, "mean_env_wait_ms": 1.3034329050233087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06013345718383789, "StateBufferConnector_ms": 0.009621143341064453, "ViewRequirementAgentConnector_ms": 0.39641642570495605}, "num_episodes": 23, "episode_return_max": 1490.0, "episode_return_min": 120.0, "episode_return_mean": 642.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.28414968317318, "num_env_steps_trained_throughput_per_sec": 36.28414968317318, "timesteps_total": 500000, "num_env_steps_sampled_lifetime": 500000, "num_agent_steps_sampled_lifetime": 5000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5000000, "timers": {"training_iteration_time_ms": 110149.921, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110149.874, "sample_time_ms": 2459.18, "learn_time_ms": 107670.663, "learn_throughput": 37.15, "synch_weights_time_ms": 11.54}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 5000000, "num_agent_steps_trained": 5000000}, "done": false, "training_iteration": 125, "trial_id": "57140_00000", "date": "2024-06-27_03-09-37", "timestamp": 1719472177, "time_this_iter_s": 110.25258421897888, "time_total_s": 14102.113827943802, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23fd310>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14102.113827943802, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 15.692948717948717, "ram_util_percent": 77.93974358974359}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8743881066894126, "cur_kl_coeff": 9.998311198766649, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.001768916314770294, "vf_loss": 3.6325382850548458, "vf_explained_var": 0.0005929280203371383, "kl": Infinity, "entropy": 0.38516301702196226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1178445.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000}, "env_runners": {"episode_reward_max": 1490.0, "episode_reward_min": 110.0, "episode_reward_mean": 617.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -620.0}, "policy_reward_max": {"policy_0": 980.0}, "policy_reward_mean": {"policy_0": 61.735}, "custom_metrics": {}, "hist_stats": {"episode_reward": [500.0, 130.0, 940.0, 400.0, 800.0, 400.0, 1490.0, 960.0, 380.0, 820.0, 925.0, 800.0, 580.0, 770.0, 540.0, 710.0, 340.0, 710.0, 580.0, 680.0, 680.0, 720.0, 950.0, 970.0, 190.0, 220.0, 350.0, 360.0, 600.0, 580.0, 680.0, 800.0, 770.0, 780.0, 490.0, 280.0, 710.0, 850.0, 885.0, 1050.0, 420.0, 655.0, 440.0, 120.0, 370.0, 360.0, 600.0, 380.0, 600.0, 790.0, 1470.0, 1230.0, 440.0, 370.0, 250.0, 620.0, 1230.0, 650.0, 630.0, 470.0, 360.0, 340.0, 760.0, 470.0, 1150.0, 745.0, 530.0, 1105.0, 850.0, 500.0, 1310.0, 520.0, 360.0, 305.0, 195.0, 250.0, 1090.0, 450.0, 1460.0, 280.0, 540.0, 1130.0, 165.0, 440.0, 470.0, 360.0, 1020.0, 290.0, 1420.0, 250.0, 340.0, 340.0, 430.0, 810.0, 725.0, 450.0, 230.0, 280.0, 440.0, 110.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 10.0, 40.0, 10.0, 270.0, 40.0, 50.0, 20.0, 20.0, 20.0, 10.0, 0.0, 0.0, 0.0, 0.0, 10.0, 60.0, 40.0, 0.0, 10.0, 80.0, 20.0, 20.0, 0.0, 70.0, 310.0, 40.0, 90.0, 30.0, 280.0, 30.0, 40.0, 20.0, 10.0, 90.0, 70.0, 20.0, 60.0, 20.0, 40.0, 380.0, 20.0, 100.0, 50.0, 0.0, 10.0, 80.0, 40.0, 40.0, 80.0, 0.0, 20.0, 30.0, 0.0, 50.0, 10.0, 10.0, 250.0, 10.0, 20.0, 30.0, 40.0, 560.0, 0.0, 30.0, 70.0, 190.0, 20.0, 70.0, 480.0, 30.0, 0.0, 30.0, 0.0, 60.0, 10.0, 710.0, 30.0, 70.0, 20.0, 30.0, 160.0, 50.0, 30.0, 0.0, 0.0, 40.0, 50.0, 20.0, 0.0, 20.0, 300.0, 40.0, 40.0, 160.0, 170.0, 60.0, 20.0, 0.0, 10.0, 0.0, 20.0, 0.0, 160.0, 50.0, 0.0, 70.0, -5.0, 50.0, 580.0, 60.0, 380.0, 40.0, 0.0, 70.0, 40.0, 120.0, 40.0, 30.0, 20.0, 190.0, 70.0, 90.0, 30.0, 20.0, 40.0, 60.0, 30.0, 0.0, 50.0, 90.0, 70.0, 70.0, 0.0, 40.0, 180.0, 250.0, 30.0, 0.0, 40.0, 60.0, 130.0, 10.0, 170.0, 60.0, 40.0, 0.0, 20.0, 50.0, 0.0, 470.0, 0.0, 0.0, -50.0, 60.0, 50.0, 140.0, 40.0, 30.0, -30.0, 0.0, 40.0, 0.0, 40.0, 60.0, 130.0, 0.0, 10.0, 60.0, 0.0, 70.0, 40.0, 40.0, 20.0, 300.0, 20.0, 30.0, 110.0, 80.0, 0.0, 190.0, 40.0, 0.0, 40.0, 60.0, 10.0, 0.0, 0.0, 70.0, 170.0, 80.0, 20.0, 90.0, 120.0, 290.0, 40.0, -50.0, 10.0, 40.0, 40.0, 30.0, 10.0, 10.0, 20.0, 560.0, 60.0, 30.0, -85.0, 70.0, -25.0, 250.0, 250.0, -10.0, 40.0, 20.0, 20.0, 0.0, 40.0, 40.0, 70.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 30.0, 40.0, 40.0, 760.0, 40.0, 160.0, 160.0, 50.0, 150.0, 80.0, 90.0, 80.0, 90.0, 70.0, 30.0, 10.0, 10.0, 0.0, 30.0, 20.0, 10.0, 10.0, 70.0, 0.0, 30.0, 10.0, 60.0, 10.0, 0.0, 20.0, 30.0, 10.0, 30.0, 20.0, 0.0, 20.0, 90.0, 40.0, 40.0, 70.0, 10.0, 0.0, 80.0, 0.0, 80.0, 20.0, 0.0, 10.0, 40.0, 0.0, 50.0, 0.0, 90.0, 70.0, 0.0, 250.0, 0.0, 30.0, 160.0, 50.0, 10.0, -50.0, 30.0, 120.0, 70.0, 0.0, 350.0, 70.0, 10.0, 0.0, 10.0, 0.0, 40.0, 30.0, 50.0, 0.0, -30.0, 60.0, 30.0, 0.0, 0.0, 410.0, 120.0, 40.0, 20.0, 0.0, 40.0, 80.0, 40.0, 570.0, 30.0, 0.0, 0.0, 20.0, 280.0, 20.0, 10.0, 40.0, 300.0, 30.0, 10.0, 0.0, 10.0, 70.0, 60.0, 30.0, 20.0, 10.0, 180.0, 160.0, 50.0, 0.0, 20.0, 250.0, 30.0, 20.0, 10.0, 20.0, 10.0, 250.0, 60.0, 20.0, 10.0, 60.0, 10.0, 10.0, 10.0, 10.0, 30.0, 10.0, 150.0, 40.0, 10.0, 0.0, -10.0, 370.0, -40.0, 20.0, 350.0, 0.0, 50.0, -40.0, 20.0, -10.0, 150.0, 80.0, -10.0, 40.0, 250.0, 70.0, 150.0, 80.0, 30.0, 10.0, 100.0, 30.0, 350.0, 270.0, 120.0, 20.0, 35.0, 10.0, -40.0, -10.0, 70.0, 70.0, 20.0, 160.0, 160.0, 20.0, 20.0, 20.0, 30.0, 480.0, 0.0, 30.0, 30.0, 0.0, 0.0, 70.0, 10.0, 40.0, 170.0, 70.0, 0.0, 0.0, 30.0, 5.0, 30.0, 10.0, 30.0, 30.0, 360.0, 160.0, 20.0, 40.0, 20.0, 160.0, 30.0, 20.0, 10.0, 20.0, 40.0, 80.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 10.0, 20.0, 30.0, 20.0, 40.0, 20.0, 40.0, 40.0, 110.0, 30.0, 40.0, 10.0, 20.0, 40.0, 30.0, 10.0, 20.0, 30.0, 10.0, 80.0, 40.0, 20.0, 80.0, 160.0, 20.0, 0.0, 50.0, 30.0, 20.0, 100.0, 30.0, 180.0, 10.0, 10.0, 10.0, 30.0, 0.0, 40.0, 50.0, 20.0, 150.0, 40.0, 30.0, 20.0, 30.0, 40.0, 80.0, 20.0, 0.0, 10.0, 210.0, 170.0, 20.0, 0.0, 20.0, 50.0, -50.0, 270.0, 50.0, 350.0, 60.0, -20.0, 60.0, 50.0, 30.0, 90.0, 100.0, 0.0, 490.0, 20.0, 200.0, 420.0, 70.0, 360.0, 30.0, 170.0, 110.0, 180.0, 10.0, 60.0, 250.0, 40.0, 20.0, 150.0, 30.0, 30.0, 0.0, 170.0, 10.0, 10.0, 0.0, 0.0, 40.0, 10.0, 20.0, 170.0, 0.0, 70.0, 40.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 30.0, 140.0, 20.0, 40.0, 0.0, 0.0, 20.0, 0.0, 100.0, 50.0, 30.0, 0.0, -10.0, 50.0, 260.0, 90.0, 30.0, 20.0, 50.0, 150.0, 110.0, 20.0, 50.0, 80.0, 60.0, 40.0, 460.0, 210.0, 100.0, 40.0, 110.0, 60.0, 100.0, 20.0, 70.0, 0.0, 110.0, 40.0, 10.0, 30.0, 380.0, 10.0, 30.0, 90.0, 40.0, 0.0, 0.0, 40.0, 10.0, 40.0, 0.0, 40.0, 20.0, 40.0, 30.0, 10.0, 250.0, 30.0, 40.0, 0.0, 0.0, 20.0, 0.0, 10.0, 70.0, 0.0, 40.0, 180.0, 10.0, 0.0, 0.0, 10.0, 50.0, 50.0, 160.0, 20.0, 40.0, 0.0, 70.0, 10.0, 10.0, 100.0, 190.0, 10.0, 50.0, 20.0, 30.0, 270.0, 40.0, 40.0, 10.0, 50.0, 40.0, 160.0, 10.0, 20.0, 20.0, 80.0, 20.0, -40.0, 140.0, 40.0, 70.0, -10.0, 820.0, 0.0, 30.0, 80.0, 20.0, 20.0, 260.0, 130.0, 0.0, 35.0, 40.0, 80.0, 10.0, 150.0, 70.0, 0.0, 90.0, 0.0, 150.0, 20.0, 20.0, 20.0, 30.0, 130.0, -130.0, 40.0, 30.0, 25.0, 770.0, 160.0, 20.0, 50.0, 70.0, 70.0, 20.0, 40.0, 30.0, 10.0, 10.0, 360.0, 120.0, 80.0, 110.0, 70.0, 10.0, 30.0, 0.0, 110.0, 30.0, 10.0, 60.0, 60.0, 20.0, 170.0, 60.0, -10.0, 50.0, 140.0, 80.0, 0.0, 10.0, 20.0, 580.0, 380.0, 80.0, 110.0, 10.0, 70.0, 210.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 40.0, 0.0, 20.0, 60.0, 90.0, 60.0, 20.0, 0.0, 40.0, 50.0, 0.0, 30.0, 170.0, 145.0, 0.0, -620.0, 70.0, 410.0, 50.0, 0.0, 10.0, 70.0, 10.0, 5.0, 40.0, 0.0, 40.0, 10.0, 10.0, 30.0, 10.0, 0.0, 60.0, 40.0, 20.0, 0.0, 30.0, 30.0, 30.0, 50.0, 40.0, 70.0, 10.0, 180.0, 0.0, 80.0, 660.0, 110.0, -110.0, 40.0, 30.0, 10.0, 10.0, 170.0, 150.0, -30.0, 30.0, 40.0, 0.0, 20.0, 20.0, 50.0, 980.0, 10.0, 80.0, 20.0, 40.0, 40.0, 200.0, 0.0, 40.0, 100.0, 20.0, 20.0, 20.0, 10.0, 40.0, 20.0, 10.0, 10.0, 160.0, 30.0, 40.0, 0.0, 40.0, 0.0, 180.0, 30.0, 50.0, 360.0, 30.0, 40.0, 20.0, 30.0, 40.0, 480.0, 90.0, 20.0, 20.0, 30.0, 0.0, 0.0, 20.0, 30.0, 10.0, 40.0, -5.0, 0.0, 40.0, 260.0, 30.0, 10.0, 0.0, 40.0, 20.0, 30.0, 20.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 310.0, 60.0, 40.0, 20.0, 0.0, 30.0, 370.0, 10.0, -20.0, 0.0, -50.0, 20.0, 0.0, 0.0, 20.0, 200.0, 80.0, 610.0, 0.0, 100.0, 20.0, 10.0, 20.0, -40.0, 10.0, 20.0, 10.0, 40.0, 0.0, 70.0, 0.0, 100.0, 40.0, 0.0, 50.0, 40.0, 950.0, 20.0, 30.0, 100.0, 40.0, 0.0, 40.0, 150.0, 60.0, 30.0, 20.0, 0.0, 30.0, 40.0, 0.0, 10.0, 40.0, 20.0, 30.0, 30.0, 50.0, 70.0, 40.0, 30.0, 30.0, 30.0, 20.0, 10.0, 60.0, 20.0, 30.0, 10.0, 40.0, 40.0, 40.0, 60.0, 40.0, 0.0, 0.0, 0.0, 150.0, 20.0, 10.0, 50.0, 10.0, 10.0, 10.0, 170.0, 60.0, 110.0, 30.0, 10.0, 130.0, 10.0, 40.0, -280.0, 570.0, 130.0, 155.0, 10.0, 260.0, 50.0, 40.0, 20.0, -20.0, 30.0, 10.0, 170.0, 0.0, 30.0, 40.0, 40.0, 50.0, 30.0, 150.0, 30.0, 50.0, 30.0, 0.0, 40.0, 100.0, 0.0, 20.0, 30.0, 20.0, 20.0, 0.0, 0.0, 50.0, 0.0, 0.0, 40.0, 40.0, 30.0, 50.0, 30.0, 20.0, 20.0, 130.0, 40.0, 20.0, 50.0, 0.0, 0.0, 20.0, 160.0, 20.0, 0.0, 30.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4189372548937245, "mean_inference_ms": 1.6198614615831315, "mean_action_processing_ms": 0.421962531035002, "mean_env_wait_ms": 1.30315352739719, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.060006141662597656, "StateBufferConnector_ms": 0.009516239166259766, "ViewRequirementAgentConnector_ms": 0.39137959480285645}, "num_episodes": 18, "episode_return_max": 1490.0, "episode_return_min": 110.0, "episode_return_mean": 617.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.44099009553505, "num_env_steps_trained_throughput_per_sec": 36.44099009553505, "timesteps_total": 504000, "num_env_steps_sampled_lifetime": 504000, "num_agent_steps_sampled_lifetime": 5040000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5040000, "timers": {"training_iteration_time_ms": 110151.223, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110151.175, "sample_time_ms": 2464.241, "learn_time_ms": 107666.842, "learn_throughput": 37.152, "synch_weights_time_ms": 11.57}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 5040000, "num_agent_steps_trained": 5040000}, "done": false, "training_iteration": 126, "trial_id": "57140_00000", "date": "2024-06-27_03-11-27", "timestamp": 1719472287, "time_this_iter_s": 109.7799711227417, "time_total_s": 14211.893799066544, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23a7160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14211.893799066544, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 15.573548387096771, "ram_util_percent": 78.46387096774194}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.446334374515901, "cur_kl_coeff": 14.997466798149965, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.002043338264839543, "vf_loss": 4.820199935200115, "vf_explained_var": -0.0002913920833660772, "kl": Infinity, "entropy": 0.3541121091451635, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1187835.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000}, "env_runners": {"episode_reward_max": 1470.0, "episode_reward_min": 110.0, "episode_reward_mean": 612.3, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -620.0}, "policy_reward_max": {"policy_0": 980.0}, "policy_reward_mean": {"policy_0": 61.23}, "custom_metrics": {}, "hist_stats": {"episode_reward": [950.0, 970.0, 190.0, 220.0, 350.0, 360.0, 600.0, 580.0, 680.0, 800.0, 770.0, 780.0, 490.0, 280.0, 710.0, 850.0, 885.0, 1050.0, 420.0, 655.0, 440.0, 120.0, 370.0, 360.0, 600.0, 380.0, 600.0, 790.0, 1470.0, 1230.0, 440.0, 370.0, 250.0, 620.0, 1230.0, 650.0, 630.0, 470.0, 360.0, 340.0, 760.0, 470.0, 1150.0, 745.0, 530.0, 1105.0, 850.0, 500.0, 1310.0, 520.0, 360.0, 305.0, 195.0, 250.0, 1090.0, 450.0, 1460.0, 280.0, 540.0, 1130.0, 165.0, 440.0, 470.0, 360.0, 1020.0, 290.0, 1420.0, 250.0, 340.0, 340.0, 430.0, 810.0, 725.0, 450.0, 230.0, 280.0, 440.0, 110.0, 200.0, 780.0, 360.0, 150.0, 1120.0, 1390.0, 960.0, 865.0, 170.0, 780.0, 1000.0, 630.0, 525.0, 1280.0, 130.0, 960.0, 340.0, 550.0, 490.0, 800.0, 600.0, 270.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 30.0, 40.0, 40.0, 760.0, 40.0, 160.0, 160.0, 50.0, 150.0, 80.0, 90.0, 80.0, 90.0, 70.0, 30.0, 10.0, 10.0, 0.0, 30.0, 20.0, 10.0, 10.0, 70.0, 0.0, 30.0, 10.0, 60.0, 10.0, 0.0, 20.0, 30.0, 10.0, 30.0, 20.0, 0.0, 20.0, 90.0, 40.0, 40.0, 70.0, 10.0, 0.0, 80.0, 0.0, 80.0, 20.0, 0.0, 10.0, 40.0, 0.0, 50.0, 0.0, 90.0, 70.0, 0.0, 250.0, 0.0, 30.0, 160.0, 50.0, 10.0, -50.0, 30.0, 120.0, 70.0, 0.0, 350.0, 70.0, 10.0, 0.0, 10.0, 0.0, 40.0, 30.0, 50.0, 0.0, -30.0, 60.0, 30.0, 0.0, 0.0, 410.0, 120.0, 40.0, 20.0, 0.0, 40.0, 80.0, 40.0, 570.0, 30.0, 0.0, 0.0, 20.0, 280.0, 20.0, 10.0, 40.0, 300.0, 30.0, 10.0, 0.0, 10.0, 70.0, 60.0, 30.0, 20.0, 10.0, 180.0, 160.0, 50.0, 0.0, 20.0, 250.0, 30.0, 20.0, 10.0, 20.0, 10.0, 250.0, 60.0, 20.0, 10.0, 60.0, 10.0, 10.0, 10.0, 10.0, 30.0, 10.0, 150.0, 40.0, 10.0, 0.0, -10.0, 370.0, -40.0, 20.0, 350.0, 0.0, 50.0, -40.0, 20.0, -10.0, 150.0, 80.0, -10.0, 40.0, 250.0, 70.0, 150.0, 80.0, 30.0, 10.0, 100.0, 30.0, 350.0, 270.0, 120.0, 20.0, 35.0, 10.0, -40.0, -10.0, 70.0, 70.0, 20.0, 160.0, 160.0, 20.0, 20.0, 20.0, 30.0, 480.0, 0.0, 30.0, 30.0, 0.0, 0.0, 70.0, 10.0, 40.0, 170.0, 70.0, 0.0, 0.0, 30.0, 5.0, 30.0, 10.0, 30.0, 30.0, 360.0, 160.0, 20.0, 40.0, 20.0, 160.0, 30.0, 20.0, 10.0, 20.0, 40.0, 80.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 10.0, 20.0, 30.0, 20.0, 40.0, 20.0, 40.0, 40.0, 110.0, 30.0, 40.0, 10.0, 20.0, 40.0, 30.0, 10.0, 20.0, 30.0, 10.0, 80.0, 40.0, 20.0, 80.0, 160.0, 20.0, 0.0, 50.0, 30.0, 20.0, 100.0, 30.0, 180.0, 10.0, 10.0, 10.0, 30.0, 0.0, 40.0, 50.0, 20.0, 150.0, 40.0, 30.0, 20.0, 30.0, 40.0, 80.0, 20.0, 0.0, 10.0, 210.0, 170.0, 20.0, 0.0, 20.0, 50.0, -50.0, 270.0, 50.0, 350.0, 60.0, -20.0, 60.0, 50.0, 30.0, 90.0, 100.0, 0.0, 490.0, 20.0, 200.0, 420.0, 70.0, 360.0, 30.0, 170.0, 110.0, 180.0, 10.0, 60.0, 250.0, 40.0, 20.0, 150.0, 30.0, 30.0, 0.0, 170.0, 10.0, 10.0, 0.0, 0.0, 40.0, 10.0, 20.0, 170.0, 0.0, 70.0, 40.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 30.0, 140.0, 20.0, 40.0, 0.0, 0.0, 20.0, 0.0, 100.0, 50.0, 30.0, 0.0, -10.0, 50.0, 260.0, 90.0, 30.0, 20.0, 50.0, 150.0, 110.0, 20.0, 50.0, 80.0, 60.0, 40.0, 460.0, 210.0, 100.0, 40.0, 110.0, 60.0, 100.0, 20.0, 70.0, 0.0, 110.0, 40.0, 10.0, 30.0, 380.0, 10.0, 30.0, 90.0, 40.0, 0.0, 0.0, 40.0, 10.0, 40.0, 0.0, 40.0, 20.0, 40.0, 30.0, 10.0, 250.0, 30.0, 40.0, 0.0, 0.0, 20.0, 0.0, 10.0, 70.0, 0.0, 40.0, 180.0, 10.0, 0.0, 0.0, 10.0, 50.0, 50.0, 160.0, 20.0, 40.0, 0.0, 70.0, 10.0, 10.0, 100.0, 190.0, 10.0, 50.0, 20.0, 30.0, 270.0, 40.0, 40.0, 10.0, 50.0, 40.0, 160.0, 10.0, 20.0, 20.0, 80.0, 20.0, -40.0, 140.0, 40.0, 70.0, -10.0, 820.0, 0.0, 30.0, 80.0, 20.0, 20.0, 260.0, 130.0, 0.0, 35.0, 40.0, 80.0, 10.0, 150.0, 70.0, 0.0, 90.0, 0.0, 150.0, 20.0, 20.0, 20.0, 30.0, 130.0, -130.0, 40.0, 30.0, 25.0, 770.0, 160.0, 20.0, 50.0, 70.0, 70.0, 20.0, 40.0, 30.0, 10.0, 10.0, 360.0, 120.0, 80.0, 110.0, 70.0, 10.0, 30.0, 0.0, 110.0, 30.0, 10.0, 60.0, 60.0, 20.0, 170.0, 60.0, -10.0, 50.0, 140.0, 80.0, 0.0, 10.0, 20.0, 580.0, 380.0, 80.0, 110.0, 10.0, 70.0, 210.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 40.0, 0.0, 20.0, 60.0, 90.0, 60.0, 20.0, 0.0, 40.0, 50.0, 0.0, 30.0, 170.0, 145.0, 0.0, -620.0, 70.0, 410.0, 50.0, 0.0, 10.0, 70.0, 10.0, 5.0, 40.0, 0.0, 40.0, 10.0, 10.0, 30.0, 10.0, 0.0, 60.0, 40.0, 20.0, 0.0, 30.0, 30.0, 30.0, 50.0, 40.0, 70.0, 10.0, 180.0, 0.0, 80.0, 660.0, 110.0, -110.0, 40.0, 30.0, 10.0, 10.0, 170.0, 150.0, -30.0, 30.0, 40.0, 0.0, 20.0, 20.0, 50.0, 980.0, 10.0, 80.0, 20.0, 40.0, 40.0, 200.0, 0.0, 40.0, 100.0, 20.0, 20.0, 20.0, 10.0, 40.0, 20.0, 10.0, 10.0, 160.0, 30.0, 40.0, 0.0, 40.0, 0.0, 180.0, 30.0, 50.0, 360.0, 30.0, 40.0, 20.0, 30.0, 40.0, 480.0, 90.0, 20.0, 20.0, 30.0, 0.0, 0.0, 20.0, 30.0, 10.0, 40.0, -5.0, 0.0, 40.0, 260.0, 30.0, 10.0, 0.0, 40.0, 20.0, 30.0, 20.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 310.0, 60.0, 40.0, 20.0, 0.0, 30.0, 370.0, 10.0, -20.0, 0.0, -50.0, 20.0, 0.0, 0.0, 20.0, 200.0, 80.0, 610.0, 0.0, 100.0, 20.0, 10.0, 20.0, -40.0, 10.0, 20.0, 10.0, 40.0, 0.0, 70.0, 0.0, 100.0, 40.0, 0.0, 50.0, 40.0, 950.0, 20.0, 30.0, 100.0, 40.0, 0.0, 40.0, 150.0, 60.0, 30.0, 20.0, 0.0, 30.0, 40.0, 0.0, 10.0, 40.0, 20.0, 30.0, 30.0, 50.0, 70.0, 40.0, 30.0, 30.0, 30.0, 20.0, 10.0, 60.0, 20.0, 30.0, 10.0, 40.0, 40.0, 40.0, 60.0, 40.0, 0.0, 0.0, 0.0, 150.0, 20.0, 10.0, 50.0, 10.0, 10.0, 10.0, 170.0, 60.0, 110.0, 30.0, 10.0, 130.0, 10.0, 40.0, -280.0, 570.0, 130.0, 155.0, 10.0, 260.0, 50.0, 40.0, 20.0, -20.0, 30.0, 10.0, 170.0, 0.0, 30.0, 40.0, 40.0, 50.0, 30.0, 150.0, 30.0, 50.0, 30.0, 0.0, 40.0, 100.0, 0.0, 20.0, 30.0, 20.0, 20.0, 0.0, 0.0, 50.0, 0.0, 0.0, 40.0, 40.0, 30.0, 50.0, 30.0, 20.0, 20.0, 130.0, 40.0, 20.0, 50.0, 0.0, 0.0, 20.0, 160.0, 20.0, 0.0, 30.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 30.0, 20.0, 0.0, 40.0, 10.0, 30.0, 10.0, 50.0, 250.0, 30.0, 30.0, 10.0, 20.0, 400.0, 60.0, -10.0, -30.0, 20.0, 0.0, 40.0, 160.0, 20.0, 10.0, 20.0, 40.0, 20.0, 10.0, 40.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 0.0, 20.0, 40.0, 20.0, 0.0, 580.0, 390.0, -20.0, -40.0, -50.0, 100.0, 40.0, 0.0, 120.0, 290.0, 10.0, 10.0, 100.0, 310.0, 70.0, 100.0, 70.0, 330.0, 100.0, 10.0, 110.0, 180.0, 40.0, 50.0, 40.0, 20.0, 190.0, 160.0, 160.0, 210.0, 0.0, 20.0, 0.0, 40.0, 40.0, 660.0, -50.0, -50.0, -5.0, 30.0, 0.0, 0.0, 20.0, 10.0, 10.0, 20.0, 60.0, 0.0, 20.0, -30.0, 0.0, 0.0, 390.0, -30.0, -40.0, 0.0, 30.0, -20.0, 480.0, 35.0, 130.0, 35.0, 170.0, 10.0, 40.0, 40.0, 380.0, 0.0, 160.0, 180.0, 10.0, 310.0, 40.0, 40.0, 0.0, 20.0, 70.0, 0.0, -40.0, 30.0, 80.0, 30.0, -10.0, 20.0, -20.0, 40.0, 260.0, 110.0, -15.0, 20.0, 200.0, 40.0, 40.0, 30.0, 0.0, 30.0, 360.0, 560.0, 0.0, 0.0, 0.0, 0.0, 10.0, 70.0, 0.0, 0.0, 0.0, 20.0, 30.0, 360.0, 30.0, 90.0, 220.0, 30.0, 60.0, 30.0, 20.0, 20.0, 100.0, 30.0, 30.0, 40.0, 0.0, 160.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 80.0, 20.0, 20.0, 30.0, 350.0, -30.0, 50.0, 10.0, 0.0, 20.0, 20.0, 80.0, 160.0, 40.0, 10.0, 30.0, 40.0, 90.0, -10.0, 100.0, 20.0, 260.0, 0.0, 70.0, 160.0, 170.0, 10.0, 20.0, 40.0, 30.0, 40.0, 170.0, 30.0, 60.0, 110.0, 30.0, 50.0, 40.0, 70.0, 20.0, 70.0, 80.0, 10.0, 10.0, 40.0, 10.0, -50.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4182222475866417, "mean_inference_ms": 1.6193405138912687, "mean_action_processing_ms": 0.4226865403527812, "mean_env_wait_ms": 1.3028184491268289, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06044173240661621, "StateBufferConnector_ms": 0.00955343246459961, "ViewRequirementAgentConnector_ms": 0.4006361961364746}, "num_episodes": 22, "episode_return_max": 1470.0, "episode_return_min": 110.0, "episode_return_mean": 612.3}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.3823958251477, "num_env_steps_trained_throughput_per_sec": 36.3823958251477, "timesteps_total": 508000, "num_env_steps_sampled_lifetime": 508000, "num_agent_steps_sampled_lifetime": 5080000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5080000, "timers": {"training_iteration_time_ms": 110048.599, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110048.552, "sample_time_ms": 2455.941, "learn_time_ms": 107572.721, "learn_throughput": 37.184, "synch_weights_time_ms": 11.241}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 5080000, "num_agent_steps_trained": 5080000}, "done": false, "training_iteration": 127, "trial_id": "57140_00000", "date": "2024-06-27_03-13-17", "timestamp": 1719472397, "time_this_iter_s": 109.95607900619507, "time_total_s": 14321.849878072739, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23fddc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14321.849878072739, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 15.252564102564103, "ram_util_percent": 78.37564102564103}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1383563316477754, "cur_kl_coeff": 22.496200197224955, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0015271130053641888, "vf_loss": 3.720004694149517, "vf_explained_var": -0.0005280993045709384, "kl": Infinity, "entropy": 0.37950825974011954, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1197225.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000}, "env_runners": {"episode_reward_max": 1470.0, "episode_reward_min": 110.0, "episode_reward_mean": 595.75, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -620.0}, "policy_reward_max": {"policy_0": 980.0}, "policy_reward_mean": {"policy_0": 59.575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [420.0, 655.0, 440.0, 120.0, 370.0, 360.0, 600.0, 380.0, 600.0, 790.0, 1470.0, 1230.0, 440.0, 370.0, 250.0, 620.0, 1230.0, 650.0, 630.0, 470.0, 360.0, 340.0, 760.0, 470.0, 1150.0, 745.0, 530.0, 1105.0, 850.0, 500.0, 1310.0, 520.0, 360.0, 305.0, 195.0, 250.0, 1090.0, 450.0, 1460.0, 280.0, 540.0, 1130.0, 165.0, 440.0, 470.0, 360.0, 1020.0, 290.0, 1420.0, 250.0, 340.0, 340.0, 430.0, 810.0, 725.0, 450.0, 230.0, 280.0, 440.0, 110.0, 200.0, 780.0, 360.0, 150.0, 1120.0, 1390.0, 960.0, 865.0, 170.0, 780.0, 1000.0, 630.0, 525.0, 1280.0, 130.0, 960.0, 340.0, 550.0, 490.0, 800.0, 600.0, 270.0, 370.0, 880.0, 260.0, 520.0, 380.0, 330.0, 640.0, 380.0, 850.0, 1160.0, 160.0, 235.0, 360.0, 990.0, 540.0, 1080.0, 550.0, 175.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 30.0, 30.0, 0.0, 0.0, 70.0, 10.0, 40.0, 170.0, 70.0, 0.0, 0.0, 30.0, 5.0, 30.0, 10.0, 30.0, 30.0, 360.0, 160.0, 20.0, 40.0, 20.0, 160.0, 30.0, 20.0, 10.0, 20.0, 40.0, 80.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 10.0, 20.0, 30.0, 20.0, 40.0, 20.0, 40.0, 40.0, 110.0, 30.0, 40.0, 10.0, 20.0, 40.0, 30.0, 10.0, 20.0, 30.0, 10.0, 80.0, 40.0, 20.0, 80.0, 160.0, 20.0, 0.0, 50.0, 30.0, 20.0, 100.0, 30.0, 180.0, 10.0, 10.0, 10.0, 30.0, 0.0, 40.0, 50.0, 20.0, 150.0, 40.0, 30.0, 20.0, 30.0, 40.0, 80.0, 20.0, 0.0, 10.0, 210.0, 170.0, 20.0, 0.0, 20.0, 50.0, -50.0, 270.0, 50.0, 350.0, 60.0, -20.0, 60.0, 50.0, 30.0, 90.0, 100.0, 0.0, 490.0, 20.0, 200.0, 420.0, 70.0, 360.0, 30.0, 170.0, 110.0, 180.0, 10.0, 60.0, 250.0, 40.0, 20.0, 150.0, 30.0, 30.0, 0.0, 170.0, 10.0, 10.0, 0.0, 0.0, 40.0, 10.0, 20.0, 170.0, 0.0, 70.0, 40.0, 0.0, 10.0, 20.0, 30.0, 0.0, 0.0, 30.0, 140.0, 20.0, 40.0, 0.0, 0.0, 20.0, 0.0, 100.0, 50.0, 30.0, 0.0, -10.0, 50.0, 260.0, 90.0, 30.0, 20.0, 50.0, 150.0, 110.0, 20.0, 50.0, 80.0, 60.0, 40.0, 460.0, 210.0, 100.0, 40.0, 110.0, 60.0, 100.0, 20.0, 70.0, 0.0, 110.0, 40.0, 10.0, 30.0, 380.0, 10.0, 30.0, 90.0, 40.0, 0.0, 0.0, 40.0, 10.0, 40.0, 0.0, 40.0, 20.0, 40.0, 30.0, 10.0, 250.0, 30.0, 40.0, 0.0, 0.0, 20.0, 0.0, 10.0, 70.0, 0.0, 40.0, 180.0, 10.0, 0.0, 0.0, 10.0, 50.0, 50.0, 160.0, 20.0, 40.0, 0.0, 70.0, 10.0, 10.0, 100.0, 190.0, 10.0, 50.0, 20.0, 30.0, 270.0, 40.0, 40.0, 10.0, 50.0, 40.0, 160.0, 10.0, 20.0, 20.0, 80.0, 20.0, -40.0, 140.0, 40.0, 70.0, -10.0, 820.0, 0.0, 30.0, 80.0, 20.0, 20.0, 260.0, 130.0, 0.0, 35.0, 40.0, 80.0, 10.0, 150.0, 70.0, 0.0, 90.0, 0.0, 150.0, 20.0, 20.0, 20.0, 30.0, 130.0, -130.0, 40.0, 30.0, 25.0, 770.0, 160.0, 20.0, 50.0, 70.0, 70.0, 20.0, 40.0, 30.0, 10.0, 10.0, 360.0, 120.0, 80.0, 110.0, 70.0, 10.0, 30.0, 0.0, 110.0, 30.0, 10.0, 60.0, 60.0, 20.0, 170.0, 60.0, -10.0, 50.0, 140.0, 80.0, 0.0, 10.0, 20.0, 580.0, 380.0, 80.0, 110.0, 10.0, 70.0, 210.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 40.0, 0.0, 20.0, 60.0, 90.0, 60.0, 20.0, 0.0, 40.0, 50.0, 0.0, 30.0, 170.0, 145.0, 0.0, -620.0, 70.0, 410.0, 50.0, 0.0, 10.0, 70.0, 10.0, 5.0, 40.0, 0.0, 40.0, 10.0, 10.0, 30.0, 10.0, 0.0, 60.0, 40.0, 20.0, 0.0, 30.0, 30.0, 30.0, 50.0, 40.0, 70.0, 10.0, 180.0, 0.0, 80.0, 660.0, 110.0, -110.0, 40.0, 30.0, 10.0, 10.0, 170.0, 150.0, -30.0, 30.0, 40.0, 0.0, 20.0, 20.0, 50.0, 980.0, 10.0, 80.0, 20.0, 40.0, 40.0, 200.0, 0.0, 40.0, 100.0, 20.0, 20.0, 20.0, 10.0, 40.0, 20.0, 10.0, 10.0, 160.0, 30.0, 40.0, 0.0, 40.0, 0.0, 180.0, 30.0, 50.0, 360.0, 30.0, 40.0, 20.0, 30.0, 40.0, 480.0, 90.0, 20.0, 20.0, 30.0, 0.0, 0.0, 20.0, 30.0, 10.0, 40.0, -5.0, 0.0, 40.0, 260.0, 30.0, 10.0, 0.0, 40.0, 20.0, 30.0, 20.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 310.0, 60.0, 40.0, 20.0, 0.0, 30.0, 370.0, 10.0, -20.0, 0.0, -50.0, 20.0, 0.0, 0.0, 20.0, 200.0, 80.0, 610.0, 0.0, 100.0, 20.0, 10.0, 20.0, -40.0, 10.0, 20.0, 10.0, 40.0, 0.0, 70.0, 0.0, 100.0, 40.0, 0.0, 50.0, 40.0, 950.0, 20.0, 30.0, 100.0, 40.0, 0.0, 40.0, 150.0, 60.0, 30.0, 20.0, 0.0, 30.0, 40.0, 0.0, 10.0, 40.0, 20.0, 30.0, 30.0, 50.0, 70.0, 40.0, 30.0, 30.0, 30.0, 20.0, 10.0, 60.0, 20.0, 30.0, 10.0, 40.0, 40.0, 40.0, 60.0, 40.0, 0.0, 0.0, 0.0, 150.0, 20.0, 10.0, 50.0, 10.0, 10.0, 10.0, 170.0, 60.0, 110.0, 30.0, 10.0, 130.0, 10.0, 40.0, -280.0, 570.0, 130.0, 155.0, 10.0, 260.0, 50.0, 40.0, 20.0, -20.0, 30.0, 10.0, 170.0, 0.0, 30.0, 40.0, 40.0, 50.0, 30.0, 150.0, 30.0, 50.0, 30.0, 0.0, 40.0, 100.0, 0.0, 20.0, 30.0, 20.0, 20.0, 0.0, 0.0, 50.0, 0.0, 0.0, 40.0, 40.0, 30.0, 50.0, 30.0, 20.0, 20.0, 130.0, 40.0, 20.0, 50.0, 0.0, 0.0, 20.0, 160.0, 20.0, 0.0, 30.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 30.0, 20.0, 0.0, 40.0, 10.0, 30.0, 10.0, 50.0, 250.0, 30.0, 30.0, 10.0, 20.0, 400.0, 60.0, -10.0, -30.0, 20.0, 0.0, 40.0, 160.0, 20.0, 10.0, 20.0, 40.0, 20.0, 10.0, 40.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 0.0, 20.0, 40.0, 20.0, 0.0, 580.0, 390.0, -20.0, -40.0, -50.0, 100.0, 40.0, 0.0, 120.0, 290.0, 10.0, 10.0, 100.0, 310.0, 70.0, 100.0, 70.0, 330.0, 100.0, 10.0, 110.0, 180.0, 40.0, 50.0, 40.0, 20.0, 190.0, 160.0, 160.0, 210.0, 0.0, 20.0, 0.0, 40.0, 40.0, 660.0, -50.0, -50.0, -5.0, 30.0, 0.0, 0.0, 20.0, 10.0, 10.0, 20.0, 60.0, 0.0, 20.0, -30.0, 0.0, 0.0, 390.0, -30.0, -40.0, 0.0, 30.0, -20.0, 480.0, 35.0, 130.0, 35.0, 170.0, 10.0, 40.0, 40.0, 380.0, 0.0, 160.0, 180.0, 10.0, 310.0, 40.0, 40.0, 0.0, 20.0, 70.0, 0.0, -40.0, 30.0, 80.0, 30.0, -10.0, 20.0, -20.0, 40.0, 260.0, 110.0, -15.0, 20.0, 200.0, 40.0, 40.0, 30.0, 0.0, 30.0, 360.0, 560.0, 0.0, 0.0, 0.0, 0.0, 10.0, 70.0, 0.0, 0.0, 0.0, 20.0, 30.0, 360.0, 30.0, 90.0, 220.0, 30.0, 60.0, 30.0, 20.0, 20.0, 100.0, 30.0, 30.0, 40.0, 0.0, 160.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 80.0, 20.0, 20.0, 30.0, 350.0, -30.0, 50.0, 10.0, 0.0, 20.0, 20.0, 80.0, 160.0, 40.0, 10.0, 30.0, 40.0, 90.0, -10.0, 100.0, 20.0, 260.0, 0.0, 70.0, 160.0, 170.0, 10.0, 20.0, 40.0, 30.0, 40.0, 170.0, 30.0, 60.0, 110.0, 30.0, 50.0, 40.0, 70.0, 20.0, 70.0, 80.0, 10.0, 10.0, 40.0, 10.0, -50.0, 10.0, 60.0, 30.0, 10.0, 10.0, 20.0, 70.0, 90.0, 80.0, 0.0, 0.0, 180.0, 0.0, 500.0, 20.0, 0.0, 60.0, 40.0, 30.0, 40.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 30.0, 20.0, 160.0, 10.0, 190.0, 50.0, 160.0, 0.0, 0.0, 30.0, 30.0, 0.0, 50.0, 30.0, 30.0, 20.0, 180.0, 50.0, 30.0, 20.0, 0.0, 10.0, 10.0, 150.0, 10.0, 20.0, 30.0, 40.0, 10.0, 40.0, 10.0, 0.0, 20.0, 60.0, 10.0, 260.0, 60.0, 40.0, 90.0, 60.0, 40.0, 20.0, 0.0, 180.0, 10.0, 20.0, 90.0, 0.0, 30.0, 10.0, 0.0, 0.0, 40.0, 260.0, 140.0, 0.0, 20.0, 300.0, 50.0, 20.0, 20.0, 0.0, 40.0, 10.0, 20.0, 40.0, 100.0, 90.0, 160.0, 510.0, 190.0, 10.0, 30.0, 0.0, 60.0, 0.0, 40.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 90.0, 10.0, 20.0, 20.0, 30.0, 10.0, 15.0, 20.0, 80.0, 40.0, 20.0, 0.0, 0.0, 110.0, 0.0, 10.0, 30.0, 70.0, 190.0, 50.0, 110.0, 150.0, 180.0, 20.0, 10.0, 90.0, 0.0, 190.0, 40.0, 20.0, 0.0, 210.0, 40.0, 100.0, 40.0, 30.0, 30.0, 30.0, 790.0, 30.0, 160.0, 0.0, 20.0, 20.0, 20.0, 0.0, 30.0, 10.0, 20.0, 40.0, 60.0, 190.0, 10.0, 0.0, 10.0, 0.0, 190.0, 30.0, 30.0, 30.0, 20.0, 0.0, 20.0, 20.0, 5.0, 0.0, 20.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4174250749046349, "mean_inference_ms": 1.6185163872176616, "mean_action_processing_ms": 0.4224577208750183, "mean_env_wait_ms": 1.3022901202225454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05533933639526367, "StateBufferConnector_ms": 0.009445428848266602, "ViewRequirementAgentConnector_ms": 0.37673425674438477}, "num_episodes": 18, "episode_return_max": 1470.0, "episode_return_min": 110.0, "episode_return_mean": 595.75}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.33298417562012, "num_env_steps_trained_throughput_per_sec": 36.33298417562012, "timesteps_total": 512000, "num_env_steps_sampled_lifetime": 512000, "num_agent_steps_sampled_lifetime": 5120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5120000, "timers": {"training_iteration_time_ms": 110021.853, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110021.806, "sample_time_ms": 2454.676, "learn_time_ms": 107547.293, "learn_throughput": 37.193, "synch_weights_time_ms": 11.082}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 5120000, "num_agent_steps_trained": 5120000}, "done": false, "training_iteration": 128, "trial_id": "57140_00000", "date": "2024-06-27_03-15-07", "timestamp": 1719472507, "time_this_iter_s": 110.107656955719, "time_total_s": 14431.957535028458, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b25c8f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14431.957535028458, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 15.315384615384614, "ram_util_percent": 78.28333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.231444965117275, "cur_kl_coeff": 33.744300295837434, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0008584350375042033, "vf_loss": 4.628129576748044, "vf_explained_var": 0.0002529499566339202, "kl": Infinity, "entropy": 0.3764959064202187, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1206615.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000}, "env_runners": {"episode_reward_max": 1460.0, "episode_reward_min": 110.0, "episode_reward_mean": 575.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -620.0}, "policy_reward_max": {"policy_0": 980.0}, "policy_reward_mean": {"policy_0": 57.535}, "custom_metrics": {}, "hist_stats": {"episode_reward": [630.0, 470.0, 360.0, 340.0, 760.0, 470.0, 1150.0, 745.0, 530.0, 1105.0, 850.0, 500.0, 1310.0, 520.0, 360.0, 305.0, 195.0, 250.0, 1090.0, 450.0, 1460.0, 280.0, 540.0, 1130.0, 165.0, 440.0, 470.0, 360.0, 1020.0, 290.0, 1420.0, 250.0, 340.0, 340.0, 430.0, 810.0, 725.0, 450.0, 230.0, 280.0, 440.0, 110.0, 200.0, 780.0, 360.0, 150.0, 1120.0, 1390.0, 960.0, 865.0, 170.0, 780.0, 1000.0, 630.0, 525.0, 1280.0, 130.0, 960.0, 340.0, 550.0, 490.0, 800.0, 600.0, 270.0, 370.0, 880.0, 260.0, 520.0, 380.0, 330.0, 640.0, 380.0, 850.0, 1160.0, 160.0, 235.0, 360.0, 990.0, 540.0, 1080.0, 550.0, 175.0, 1300.0, 370.0, 415.0, 590.0, 1340.0, 450.0, 200.0, 410.0, 220.0, 120.0, 380.0, 450.0, 230.0, 1030.0, 170.0, 310.0, 670.0, 300.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 30.0, 380.0, 10.0, 30.0, 90.0, 40.0, 0.0, 0.0, 40.0, 10.0, 40.0, 0.0, 40.0, 20.0, 40.0, 30.0, 10.0, 250.0, 30.0, 40.0, 0.0, 0.0, 20.0, 0.0, 10.0, 70.0, 0.0, 40.0, 180.0, 10.0, 0.0, 0.0, 10.0, 50.0, 50.0, 160.0, 20.0, 40.0, 0.0, 70.0, 10.0, 10.0, 100.0, 190.0, 10.0, 50.0, 20.0, 30.0, 270.0, 40.0, 40.0, 10.0, 50.0, 40.0, 160.0, 10.0, 20.0, 20.0, 80.0, 20.0, -40.0, 140.0, 40.0, 70.0, -10.0, 820.0, 0.0, 30.0, 80.0, 20.0, 20.0, 260.0, 130.0, 0.0, 35.0, 40.0, 80.0, 10.0, 150.0, 70.0, 0.0, 90.0, 0.0, 150.0, 20.0, 20.0, 20.0, 30.0, 130.0, -130.0, 40.0, 30.0, 25.0, 770.0, 160.0, 20.0, 50.0, 70.0, 70.0, 20.0, 40.0, 30.0, 10.0, 10.0, 360.0, 120.0, 80.0, 110.0, 70.0, 10.0, 30.0, 0.0, 110.0, 30.0, 10.0, 60.0, 60.0, 20.0, 170.0, 60.0, -10.0, 50.0, 140.0, 80.0, 0.0, 10.0, 20.0, 580.0, 380.0, 80.0, 110.0, 10.0, 70.0, 210.0, 0.0, 10.0, 20.0, 0.0, 10.0, 30.0, 40.0, 0.0, 20.0, 60.0, 90.0, 60.0, 20.0, 0.0, 40.0, 50.0, 0.0, 30.0, 170.0, 145.0, 0.0, -620.0, 70.0, 410.0, 50.0, 0.0, 10.0, 70.0, 10.0, 5.0, 40.0, 0.0, 40.0, 10.0, 10.0, 30.0, 10.0, 0.0, 60.0, 40.0, 20.0, 0.0, 30.0, 30.0, 30.0, 50.0, 40.0, 70.0, 10.0, 180.0, 0.0, 80.0, 660.0, 110.0, -110.0, 40.0, 30.0, 10.0, 10.0, 170.0, 150.0, -30.0, 30.0, 40.0, 0.0, 20.0, 20.0, 50.0, 980.0, 10.0, 80.0, 20.0, 40.0, 40.0, 200.0, 0.0, 40.0, 100.0, 20.0, 20.0, 20.0, 10.0, 40.0, 20.0, 10.0, 10.0, 160.0, 30.0, 40.0, 0.0, 40.0, 0.0, 180.0, 30.0, 50.0, 360.0, 30.0, 40.0, 20.0, 30.0, 40.0, 480.0, 90.0, 20.0, 20.0, 30.0, 0.0, 0.0, 20.0, 30.0, 10.0, 40.0, -5.0, 0.0, 40.0, 260.0, 30.0, 10.0, 0.0, 40.0, 20.0, 30.0, 20.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 310.0, 60.0, 40.0, 20.0, 0.0, 30.0, 370.0, 10.0, -20.0, 0.0, -50.0, 20.0, 0.0, 0.0, 20.0, 200.0, 80.0, 610.0, 0.0, 100.0, 20.0, 10.0, 20.0, -40.0, 10.0, 20.0, 10.0, 40.0, 0.0, 70.0, 0.0, 100.0, 40.0, 0.0, 50.0, 40.0, 950.0, 20.0, 30.0, 100.0, 40.0, 0.0, 40.0, 150.0, 60.0, 30.0, 20.0, 0.0, 30.0, 40.0, 0.0, 10.0, 40.0, 20.0, 30.0, 30.0, 50.0, 70.0, 40.0, 30.0, 30.0, 30.0, 20.0, 10.0, 60.0, 20.0, 30.0, 10.0, 40.0, 40.0, 40.0, 60.0, 40.0, 0.0, 0.0, 0.0, 150.0, 20.0, 10.0, 50.0, 10.0, 10.0, 10.0, 170.0, 60.0, 110.0, 30.0, 10.0, 130.0, 10.0, 40.0, -280.0, 570.0, 130.0, 155.0, 10.0, 260.0, 50.0, 40.0, 20.0, -20.0, 30.0, 10.0, 170.0, 0.0, 30.0, 40.0, 40.0, 50.0, 30.0, 150.0, 30.0, 50.0, 30.0, 0.0, 40.0, 100.0, 0.0, 20.0, 30.0, 20.0, 20.0, 0.0, 0.0, 50.0, 0.0, 0.0, 40.0, 40.0, 30.0, 50.0, 30.0, 20.0, 20.0, 130.0, 40.0, 20.0, 50.0, 0.0, 0.0, 20.0, 160.0, 20.0, 0.0, 30.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 30.0, 20.0, 0.0, 40.0, 10.0, 30.0, 10.0, 50.0, 250.0, 30.0, 30.0, 10.0, 20.0, 400.0, 60.0, -10.0, -30.0, 20.0, 0.0, 40.0, 160.0, 20.0, 10.0, 20.0, 40.0, 20.0, 10.0, 40.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 0.0, 20.0, 40.0, 20.0, 0.0, 580.0, 390.0, -20.0, -40.0, -50.0, 100.0, 40.0, 0.0, 120.0, 290.0, 10.0, 10.0, 100.0, 310.0, 70.0, 100.0, 70.0, 330.0, 100.0, 10.0, 110.0, 180.0, 40.0, 50.0, 40.0, 20.0, 190.0, 160.0, 160.0, 210.0, 0.0, 20.0, 0.0, 40.0, 40.0, 660.0, -50.0, -50.0, -5.0, 30.0, 0.0, 0.0, 20.0, 10.0, 10.0, 20.0, 60.0, 0.0, 20.0, -30.0, 0.0, 0.0, 390.0, -30.0, -40.0, 0.0, 30.0, -20.0, 480.0, 35.0, 130.0, 35.0, 170.0, 10.0, 40.0, 40.0, 380.0, 0.0, 160.0, 180.0, 10.0, 310.0, 40.0, 40.0, 0.0, 20.0, 70.0, 0.0, -40.0, 30.0, 80.0, 30.0, -10.0, 20.0, -20.0, 40.0, 260.0, 110.0, -15.0, 20.0, 200.0, 40.0, 40.0, 30.0, 0.0, 30.0, 360.0, 560.0, 0.0, 0.0, 0.0, 0.0, 10.0, 70.0, 0.0, 0.0, 0.0, 20.0, 30.0, 360.0, 30.0, 90.0, 220.0, 30.0, 60.0, 30.0, 20.0, 20.0, 100.0, 30.0, 30.0, 40.0, 0.0, 160.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 80.0, 20.0, 20.0, 30.0, 350.0, -30.0, 50.0, 10.0, 0.0, 20.0, 20.0, 80.0, 160.0, 40.0, 10.0, 30.0, 40.0, 90.0, -10.0, 100.0, 20.0, 260.0, 0.0, 70.0, 160.0, 170.0, 10.0, 20.0, 40.0, 30.0, 40.0, 170.0, 30.0, 60.0, 110.0, 30.0, 50.0, 40.0, 70.0, 20.0, 70.0, 80.0, 10.0, 10.0, 40.0, 10.0, -50.0, 10.0, 60.0, 30.0, 10.0, 10.0, 20.0, 70.0, 90.0, 80.0, 0.0, 0.0, 180.0, 0.0, 500.0, 20.0, 0.0, 60.0, 40.0, 30.0, 40.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 30.0, 20.0, 160.0, 10.0, 190.0, 50.0, 160.0, 0.0, 0.0, 30.0, 30.0, 0.0, 50.0, 30.0, 30.0, 20.0, 180.0, 50.0, 30.0, 20.0, 0.0, 10.0, 10.0, 150.0, 10.0, 20.0, 30.0, 40.0, 10.0, 40.0, 10.0, 0.0, 20.0, 60.0, 10.0, 260.0, 60.0, 40.0, 90.0, 60.0, 40.0, 20.0, 0.0, 180.0, 10.0, 20.0, 90.0, 0.0, 30.0, 10.0, 0.0, 0.0, 40.0, 260.0, 140.0, 0.0, 20.0, 300.0, 50.0, 20.0, 20.0, 0.0, 40.0, 10.0, 20.0, 40.0, 100.0, 90.0, 160.0, 510.0, 190.0, 10.0, 30.0, 0.0, 60.0, 0.0, 40.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 90.0, 10.0, 20.0, 20.0, 30.0, 10.0, 15.0, 20.0, 80.0, 40.0, 20.0, 0.0, 0.0, 110.0, 0.0, 10.0, 30.0, 70.0, 190.0, 50.0, 110.0, 150.0, 180.0, 20.0, 10.0, 90.0, 0.0, 190.0, 40.0, 20.0, 0.0, 210.0, 40.0, 100.0, 40.0, 30.0, 30.0, 30.0, 790.0, 30.0, 160.0, 0.0, 20.0, 20.0, 20.0, 0.0, 30.0, 10.0, 20.0, 40.0, 60.0, 190.0, 10.0, 0.0, 10.0, 0.0, 190.0, 30.0, 30.0, 30.0, 20.0, 0.0, 20.0, 20.0, 5.0, 0.0, 20.0, 30.0, 770.0, 90.0, 90.0, 10.0, 20.0, 160.0, 50.0, 30.0, 20.0, 60.0, 170.0, 0.0, 0.0, 60.0, 0.0, 60.0, 30.0, 40.0, 0.0, 10.0, 10.0, 0.0, 20.0, 30.0, 40.0, 110.0, 0.0, 45.0, 120.0, 40.0, 0.0, 70.0, 60.0, 170.0, 20.0, 20.0, 160.0, 50.0, 10.0, 30.0, 30.0, 20.0, 30.0, 90.0, 160.0, 10.0, 380.0, 80.0, 60.0, 480.0, 30.0, 60.0, 40.0, 30.0, 150.0, 10.0, 30.0, 10.0, 40.0, 50.0, 10.0, 20.0, 20.0, 0.0, 0.0, 10.0, 40.0, 40.0, 40.0, 20.0, 60.0, 10.0, 90.0, 50.0, 0.0, 30.0, 0.0, 150.0, 0.0, 20.0, 40.0, 30.0, 20.0, 40.0, 20.0, 10.0, 40.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 70.0, 10.0, 30.0, 20.0, 20.0, 10.0, 70.0, 40.0, 90.0, 70.0, 20.0, 10.0, 0.0, 50.0, 20.0, 30.0, 0.0, 150.0, 10.0, 70.0, 110.0, 20.0, 50.0, 0.0, 10.0, 10.0, 0.0, 10.0, 40.0, 0.0, 90.0, 260.0, 50.0, 40.0, 20.0, 260.0, 50.0, 60.0, 200.0, 10.0, 80.0, 40.0, 0.0, 20.0, 20.0, 10.0, 40.0, 10.0, 20.0, 0.0, 10.0, 30.0, 0.0, 20.0, 10.0, 0.0, 10.0, 30.0, 70.0, 10.0, 130.0, 190.0, 270.0, 10.0, 30.0, 10.0, 10.0, 40.0, 80.0, 10.0, 20.0, 20.0, 40.0, 10.0, 10.0, 40.0, 10.0, 0.0, 20.0, 170.0, -20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4167163749188836, "mean_inference_ms": 1.6177456836095578, "mean_action_processing_ms": 0.42219841727182694, "mean_env_wait_ms": 1.3017805714821575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055280447006225586, "StateBufferConnector_ms": 0.009365081787109375, "ViewRequirementAgentConnector_ms": 0.3714127540588379}, "num_episodes": 18, "episode_return_max": 1460.0, "episode_return_min": 110.0, "episode_return_mean": 575.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.322720407827994, "num_env_steps_trained_throughput_per_sec": 36.322720407827994, "timesteps_total": 516000, "num_env_steps_sampled_lifetime": 516000, "num_agent_steps_sampled_lifetime": 5160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5160000, "timers": {"training_iteration_time_ms": 110098.91, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110098.862, "sample_time_ms": 2459.804, "learn_time_ms": 107619.065, "learn_throughput": 37.168, "synch_weights_time_ms": 11.405}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 5160000, "num_agent_steps_trained": 5160000}, "done": false, "training_iteration": 129, "trial_id": "57140_00000", "date": "2024-06-27_03-16-57", "timestamp": 1719472617, "time_this_iter_s": 110.13546800613403, "time_total_s": 14542.093003034592, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b1964a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14542.093003034592, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 15.419999999999996, "ram_util_percent": 78.37483870967742}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.7815505442147055, "cur_kl_coeff": 50.616450443756136, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.403337232957379, "policy_loss": -0.0008059636386472403, "vf_loss": 4.402029916475883, "vf_explained_var": 0.000855629963361925, "kl": 4.1750744011235675e-05, "entropy": 0.3824265891561112, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1216005.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000}, "env_runners": {"episode_reward_max": 1420.0, "episode_reward_min": 110.0, "episode_reward_mean": 564.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -280.0}, "policy_reward_max": {"policy_0": 950.0}, "policy_reward_mean": {"policy_0": 56.41}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1130.0, 165.0, 440.0, 470.0, 360.0, 1020.0, 290.0, 1420.0, 250.0, 340.0, 340.0, 430.0, 810.0, 725.0, 450.0, 230.0, 280.0, 440.0, 110.0, 200.0, 780.0, 360.0, 150.0, 1120.0, 1390.0, 960.0, 865.0, 170.0, 780.0, 1000.0, 630.0, 525.0, 1280.0, 130.0, 960.0, 340.0, 550.0, 490.0, 800.0, 600.0, 270.0, 370.0, 880.0, 260.0, 520.0, 380.0, 330.0, 640.0, 380.0, 850.0, 1160.0, 160.0, 235.0, 360.0, 990.0, 540.0, 1080.0, 550.0, 175.0, 1300.0, 370.0, 415.0, 590.0, 1340.0, 450.0, 200.0, 410.0, 220.0, 120.0, 380.0, 450.0, 230.0, 1030.0, 170.0, 310.0, 670.0, 300.0, 280.0, 1240.0, 260.0, 400.0, 570.0, 730.0, 440.0, 810.0, 1020.0, 180.0, 990.0, 390.0, 430.0, 200.0, 1300.0, 700.0, 460.0, 450.0, 500.0, 695.0, 880.0, 210.0, 410.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [360.0, 30.0, 40.0, 20.0, 30.0, 40.0, 480.0, 90.0, 20.0, 20.0, 30.0, 0.0, 0.0, 20.0, 30.0, 10.0, 40.0, -5.0, 0.0, 40.0, 260.0, 30.0, 10.0, 0.0, 40.0, 20.0, 30.0, 20.0, 0.0, 30.0, 0.0, 0.0, 10.0, 0.0, 10.0, 20.0, 310.0, 60.0, 40.0, 20.0, 0.0, 30.0, 370.0, 10.0, -20.0, 0.0, -50.0, 20.0, 0.0, 0.0, 20.0, 200.0, 80.0, 610.0, 0.0, 100.0, 20.0, 10.0, 20.0, -40.0, 10.0, 20.0, 10.0, 40.0, 0.0, 70.0, 0.0, 100.0, 40.0, 0.0, 50.0, 40.0, 950.0, 20.0, 30.0, 100.0, 40.0, 0.0, 40.0, 150.0, 60.0, 30.0, 20.0, 0.0, 30.0, 40.0, 0.0, 10.0, 40.0, 20.0, 30.0, 30.0, 50.0, 70.0, 40.0, 30.0, 30.0, 30.0, 20.0, 10.0, 60.0, 20.0, 30.0, 10.0, 40.0, 40.0, 40.0, 60.0, 40.0, 0.0, 0.0, 0.0, 150.0, 20.0, 10.0, 50.0, 10.0, 10.0, 10.0, 170.0, 60.0, 110.0, 30.0, 10.0, 130.0, 10.0, 40.0, -280.0, 570.0, 130.0, 155.0, 10.0, 260.0, 50.0, 40.0, 20.0, -20.0, 30.0, 10.0, 170.0, 0.0, 30.0, 40.0, 40.0, 50.0, 30.0, 150.0, 30.0, 50.0, 30.0, 0.0, 40.0, 100.0, 0.0, 20.0, 30.0, 20.0, 20.0, 0.0, 0.0, 50.0, 0.0, 0.0, 40.0, 40.0, 30.0, 50.0, 30.0, 20.0, 20.0, 130.0, 40.0, 20.0, 50.0, 0.0, 0.0, 20.0, 160.0, 20.0, 0.0, 30.0, 20.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 0.0, 0.0, 10.0, 0.0, 30.0, 20.0, 0.0, 40.0, 10.0, 30.0, 10.0, 50.0, 250.0, 30.0, 30.0, 10.0, 20.0, 400.0, 60.0, -10.0, -30.0, 20.0, 0.0, 40.0, 160.0, 20.0, 10.0, 20.0, 40.0, 20.0, 10.0, 40.0, 20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 0.0, 20.0, 40.0, 20.0, 0.0, 580.0, 390.0, -20.0, -40.0, -50.0, 100.0, 40.0, 0.0, 120.0, 290.0, 10.0, 10.0, 100.0, 310.0, 70.0, 100.0, 70.0, 330.0, 100.0, 10.0, 110.0, 180.0, 40.0, 50.0, 40.0, 20.0, 190.0, 160.0, 160.0, 210.0, 0.0, 20.0, 0.0, 40.0, 40.0, 660.0, -50.0, -50.0, -5.0, 30.0, 0.0, 0.0, 20.0, 10.0, 10.0, 20.0, 60.0, 0.0, 20.0, -30.0, 0.0, 0.0, 390.0, -30.0, -40.0, 0.0, 30.0, -20.0, 480.0, 35.0, 130.0, 35.0, 170.0, 10.0, 40.0, 40.0, 380.0, 0.0, 160.0, 180.0, 10.0, 310.0, 40.0, 40.0, 0.0, 20.0, 70.0, 0.0, -40.0, 30.0, 80.0, 30.0, -10.0, 20.0, -20.0, 40.0, 260.0, 110.0, -15.0, 20.0, 200.0, 40.0, 40.0, 30.0, 0.0, 30.0, 360.0, 560.0, 0.0, 0.0, 0.0, 0.0, 10.0, 70.0, 0.0, 0.0, 0.0, 20.0, 30.0, 360.0, 30.0, 90.0, 220.0, 30.0, 60.0, 30.0, 20.0, 20.0, 100.0, 30.0, 30.0, 40.0, 0.0, 160.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 80.0, 20.0, 20.0, 30.0, 350.0, -30.0, 50.0, 10.0, 0.0, 20.0, 20.0, 80.0, 160.0, 40.0, 10.0, 30.0, 40.0, 90.0, -10.0, 100.0, 20.0, 260.0, 0.0, 70.0, 160.0, 170.0, 10.0, 20.0, 40.0, 30.0, 40.0, 170.0, 30.0, 60.0, 110.0, 30.0, 50.0, 40.0, 70.0, 20.0, 70.0, 80.0, 10.0, 10.0, 40.0, 10.0, -50.0, 10.0, 60.0, 30.0, 10.0, 10.0, 20.0, 70.0, 90.0, 80.0, 0.0, 0.0, 180.0, 0.0, 500.0, 20.0, 0.0, 60.0, 40.0, 30.0, 40.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 30.0, 20.0, 160.0, 10.0, 190.0, 50.0, 160.0, 0.0, 0.0, 30.0, 30.0, 0.0, 50.0, 30.0, 30.0, 20.0, 180.0, 50.0, 30.0, 20.0, 0.0, 10.0, 10.0, 150.0, 10.0, 20.0, 30.0, 40.0, 10.0, 40.0, 10.0, 0.0, 20.0, 60.0, 10.0, 260.0, 60.0, 40.0, 90.0, 60.0, 40.0, 20.0, 0.0, 180.0, 10.0, 20.0, 90.0, 0.0, 30.0, 10.0, 0.0, 0.0, 40.0, 260.0, 140.0, 0.0, 20.0, 300.0, 50.0, 20.0, 20.0, 0.0, 40.0, 10.0, 20.0, 40.0, 100.0, 90.0, 160.0, 510.0, 190.0, 10.0, 30.0, 0.0, 60.0, 0.0, 40.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 90.0, 10.0, 20.0, 20.0, 30.0, 10.0, 15.0, 20.0, 80.0, 40.0, 20.0, 0.0, 0.0, 110.0, 0.0, 10.0, 30.0, 70.0, 190.0, 50.0, 110.0, 150.0, 180.0, 20.0, 10.0, 90.0, 0.0, 190.0, 40.0, 20.0, 0.0, 210.0, 40.0, 100.0, 40.0, 30.0, 30.0, 30.0, 790.0, 30.0, 160.0, 0.0, 20.0, 20.0, 20.0, 0.0, 30.0, 10.0, 20.0, 40.0, 60.0, 190.0, 10.0, 0.0, 10.0, 0.0, 190.0, 30.0, 30.0, 30.0, 20.0, 0.0, 20.0, 20.0, 5.0, 0.0, 20.0, 30.0, 770.0, 90.0, 90.0, 10.0, 20.0, 160.0, 50.0, 30.0, 20.0, 60.0, 170.0, 0.0, 0.0, 60.0, 0.0, 60.0, 30.0, 40.0, 0.0, 10.0, 10.0, 0.0, 20.0, 30.0, 40.0, 110.0, 0.0, 45.0, 120.0, 40.0, 0.0, 70.0, 60.0, 170.0, 20.0, 20.0, 160.0, 50.0, 10.0, 30.0, 30.0, 20.0, 30.0, 90.0, 160.0, 10.0, 380.0, 80.0, 60.0, 480.0, 30.0, 60.0, 40.0, 30.0, 150.0, 10.0, 30.0, 10.0, 40.0, 50.0, 10.0, 20.0, 20.0, 0.0, 0.0, 10.0, 40.0, 40.0, 40.0, 20.0, 60.0, 10.0, 90.0, 50.0, 0.0, 30.0, 0.0, 150.0, 0.0, 20.0, 40.0, 30.0, 20.0, 40.0, 20.0, 10.0, 40.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 70.0, 10.0, 30.0, 20.0, 20.0, 10.0, 70.0, 40.0, 90.0, 70.0, 20.0, 10.0, 0.0, 50.0, 20.0, 30.0, 0.0, 150.0, 10.0, 70.0, 110.0, 20.0, 50.0, 0.0, 10.0, 10.0, 0.0, 10.0, 40.0, 0.0, 90.0, 260.0, 50.0, 40.0, 20.0, 260.0, 50.0, 60.0, 200.0, 10.0, 80.0, 40.0, 0.0, 20.0, 20.0, 10.0, 40.0, 10.0, 20.0, 0.0, 10.0, 30.0, 0.0, 20.0, 10.0, 0.0, 10.0, 30.0, 70.0, 10.0, 130.0, 190.0, 270.0, 10.0, 30.0, 10.0, 10.0, 40.0, 80.0, 10.0, 20.0, 20.0, 40.0, 10.0, 10.0, 40.0, 10.0, 0.0, 20.0, 170.0, -20.0, 20.0, 40.0, 20.0, 40.0, 30.0, 20.0, 10.0, 20.0, 0.0, 80.0, 10.0, 240.0, 40.0, 60.0, 160.0, 30.0, 590.0, 30.0, 50.0, 30.0, 10.0, 50.0, 30.0, 0.0, 30.0, 10.0, 0.0, 20.0, 20.0, 90.0, 10.0, 50.0, 90.0, 140.0, 60.0, 0.0, 0.0, 0.0, 10.0, 40.0, 450.0, 20.0, 30.0, 0.0, -50.0, 40.0, 30.0, 10.0, 20.0, 20.0, 110.0, 10.0, 20.0, 40.0, 150.0, 20.0, 10.0, 50.0, 30.0, 290.0, 60.0, 50.0, 10.0, 40.0, 30.0, 180.0, 0.0, 40.0, 10.0, 20.0, 380.0, 50.0, 80.0, -10.0, 30.0, 50.0, 120.0, 20.0, 30.0, 60.0, 560.0, 130.0, 60.0, 20.0, 30.0, 20.0, 50.0, 60.0, 40.0, 50.0, 20.0, 10.0, 0.0, 30.0, 0.0, 40.0, 30.0, 50.0, 0.0, 0.0, 30.0, 20.0, 150.0, 40.0, 30.0, 40.0, 30.0, 550.0, 60.0, 40.0, 30.0, 40.0, 30.0, 0.0, 0.0, 40.0, 190.0, 20.0, 30.0, 10.0, 20.0, -130.0, 160.0, 40.0, 150.0, 30.0, 100.0, 30.0, 0.0, 30.0, 0.0, 40.0, 20.0, 0.0, 0.0, 80.0, 0.0, 20.0, 30.0, 10.0, 160.0, 30.0, 60.0, 60.0, 780.0, 30.0, 60.0, 20.0, 40.0, 60.0, 60.0, 20.0, 40.0, 30.0, 20.0, 240.0, -10.0, 270.0, 20.0, 10.0, 40.0, 10.0, 0.0, 30.0, 40.0, 30.0, 20.0, 30.0, 230.0, 30.0, 40.0, 60.0, 0.0, 60.0, 30.0, 50.0, 10.0, 80.0, 90.0, 30.0, 30.0, 30.0, 0.0, 0.0, 90.0, 20.0, 10.0, 190.0, 40.0, 90.0, 40.0, 60.0, 60.0, 60.0, 160.0, 180.0, -115.0, 80.0, 150.0, 20.0, 310.0, 70.0, 60.0, 20.0, 60.0, 0.0, 80.0, 180.0, 40.0, 60.0, 10.0, 10.0, 0.0, 30.0, 0.0, 60.0, 20.0, 30.0, 0.0, 50.0, 10.0, 10.0, 170.0, 10.0, 60.0, 0.0, 30.0, 60.0, 60.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4158618269088785, "mean_inference_ms": 1.6168679977508413, "mean_action_processing_ms": 0.42185895457602834, "mean_env_wait_ms": 1.3011291347766352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.056308746337890625, "StateBufferConnector_ms": 0.009613752365112305, "ViewRequirementAgentConnector_ms": 0.37384533882141113}, "num_episodes": 23, "episode_return_max": 1420.0, "episode_return_min": 110.0, "episode_return_mean": 564.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.356323152709365, "num_env_steps_trained_throughput_per_sec": 36.356323152709365, "timesteps_total": 520000, "num_env_steps_sampled_lifetime": 520000, "num_agent_steps_sampled_lifetime": 5200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5200000, "timers": {"training_iteration_time_ms": 110099.663, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110099.615, "sample_time_ms": 2462.712, "learn_time_ms": 107616.931, "learn_throughput": 37.169, "synch_weights_time_ms": 11.563}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 5200000, "num_agent_steps_trained": 5200000}, "done": false, "training_iteration": 130, "trial_id": "57140_00000", "date": "2024-06-27_03-18-47", "timestamp": 1719472727, "time_this_iter_s": 110.03417110443115, "time_total_s": 14652.127174139023, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23e48b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14652.127174139023, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 15.421153846153844, "ram_util_percent": 78.05384615384617}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.992317697193168, "cur_kl_coeff": 25.308225221878068, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.784887211238995, "policy_loss": -0.001110328645301592, "vf_loss": 3.784281391736925, "vf_explained_var": 0.00013981034326604125, "kl": 6.780975440288856e-05, "entropy": 0.4009339410307816, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1225395.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000}, "env_runners": {"episode_reward_max": 1390.0, "episode_reward_min": 120.0, "episode_reward_mean": 569.95, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 790.0}, "policy_reward_mean": {"policy_0": 56.995}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 1120.0, 1390.0, 960.0, 865.0, 170.0, 780.0, 1000.0, 630.0, 525.0, 1280.0, 130.0, 960.0, 340.0, 550.0, 490.0, 800.0, 600.0, 270.0, 370.0, 880.0, 260.0, 520.0, 380.0, 330.0, 640.0, 380.0, 850.0, 1160.0, 160.0, 235.0, 360.0, 990.0, 540.0, 1080.0, 550.0, 175.0, 1300.0, 370.0, 415.0, 590.0, 1340.0, 450.0, 200.0, 410.0, 220.0, 120.0, 380.0, 450.0, 230.0, 1030.0, 170.0, 310.0, 670.0, 300.0, 280.0, 1240.0, 260.0, 400.0, 570.0, 730.0, 440.0, 810.0, 1020.0, 180.0, 990.0, 390.0, 430.0, 200.0, 1300.0, 700.0, 460.0, 450.0, 500.0, 695.0, 880.0, 210.0, 410.0, 330.0, 1160.0, 1370.0, 890.0, 340.0, 830.0, 270.0, 180.0, 590.0, 535.0, 610.0, 250.0, 530.0, 1060.0, 340.0, 270.0, 220.0, 230.0, 280.0, 220.0, 420.0, 700.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 0.0, 0.0, 20.0, 30.0, 0.0, 0.0, 20.0, 40.0, 20.0, 0.0, 580.0, 390.0, -20.0, -40.0, -50.0, 100.0, 40.0, 0.0, 120.0, 290.0, 10.0, 10.0, 100.0, 310.0, 70.0, 100.0, 70.0, 330.0, 100.0, 10.0, 110.0, 180.0, 40.0, 50.0, 40.0, 20.0, 190.0, 160.0, 160.0, 210.0, 0.0, 20.0, 0.0, 40.0, 40.0, 660.0, -50.0, -50.0, -5.0, 30.0, 0.0, 0.0, 20.0, 10.0, 10.0, 20.0, 60.0, 0.0, 20.0, -30.0, 0.0, 0.0, 390.0, -30.0, -40.0, 0.0, 30.0, -20.0, 480.0, 35.0, 130.0, 35.0, 170.0, 10.0, 40.0, 40.0, 380.0, 0.0, 160.0, 180.0, 10.0, 310.0, 40.0, 40.0, 0.0, 20.0, 70.0, 0.0, -40.0, 30.0, 80.0, 30.0, -10.0, 20.0, -20.0, 40.0, 260.0, 110.0, -15.0, 20.0, 200.0, 40.0, 40.0, 30.0, 0.0, 30.0, 360.0, 560.0, 0.0, 0.0, 0.0, 0.0, 10.0, 70.0, 0.0, 0.0, 0.0, 20.0, 30.0, 360.0, 30.0, 90.0, 220.0, 30.0, 60.0, 30.0, 20.0, 20.0, 100.0, 30.0, 30.0, 40.0, 0.0, 160.0, 0.0, 20.0, 20.0, 20.0, 20.0, 20.0, 0.0, 80.0, 20.0, 20.0, 30.0, 350.0, -30.0, 50.0, 10.0, 0.0, 20.0, 20.0, 80.0, 160.0, 40.0, 10.0, 30.0, 40.0, 90.0, -10.0, 100.0, 20.0, 260.0, 0.0, 70.0, 160.0, 170.0, 10.0, 20.0, 40.0, 30.0, 40.0, 170.0, 30.0, 60.0, 110.0, 30.0, 50.0, 40.0, 70.0, 20.0, 70.0, 80.0, 10.0, 10.0, 40.0, 10.0, -50.0, 10.0, 60.0, 30.0, 10.0, 10.0, 20.0, 70.0, 90.0, 80.0, 0.0, 0.0, 180.0, 0.0, 500.0, 20.0, 0.0, 60.0, 40.0, 30.0, 40.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 30.0, 20.0, 160.0, 10.0, 190.0, 50.0, 160.0, 0.0, 0.0, 30.0, 30.0, 0.0, 50.0, 30.0, 30.0, 20.0, 180.0, 50.0, 30.0, 20.0, 0.0, 10.0, 10.0, 150.0, 10.0, 20.0, 30.0, 40.0, 10.0, 40.0, 10.0, 0.0, 20.0, 60.0, 10.0, 260.0, 60.0, 40.0, 90.0, 60.0, 40.0, 20.0, 0.0, 180.0, 10.0, 20.0, 90.0, 0.0, 30.0, 10.0, 0.0, 0.0, 40.0, 260.0, 140.0, 0.0, 20.0, 300.0, 50.0, 20.0, 20.0, 0.0, 40.0, 10.0, 20.0, 40.0, 100.0, 90.0, 160.0, 510.0, 190.0, 10.0, 30.0, 0.0, 60.0, 0.0, 40.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 90.0, 10.0, 20.0, 20.0, 30.0, 10.0, 15.0, 20.0, 80.0, 40.0, 20.0, 0.0, 0.0, 110.0, 0.0, 10.0, 30.0, 70.0, 190.0, 50.0, 110.0, 150.0, 180.0, 20.0, 10.0, 90.0, 0.0, 190.0, 40.0, 20.0, 0.0, 210.0, 40.0, 100.0, 40.0, 30.0, 30.0, 30.0, 790.0, 30.0, 160.0, 0.0, 20.0, 20.0, 20.0, 0.0, 30.0, 10.0, 20.0, 40.0, 60.0, 190.0, 10.0, 0.0, 10.0, 0.0, 190.0, 30.0, 30.0, 30.0, 20.0, 0.0, 20.0, 20.0, 5.0, 0.0, 20.0, 30.0, 770.0, 90.0, 90.0, 10.0, 20.0, 160.0, 50.0, 30.0, 20.0, 60.0, 170.0, 0.0, 0.0, 60.0, 0.0, 60.0, 30.0, 40.0, 0.0, 10.0, 10.0, 0.0, 20.0, 30.0, 40.0, 110.0, 0.0, 45.0, 120.0, 40.0, 0.0, 70.0, 60.0, 170.0, 20.0, 20.0, 160.0, 50.0, 10.0, 30.0, 30.0, 20.0, 30.0, 90.0, 160.0, 10.0, 380.0, 80.0, 60.0, 480.0, 30.0, 60.0, 40.0, 30.0, 150.0, 10.0, 30.0, 10.0, 40.0, 50.0, 10.0, 20.0, 20.0, 0.0, 0.0, 10.0, 40.0, 40.0, 40.0, 20.0, 60.0, 10.0, 90.0, 50.0, 0.0, 30.0, 0.0, 150.0, 0.0, 20.0, 40.0, 30.0, 20.0, 40.0, 20.0, 10.0, 40.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 70.0, 10.0, 30.0, 20.0, 20.0, 10.0, 70.0, 40.0, 90.0, 70.0, 20.0, 10.0, 0.0, 50.0, 20.0, 30.0, 0.0, 150.0, 10.0, 70.0, 110.0, 20.0, 50.0, 0.0, 10.0, 10.0, 0.0, 10.0, 40.0, 0.0, 90.0, 260.0, 50.0, 40.0, 20.0, 260.0, 50.0, 60.0, 200.0, 10.0, 80.0, 40.0, 0.0, 20.0, 20.0, 10.0, 40.0, 10.0, 20.0, 0.0, 10.0, 30.0, 0.0, 20.0, 10.0, 0.0, 10.0, 30.0, 70.0, 10.0, 130.0, 190.0, 270.0, 10.0, 30.0, 10.0, 10.0, 40.0, 80.0, 10.0, 20.0, 20.0, 40.0, 10.0, 10.0, 40.0, 10.0, 0.0, 20.0, 170.0, -20.0, 20.0, 40.0, 20.0, 40.0, 30.0, 20.0, 10.0, 20.0, 0.0, 80.0, 10.0, 240.0, 40.0, 60.0, 160.0, 30.0, 590.0, 30.0, 50.0, 30.0, 10.0, 50.0, 30.0, 0.0, 30.0, 10.0, 0.0, 20.0, 20.0, 90.0, 10.0, 50.0, 90.0, 140.0, 60.0, 0.0, 0.0, 0.0, 10.0, 40.0, 450.0, 20.0, 30.0, 0.0, -50.0, 40.0, 30.0, 10.0, 20.0, 20.0, 110.0, 10.0, 20.0, 40.0, 150.0, 20.0, 10.0, 50.0, 30.0, 290.0, 60.0, 50.0, 10.0, 40.0, 30.0, 180.0, 0.0, 40.0, 10.0, 20.0, 380.0, 50.0, 80.0, -10.0, 30.0, 50.0, 120.0, 20.0, 30.0, 60.0, 560.0, 130.0, 60.0, 20.0, 30.0, 20.0, 50.0, 60.0, 40.0, 50.0, 20.0, 10.0, 0.0, 30.0, 0.0, 40.0, 30.0, 50.0, 0.0, 0.0, 30.0, 20.0, 150.0, 40.0, 30.0, 40.0, 30.0, 550.0, 60.0, 40.0, 30.0, 40.0, 30.0, 0.0, 0.0, 40.0, 190.0, 20.0, 30.0, 10.0, 20.0, -130.0, 160.0, 40.0, 150.0, 30.0, 100.0, 30.0, 0.0, 30.0, 0.0, 40.0, 20.0, 0.0, 0.0, 80.0, 0.0, 20.0, 30.0, 10.0, 160.0, 30.0, 60.0, 60.0, 780.0, 30.0, 60.0, 20.0, 40.0, 60.0, 60.0, 20.0, 40.0, 30.0, 20.0, 240.0, -10.0, 270.0, 20.0, 10.0, 40.0, 10.0, 0.0, 30.0, 40.0, 30.0, 20.0, 30.0, 230.0, 30.0, 40.0, 60.0, 0.0, 60.0, 30.0, 50.0, 10.0, 80.0, 90.0, 30.0, 30.0, 30.0, 0.0, 0.0, 90.0, 20.0, 10.0, 190.0, 40.0, 90.0, 40.0, 60.0, 60.0, 60.0, 160.0, 180.0, -115.0, 80.0, 150.0, 20.0, 310.0, 70.0, 60.0, 20.0, 60.0, 0.0, 80.0, 180.0, 40.0, 60.0, 10.0, 10.0, 0.0, 30.0, 0.0, 60.0, 20.0, 30.0, 0.0, 50.0, 10.0, 10.0, 170.0, 10.0, 60.0, 0.0, 30.0, 60.0, 60.0, 0.0, 20.0, 80.0, 60.0, 0.0, 40.0, 20.0, 80.0, 30.0, 0.0, 0.0, 310.0, 0.0, 380.0, 30.0, 30.0, 120.0, 100.0, 130.0, 20.0, 40.0, 40.0, 80.0, 230.0, 20.0, 110.0, 90.0, 570.0, 60.0, 0.0, 170.0, 150.0, 20.0, 330.0, 40.0, 20.0, 50.0, 80.0, 170.0, 30.0, 0.0, 70.0, 50.0, 0.0, 40.0, 30.0, 0.0, 30.0, 40.0, 80.0, 0.0, 20.0, 20.0, 10.0, 40.0, 120.0, 460.0, 40.0, 0.0, 30.0, 90.0, 0.0, 10.0, 0.0, 30.0, 40.0, 10.0, 150.0, 0.0, 0.0, 30.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, 30.0, 10.0, 30.0, 50.0, 50.0, 50.0, 0.0, 0.0, 10.0, 20.0, 210.0, 200.0, 0.0, 15.0, 0.0, 60.0, 20.0, 90.0, 10.0, 60.0, 10.0, 40.0, 230.0, -40.0, 40.0, 20.0, 30.0, 10.0, 0.0, 30.0, 10.0, 490.0, 20.0, 20.0, 90.0, 10.0, 70.0, 10.0, 0.0, 10.0, 20.0, 20.0, 0.0, 20.0, 40.0, 260.0, 10.0, 40.0, 40.0, 0.0, 80.0, 20.0, 20.0, 10.0, 30.0, 30.0, 10.0, 70.0, 170.0, 60.0, 660.0, 0.0, 20.0, 20.0, -30.0, 40.0, 10.0, 10.0, 90.0, 10.0, 10.0, 10.0, 170.0, 10.0, 10.0, 90.0, 10.0, 20.0, 20.0, 90.0, 10.0, 0.0, 10.0, 40.0, 20.0, 10.0, 0.0, 70.0, 0.0, 40.0, 0.0, 10.0, 30.0, 40.0, 10.0, 50.0, 10.0, 30.0, 20.0, 10.0, 10.0, 20.0, 30.0, 30.0, 0.0, 20.0, 10.0, 20.0, 10.0, 30.0, 150.0, 10.0, 0.0, 10.0, 40.0, 20.0, 30.0, 10.0, 40.0, 30.0, 40.0, 0.0, 0.0, 20.0, 60.0, 10.0, 0.0, 40.0, 0.0, 50.0, 180.0, 10.0, 50.0, 40.0, -50.0, -80.0, 60.0, 40.0, 300.0, 260.0, 40.0, -30.0, 120.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4186708637332879, "mean_inference_ms": 1.6232089804895105, "mean_action_processing_ms": 0.4231973436518348, "mean_env_wait_ms": 1.3035031609335965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0556488037109375, "StateBufferConnector_ms": 0.009620189666748047, "ViewRequirementAgentConnector_ms": 0.37427759170532227}, "num_episodes": 22, "episode_return_max": 1390.0, "episode_return_min": 120.0, "episode_return_mean": 569.95}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.30952002343396, "num_env_steps_trained_throughput_per_sec": 36.30952002343396, "timesteps_total": 524000, "num_env_steps_sampled_lifetime": 524000, "num_agent_steps_sampled_lifetime": 5240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5240000, "timers": {"training_iteration_time_ms": 110132.962, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110132.915, "sample_time_ms": 2460.777, "learn_time_ms": 107652.197, "learn_throughput": 37.157, "synch_weights_time_ms": 11.443}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 5240000, "num_agent_steps_trained": 5240000}, "done": false, "training_iteration": 131, "trial_id": "57140_00000", "date": "2024-06-27_03-20-37", "timestamp": 1719472837, "time_this_iter_s": 110.17615795135498, "time_total_s": 14762.303332090378, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23eaee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14762.303332090378, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 15.799358974358974, "ram_util_percent": 78.40641025641024}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7165907387852797, "cur_kl_coeff": 12.654112610939034, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.501567093988323, "policy_loss": -0.0018893516757371772, "vf_loss": 4.501454499608284, "vf_explained_var": 0.0009422919049430579, "kl": 0.0001582049902505343, "entropy": 0.35188174196642935, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1234785.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000}, "env_runners": {"episode_reward_max": 1370.0, "episode_reward_min": 120.0, "episode_reward_mean": 562.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 790.0}, "policy_reward_mean": {"policy_0": 56.235}, "custom_metrics": {}, "hist_stats": {"episode_reward": [270.0, 370.0, 880.0, 260.0, 520.0, 380.0, 330.0, 640.0, 380.0, 850.0, 1160.0, 160.0, 235.0, 360.0, 990.0, 540.0, 1080.0, 550.0, 175.0, 1300.0, 370.0, 415.0, 590.0, 1340.0, 450.0, 200.0, 410.0, 220.0, 120.0, 380.0, 450.0, 230.0, 1030.0, 170.0, 310.0, 670.0, 300.0, 280.0, 1240.0, 260.0, 400.0, 570.0, 730.0, 440.0, 810.0, 1020.0, 180.0, 990.0, 390.0, 430.0, 200.0, 1300.0, 700.0, 460.0, 450.0, 500.0, 695.0, 880.0, 210.0, 410.0, 330.0, 1160.0, 1370.0, 890.0, 340.0, 830.0, 270.0, 180.0, 590.0, 535.0, 610.0, 250.0, 530.0, 1060.0, 340.0, 270.0, 220.0, 230.0, 280.0, 220.0, 420.0, 700.0, 1200.0, 710.0, 920.0, 850.0, 700.0, 910.0, 440.0, 250.0, 450.0, 1060.0, 350.0, 510.0, 260.0, 330.0, 420.0, 1120.0, 300.0, 1200.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [70.0, 20.0, 70.0, 80.0, 10.0, 10.0, 40.0, 10.0, -50.0, 10.0, 60.0, 30.0, 10.0, 10.0, 20.0, 70.0, 90.0, 80.0, 0.0, 0.0, 180.0, 0.0, 500.0, 20.0, 0.0, 60.0, 40.0, 30.0, 40.0, 10.0, 30.0, 0.0, 0.0, 0.0, 0.0, 20.0, 0.0, 30.0, 20.0, 160.0, 10.0, 190.0, 50.0, 160.0, 0.0, 0.0, 30.0, 30.0, 0.0, 50.0, 30.0, 30.0, 20.0, 180.0, 50.0, 30.0, 20.0, 0.0, 10.0, 10.0, 150.0, 10.0, 20.0, 30.0, 40.0, 10.0, 40.0, 10.0, 0.0, 20.0, 60.0, 10.0, 260.0, 60.0, 40.0, 90.0, 60.0, 40.0, 20.0, 0.0, 180.0, 10.0, 20.0, 90.0, 0.0, 30.0, 10.0, 0.0, 0.0, 40.0, 260.0, 140.0, 0.0, 20.0, 300.0, 50.0, 20.0, 20.0, 0.0, 40.0, 10.0, 20.0, 40.0, 100.0, 90.0, 160.0, 510.0, 190.0, 10.0, 30.0, 0.0, 60.0, 0.0, 40.0, 10.0, 30.0, 0.0, 20.0, 0.0, 0.0, 20.0, 0.0, 90.0, 10.0, 20.0, 20.0, 30.0, 10.0, 15.0, 20.0, 80.0, 40.0, 20.0, 0.0, 0.0, 110.0, 0.0, 10.0, 30.0, 70.0, 190.0, 50.0, 110.0, 150.0, 180.0, 20.0, 10.0, 90.0, 0.0, 190.0, 40.0, 20.0, 0.0, 210.0, 40.0, 100.0, 40.0, 30.0, 30.0, 30.0, 790.0, 30.0, 160.0, 0.0, 20.0, 20.0, 20.0, 0.0, 30.0, 10.0, 20.0, 40.0, 60.0, 190.0, 10.0, 0.0, 10.0, 0.0, 190.0, 30.0, 30.0, 30.0, 20.0, 0.0, 20.0, 20.0, 5.0, 0.0, 20.0, 30.0, 770.0, 90.0, 90.0, 10.0, 20.0, 160.0, 50.0, 30.0, 20.0, 60.0, 170.0, 0.0, 0.0, 60.0, 0.0, 60.0, 30.0, 40.0, 0.0, 10.0, 10.0, 0.0, 20.0, 30.0, 40.0, 110.0, 0.0, 45.0, 120.0, 40.0, 0.0, 70.0, 60.0, 170.0, 20.0, 20.0, 160.0, 50.0, 10.0, 30.0, 30.0, 20.0, 30.0, 90.0, 160.0, 10.0, 380.0, 80.0, 60.0, 480.0, 30.0, 60.0, 40.0, 30.0, 150.0, 10.0, 30.0, 10.0, 40.0, 50.0, 10.0, 20.0, 20.0, 0.0, 0.0, 10.0, 40.0, 40.0, 40.0, 20.0, 60.0, 10.0, 90.0, 50.0, 0.0, 30.0, 0.0, 150.0, 0.0, 20.0, 40.0, 30.0, 20.0, 40.0, 20.0, 10.0, 40.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 70.0, 10.0, 30.0, 20.0, 20.0, 10.0, 70.0, 40.0, 90.0, 70.0, 20.0, 10.0, 0.0, 50.0, 20.0, 30.0, 0.0, 150.0, 10.0, 70.0, 110.0, 20.0, 50.0, 0.0, 10.0, 10.0, 0.0, 10.0, 40.0, 0.0, 90.0, 260.0, 50.0, 40.0, 20.0, 260.0, 50.0, 60.0, 200.0, 10.0, 80.0, 40.0, 0.0, 20.0, 20.0, 10.0, 40.0, 10.0, 20.0, 0.0, 10.0, 30.0, 0.0, 20.0, 10.0, 0.0, 10.0, 30.0, 70.0, 10.0, 130.0, 190.0, 270.0, 10.0, 30.0, 10.0, 10.0, 40.0, 80.0, 10.0, 20.0, 20.0, 40.0, 10.0, 10.0, 40.0, 10.0, 0.0, 20.0, 170.0, -20.0, 20.0, 40.0, 20.0, 40.0, 30.0, 20.0, 10.0, 20.0, 0.0, 80.0, 10.0, 240.0, 40.0, 60.0, 160.0, 30.0, 590.0, 30.0, 50.0, 30.0, 10.0, 50.0, 30.0, 0.0, 30.0, 10.0, 0.0, 20.0, 20.0, 90.0, 10.0, 50.0, 90.0, 140.0, 60.0, 0.0, 0.0, 0.0, 10.0, 40.0, 450.0, 20.0, 30.0, 0.0, -50.0, 40.0, 30.0, 10.0, 20.0, 20.0, 110.0, 10.0, 20.0, 40.0, 150.0, 20.0, 10.0, 50.0, 30.0, 290.0, 60.0, 50.0, 10.0, 40.0, 30.0, 180.0, 0.0, 40.0, 10.0, 20.0, 380.0, 50.0, 80.0, -10.0, 30.0, 50.0, 120.0, 20.0, 30.0, 60.0, 560.0, 130.0, 60.0, 20.0, 30.0, 20.0, 50.0, 60.0, 40.0, 50.0, 20.0, 10.0, 0.0, 30.0, 0.0, 40.0, 30.0, 50.0, 0.0, 0.0, 30.0, 20.0, 150.0, 40.0, 30.0, 40.0, 30.0, 550.0, 60.0, 40.0, 30.0, 40.0, 30.0, 0.0, 0.0, 40.0, 190.0, 20.0, 30.0, 10.0, 20.0, -130.0, 160.0, 40.0, 150.0, 30.0, 100.0, 30.0, 0.0, 30.0, 0.0, 40.0, 20.0, 0.0, 0.0, 80.0, 0.0, 20.0, 30.0, 10.0, 160.0, 30.0, 60.0, 60.0, 780.0, 30.0, 60.0, 20.0, 40.0, 60.0, 60.0, 20.0, 40.0, 30.0, 20.0, 240.0, -10.0, 270.0, 20.0, 10.0, 40.0, 10.0, 0.0, 30.0, 40.0, 30.0, 20.0, 30.0, 230.0, 30.0, 40.0, 60.0, 0.0, 60.0, 30.0, 50.0, 10.0, 80.0, 90.0, 30.0, 30.0, 30.0, 0.0, 0.0, 90.0, 20.0, 10.0, 190.0, 40.0, 90.0, 40.0, 60.0, 60.0, 60.0, 160.0, 180.0, -115.0, 80.0, 150.0, 20.0, 310.0, 70.0, 60.0, 20.0, 60.0, 0.0, 80.0, 180.0, 40.0, 60.0, 10.0, 10.0, 0.0, 30.0, 0.0, 60.0, 20.0, 30.0, 0.0, 50.0, 10.0, 10.0, 170.0, 10.0, 60.0, 0.0, 30.0, 60.0, 60.0, 0.0, 20.0, 80.0, 60.0, 0.0, 40.0, 20.0, 80.0, 30.0, 0.0, 0.0, 310.0, 0.0, 380.0, 30.0, 30.0, 120.0, 100.0, 130.0, 20.0, 40.0, 40.0, 80.0, 230.0, 20.0, 110.0, 90.0, 570.0, 60.0, 0.0, 170.0, 150.0, 20.0, 330.0, 40.0, 20.0, 50.0, 80.0, 170.0, 30.0, 0.0, 70.0, 50.0, 0.0, 40.0, 30.0, 0.0, 30.0, 40.0, 80.0, 0.0, 20.0, 20.0, 10.0, 40.0, 120.0, 460.0, 40.0, 0.0, 30.0, 90.0, 0.0, 10.0, 0.0, 30.0, 40.0, 10.0, 150.0, 0.0, 0.0, 30.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, 30.0, 10.0, 30.0, 50.0, 50.0, 50.0, 0.0, 0.0, 10.0, 20.0, 210.0, 200.0, 0.0, 15.0, 0.0, 60.0, 20.0, 90.0, 10.0, 60.0, 10.0, 40.0, 230.0, -40.0, 40.0, 20.0, 30.0, 10.0, 0.0, 30.0, 10.0, 490.0, 20.0, 20.0, 90.0, 10.0, 70.0, 10.0, 0.0, 10.0, 20.0, 20.0, 0.0, 20.0, 40.0, 260.0, 10.0, 40.0, 40.0, 0.0, 80.0, 20.0, 20.0, 10.0, 30.0, 30.0, 10.0, 70.0, 170.0, 60.0, 660.0, 0.0, 20.0, 20.0, -30.0, 40.0, 10.0, 10.0, 90.0, 10.0, 10.0, 10.0, 170.0, 10.0, 10.0, 90.0, 10.0, 20.0, 20.0, 90.0, 10.0, 0.0, 10.0, 40.0, 20.0, 10.0, 0.0, 70.0, 0.0, 40.0, 0.0, 10.0, 30.0, 40.0, 10.0, 50.0, 10.0, 30.0, 20.0, 10.0, 10.0, 20.0, 30.0, 30.0, 0.0, 20.0, 10.0, 20.0, 10.0, 30.0, 150.0, 10.0, 0.0, 10.0, 40.0, 20.0, 30.0, 10.0, 40.0, 30.0, 40.0, 0.0, 0.0, 20.0, 60.0, 10.0, 0.0, 40.0, 0.0, 50.0, 180.0, 10.0, 50.0, 40.0, -50.0, -80.0, 60.0, 40.0, 300.0, 260.0, 40.0, -30.0, 120.0, 370.0, 60.0, 40.0, 90.0, 130.0, 10.0, 90.0, 250.0, 10.0, 150.0, -20.0, 20.0, 20.0, 0.0, 10.0, 70.0, 40.0, 30.0, 280.0, 260.0, 10.0, 110.0, 30.0, 40.0, 200.0, 160.0, 50.0, 170.0, 150.0, 0.0, 30.0, 50.0, 30.0, 20.0, 0.0, 360.0, 50.0, 120.0, 170.0, 20.0, -40.0, 30.0, 90.0, 60.0, 40.0, -50.0, 140.0, 370.0, 30.0, 30.0, 0.0, 50.0, 20.0, 560.0, 50.0, 10.0, -10.0, 180.0, 40.0, 10.0, 20.0, 250.0, 0.0, 20.0, 40.0, 10.0, 60.0, 0.0, 10.0, 30.0, 40.0, 40.0, 0.0, 40.0, 10.0, 0.0, 0.0, 100.0, 20.0, 0.0, 30.0, 10.0, -20.0, 0.0, 180.0, 30.0, 20.0, 10.0, 150.0, 40.0, 90.0, 40.0, 100.0, 20.0, 300.0, 160.0, 310.0, 30.0, 0.0, 10.0, 40.0, 20.0, 10.0, 110.0, 60.0, 30.0, 0.0, 10.0, 40.0, 30.0, 70.0, 20.0, 20.0, 10.0, 60.0, 10.0, 90.0, 30.0, 40.0, 160.0, 10.0, 0.0, 40.0, 0.0, 0.0, 80.0, 30.0, 10.0, 20.0, 70.0, 20.0, 40.0, 30.0, 10.0, 70.0, 110.0, 0.0, 40.0, 0.0, 10.0, 20.0, 30.0, 0.0, 20.0, 30.0, 10.0, 20.0, 30.0, 260.0, 0.0, 770.0, 80.0, 0.0, 40.0, 40.0, 50.0, 20.0, -20.0, 70.0, 70.0, 30.0, 10.0, 0.0, 30.0, 20.0, 0.0, 10.0, 170.0, 0.0, 30.0, 100.0, 90.0, 30.0, 480.0, 20.0, 60.0, 50.0, 70.0, 30.0, 270.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.414499938030097, "mean_inference_ms": 1.6154293623011233, "mean_action_processing_ms": 0.421313461145209, "mean_env_wait_ms": 1.3000994514289193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05491948127746582, "StateBufferConnector_ms": 0.009425163269042969, "ViewRequirementAgentConnector_ms": 0.35750794410705566}, "num_episodes": 18, "episode_return_max": 1370.0, "episode_return_min": 120.0, "episode_return_mean": 562.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.510076629653526, "num_env_steps_trained_throughput_per_sec": 36.510076629653526, "timesteps_total": 528000, "num_env_steps_sampled_lifetime": 528000, "num_agent_steps_sampled_lifetime": 5280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5280000, "timers": {"training_iteration_time_ms": 110055.299, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110055.252, "sample_time_ms": 2457.485, "learn_time_ms": 107577.96, "learn_throughput": 37.182, "synch_weights_time_ms": 11.252}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 5280000, "num_agent_steps_trained": 5280000}, "done": false, "training_iteration": 132, "trial_id": "57140_00000", "date": "2024-06-27_03-22-27", "timestamp": 1719472947, "time_this_iter_s": 109.57244300842285, "time_total_s": 14871.8757750988, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b25c2670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14871.8757750988, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 15.391612903225806, "ram_util_percent": 79.22322580645161}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5973866679099675, "cur_kl_coeff": 6.327056305469517, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.0472887268970315, "policy_loss": -0.0019106593203936189, "vf_loss": 4.047270302676037, "vf_explained_var": 0.0012090628076031312, "kl": 0.0003048936851465927, "entropy": 0.3779380308299527, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1244175.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000}, "env_runners": {"episode_reward_max": 1370.0, "episode_reward_min": 120.0, "episode_reward_mean": 551.9, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -130.0}, "policy_reward_max": {"policy_0": 780.0}, "policy_reward_mean": {"policy_0": 55.19}, "custom_metrics": {}, "hist_stats": {"episode_reward": [175.0, 1300.0, 370.0, 415.0, 590.0, 1340.0, 450.0, 200.0, 410.0, 220.0, 120.0, 380.0, 450.0, 230.0, 1030.0, 170.0, 310.0, 670.0, 300.0, 280.0, 1240.0, 260.0, 400.0, 570.0, 730.0, 440.0, 810.0, 1020.0, 180.0, 990.0, 390.0, 430.0, 200.0, 1300.0, 700.0, 460.0, 450.0, 500.0, 695.0, 880.0, 210.0, 410.0, 330.0, 1160.0, 1370.0, 890.0, 340.0, 830.0, 270.0, 180.0, 590.0, 535.0, 610.0, 250.0, 530.0, 1060.0, 340.0, 270.0, 220.0, 230.0, 280.0, 220.0, 420.0, 700.0, 1200.0, 710.0, 920.0, 850.0, 700.0, 910.0, 440.0, 250.0, 450.0, 1060.0, 350.0, 510.0, 260.0, 330.0, 420.0, 1120.0, 300.0, 1200.0, 700.0, 630.0, 760.0, 930.0, 300.0, 300.0, 250.0, 590.0, 290.0, 650.0, 170.0, 520.0, 210.0, 670.0, 120.0, 600.0, 820.0, 400.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [30.0, 30.0, 20.0, 0.0, 20.0, 20.0, 5.0, 0.0, 20.0, 30.0, 770.0, 90.0, 90.0, 10.0, 20.0, 160.0, 50.0, 30.0, 20.0, 60.0, 170.0, 0.0, 0.0, 60.0, 0.0, 60.0, 30.0, 40.0, 0.0, 10.0, 10.0, 0.0, 20.0, 30.0, 40.0, 110.0, 0.0, 45.0, 120.0, 40.0, 0.0, 70.0, 60.0, 170.0, 20.0, 20.0, 160.0, 50.0, 10.0, 30.0, 30.0, 20.0, 30.0, 90.0, 160.0, 10.0, 380.0, 80.0, 60.0, 480.0, 30.0, 60.0, 40.0, 30.0, 150.0, 10.0, 30.0, 10.0, 40.0, 50.0, 10.0, 20.0, 20.0, 0.0, 0.0, 10.0, 40.0, 40.0, 40.0, 20.0, 60.0, 10.0, 90.0, 50.0, 0.0, 30.0, 0.0, 150.0, 0.0, 20.0, 40.0, 30.0, 20.0, 40.0, 20.0, 10.0, 40.0, 0.0, 20.0, 0.0, 10.0, 0.0, 10.0, 20.0, 0.0, 0.0, 0.0, 0.0, 10.0, 70.0, 10.0, 30.0, 20.0, 20.0, 10.0, 70.0, 40.0, 90.0, 70.0, 20.0, 10.0, 0.0, 50.0, 20.0, 30.0, 0.0, 150.0, 10.0, 70.0, 110.0, 20.0, 50.0, 0.0, 10.0, 10.0, 0.0, 10.0, 40.0, 0.0, 90.0, 260.0, 50.0, 40.0, 20.0, 260.0, 50.0, 60.0, 200.0, 10.0, 80.0, 40.0, 0.0, 20.0, 20.0, 10.0, 40.0, 10.0, 20.0, 0.0, 10.0, 30.0, 0.0, 20.0, 10.0, 0.0, 10.0, 30.0, 70.0, 10.0, 130.0, 190.0, 270.0, 10.0, 30.0, 10.0, 10.0, 40.0, 80.0, 10.0, 20.0, 20.0, 40.0, 10.0, 10.0, 40.0, 10.0, 0.0, 20.0, 170.0, -20.0, 20.0, 40.0, 20.0, 40.0, 30.0, 20.0, 10.0, 20.0, 0.0, 80.0, 10.0, 240.0, 40.0, 60.0, 160.0, 30.0, 590.0, 30.0, 50.0, 30.0, 10.0, 50.0, 30.0, 0.0, 30.0, 10.0, 0.0, 20.0, 20.0, 90.0, 10.0, 50.0, 90.0, 140.0, 60.0, 0.0, 0.0, 0.0, 10.0, 40.0, 450.0, 20.0, 30.0, 0.0, -50.0, 40.0, 30.0, 10.0, 20.0, 20.0, 110.0, 10.0, 20.0, 40.0, 150.0, 20.0, 10.0, 50.0, 30.0, 290.0, 60.0, 50.0, 10.0, 40.0, 30.0, 180.0, 0.0, 40.0, 10.0, 20.0, 380.0, 50.0, 80.0, -10.0, 30.0, 50.0, 120.0, 20.0, 30.0, 60.0, 560.0, 130.0, 60.0, 20.0, 30.0, 20.0, 50.0, 60.0, 40.0, 50.0, 20.0, 10.0, 0.0, 30.0, 0.0, 40.0, 30.0, 50.0, 0.0, 0.0, 30.0, 20.0, 150.0, 40.0, 30.0, 40.0, 30.0, 550.0, 60.0, 40.0, 30.0, 40.0, 30.0, 0.0, 0.0, 40.0, 190.0, 20.0, 30.0, 10.0, 20.0, -130.0, 160.0, 40.0, 150.0, 30.0, 100.0, 30.0, 0.0, 30.0, 0.0, 40.0, 20.0, 0.0, 0.0, 80.0, 0.0, 20.0, 30.0, 10.0, 160.0, 30.0, 60.0, 60.0, 780.0, 30.0, 60.0, 20.0, 40.0, 60.0, 60.0, 20.0, 40.0, 30.0, 20.0, 240.0, -10.0, 270.0, 20.0, 10.0, 40.0, 10.0, 0.0, 30.0, 40.0, 30.0, 20.0, 30.0, 230.0, 30.0, 40.0, 60.0, 0.0, 60.0, 30.0, 50.0, 10.0, 80.0, 90.0, 30.0, 30.0, 30.0, 0.0, 0.0, 90.0, 20.0, 10.0, 190.0, 40.0, 90.0, 40.0, 60.0, 60.0, 60.0, 160.0, 180.0, -115.0, 80.0, 150.0, 20.0, 310.0, 70.0, 60.0, 20.0, 60.0, 0.0, 80.0, 180.0, 40.0, 60.0, 10.0, 10.0, 0.0, 30.0, 0.0, 60.0, 20.0, 30.0, 0.0, 50.0, 10.0, 10.0, 170.0, 10.0, 60.0, 0.0, 30.0, 60.0, 60.0, 0.0, 20.0, 80.0, 60.0, 0.0, 40.0, 20.0, 80.0, 30.0, 0.0, 0.0, 310.0, 0.0, 380.0, 30.0, 30.0, 120.0, 100.0, 130.0, 20.0, 40.0, 40.0, 80.0, 230.0, 20.0, 110.0, 90.0, 570.0, 60.0, 0.0, 170.0, 150.0, 20.0, 330.0, 40.0, 20.0, 50.0, 80.0, 170.0, 30.0, 0.0, 70.0, 50.0, 0.0, 40.0, 30.0, 0.0, 30.0, 40.0, 80.0, 0.0, 20.0, 20.0, 10.0, 40.0, 120.0, 460.0, 40.0, 0.0, 30.0, 90.0, 0.0, 10.0, 0.0, 30.0, 40.0, 10.0, 150.0, 0.0, 0.0, 30.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, 30.0, 10.0, 30.0, 50.0, 50.0, 50.0, 0.0, 0.0, 10.0, 20.0, 210.0, 200.0, 0.0, 15.0, 0.0, 60.0, 20.0, 90.0, 10.0, 60.0, 10.0, 40.0, 230.0, -40.0, 40.0, 20.0, 30.0, 10.0, 0.0, 30.0, 10.0, 490.0, 20.0, 20.0, 90.0, 10.0, 70.0, 10.0, 0.0, 10.0, 20.0, 20.0, 0.0, 20.0, 40.0, 260.0, 10.0, 40.0, 40.0, 0.0, 80.0, 20.0, 20.0, 10.0, 30.0, 30.0, 10.0, 70.0, 170.0, 60.0, 660.0, 0.0, 20.0, 20.0, -30.0, 40.0, 10.0, 10.0, 90.0, 10.0, 10.0, 10.0, 170.0, 10.0, 10.0, 90.0, 10.0, 20.0, 20.0, 90.0, 10.0, 0.0, 10.0, 40.0, 20.0, 10.0, 0.0, 70.0, 0.0, 40.0, 0.0, 10.0, 30.0, 40.0, 10.0, 50.0, 10.0, 30.0, 20.0, 10.0, 10.0, 20.0, 30.0, 30.0, 0.0, 20.0, 10.0, 20.0, 10.0, 30.0, 150.0, 10.0, 0.0, 10.0, 40.0, 20.0, 30.0, 10.0, 40.0, 30.0, 40.0, 0.0, 0.0, 20.0, 60.0, 10.0, 0.0, 40.0, 0.0, 50.0, 180.0, 10.0, 50.0, 40.0, -50.0, -80.0, 60.0, 40.0, 300.0, 260.0, 40.0, -30.0, 120.0, 370.0, 60.0, 40.0, 90.0, 130.0, 10.0, 90.0, 250.0, 10.0, 150.0, -20.0, 20.0, 20.0, 0.0, 10.0, 70.0, 40.0, 30.0, 280.0, 260.0, 10.0, 110.0, 30.0, 40.0, 200.0, 160.0, 50.0, 170.0, 150.0, 0.0, 30.0, 50.0, 30.0, 20.0, 0.0, 360.0, 50.0, 120.0, 170.0, 20.0, -40.0, 30.0, 90.0, 60.0, 40.0, -50.0, 140.0, 370.0, 30.0, 30.0, 0.0, 50.0, 20.0, 560.0, 50.0, 10.0, -10.0, 180.0, 40.0, 10.0, 20.0, 250.0, 0.0, 20.0, 40.0, 10.0, 60.0, 0.0, 10.0, 30.0, 40.0, 40.0, 0.0, 40.0, 10.0, 0.0, 0.0, 100.0, 20.0, 0.0, 30.0, 10.0, -20.0, 0.0, 180.0, 30.0, 20.0, 10.0, 150.0, 40.0, 90.0, 40.0, 100.0, 20.0, 300.0, 160.0, 310.0, 30.0, 0.0, 10.0, 40.0, 20.0, 10.0, 110.0, 60.0, 30.0, 0.0, 10.0, 40.0, 30.0, 70.0, 20.0, 20.0, 10.0, 60.0, 10.0, 90.0, 30.0, 40.0, 160.0, 10.0, 0.0, 40.0, 0.0, 0.0, 80.0, 30.0, 10.0, 20.0, 70.0, 20.0, 40.0, 30.0, 10.0, 70.0, 110.0, 0.0, 40.0, 0.0, 10.0, 20.0, 30.0, 0.0, 20.0, 30.0, 10.0, 20.0, 30.0, 260.0, 0.0, 770.0, 80.0, 0.0, 40.0, 40.0, 50.0, 20.0, -20.0, 70.0, 70.0, 30.0, 10.0, 0.0, 30.0, 20.0, 0.0, 10.0, 170.0, 0.0, 30.0, 100.0, 90.0, 30.0, 480.0, 20.0, 60.0, 50.0, 70.0, 30.0, 270.0, 30.0, 10.0, 80.0, 0.0, 370.0, -10.0, 80.0, 130.0, 0.0, 10.0, 10.0, 110.0, 60.0, 0.0, 40.0, 90.0, 10.0, 30.0, 280.0, 0.0, 20.0, 80.0, 160.0, 20.0, 30.0, 250.0, 70.0, 30.0, 40.0, 60.0, 20.0, 0.0, 40.0, 590.0, 20.0, 10.0, 20.0, 50.0, 100.0, 80.0, 20.0, 150.0, 0.0, 30.0, 40.0, 0.0, 20.0, 40.0, 0.0, 0.0, 20.0, 0.0, 70.0, 40.0, 20.0, 0.0, 30.0, 20.0, 100.0, 0.0, 20.0, 80.0, 20.0, 10.0, 20.0, 30.0, 30.0, 40.0, 0.0, 0.0, 40.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 30.0, 470.0, 10.0, 150.0, 20.0, 10.0, 10.0, 40.0, 10.0, 0.0, 20.0, 20.0, 40.0, 10.0, 0.0, 490.0, 10.0, 30.0, 10.0, 20.0, 20.0, 20.0, 0.0, 30.0, 40.0, 0.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 40.0, 0.0, 110.0, 40.0, 150.0, 10.0, 40.0, 40.0, 10.0, 80.0, 0.0, 30.0, 180.0, 10.0, 40.0, 20.0, 10.0, -100.0, 10.0, 10.0, 40.0, 90.0, 50.0, 150.0, 20.0, 40.0, 10.0, 10.0, 10.0, 250.0, 30.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 10.0, 0.0, 20.0, 170.0, 130.0, 40.0, 60.0, 10.0, 50.0, 90.0, 20.0, 30.0, 0.0, 310.0, 0.0, 10.0, 20.0, 20.0, 10.0, 30.0, 20.0, 20.0, 380.0, 20.0, 10.0, 70.0, 40.0, 30.0, 10.0, 50.0, 30.0, 40.0, 100.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.413902425564242, "mean_inference_ms": 1.6146476523233326, "mean_action_processing_ms": 0.4210589993871354, "mean_env_wait_ms": 1.29958440426378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.055043697357177734, "StateBufferConnector_ms": 0.009254932403564453, "ViewRequirementAgentConnector_ms": 0.3609323501586914}, "num_episodes": 18, "episode_return_max": 1370.0, "episode_return_min": 120.0, "episode_return_mean": 551.9}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.36574331778749, "num_env_steps_trained_throughput_per_sec": 36.36574331778749, "timesteps_total": 532000, "num_env_steps_sampled_lifetime": 532000, "num_agent_steps_sampled_lifetime": 5320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5320000, "timers": {"training_iteration_time_ms": 109939.709, "restore_workers_time_ms": 0.012, "training_step_time_ms": 109939.661, "sample_time_ms": 2374.095, "learn_time_ms": 107545.581, "learn_throughput": 37.194, "synch_weights_time_ms": 11.461}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 5320000, "num_agent_steps_trained": 5320000}, "done": false, "training_iteration": 133, "trial_id": "57140_00000", "date": "2024-06-27_03-24-17", "timestamp": 1719473057, "time_this_iter_s": 110.00370717048645, "time_total_s": 14981.879482269287, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af404790>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14981.879482269287, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 15.67820512820513, "ram_util_percent": 79.05128205128206}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.629704168816598, "cur_kl_coeff": 3.1635281527347585, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.683577983270184, "policy_loss": -0.003867775506448572, "vf_loss": 4.685172615899319, "vf_explained_var": 0.00112839091700106, "kl": 0.0007185484860106196, "entropy": 0.36884840786203155, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1253565.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000}, "env_runners": {"episode_reward_max": 1515.0, "episode_reward_min": 120.0, "episode_reward_mean": 601.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 1050.0}, "policy_reward_mean": {"policy_0": 60.165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [570.0, 730.0, 440.0, 810.0, 1020.0, 180.0, 990.0, 390.0, 430.0, 200.0, 1300.0, 700.0, 460.0, 450.0, 500.0, 695.0, 880.0, 210.0, 410.0, 330.0, 1160.0, 1370.0, 890.0, 340.0, 830.0, 270.0, 180.0, 590.0, 535.0, 610.0, 250.0, 530.0, 1060.0, 340.0, 270.0, 220.0, 230.0, 280.0, 220.0, 420.0, 700.0, 1200.0, 710.0, 920.0, 850.0, 700.0, 910.0, 440.0, 250.0, 450.0, 1060.0, 350.0, 510.0, 260.0, 330.0, 420.0, 1120.0, 300.0, 1200.0, 700.0, 630.0, 760.0, 930.0, 300.0, 300.0, 250.0, 590.0, 290.0, 650.0, 170.0, 520.0, 210.0, 670.0, 120.0, 600.0, 820.0, 400.0, 560.0, 510.0, 1165.0, 270.0, 1340.0, 1260.0, 750.0, 500.0, 280.0, 470.0, 1515.0, 950.0, 600.0, 1300.0, 400.0, 490.0, 360.0, 555.0, 790.0, 660.0, 230.0, 690.0, 640.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [450.0, 20.0, 30.0, 0.0, -50.0, 40.0, 30.0, 10.0, 20.0, 20.0, 110.0, 10.0, 20.0, 40.0, 150.0, 20.0, 10.0, 50.0, 30.0, 290.0, 60.0, 50.0, 10.0, 40.0, 30.0, 180.0, 0.0, 40.0, 10.0, 20.0, 380.0, 50.0, 80.0, -10.0, 30.0, 50.0, 120.0, 20.0, 30.0, 60.0, 560.0, 130.0, 60.0, 20.0, 30.0, 20.0, 50.0, 60.0, 40.0, 50.0, 20.0, 10.0, 0.0, 30.0, 0.0, 40.0, 30.0, 50.0, 0.0, 0.0, 30.0, 20.0, 150.0, 40.0, 30.0, 40.0, 30.0, 550.0, 60.0, 40.0, 30.0, 40.0, 30.0, 0.0, 0.0, 40.0, 190.0, 20.0, 30.0, 10.0, 20.0, -130.0, 160.0, 40.0, 150.0, 30.0, 100.0, 30.0, 0.0, 30.0, 0.0, 40.0, 20.0, 0.0, 0.0, 80.0, 0.0, 20.0, 30.0, 10.0, 160.0, 30.0, 60.0, 60.0, 780.0, 30.0, 60.0, 20.0, 40.0, 60.0, 60.0, 20.0, 40.0, 30.0, 20.0, 240.0, -10.0, 270.0, 20.0, 10.0, 40.0, 10.0, 0.0, 30.0, 40.0, 30.0, 20.0, 30.0, 230.0, 30.0, 40.0, 60.0, 0.0, 60.0, 30.0, 50.0, 10.0, 80.0, 90.0, 30.0, 30.0, 30.0, 0.0, 0.0, 90.0, 20.0, 10.0, 190.0, 40.0, 90.0, 40.0, 60.0, 60.0, 60.0, 160.0, 180.0, -115.0, 80.0, 150.0, 20.0, 310.0, 70.0, 60.0, 20.0, 60.0, 0.0, 80.0, 180.0, 40.0, 60.0, 10.0, 10.0, 0.0, 30.0, 0.0, 60.0, 20.0, 30.0, 0.0, 50.0, 10.0, 10.0, 170.0, 10.0, 60.0, 0.0, 30.0, 60.0, 60.0, 0.0, 20.0, 80.0, 60.0, 0.0, 40.0, 20.0, 80.0, 30.0, 0.0, 0.0, 310.0, 0.0, 380.0, 30.0, 30.0, 120.0, 100.0, 130.0, 20.0, 40.0, 40.0, 80.0, 230.0, 20.0, 110.0, 90.0, 570.0, 60.0, 0.0, 170.0, 150.0, 20.0, 330.0, 40.0, 20.0, 50.0, 80.0, 170.0, 30.0, 0.0, 70.0, 50.0, 0.0, 40.0, 30.0, 0.0, 30.0, 40.0, 80.0, 0.0, 20.0, 20.0, 10.0, 40.0, 120.0, 460.0, 40.0, 0.0, 30.0, 90.0, 0.0, 10.0, 0.0, 30.0, 40.0, 10.0, 150.0, 0.0, 0.0, 30.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, 30.0, 10.0, 30.0, 50.0, 50.0, 50.0, 0.0, 0.0, 10.0, 20.0, 210.0, 200.0, 0.0, 15.0, 0.0, 60.0, 20.0, 90.0, 10.0, 60.0, 10.0, 40.0, 230.0, -40.0, 40.0, 20.0, 30.0, 10.0, 0.0, 30.0, 10.0, 490.0, 20.0, 20.0, 90.0, 10.0, 70.0, 10.0, 0.0, 10.0, 20.0, 20.0, 0.0, 20.0, 40.0, 260.0, 10.0, 40.0, 40.0, 0.0, 80.0, 20.0, 20.0, 10.0, 30.0, 30.0, 10.0, 70.0, 170.0, 60.0, 660.0, 0.0, 20.0, 20.0, -30.0, 40.0, 10.0, 10.0, 90.0, 10.0, 10.0, 10.0, 170.0, 10.0, 10.0, 90.0, 10.0, 20.0, 20.0, 90.0, 10.0, 0.0, 10.0, 40.0, 20.0, 10.0, 0.0, 70.0, 0.0, 40.0, 0.0, 10.0, 30.0, 40.0, 10.0, 50.0, 10.0, 30.0, 20.0, 10.0, 10.0, 20.0, 30.0, 30.0, 0.0, 20.0, 10.0, 20.0, 10.0, 30.0, 150.0, 10.0, 0.0, 10.0, 40.0, 20.0, 30.0, 10.0, 40.0, 30.0, 40.0, 0.0, 0.0, 20.0, 60.0, 10.0, 0.0, 40.0, 0.0, 50.0, 180.0, 10.0, 50.0, 40.0, -50.0, -80.0, 60.0, 40.0, 300.0, 260.0, 40.0, -30.0, 120.0, 370.0, 60.0, 40.0, 90.0, 130.0, 10.0, 90.0, 250.0, 10.0, 150.0, -20.0, 20.0, 20.0, 0.0, 10.0, 70.0, 40.0, 30.0, 280.0, 260.0, 10.0, 110.0, 30.0, 40.0, 200.0, 160.0, 50.0, 170.0, 150.0, 0.0, 30.0, 50.0, 30.0, 20.0, 0.0, 360.0, 50.0, 120.0, 170.0, 20.0, -40.0, 30.0, 90.0, 60.0, 40.0, -50.0, 140.0, 370.0, 30.0, 30.0, 0.0, 50.0, 20.0, 560.0, 50.0, 10.0, -10.0, 180.0, 40.0, 10.0, 20.0, 250.0, 0.0, 20.0, 40.0, 10.0, 60.0, 0.0, 10.0, 30.0, 40.0, 40.0, 0.0, 40.0, 10.0, 0.0, 0.0, 100.0, 20.0, 0.0, 30.0, 10.0, -20.0, 0.0, 180.0, 30.0, 20.0, 10.0, 150.0, 40.0, 90.0, 40.0, 100.0, 20.0, 300.0, 160.0, 310.0, 30.0, 0.0, 10.0, 40.0, 20.0, 10.0, 110.0, 60.0, 30.0, 0.0, 10.0, 40.0, 30.0, 70.0, 20.0, 20.0, 10.0, 60.0, 10.0, 90.0, 30.0, 40.0, 160.0, 10.0, 0.0, 40.0, 0.0, 0.0, 80.0, 30.0, 10.0, 20.0, 70.0, 20.0, 40.0, 30.0, 10.0, 70.0, 110.0, 0.0, 40.0, 0.0, 10.0, 20.0, 30.0, 0.0, 20.0, 30.0, 10.0, 20.0, 30.0, 260.0, 0.0, 770.0, 80.0, 0.0, 40.0, 40.0, 50.0, 20.0, -20.0, 70.0, 70.0, 30.0, 10.0, 0.0, 30.0, 20.0, 0.0, 10.0, 170.0, 0.0, 30.0, 100.0, 90.0, 30.0, 480.0, 20.0, 60.0, 50.0, 70.0, 30.0, 270.0, 30.0, 10.0, 80.0, 0.0, 370.0, -10.0, 80.0, 130.0, 0.0, 10.0, 10.0, 110.0, 60.0, 0.0, 40.0, 90.0, 10.0, 30.0, 280.0, 0.0, 20.0, 80.0, 160.0, 20.0, 30.0, 250.0, 70.0, 30.0, 40.0, 60.0, 20.0, 0.0, 40.0, 590.0, 20.0, 10.0, 20.0, 50.0, 100.0, 80.0, 20.0, 150.0, 0.0, 30.0, 40.0, 0.0, 20.0, 40.0, 0.0, 0.0, 20.0, 0.0, 70.0, 40.0, 20.0, 0.0, 30.0, 20.0, 100.0, 0.0, 20.0, 80.0, 20.0, 10.0, 20.0, 30.0, 30.0, 40.0, 0.0, 0.0, 40.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 30.0, 470.0, 10.0, 150.0, 20.0, 10.0, 10.0, 40.0, 10.0, 0.0, 20.0, 20.0, 40.0, 10.0, 0.0, 490.0, 10.0, 30.0, 10.0, 20.0, 20.0, 20.0, 0.0, 30.0, 40.0, 0.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 40.0, 0.0, 110.0, 40.0, 150.0, 10.0, 40.0, 40.0, 10.0, 80.0, 0.0, 30.0, 180.0, 10.0, 40.0, 20.0, 10.0, -100.0, 10.0, 10.0, 40.0, 90.0, 50.0, 150.0, 20.0, 40.0, 10.0, 10.0, 10.0, 250.0, 30.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 10.0, 0.0, 20.0, 170.0, 130.0, 40.0, 60.0, 10.0, 50.0, 90.0, 20.0, 30.0, 0.0, 310.0, 0.0, 10.0, 20.0, 20.0, 10.0, 30.0, 20.0, 20.0, 380.0, 20.0, 10.0, 70.0, 40.0, 30.0, 10.0, 50.0, 30.0, 40.0, 100.0, 70.0, 10.0, 10.0, 30.0, 160.0, 90.0, 40.0, 0.0, 140.0, 10.0, 560.0, -20.0, 10.0, -20.0, 20.0, 10.0, 30.0, 0.0, -90.0, 10.0, 50.0, 10.0, 100.0, 70.0, 35.0, 40.0, 40.0, 610.0, 130.0, 80.0, 170.0, 20.0, 0.0, 40.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 1050.0, 110.0, 30.0, 10.0, 70.0, 80.0, 370.0, 30.0, 90.0, 510.0, 0.0, 20.0, 10.0, 100.0, 50.0, 50.0, 20.0, 40.0, 50.0, 0.0, 80.0, 30.0, 10.0, 300.0, 170.0, 10.0, 70.0, 30.0, 10.0, 30.0, 20.0, 20.0, 310.0, 0.0, 0.0, 40.0, 50.0, 10.0, 10.0, -120.0, 170.0, 170.0, 40.0, -100.0, 10.0, 20.0, 0.0, 370.0, 30.0, 0.0, -20.0, 20.0, 0.0, 20.0, 30.0, 70.0, 60.0, 60.0, 275.0, 310.0, 170.0, 60.0, 10.0, 10.0, 490.0, 0.0, 390.0, 30.0, 340.0, 20.0, 70.0, -20.0, 40.0, 40.0, 40.0, 70.0, 40.0, 170.0, 0.0, 150.0, 0.0, 40.0, 50.0, 10.0, 70.0, -10.0, 150.0, 200.0, 30.0, 60.0, 610.0, 60.0, 90.0, 60.0, 50.0, 70.0, 50.0, 0.0, 10.0, 40.0, 140.0, 20.0, 20.0, 30.0, 20.0, 20.0, 150.0, 100.0, 20.0, 30.0, 100.0, 0.0, 20.0, 20.0, 30.0, 35.0, 40.0, 15.0, -210.0, -40.0, 140.0, 130.0, 230.0, 0.0, 20.0, 0.0, 50.0, 180.0, 15.0, 0.0, 190.0, 30.0, 40.0, 40.0, 10.0, 0.0, 30.0, 30.0, 20.0, 40.0, 330.0, 0.0, 10.0, 50.0, 280.0, 80.0, 20.0, 30.0, 150.0, 60.0, 20.0, 30.0, 0.0, 10.0, 260.0, 0.0, 0.0, 40.0, 80.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0, 220.0, 0.0, 140.0, 20.0, 20.0, 90.0, 40.0, 40.0, 80.0, 40.0, 50.0, 20.0, 110.0, 40.0, 0.0, 200.0, 30.0, 150.0, 10.0, 30.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4131654853193205, "mean_inference_ms": 1.6083911823973662, "mean_action_processing_ms": 0.4204890195938335, "mean_env_wait_ms": 1.2974762344449968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0635073184967041, "StateBufferConnector_ms": 0.009679555892944336, "ViewRequirementAgentConnector_ms": 0.37746524810791016}, "num_episodes": 23, "episode_return_max": 1515.0, "episode_return_min": 120.0, "episode_return_mean": 601.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.1015308128021, "num_env_steps_trained_throughput_per_sec": 36.1015308128021, "timesteps_total": 536000, "num_env_steps_sampled_lifetime": 536000, "num_agent_steps_sampled_lifetime": 5360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5360000, "timers": {"training_iteration_time_ms": 110070.473, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110070.425, "sample_time_ms": 2392.827, "learn_time_ms": 107657.413, "learn_throughput": 37.155, "synch_weights_time_ms": 11.712}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 5360000, "num_agent_steps_trained": 5360000}, "done": false, "training_iteration": 134, "trial_id": "57140_00000", "date": "2024-06-27_03-26-08", "timestamp": 1719473168, "time_this_iter_s": 110.81106400489807, "time_total_s": 15092.690546274185, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b25c29d0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15092.690546274185, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 17.16153846153846, "ram_util_percent": 78.4948717948718}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.0152270888907715, "cur_kl_coeff": 1.5817640763673793, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.665343609836282, "policy_loss": -0.0034126546911804026, "vf_loss": 4.666871538939186, "vf_explained_var": 0.0006089865970916261, "kl": 0.0011915338007675593, "entropy": 0.3874857767035786, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1262955.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000}, "env_runners": {"episode_reward_max": 1515.0, "episode_reward_min": 110.0, "episode_reward_mean": 616.6, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 1050.0}, "policy_reward_mean": {"policy_0": 61.66}, "custom_metrics": {}, "hist_stats": {"episode_reward": [410.0, 330.0, 1160.0, 1370.0, 890.0, 340.0, 830.0, 270.0, 180.0, 590.0, 535.0, 610.0, 250.0, 530.0, 1060.0, 340.0, 270.0, 220.0, 230.0, 280.0, 220.0, 420.0, 700.0, 1200.0, 710.0, 920.0, 850.0, 700.0, 910.0, 440.0, 250.0, 450.0, 1060.0, 350.0, 510.0, 260.0, 330.0, 420.0, 1120.0, 300.0, 1200.0, 700.0, 630.0, 760.0, 930.0, 300.0, 300.0, 250.0, 590.0, 290.0, 650.0, 170.0, 520.0, 210.0, 670.0, 120.0, 600.0, 820.0, 400.0, 560.0, 510.0, 1165.0, 270.0, 1340.0, 1260.0, 750.0, 500.0, 280.0, 470.0, 1515.0, 950.0, 600.0, 1300.0, 400.0, 490.0, 360.0, 555.0, 790.0, 660.0, 230.0, 690.0, 640.0, 110.0, 620.0, 560.0, 1460.0, 970.0, 840.0, 1275.0, 570.0, 180.0, 610.0, 490.0, 325.0, 250.0, 1500.0, 690.0, 910.0, 580.0, 510.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 10.0, 170.0, 10.0, 60.0, 0.0, 30.0, 60.0, 60.0, 0.0, 20.0, 80.0, 60.0, 0.0, 40.0, 20.0, 80.0, 30.0, 0.0, 0.0, 310.0, 0.0, 380.0, 30.0, 30.0, 120.0, 100.0, 130.0, 20.0, 40.0, 40.0, 80.0, 230.0, 20.0, 110.0, 90.0, 570.0, 60.0, 0.0, 170.0, 150.0, 20.0, 330.0, 40.0, 20.0, 50.0, 80.0, 170.0, 30.0, 0.0, 70.0, 50.0, 0.0, 40.0, 30.0, 0.0, 30.0, 40.0, 80.0, 0.0, 20.0, 20.0, 10.0, 40.0, 120.0, 460.0, 40.0, 0.0, 30.0, 90.0, 0.0, 10.0, 0.0, 30.0, 40.0, 10.0, 150.0, 0.0, 0.0, 30.0, 10.0, 0.0, 20.0, 20.0, 60.0, 0.0, 0.0, 30.0, 10.0, 30.0, 50.0, 50.0, 50.0, 0.0, 0.0, 10.0, 20.0, 210.0, 200.0, 0.0, 15.0, 0.0, 60.0, 20.0, 90.0, 10.0, 60.0, 10.0, 40.0, 230.0, -40.0, 40.0, 20.0, 30.0, 10.0, 0.0, 30.0, 10.0, 490.0, 20.0, 20.0, 90.0, 10.0, 70.0, 10.0, 0.0, 10.0, 20.0, 20.0, 0.0, 20.0, 40.0, 260.0, 10.0, 40.0, 40.0, 0.0, 80.0, 20.0, 20.0, 10.0, 30.0, 30.0, 10.0, 70.0, 170.0, 60.0, 660.0, 0.0, 20.0, 20.0, -30.0, 40.0, 10.0, 10.0, 90.0, 10.0, 10.0, 10.0, 170.0, 10.0, 10.0, 90.0, 10.0, 20.0, 20.0, 90.0, 10.0, 0.0, 10.0, 40.0, 20.0, 10.0, 0.0, 70.0, 0.0, 40.0, 0.0, 10.0, 30.0, 40.0, 10.0, 50.0, 10.0, 30.0, 20.0, 10.0, 10.0, 20.0, 30.0, 30.0, 0.0, 20.0, 10.0, 20.0, 10.0, 30.0, 150.0, 10.0, 0.0, 10.0, 40.0, 20.0, 30.0, 10.0, 40.0, 30.0, 40.0, 0.0, 0.0, 20.0, 60.0, 10.0, 0.0, 40.0, 0.0, 50.0, 180.0, 10.0, 50.0, 40.0, -50.0, -80.0, 60.0, 40.0, 300.0, 260.0, 40.0, -30.0, 120.0, 370.0, 60.0, 40.0, 90.0, 130.0, 10.0, 90.0, 250.0, 10.0, 150.0, -20.0, 20.0, 20.0, 0.0, 10.0, 70.0, 40.0, 30.0, 280.0, 260.0, 10.0, 110.0, 30.0, 40.0, 200.0, 160.0, 50.0, 170.0, 150.0, 0.0, 30.0, 50.0, 30.0, 20.0, 0.0, 360.0, 50.0, 120.0, 170.0, 20.0, -40.0, 30.0, 90.0, 60.0, 40.0, -50.0, 140.0, 370.0, 30.0, 30.0, 0.0, 50.0, 20.0, 560.0, 50.0, 10.0, -10.0, 180.0, 40.0, 10.0, 20.0, 250.0, 0.0, 20.0, 40.0, 10.0, 60.0, 0.0, 10.0, 30.0, 40.0, 40.0, 0.0, 40.0, 10.0, 0.0, 0.0, 100.0, 20.0, 0.0, 30.0, 10.0, -20.0, 0.0, 180.0, 30.0, 20.0, 10.0, 150.0, 40.0, 90.0, 40.0, 100.0, 20.0, 300.0, 160.0, 310.0, 30.0, 0.0, 10.0, 40.0, 20.0, 10.0, 110.0, 60.0, 30.0, 0.0, 10.0, 40.0, 30.0, 70.0, 20.0, 20.0, 10.0, 60.0, 10.0, 90.0, 30.0, 40.0, 160.0, 10.0, 0.0, 40.0, 0.0, 0.0, 80.0, 30.0, 10.0, 20.0, 70.0, 20.0, 40.0, 30.0, 10.0, 70.0, 110.0, 0.0, 40.0, 0.0, 10.0, 20.0, 30.0, 0.0, 20.0, 30.0, 10.0, 20.0, 30.0, 260.0, 0.0, 770.0, 80.0, 0.0, 40.0, 40.0, 50.0, 20.0, -20.0, 70.0, 70.0, 30.0, 10.0, 0.0, 30.0, 20.0, 0.0, 10.0, 170.0, 0.0, 30.0, 100.0, 90.0, 30.0, 480.0, 20.0, 60.0, 50.0, 70.0, 30.0, 270.0, 30.0, 10.0, 80.0, 0.0, 370.0, -10.0, 80.0, 130.0, 0.0, 10.0, 10.0, 110.0, 60.0, 0.0, 40.0, 90.0, 10.0, 30.0, 280.0, 0.0, 20.0, 80.0, 160.0, 20.0, 30.0, 250.0, 70.0, 30.0, 40.0, 60.0, 20.0, 0.0, 40.0, 590.0, 20.0, 10.0, 20.0, 50.0, 100.0, 80.0, 20.0, 150.0, 0.0, 30.0, 40.0, 0.0, 20.0, 40.0, 0.0, 0.0, 20.0, 0.0, 70.0, 40.0, 20.0, 0.0, 30.0, 20.0, 100.0, 0.0, 20.0, 80.0, 20.0, 10.0, 20.0, 30.0, 30.0, 40.0, 0.0, 0.0, 40.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 30.0, 470.0, 10.0, 150.0, 20.0, 10.0, 10.0, 40.0, 10.0, 0.0, 20.0, 20.0, 40.0, 10.0, 0.0, 490.0, 10.0, 30.0, 10.0, 20.0, 20.0, 20.0, 0.0, 30.0, 40.0, 0.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 40.0, 0.0, 110.0, 40.0, 150.0, 10.0, 40.0, 40.0, 10.0, 80.0, 0.0, 30.0, 180.0, 10.0, 40.0, 20.0, 10.0, -100.0, 10.0, 10.0, 40.0, 90.0, 50.0, 150.0, 20.0, 40.0, 10.0, 10.0, 10.0, 250.0, 30.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 10.0, 0.0, 20.0, 170.0, 130.0, 40.0, 60.0, 10.0, 50.0, 90.0, 20.0, 30.0, 0.0, 310.0, 0.0, 10.0, 20.0, 20.0, 10.0, 30.0, 20.0, 20.0, 380.0, 20.0, 10.0, 70.0, 40.0, 30.0, 10.0, 50.0, 30.0, 40.0, 100.0, 70.0, 10.0, 10.0, 30.0, 160.0, 90.0, 40.0, 0.0, 140.0, 10.0, 560.0, -20.0, 10.0, -20.0, 20.0, 10.0, 30.0, 0.0, -90.0, 10.0, 50.0, 10.0, 100.0, 70.0, 35.0, 40.0, 40.0, 610.0, 130.0, 80.0, 170.0, 20.0, 0.0, 40.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 1050.0, 110.0, 30.0, 10.0, 70.0, 80.0, 370.0, 30.0, 90.0, 510.0, 0.0, 20.0, 10.0, 100.0, 50.0, 50.0, 20.0, 40.0, 50.0, 0.0, 80.0, 30.0, 10.0, 300.0, 170.0, 10.0, 70.0, 30.0, 10.0, 30.0, 20.0, 20.0, 310.0, 0.0, 0.0, 40.0, 50.0, 10.0, 10.0, -120.0, 170.0, 170.0, 40.0, -100.0, 10.0, 20.0, 0.0, 370.0, 30.0, 0.0, -20.0, 20.0, 0.0, 20.0, 30.0, 70.0, 60.0, 60.0, 275.0, 310.0, 170.0, 60.0, 10.0, 10.0, 490.0, 0.0, 390.0, 30.0, 340.0, 20.0, 70.0, -20.0, 40.0, 40.0, 40.0, 70.0, 40.0, 170.0, 0.0, 150.0, 0.0, 40.0, 50.0, 10.0, 70.0, -10.0, 150.0, 200.0, 30.0, 60.0, 610.0, 60.0, 90.0, 60.0, 50.0, 70.0, 50.0, 0.0, 10.0, 40.0, 140.0, 20.0, 20.0, 30.0, 20.0, 20.0, 150.0, 100.0, 20.0, 30.0, 100.0, 0.0, 20.0, 20.0, 30.0, 35.0, 40.0, 15.0, -210.0, -40.0, 140.0, 130.0, 230.0, 0.0, 20.0, 0.0, 50.0, 180.0, 15.0, 0.0, 190.0, 30.0, 40.0, 40.0, 10.0, 0.0, 30.0, 30.0, 20.0, 40.0, 330.0, 0.0, 10.0, 50.0, 280.0, 80.0, 20.0, 30.0, 150.0, 60.0, 20.0, 30.0, 0.0, 10.0, 260.0, 0.0, 0.0, 40.0, 80.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0, 220.0, 0.0, 140.0, 20.0, 20.0, 90.0, 40.0, 40.0, 80.0, 40.0, 50.0, 20.0, 110.0, 40.0, 0.0, 200.0, 30.0, 150.0, 10.0, 30.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 90.0, 40.0, 50.0, 30.0, 60.0, 40.0, 280.0, 20.0, 10.0, 0.0, 10.0, 150.0, 0.0, 20.0, 30.0, 260.0, 50.0, 10.0, 10.0, 20.0, 760.0, 120.0, 380.0, 30.0, 70.0, 10.0, 40.0, 30.0, 20.0, 0.0, 330.0, 40.0, 160.0, -20.0, 100.0, 60.0, 210.0, 70.0, 10.0, 10.0, 90.0, 20.0, 0.0, 70.0, 0.0, 40.0, 100.0, 180.0, 300.0, 40.0, 70.0, 250.0, 20.0, 380.0, 130.0, -20.0, 0.0, 100.0, 310.0, 35.0, 40.0, 40.0, 60.0, 40.0, 40.0, 50.0, 210.0, 70.0, 10.0, 10.0, 10.0, 30.0, 60.0, 0.0, 10.0, 20.0, 0.0, 0.0, 30.0, 20.0, 30.0, 20.0, 10.0, 120.0, 10.0, 20.0, 40.0, 60.0, 280.0, 20.0, 10.0, 180.0, 30.0, 20.0, 20.0, 0.0, 80.0, 40.0, 20.0, 90.0, 10.0, -35.0, 10.0, 80.0, 80.0, 10.0, 100.0, 40.0, 0.0, 30.0, 40.0, 30.0, 10.0, 10.0, 20.0, 0.0, 70.0, 10.0, 50.0, 10.0, 580.0, 80.0, 20.0, 10.0, 10.0, 30.0, 30.0, 20.0, 560.0, 160.0, 480.0, -20.0, -40.0, 20.0, 40.0, 0.0, 180.0, 0.0, 10.0, 20.0, 10.0, 0.0, 370.0, 350.0, 70.0, 20.0, 40.0, -50.0, 10.0, 90.0, 90.0, 40.0, 60.0, 30.0, 0.0, 260.0, 0.0, 0.0, 20.0, 80.0, 10.0, 10.0, 20.0, 0.0, 20.0, 100.0, 160.0, 40.0, 150.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.412599597412849, "mean_inference_ms": 1.613338611790146, "mean_action_processing_ms": 0.42052945826017285, "mean_env_wait_ms": 1.2985974869543029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06174159049987793, "StateBufferConnector_ms": 0.00933527946472168, "ViewRequirementAgentConnector_ms": 0.36971139907836914}, "num_episodes": 18, "episode_return_max": 1515.0, "episode_return_min": 110.0, "episode_return_mean": 616.6}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 35.990793031393494, "num_env_steps_trained_throughput_per_sec": 35.990793031393494, "timesteps_total": 540000, "num_env_steps_sampled_lifetime": 540000, "num_agent_steps_sampled_lifetime": 5400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5400000, "timers": {"training_iteration_time_ms": 110160.329, "restore_workers_time_ms": 0.011, "training_step_time_ms": 110160.282, "sample_time_ms": 2394.179, "learn_time_ms": 107745.86, "learn_throughput": 37.124, "synch_weights_time_ms": 11.96}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 5400000, "num_agent_steps_trained": 5400000}, "done": false, "training_iteration": 135, "trial_id": "57140_00000", "date": "2024-06-27_03-27-59", "timestamp": 1719473279, "time_this_iter_s": 111.15121793746948, "time_total_s": 15203.841764211655, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18e18b0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15203.841764211655, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 18.654430379746838, "ram_util_percent": 78.90759493670885}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.248086233505299, "cur_kl_coeff": 0.7908820381836896, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.003770146657503483, "vf_loss": 3.7161753210904624, "vf_explained_var": 0.0003824517368889464, "kl": Infinity, "entropy": 0.37564751264798885, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1272345.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000}, "env_runners": {"episode_reward_max": 1515.0, "episode_reward_min": 110.0, "episode_reward_mean": 623.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 1050.0}, "policy_reward_mean": {"policy_0": 62.31}, "custom_metrics": {}, "hist_stats": {"episode_reward": [700.0, 1200.0, 710.0, 920.0, 850.0, 700.0, 910.0, 440.0, 250.0, 450.0, 1060.0, 350.0, 510.0, 260.0, 330.0, 420.0, 1120.0, 300.0, 1200.0, 700.0, 630.0, 760.0, 930.0, 300.0, 300.0, 250.0, 590.0, 290.0, 650.0, 170.0, 520.0, 210.0, 670.0, 120.0, 600.0, 820.0, 400.0, 560.0, 510.0, 1165.0, 270.0, 1340.0, 1260.0, 750.0, 500.0, 280.0, 470.0, 1515.0, 950.0, 600.0, 1300.0, 400.0, 490.0, 360.0, 555.0, 790.0, 660.0, 230.0, 690.0, 640.0, 110.0, 620.0, 560.0, 1460.0, 970.0, 840.0, 1275.0, 570.0, 180.0, 610.0, 490.0, 325.0, 250.0, 1500.0, 690.0, 910.0, 580.0, 510.0, 920.0, 780.0, 680.0, 490.0, 550.0, 170.0, 565.0, 420.0, 300.0, 780.0, 170.0, 1210.0, 690.0, 830.0, 180.0, 330.0, 200.0, 340.0, 520.0, 1190.0, 190.0, 480.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [40.0, -50.0, -80.0, 60.0, 40.0, 300.0, 260.0, 40.0, -30.0, 120.0, 370.0, 60.0, 40.0, 90.0, 130.0, 10.0, 90.0, 250.0, 10.0, 150.0, -20.0, 20.0, 20.0, 0.0, 10.0, 70.0, 40.0, 30.0, 280.0, 260.0, 10.0, 110.0, 30.0, 40.0, 200.0, 160.0, 50.0, 170.0, 150.0, 0.0, 30.0, 50.0, 30.0, 20.0, 0.0, 360.0, 50.0, 120.0, 170.0, 20.0, -40.0, 30.0, 90.0, 60.0, 40.0, -50.0, 140.0, 370.0, 30.0, 30.0, 0.0, 50.0, 20.0, 560.0, 50.0, 10.0, -10.0, 180.0, 40.0, 10.0, 20.0, 250.0, 0.0, 20.0, 40.0, 10.0, 60.0, 0.0, 10.0, 30.0, 40.0, 40.0, 0.0, 40.0, 10.0, 0.0, 0.0, 100.0, 20.0, 0.0, 30.0, 10.0, -20.0, 0.0, 180.0, 30.0, 20.0, 10.0, 150.0, 40.0, 90.0, 40.0, 100.0, 20.0, 300.0, 160.0, 310.0, 30.0, 0.0, 10.0, 40.0, 20.0, 10.0, 110.0, 60.0, 30.0, 0.0, 10.0, 40.0, 30.0, 70.0, 20.0, 20.0, 10.0, 60.0, 10.0, 90.0, 30.0, 40.0, 160.0, 10.0, 0.0, 40.0, 0.0, 0.0, 80.0, 30.0, 10.0, 20.0, 70.0, 20.0, 40.0, 30.0, 10.0, 70.0, 110.0, 0.0, 40.0, 0.0, 10.0, 20.0, 30.0, 0.0, 20.0, 30.0, 10.0, 20.0, 30.0, 260.0, 0.0, 770.0, 80.0, 0.0, 40.0, 40.0, 50.0, 20.0, -20.0, 70.0, 70.0, 30.0, 10.0, 0.0, 30.0, 20.0, 0.0, 10.0, 170.0, 0.0, 30.0, 100.0, 90.0, 30.0, 480.0, 20.0, 60.0, 50.0, 70.0, 30.0, 270.0, 30.0, 10.0, 80.0, 0.0, 370.0, -10.0, 80.0, 130.0, 0.0, 10.0, 10.0, 110.0, 60.0, 0.0, 40.0, 90.0, 10.0, 30.0, 280.0, 0.0, 20.0, 80.0, 160.0, 20.0, 30.0, 250.0, 70.0, 30.0, 40.0, 60.0, 20.0, 0.0, 40.0, 590.0, 20.0, 10.0, 20.0, 50.0, 100.0, 80.0, 20.0, 150.0, 0.0, 30.0, 40.0, 0.0, 20.0, 40.0, 0.0, 0.0, 20.0, 0.0, 70.0, 40.0, 20.0, 0.0, 30.0, 20.0, 100.0, 0.0, 20.0, 80.0, 20.0, 10.0, 20.0, 30.0, 30.0, 40.0, 0.0, 0.0, 40.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 30.0, 470.0, 10.0, 150.0, 20.0, 10.0, 10.0, 40.0, 10.0, 0.0, 20.0, 20.0, 40.0, 10.0, 0.0, 490.0, 10.0, 30.0, 10.0, 20.0, 20.0, 20.0, 0.0, 30.0, 40.0, 0.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 40.0, 0.0, 110.0, 40.0, 150.0, 10.0, 40.0, 40.0, 10.0, 80.0, 0.0, 30.0, 180.0, 10.0, 40.0, 20.0, 10.0, -100.0, 10.0, 10.0, 40.0, 90.0, 50.0, 150.0, 20.0, 40.0, 10.0, 10.0, 10.0, 250.0, 30.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 10.0, 0.0, 20.0, 170.0, 130.0, 40.0, 60.0, 10.0, 50.0, 90.0, 20.0, 30.0, 0.0, 310.0, 0.0, 10.0, 20.0, 20.0, 10.0, 30.0, 20.0, 20.0, 380.0, 20.0, 10.0, 70.0, 40.0, 30.0, 10.0, 50.0, 30.0, 40.0, 100.0, 70.0, 10.0, 10.0, 30.0, 160.0, 90.0, 40.0, 0.0, 140.0, 10.0, 560.0, -20.0, 10.0, -20.0, 20.0, 10.0, 30.0, 0.0, -90.0, 10.0, 50.0, 10.0, 100.0, 70.0, 35.0, 40.0, 40.0, 610.0, 130.0, 80.0, 170.0, 20.0, 0.0, 40.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 1050.0, 110.0, 30.0, 10.0, 70.0, 80.0, 370.0, 30.0, 90.0, 510.0, 0.0, 20.0, 10.0, 100.0, 50.0, 50.0, 20.0, 40.0, 50.0, 0.0, 80.0, 30.0, 10.0, 300.0, 170.0, 10.0, 70.0, 30.0, 10.0, 30.0, 20.0, 20.0, 310.0, 0.0, 0.0, 40.0, 50.0, 10.0, 10.0, -120.0, 170.0, 170.0, 40.0, -100.0, 10.0, 20.0, 0.0, 370.0, 30.0, 0.0, -20.0, 20.0, 0.0, 20.0, 30.0, 70.0, 60.0, 60.0, 275.0, 310.0, 170.0, 60.0, 10.0, 10.0, 490.0, 0.0, 390.0, 30.0, 340.0, 20.0, 70.0, -20.0, 40.0, 40.0, 40.0, 70.0, 40.0, 170.0, 0.0, 150.0, 0.0, 40.0, 50.0, 10.0, 70.0, -10.0, 150.0, 200.0, 30.0, 60.0, 610.0, 60.0, 90.0, 60.0, 50.0, 70.0, 50.0, 0.0, 10.0, 40.0, 140.0, 20.0, 20.0, 30.0, 20.0, 20.0, 150.0, 100.0, 20.0, 30.0, 100.0, 0.0, 20.0, 20.0, 30.0, 35.0, 40.0, 15.0, -210.0, -40.0, 140.0, 130.0, 230.0, 0.0, 20.0, 0.0, 50.0, 180.0, 15.0, 0.0, 190.0, 30.0, 40.0, 40.0, 10.0, 0.0, 30.0, 30.0, 20.0, 40.0, 330.0, 0.0, 10.0, 50.0, 280.0, 80.0, 20.0, 30.0, 150.0, 60.0, 20.0, 30.0, 0.0, 10.0, 260.0, 0.0, 0.0, 40.0, 80.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0, 220.0, 0.0, 140.0, 20.0, 20.0, 90.0, 40.0, 40.0, 80.0, 40.0, 50.0, 20.0, 110.0, 40.0, 0.0, 200.0, 30.0, 150.0, 10.0, 30.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 90.0, 40.0, 50.0, 30.0, 60.0, 40.0, 280.0, 20.0, 10.0, 0.0, 10.0, 150.0, 0.0, 20.0, 30.0, 260.0, 50.0, 10.0, 10.0, 20.0, 760.0, 120.0, 380.0, 30.0, 70.0, 10.0, 40.0, 30.0, 20.0, 0.0, 330.0, 40.0, 160.0, -20.0, 100.0, 60.0, 210.0, 70.0, 10.0, 10.0, 90.0, 20.0, 0.0, 70.0, 0.0, 40.0, 100.0, 180.0, 300.0, 40.0, 70.0, 250.0, 20.0, 380.0, 130.0, -20.0, 0.0, 100.0, 310.0, 35.0, 40.0, 40.0, 60.0, 40.0, 40.0, 50.0, 210.0, 70.0, 10.0, 10.0, 10.0, 30.0, 60.0, 0.0, 10.0, 20.0, 0.0, 0.0, 30.0, 20.0, 30.0, 20.0, 10.0, 120.0, 10.0, 20.0, 40.0, 60.0, 280.0, 20.0, 10.0, 180.0, 30.0, 20.0, 20.0, 0.0, 80.0, 40.0, 20.0, 90.0, 10.0, -35.0, 10.0, 80.0, 80.0, 10.0, 100.0, 40.0, 0.0, 30.0, 40.0, 30.0, 10.0, 10.0, 20.0, 0.0, 70.0, 10.0, 50.0, 10.0, 580.0, 80.0, 20.0, 10.0, 10.0, 30.0, 30.0, 20.0, 560.0, 160.0, 480.0, -20.0, -40.0, 20.0, 40.0, 0.0, 180.0, 0.0, 10.0, 20.0, 10.0, 0.0, 370.0, 350.0, 70.0, 20.0, 40.0, -50.0, 10.0, 90.0, 90.0, 40.0, 60.0, 30.0, 0.0, 260.0, 0.0, 0.0, 20.0, 80.0, 10.0, 10.0, 20.0, 0.0, 20.0, 100.0, 160.0, 40.0, 150.0, 0.0, 30.0, 40.0, 10.0, 0.0, 50.0, 160.0, 190.0, 350.0, 40.0, 50.0, 20.0, 30.0, 60.0, 550.0, 20.0, 10.0, 0.0, 40.0, 10.0, 40.0, 70.0, 190.0, 70.0, 40.0, 60.0, 20.0, 30.0, 150.0, 30.0, 20.0, 30.0, 20.0, 0.0, 40.0, 30.0, 190.0, 50.0, 40.0, 30.0, 60.0, 10.0, 200.0, 40.0, 40.0, 40.0, 40.0, 20.0, 110.0, 0.0, 50.0, 30.0, 40.0, 0.0, 70.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 470.0, 5.0, 10.0, 20.0, 50.0, 0.0, 10.0, 50.0, 0.0, 40.0, 250.0, 0.0, 10.0, 10.0, 10.0, 170.0, 0.0, 0.0, 10.0, 60.0, 10.0, 20.0, 0.0, 20.0, 30.0, 80.0, 30.0, 490.0, 40.0, 30.0, 40.0, 10.0, 0.0, 30.0, 10.0, 10.0, 20.0, 10.0, 40.0, 0.0, 30.0, 20.0, 30.0, 0.0, 60.0, 160.0, 60.0, 0.0, 40.0, 90.0, 600.0, 40.0, 40.0, 120.0, 20.0, 0.0, 20.0, 330.0, 160.0, 50.0, 40.0, 20.0, 10.0, 40.0, 0.0, 40.0, 80.0, 270.0, 20.0, 70.0, 40.0, 40.0, 250.0, 20.0, 50.0, 0.0, 0.0, 60.0, 10.0, 0.0, 30.0, 0.0, 10.0, 20.0, 260.0, 30.0, -50.0, -50.0, 40.0, 10.0, 50.0, 40.0, 20.0, -20.0, 40.0, 20.0, 30.0, 0.0, 30.0, 30.0, 20.0, 10.0, 20.0, 0.0, 0.0, 10.0, 40.0, -40.0, 20.0, 30.0, 40.0, 200.0, 40.0, 0.0, 70.0, 0.0, 0.0, 20.0, 30.0, 60.0, 20.0, 180.0, 130.0, 10.0, 560.0, 40.0, 280.0, 40.0, 100.0, 20.0, 70.0, 60.0, 10.0, 10.0, 40.0, 30.0, 20.0, 0.0, 0.0, 50.0, 0.0, 20.0, 0.0, 30.0, 10.0, 40.0, 0.0, 40.0, 270.0, 10.0, 10.0, 20.0, 0.0, 80.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4119268951319277, "mean_inference_ms": 1.6126430101305471, "mean_action_processing_ms": 0.42025683510785344, "mean_env_wait_ms": 1.2980321612392396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06255865097045898, "StateBufferConnector_ms": 0.009571075439453125, "ViewRequirementAgentConnector_ms": 0.3738737106323242}, "num_episodes": 22, "episode_return_max": 1515.0, "episode_return_min": 110.0, "episode_return_mean": 623.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.0574015266065, "num_env_steps_trained_throughput_per_sec": 36.0574015266065, "timesteps_total": 544000, "num_env_steps_sampled_lifetime": 544000, "num_agent_steps_sampled_lifetime": 5440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5440000, "timers": {"training_iteration_time_ms": 110277.101, "restore_workers_time_ms": 0.011, "training_step_time_ms": 110277.054, "sample_time_ms": 2390.197, "learn_time_ms": 107866.723, "learn_throughput": 37.083, "synch_weights_time_ms": 11.846}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 5440000, "num_agent_steps_trained": 5440000}, "done": false, "training_iteration": 136, "trial_id": "57140_00000", "date": "2024-06-27_03-29-50", "timestamp": 1719473390, "time_this_iter_s": 110.94963717460632, "time_total_s": 15314.791401386261, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23f7040>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15314.791401386261, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 16.391025641025642, "ram_util_percent": 78.43782051282054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6857558848219303, "cur_kl_coeff": 1.186323057275535, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.004519952213316283, "vf_loss": 3.9704877939467993, "vf_explained_var": 3.3923967704732326e-05, "kl": Infinity, "entropy": 0.3562146100040061, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1281735.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000}, "env_runners": {"episode_reward_max": 1515.0, "episode_reward_min": -160.0, "episode_reward_mean": 610.55, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -600.0}, "policy_reward_max": {"policy_0": 1050.0}, "policy_reward_mean": {"policy_0": 61.055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1200.0, 700.0, 630.0, 760.0, 930.0, 300.0, 300.0, 250.0, 590.0, 290.0, 650.0, 170.0, 520.0, 210.0, 670.0, 120.0, 600.0, 820.0, 400.0, 560.0, 510.0, 1165.0, 270.0, 1340.0, 1260.0, 750.0, 500.0, 280.0, 470.0, 1515.0, 950.0, 600.0, 1300.0, 400.0, 490.0, 360.0, 555.0, 790.0, 660.0, 230.0, 690.0, 640.0, 110.0, 620.0, 560.0, 1460.0, 970.0, 840.0, 1275.0, 570.0, 180.0, 610.0, 490.0, 325.0, 250.0, 1500.0, 690.0, 910.0, 580.0, 510.0, 920.0, 780.0, 680.0, 490.0, 550.0, 170.0, 565.0, 420.0, 300.0, 780.0, 170.0, 1210.0, 690.0, 830.0, 180.0, 330.0, 200.0, 340.0, 520.0, 1190.0, 190.0, 480.0, 960.0, 530.0, 970.0, 790.0, 930.0, 770.0, 330.0, 310.0, 1250.0, 880.0, 290.0, 210.0, -160.0, 145.0, 790.0, 210.0, 350.0, 670.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [100.0, 90.0, 30.0, 480.0, 20.0, 60.0, 50.0, 70.0, 30.0, 270.0, 30.0, 10.0, 80.0, 0.0, 370.0, -10.0, 80.0, 130.0, 0.0, 10.0, 10.0, 110.0, 60.0, 0.0, 40.0, 90.0, 10.0, 30.0, 280.0, 0.0, 20.0, 80.0, 160.0, 20.0, 30.0, 250.0, 70.0, 30.0, 40.0, 60.0, 20.0, 0.0, 40.0, 590.0, 20.0, 10.0, 20.0, 50.0, 100.0, 80.0, 20.0, 150.0, 0.0, 30.0, 40.0, 0.0, 20.0, 40.0, 0.0, 0.0, 20.0, 0.0, 70.0, 40.0, 20.0, 0.0, 30.0, 20.0, 100.0, 0.0, 20.0, 80.0, 20.0, 10.0, 20.0, 30.0, 30.0, 40.0, 0.0, 0.0, 40.0, 10.0, 10.0, 20.0, 10.0, 0.0, 0.0, 0.0, 30.0, 470.0, 10.0, 150.0, 20.0, 10.0, 10.0, 40.0, 10.0, 0.0, 20.0, 20.0, 40.0, 10.0, 0.0, 490.0, 10.0, 30.0, 10.0, 20.0, 20.0, 20.0, 0.0, 30.0, 40.0, 0.0, 10.0, 20.0, 20.0, 10.0, 20.0, 20.0, 40.0, 0.0, 110.0, 40.0, 150.0, 10.0, 40.0, 40.0, 10.0, 80.0, 0.0, 30.0, 180.0, 10.0, 40.0, 20.0, 10.0, -100.0, 10.0, 10.0, 40.0, 90.0, 50.0, 150.0, 20.0, 40.0, 10.0, 10.0, 10.0, 250.0, 30.0, 10.0, 0.0, 0.0, 0.0, 30.0, 20.0, 10.0, 0.0, 20.0, 170.0, 130.0, 40.0, 60.0, 10.0, 50.0, 90.0, 20.0, 30.0, 0.0, 310.0, 0.0, 10.0, 20.0, 20.0, 10.0, 30.0, 20.0, 20.0, 380.0, 20.0, 10.0, 70.0, 40.0, 30.0, 10.0, 50.0, 30.0, 40.0, 100.0, 70.0, 10.0, 10.0, 30.0, 160.0, 90.0, 40.0, 0.0, 140.0, 10.0, 560.0, -20.0, 10.0, -20.0, 20.0, 10.0, 30.0, 0.0, -90.0, 10.0, 50.0, 10.0, 100.0, 70.0, 35.0, 40.0, 40.0, 610.0, 130.0, 80.0, 170.0, 20.0, 0.0, 40.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 1050.0, 110.0, 30.0, 10.0, 70.0, 80.0, 370.0, 30.0, 90.0, 510.0, 0.0, 20.0, 10.0, 100.0, 50.0, 50.0, 20.0, 40.0, 50.0, 0.0, 80.0, 30.0, 10.0, 300.0, 170.0, 10.0, 70.0, 30.0, 10.0, 30.0, 20.0, 20.0, 310.0, 0.0, 0.0, 40.0, 50.0, 10.0, 10.0, -120.0, 170.0, 170.0, 40.0, -100.0, 10.0, 20.0, 0.0, 370.0, 30.0, 0.0, -20.0, 20.0, 0.0, 20.0, 30.0, 70.0, 60.0, 60.0, 275.0, 310.0, 170.0, 60.0, 10.0, 10.0, 490.0, 0.0, 390.0, 30.0, 340.0, 20.0, 70.0, -20.0, 40.0, 40.0, 40.0, 70.0, 40.0, 170.0, 0.0, 150.0, 0.0, 40.0, 50.0, 10.0, 70.0, -10.0, 150.0, 200.0, 30.0, 60.0, 610.0, 60.0, 90.0, 60.0, 50.0, 70.0, 50.0, 0.0, 10.0, 40.0, 140.0, 20.0, 20.0, 30.0, 20.0, 20.0, 150.0, 100.0, 20.0, 30.0, 100.0, 0.0, 20.0, 20.0, 30.0, 35.0, 40.0, 15.0, -210.0, -40.0, 140.0, 130.0, 230.0, 0.0, 20.0, 0.0, 50.0, 180.0, 15.0, 0.0, 190.0, 30.0, 40.0, 40.0, 10.0, 0.0, 30.0, 30.0, 20.0, 40.0, 330.0, 0.0, 10.0, 50.0, 280.0, 80.0, 20.0, 30.0, 150.0, 60.0, 20.0, 30.0, 0.0, 10.0, 260.0, 0.0, 0.0, 40.0, 80.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0, 220.0, 0.0, 140.0, 20.0, 20.0, 90.0, 40.0, 40.0, 80.0, 40.0, 50.0, 20.0, 110.0, 40.0, 0.0, 200.0, 30.0, 150.0, 10.0, 30.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 90.0, 40.0, 50.0, 30.0, 60.0, 40.0, 280.0, 20.0, 10.0, 0.0, 10.0, 150.0, 0.0, 20.0, 30.0, 260.0, 50.0, 10.0, 10.0, 20.0, 760.0, 120.0, 380.0, 30.0, 70.0, 10.0, 40.0, 30.0, 20.0, 0.0, 330.0, 40.0, 160.0, -20.0, 100.0, 60.0, 210.0, 70.0, 10.0, 10.0, 90.0, 20.0, 0.0, 70.0, 0.0, 40.0, 100.0, 180.0, 300.0, 40.0, 70.0, 250.0, 20.0, 380.0, 130.0, -20.0, 0.0, 100.0, 310.0, 35.0, 40.0, 40.0, 60.0, 40.0, 40.0, 50.0, 210.0, 70.0, 10.0, 10.0, 10.0, 30.0, 60.0, 0.0, 10.0, 20.0, 0.0, 0.0, 30.0, 20.0, 30.0, 20.0, 10.0, 120.0, 10.0, 20.0, 40.0, 60.0, 280.0, 20.0, 10.0, 180.0, 30.0, 20.0, 20.0, 0.0, 80.0, 40.0, 20.0, 90.0, 10.0, -35.0, 10.0, 80.0, 80.0, 10.0, 100.0, 40.0, 0.0, 30.0, 40.0, 30.0, 10.0, 10.0, 20.0, 0.0, 70.0, 10.0, 50.0, 10.0, 580.0, 80.0, 20.0, 10.0, 10.0, 30.0, 30.0, 20.0, 560.0, 160.0, 480.0, -20.0, -40.0, 20.0, 40.0, 0.0, 180.0, 0.0, 10.0, 20.0, 10.0, 0.0, 370.0, 350.0, 70.0, 20.0, 40.0, -50.0, 10.0, 90.0, 90.0, 40.0, 60.0, 30.0, 0.0, 260.0, 0.0, 0.0, 20.0, 80.0, 10.0, 10.0, 20.0, 0.0, 20.0, 100.0, 160.0, 40.0, 150.0, 0.0, 30.0, 40.0, 10.0, 0.0, 50.0, 160.0, 190.0, 350.0, 40.0, 50.0, 20.0, 30.0, 60.0, 550.0, 20.0, 10.0, 0.0, 40.0, 10.0, 40.0, 70.0, 190.0, 70.0, 40.0, 60.0, 20.0, 30.0, 150.0, 30.0, 20.0, 30.0, 20.0, 0.0, 40.0, 30.0, 190.0, 50.0, 40.0, 30.0, 60.0, 10.0, 200.0, 40.0, 40.0, 40.0, 40.0, 20.0, 110.0, 0.0, 50.0, 30.0, 40.0, 0.0, 70.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 470.0, 5.0, 10.0, 20.0, 50.0, 0.0, 10.0, 50.0, 0.0, 40.0, 250.0, 0.0, 10.0, 10.0, 10.0, 170.0, 0.0, 0.0, 10.0, 60.0, 10.0, 20.0, 0.0, 20.0, 30.0, 80.0, 30.0, 490.0, 40.0, 30.0, 40.0, 10.0, 0.0, 30.0, 10.0, 10.0, 20.0, 10.0, 40.0, 0.0, 30.0, 20.0, 30.0, 0.0, 60.0, 160.0, 60.0, 0.0, 40.0, 90.0, 600.0, 40.0, 40.0, 120.0, 20.0, 0.0, 20.0, 330.0, 160.0, 50.0, 40.0, 20.0, 10.0, 40.0, 0.0, 40.0, 80.0, 270.0, 20.0, 70.0, 40.0, 40.0, 250.0, 20.0, 50.0, 0.0, 0.0, 60.0, 10.0, 0.0, 30.0, 0.0, 10.0, 20.0, 260.0, 30.0, -50.0, -50.0, 40.0, 10.0, 50.0, 40.0, 20.0, -20.0, 40.0, 20.0, 30.0, 0.0, 30.0, 30.0, 20.0, 10.0, 20.0, 0.0, 0.0, 10.0, 40.0, -40.0, 20.0, 30.0, 40.0, 200.0, 40.0, 0.0, 70.0, 0.0, 0.0, 20.0, 30.0, 60.0, 20.0, 180.0, 130.0, 10.0, 560.0, 40.0, 280.0, 40.0, 100.0, 20.0, 70.0, 60.0, 10.0, 10.0, 40.0, 30.0, 20.0, 0.0, 0.0, 50.0, 0.0, 20.0, 0.0, 30.0, 10.0, 40.0, 0.0, 40.0, 270.0, 10.0, 10.0, 20.0, 0.0, 80.0, 160.0, 40.0, 230.0, 270.0, 10.0, 10.0, 0.0, 150.0, 50.0, 40.0, 20.0, 0.0, 0.0, 10.0, 10.0, 250.0, 30.0, 160.0, 50.0, 0.0, 60.0, 40.0, 20.0, 10.0, 30.0, 70.0, 10.0, 70.0, 190.0, 470.0, 10.0, 190.0, 60.0, 260.0, 80.0, 30.0, 40.0, 20.0, 30.0, 70.0, -50.0, 0.0, 0.0, 190.0, 560.0, 110.0, 10.0, 30.0, 20.0, 60.0, -10.0, 70.0, 30.0, 350.0, 60.0, 200.0, 20.0, 0.0, 50.0, 0.0, 0.0, 30.0, 0.0, 30.0, 60.0, 40.0, 70.0, 40.0, 20.0, 40.0, 20.0, 40.0, 0.0, 50.0, 30.0, 0.0, 40.0, -50.0, 170.0, 10.0, 60.0, 220.0, 40.0, 40.0, 0.0, 10.0, 180.0, 210.0, 460.0, 30.0, 80.0, 10.0, 30.0, 160.0, 70.0, 40.0, 20.0, 70.0, 370.0, 30.0, 80.0, 30.0, 0.0, 50.0, 10.0, 20.0, 20.0, 0.0, 70.0, 10.0, 0.0, 20.0, 20.0, 10.0, 40.0, 0.0, 50.0, 20.0, 10.0, 40.0, 10.0, 0.0, 150.0, 40.0, 0.0, 20.0, 10.0, 30.0, -600.0, 180.0, 60.0, 10.0, 10.0, 30.0, 0.0, 0.0, 15.0, 0.0, 20.0, 0.0, 160.0, 550.0, 10.0, -40.0, -30.0, 30.0, 40.0, 40.0, 130.0, -100.0, 0.0, 40.0, 40.0, 30.0, 30.0, 40.0, 10.0, 10.0, 10.0, 0.0, 10.0, 40.0, 0.0, 30.0, 30.0, 20.0, 50.0, 30.0, 100.0, 40.0, 0.0, 70.0, 0.0, 40.0, 270.0, 10.0, 0.0, 160.0, 100.0, 20.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4112940446601072, "mean_inference_ms": 1.6120403355572812, "mean_action_processing_ms": 0.42001132221353304, "mean_env_wait_ms": 1.2975644844441152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.06224822998046875, "StateBufferConnector_ms": 0.009488105773925781, "ViewRequirementAgentConnector_ms": 0.3711831569671631}, "num_episodes": 18, "episode_return_max": 1515.0, "episode_return_min": -160.0, "episode_return_mean": 610.55}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.14783453084466, "num_env_steps_trained_throughput_per_sec": 36.14783453084466, "timesteps_total": 548000, "num_env_steps_sampled_lifetime": 548000, "num_agent_steps_sampled_lifetime": 5480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5480000, "timers": {"training_iteration_time_ms": 110348.443, "restore_workers_time_ms": 0.011, "training_step_time_ms": 110348.396, "sample_time_ms": 2387.591, "learn_time_ms": 107940.627, "learn_throughput": 37.057, "synch_weights_time_ms": 11.99}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 5480000, "num_agent_steps_trained": 5480000}, "done": false, "training_iteration": 137, "trial_id": "57140_00000", "date": "2024-06-27_03-31-40", "timestamp": 1719473500, "time_this_iter_s": 110.66964197158813, "time_total_s": 15425.46104335785, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18cb670>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15425.46104335785, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 15.589171974522293, "ram_util_percent": 78.75541401273885}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.871715859914867, "cur_kl_coeff": 1.7794845859133024, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0032190916405113452, "vf_loss": 4.36822174570431, "vf_explained_var": -8.19075539216193e-05, "kl": Infinity, "entropy": 0.3421816399890267, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1291125.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000}, "env_runners": {"episode_reward_max": 1515.0, "episode_reward_min": -160.0, "episode_reward_mean": 620.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -600.0}, "policy_reward_max": {"policy_0": 1050.0}, "policy_reward_mean": {"policy_0": 62.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [400.0, 560.0, 510.0, 1165.0, 270.0, 1340.0, 1260.0, 750.0, 500.0, 280.0, 470.0, 1515.0, 950.0, 600.0, 1300.0, 400.0, 490.0, 360.0, 555.0, 790.0, 660.0, 230.0, 690.0, 640.0, 110.0, 620.0, 560.0, 1460.0, 970.0, 840.0, 1275.0, 570.0, 180.0, 610.0, 490.0, 325.0, 250.0, 1500.0, 690.0, 910.0, 580.0, 510.0, 920.0, 780.0, 680.0, 490.0, 550.0, 170.0, 565.0, 420.0, 300.0, 780.0, 170.0, 1210.0, 690.0, 830.0, 180.0, 330.0, 200.0, 340.0, 520.0, 1190.0, 190.0, 480.0, 960.0, 530.0, 970.0, 790.0, 930.0, 770.0, 330.0, 310.0, 1250.0, 880.0, 290.0, 210.0, -160.0, 145.0, 790.0, 210.0, 350.0, 670.0, 695.0, 260.0, 600.0, 560.0, 1070.0, 1070.0, 1330.0, 580.0, 530.0, 560.0, 510.0, 280.0, 130.0, 520.0, 1100.0, 150.0, 140.0, 615.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 10.0, 70.0, 40.0, 30.0, 10.0, 50.0, 30.0, 40.0, 100.0, 70.0, 10.0, 10.0, 30.0, 160.0, 90.0, 40.0, 0.0, 140.0, 10.0, 560.0, -20.0, 10.0, -20.0, 20.0, 10.0, 30.0, 0.0, -90.0, 10.0, 50.0, 10.0, 100.0, 70.0, 35.0, 40.0, 40.0, 610.0, 130.0, 80.0, 170.0, 20.0, 0.0, 40.0, 10.0, 10.0, 0.0, 0.0, 20.0, 0.0, 0.0, 20.0, 30.0, 20.0, 0.0, 1050.0, 110.0, 30.0, 10.0, 70.0, 80.0, 370.0, 30.0, 90.0, 510.0, 0.0, 20.0, 10.0, 100.0, 50.0, 50.0, 20.0, 40.0, 50.0, 0.0, 80.0, 30.0, 10.0, 300.0, 170.0, 10.0, 70.0, 30.0, 10.0, 30.0, 20.0, 20.0, 310.0, 0.0, 0.0, 40.0, 50.0, 10.0, 10.0, -120.0, 170.0, 170.0, 40.0, -100.0, 10.0, 20.0, 0.0, 370.0, 30.0, 0.0, -20.0, 20.0, 0.0, 20.0, 30.0, 70.0, 60.0, 60.0, 275.0, 310.0, 170.0, 60.0, 10.0, 10.0, 490.0, 0.0, 390.0, 30.0, 340.0, 20.0, 70.0, -20.0, 40.0, 40.0, 40.0, 70.0, 40.0, 170.0, 0.0, 150.0, 0.0, 40.0, 50.0, 10.0, 70.0, -10.0, 150.0, 200.0, 30.0, 60.0, 610.0, 60.0, 90.0, 60.0, 50.0, 70.0, 50.0, 0.0, 10.0, 40.0, 140.0, 20.0, 20.0, 30.0, 20.0, 20.0, 150.0, 100.0, 20.0, 30.0, 100.0, 0.0, 20.0, 20.0, 30.0, 35.0, 40.0, 15.0, -210.0, -40.0, 140.0, 130.0, 230.0, 0.0, 20.0, 0.0, 50.0, 180.0, 15.0, 0.0, 190.0, 30.0, 40.0, 40.0, 10.0, 0.0, 30.0, 30.0, 20.0, 40.0, 330.0, 0.0, 10.0, 50.0, 280.0, 80.0, 20.0, 30.0, 150.0, 60.0, 20.0, 30.0, 0.0, 10.0, 260.0, 0.0, 0.0, 40.0, 80.0, 20.0, 20.0, 20.0, 30.0, 10.0, 10.0, 220.0, 0.0, 140.0, 20.0, 20.0, 90.0, 40.0, 40.0, 80.0, 40.0, 50.0, 20.0, 110.0, 40.0, 0.0, 200.0, 30.0, 150.0, 10.0, 30.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 90.0, 40.0, 50.0, 30.0, 60.0, 40.0, 280.0, 20.0, 10.0, 0.0, 10.0, 150.0, 0.0, 20.0, 30.0, 260.0, 50.0, 10.0, 10.0, 20.0, 760.0, 120.0, 380.0, 30.0, 70.0, 10.0, 40.0, 30.0, 20.0, 0.0, 330.0, 40.0, 160.0, -20.0, 100.0, 60.0, 210.0, 70.0, 10.0, 10.0, 90.0, 20.0, 0.0, 70.0, 0.0, 40.0, 100.0, 180.0, 300.0, 40.0, 70.0, 250.0, 20.0, 380.0, 130.0, -20.0, 0.0, 100.0, 310.0, 35.0, 40.0, 40.0, 60.0, 40.0, 40.0, 50.0, 210.0, 70.0, 10.0, 10.0, 10.0, 30.0, 60.0, 0.0, 10.0, 20.0, 0.0, 0.0, 30.0, 20.0, 30.0, 20.0, 10.0, 120.0, 10.0, 20.0, 40.0, 60.0, 280.0, 20.0, 10.0, 180.0, 30.0, 20.0, 20.0, 0.0, 80.0, 40.0, 20.0, 90.0, 10.0, -35.0, 10.0, 80.0, 80.0, 10.0, 100.0, 40.0, 0.0, 30.0, 40.0, 30.0, 10.0, 10.0, 20.0, 0.0, 70.0, 10.0, 50.0, 10.0, 580.0, 80.0, 20.0, 10.0, 10.0, 30.0, 30.0, 20.0, 560.0, 160.0, 480.0, -20.0, -40.0, 20.0, 40.0, 0.0, 180.0, 0.0, 10.0, 20.0, 10.0, 0.0, 370.0, 350.0, 70.0, 20.0, 40.0, -50.0, 10.0, 90.0, 90.0, 40.0, 60.0, 30.0, 0.0, 260.0, 0.0, 0.0, 20.0, 80.0, 10.0, 10.0, 20.0, 0.0, 20.0, 100.0, 160.0, 40.0, 150.0, 0.0, 30.0, 40.0, 10.0, 0.0, 50.0, 160.0, 190.0, 350.0, 40.0, 50.0, 20.0, 30.0, 60.0, 550.0, 20.0, 10.0, 0.0, 40.0, 10.0, 40.0, 70.0, 190.0, 70.0, 40.0, 60.0, 20.0, 30.0, 150.0, 30.0, 20.0, 30.0, 20.0, 0.0, 40.0, 30.0, 190.0, 50.0, 40.0, 30.0, 60.0, 10.0, 200.0, 40.0, 40.0, 40.0, 40.0, 20.0, 110.0, 0.0, 50.0, 30.0, 40.0, 0.0, 70.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 470.0, 5.0, 10.0, 20.0, 50.0, 0.0, 10.0, 50.0, 0.0, 40.0, 250.0, 0.0, 10.0, 10.0, 10.0, 170.0, 0.0, 0.0, 10.0, 60.0, 10.0, 20.0, 0.0, 20.0, 30.0, 80.0, 30.0, 490.0, 40.0, 30.0, 40.0, 10.0, 0.0, 30.0, 10.0, 10.0, 20.0, 10.0, 40.0, 0.0, 30.0, 20.0, 30.0, 0.0, 60.0, 160.0, 60.0, 0.0, 40.0, 90.0, 600.0, 40.0, 40.0, 120.0, 20.0, 0.0, 20.0, 330.0, 160.0, 50.0, 40.0, 20.0, 10.0, 40.0, 0.0, 40.0, 80.0, 270.0, 20.0, 70.0, 40.0, 40.0, 250.0, 20.0, 50.0, 0.0, 0.0, 60.0, 10.0, 0.0, 30.0, 0.0, 10.0, 20.0, 260.0, 30.0, -50.0, -50.0, 40.0, 10.0, 50.0, 40.0, 20.0, -20.0, 40.0, 20.0, 30.0, 0.0, 30.0, 30.0, 20.0, 10.0, 20.0, 0.0, 0.0, 10.0, 40.0, -40.0, 20.0, 30.0, 40.0, 200.0, 40.0, 0.0, 70.0, 0.0, 0.0, 20.0, 30.0, 60.0, 20.0, 180.0, 130.0, 10.0, 560.0, 40.0, 280.0, 40.0, 100.0, 20.0, 70.0, 60.0, 10.0, 10.0, 40.0, 30.0, 20.0, 0.0, 0.0, 50.0, 0.0, 20.0, 0.0, 30.0, 10.0, 40.0, 0.0, 40.0, 270.0, 10.0, 10.0, 20.0, 0.0, 80.0, 160.0, 40.0, 230.0, 270.0, 10.0, 10.0, 0.0, 150.0, 50.0, 40.0, 20.0, 0.0, 0.0, 10.0, 10.0, 250.0, 30.0, 160.0, 50.0, 0.0, 60.0, 40.0, 20.0, 10.0, 30.0, 70.0, 10.0, 70.0, 190.0, 470.0, 10.0, 190.0, 60.0, 260.0, 80.0, 30.0, 40.0, 20.0, 30.0, 70.0, -50.0, 0.0, 0.0, 190.0, 560.0, 110.0, 10.0, 30.0, 20.0, 60.0, -10.0, 70.0, 30.0, 350.0, 60.0, 200.0, 20.0, 0.0, 50.0, 0.0, 0.0, 30.0, 0.0, 30.0, 60.0, 40.0, 70.0, 40.0, 20.0, 40.0, 20.0, 40.0, 0.0, 50.0, 30.0, 0.0, 40.0, -50.0, 170.0, 10.0, 60.0, 220.0, 40.0, 40.0, 0.0, 10.0, 180.0, 210.0, 460.0, 30.0, 80.0, 10.0, 30.0, 160.0, 70.0, 40.0, 20.0, 70.0, 370.0, 30.0, 80.0, 30.0, 0.0, 50.0, 10.0, 20.0, 20.0, 0.0, 70.0, 10.0, 0.0, 20.0, 20.0, 10.0, 40.0, 0.0, 50.0, 20.0, 10.0, 40.0, 10.0, 0.0, 150.0, 40.0, 0.0, 20.0, 10.0, 30.0, -600.0, 180.0, 60.0, 10.0, 10.0, 30.0, 0.0, 0.0, 15.0, 0.0, 20.0, 0.0, 160.0, 550.0, 10.0, -40.0, -30.0, 30.0, 40.0, 40.0, 130.0, -100.0, 0.0, 40.0, 40.0, 30.0, 30.0, 40.0, 10.0, 10.0, 10.0, 0.0, 10.0, 40.0, 0.0, 30.0, 30.0, 20.0, 50.0, 30.0, 100.0, 40.0, 0.0, 70.0, 0.0, 40.0, 270.0, 10.0, 0.0, 160.0, 100.0, 20.0, 10.0, 130.0, 0.0, 40.0, -5.0, 160.0, 30.0, 250.0, 30.0, 50.0, 0.0, 10.0, 50.0, 0.0, 40.0, 0.0, 80.0, 40.0, 30.0, 10.0, 20.0, 10.0, 30.0, 90.0, 20.0, 50.0, 30.0, 0.0, 280.0, 70.0, 40.0, 20.0, 40.0, 10.0, 0.0, 170.0, 170.0, 20.0, 10.0, 80.0, 50.0, 60.0, 40.0, 0.0, -20.0, 450.0, 30.0, 300.0, 80.0, 80.0, 40.0, 40.0, 60.0, 10.0, 40.0, 90.0, 450.0, 160.0, 100.0, 80.0, 50.0, 220.0, 670.0, 170.0, 20.0, 40.0, 80.0, 40.0, 20.0, 20.0, 40.0, 0.0, 50.0, 30.0, 110.0, 180.0, 150.0, 10.0, 0.0, 10.0, -20.0, 10.0, 30.0, 10.0, 0.0, 30.0, 370.0, 40.0, -10.0, 70.0, 20.0, 40.0, 50.0, 120.0, 180.0, 20.0, 10.0, 40.0, 40.0, 40.0, 0.0, 50.0, 20.0, 0.0, 150.0, 10.0, 260.0, 0.0, 10.0, 10.0, 20.0, -40.0, 40.0, 0.0, 0.0, 30.0, 150.0, 10.0, 30.0, 40.0, 0.0, 10.0, 10.0, 20.0, 30.0, 0.0, 0.0, 20.0, 20.0, 20.0, 150.0, 10.0, 0.0, 20.0, 70.0, 10.0, 30.0, 190.0, 30.0, 10.0, 50.0, 310.0, 80.0, 40.0, 170.0, -50.0, 20.0, 30.0, 190.0, 260.0, 0.0, 40.0, 0.0, 0.0, 30.0, 10.0, 0.0, 40.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 30.0, 20.0, 10.0, 10.0, 20.0, 20.0, 30.0, 10.0, 210.0, 260.0, 0.0, 70.0, 20.0, 0.0, -5.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.410690301986035, "mean_inference_ms": 1.611386389671714, "mean_action_processing_ms": 0.4197910901478982, "mean_env_wait_ms": 1.2971084668407402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.062055110931396484, "StateBufferConnector_ms": 0.011654376983642578, "ViewRequirementAgentConnector_ms": 0.36750102043151855}, "num_episodes": 18, "episode_return_max": 1515.0, "episode_return_min": -160.0, "episode_return_mean": 620.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.2303616589417, "num_env_steps_trained_throughput_per_sec": 36.2303616589417, "timesteps_total": 552000, "num_env_steps_sampled_lifetime": 552000, "num_agent_steps_sampled_lifetime": 5520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5520000, "timers": {"training_iteration_time_ms": 110379.626, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110379.577, "sample_time_ms": 2379.166, "learn_time_ms": 107980.108, "learn_throughput": 37.044, "synch_weights_time_ms": 12.023}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 5520000, "num_agent_steps_trained": 5520000}, "done": false, "training_iteration": 138, "trial_id": "57140_00000", "date": "2024-06-27_03-33-31", "timestamp": 1719473611, "time_this_iter_s": 110.41723108291626, "time_total_s": 15535.878274440765, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b25c24c0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15535.878274440765, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 15.550641025641026, "ram_util_percent": 78.82307692307693}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9203132577756215, "cur_kl_coeff": 2.669226878869954, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.003082796909967368, "vf_loss": 3.8176584869401013, "vf_explained_var": -7.079328718784645e-05, "kl": Infinity, "entropy": 0.3908074954447274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1300515.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000}, "env_runners": {"episode_reward_max": 1500.0, "episode_reward_min": -160.0, "episode_reward_mean": 581.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -600.0}, "policy_reward_max": {"policy_0": 760.0}, "policy_reward_mean": {"policy_0": 58.11}, "custom_metrics": {}, "hist_stats": {"episode_reward": [640.0, 110.0, 620.0, 560.0, 1460.0, 970.0, 840.0, 1275.0, 570.0, 180.0, 610.0, 490.0, 325.0, 250.0, 1500.0, 690.0, 910.0, 580.0, 510.0, 920.0, 780.0, 680.0, 490.0, 550.0, 170.0, 565.0, 420.0, 300.0, 780.0, 170.0, 1210.0, 690.0, 830.0, 180.0, 330.0, 200.0, 340.0, 520.0, 1190.0, 190.0, 480.0, 960.0, 530.0, 970.0, 790.0, 930.0, 770.0, 330.0, 310.0, 1250.0, 880.0, 290.0, 210.0, -160.0, 145.0, 790.0, 210.0, 350.0, 670.0, 695.0, 260.0, 600.0, 560.0, 1070.0, 1070.0, 1330.0, 580.0, 530.0, 560.0, 510.0, 280.0, 130.0, 520.0, 1100.0, 150.0, 140.0, 615.0, 300.0, 460.0, 560.0, 410.0, 340.0, 435.0, 510.0, 180.0, 590.0, 730.0, 1430.0, 280.0, 530.0, 380.0, 390.0, 635.0, 300.0, 600.0, 290.0, 350.0, 710.0, 555.0, 1145.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [50.0, 20.0, 110.0, 40.0, 0.0, 200.0, 30.0, 150.0, 10.0, 30.0, 20.0, 20.0, 10.0, 0.0, 10.0, 0.0, 20.0, 0.0, 10.0, 20.0, 90.0, 40.0, 50.0, 30.0, 60.0, 40.0, 280.0, 20.0, 10.0, 0.0, 10.0, 150.0, 0.0, 20.0, 30.0, 260.0, 50.0, 10.0, 10.0, 20.0, 760.0, 120.0, 380.0, 30.0, 70.0, 10.0, 40.0, 30.0, 20.0, 0.0, 330.0, 40.0, 160.0, -20.0, 100.0, 60.0, 210.0, 70.0, 10.0, 10.0, 90.0, 20.0, 0.0, 70.0, 0.0, 40.0, 100.0, 180.0, 300.0, 40.0, 70.0, 250.0, 20.0, 380.0, 130.0, -20.0, 0.0, 100.0, 310.0, 35.0, 40.0, 40.0, 60.0, 40.0, 40.0, 50.0, 210.0, 70.0, 10.0, 10.0, 10.0, 30.0, 60.0, 0.0, 10.0, 20.0, 0.0, 0.0, 30.0, 20.0, 30.0, 20.0, 10.0, 120.0, 10.0, 20.0, 40.0, 60.0, 280.0, 20.0, 10.0, 180.0, 30.0, 20.0, 20.0, 0.0, 80.0, 40.0, 20.0, 90.0, 10.0, -35.0, 10.0, 80.0, 80.0, 10.0, 100.0, 40.0, 0.0, 30.0, 40.0, 30.0, 10.0, 10.0, 20.0, 0.0, 70.0, 10.0, 50.0, 10.0, 580.0, 80.0, 20.0, 10.0, 10.0, 30.0, 30.0, 20.0, 560.0, 160.0, 480.0, -20.0, -40.0, 20.0, 40.0, 0.0, 180.0, 0.0, 10.0, 20.0, 10.0, 0.0, 370.0, 350.0, 70.0, 20.0, 40.0, -50.0, 10.0, 90.0, 90.0, 40.0, 60.0, 30.0, 0.0, 260.0, 0.0, 0.0, 20.0, 80.0, 10.0, 10.0, 20.0, 0.0, 20.0, 100.0, 160.0, 40.0, 150.0, 0.0, 30.0, 40.0, 10.0, 0.0, 50.0, 160.0, 190.0, 350.0, 40.0, 50.0, 20.0, 30.0, 60.0, 550.0, 20.0, 10.0, 0.0, 40.0, 10.0, 40.0, 70.0, 190.0, 70.0, 40.0, 60.0, 20.0, 30.0, 150.0, 30.0, 20.0, 30.0, 20.0, 0.0, 40.0, 30.0, 190.0, 50.0, 40.0, 30.0, 60.0, 10.0, 200.0, 40.0, 40.0, 40.0, 40.0, 20.0, 110.0, 0.0, 50.0, 30.0, 40.0, 0.0, 70.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 470.0, 5.0, 10.0, 20.0, 50.0, 0.0, 10.0, 50.0, 0.0, 40.0, 250.0, 0.0, 10.0, 10.0, 10.0, 170.0, 0.0, 0.0, 10.0, 60.0, 10.0, 20.0, 0.0, 20.0, 30.0, 80.0, 30.0, 490.0, 40.0, 30.0, 40.0, 10.0, 0.0, 30.0, 10.0, 10.0, 20.0, 10.0, 40.0, 0.0, 30.0, 20.0, 30.0, 0.0, 60.0, 160.0, 60.0, 0.0, 40.0, 90.0, 600.0, 40.0, 40.0, 120.0, 20.0, 0.0, 20.0, 330.0, 160.0, 50.0, 40.0, 20.0, 10.0, 40.0, 0.0, 40.0, 80.0, 270.0, 20.0, 70.0, 40.0, 40.0, 250.0, 20.0, 50.0, 0.0, 0.0, 60.0, 10.0, 0.0, 30.0, 0.0, 10.0, 20.0, 260.0, 30.0, -50.0, -50.0, 40.0, 10.0, 50.0, 40.0, 20.0, -20.0, 40.0, 20.0, 30.0, 0.0, 30.0, 30.0, 20.0, 10.0, 20.0, 0.0, 0.0, 10.0, 40.0, -40.0, 20.0, 30.0, 40.0, 200.0, 40.0, 0.0, 70.0, 0.0, 0.0, 20.0, 30.0, 60.0, 20.0, 180.0, 130.0, 10.0, 560.0, 40.0, 280.0, 40.0, 100.0, 20.0, 70.0, 60.0, 10.0, 10.0, 40.0, 30.0, 20.0, 0.0, 0.0, 50.0, 0.0, 20.0, 0.0, 30.0, 10.0, 40.0, 0.0, 40.0, 270.0, 10.0, 10.0, 20.0, 0.0, 80.0, 160.0, 40.0, 230.0, 270.0, 10.0, 10.0, 0.0, 150.0, 50.0, 40.0, 20.0, 0.0, 0.0, 10.0, 10.0, 250.0, 30.0, 160.0, 50.0, 0.0, 60.0, 40.0, 20.0, 10.0, 30.0, 70.0, 10.0, 70.0, 190.0, 470.0, 10.0, 190.0, 60.0, 260.0, 80.0, 30.0, 40.0, 20.0, 30.0, 70.0, -50.0, 0.0, 0.0, 190.0, 560.0, 110.0, 10.0, 30.0, 20.0, 60.0, -10.0, 70.0, 30.0, 350.0, 60.0, 200.0, 20.0, 0.0, 50.0, 0.0, 0.0, 30.0, 0.0, 30.0, 60.0, 40.0, 70.0, 40.0, 20.0, 40.0, 20.0, 40.0, 0.0, 50.0, 30.0, 0.0, 40.0, -50.0, 170.0, 10.0, 60.0, 220.0, 40.0, 40.0, 0.0, 10.0, 180.0, 210.0, 460.0, 30.0, 80.0, 10.0, 30.0, 160.0, 70.0, 40.0, 20.0, 70.0, 370.0, 30.0, 80.0, 30.0, 0.0, 50.0, 10.0, 20.0, 20.0, 0.0, 70.0, 10.0, 0.0, 20.0, 20.0, 10.0, 40.0, 0.0, 50.0, 20.0, 10.0, 40.0, 10.0, 0.0, 150.0, 40.0, 0.0, 20.0, 10.0, 30.0, -600.0, 180.0, 60.0, 10.0, 10.0, 30.0, 0.0, 0.0, 15.0, 0.0, 20.0, 0.0, 160.0, 550.0, 10.0, -40.0, -30.0, 30.0, 40.0, 40.0, 130.0, -100.0, 0.0, 40.0, 40.0, 30.0, 30.0, 40.0, 10.0, 10.0, 10.0, 0.0, 10.0, 40.0, 0.0, 30.0, 30.0, 20.0, 50.0, 30.0, 100.0, 40.0, 0.0, 70.0, 0.0, 40.0, 270.0, 10.0, 0.0, 160.0, 100.0, 20.0, 10.0, 130.0, 0.0, 40.0, -5.0, 160.0, 30.0, 250.0, 30.0, 50.0, 0.0, 10.0, 50.0, 0.0, 40.0, 0.0, 80.0, 40.0, 30.0, 10.0, 20.0, 10.0, 30.0, 90.0, 20.0, 50.0, 30.0, 0.0, 280.0, 70.0, 40.0, 20.0, 40.0, 10.0, 0.0, 170.0, 170.0, 20.0, 10.0, 80.0, 50.0, 60.0, 40.0, 0.0, -20.0, 450.0, 30.0, 300.0, 80.0, 80.0, 40.0, 40.0, 60.0, 10.0, 40.0, 90.0, 450.0, 160.0, 100.0, 80.0, 50.0, 220.0, 670.0, 170.0, 20.0, 40.0, 80.0, 40.0, 20.0, 20.0, 40.0, 0.0, 50.0, 30.0, 110.0, 180.0, 150.0, 10.0, 0.0, 10.0, -20.0, 10.0, 30.0, 10.0, 0.0, 30.0, 370.0, 40.0, -10.0, 70.0, 20.0, 40.0, 50.0, 120.0, 180.0, 20.0, 10.0, 40.0, 40.0, 40.0, 0.0, 50.0, 20.0, 0.0, 150.0, 10.0, 260.0, 0.0, 10.0, 10.0, 20.0, -40.0, 40.0, 0.0, 0.0, 30.0, 150.0, 10.0, 30.0, 40.0, 0.0, 10.0, 10.0, 20.0, 30.0, 0.0, 0.0, 20.0, 20.0, 20.0, 150.0, 10.0, 0.0, 20.0, 70.0, 10.0, 30.0, 190.0, 30.0, 10.0, 50.0, 310.0, 80.0, 40.0, 170.0, -50.0, 20.0, 30.0, 190.0, 260.0, 0.0, 40.0, 0.0, 0.0, 30.0, 10.0, 0.0, 40.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 30.0, 20.0, 10.0, 10.0, 20.0, 20.0, 30.0, 10.0, 210.0, 260.0, 0.0, 70.0, 20.0, 0.0, -5.0, 40.0, 0.0, 20.0, 20.0, 10.0, 100.0, 40.0, 0.0, 60.0, 10.0, 70.0, 0.0, 10.0, 30.0, 20.0, 20.0, 40.0, 260.0, 0.0, 10.0, 20.0, 270.0, 20.0, 60.0, 10.0, 20.0, 70.0, 10.0, 50.0, 30.0, 10.0, 40.0, 30.0, 20.0, 80.0, 170.0, 40.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 40.0, 30.0, 0.0, 170.0, 40.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 60.0, 20.0, 260.0, 180.0, -125.0, 10.0, 20.0, 0.0, 90.0, 290.0, 10.0, 50.0, 20.0, 0.0, 10.0, 20.0, 50.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 40.0, 30.0, 260.0, 40.0, 130.0, 70.0, 0.0, 50.0, 10.0, -10.0, -20.0, 60.0, 30.0, 20.0, 40.0, 30.0, 10.0, 420.0, -10.0, 170.0, -10.0, 30.0, 730.0, 140.0, 30.0, -50.0, 20.0, 190.0, 100.0, 60.0, 90.0, 120.0, 20.0, 20.0, 20.0, 10.0, 30.0, 0.0, 40.0, 0.0, 80.0, 60.0, 40.0, 80.0, 60.0, 160.0, 40.0, 40.0, 50.0, 10.0, 10.0, 40.0, 70.0, 0.0, 20.0, 30.0, 20.0, 160.0, 0.0, -40.0, 50.0, 70.0, 60.0, 10.0, 50.0, 160.0, 40.0, 20.0, 10.0, 20.0, 0.0, 20.0, 20.0, -50.0, 10.0, 30.0, 170.0, 460.0, -90.0, 50.0, 50.0, -15.0, 40.0, 10.0, 10.0, 40.0, 20.0, 0.0, 0.0, 80.0, 30.0, 70.0, 260.0, 180.0, 30.0, 0.0, 70.0, 0.0, 0.0, 40.0, 10.0, 10.0, 30.0, 0.0, 30.0, 40.0, 50.0, 10.0, 20.0, 60.0, 30.0, 20.0, 10.0, 0.0, 0.0, 20.0, 0.0, 260.0, 10.0, 30.0, 10.0, 10.0, 10.0, 40.0, 20.0, 20.0, 140.0, 40.0, 170.0, 50.0, 40.0, 180.0, 40.0, -10.0, 10.0, 5.0, 50.0, 0.0, 70.0, 350.0, 10.0, 30.0, 90.0, 570.0, 30.0, 20.0, 270.0, 50.0, 70.0, 20.0, 15.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4098827537356768, "mean_inference_ms": 1.610426666785512, "mean_action_processing_ms": 0.4194872621204434, "mean_env_wait_ms": 1.2964579603771313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05402827262878418, "StateBufferConnector_ms": 0.011759757995605469, "ViewRequirementAgentConnector_ms": 0.35831594467163086}, "num_episodes": 23, "episode_return_max": 1500.0, "episode_return_min": -160.0, "episode_return_mean": 581.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.117957098460145, "num_env_steps_trained_throughput_per_sec": 36.117957098460145, "timesteps_total": 556000, "num_env_steps_sampled_lifetime": 556000, "num_agent_steps_sampled_lifetime": 5560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5560000, "timers": {"training_iteration_time_ms": 110442.059, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110442.01, "sample_time_ms": 2380.615, "learn_time_ms": 108041.376, "learn_throughput": 37.023, "synch_weights_time_ms": 11.574}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 5560000, "num_agent_steps_trained": 5560000}, "done": false, "training_iteration": 139, "trial_id": "57140_00000", "date": "2024-06-27_03-35-22", "timestamp": 1719473722, "time_this_iter_s": 110.75905513763428, "time_total_s": 15646.6373295784, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18e1f70>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15646.6373295784, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 15.760509554140125, "ram_util_percent": 79.16496815286625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.5564533943248886, "cur_kl_coeff": 4.00384031830493, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.34431897984526, "policy_loss": -0.003285287165269454, "vf_loss": 4.345415244848964, "vf_explained_var": 7.871049153792084e-05, "kl": 0.0005467298887912255, "entropy": 0.36354624921648393, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1309905.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000}, "env_runners": {"episode_reward_max": 1590.0, "episode_reward_min": -160.0, "episode_reward_mean": 581.2, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -600.0}, "policy_reward_max": {"policy_0": 1120.0}, "policy_reward_mean": {"policy_0": 58.12}, "custom_metrics": {}, "hist_stats": {"episode_reward": [510.0, 920.0, 780.0, 680.0, 490.0, 550.0, 170.0, 565.0, 420.0, 300.0, 780.0, 170.0, 1210.0, 690.0, 830.0, 180.0, 330.0, 200.0, 340.0, 520.0, 1190.0, 190.0, 480.0, 960.0, 530.0, 970.0, 790.0, 930.0, 770.0, 330.0, 310.0, 1250.0, 880.0, 290.0, 210.0, -160.0, 145.0, 790.0, 210.0, 350.0, 670.0, 695.0, 260.0, 600.0, 560.0, 1070.0, 1070.0, 1330.0, 580.0, 530.0, 560.0, 510.0, 280.0, 130.0, 520.0, 1100.0, 150.0, 140.0, 615.0, 300.0, 460.0, 560.0, 410.0, 340.0, 435.0, 510.0, 180.0, 590.0, 730.0, 1430.0, 280.0, 530.0, 380.0, 390.0, 635.0, 300.0, 600.0, 290.0, 350.0, 710.0, 555.0, 1145.0, 390.0, 690.0, 1590.0, 110.0, 630.0, 1070.0, 640.0, 890.0, 350.0, 260.0, 730.0, 1440.0, 190.0, 600.0, 230.0, 920.0, 1010.0, 850.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 10.0, 20.0, 0.0, 20.0, 100.0, 160.0, 40.0, 150.0, 0.0, 30.0, 40.0, 10.0, 0.0, 50.0, 160.0, 190.0, 350.0, 40.0, 50.0, 20.0, 30.0, 60.0, 550.0, 20.0, 10.0, 0.0, 40.0, 10.0, 40.0, 70.0, 190.0, 70.0, 40.0, 60.0, 20.0, 30.0, 150.0, 30.0, 20.0, 30.0, 20.0, 0.0, 40.0, 30.0, 190.0, 50.0, 40.0, 30.0, 60.0, 10.0, 200.0, 40.0, 40.0, 40.0, 40.0, 20.0, 110.0, 0.0, 50.0, 30.0, 40.0, 0.0, 70.0, 0.0, 0.0, 20.0, 0.0, 10.0, 0.0, 0.0, 10.0, 0.0, 30.0, 10.0, 10.0, 470.0, 5.0, 10.0, 20.0, 50.0, 0.0, 10.0, 50.0, 0.0, 40.0, 250.0, 0.0, 10.0, 10.0, 10.0, 170.0, 0.0, 0.0, 10.0, 60.0, 10.0, 20.0, 0.0, 20.0, 30.0, 80.0, 30.0, 490.0, 40.0, 30.0, 40.0, 10.0, 0.0, 30.0, 10.0, 10.0, 20.0, 10.0, 40.0, 0.0, 30.0, 20.0, 30.0, 0.0, 60.0, 160.0, 60.0, 0.0, 40.0, 90.0, 600.0, 40.0, 40.0, 120.0, 20.0, 0.0, 20.0, 330.0, 160.0, 50.0, 40.0, 20.0, 10.0, 40.0, 0.0, 40.0, 80.0, 270.0, 20.0, 70.0, 40.0, 40.0, 250.0, 20.0, 50.0, 0.0, 0.0, 60.0, 10.0, 0.0, 30.0, 0.0, 10.0, 20.0, 260.0, 30.0, -50.0, -50.0, 40.0, 10.0, 50.0, 40.0, 20.0, -20.0, 40.0, 20.0, 30.0, 0.0, 30.0, 30.0, 20.0, 10.0, 20.0, 0.0, 0.0, 10.0, 40.0, -40.0, 20.0, 30.0, 40.0, 200.0, 40.0, 0.0, 70.0, 0.0, 0.0, 20.0, 30.0, 60.0, 20.0, 180.0, 130.0, 10.0, 560.0, 40.0, 280.0, 40.0, 100.0, 20.0, 70.0, 60.0, 10.0, 10.0, 40.0, 30.0, 20.0, 0.0, 0.0, 50.0, 0.0, 20.0, 0.0, 30.0, 10.0, 40.0, 0.0, 40.0, 270.0, 10.0, 10.0, 20.0, 0.0, 80.0, 160.0, 40.0, 230.0, 270.0, 10.0, 10.0, 0.0, 150.0, 50.0, 40.0, 20.0, 0.0, 0.0, 10.0, 10.0, 250.0, 30.0, 160.0, 50.0, 0.0, 60.0, 40.0, 20.0, 10.0, 30.0, 70.0, 10.0, 70.0, 190.0, 470.0, 10.0, 190.0, 60.0, 260.0, 80.0, 30.0, 40.0, 20.0, 30.0, 70.0, -50.0, 0.0, 0.0, 190.0, 560.0, 110.0, 10.0, 30.0, 20.0, 60.0, -10.0, 70.0, 30.0, 350.0, 60.0, 200.0, 20.0, 0.0, 50.0, 0.0, 0.0, 30.0, 0.0, 30.0, 60.0, 40.0, 70.0, 40.0, 20.0, 40.0, 20.0, 40.0, 0.0, 50.0, 30.0, 0.0, 40.0, -50.0, 170.0, 10.0, 60.0, 220.0, 40.0, 40.0, 0.0, 10.0, 180.0, 210.0, 460.0, 30.0, 80.0, 10.0, 30.0, 160.0, 70.0, 40.0, 20.0, 70.0, 370.0, 30.0, 80.0, 30.0, 0.0, 50.0, 10.0, 20.0, 20.0, 0.0, 70.0, 10.0, 0.0, 20.0, 20.0, 10.0, 40.0, 0.0, 50.0, 20.0, 10.0, 40.0, 10.0, 0.0, 150.0, 40.0, 0.0, 20.0, 10.0, 30.0, -600.0, 180.0, 60.0, 10.0, 10.0, 30.0, 0.0, 0.0, 15.0, 0.0, 20.0, 0.0, 160.0, 550.0, 10.0, -40.0, -30.0, 30.0, 40.0, 40.0, 130.0, -100.0, 0.0, 40.0, 40.0, 30.0, 30.0, 40.0, 10.0, 10.0, 10.0, 0.0, 10.0, 40.0, 0.0, 30.0, 30.0, 20.0, 50.0, 30.0, 100.0, 40.0, 0.0, 70.0, 0.0, 40.0, 270.0, 10.0, 0.0, 160.0, 100.0, 20.0, 10.0, 130.0, 0.0, 40.0, -5.0, 160.0, 30.0, 250.0, 30.0, 50.0, 0.0, 10.0, 50.0, 0.0, 40.0, 0.0, 80.0, 40.0, 30.0, 10.0, 20.0, 10.0, 30.0, 90.0, 20.0, 50.0, 30.0, 0.0, 280.0, 70.0, 40.0, 20.0, 40.0, 10.0, 0.0, 170.0, 170.0, 20.0, 10.0, 80.0, 50.0, 60.0, 40.0, 0.0, -20.0, 450.0, 30.0, 300.0, 80.0, 80.0, 40.0, 40.0, 60.0, 10.0, 40.0, 90.0, 450.0, 160.0, 100.0, 80.0, 50.0, 220.0, 670.0, 170.0, 20.0, 40.0, 80.0, 40.0, 20.0, 20.0, 40.0, 0.0, 50.0, 30.0, 110.0, 180.0, 150.0, 10.0, 0.0, 10.0, -20.0, 10.0, 30.0, 10.0, 0.0, 30.0, 370.0, 40.0, -10.0, 70.0, 20.0, 40.0, 50.0, 120.0, 180.0, 20.0, 10.0, 40.0, 40.0, 40.0, 0.0, 50.0, 20.0, 0.0, 150.0, 10.0, 260.0, 0.0, 10.0, 10.0, 20.0, -40.0, 40.0, 0.0, 0.0, 30.0, 150.0, 10.0, 30.0, 40.0, 0.0, 10.0, 10.0, 20.0, 30.0, 0.0, 0.0, 20.0, 20.0, 20.0, 150.0, 10.0, 0.0, 20.0, 70.0, 10.0, 30.0, 190.0, 30.0, 10.0, 50.0, 310.0, 80.0, 40.0, 170.0, -50.0, 20.0, 30.0, 190.0, 260.0, 0.0, 40.0, 0.0, 0.0, 30.0, 10.0, 0.0, 40.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 30.0, 20.0, 10.0, 10.0, 20.0, 20.0, 30.0, 10.0, 210.0, 260.0, 0.0, 70.0, 20.0, 0.0, -5.0, 40.0, 0.0, 20.0, 20.0, 10.0, 100.0, 40.0, 0.0, 60.0, 10.0, 70.0, 0.0, 10.0, 30.0, 20.0, 20.0, 40.0, 260.0, 0.0, 10.0, 20.0, 270.0, 20.0, 60.0, 10.0, 20.0, 70.0, 10.0, 50.0, 30.0, 10.0, 40.0, 30.0, 20.0, 80.0, 170.0, 40.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 40.0, 30.0, 0.0, 170.0, 40.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 60.0, 20.0, 260.0, 180.0, -125.0, 10.0, 20.0, 0.0, 90.0, 290.0, 10.0, 50.0, 20.0, 0.0, 10.0, 20.0, 50.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 40.0, 30.0, 260.0, 40.0, 130.0, 70.0, 0.0, 50.0, 10.0, -10.0, -20.0, 60.0, 30.0, 20.0, 40.0, 30.0, 10.0, 420.0, -10.0, 170.0, -10.0, 30.0, 730.0, 140.0, 30.0, -50.0, 20.0, 190.0, 100.0, 60.0, 90.0, 120.0, 20.0, 20.0, 20.0, 10.0, 30.0, 0.0, 40.0, 0.0, 80.0, 60.0, 40.0, 80.0, 60.0, 160.0, 40.0, 40.0, 50.0, 10.0, 10.0, 40.0, 70.0, 0.0, 20.0, 30.0, 20.0, 160.0, 0.0, -40.0, 50.0, 70.0, 60.0, 10.0, 50.0, 160.0, 40.0, 20.0, 10.0, 20.0, 0.0, 20.0, 20.0, -50.0, 10.0, 30.0, 170.0, 460.0, -90.0, 50.0, 50.0, -15.0, 40.0, 10.0, 10.0, 40.0, 20.0, 0.0, 0.0, 80.0, 30.0, 70.0, 260.0, 180.0, 30.0, 0.0, 70.0, 0.0, 0.0, 40.0, 10.0, 10.0, 30.0, 0.0, 30.0, 40.0, 50.0, 10.0, 20.0, 60.0, 30.0, 20.0, 10.0, 0.0, 0.0, 20.0, 0.0, 260.0, 10.0, 30.0, 10.0, 10.0, 10.0, 40.0, 20.0, 20.0, 140.0, 40.0, 170.0, 50.0, 40.0, 180.0, 40.0, -10.0, 10.0, 5.0, 50.0, 0.0, 70.0, 350.0, 10.0, 30.0, 90.0, 570.0, 30.0, 20.0, 270.0, 50.0, 70.0, 20.0, 15.0, 10.0, 60.0, 10.0, 40.0, 60.0, 20.0, 20.0, 20.0, 0.0, 40.0, 120.0, 30.0, 20.0, 60.0, 30.0, 20.0, 220.0, 180.0, 105.0, 30.0, -5.0, 30.0, 40.0, 20.0, 100.0, 30.0, 1120.0, 20.0, 10.0, 150.0, 70.0, 30.0, 0.0, 40.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 60.0, 10.0, 40.0, 370.0, 60.0, 20.0, 30.0, 20.0, 20.0, 0.0, 50.0, 130.0, 30.0, 20.0, 30.0, 20.0, 300.0, 260.0, 20.0, 210.0, 270.0, 10.0, 0.0, 30.0, 160.0, 20.0, 60.0, 10.0, 50.0, 30.0, 10.0, 350.0, 30.0, 40.0, 20.0, 110.0, 30.0, 60.0, 170.0, 70.0, 60.0, 10.0, 170.0, 10.0, 0.0, -20.0, 70.0, 0.0, 50.0, 0.0, 20.0, 30.0, 0.0, 10.0, 20.0, 40.0, 40.0, 70.0, 20.0, 10.0, 30.0, 10.0, 10.0, 0.0, 250.0, 0.0, 30.0, 0.0, 360.0, 40.0, 90.0, 10.0, 80.0, 0.0, 50.0, 20.0, 70.0, 810.0, 280.0, 30.0, 20.0, 20.0, 30.0, 10.0, 30.0, 0.0, 10.0, 40.0, 30.0, 0.0, 50.0, -100.0, 560.0, 20.0, 0.0, 20.0, 10.0, 0.0, 30.0, 10.0, 70.0, 20.0, 10.0, 0.0, 30.0, 30.0, 40.0, 30.0, 0.0, 0.0, 10.0, 40.0, 20.0, 280.0, 0.0, 120.0, 40.0, 150.0, 90.0, 170.0, 50.0, 40.0, 300.0, 290.0, 70.0, 0.0, 30.0, 170.0, 10.0, 50.0, 190.0, 20.0, 30.0, 160.0, 0.0, 0.0, 0.0, 380.0, 30.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4091865093082194, "mean_inference_ms": 1.6096105745933464, "mean_action_processing_ms": 0.41925058924284103, "mean_env_wait_ms": 1.2959318971660003, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05403494834899902, "StateBufferConnector_ms": 0.011811494827270508, "ViewRequirementAgentConnector_ms": 0.3580362796783447}, "num_episodes": 18, "episode_return_max": 1590.0, "episode_return_min": -160.0, "episode_return_mean": 581.2}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.03391293734949, "num_env_steps_trained_throughput_per_sec": 36.03391293734949, "timesteps_total": 560000, "num_env_steps_sampled_lifetime": 560000, "num_agent_steps_sampled_lifetime": 5600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5600000, "timers": {"training_iteration_time_ms": 110540.5, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110540.451, "sample_time_ms": 2373.017, "learn_time_ms": 108147.057, "learn_throughput": 36.987, "synch_weights_time_ms": 11.858}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 5600000, "num_agent_steps_trained": 5600000}, "done": false, "training_iteration": 140, "trial_id": "57140_00000", "date": "2024-06-27_03-37-13", "timestamp": 1719473833, "time_this_iter_s": 111.02053499221802, "time_total_s": 15757.657864570618, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23f7550>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15757.657864570618, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 15.68089171974522, "ram_util_percent": 79.50764331210192}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2828388089792164, "cur_kl_coeff": 2.001920159152465, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0033536292290333876, "vf_loss": 3.6287041108067424, "vf_explained_var": 0.0006797142049121146, "kl": Infinity, "entropy": 0.39242324160374265, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1319295.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000}, "env_runners": {"episode_reward_max": 1590.0, "episode_reward_min": -160.0, "episode_reward_mean": 557.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -600.0}, "policy_reward_max": {"policy_0": 1120.0}, "policy_reward_mean": {"policy_0": 55.75}, "custom_metrics": {}, "hist_stats": {"episode_reward": [480.0, 960.0, 530.0, 970.0, 790.0, 930.0, 770.0, 330.0, 310.0, 1250.0, 880.0, 290.0, 210.0, -160.0, 145.0, 790.0, 210.0, 350.0, 670.0, 695.0, 260.0, 600.0, 560.0, 1070.0, 1070.0, 1330.0, 580.0, 530.0, 560.0, 510.0, 280.0, 130.0, 520.0, 1100.0, 150.0, 140.0, 615.0, 300.0, 460.0, 560.0, 410.0, 340.0, 435.0, 510.0, 180.0, 590.0, 730.0, 1430.0, 280.0, 530.0, 380.0, 390.0, 635.0, 300.0, 600.0, 290.0, 350.0, 710.0, 555.0, 1145.0, 390.0, 690.0, 1590.0, 110.0, 630.0, 1070.0, 640.0, 890.0, 350.0, 260.0, 730.0, 1440.0, 190.0, 600.0, 230.0, 920.0, 1010.0, 850.0, 580.0, 210.0, 350.0, 195.0, 545.0, 670.0, 660.0, 190.0, 300.0, 250.0, 220.0, 400.0, 355.0, 890.0, 245.0, 1285.0, 350.0, 430.0, 620.0, 270.0, 480.0, 150.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 40.0, 0.0, 40.0, 270.0, 10.0, 10.0, 20.0, 0.0, 80.0, 160.0, 40.0, 230.0, 270.0, 10.0, 10.0, 0.0, 150.0, 50.0, 40.0, 20.0, 0.0, 0.0, 10.0, 10.0, 250.0, 30.0, 160.0, 50.0, 0.0, 60.0, 40.0, 20.0, 10.0, 30.0, 70.0, 10.0, 70.0, 190.0, 470.0, 10.0, 190.0, 60.0, 260.0, 80.0, 30.0, 40.0, 20.0, 30.0, 70.0, -50.0, 0.0, 0.0, 190.0, 560.0, 110.0, 10.0, 30.0, 20.0, 60.0, -10.0, 70.0, 30.0, 350.0, 60.0, 200.0, 20.0, 0.0, 50.0, 0.0, 0.0, 30.0, 0.0, 30.0, 60.0, 40.0, 70.0, 40.0, 20.0, 40.0, 20.0, 40.0, 0.0, 50.0, 30.0, 0.0, 40.0, -50.0, 170.0, 10.0, 60.0, 220.0, 40.0, 40.0, 0.0, 10.0, 180.0, 210.0, 460.0, 30.0, 80.0, 10.0, 30.0, 160.0, 70.0, 40.0, 20.0, 70.0, 370.0, 30.0, 80.0, 30.0, 0.0, 50.0, 10.0, 20.0, 20.0, 0.0, 70.0, 10.0, 0.0, 20.0, 20.0, 10.0, 40.0, 0.0, 50.0, 20.0, 10.0, 40.0, 10.0, 0.0, 150.0, 40.0, 0.0, 20.0, 10.0, 30.0, -600.0, 180.0, 60.0, 10.0, 10.0, 30.0, 0.0, 0.0, 15.0, 0.0, 20.0, 0.0, 160.0, 550.0, 10.0, -40.0, -30.0, 30.0, 40.0, 40.0, 130.0, -100.0, 0.0, 40.0, 40.0, 30.0, 30.0, 40.0, 10.0, 10.0, 10.0, 0.0, 10.0, 40.0, 0.0, 30.0, 30.0, 20.0, 50.0, 30.0, 100.0, 40.0, 0.0, 70.0, 0.0, 40.0, 270.0, 10.0, 0.0, 160.0, 100.0, 20.0, 10.0, 130.0, 0.0, 40.0, -5.0, 160.0, 30.0, 250.0, 30.0, 50.0, 0.0, 10.0, 50.0, 0.0, 40.0, 0.0, 80.0, 40.0, 30.0, 10.0, 20.0, 10.0, 30.0, 90.0, 20.0, 50.0, 30.0, 0.0, 280.0, 70.0, 40.0, 20.0, 40.0, 10.0, 0.0, 170.0, 170.0, 20.0, 10.0, 80.0, 50.0, 60.0, 40.0, 0.0, -20.0, 450.0, 30.0, 300.0, 80.0, 80.0, 40.0, 40.0, 60.0, 10.0, 40.0, 90.0, 450.0, 160.0, 100.0, 80.0, 50.0, 220.0, 670.0, 170.0, 20.0, 40.0, 80.0, 40.0, 20.0, 20.0, 40.0, 0.0, 50.0, 30.0, 110.0, 180.0, 150.0, 10.0, 0.0, 10.0, -20.0, 10.0, 30.0, 10.0, 0.0, 30.0, 370.0, 40.0, -10.0, 70.0, 20.0, 40.0, 50.0, 120.0, 180.0, 20.0, 10.0, 40.0, 40.0, 40.0, 0.0, 50.0, 20.0, 0.0, 150.0, 10.0, 260.0, 0.0, 10.0, 10.0, 20.0, -40.0, 40.0, 0.0, 0.0, 30.0, 150.0, 10.0, 30.0, 40.0, 0.0, 10.0, 10.0, 20.0, 30.0, 0.0, 0.0, 20.0, 20.0, 20.0, 150.0, 10.0, 0.0, 20.0, 70.0, 10.0, 30.0, 190.0, 30.0, 10.0, 50.0, 310.0, 80.0, 40.0, 170.0, -50.0, 20.0, 30.0, 190.0, 260.0, 0.0, 40.0, 0.0, 0.0, 30.0, 10.0, 0.0, 40.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 30.0, 20.0, 10.0, 10.0, 20.0, 20.0, 30.0, 10.0, 210.0, 260.0, 0.0, 70.0, 20.0, 0.0, -5.0, 40.0, 0.0, 20.0, 20.0, 10.0, 100.0, 40.0, 0.0, 60.0, 10.0, 70.0, 0.0, 10.0, 30.0, 20.0, 20.0, 40.0, 260.0, 0.0, 10.0, 20.0, 270.0, 20.0, 60.0, 10.0, 20.0, 70.0, 10.0, 50.0, 30.0, 10.0, 40.0, 30.0, 20.0, 80.0, 170.0, 40.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 40.0, 30.0, 0.0, 170.0, 40.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 60.0, 20.0, 260.0, 180.0, -125.0, 10.0, 20.0, 0.0, 90.0, 290.0, 10.0, 50.0, 20.0, 0.0, 10.0, 20.0, 50.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 40.0, 30.0, 260.0, 40.0, 130.0, 70.0, 0.0, 50.0, 10.0, -10.0, -20.0, 60.0, 30.0, 20.0, 40.0, 30.0, 10.0, 420.0, -10.0, 170.0, -10.0, 30.0, 730.0, 140.0, 30.0, -50.0, 20.0, 190.0, 100.0, 60.0, 90.0, 120.0, 20.0, 20.0, 20.0, 10.0, 30.0, 0.0, 40.0, 0.0, 80.0, 60.0, 40.0, 80.0, 60.0, 160.0, 40.0, 40.0, 50.0, 10.0, 10.0, 40.0, 70.0, 0.0, 20.0, 30.0, 20.0, 160.0, 0.0, -40.0, 50.0, 70.0, 60.0, 10.0, 50.0, 160.0, 40.0, 20.0, 10.0, 20.0, 0.0, 20.0, 20.0, -50.0, 10.0, 30.0, 170.0, 460.0, -90.0, 50.0, 50.0, -15.0, 40.0, 10.0, 10.0, 40.0, 20.0, 0.0, 0.0, 80.0, 30.0, 70.0, 260.0, 180.0, 30.0, 0.0, 70.0, 0.0, 0.0, 40.0, 10.0, 10.0, 30.0, 0.0, 30.0, 40.0, 50.0, 10.0, 20.0, 60.0, 30.0, 20.0, 10.0, 0.0, 0.0, 20.0, 0.0, 260.0, 10.0, 30.0, 10.0, 10.0, 10.0, 40.0, 20.0, 20.0, 140.0, 40.0, 170.0, 50.0, 40.0, 180.0, 40.0, -10.0, 10.0, 5.0, 50.0, 0.0, 70.0, 350.0, 10.0, 30.0, 90.0, 570.0, 30.0, 20.0, 270.0, 50.0, 70.0, 20.0, 15.0, 10.0, 60.0, 10.0, 40.0, 60.0, 20.0, 20.0, 20.0, 0.0, 40.0, 120.0, 30.0, 20.0, 60.0, 30.0, 20.0, 220.0, 180.0, 105.0, 30.0, -5.0, 30.0, 40.0, 20.0, 100.0, 30.0, 1120.0, 20.0, 10.0, 150.0, 70.0, 30.0, 0.0, 40.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 60.0, 10.0, 40.0, 370.0, 60.0, 20.0, 30.0, 20.0, 20.0, 0.0, 50.0, 130.0, 30.0, 20.0, 30.0, 20.0, 300.0, 260.0, 20.0, 210.0, 270.0, 10.0, 0.0, 30.0, 160.0, 20.0, 60.0, 10.0, 50.0, 30.0, 10.0, 350.0, 30.0, 40.0, 20.0, 110.0, 30.0, 60.0, 170.0, 70.0, 60.0, 10.0, 170.0, 10.0, 0.0, -20.0, 70.0, 0.0, 50.0, 0.0, 20.0, 30.0, 0.0, 10.0, 20.0, 40.0, 40.0, 70.0, 20.0, 10.0, 30.0, 10.0, 10.0, 0.0, 250.0, 0.0, 30.0, 0.0, 360.0, 40.0, 90.0, 10.0, 80.0, 0.0, 50.0, 20.0, 70.0, 810.0, 280.0, 30.0, 20.0, 20.0, 30.0, 10.0, 30.0, 0.0, 10.0, 40.0, 30.0, 0.0, 50.0, -100.0, 560.0, 20.0, 0.0, 20.0, 10.0, 0.0, 30.0, 10.0, 70.0, 20.0, 10.0, 0.0, 30.0, 30.0, 40.0, 30.0, 0.0, 0.0, 10.0, 40.0, 20.0, 280.0, 0.0, 120.0, 40.0, 150.0, 90.0, 170.0, 50.0, 40.0, 300.0, 290.0, 70.0, 0.0, 30.0, 170.0, 10.0, 50.0, 190.0, 20.0, 30.0, 160.0, 0.0, 0.0, 0.0, 380.0, 30.0, 40.0, 170.0, 350.0, -30.0, 0.0, -10.0, 60.0, 0.0, -30.0, 10.0, 60.0, 40.0, 30.0, 20.0, 10.0, 10.0, 0.0, 70.0, 30.0, 0.0, 0.0, 10.0, 50.0, 10.0, 30.0, 150.0, 0.0, 40.0, 20.0, 30.0, 10.0, 0.0, 40.0, 10.0, 10.0, 30.0, -25.0, 90.0, 20.0, 0.0, 20.0, 30.0, 20.0, 110.0, 30.0, 245.0, 30.0, 60.0, 50.0, -30.0, 0.0, 40.0, 20.0, 70.0, 50.0, 350.0, 60.0, 30.0, 40.0, 60.0, -50.0, 80.0, 50.0, 20.0, 10.0, 450.0, 90.0, -40.0, 0.0, 20.0, -20.0, 20.0, 20.0, 10.0, 20.0, 80.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 50.0, 50.0, 40.0, 0.0, 20.0, 10.0, 30.0, 40.0, 40.0, 0.0, 40.0, 40.0, 0.0, 30.0, 10.0, 0.0, 40.0, 60.0, 30.0, 40.0, 30.0, 30.0, 0.0, 10.0, 0.0, 10.0, 80.0, 10.0, 10.0, 50.0, 250.0, 0.0, 30.0, 10.0, 30.0, 10.0, 20.0, 0.0, 0.0, 30.0, 0.0, 70.0, 70.0, 40.0, 20.0, 0.0, 30.0, -15.0, 110.0, 20.0, 40.0, 50.0, 10.0, 150.0, 350.0, 20.0, 50.0, 180.0, 20.0, 20.0, -25.0, 0.0, 30.0, 10.0, 40.0, 0.0, 160.0, 10.0, 0.0, 115.0, 360.0, 270.0, 30.0, 0.0, 140.0, 10.0, 200.0, 130.0, 30.0, 30.0, 30.0, 80.0, 10.0, 0.0, 20.0, 20.0, 70.0, 20.0, 70.0, 0.0, 0.0, 60.0, 40.0, 30.0, 20.0, 20.0, 30.0, 190.0, 40.0, 40.0, 150.0, 40.0, 20.0, 90.0, 50.0, 40.0, 30.0, 150.0, 10.0, 60.0, 40.0, 20.0, 10.0, 20.0, 50.0, 20.0, 0.0, 30.0, 20.0, 30.0, 30.0, 40.0, 120.0, 20.0, 80.0, 20.0, 40.0, 20.0, 80.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 40.0, 40.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4084629834231261, "mean_inference_ms": 1.6086469605938394, "mean_action_processing_ms": 0.41896262873450785, "mean_env_wait_ms": 1.2953054291629056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05677008628845215, "StateBufferConnector_ms": 0.01198720932006836, "ViewRequirementAgentConnector_ms": 0.3603482246398926}, "num_episodes": 22, "episode_return_max": 1590.0, "episode_return_min": -160.0, "episode_return_mean": 557.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.1348697339533, "num_env_steps_trained_throughput_per_sec": 36.1348697339533, "timesteps_total": 564000, "num_env_steps_sampled_lifetime": 564000, "num_agent_steps_sampled_lifetime": 5640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5640000, "timers": {"training_iteration_time_ms": 110593.745, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110593.696, "sample_time_ms": 2381.838, "learn_time_ms": 108191.391, "learn_throughput": 36.972, "synch_weights_time_ms": 11.997}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000}, "done": false, "training_iteration": 141, "trial_id": "57140_00000", "date": "2024-06-27_03-39-03", "timestamp": 1719473943, "time_this_iter_s": 110.70858907699585, "time_total_s": 15868.366453647614, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23e4a60>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15868.366453647614, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 15.71602564102564, "ram_util_percent": 79.51923076923077}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.487103138291163, "cur_kl_coeff": 3.0028802387286975, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.391085715111071, "policy_loss": -0.002437016453258733, "vf_loss": 4.391565266153175, "vf_explained_var": 0.001332682123580299, "kl": 0.0006518631705602263, "entropy": 0.34994490228998015, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1328685.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000}, "env_runners": {"episode_reward_max": 1835.0, "episode_reward_min": 110.0, "episode_reward_mean": 563.5, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -230.0}, "policy_reward_max": {"policy_0": 1210.0}, "policy_reward_mean": {"policy_0": 56.35}, "custom_metrics": {}, "hist_stats": {"episode_reward": [670.0, 695.0, 260.0, 600.0, 560.0, 1070.0, 1070.0, 1330.0, 580.0, 530.0, 560.0, 510.0, 280.0, 130.0, 520.0, 1100.0, 150.0, 140.0, 615.0, 300.0, 460.0, 560.0, 410.0, 340.0, 435.0, 510.0, 180.0, 590.0, 730.0, 1430.0, 280.0, 530.0, 380.0, 390.0, 635.0, 300.0, 600.0, 290.0, 350.0, 710.0, 555.0, 1145.0, 390.0, 690.0, 1590.0, 110.0, 630.0, 1070.0, 640.0, 890.0, 350.0, 260.0, 730.0, 1440.0, 190.0, 600.0, 230.0, 920.0, 1010.0, 850.0, 580.0, 210.0, 350.0, 195.0, 545.0, 670.0, 660.0, 190.0, 300.0, 250.0, 220.0, 400.0, 355.0, 890.0, 245.0, 1285.0, 350.0, 430.0, 620.0, 270.0, 480.0, 150.0, 800.0, 570.0, 430.0, 290.0, 120.0, 420.0, 1230.0, 600.0, 690.0, 600.0, 360.0, 1835.0, 360.0, 870.0, 190.0, 500.0, 210.0, 560.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 70.0, 0.0, 40.0, 270.0, 10.0, 0.0, 160.0, 100.0, 20.0, 10.0, 130.0, 0.0, 40.0, -5.0, 160.0, 30.0, 250.0, 30.0, 50.0, 0.0, 10.0, 50.0, 0.0, 40.0, 0.0, 80.0, 40.0, 30.0, 10.0, 20.0, 10.0, 30.0, 90.0, 20.0, 50.0, 30.0, 0.0, 280.0, 70.0, 40.0, 20.0, 40.0, 10.0, 0.0, 170.0, 170.0, 20.0, 10.0, 80.0, 50.0, 60.0, 40.0, 0.0, -20.0, 450.0, 30.0, 300.0, 80.0, 80.0, 40.0, 40.0, 60.0, 10.0, 40.0, 90.0, 450.0, 160.0, 100.0, 80.0, 50.0, 220.0, 670.0, 170.0, 20.0, 40.0, 80.0, 40.0, 20.0, 20.0, 40.0, 0.0, 50.0, 30.0, 110.0, 180.0, 150.0, 10.0, 0.0, 10.0, -20.0, 10.0, 30.0, 10.0, 0.0, 30.0, 370.0, 40.0, -10.0, 70.0, 20.0, 40.0, 50.0, 120.0, 180.0, 20.0, 10.0, 40.0, 40.0, 40.0, 0.0, 50.0, 20.0, 0.0, 150.0, 10.0, 260.0, 0.0, 10.0, 10.0, 20.0, -40.0, 40.0, 0.0, 0.0, 30.0, 150.0, 10.0, 30.0, 40.0, 0.0, 10.0, 10.0, 20.0, 30.0, 0.0, 0.0, 20.0, 20.0, 20.0, 150.0, 10.0, 0.0, 20.0, 70.0, 10.0, 30.0, 190.0, 30.0, 10.0, 50.0, 310.0, 80.0, 40.0, 170.0, -50.0, 20.0, 30.0, 190.0, 260.0, 0.0, 40.0, 0.0, 0.0, 30.0, 10.0, 0.0, 40.0, 20.0, 10.0, 10.0, 10.0, 0.0, 10.0, 20.0, 30.0, 20.0, 10.0, 10.0, 20.0, 20.0, 30.0, 10.0, 210.0, 260.0, 0.0, 70.0, 20.0, 0.0, -5.0, 40.0, 0.0, 20.0, 20.0, 10.0, 100.0, 40.0, 0.0, 60.0, 10.0, 70.0, 0.0, 10.0, 30.0, 20.0, 20.0, 40.0, 260.0, 0.0, 10.0, 20.0, 270.0, 20.0, 60.0, 10.0, 20.0, 70.0, 10.0, 50.0, 30.0, 10.0, 40.0, 30.0, 20.0, 80.0, 170.0, 40.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 40.0, 30.0, 0.0, 170.0, 40.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 60.0, 20.0, 260.0, 180.0, -125.0, 10.0, 20.0, 0.0, 90.0, 290.0, 10.0, 50.0, 20.0, 0.0, 10.0, 20.0, 50.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 40.0, 30.0, 260.0, 40.0, 130.0, 70.0, 0.0, 50.0, 10.0, -10.0, -20.0, 60.0, 30.0, 20.0, 40.0, 30.0, 10.0, 420.0, -10.0, 170.0, -10.0, 30.0, 730.0, 140.0, 30.0, -50.0, 20.0, 190.0, 100.0, 60.0, 90.0, 120.0, 20.0, 20.0, 20.0, 10.0, 30.0, 0.0, 40.0, 0.0, 80.0, 60.0, 40.0, 80.0, 60.0, 160.0, 40.0, 40.0, 50.0, 10.0, 10.0, 40.0, 70.0, 0.0, 20.0, 30.0, 20.0, 160.0, 0.0, -40.0, 50.0, 70.0, 60.0, 10.0, 50.0, 160.0, 40.0, 20.0, 10.0, 20.0, 0.0, 20.0, 20.0, -50.0, 10.0, 30.0, 170.0, 460.0, -90.0, 50.0, 50.0, -15.0, 40.0, 10.0, 10.0, 40.0, 20.0, 0.0, 0.0, 80.0, 30.0, 70.0, 260.0, 180.0, 30.0, 0.0, 70.0, 0.0, 0.0, 40.0, 10.0, 10.0, 30.0, 0.0, 30.0, 40.0, 50.0, 10.0, 20.0, 60.0, 30.0, 20.0, 10.0, 0.0, 0.0, 20.0, 0.0, 260.0, 10.0, 30.0, 10.0, 10.0, 10.0, 40.0, 20.0, 20.0, 140.0, 40.0, 170.0, 50.0, 40.0, 180.0, 40.0, -10.0, 10.0, 5.0, 50.0, 0.0, 70.0, 350.0, 10.0, 30.0, 90.0, 570.0, 30.0, 20.0, 270.0, 50.0, 70.0, 20.0, 15.0, 10.0, 60.0, 10.0, 40.0, 60.0, 20.0, 20.0, 20.0, 0.0, 40.0, 120.0, 30.0, 20.0, 60.0, 30.0, 20.0, 220.0, 180.0, 105.0, 30.0, -5.0, 30.0, 40.0, 20.0, 100.0, 30.0, 1120.0, 20.0, 10.0, 150.0, 70.0, 30.0, 0.0, 40.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 60.0, 10.0, 40.0, 370.0, 60.0, 20.0, 30.0, 20.0, 20.0, 0.0, 50.0, 130.0, 30.0, 20.0, 30.0, 20.0, 300.0, 260.0, 20.0, 210.0, 270.0, 10.0, 0.0, 30.0, 160.0, 20.0, 60.0, 10.0, 50.0, 30.0, 10.0, 350.0, 30.0, 40.0, 20.0, 110.0, 30.0, 60.0, 170.0, 70.0, 60.0, 10.0, 170.0, 10.0, 0.0, -20.0, 70.0, 0.0, 50.0, 0.0, 20.0, 30.0, 0.0, 10.0, 20.0, 40.0, 40.0, 70.0, 20.0, 10.0, 30.0, 10.0, 10.0, 0.0, 250.0, 0.0, 30.0, 0.0, 360.0, 40.0, 90.0, 10.0, 80.0, 0.0, 50.0, 20.0, 70.0, 810.0, 280.0, 30.0, 20.0, 20.0, 30.0, 10.0, 30.0, 0.0, 10.0, 40.0, 30.0, 0.0, 50.0, -100.0, 560.0, 20.0, 0.0, 20.0, 10.0, 0.0, 30.0, 10.0, 70.0, 20.0, 10.0, 0.0, 30.0, 30.0, 40.0, 30.0, 0.0, 0.0, 10.0, 40.0, 20.0, 280.0, 0.0, 120.0, 40.0, 150.0, 90.0, 170.0, 50.0, 40.0, 300.0, 290.0, 70.0, 0.0, 30.0, 170.0, 10.0, 50.0, 190.0, 20.0, 30.0, 160.0, 0.0, 0.0, 0.0, 380.0, 30.0, 40.0, 170.0, 350.0, -30.0, 0.0, -10.0, 60.0, 0.0, -30.0, 10.0, 60.0, 40.0, 30.0, 20.0, 10.0, 10.0, 0.0, 70.0, 30.0, 0.0, 0.0, 10.0, 50.0, 10.0, 30.0, 150.0, 0.0, 40.0, 20.0, 30.0, 10.0, 0.0, 40.0, 10.0, 10.0, 30.0, -25.0, 90.0, 20.0, 0.0, 20.0, 30.0, 20.0, 110.0, 30.0, 245.0, 30.0, 60.0, 50.0, -30.0, 0.0, 40.0, 20.0, 70.0, 50.0, 350.0, 60.0, 30.0, 40.0, 60.0, -50.0, 80.0, 50.0, 20.0, 10.0, 450.0, 90.0, -40.0, 0.0, 20.0, -20.0, 20.0, 20.0, 10.0, 20.0, 80.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 50.0, 50.0, 40.0, 0.0, 20.0, 10.0, 30.0, 40.0, 40.0, 0.0, 40.0, 40.0, 0.0, 30.0, 10.0, 0.0, 40.0, 60.0, 30.0, 40.0, 30.0, 30.0, 0.0, 10.0, 0.0, 10.0, 80.0, 10.0, 10.0, 50.0, 250.0, 0.0, 30.0, 10.0, 30.0, 10.0, 20.0, 0.0, 0.0, 30.0, 0.0, 70.0, 70.0, 40.0, 20.0, 0.0, 30.0, -15.0, 110.0, 20.0, 40.0, 50.0, 10.0, 150.0, 350.0, 20.0, 50.0, 180.0, 20.0, 20.0, -25.0, 0.0, 30.0, 10.0, 40.0, 0.0, 160.0, 10.0, 0.0, 115.0, 360.0, 270.0, 30.0, 0.0, 140.0, 10.0, 200.0, 130.0, 30.0, 30.0, 30.0, 80.0, 10.0, 0.0, 20.0, 20.0, 70.0, 20.0, 70.0, 0.0, 0.0, 60.0, 40.0, 30.0, 20.0, 20.0, 30.0, 190.0, 40.0, 40.0, 150.0, 40.0, 20.0, 90.0, 50.0, 40.0, 30.0, 150.0, 10.0, 60.0, 40.0, 20.0, 10.0, 20.0, 50.0, 20.0, 0.0, 30.0, 20.0, 30.0, 30.0, 40.0, 120.0, 20.0, 80.0, 20.0, 40.0, 20.0, 80.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 40.0, 40.0, 10.0, 360.0, 40.0, 150.0, 190.0, 30.0, -230.0, 100.0, 60.0, 50.0, 50.0, 40.0, 5.0, -190.0, 150.0, 20.0, -5.0, 110.0, 360.0, 60.0, 20.0, 30.0, 10.0, 40.0, 20.0, 20.0, 20.0, 20.0, 180.0, 60.0, 30.0, 50.0, 0.0, -50.0, 10.0, 10.0, 50.0, 150.0, 20.0, 30.0, 20.0, 10.0, 10.0, 20.0, 0.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 10.0, 30.0, 20.0, 30.0, 170.0, 30.0, 80.0, 20.0, 10.0, 20.0, 100.0, 40.0, 60.0, -10.0, 590.0, 50.0, 80.0, 100.0, 180.0, 40.0, 40.0, 0.0, 160.0, 30.0, 0.0, 30.0, 0.0, 30.0, 280.0, 30.0, 60.0, 190.0, -10.0, -20.0, 70.0, 30.0, -50.0, 380.0, 20.0, 20.0, 20.0, 0.0, 180.0, 0.0, 180.0, 30.0, 50.0, 120.0, 0.0, 20.0, 30.0, 20.0, 20.0, 80.0, 20.0, 20.0, 60.0, 20.0, 60.0, 30.0, 50.0, -45.0, 60.0, 50.0, 60.0, 40.0, 410.0, 20.0, 1210.0, -20.0, 60.0, 30.0, -15.0, 0.0, 80.0, 10.0, 0.0, 5.0, 0.0, 190.0, 10.0, 10.0, -10.0, 50.0, 670.0, 50.0, 30.0, -40.0, 40.0, 60.0, 10.0, 10.0, 30.0, 20.0, 30.0, 0.0, 60.0, 0.0, 20.0, 10.0, 40.0, 20.0, 30.0, 60.0, 20.0, 190.0, 20.0, 20.0, 20.0, 80.0, 40.0, 10.0, 0.0, 30.0, 10.0, 40.0, 40.0, 20.0, 0.0, 20.0, 0.0, 20.0, 10.0, 40.0, 60.0, 270.0, 50.0, 90.0, 10.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4078757375363151, "mean_inference_ms": 1.6079063957704653, "mean_action_processing_ms": 0.4187494434850542, "mean_env_wait_ms": 1.2948251443143075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05602860450744629, "StateBufferConnector_ms": 0.011996984481811523, "ViewRequirementAgentConnector_ms": 0.3563399314880371}, "num_episodes": 18, "episode_return_max": 1835.0, "episode_return_min": 110.0, "episode_return_mean": 563.5}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.17042679430878, "num_env_steps_trained_throughput_per_sec": 36.17042679430878, "timesteps_total": 568000, "num_env_steps_sampled_lifetime": 568000, "num_agent_steps_sampled_lifetime": 5680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5680000, "timers": {"training_iteration_time_ms": 110696.624, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110696.575, "sample_time_ms": 2377.938, "learn_time_ms": 108297.94, "learn_throughput": 36.935, "synch_weights_time_ms": 12.239}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 5680000, "num_agent_steps_trained": 5680000}, "done": false, "training_iteration": 142, "trial_id": "57140_00000", "date": "2024-06-27_03-40-54", "timestamp": 1719474054, "time_this_iter_s": 110.60165214538574, "time_total_s": 15978.968105793, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23f7ca0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15978.968105793, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 15.317197452229301, "ram_util_percent": 78.90445859872611}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.05422031426836, "cur_kl_coeff": 1.5014401193643487, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.003213495928786707, "vf_loss": 4.046191394595673, "vf_explained_var": 0.00047282632420492124, "kl": Infinity, "entropy": 0.3659685321810781, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1338075.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000}, "env_runners": {"episode_reward_max": 1835.0, "episode_reward_min": 110.0, "episode_reward_mean": 570.35, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -230.0}, "policy_reward_max": {"policy_0": 1210.0}, "policy_reward_mean": {"policy_0": 57.035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [615.0, 300.0, 460.0, 560.0, 410.0, 340.0, 435.0, 510.0, 180.0, 590.0, 730.0, 1430.0, 280.0, 530.0, 380.0, 390.0, 635.0, 300.0, 600.0, 290.0, 350.0, 710.0, 555.0, 1145.0, 390.0, 690.0, 1590.0, 110.0, 630.0, 1070.0, 640.0, 890.0, 350.0, 260.0, 730.0, 1440.0, 190.0, 600.0, 230.0, 920.0, 1010.0, 850.0, 580.0, 210.0, 350.0, 195.0, 545.0, 670.0, 660.0, 190.0, 300.0, 250.0, 220.0, 400.0, 355.0, 890.0, 245.0, 1285.0, 350.0, 430.0, 620.0, 270.0, 480.0, 150.0, 800.0, 570.0, 430.0, 290.0, 120.0, 420.0, 1230.0, 600.0, 690.0, 600.0, 360.0, 1835.0, 360.0, 870.0, 190.0, 500.0, 210.0, 560.0, 370.0, 550.0, 410.0, 150.0, 1520.0, 200.0, 1160.0, 120.0, 760.0, 220.0, 410.0, 940.0, 990.0, 360.0, 1180.0, 580.0, 260.0, 1260.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [20.0, 30.0, 10.0, 210.0, 260.0, 0.0, 70.0, 20.0, 0.0, -5.0, 40.0, 0.0, 20.0, 20.0, 10.0, 100.0, 40.0, 0.0, 60.0, 10.0, 70.0, 0.0, 10.0, 30.0, 20.0, 20.0, 40.0, 260.0, 0.0, 10.0, 20.0, 270.0, 20.0, 60.0, 10.0, 20.0, 70.0, 10.0, 50.0, 30.0, 10.0, 40.0, 30.0, 20.0, 80.0, 170.0, 40.0, 0.0, 10.0, 10.0, 10.0, 0.0, 30.0, 40.0, 30.0, 0.0, 170.0, 40.0, 0.0, 20.0, 10.0, 0.0, 20.0, 0.0, 60.0, 20.0, 260.0, 180.0, -125.0, 10.0, 20.0, 0.0, 90.0, 290.0, 10.0, 50.0, 20.0, 0.0, 10.0, 20.0, 50.0, 0.0, 0.0, 20.0, 10.0, 30.0, 0.0, 0.0, 40.0, 30.0, 260.0, 40.0, 130.0, 70.0, 0.0, 50.0, 10.0, -10.0, -20.0, 60.0, 30.0, 20.0, 40.0, 30.0, 10.0, 420.0, -10.0, 170.0, -10.0, 30.0, 730.0, 140.0, 30.0, -50.0, 20.0, 190.0, 100.0, 60.0, 90.0, 120.0, 20.0, 20.0, 20.0, 10.0, 30.0, 0.0, 40.0, 0.0, 80.0, 60.0, 40.0, 80.0, 60.0, 160.0, 40.0, 40.0, 50.0, 10.0, 10.0, 40.0, 70.0, 0.0, 20.0, 30.0, 20.0, 160.0, 0.0, -40.0, 50.0, 70.0, 60.0, 10.0, 50.0, 160.0, 40.0, 20.0, 10.0, 20.0, 0.0, 20.0, 20.0, -50.0, 10.0, 30.0, 170.0, 460.0, -90.0, 50.0, 50.0, -15.0, 40.0, 10.0, 10.0, 40.0, 20.0, 0.0, 0.0, 80.0, 30.0, 70.0, 260.0, 180.0, 30.0, 0.0, 70.0, 0.0, 0.0, 40.0, 10.0, 10.0, 30.0, 0.0, 30.0, 40.0, 50.0, 10.0, 20.0, 60.0, 30.0, 20.0, 10.0, 0.0, 0.0, 20.0, 0.0, 260.0, 10.0, 30.0, 10.0, 10.0, 10.0, 40.0, 20.0, 20.0, 140.0, 40.0, 170.0, 50.0, 40.0, 180.0, 40.0, -10.0, 10.0, 5.0, 50.0, 0.0, 70.0, 350.0, 10.0, 30.0, 90.0, 570.0, 30.0, 20.0, 270.0, 50.0, 70.0, 20.0, 15.0, 10.0, 60.0, 10.0, 40.0, 60.0, 20.0, 20.0, 20.0, 0.0, 40.0, 120.0, 30.0, 20.0, 60.0, 30.0, 20.0, 220.0, 180.0, 105.0, 30.0, -5.0, 30.0, 40.0, 20.0, 100.0, 30.0, 1120.0, 20.0, 10.0, 150.0, 70.0, 30.0, 0.0, 40.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 60.0, 10.0, 40.0, 370.0, 60.0, 20.0, 30.0, 20.0, 20.0, 0.0, 50.0, 130.0, 30.0, 20.0, 30.0, 20.0, 300.0, 260.0, 20.0, 210.0, 270.0, 10.0, 0.0, 30.0, 160.0, 20.0, 60.0, 10.0, 50.0, 30.0, 10.0, 350.0, 30.0, 40.0, 20.0, 110.0, 30.0, 60.0, 170.0, 70.0, 60.0, 10.0, 170.0, 10.0, 0.0, -20.0, 70.0, 0.0, 50.0, 0.0, 20.0, 30.0, 0.0, 10.0, 20.0, 40.0, 40.0, 70.0, 20.0, 10.0, 30.0, 10.0, 10.0, 0.0, 250.0, 0.0, 30.0, 0.0, 360.0, 40.0, 90.0, 10.0, 80.0, 0.0, 50.0, 20.0, 70.0, 810.0, 280.0, 30.0, 20.0, 20.0, 30.0, 10.0, 30.0, 0.0, 10.0, 40.0, 30.0, 0.0, 50.0, -100.0, 560.0, 20.0, 0.0, 20.0, 10.0, 0.0, 30.0, 10.0, 70.0, 20.0, 10.0, 0.0, 30.0, 30.0, 40.0, 30.0, 0.0, 0.0, 10.0, 40.0, 20.0, 280.0, 0.0, 120.0, 40.0, 150.0, 90.0, 170.0, 50.0, 40.0, 300.0, 290.0, 70.0, 0.0, 30.0, 170.0, 10.0, 50.0, 190.0, 20.0, 30.0, 160.0, 0.0, 0.0, 0.0, 380.0, 30.0, 40.0, 170.0, 350.0, -30.0, 0.0, -10.0, 60.0, 0.0, -30.0, 10.0, 60.0, 40.0, 30.0, 20.0, 10.0, 10.0, 0.0, 70.0, 30.0, 0.0, 0.0, 10.0, 50.0, 10.0, 30.0, 150.0, 0.0, 40.0, 20.0, 30.0, 10.0, 0.0, 40.0, 10.0, 10.0, 30.0, -25.0, 90.0, 20.0, 0.0, 20.0, 30.0, 20.0, 110.0, 30.0, 245.0, 30.0, 60.0, 50.0, -30.0, 0.0, 40.0, 20.0, 70.0, 50.0, 350.0, 60.0, 30.0, 40.0, 60.0, -50.0, 80.0, 50.0, 20.0, 10.0, 450.0, 90.0, -40.0, 0.0, 20.0, -20.0, 20.0, 20.0, 10.0, 20.0, 80.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 50.0, 50.0, 40.0, 0.0, 20.0, 10.0, 30.0, 40.0, 40.0, 0.0, 40.0, 40.0, 0.0, 30.0, 10.0, 0.0, 40.0, 60.0, 30.0, 40.0, 30.0, 30.0, 0.0, 10.0, 0.0, 10.0, 80.0, 10.0, 10.0, 50.0, 250.0, 0.0, 30.0, 10.0, 30.0, 10.0, 20.0, 0.0, 0.0, 30.0, 0.0, 70.0, 70.0, 40.0, 20.0, 0.0, 30.0, -15.0, 110.0, 20.0, 40.0, 50.0, 10.0, 150.0, 350.0, 20.0, 50.0, 180.0, 20.0, 20.0, -25.0, 0.0, 30.0, 10.0, 40.0, 0.0, 160.0, 10.0, 0.0, 115.0, 360.0, 270.0, 30.0, 0.0, 140.0, 10.0, 200.0, 130.0, 30.0, 30.0, 30.0, 80.0, 10.0, 0.0, 20.0, 20.0, 70.0, 20.0, 70.0, 0.0, 0.0, 60.0, 40.0, 30.0, 20.0, 20.0, 30.0, 190.0, 40.0, 40.0, 150.0, 40.0, 20.0, 90.0, 50.0, 40.0, 30.0, 150.0, 10.0, 60.0, 40.0, 20.0, 10.0, 20.0, 50.0, 20.0, 0.0, 30.0, 20.0, 30.0, 30.0, 40.0, 120.0, 20.0, 80.0, 20.0, 40.0, 20.0, 80.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 40.0, 40.0, 10.0, 360.0, 40.0, 150.0, 190.0, 30.0, -230.0, 100.0, 60.0, 50.0, 50.0, 40.0, 5.0, -190.0, 150.0, 20.0, -5.0, 110.0, 360.0, 60.0, 20.0, 30.0, 10.0, 40.0, 20.0, 20.0, 20.0, 20.0, 180.0, 60.0, 30.0, 50.0, 0.0, -50.0, 10.0, 10.0, 50.0, 150.0, 20.0, 30.0, 20.0, 10.0, 10.0, 20.0, 0.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 10.0, 30.0, 20.0, 30.0, 170.0, 30.0, 80.0, 20.0, 10.0, 20.0, 100.0, 40.0, 60.0, -10.0, 590.0, 50.0, 80.0, 100.0, 180.0, 40.0, 40.0, 0.0, 160.0, 30.0, 0.0, 30.0, 0.0, 30.0, 280.0, 30.0, 60.0, 190.0, -10.0, -20.0, 70.0, 30.0, -50.0, 380.0, 20.0, 20.0, 20.0, 0.0, 180.0, 0.0, 180.0, 30.0, 50.0, 120.0, 0.0, 20.0, 30.0, 20.0, 20.0, 80.0, 20.0, 20.0, 60.0, 20.0, 60.0, 30.0, 50.0, -45.0, 60.0, 50.0, 60.0, 40.0, 410.0, 20.0, 1210.0, -20.0, 60.0, 30.0, -15.0, 0.0, 80.0, 10.0, 0.0, 5.0, 0.0, 190.0, 10.0, 10.0, -10.0, 50.0, 670.0, 50.0, 30.0, -40.0, 40.0, 60.0, 10.0, 10.0, 30.0, 20.0, 30.0, 0.0, 60.0, 0.0, 20.0, 10.0, 40.0, 20.0, 30.0, 60.0, 20.0, 190.0, 20.0, 20.0, 20.0, 80.0, 40.0, 10.0, 0.0, 30.0, 10.0, 40.0, 40.0, 20.0, 0.0, 20.0, 0.0, 20.0, 10.0, 40.0, 60.0, 270.0, 50.0, 90.0, 10.0, 10.0, 50.0, 20.0, 10.0, 10.0, 20.0, 110.0, 0.0, 100.0, 10.0, 40.0, 60.0, 0.0, 10.0, 40.0, 40.0, 190.0, 20.0, 0.0, 0.0, 190.0, 30.0, 20.0, 60.0, 30.0, 50.0, 20.0, 0.0, 10.0, 150.0, 40.0, 30.0, 10.0, 60.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 0.0, 1120.0, 0.0, 100.0, 30.0, 80.0, 50.0, 30.0, 100.0, 70.0, -60.0, 0.0, 40.0, 50.0, 50.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 50.0, 0.0, 10.0, 280.0, 40.0, -20.0, 170.0, 30.0, 570.0, 30.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 30.0, 20.0, 20.0, 0.0, 20.0, 160.0, 70.0, 280.0, 10.0, 0.0, 110.0, 90.0, 0.0, 10.0, 10.0, 0.0, 60.0, 70.0, 10.0, 10.0, 50.0, 0.0, 40.0, 40.0, 0.0, 80.0, 30.0, 20.0, 10.0, 180.0, 10.0, 0.0, 250.0, 0.0, 470.0, 30.0, 20.0, 30.0, -80.0, 70.0, 150.0, 0.0, -20.0, 230.0, 90.0, 0.0, 200.0, 60.0, 110.0, 250.0, 10.0, 60.0, 30.0, 0.0, 20.0, 20.0, 0.0, 30.0, 30.0, 10.0, 190.0, 30.0, 10.0, 10.0, 50.0, -20.0, 10.0, 20.0, 10.0, 1030.0, 20.0, 40.0, 60.0, 30.0, 10.0, 30.0, 40.0, 50.0, 260.0, 50.0, 0.0, 50.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, 110.0, 10.0, 20.0, 50.0, 350.0, 340.0, 80.0, 0.0, -30.0, 60.0, -30.0, 310.0, 90.0, 90.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4072640402601768, "mean_inference_ms": 1.6072469379299006, "mean_action_processing_ms": 0.41852104693784503, "mean_env_wait_ms": 1.2943455077193338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05669856071472168, "StateBufferConnector_ms": 0.009824275970458984, "ViewRequirementAgentConnector_ms": 0.3607673645019531}, "num_episodes": 18, "episode_return_max": 1835.0, "episode_return_min": 110.0, "episode_return_mean": 570.35}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.13198536567689, "num_env_steps_trained_throughput_per_sec": 36.13198536567689, "timesteps_total": 572000, "num_env_steps_sampled_lifetime": 572000, "num_agent_steps_sampled_lifetime": 5720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5720000, "timers": {"training_iteration_time_ms": 110767.785, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110767.736, "sample_time_ms": 2378.335, "learn_time_ms": 108369.0, "learn_throughput": 36.911, "synch_weights_time_ms": 12.115}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 5720000, "num_agent_steps_trained": 5720000}, "done": false, "training_iteration": 143, "trial_id": "57140_00000", "date": "2024-06-27_03-42-45", "timestamp": 1719474165, "time_this_iter_s": 110.7197060585022, "time_total_s": 16089.687811851501, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18e1af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16089.687811851501, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 16.36153846153846, "ram_util_percent": 79.06987179487179}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9228027029349781, "cur_kl_coeff": 2.2521601790465233, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.003036385919815435, "vf_loss": 4.020037007865053, "vf_explained_var": 0.00035703047015034735, "kl": Infinity, "entropy": 0.36072107752322896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1347465.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000}, "env_runners": {"episode_reward_max": 1835.0, "episode_reward_min": 100.0, "episode_reward_mean": 567.65, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -230.0}, "policy_reward_max": {"policy_0": 1210.0}, "policy_reward_mean": {"policy_0": 56.765}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1145.0, 390.0, 690.0, 1590.0, 110.0, 630.0, 1070.0, 640.0, 890.0, 350.0, 260.0, 730.0, 1440.0, 190.0, 600.0, 230.0, 920.0, 1010.0, 850.0, 580.0, 210.0, 350.0, 195.0, 545.0, 670.0, 660.0, 190.0, 300.0, 250.0, 220.0, 400.0, 355.0, 890.0, 245.0, 1285.0, 350.0, 430.0, 620.0, 270.0, 480.0, 150.0, 800.0, 570.0, 430.0, 290.0, 120.0, 420.0, 1230.0, 600.0, 690.0, 600.0, 360.0, 1835.0, 360.0, 870.0, 190.0, 500.0, 210.0, 560.0, 370.0, 550.0, 410.0, 150.0, 1520.0, 200.0, 1160.0, 120.0, 760.0, 220.0, 410.0, 940.0, 990.0, 360.0, 1180.0, 580.0, 260.0, 1260.0, 540.0, 350.0, 280.0, 560.0, 460.0, 570.0, 100.0, 590.0, 260.0, 460.0, 740.0, 490.0, 560.0, 310.0, 590.0, 935.0, 270.0, 230.0, 1180.0, 340.0, 1005.0, 310.0, 180.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [90.0, 570.0, 30.0, 20.0, 270.0, 50.0, 70.0, 20.0, 15.0, 10.0, 60.0, 10.0, 40.0, 60.0, 20.0, 20.0, 20.0, 0.0, 40.0, 120.0, 30.0, 20.0, 60.0, 30.0, 20.0, 220.0, 180.0, 105.0, 30.0, -5.0, 30.0, 40.0, 20.0, 100.0, 30.0, 1120.0, 20.0, 10.0, 150.0, 70.0, 30.0, 0.0, 40.0, 20.0, 0.0, 0.0, 10.0, 10.0, 0.0, 0.0, 60.0, 10.0, 40.0, 370.0, 60.0, 20.0, 30.0, 20.0, 20.0, 0.0, 50.0, 130.0, 30.0, 20.0, 30.0, 20.0, 300.0, 260.0, 20.0, 210.0, 270.0, 10.0, 0.0, 30.0, 160.0, 20.0, 60.0, 10.0, 50.0, 30.0, 10.0, 350.0, 30.0, 40.0, 20.0, 110.0, 30.0, 60.0, 170.0, 70.0, 60.0, 10.0, 170.0, 10.0, 0.0, -20.0, 70.0, 0.0, 50.0, 0.0, 20.0, 30.0, 0.0, 10.0, 20.0, 40.0, 40.0, 70.0, 20.0, 10.0, 30.0, 10.0, 10.0, 0.0, 250.0, 0.0, 30.0, 0.0, 360.0, 40.0, 90.0, 10.0, 80.0, 0.0, 50.0, 20.0, 70.0, 810.0, 280.0, 30.0, 20.0, 20.0, 30.0, 10.0, 30.0, 0.0, 10.0, 40.0, 30.0, 0.0, 50.0, -100.0, 560.0, 20.0, 0.0, 20.0, 10.0, 0.0, 30.0, 10.0, 70.0, 20.0, 10.0, 0.0, 30.0, 30.0, 40.0, 30.0, 0.0, 0.0, 10.0, 40.0, 20.0, 280.0, 0.0, 120.0, 40.0, 150.0, 90.0, 170.0, 50.0, 40.0, 300.0, 290.0, 70.0, 0.0, 30.0, 170.0, 10.0, 50.0, 190.0, 20.0, 30.0, 160.0, 0.0, 0.0, 0.0, 380.0, 30.0, 40.0, 170.0, 350.0, -30.0, 0.0, -10.0, 60.0, 0.0, -30.0, 10.0, 60.0, 40.0, 30.0, 20.0, 10.0, 10.0, 0.0, 70.0, 30.0, 0.0, 0.0, 10.0, 50.0, 10.0, 30.0, 150.0, 0.0, 40.0, 20.0, 30.0, 10.0, 0.0, 40.0, 10.0, 10.0, 30.0, -25.0, 90.0, 20.0, 0.0, 20.0, 30.0, 20.0, 110.0, 30.0, 245.0, 30.0, 60.0, 50.0, -30.0, 0.0, 40.0, 20.0, 70.0, 50.0, 350.0, 60.0, 30.0, 40.0, 60.0, -50.0, 80.0, 50.0, 20.0, 10.0, 450.0, 90.0, -40.0, 0.0, 20.0, -20.0, 20.0, 20.0, 10.0, 20.0, 80.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 50.0, 50.0, 40.0, 0.0, 20.0, 10.0, 30.0, 40.0, 40.0, 0.0, 40.0, 40.0, 0.0, 30.0, 10.0, 0.0, 40.0, 60.0, 30.0, 40.0, 30.0, 30.0, 0.0, 10.0, 0.0, 10.0, 80.0, 10.0, 10.0, 50.0, 250.0, 0.0, 30.0, 10.0, 30.0, 10.0, 20.0, 0.0, 0.0, 30.0, 0.0, 70.0, 70.0, 40.0, 20.0, 0.0, 30.0, -15.0, 110.0, 20.0, 40.0, 50.0, 10.0, 150.0, 350.0, 20.0, 50.0, 180.0, 20.0, 20.0, -25.0, 0.0, 30.0, 10.0, 40.0, 0.0, 160.0, 10.0, 0.0, 115.0, 360.0, 270.0, 30.0, 0.0, 140.0, 10.0, 200.0, 130.0, 30.0, 30.0, 30.0, 80.0, 10.0, 0.0, 20.0, 20.0, 70.0, 20.0, 70.0, 0.0, 0.0, 60.0, 40.0, 30.0, 20.0, 20.0, 30.0, 190.0, 40.0, 40.0, 150.0, 40.0, 20.0, 90.0, 50.0, 40.0, 30.0, 150.0, 10.0, 60.0, 40.0, 20.0, 10.0, 20.0, 50.0, 20.0, 0.0, 30.0, 20.0, 30.0, 30.0, 40.0, 120.0, 20.0, 80.0, 20.0, 40.0, 20.0, 80.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 40.0, 40.0, 10.0, 360.0, 40.0, 150.0, 190.0, 30.0, -230.0, 100.0, 60.0, 50.0, 50.0, 40.0, 5.0, -190.0, 150.0, 20.0, -5.0, 110.0, 360.0, 60.0, 20.0, 30.0, 10.0, 40.0, 20.0, 20.0, 20.0, 20.0, 180.0, 60.0, 30.0, 50.0, 0.0, -50.0, 10.0, 10.0, 50.0, 150.0, 20.0, 30.0, 20.0, 10.0, 10.0, 20.0, 0.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 10.0, 30.0, 20.0, 30.0, 170.0, 30.0, 80.0, 20.0, 10.0, 20.0, 100.0, 40.0, 60.0, -10.0, 590.0, 50.0, 80.0, 100.0, 180.0, 40.0, 40.0, 0.0, 160.0, 30.0, 0.0, 30.0, 0.0, 30.0, 280.0, 30.0, 60.0, 190.0, -10.0, -20.0, 70.0, 30.0, -50.0, 380.0, 20.0, 20.0, 20.0, 0.0, 180.0, 0.0, 180.0, 30.0, 50.0, 120.0, 0.0, 20.0, 30.0, 20.0, 20.0, 80.0, 20.0, 20.0, 60.0, 20.0, 60.0, 30.0, 50.0, -45.0, 60.0, 50.0, 60.0, 40.0, 410.0, 20.0, 1210.0, -20.0, 60.0, 30.0, -15.0, 0.0, 80.0, 10.0, 0.0, 5.0, 0.0, 190.0, 10.0, 10.0, -10.0, 50.0, 670.0, 50.0, 30.0, -40.0, 40.0, 60.0, 10.0, 10.0, 30.0, 20.0, 30.0, 0.0, 60.0, 0.0, 20.0, 10.0, 40.0, 20.0, 30.0, 60.0, 20.0, 190.0, 20.0, 20.0, 20.0, 80.0, 40.0, 10.0, 0.0, 30.0, 10.0, 40.0, 40.0, 20.0, 0.0, 20.0, 0.0, 20.0, 10.0, 40.0, 60.0, 270.0, 50.0, 90.0, 10.0, 10.0, 50.0, 20.0, 10.0, 10.0, 20.0, 110.0, 0.0, 100.0, 10.0, 40.0, 60.0, 0.0, 10.0, 40.0, 40.0, 190.0, 20.0, 0.0, 0.0, 190.0, 30.0, 20.0, 60.0, 30.0, 50.0, 20.0, 0.0, 10.0, 150.0, 40.0, 30.0, 10.0, 60.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 0.0, 1120.0, 0.0, 100.0, 30.0, 80.0, 50.0, 30.0, 100.0, 70.0, -60.0, 0.0, 40.0, 50.0, 50.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 50.0, 0.0, 10.0, 280.0, 40.0, -20.0, 170.0, 30.0, 570.0, 30.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 30.0, 20.0, 20.0, 0.0, 20.0, 160.0, 70.0, 280.0, 10.0, 0.0, 110.0, 90.0, 0.0, 10.0, 10.0, 0.0, 60.0, 70.0, 10.0, 10.0, 50.0, 0.0, 40.0, 40.0, 0.0, 80.0, 30.0, 20.0, 10.0, 180.0, 10.0, 0.0, 250.0, 0.0, 470.0, 30.0, 20.0, 30.0, -80.0, 70.0, 150.0, 0.0, -20.0, 230.0, 90.0, 0.0, 200.0, 60.0, 110.0, 250.0, 10.0, 60.0, 30.0, 0.0, 20.0, 20.0, 0.0, 30.0, 30.0, 10.0, 190.0, 30.0, 10.0, 10.0, 50.0, -20.0, 10.0, 20.0, 10.0, 1030.0, 20.0, 40.0, 60.0, 30.0, 10.0, 30.0, 40.0, 50.0, 260.0, 50.0, 0.0, 50.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, 110.0, 10.0, 20.0, 50.0, 350.0, 340.0, 80.0, 0.0, -30.0, 60.0, -30.0, 310.0, 90.0, 90.0, 20.0, 60.0, 180.0, 20.0, 60.0, 30.0, 30.0, 40.0, 20.0, 80.0, 80.0, 40.0, 20.0, 20.0, 50.0, 60.0, 0.0, 50.0, 20.0, 10.0, 10.0, 70.0, 60.0, 0.0, 40.0, 0.0, -40.0, 90.0, 50.0, 0.0, 0.0, 40.0, 0.0, 20.0, 30.0, 20.0, 20.0, 360.0, 50.0, 20.0, 60.0, 20.0, 30.0, 80.0, 0.0, 40.0, 40.0, 60.0, 0.0, 130.0, 20.0, 10.0, 30.0, 40.0, 40.0, 60.0, 30.0, 80.0, 10.0, 250.0, 30.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 100.0, 20.0, 20.0, 110.0, 180.0, 260.0, -150.0, 20.0, 20.0, 10.0, 0.0, 0.0, 20.0, 40.0, 60.0, 40.0, 20.0, 40.0, 0.0, 40.0, 0.0, 170.0, 30.0, 50.0, 20.0, 70.0, 60.0, 0.0, 20.0, 40.0, 20.0, 10.0, 30.0, 390.0, 40.0, 40.0, 80.0, 60.0, 40.0, 30.0, 20.0, 110.0, 40.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 270.0, 290.0, 60.0, 80.0, 0.0, 0.0, 10.0, 80.0, 40.0, 30.0, -30.0, 30.0, 10.0, 30.0, 30.0, 20.0, 0.0, 40.0, 10.0, 130.0, 10.0, 350.0, 30.0, 0.0, 0.0, 90.0, 40.0, 30.0, 0.0, 20.0, 30.0, 10.0, 0.0, 40.0, 160.0, 20.0, 40.0, 250.0, 350.0, 15.0, 50.0, 160.0, 0.0, 10.0, 40.0, 0.0, 30.0, 0.0, 10.0, 0.0, 20.0, 10.0, 50.0, 0.0, 50.0, 20.0, 10.0, 30.0, 20.0, 0.0, 40.0, 170.0, 270.0, 20.0, 50.0, 440.0, 40.0, 70.0, 20.0, 0.0, 100.0, 30.0, 0.0, 0.0, 40.0, 10.0, 40.0, 160.0, 0.0, 30.0, 30.0, 50.0, 30.0, 40.0, 690.0, 5.0, 20.0, 0.0, 70.0, 80.0, 20.0, 40.0, 110.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 40.0, 40.0, 10.0, 30.0, 30.0, 20.0, 10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4065640984035557, "mean_inference_ms": 1.6064143566803977, "mean_action_processing_ms": 0.4182395604641881, "mean_env_wait_ms": 1.29375431221688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.058661699295043945, "StateBufferConnector_ms": 0.009397268295288086, "ViewRequirementAgentConnector_ms": 0.3602457046508789}, "num_episodes": 23, "episode_return_max": 1835.0, "episode_return_min": 100.0, "episode_return_mean": 567.65}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 35.89241142058594, "num_env_steps_trained_throughput_per_sec": 35.89241142058594, "timesteps_total": 576000, "num_env_steps_sampled_lifetime": 576000, "num_agent_steps_sampled_lifetime": 5760000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5760000, "timers": {"training_iteration_time_ms": 110832.339, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110832.29, "sample_time_ms": 2371.138, "learn_time_ms": 108440.44, "learn_throughput": 36.887, "synch_weights_time_ms": 12.452}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 5760000, "num_agent_steps_trained": 5760000}, "done": false, "training_iteration": 144, "trial_id": "57140_00000", "date": "2024-06-27_03-44-36", "timestamp": 1719474276, "time_this_iter_s": 111.45075178146362, "time_total_s": 16201.138563632965, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3af43ab80>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16201.138563632965, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 15.774050632911393, "ram_util_percent": 78.94240506329113}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4308772734305855, "cur_kl_coeff": 3.3782402685697837, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0029273752420540615, "vf_loss": 4.458695898574001, "vf_explained_var": 0.0008992592049355959, "kl": Infinity, "entropy": 0.348262719694164, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1356855.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000}, "env_runners": {"episode_reward_max": 1835.0, "episode_reward_min": 100.0, "episode_reward_mean": 559.8, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -230.0}, "policy_reward_max": {"policy_0": 1210.0}, "policy_reward_mean": {"policy_0": 55.98}, "custom_metrics": {}, "hist_stats": {"episode_reward": [195.0, 545.0, 670.0, 660.0, 190.0, 300.0, 250.0, 220.0, 400.0, 355.0, 890.0, 245.0, 1285.0, 350.0, 430.0, 620.0, 270.0, 480.0, 150.0, 800.0, 570.0, 430.0, 290.0, 120.0, 420.0, 1230.0, 600.0, 690.0, 600.0, 360.0, 1835.0, 360.0, 870.0, 190.0, 500.0, 210.0, 560.0, 370.0, 550.0, 410.0, 150.0, 1520.0, 200.0, 1160.0, 120.0, 760.0, 220.0, 410.0, 940.0, 990.0, 360.0, 1180.0, 580.0, 260.0, 1260.0, 540.0, 350.0, 280.0, 560.0, 460.0, 570.0, 100.0, 590.0, 260.0, 460.0, 740.0, 490.0, 560.0, 310.0, 590.0, 935.0, 270.0, 230.0, 1180.0, 340.0, 1005.0, 310.0, 180.0, 1650.0, 490.0, 770.0, 1070.0, 310.0, 340.0, 760.0, 550.0, 1100.0, 460.0, 660.0, 570.0, 590.0, 200.0, 590.0, 730.0, 410.0, 390.0, 380.0, 560.0, 570.0, 940.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 40.0, 10.0, 10.0, 30.0, -25.0, 90.0, 20.0, 0.0, 20.0, 30.0, 20.0, 110.0, 30.0, 245.0, 30.0, 60.0, 50.0, -30.0, 0.0, 40.0, 20.0, 70.0, 50.0, 350.0, 60.0, 30.0, 40.0, 60.0, -50.0, 80.0, 50.0, 20.0, 10.0, 450.0, 90.0, -40.0, 0.0, 20.0, -20.0, 20.0, 20.0, 10.0, 20.0, 80.0, 10.0, 0.0, 10.0, 0.0, 20.0, 20.0, 50.0, 50.0, 40.0, 0.0, 20.0, 10.0, 30.0, 40.0, 40.0, 0.0, 40.0, 40.0, 0.0, 30.0, 10.0, 0.0, 40.0, 60.0, 30.0, 40.0, 30.0, 30.0, 0.0, 10.0, 0.0, 10.0, 80.0, 10.0, 10.0, 50.0, 250.0, 0.0, 30.0, 10.0, 30.0, 10.0, 20.0, 0.0, 0.0, 30.0, 0.0, 70.0, 70.0, 40.0, 20.0, 0.0, 30.0, -15.0, 110.0, 20.0, 40.0, 50.0, 10.0, 150.0, 350.0, 20.0, 50.0, 180.0, 20.0, 20.0, -25.0, 0.0, 30.0, 10.0, 40.0, 0.0, 160.0, 10.0, 0.0, 115.0, 360.0, 270.0, 30.0, 0.0, 140.0, 10.0, 200.0, 130.0, 30.0, 30.0, 30.0, 80.0, 10.0, 0.0, 20.0, 20.0, 70.0, 20.0, 70.0, 0.0, 0.0, 60.0, 40.0, 30.0, 20.0, 20.0, 30.0, 190.0, 40.0, 40.0, 150.0, 40.0, 20.0, 90.0, 50.0, 40.0, 30.0, 150.0, 10.0, 60.0, 40.0, 20.0, 10.0, 20.0, 50.0, 20.0, 0.0, 30.0, 20.0, 30.0, 30.0, 40.0, 120.0, 20.0, 80.0, 20.0, 40.0, 20.0, 80.0, 10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 40.0, 40.0, 10.0, 360.0, 40.0, 150.0, 190.0, 30.0, -230.0, 100.0, 60.0, 50.0, 50.0, 40.0, 5.0, -190.0, 150.0, 20.0, -5.0, 110.0, 360.0, 60.0, 20.0, 30.0, 10.0, 40.0, 20.0, 20.0, 20.0, 20.0, 180.0, 60.0, 30.0, 50.0, 0.0, -50.0, 10.0, 10.0, 50.0, 150.0, 20.0, 30.0, 20.0, 10.0, 10.0, 20.0, 0.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 10.0, 30.0, 20.0, 30.0, 170.0, 30.0, 80.0, 20.0, 10.0, 20.0, 100.0, 40.0, 60.0, -10.0, 590.0, 50.0, 80.0, 100.0, 180.0, 40.0, 40.0, 0.0, 160.0, 30.0, 0.0, 30.0, 0.0, 30.0, 280.0, 30.0, 60.0, 190.0, -10.0, -20.0, 70.0, 30.0, -50.0, 380.0, 20.0, 20.0, 20.0, 0.0, 180.0, 0.0, 180.0, 30.0, 50.0, 120.0, 0.0, 20.0, 30.0, 20.0, 20.0, 80.0, 20.0, 20.0, 60.0, 20.0, 60.0, 30.0, 50.0, -45.0, 60.0, 50.0, 60.0, 40.0, 410.0, 20.0, 1210.0, -20.0, 60.0, 30.0, -15.0, 0.0, 80.0, 10.0, 0.0, 5.0, 0.0, 190.0, 10.0, 10.0, -10.0, 50.0, 670.0, 50.0, 30.0, -40.0, 40.0, 60.0, 10.0, 10.0, 30.0, 20.0, 30.0, 0.0, 60.0, 0.0, 20.0, 10.0, 40.0, 20.0, 30.0, 60.0, 20.0, 190.0, 20.0, 20.0, 20.0, 80.0, 40.0, 10.0, 0.0, 30.0, 10.0, 40.0, 40.0, 20.0, 0.0, 20.0, 0.0, 20.0, 10.0, 40.0, 60.0, 270.0, 50.0, 90.0, 10.0, 10.0, 50.0, 20.0, 10.0, 10.0, 20.0, 110.0, 0.0, 100.0, 10.0, 40.0, 60.0, 0.0, 10.0, 40.0, 40.0, 190.0, 20.0, 0.0, 0.0, 190.0, 30.0, 20.0, 60.0, 30.0, 50.0, 20.0, 0.0, 10.0, 150.0, 40.0, 30.0, 10.0, 60.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 0.0, 1120.0, 0.0, 100.0, 30.0, 80.0, 50.0, 30.0, 100.0, 70.0, -60.0, 0.0, 40.0, 50.0, 50.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 50.0, 0.0, 10.0, 280.0, 40.0, -20.0, 170.0, 30.0, 570.0, 30.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 30.0, 20.0, 20.0, 0.0, 20.0, 160.0, 70.0, 280.0, 10.0, 0.0, 110.0, 90.0, 0.0, 10.0, 10.0, 0.0, 60.0, 70.0, 10.0, 10.0, 50.0, 0.0, 40.0, 40.0, 0.0, 80.0, 30.0, 20.0, 10.0, 180.0, 10.0, 0.0, 250.0, 0.0, 470.0, 30.0, 20.0, 30.0, -80.0, 70.0, 150.0, 0.0, -20.0, 230.0, 90.0, 0.0, 200.0, 60.0, 110.0, 250.0, 10.0, 60.0, 30.0, 0.0, 20.0, 20.0, 0.0, 30.0, 30.0, 10.0, 190.0, 30.0, 10.0, 10.0, 50.0, -20.0, 10.0, 20.0, 10.0, 1030.0, 20.0, 40.0, 60.0, 30.0, 10.0, 30.0, 40.0, 50.0, 260.0, 50.0, 0.0, 50.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, 110.0, 10.0, 20.0, 50.0, 350.0, 340.0, 80.0, 0.0, -30.0, 60.0, -30.0, 310.0, 90.0, 90.0, 20.0, 60.0, 180.0, 20.0, 60.0, 30.0, 30.0, 40.0, 20.0, 80.0, 80.0, 40.0, 20.0, 20.0, 50.0, 60.0, 0.0, 50.0, 20.0, 10.0, 10.0, 70.0, 60.0, 0.0, 40.0, 0.0, -40.0, 90.0, 50.0, 0.0, 0.0, 40.0, 0.0, 20.0, 30.0, 20.0, 20.0, 360.0, 50.0, 20.0, 60.0, 20.0, 30.0, 80.0, 0.0, 40.0, 40.0, 60.0, 0.0, 130.0, 20.0, 10.0, 30.0, 40.0, 40.0, 60.0, 30.0, 80.0, 10.0, 250.0, 30.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 100.0, 20.0, 20.0, 110.0, 180.0, 260.0, -150.0, 20.0, 20.0, 10.0, 0.0, 0.0, 20.0, 40.0, 60.0, 40.0, 20.0, 40.0, 0.0, 40.0, 0.0, 170.0, 30.0, 50.0, 20.0, 70.0, 60.0, 0.0, 20.0, 40.0, 20.0, 10.0, 30.0, 390.0, 40.0, 40.0, 80.0, 60.0, 40.0, 30.0, 20.0, 110.0, 40.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 270.0, 290.0, 60.0, 80.0, 0.0, 0.0, 10.0, 80.0, 40.0, 30.0, -30.0, 30.0, 10.0, 30.0, 30.0, 20.0, 0.0, 40.0, 10.0, 130.0, 10.0, 350.0, 30.0, 0.0, 0.0, 90.0, 40.0, 30.0, 0.0, 20.0, 30.0, 10.0, 0.0, 40.0, 160.0, 20.0, 40.0, 250.0, 350.0, 15.0, 50.0, 160.0, 0.0, 10.0, 40.0, 0.0, 30.0, 0.0, 10.0, 0.0, 20.0, 10.0, 50.0, 0.0, 50.0, 20.0, 10.0, 30.0, 20.0, 0.0, 40.0, 170.0, 270.0, 20.0, 50.0, 440.0, 40.0, 70.0, 20.0, 0.0, 100.0, 30.0, 0.0, 0.0, 40.0, 10.0, 40.0, 160.0, 0.0, 30.0, 30.0, 50.0, 30.0, 40.0, 690.0, 5.0, 20.0, 0.0, 70.0, 80.0, 20.0, 40.0, 110.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 40.0, 40.0, 10.0, 30.0, 30.0, 20.0, 10.0, 30.0, 30.0, 160.0, 110.0, 60.0, 720.0, 170.0, 80.0, 310.0, -20.0, -50.0, 40.0, 370.0, 10.0, 0.0, 30.0, -10.0, 40.0, 20.0, 40.0, 0.0, 60.0, 160.0, 80.0, 100.0, 10.0, 180.0, 0.0, 10.0, 170.0, 110.0, 80.0, 120.0, 20.0, 90.0, 220.0, 90.0, 120.0, 30.0, 190.0, 30.0, 0.0, 0.0, 30.0, 10.0, 170.0, 30.0, 10.0, 20.0, 10.0, 30.0, 150.0, 10.0, 10.0, 50.0, 10.0, 40.0, 10.0, 0.0, 30.0, 20.0, 150.0, 120.0, 300.0, 10.0, 0.0, 20.0, 40.0, 80.0, 20.0, 20.0, 80.0, 0.0, 260.0, 40.0, 10.0, -30.0, 90.0, 60.0, 20.0, 50.0, 30.0, 100.0, 30.0, 310.0, 40.0, 70.0, 380.0, 70.0, 20.0, 40.0, 170.0, 20.0, 40.0, 0.0, 70.0, 20.0, 30.0, 30.0, 40.0, 10.0, 0.0, 180.0, 30.0, 50.0, 20.0, 70.0, 40.0, 100.0, 160.0, -20.0, 30.0, 360.0, 70.0, 0.0, 0.0, 40.0, 30.0, 20.0, 40.0, 0.0, 10.0, 20.0, 20.0, 20.0, 260.0, 50.0, 30.0, 160.0, 20.0, 10.0, 50.0, 20.0, 30.0, 40.0, 0.0, 0.0, 40.0, 0.0, 10.0, 10.0, 60.0, 40.0, 40.0, 0.0, 0.0, 130.0, 290.0, 0.0, 20.0, 70.0, 40.0, 80.0, 40.0, 10.0, 270.0, 10.0, 0.0, 110.0, 100.0, 30.0, 30.0, 40.0, 10.0, 20.0, 0.0, 220.0, 40.0, 0.0, 20.0, -70.0, 20.0, 20.0, 150.0, 50.0, 0.0, 30.0, 0.0, 170.0, 20.0, 20.0, 0.0, 70.0, 10.0, 0.0, 30.0, 10.0, 10.0, 70.0, 160.0, 0.0, 210.0, 80.0, 60.0, 40.0, 70.0, 40.0, 40.0, 0.0, 20.0, 10.0, 170.0, 40.0, 30.0, 30.0, 50.0, 60.0, 160.0, 0.0, 20.0, 80.0, 20.0, 10.0, 0.0, 460.0, 20.0, 160.0, 90.0, 40.0, 60.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4093688412894811, "mean_inference_ms": 1.6128176501373384, "mean_action_processing_ms": 0.4196092068751943, "mean_env_wait_ms": 1.2960993332167912, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05871129035949707, "StateBufferConnector_ms": 0.009604215621948242, "ViewRequirementAgentConnector_ms": 0.35684847831726074}, "num_episodes": 22, "episode_return_max": 1835.0, "episode_return_min": 100.0, "episode_return_mean": 559.8}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.198277053669926, "num_env_steps_trained_throughput_per_sec": 36.198277053669926, "timesteps_total": 580000, "num_env_steps_sampled_lifetime": 580000, "num_agent_steps_sampled_lifetime": 5800000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5800000, "timers": {"training_iteration_time_ms": 110768.635, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110768.587, "sample_time_ms": 2368.205, "learn_time_ms": 108379.921, "learn_throughput": 36.907, "synch_weights_time_ms": 12.218}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 5800000, "num_agent_steps_trained": 5800000}, "done": false, "training_iteration": 145, "trial_id": "57140_00000", "date": "2024-06-27_03-46-27", "timestamp": 1719474387, "time_this_iter_s": 110.51578307151794, "time_total_s": 16311.654346704483, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b2594160>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16311.654346704483, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 15.275, "ram_util_percent": 79.22948717948718}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1750658851715956, "cur_kl_coeff": 5.067360402854677, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0022622660083122972, "vf_loss": 4.882518304676547, "vf_explained_var": 0.0005011194557173692, "kl": Infinity, "entropy": 0.34449801313769196, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1366245.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000}, "env_runners": {"episode_reward_max": 1835.0, "episode_reward_min": 100.0, "episode_reward_mean": 596.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -230.0}, "policy_reward_max": {"policy_0": 1210.0}, "policy_reward_mean": {"policy_0": 59.645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [150.0, 800.0, 570.0, 430.0, 290.0, 120.0, 420.0, 1230.0, 600.0, 690.0, 600.0, 360.0, 1835.0, 360.0, 870.0, 190.0, 500.0, 210.0, 560.0, 370.0, 550.0, 410.0, 150.0, 1520.0, 200.0, 1160.0, 120.0, 760.0, 220.0, 410.0, 940.0, 990.0, 360.0, 1180.0, 580.0, 260.0, 1260.0, 540.0, 350.0, 280.0, 560.0, 460.0, 570.0, 100.0, 590.0, 260.0, 460.0, 740.0, 490.0, 560.0, 310.0, 590.0, 935.0, 270.0, 230.0, 1180.0, 340.0, 1005.0, 310.0, 180.0, 1650.0, 490.0, 770.0, 1070.0, 310.0, 340.0, 760.0, 550.0, 1100.0, 460.0, 660.0, 570.0, 590.0, 200.0, 590.0, 730.0, 410.0, 390.0, 380.0, 560.0, 570.0, 940.0, 870.0, 1150.0, 1190.0, 660.0, 445.0, 650.0, 740.0, 390.0, 1020.0, 835.0, 1060.0, 670.0, 510.0, 220.0, 630.0, 380.0, 340.0, 260.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [10.0, 20.0, 0.0, 20.0, 10.0, 0.0, 0.0, 40.0, 40.0, 10.0, 360.0, 40.0, 150.0, 190.0, 30.0, -230.0, 100.0, 60.0, 50.0, 50.0, 40.0, 5.0, -190.0, 150.0, 20.0, -5.0, 110.0, 360.0, 60.0, 20.0, 30.0, 10.0, 40.0, 20.0, 20.0, 20.0, 20.0, 180.0, 60.0, 30.0, 50.0, 0.0, -50.0, 10.0, 10.0, 50.0, 150.0, 20.0, 30.0, 20.0, 10.0, 10.0, 20.0, 0.0, 0.0, 30.0, 30.0, 0.0, 20.0, 0.0, 10.0, 30.0, 20.0, 30.0, 170.0, 30.0, 80.0, 20.0, 10.0, 20.0, 100.0, 40.0, 60.0, -10.0, 590.0, 50.0, 80.0, 100.0, 180.0, 40.0, 40.0, 0.0, 160.0, 30.0, 0.0, 30.0, 0.0, 30.0, 280.0, 30.0, 60.0, 190.0, -10.0, -20.0, 70.0, 30.0, -50.0, 380.0, 20.0, 20.0, 20.0, 0.0, 180.0, 0.0, 180.0, 30.0, 50.0, 120.0, 0.0, 20.0, 30.0, 20.0, 20.0, 80.0, 20.0, 20.0, 60.0, 20.0, 60.0, 30.0, 50.0, -45.0, 60.0, 50.0, 60.0, 40.0, 410.0, 20.0, 1210.0, -20.0, 60.0, 30.0, -15.0, 0.0, 80.0, 10.0, 0.0, 5.0, 0.0, 190.0, 10.0, 10.0, -10.0, 50.0, 670.0, 50.0, 30.0, -40.0, 40.0, 60.0, 10.0, 10.0, 30.0, 20.0, 30.0, 0.0, 60.0, 0.0, 20.0, 10.0, 40.0, 20.0, 30.0, 60.0, 20.0, 190.0, 20.0, 20.0, 20.0, 80.0, 40.0, 10.0, 0.0, 30.0, 10.0, 40.0, 40.0, 20.0, 0.0, 20.0, 0.0, 20.0, 10.0, 40.0, 60.0, 270.0, 50.0, 90.0, 10.0, 10.0, 50.0, 20.0, 10.0, 10.0, 20.0, 110.0, 0.0, 100.0, 10.0, 40.0, 60.0, 0.0, 10.0, 40.0, 40.0, 190.0, 20.0, 0.0, 0.0, 190.0, 30.0, 20.0, 60.0, 30.0, 50.0, 20.0, 0.0, 10.0, 150.0, 40.0, 30.0, 10.0, 60.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 0.0, 1120.0, 0.0, 100.0, 30.0, 80.0, 50.0, 30.0, 100.0, 70.0, -60.0, 0.0, 40.0, 50.0, 50.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 50.0, 0.0, 10.0, 280.0, 40.0, -20.0, 170.0, 30.0, 570.0, 30.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 30.0, 20.0, 20.0, 0.0, 20.0, 160.0, 70.0, 280.0, 10.0, 0.0, 110.0, 90.0, 0.0, 10.0, 10.0, 0.0, 60.0, 70.0, 10.0, 10.0, 50.0, 0.0, 40.0, 40.0, 0.0, 80.0, 30.0, 20.0, 10.0, 180.0, 10.0, 0.0, 250.0, 0.0, 470.0, 30.0, 20.0, 30.0, -80.0, 70.0, 150.0, 0.0, -20.0, 230.0, 90.0, 0.0, 200.0, 60.0, 110.0, 250.0, 10.0, 60.0, 30.0, 0.0, 20.0, 20.0, 0.0, 30.0, 30.0, 10.0, 190.0, 30.0, 10.0, 10.0, 50.0, -20.0, 10.0, 20.0, 10.0, 1030.0, 20.0, 40.0, 60.0, 30.0, 10.0, 30.0, 40.0, 50.0, 260.0, 50.0, 0.0, 50.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, 110.0, 10.0, 20.0, 50.0, 350.0, 340.0, 80.0, 0.0, -30.0, 60.0, -30.0, 310.0, 90.0, 90.0, 20.0, 60.0, 180.0, 20.0, 60.0, 30.0, 30.0, 40.0, 20.0, 80.0, 80.0, 40.0, 20.0, 20.0, 50.0, 60.0, 0.0, 50.0, 20.0, 10.0, 10.0, 70.0, 60.0, 0.0, 40.0, 0.0, -40.0, 90.0, 50.0, 0.0, 0.0, 40.0, 0.0, 20.0, 30.0, 20.0, 20.0, 360.0, 50.0, 20.0, 60.0, 20.0, 30.0, 80.0, 0.0, 40.0, 40.0, 60.0, 0.0, 130.0, 20.0, 10.0, 30.0, 40.0, 40.0, 60.0, 30.0, 80.0, 10.0, 250.0, 30.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 100.0, 20.0, 20.0, 110.0, 180.0, 260.0, -150.0, 20.0, 20.0, 10.0, 0.0, 0.0, 20.0, 40.0, 60.0, 40.0, 20.0, 40.0, 0.0, 40.0, 0.0, 170.0, 30.0, 50.0, 20.0, 70.0, 60.0, 0.0, 20.0, 40.0, 20.0, 10.0, 30.0, 390.0, 40.0, 40.0, 80.0, 60.0, 40.0, 30.0, 20.0, 110.0, 40.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 270.0, 290.0, 60.0, 80.0, 0.0, 0.0, 10.0, 80.0, 40.0, 30.0, -30.0, 30.0, 10.0, 30.0, 30.0, 20.0, 0.0, 40.0, 10.0, 130.0, 10.0, 350.0, 30.0, 0.0, 0.0, 90.0, 40.0, 30.0, 0.0, 20.0, 30.0, 10.0, 0.0, 40.0, 160.0, 20.0, 40.0, 250.0, 350.0, 15.0, 50.0, 160.0, 0.0, 10.0, 40.0, 0.0, 30.0, 0.0, 10.0, 0.0, 20.0, 10.0, 50.0, 0.0, 50.0, 20.0, 10.0, 30.0, 20.0, 0.0, 40.0, 170.0, 270.0, 20.0, 50.0, 440.0, 40.0, 70.0, 20.0, 0.0, 100.0, 30.0, 0.0, 0.0, 40.0, 10.0, 40.0, 160.0, 0.0, 30.0, 30.0, 50.0, 30.0, 40.0, 690.0, 5.0, 20.0, 0.0, 70.0, 80.0, 20.0, 40.0, 110.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 40.0, 40.0, 10.0, 30.0, 30.0, 20.0, 10.0, 30.0, 30.0, 160.0, 110.0, 60.0, 720.0, 170.0, 80.0, 310.0, -20.0, -50.0, 40.0, 370.0, 10.0, 0.0, 30.0, -10.0, 40.0, 20.0, 40.0, 0.0, 60.0, 160.0, 80.0, 100.0, 10.0, 180.0, 0.0, 10.0, 170.0, 110.0, 80.0, 120.0, 20.0, 90.0, 220.0, 90.0, 120.0, 30.0, 190.0, 30.0, 0.0, 0.0, 30.0, 10.0, 170.0, 30.0, 10.0, 20.0, 10.0, 30.0, 150.0, 10.0, 10.0, 50.0, 10.0, 40.0, 10.0, 0.0, 30.0, 20.0, 150.0, 120.0, 300.0, 10.0, 0.0, 20.0, 40.0, 80.0, 20.0, 20.0, 80.0, 0.0, 260.0, 40.0, 10.0, -30.0, 90.0, 60.0, 20.0, 50.0, 30.0, 100.0, 30.0, 310.0, 40.0, 70.0, 380.0, 70.0, 20.0, 40.0, 170.0, 20.0, 40.0, 0.0, 70.0, 20.0, 30.0, 30.0, 40.0, 10.0, 0.0, 180.0, 30.0, 50.0, 20.0, 70.0, 40.0, 100.0, 160.0, -20.0, 30.0, 360.0, 70.0, 0.0, 0.0, 40.0, 30.0, 20.0, 40.0, 0.0, 10.0, 20.0, 20.0, 20.0, 260.0, 50.0, 30.0, 160.0, 20.0, 10.0, 50.0, 20.0, 30.0, 40.0, 0.0, 0.0, 40.0, 0.0, 10.0, 10.0, 60.0, 40.0, 40.0, 0.0, 0.0, 130.0, 290.0, 0.0, 20.0, 70.0, 40.0, 80.0, 40.0, 10.0, 270.0, 10.0, 0.0, 110.0, 100.0, 30.0, 30.0, 40.0, 10.0, 20.0, 0.0, 220.0, 40.0, 0.0, 20.0, -70.0, 20.0, 20.0, 150.0, 50.0, 0.0, 30.0, 0.0, 170.0, 20.0, 20.0, 0.0, 70.0, 10.0, 0.0, 30.0, 10.0, 10.0, 70.0, 160.0, 0.0, 210.0, 80.0, 60.0, 40.0, 70.0, 40.0, 40.0, 0.0, 20.0, 10.0, 170.0, 40.0, 30.0, 30.0, 50.0, 60.0, 160.0, 0.0, 20.0, 80.0, 20.0, 10.0, 0.0, 460.0, 20.0, 160.0, 90.0, 40.0, 60.0, 10.0, 180.0, 350.0, 30.0, 30.0, 140.0, 30.0, 20.0, 40.0, 40.0, 270.0, 30.0, 60.0, 70.0, 30.0, 30.0, 70.0, 370.0, 40.0, 180.0, 30.0, 170.0, 120.0, 20.0, 50.0, 30.0, 10.0, 360.0, 150.0, 250.0, 20.0, 50.0, 50.0, 90.0, 0.0, 270.0, 60.0, 20.0, 40.0, 60.0, 10.0, 50.0, 10.0, 10.0, 50.0, 160.0, 0.0, 30.0, 10.0, 115.0, 60.0, 20.0, 55.0, 95.0, 70.0, 70.0, 160.0, 180.0, -130.0, 70.0, 280.0, 170.0, 60.0, 30.0, 40.0, 60.0, 30.0, 20.0, 10.0, 40.0, 20.0, 30.0, 10.0, 40.0, 10.0, 80.0, 30.0, 40.0, 100.0, 30.0, 510.0, 120.0, 50.0, 30.0, 90.0, 60.0, 10.0, 60.0, 40.0, 50.0, 300.0, 100.0, 20.0, 70.0, 40.0, 0.0, 30.0, 60.0, 15.0, 200.0, -40.0, 40.0, 90.0, 140.0, 20.0, 520.0, 70.0, 170.0, 40.0, 10.0, 20.0, 0.0, 40.0, 20.0, 380.0, 10.0, 0.0, 160.0, 30.0, 10.0, 80.0, 180.0, 40.0, 70.0, 70.0, 30.0, 10.0, 0.0, 30.0, 0.0, 40.0, 40.0, 10.0, 40.0, 20.0, 0.0, 0.0, 40.0, 0.0, 30.0, 150.0, 50.0, 30.0, 210.0, 60.0, 10.0, 40.0, 20.0, 30.0, 30.0, 60.0, 90.0, 20.0, 30.0, 40.0, 40.0, 80.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 60.0, 10.0, 70.0, 40.0, 110.0, 10.0, 30.0, 30.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 90.0, 0.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4052306839445814, "mean_inference_ms": 1.6049185476847467, "mean_action_processing_ms": 0.41774391200101346, "mean_env_wait_ms": 1.292728770473226, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05600786209106445, "StateBufferConnector_ms": 0.00932455062866211, "ViewRequirementAgentConnector_ms": 0.35303425788879395}, "num_episodes": 18, "episode_return_max": 1835.0, "episode_return_min": 100.0, "episode_return_mean": 596.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.36098762765109, "num_env_steps_trained_throughput_per_sec": 36.36098762765109, "timesteps_total": 584000, "num_env_steps_sampled_lifetime": 584000, "num_agent_steps_sampled_lifetime": 5840000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5840000, "timers": {"training_iteration_time_ms": 110676.013, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110675.966, "sample_time_ms": 2373.238, "learn_time_ms": 108282.306, "learn_throughput": 36.94, "synch_weights_time_ms": 12.205}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 5840000, "num_agent_steps_trained": 5840000}, "done": false, "training_iteration": 146, "trial_id": "57140_00000", "date": "2024-06-27_03-48-17", "timestamp": 1719474497, "time_this_iter_s": 110.02175903320312, "time_total_s": 16421.676105737686, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23e4c10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16421.676105737686, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 15.391612903225806, "ram_util_percent": 79.37677419354839}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.492179621224459, "cur_kl_coeff": 7.601040604282018, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0028049112652171566, "vf_loss": 3.9151024367227847, "vf_explained_var": 0.0006518669466114145, "kl": Infinity, "entropy": 0.34164791136377026, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1375635.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000}, "env_runners": {"episode_reward_max": 1740.0, "episode_reward_min": 100.0, "episode_reward_mean": 600.45, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 1120.0}, "policy_reward_mean": {"policy_0": 60.045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [560.0, 370.0, 550.0, 410.0, 150.0, 1520.0, 200.0, 1160.0, 120.0, 760.0, 220.0, 410.0, 940.0, 990.0, 360.0, 1180.0, 580.0, 260.0, 1260.0, 540.0, 350.0, 280.0, 560.0, 460.0, 570.0, 100.0, 590.0, 260.0, 460.0, 740.0, 490.0, 560.0, 310.0, 590.0, 935.0, 270.0, 230.0, 1180.0, 340.0, 1005.0, 310.0, 180.0, 1650.0, 490.0, 770.0, 1070.0, 310.0, 340.0, 760.0, 550.0, 1100.0, 460.0, 660.0, 570.0, 590.0, 200.0, 590.0, 730.0, 410.0, 390.0, 380.0, 560.0, 570.0, 940.0, 870.0, 1150.0, 1190.0, 660.0, 445.0, 650.0, 740.0, 390.0, 1020.0, 835.0, 1060.0, 670.0, 510.0, 220.0, 630.0, 380.0, 340.0, 260.0, 1740.0, 270.0, 880.0, 160.0, 920.0, 200.0, 770.0, 665.0, 700.0, 220.0, 820.0, 990.0, 1050.0, 250.0, 330.0, 210.0, 270.0, 180.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 20.0, 10.0, 40.0, 60.0, 270.0, 50.0, 90.0, 10.0, 10.0, 50.0, 20.0, 10.0, 10.0, 20.0, 110.0, 0.0, 100.0, 10.0, 40.0, 60.0, 0.0, 10.0, 40.0, 40.0, 190.0, 20.0, 0.0, 0.0, 190.0, 30.0, 20.0, 60.0, 30.0, 50.0, 20.0, 0.0, 10.0, 150.0, 40.0, 30.0, 10.0, 60.0, 0.0, 0.0, 10.0, 20.0, 20.0, 0.0, 0.0, 1120.0, 0.0, 100.0, 30.0, 80.0, 50.0, 30.0, 100.0, 70.0, -60.0, 0.0, 40.0, 50.0, 50.0, 0.0, 20.0, 0.0, 10.0, 20.0, 10.0, 50.0, 0.0, 10.0, 280.0, 40.0, -20.0, 170.0, 30.0, 570.0, 30.0, 0.0, 0.0, 10.0, 20.0, 0.0, 0.0, 10.0, 30.0, 30.0, 20.0, 20.0, 0.0, 20.0, 160.0, 70.0, 280.0, 10.0, 0.0, 110.0, 90.0, 0.0, 10.0, 10.0, 0.0, 60.0, 70.0, 10.0, 10.0, 50.0, 0.0, 40.0, 40.0, 0.0, 80.0, 30.0, 20.0, 10.0, 180.0, 10.0, 0.0, 250.0, 0.0, 470.0, 30.0, 20.0, 30.0, -80.0, 70.0, 150.0, 0.0, -20.0, 230.0, 90.0, 0.0, 200.0, 60.0, 110.0, 250.0, 10.0, 60.0, 30.0, 0.0, 20.0, 20.0, 0.0, 30.0, 30.0, 10.0, 190.0, 30.0, 10.0, 10.0, 50.0, -20.0, 10.0, 20.0, 10.0, 1030.0, 20.0, 40.0, 60.0, 30.0, 10.0, 30.0, 40.0, 50.0, 260.0, 50.0, 0.0, 50.0, 0.0, 10.0, 20.0, 10.0, 20.0, 10.0, 110.0, 10.0, 20.0, 50.0, 350.0, 340.0, 80.0, 0.0, -30.0, 60.0, -30.0, 310.0, 90.0, 90.0, 20.0, 60.0, 180.0, 20.0, 60.0, 30.0, 30.0, 40.0, 20.0, 80.0, 80.0, 40.0, 20.0, 20.0, 50.0, 60.0, 0.0, 50.0, 20.0, 10.0, 10.0, 70.0, 60.0, 0.0, 40.0, 0.0, -40.0, 90.0, 50.0, 0.0, 0.0, 40.0, 0.0, 20.0, 30.0, 20.0, 20.0, 360.0, 50.0, 20.0, 60.0, 20.0, 30.0, 80.0, 0.0, 40.0, 40.0, 60.0, 0.0, 130.0, 20.0, 10.0, 30.0, 40.0, 40.0, 60.0, 30.0, 80.0, 10.0, 250.0, 30.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 100.0, 20.0, 20.0, 110.0, 180.0, 260.0, -150.0, 20.0, 20.0, 10.0, 0.0, 0.0, 20.0, 40.0, 60.0, 40.0, 20.0, 40.0, 0.0, 40.0, 0.0, 170.0, 30.0, 50.0, 20.0, 70.0, 60.0, 0.0, 20.0, 40.0, 20.0, 10.0, 30.0, 390.0, 40.0, 40.0, 80.0, 60.0, 40.0, 30.0, 20.0, 110.0, 40.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 270.0, 290.0, 60.0, 80.0, 0.0, 0.0, 10.0, 80.0, 40.0, 30.0, -30.0, 30.0, 10.0, 30.0, 30.0, 20.0, 0.0, 40.0, 10.0, 130.0, 10.0, 350.0, 30.0, 0.0, 0.0, 90.0, 40.0, 30.0, 0.0, 20.0, 30.0, 10.0, 0.0, 40.0, 160.0, 20.0, 40.0, 250.0, 350.0, 15.0, 50.0, 160.0, 0.0, 10.0, 40.0, 0.0, 30.0, 0.0, 10.0, 0.0, 20.0, 10.0, 50.0, 0.0, 50.0, 20.0, 10.0, 30.0, 20.0, 0.0, 40.0, 170.0, 270.0, 20.0, 50.0, 440.0, 40.0, 70.0, 20.0, 0.0, 100.0, 30.0, 0.0, 0.0, 40.0, 10.0, 40.0, 160.0, 0.0, 30.0, 30.0, 50.0, 30.0, 40.0, 690.0, 5.0, 20.0, 0.0, 70.0, 80.0, 20.0, 40.0, 110.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 40.0, 40.0, 10.0, 30.0, 30.0, 20.0, 10.0, 30.0, 30.0, 160.0, 110.0, 60.0, 720.0, 170.0, 80.0, 310.0, -20.0, -50.0, 40.0, 370.0, 10.0, 0.0, 30.0, -10.0, 40.0, 20.0, 40.0, 0.0, 60.0, 160.0, 80.0, 100.0, 10.0, 180.0, 0.0, 10.0, 170.0, 110.0, 80.0, 120.0, 20.0, 90.0, 220.0, 90.0, 120.0, 30.0, 190.0, 30.0, 0.0, 0.0, 30.0, 10.0, 170.0, 30.0, 10.0, 20.0, 10.0, 30.0, 150.0, 10.0, 10.0, 50.0, 10.0, 40.0, 10.0, 0.0, 30.0, 20.0, 150.0, 120.0, 300.0, 10.0, 0.0, 20.0, 40.0, 80.0, 20.0, 20.0, 80.0, 0.0, 260.0, 40.0, 10.0, -30.0, 90.0, 60.0, 20.0, 50.0, 30.0, 100.0, 30.0, 310.0, 40.0, 70.0, 380.0, 70.0, 20.0, 40.0, 170.0, 20.0, 40.0, 0.0, 70.0, 20.0, 30.0, 30.0, 40.0, 10.0, 0.0, 180.0, 30.0, 50.0, 20.0, 70.0, 40.0, 100.0, 160.0, -20.0, 30.0, 360.0, 70.0, 0.0, 0.0, 40.0, 30.0, 20.0, 40.0, 0.0, 10.0, 20.0, 20.0, 20.0, 260.0, 50.0, 30.0, 160.0, 20.0, 10.0, 50.0, 20.0, 30.0, 40.0, 0.0, 0.0, 40.0, 0.0, 10.0, 10.0, 60.0, 40.0, 40.0, 0.0, 0.0, 130.0, 290.0, 0.0, 20.0, 70.0, 40.0, 80.0, 40.0, 10.0, 270.0, 10.0, 0.0, 110.0, 100.0, 30.0, 30.0, 40.0, 10.0, 20.0, 0.0, 220.0, 40.0, 0.0, 20.0, -70.0, 20.0, 20.0, 150.0, 50.0, 0.0, 30.0, 0.0, 170.0, 20.0, 20.0, 0.0, 70.0, 10.0, 0.0, 30.0, 10.0, 10.0, 70.0, 160.0, 0.0, 210.0, 80.0, 60.0, 40.0, 70.0, 40.0, 40.0, 0.0, 20.0, 10.0, 170.0, 40.0, 30.0, 30.0, 50.0, 60.0, 160.0, 0.0, 20.0, 80.0, 20.0, 10.0, 0.0, 460.0, 20.0, 160.0, 90.0, 40.0, 60.0, 10.0, 180.0, 350.0, 30.0, 30.0, 140.0, 30.0, 20.0, 40.0, 40.0, 270.0, 30.0, 60.0, 70.0, 30.0, 30.0, 70.0, 370.0, 40.0, 180.0, 30.0, 170.0, 120.0, 20.0, 50.0, 30.0, 10.0, 360.0, 150.0, 250.0, 20.0, 50.0, 50.0, 90.0, 0.0, 270.0, 60.0, 20.0, 40.0, 60.0, 10.0, 50.0, 10.0, 10.0, 50.0, 160.0, 0.0, 30.0, 10.0, 115.0, 60.0, 20.0, 55.0, 95.0, 70.0, 70.0, 160.0, 180.0, -130.0, 70.0, 280.0, 170.0, 60.0, 30.0, 40.0, 60.0, 30.0, 20.0, 10.0, 40.0, 20.0, 30.0, 10.0, 40.0, 10.0, 80.0, 30.0, 40.0, 100.0, 30.0, 510.0, 120.0, 50.0, 30.0, 90.0, 60.0, 10.0, 60.0, 40.0, 50.0, 300.0, 100.0, 20.0, 70.0, 40.0, 0.0, 30.0, 60.0, 15.0, 200.0, -40.0, 40.0, 90.0, 140.0, 20.0, 520.0, 70.0, 170.0, 40.0, 10.0, 20.0, 0.0, 40.0, 20.0, 380.0, 10.0, 0.0, 160.0, 30.0, 10.0, 80.0, 180.0, 40.0, 70.0, 70.0, 30.0, 10.0, 0.0, 30.0, 0.0, 40.0, 40.0, 10.0, 40.0, 20.0, 0.0, 0.0, 40.0, 0.0, 30.0, 150.0, 50.0, 30.0, 210.0, 60.0, 10.0, 40.0, 20.0, 30.0, 30.0, 60.0, 90.0, 20.0, 30.0, 40.0, 40.0, 80.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 60.0, 10.0, 70.0, 40.0, 110.0, 10.0, 30.0, 30.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 90.0, 0.0, 40.0, 170.0, 30.0, 200.0, 40.0, 80.0, 70.0, 250.0, 310.0, 580.0, 10.0, 10.0, 30.0, -30.0, 0.0, 0.0, 0.0, 0.0, 210.0, 30.0, 20.0, 30.0, 70.0, 0.0, 170.0, 20.0, 10.0, 10.0, 10.0, 250.0, 310.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 40.0, 20.0, 40.0, 90.0, 60.0, 20.0, 40.0, 30.0, 370.0, 70.0, 70.0, 170.0, 0.0, 20.0, 20.0, 40.0, 30.0, 20.0, 0.0, 30.0, 20.0, 0.0, 20.0, 20.0, 60.0, 270.0, 40.0, 40.0, 60.0, 180.0, 0.0, 60.0, 40.0, 10.0, -40.0, 360.0, 10.0, 15.0, 60.0, 20.0, 200.0, 30.0, 0.0, 20.0, 10.0, 50.0, 400.0, 50.0, 10.0, 20.0, 60.0, 70.0, 10.0, 0.0, 10.0, 40.0, 40.0, 0.0, 0.0, 70.0, 40.0, 0.0, 20.0, 250.0, 10.0, -20.0, 70.0, 0.0, 480.0, 10.0, 20.0, 0.0, 0.0, 40.0, 60.0, 50.0, 20.0, 20.0, 270.0, 50.0, 380.0, 10.0, 90.0, 30.0, 560.0, 50.0, 50.0, -10.0, 10.0, 110.0, 10.0, 80.0, 160.0, 30.0, 40.0, 10.0, 40.0, 10.0, 20.0, 0.0, 60.0, 0.0, 40.0, 0.0, 20.0, 20.0, 100.0, 120.0, 0.0, 10.0, 10.0, 40.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 260.0, 0.0, 50.0, 70.0, -210.0, 20.0, 10.0, 50.0, 20.0, 10.0, 0.0, 30.0, 90.0, 0.0, 40.0, 30.0, 0.0, 30.0, 0.0, 0.0, 0.0, 20.0, 10.0, 50.0, 40.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4046176642257018, "mean_inference_ms": 1.604284207013256, "mean_action_processing_ms": 0.41752492839037786, "mean_env_wait_ms": 1.2922781726251664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.057758331298828125, "StateBufferConnector_ms": 0.009430885314941406, "ViewRequirementAgentConnector_ms": 0.36068153381347656}, "num_episodes": 18, "episode_return_max": 1740.0, "episode_return_min": 100.0, "episode_return_mean": 600.45}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 35.976585477863075, "num_env_steps_trained_throughput_per_sec": 35.976585477863075, "timesteps_total": 588000, "num_env_steps_sampled_lifetime": 588000, "num_agent_steps_sampled_lifetime": 5880000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5880000, "timers": {"training_iteration_time_ms": 110728.686, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110728.639, "sample_time_ms": 2378.257, "learn_time_ms": 108329.804, "learn_throughput": 36.924, "synch_weights_time_ms": 12.288}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 5880000, "num_agent_steps_trained": 5880000}, "done": false, "training_iteration": 147, "trial_id": "57140_00000", "date": "2024-06-27_03-50-08", "timestamp": 1719474608, "time_this_iter_s": 111.20342898368835, "time_total_s": 16532.879534721375, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b257fc10>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16532.879534721375, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 16.300632911392405, "ram_util_percent": 78.90949367088608}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6967556878019825, "cur_kl_coeff": 11.401560906423024, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.14091201701992, "policy_loss": -0.0011527800604728814, "vf_loss": 4.140225280004061, "vf_explained_var": 0.0005598771876801317, "kl": 0.00016133913027018714, "entropy": 0.3447681873528975, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1385025.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000}, "env_runners": {"episode_reward_max": 1740.0, "episode_reward_min": 100.0, "episode_reward_mean": 596.85, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 18, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -210.0}, "policy_reward_max": {"policy_0": 720.0}, "policy_reward_mean": {"policy_0": 59.685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [1260.0, 540.0, 350.0, 280.0, 560.0, 460.0, 570.0, 100.0, 590.0, 260.0, 460.0, 740.0, 490.0, 560.0, 310.0, 590.0, 935.0, 270.0, 230.0, 1180.0, 340.0, 1005.0, 310.0, 180.0, 1650.0, 490.0, 770.0, 1070.0, 310.0, 340.0, 760.0, 550.0, 1100.0, 460.0, 660.0, 570.0, 590.0, 200.0, 590.0, 730.0, 410.0, 390.0, 380.0, 560.0, 570.0, 940.0, 870.0, 1150.0, 1190.0, 660.0, 445.0, 650.0, 740.0, 390.0, 1020.0, 835.0, 1060.0, 670.0, 510.0, 220.0, 630.0, 380.0, 340.0, 260.0, 1740.0, 270.0, 880.0, 160.0, 920.0, 200.0, 770.0, 665.0, 700.0, 220.0, 820.0, 990.0, 1050.0, 250.0, 330.0, 210.0, 270.0, 180.0, 800.0, 290.0, 920.0, 1220.0, 415.0, 240.0, 855.0, 490.0, 580.0, 400.0, 780.0, 720.0, 320.0, 280.0, 420.0, 700.0, 480.0, 470.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [350.0, 340.0, 80.0, 0.0, -30.0, 60.0, -30.0, 310.0, 90.0, 90.0, 20.0, 60.0, 180.0, 20.0, 60.0, 30.0, 30.0, 40.0, 20.0, 80.0, 80.0, 40.0, 20.0, 20.0, 50.0, 60.0, 0.0, 50.0, 20.0, 10.0, 10.0, 70.0, 60.0, 0.0, 40.0, 0.0, -40.0, 90.0, 50.0, 0.0, 0.0, 40.0, 0.0, 20.0, 30.0, 20.0, 20.0, 360.0, 50.0, 20.0, 60.0, 20.0, 30.0, 80.0, 0.0, 40.0, 40.0, 60.0, 0.0, 130.0, 20.0, 10.0, 30.0, 40.0, 40.0, 60.0, 30.0, 80.0, 10.0, 250.0, 30.0, 20.0, 20.0, 20.0, 0.0, 0.0, 0.0, 0.0, 0.0, 10.0, 100.0, 20.0, 20.0, 110.0, 180.0, 260.0, -150.0, 20.0, 20.0, 10.0, 0.0, 0.0, 20.0, 40.0, 60.0, 40.0, 20.0, 40.0, 0.0, 40.0, 0.0, 170.0, 30.0, 50.0, 20.0, 70.0, 60.0, 0.0, 20.0, 40.0, 20.0, 10.0, 30.0, 390.0, 40.0, 40.0, 80.0, 60.0, 40.0, 30.0, 20.0, 110.0, 40.0, 10.0, 0.0, 10.0, 0.0, 10.0, 20.0, 270.0, 290.0, 60.0, 80.0, 0.0, 0.0, 10.0, 80.0, 40.0, 30.0, -30.0, 30.0, 10.0, 30.0, 30.0, 20.0, 0.0, 40.0, 10.0, 130.0, 10.0, 350.0, 30.0, 0.0, 0.0, 90.0, 40.0, 30.0, 0.0, 20.0, 30.0, 10.0, 0.0, 40.0, 160.0, 20.0, 40.0, 250.0, 350.0, 15.0, 50.0, 160.0, 0.0, 10.0, 40.0, 0.0, 30.0, 0.0, 10.0, 0.0, 20.0, 10.0, 50.0, 0.0, 50.0, 20.0, 10.0, 30.0, 20.0, 0.0, 40.0, 170.0, 270.0, 20.0, 50.0, 440.0, 40.0, 70.0, 20.0, 0.0, 100.0, 30.0, 0.0, 0.0, 40.0, 10.0, 40.0, 160.0, 0.0, 30.0, 30.0, 50.0, 30.0, 40.0, 690.0, 5.0, 20.0, 0.0, 70.0, 80.0, 20.0, 40.0, 110.0, 0.0, 20.0, 20.0, 30.0, 40.0, 20.0, 10.0, 20.0, 0.0, 0.0, 0.0, 40.0, 40.0, 10.0, 30.0, 30.0, 20.0, 10.0, 30.0, 30.0, 160.0, 110.0, 60.0, 720.0, 170.0, 80.0, 310.0, -20.0, -50.0, 40.0, 370.0, 10.0, 0.0, 30.0, -10.0, 40.0, 20.0, 40.0, 0.0, 60.0, 160.0, 80.0, 100.0, 10.0, 180.0, 0.0, 10.0, 170.0, 110.0, 80.0, 120.0, 20.0, 90.0, 220.0, 90.0, 120.0, 30.0, 190.0, 30.0, 0.0, 0.0, 30.0, 10.0, 170.0, 30.0, 10.0, 20.0, 10.0, 30.0, 150.0, 10.0, 10.0, 50.0, 10.0, 40.0, 10.0, 0.0, 30.0, 20.0, 150.0, 120.0, 300.0, 10.0, 0.0, 20.0, 40.0, 80.0, 20.0, 20.0, 80.0, 0.0, 260.0, 40.0, 10.0, -30.0, 90.0, 60.0, 20.0, 50.0, 30.0, 100.0, 30.0, 310.0, 40.0, 70.0, 380.0, 70.0, 20.0, 40.0, 170.0, 20.0, 40.0, 0.0, 70.0, 20.0, 30.0, 30.0, 40.0, 10.0, 0.0, 180.0, 30.0, 50.0, 20.0, 70.0, 40.0, 100.0, 160.0, -20.0, 30.0, 360.0, 70.0, 0.0, 0.0, 40.0, 30.0, 20.0, 40.0, 0.0, 10.0, 20.0, 20.0, 20.0, 260.0, 50.0, 30.0, 160.0, 20.0, 10.0, 50.0, 20.0, 30.0, 40.0, 0.0, 0.0, 40.0, 0.0, 10.0, 10.0, 60.0, 40.0, 40.0, 0.0, 0.0, 130.0, 290.0, 0.0, 20.0, 70.0, 40.0, 80.0, 40.0, 10.0, 270.0, 10.0, 0.0, 110.0, 100.0, 30.0, 30.0, 40.0, 10.0, 20.0, 0.0, 220.0, 40.0, 0.0, 20.0, -70.0, 20.0, 20.0, 150.0, 50.0, 0.0, 30.0, 0.0, 170.0, 20.0, 20.0, 0.0, 70.0, 10.0, 0.0, 30.0, 10.0, 10.0, 70.0, 160.0, 0.0, 210.0, 80.0, 60.0, 40.0, 70.0, 40.0, 40.0, 0.0, 20.0, 10.0, 170.0, 40.0, 30.0, 30.0, 50.0, 60.0, 160.0, 0.0, 20.0, 80.0, 20.0, 10.0, 0.0, 460.0, 20.0, 160.0, 90.0, 40.0, 60.0, 10.0, 180.0, 350.0, 30.0, 30.0, 140.0, 30.0, 20.0, 40.0, 40.0, 270.0, 30.0, 60.0, 70.0, 30.0, 30.0, 70.0, 370.0, 40.0, 180.0, 30.0, 170.0, 120.0, 20.0, 50.0, 30.0, 10.0, 360.0, 150.0, 250.0, 20.0, 50.0, 50.0, 90.0, 0.0, 270.0, 60.0, 20.0, 40.0, 60.0, 10.0, 50.0, 10.0, 10.0, 50.0, 160.0, 0.0, 30.0, 10.0, 115.0, 60.0, 20.0, 55.0, 95.0, 70.0, 70.0, 160.0, 180.0, -130.0, 70.0, 280.0, 170.0, 60.0, 30.0, 40.0, 60.0, 30.0, 20.0, 10.0, 40.0, 20.0, 30.0, 10.0, 40.0, 10.0, 80.0, 30.0, 40.0, 100.0, 30.0, 510.0, 120.0, 50.0, 30.0, 90.0, 60.0, 10.0, 60.0, 40.0, 50.0, 300.0, 100.0, 20.0, 70.0, 40.0, 0.0, 30.0, 60.0, 15.0, 200.0, -40.0, 40.0, 90.0, 140.0, 20.0, 520.0, 70.0, 170.0, 40.0, 10.0, 20.0, 0.0, 40.0, 20.0, 380.0, 10.0, 0.0, 160.0, 30.0, 10.0, 80.0, 180.0, 40.0, 70.0, 70.0, 30.0, 10.0, 0.0, 30.0, 0.0, 40.0, 40.0, 10.0, 40.0, 20.0, 0.0, 0.0, 40.0, 0.0, 30.0, 150.0, 50.0, 30.0, 210.0, 60.0, 10.0, 40.0, 20.0, 30.0, 30.0, 60.0, 90.0, 20.0, 30.0, 40.0, 40.0, 80.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 60.0, 10.0, 70.0, 40.0, 110.0, 10.0, 30.0, 30.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 90.0, 0.0, 40.0, 170.0, 30.0, 200.0, 40.0, 80.0, 70.0, 250.0, 310.0, 580.0, 10.0, 10.0, 30.0, -30.0, 0.0, 0.0, 0.0, 0.0, 210.0, 30.0, 20.0, 30.0, 70.0, 0.0, 170.0, 20.0, 10.0, 10.0, 10.0, 250.0, 310.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 40.0, 20.0, 40.0, 90.0, 60.0, 20.0, 40.0, 30.0, 370.0, 70.0, 70.0, 170.0, 0.0, 20.0, 20.0, 40.0, 30.0, 20.0, 0.0, 30.0, 20.0, 0.0, 20.0, 20.0, 60.0, 270.0, 40.0, 40.0, 60.0, 180.0, 0.0, 60.0, 40.0, 10.0, -40.0, 360.0, 10.0, 15.0, 60.0, 20.0, 200.0, 30.0, 0.0, 20.0, 10.0, 50.0, 400.0, 50.0, 10.0, 20.0, 60.0, 70.0, 10.0, 0.0, 10.0, 40.0, 40.0, 0.0, 0.0, 70.0, 40.0, 0.0, 20.0, 250.0, 10.0, -20.0, 70.0, 0.0, 480.0, 10.0, 20.0, 0.0, 0.0, 40.0, 60.0, 50.0, 20.0, 20.0, 270.0, 50.0, 380.0, 10.0, 90.0, 30.0, 560.0, 50.0, 50.0, -10.0, 10.0, 110.0, 10.0, 80.0, 160.0, 30.0, 40.0, 10.0, 40.0, 10.0, 20.0, 0.0, 60.0, 0.0, 40.0, 0.0, 20.0, 20.0, 100.0, 120.0, 0.0, 10.0, 10.0, 40.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 260.0, 0.0, 50.0, 70.0, -210.0, 20.0, 10.0, 50.0, 20.0, 10.0, 0.0, 30.0, 90.0, 0.0, 40.0, 30.0, 0.0, 30.0, 0.0, 0.0, 0.0, 20.0, 10.0, 50.0, 40.0, 20.0, 70.0, 60.0, 360.0, 0.0, 40.0, 170.0, 10.0, 60.0, 10.0, 0.0, 70.0, 30.0, 30.0, 0.0, 0.0, 20.0, 110.0, 30.0, 0.0, 70.0, 40.0, 190.0, 250.0, 260.0, 20.0, 20.0, 30.0, 30.0, 10.0, 40.0, 205.0, 480.0, 190.0, 10.0, 50.0, 5.0, 30.0, 180.0, 30.0, 0.0, 150.0, 15.0, 20.0, 20.0, 90.0, 10.0, 30.0, 70.0, 10.0, 0.0, 20.0, 80.0, 20.0, 0.0, 10.0, 0.0, 40.0, 60.0, 10.0, 50.0, 40.0, 30.0, 40.0, 370.0, 35.0, 160.0, 30.0, 0.0, 100.0, 60.0, 0.0, 0.0, 40.0, 20.0, 0.0, 0.0, 20.0, 200.0, 150.0, 50.0, 30.0, 0.0, 40.0, 40.0, 260.0, 30.0, 30.0, 60.0, 40.0, 80.0, 60.0, 60.0, 20.0, 0.0, 30.0, 40.0, 40.0, 30.0, 40.0, 30.0, 10.0, 150.0, 10.0, 10.0, 50.0, 380.0, 30.0, 70.0, 40.0, 90.0, 10.0, 160.0, 250.0, 30.0, 20.0, 20.0, 70.0, 30.0, 40.0, 50.0, 20.0, 30.0, 0.0, 0.0, 170.0, 0.0, 30.0, 0.0, 20.0, 90.0, 10.0, 0.0, 40.0, 0.0, 10.0, 30.0, 30.0, 30.0, 40.0, 40.0, 0.0, 30.0, 30.0, 60.0, 70.0, 40.0, 40.0, 90.0, 20.0, -10.0, 40.0, 10.0, 370.0, 60.0, -40.0, 20.0, 30.0, 270.0, -50.0, 20.0, 0.0, 0.0, 30.0, 30.0, 30.0, 30.0, 270.0, 30.0, 40.0, 0.0, 20.0, 0.0, 80.0, 30.0, 50.0, 10.0, 10.0, 0.0, 270.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4041861709995949, "mean_inference_ms": 1.604005628078703, "mean_action_processing_ms": 0.41738353013415236, "mean_env_wait_ms": 1.2920455837653153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.057968854904174805, "StateBufferConnector_ms": 0.009499311447143555, "ViewRequirementAgentConnector_ms": 0.36911869049072266}, "num_episodes": 18, "episode_return_max": 1740.0, "episode_return_min": 100.0, "episode_return_mean": 596.85}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.2140273221292, "num_env_steps_trained_throughput_per_sec": 36.2140273221292, "timesteps_total": 592000, "num_env_steps_sampled_lifetime": 592000, "num_agent_steps_sampled_lifetime": 5920000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5920000, "timers": {"training_iteration_time_ms": 110733.667, "restore_workers_time_ms": 0.012, "training_step_time_ms": 110733.619, "sample_time_ms": 2417.002, "learn_time_ms": 108296.251, "learn_throughput": 36.936, "synch_weights_time_ms": 12.284}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 5920000, "num_agent_steps_trained": 5920000}, "done": false, "training_iteration": 148, "trial_id": "57140_00000", "date": "2024-06-27_03-51-59", "timestamp": 1719474719, "time_this_iter_s": 110.46972489356995, "time_total_s": 16643.349259614944, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b23e4dc0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16643.349259614944, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 15.511538461538462, "ram_util_percent": 78.93141025641026}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6858464312216979, "cur_kl_coeff": 5.700780453211512, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0016329488271194746, "vf_loss": 4.0712728696890155, "vf_explained_var": 0.00019713428835518444, "kl": Infinity, "entropy": 0.33043467920428266, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1394415.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000}, "env_runners": {"episode_reward_max": 1740.0, "episode_reward_min": -1050.0, "episode_reward_mean": 598.7, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 23, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -1700.0}, "policy_reward_max": {"policy_0": 720.0}, "policy_reward_mean": {"policy_0": 59.87}, "custom_metrics": {}, "hist_stats": {"episode_reward": [180.0, 1650.0, 490.0, 770.0, 1070.0, 310.0, 340.0, 760.0, 550.0, 1100.0, 460.0, 660.0, 570.0, 590.0, 200.0, 590.0, 730.0, 410.0, 390.0, 380.0, 560.0, 570.0, 940.0, 870.0, 1150.0, 1190.0, 660.0, 445.0, 650.0, 740.0, 390.0, 1020.0, 835.0, 1060.0, 670.0, 510.0, 220.0, 630.0, 380.0, 340.0, 260.0, 1740.0, 270.0, 880.0, 160.0, 920.0, 200.0, 770.0, 665.0, 700.0, 220.0, 820.0, 990.0, 1050.0, 250.0, 330.0, 210.0, 270.0, 180.0, 800.0, 290.0, 920.0, 1220.0, 415.0, 240.0, 855.0, 490.0, 580.0, 400.0, 780.0, 720.0, 320.0, 280.0, 420.0, 700.0, 480.0, 470.0, 460.0, 510.0, 720.0, 1070.0, 280.0, 870.0, 1310.0, -1050.0, 770.0, 540.0, 800.0, 470.0, 560.0, 670.0, 885.0, 160.0, 630.0, 195.0, 280.0, 690.0, 420.0, 1045.0, 290.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [0.0, 0.0, 0.0, 40.0, 40.0, 10.0, 30.0, 30.0, 20.0, 10.0, 30.0, 30.0, 160.0, 110.0, 60.0, 720.0, 170.0, 80.0, 310.0, -20.0, -50.0, 40.0, 370.0, 10.0, 0.0, 30.0, -10.0, 40.0, 20.0, 40.0, 0.0, 60.0, 160.0, 80.0, 100.0, 10.0, 180.0, 0.0, 10.0, 170.0, 110.0, 80.0, 120.0, 20.0, 90.0, 220.0, 90.0, 120.0, 30.0, 190.0, 30.0, 0.0, 0.0, 30.0, 10.0, 170.0, 30.0, 10.0, 20.0, 10.0, 30.0, 150.0, 10.0, 10.0, 50.0, 10.0, 40.0, 10.0, 0.0, 30.0, 20.0, 150.0, 120.0, 300.0, 10.0, 0.0, 20.0, 40.0, 80.0, 20.0, 20.0, 80.0, 0.0, 260.0, 40.0, 10.0, -30.0, 90.0, 60.0, 20.0, 50.0, 30.0, 100.0, 30.0, 310.0, 40.0, 70.0, 380.0, 70.0, 20.0, 40.0, 170.0, 20.0, 40.0, 0.0, 70.0, 20.0, 30.0, 30.0, 40.0, 10.0, 0.0, 180.0, 30.0, 50.0, 20.0, 70.0, 40.0, 100.0, 160.0, -20.0, 30.0, 360.0, 70.0, 0.0, 0.0, 40.0, 30.0, 20.0, 40.0, 0.0, 10.0, 20.0, 20.0, 20.0, 260.0, 50.0, 30.0, 160.0, 20.0, 10.0, 50.0, 20.0, 30.0, 40.0, 0.0, 0.0, 40.0, 0.0, 10.0, 10.0, 60.0, 40.0, 40.0, 0.0, 0.0, 130.0, 290.0, 0.0, 20.0, 70.0, 40.0, 80.0, 40.0, 10.0, 270.0, 10.0, 0.0, 110.0, 100.0, 30.0, 30.0, 40.0, 10.0, 20.0, 0.0, 220.0, 40.0, 0.0, 20.0, -70.0, 20.0, 20.0, 150.0, 50.0, 0.0, 30.0, 0.0, 170.0, 20.0, 20.0, 0.0, 70.0, 10.0, 0.0, 30.0, 10.0, 10.0, 70.0, 160.0, 0.0, 210.0, 80.0, 60.0, 40.0, 70.0, 40.0, 40.0, 0.0, 20.0, 10.0, 170.0, 40.0, 30.0, 30.0, 50.0, 60.0, 160.0, 0.0, 20.0, 80.0, 20.0, 10.0, 0.0, 460.0, 20.0, 160.0, 90.0, 40.0, 60.0, 10.0, 180.0, 350.0, 30.0, 30.0, 140.0, 30.0, 20.0, 40.0, 40.0, 270.0, 30.0, 60.0, 70.0, 30.0, 30.0, 70.0, 370.0, 40.0, 180.0, 30.0, 170.0, 120.0, 20.0, 50.0, 30.0, 10.0, 360.0, 150.0, 250.0, 20.0, 50.0, 50.0, 90.0, 0.0, 270.0, 60.0, 20.0, 40.0, 60.0, 10.0, 50.0, 10.0, 10.0, 50.0, 160.0, 0.0, 30.0, 10.0, 115.0, 60.0, 20.0, 55.0, 95.0, 70.0, 70.0, 160.0, 180.0, -130.0, 70.0, 280.0, 170.0, 60.0, 30.0, 40.0, 60.0, 30.0, 20.0, 10.0, 40.0, 20.0, 30.0, 10.0, 40.0, 10.0, 80.0, 30.0, 40.0, 100.0, 30.0, 510.0, 120.0, 50.0, 30.0, 90.0, 60.0, 10.0, 60.0, 40.0, 50.0, 300.0, 100.0, 20.0, 70.0, 40.0, 0.0, 30.0, 60.0, 15.0, 200.0, -40.0, 40.0, 90.0, 140.0, 20.0, 520.0, 70.0, 170.0, 40.0, 10.0, 20.0, 0.0, 40.0, 20.0, 380.0, 10.0, 0.0, 160.0, 30.0, 10.0, 80.0, 180.0, 40.0, 70.0, 70.0, 30.0, 10.0, 0.0, 30.0, 0.0, 40.0, 40.0, 10.0, 40.0, 20.0, 0.0, 0.0, 40.0, 0.0, 30.0, 150.0, 50.0, 30.0, 210.0, 60.0, 10.0, 40.0, 20.0, 30.0, 30.0, 60.0, 90.0, 20.0, 30.0, 40.0, 40.0, 80.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 60.0, 10.0, 70.0, 40.0, 110.0, 10.0, 30.0, 30.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 90.0, 0.0, 40.0, 170.0, 30.0, 200.0, 40.0, 80.0, 70.0, 250.0, 310.0, 580.0, 10.0, 10.0, 30.0, -30.0, 0.0, 0.0, 0.0, 0.0, 210.0, 30.0, 20.0, 30.0, 70.0, 0.0, 170.0, 20.0, 10.0, 10.0, 10.0, 250.0, 310.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 40.0, 20.0, 40.0, 90.0, 60.0, 20.0, 40.0, 30.0, 370.0, 70.0, 70.0, 170.0, 0.0, 20.0, 20.0, 40.0, 30.0, 20.0, 0.0, 30.0, 20.0, 0.0, 20.0, 20.0, 60.0, 270.0, 40.0, 40.0, 60.0, 180.0, 0.0, 60.0, 40.0, 10.0, -40.0, 360.0, 10.0, 15.0, 60.0, 20.0, 200.0, 30.0, 0.0, 20.0, 10.0, 50.0, 400.0, 50.0, 10.0, 20.0, 60.0, 70.0, 10.0, 0.0, 10.0, 40.0, 40.0, 0.0, 0.0, 70.0, 40.0, 0.0, 20.0, 250.0, 10.0, -20.0, 70.0, 0.0, 480.0, 10.0, 20.0, 0.0, 0.0, 40.0, 60.0, 50.0, 20.0, 20.0, 270.0, 50.0, 380.0, 10.0, 90.0, 30.0, 560.0, 50.0, 50.0, -10.0, 10.0, 110.0, 10.0, 80.0, 160.0, 30.0, 40.0, 10.0, 40.0, 10.0, 20.0, 0.0, 60.0, 0.0, 40.0, 0.0, 20.0, 20.0, 100.0, 120.0, 0.0, 10.0, 10.0, 40.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 260.0, 0.0, 50.0, 70.0, -210.0, 20.0, 10.0, 50.0, 20.0, 10.0, 0.0, 30.0, 90.0, 0.0, 40.0, 30.0, 0.0, 30.0, 0.0, 0.0, 0.0, 20.0, 10.0, 50.0, 40.0, 20.0, 70.0, 60.0, 360.0, 0.0, 40.0, 170.0, 10.0, 60.0, 10.0, 0.0, 70.0, 30.0, 30.0, 0.0, 0.0, 20.0, 110.0, 30.0, 0.0, 70.0, 40.0, 190.0, 250.0, 260.0, 20.0, 20.0, 30.0, 30.0, 10.0, 40.0, 205.0, 480.0, 190.0, 10.0, 50.0, 5.0, 30.0, 180.0, 30.0, 0.0, 150.0, 15.0, 20.0, 20.0, 90.0, 10.0, 30.0, 70.0, 10.0, 0.0, 20.0, 80.0, 20.0, 0.0, 10.0, 0.0, 40.0, 60.0, 10.0, 50.0, 40.0, 30.0, 40.0, 370.0, 35.0, 160.0, 30.0, 0.0, 100.0, 60.0, 0.0, 0.0, 40.0, 20.0, 0.0, 0.0, 20.0, 200.0, 150.0, 50.0, 30.0, 0.0, 40.0, 40.0, 260.0, 30.0, 30.0, 60.0, 40.0, 80.0, 60.0, 60.0, 20.0, 0.0, 30.0, 40.0, 40.0, 30.0, 40.0, 30.0, 10.0, 150.0, 10.0, 10.0, 50.0, 380.0, 30.0, 70.0, 40.0, 90.0, 10.0, 160.0, 250.0, 30.0, 20.0, 20.0, 70.0, 30.0, 40.0, 50.0, 20.0, 30.0, 0.0, 0.0, 170.0, 0.0, 30.0, 0.0, 20.0, 90.0, 10.0, 0.0, 40.0, 0.0, 10.0, 30.0, 30.0, 30.0, 40.0, 40.0, 0.0, 30.0, 30.0, 60.0, 70.0, 40.0, 40.0, 90.0, 20.0, -10.0, 40.0, 10.0, 370.0, 60.0, -40.0, 20.0, 30.0, 270.0, -50.0, 20.0, 0.0, 0.0, 30.0, 30.0, 30.0, 30.0, 270.0, 30.0, 40.0, 0.0, 20.0, 0.0, 80.0, 30.0, 50.0, 10.0, 10.0, 0.0, 270.0, 10.0, 190.0, 40.0, 30.0, 30.0, 20.0, 0.0, 30.0, 100.0, 10.0, 350.0, 0.0, 20.0, 30.0, 50.0, 0.0, 0.0, 20.0, 0.0, 40.0, 510.0, 0.0, 10.0, 10.0, 20.0, 70.0, 10.0, 40.0, 20.0, 30.0, 30.0, 30.0, 0.0, 120.0, 20.0, 30.0, 110.0, 680.0, 20.0, 30.0, 30.0, 60.0, -50.0, 10.0, 60.0, 0.0, 10.0, 0.0, 160.0, 0.0, 50.0, 70.0, 30.0, 30.0, 100.0, 10.0, 480.0, 80.0, 20.0, 0.0, 20.0, 100.0, 200.0, 40.0, 50.0, 50.0, 580.0, 90.0, 100.0, 80.0, 120.0, 30.0, 10.0, -1700.0, 70.0, 60.0, 10.0, 210.0, 110.0, 30.0, 30.0, 10.0, 30.0, 30.0, 210.0, 30.0, 20.0, 400.0, 0.0, 10.0, 30.0, 40.0, 0.0, 30.0, 280.0, 20.0, 80.0, 10.0, 0.0, 50.0, 0.0, 40.0, 50.0, 20.0, 20.0, 650.0, 10.0, 0.0, 10.0, 0.0, 170.0, 40.0, 60.0, 0.0, 20.0, 30.0, 20.0, 90.0, 10.0, 30.0, 20.0, 0.0, 30.0, 380.0, 40.0, 0.0, 40.0, 50.0, 0.0, 0.0, 40.0, 20.0, 0.0, 70.0, 180.0, 220.0, 60.0, 40.0, -30.0, 70.0, 20.0, 90.0, 60.0, 15.0, 50.0, 70.0, 20.0, 490.0, 50.0, 20.0, 30.0, 0.0, 30.0, 0.0, 40.0, 0.0, 20.0, 30.0, 0.0, 10.0, 270.0, 50.0, 20.0, 80.0, 110.0, 40.0, 10.0, 50.0, 0.0, 0.0, 40.0, 20.0, 20.0, 30.0, 10.0, 0.0, 20.0, 20.0, 5.0, 30.0, 40.0, 80.0, 40.0, 30.0, -20.0, -50.0, 20.0, 10.0, 70.0, 60.0, 20.0, 40.0, 40.0, 40.0, 360.0, 10.0, 10.0, 60.0, 60.0, 50.0, 10.0, 0.0, 50.0, 40.0, 20.0, 20.0, 0.0, 70.0, 60.0, 150.0, 50.0, 90.0, 150.0, 470.0, 60.0, 5.0, 0.0, 60.0, 90.0, 70.0, 20.0, 70.0, 0.0, 40.0, 10.0, 0.0, 0.0, 150.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4035503906393347, "mean_inference_ms": 1.6037147887188032, "mean_action_processing_ms": 0.4172153760791693, "mean_env_wait_ms": 1.2917799680509612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.05531024932861328, "StateBufferConnector_ms": 0.01530313491821289, "ViewRequirementAgentConnector_ms": 0.3714451789855957}, "num_episodes": 23, "episode_return_max": 1740.0, "episode_return_min": -1050.0, "episode_return_mean": 598.7}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 36.11606799215515, "num_env_steps_trained_throughput_per_sec": 36.11606799215515, "timesteps_total": 596000, "num_env_steps_sampled_lifetime": 596000, "num_agent_steps_sampled_lifetime": 5960000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 5960000, "timers": {"training_iteration_time_ms": 110734.245, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110734.197, "sample_time_ms": 2417.406, "learn_time_ms": 108296.252, "learn_throughput": 36.936, "synch_weights_time_ms": 12.579}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 5960000, "num_agent_steps_trained": 5960000}, "done": false, "training_iteration": 149, "trial_id": "57140_00000", "date": "2024-06-27_03-53-49", "timestamp": 1719474829, "time_this_iter_s": 110.76885199546814, "time_total_s": 16754.118111610413, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b257fee0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16754.118111610413, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 16.07707006369427, "ram_util_percent": 78.6312101910828}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.99024519225279, "cur_kl_coeff": 8.551170679817265, "cur_lr": 5.0000000000000016e-05, "total_loss": Infinity, "policy_loss": -0.0023443162570934628, "vf_loss": 4.485721490634516, "vf_explained_var": 0.00032070633956291677, "kl": Infinity, "entropy": 0.35065964035237557, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 127.79552715654953, "num_grad_updates_lifetime": 1403805.5, "diff_num_grad_updates_vs_sampler_policy": 4694.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000}, "env_runners": {"episode_reward_max": 1740.0, "episode_reward_min": -1050.0, "episode_reward_mean": 591.1, "episode_len_mean": 201.0, "episode_media": {}, "episodes_this_iter": 22, "episodes_timesteps_total": 20100, "policy_reward_min": {"policy_0": -1700.0}, "policy_reward_max": {"policy_0": 680.0}, "policy_reward_mean": {"policy_0": 59.11}, "custom_metrics": {}, "hist_stats": {"episode_reward": [940.0, 870.0, 1150.0, 1190.0, 660.0, 445.0, 650.0, 740.0, 390.0, 1020.0, 835.0, 1060.0, 670.0, 510.0, 220.0, 630.0, 380.0, 340.0, 260.0, 1740.0, 270.0, 880.0, 160.0, 920.0, 200.0, 770.0, 665.0, 700.0, 220.0, 820.0, 990.0, 1050.0, 250.0, 330.0, 210.0, 270.0, 180.0, 800.0, 290.0, 920.0, 1220.0, 415.0, 240.0, 855.0, 490.0, 580.0, 400.0, 780.0, 720.0, 320.0, 280.0, 420.0, 700.0, 480.0, 470.0, 460.0, 510.0, 720.0, 1070.0, 280.0, 870.0, 1310.0, -1050.0, 770.0, 540.0, 800.0, 470.0, 560.0, 670.0, 885.0, 160.0, 630.0, 195.0, 280.0, 690.0, 420.0, 1045.0, 290.0, 400.0, 690.0, 510.0, 310.0, 500.0, 370.0, 640.0, 185.0, 830.0, 250.0, 555.0, 1030.0, 555.0, 845.0, 470.0, 230.0, 680.0, 390.0, 1020.0, 1380.0, 260.0, 470.0], "episode_lengths": [201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201, 201], "policy_policy_0_reward": [80.0, 20.0, 10.0, 0.0, 460.0, 20.0, 160.0, 90.0, 40.0, 60.0, 10.0, 180.0, 350.0, 30.0, 30.0, 140.0, 30.0, 20.0, 40.0, 40.0, 270.0, 30.0, 60.0, 70.0, 30.0, 30.0, 70.0, 370.0, 40.0, 180.0, 30.0, 170.0, 120.0, 20.0, 50.0, 30.0, 10.0, 360.0, 150.0, 250.0, 20.0, 50.0, 50.0, 90.0, 0.0, 270.0, 60.0, 20.0, 40.0, 60.0, 10.0, 50.0, 10.0, 10.0, 50.0, 160.0, 0.0, 30.0, 10.0, 115.0, 60.0, 20.0, 55.0, 95.0, 70.0, 70.0, 160.0, 180.0, -130.0, 70.0, 280.0, 170.0, 60.0, 30.0, 40.0, 60.0, 30.0, 20.0, 10.0, 40.0, 20.0, 30.0, 10.0, 40.0, 10.0, 80.0, 30.0, 40.0, 100.0, 30.0, 510.0, 120.0, 50.0, 30.0, 90.0, 60.0, 10.0, 60.0, 40.0, 50.0, 300.0, 100.0, 20.0, 70.0, 40.0, 0.0, 30.0, 60.0, 15.0, 200.0, -40.0, 40.0, 90.0, 140.0, 20.0, 520.0, 70.0, 170.0, 40.0, 10.0, 20.0, 0.0, 40.0, 20.0, 380.0, 10.0, 0.0, 160.0, 30.0, 10.0, 80.0, 180.0, 40.0, 70.0, 70.0, 30.0, 10.0, 0.0, 30.0, 0.0, 40.0, 40.0, 10.0, 40.0, 20.0, 0.0, 0.0, 40.0, 0.0, 30.0, 150.0, 50.0, 30.0, 210.0, 60.0, 10.0, 40.0, 20.0, 30.0, 30.0, 60.0, 90.0, 20.0, 30.0, 40.0, 40.0, 80.0, 0.0, 0.0, 20.0, 10.0, 0.0, 0.0, 60.0, 10.0, 70.0, 40.0, 110.0, 10.0, 30.0, 30.0, 20.0, 20.0, 10.0, 10.0, 20.0, 20.0, 90.0, 0.0, 40.0, 170.0, 30.0, 200.0, 40.0, 80.0, 70.0, 250.0, 310.0, 580.0, 10.0, 10.0, 30.0, -30.0, 0.0, 0.0, 0.0, 0.0, 210.0, 30.0, 20.0, 30.0, 70.0, 0.0, 170.0, 20.0, 10.0, 10.0, 10.0, 250.0, 310.0, 0.0, 10.0, 0.0, 10.0, 0.0, 10.0, 30.0, 40.0, 20.0, 40.0, 90.0, 60.0, 20.0, 40.0, 30.0, 370.0, 70.0, 70.0, 170.0, 0.0, 20.0, 20.0, 40.0, 30.0, 20.0, 0.0, 30.0, 20.0, 0.0, 20.0, 20.0, 60.0, 270.0, 40.0, 40.0, 60.0, 180.0, 0.0, 60.0, 40.0, 10.0, -40.0, 360.0, 10.0, 15.0, 60.0, 20.0, 200.0, 30.0, 0.0, 20.0, 10.0, 50.0, 400.0, 50.0, 10.0, 20.0, 60.0, 70.0, 10.0, 0.0, 10.0, 40.0, 40.0, 0.0, 0.0, 70.0, 40.0, 0.0, 20.0, 250.0, 10.0, -20.0, 70.0, 0.0, 480.0, 10.0, 20.0, 0.0, 0.0, 40.0, 60.0, 50.0, 20.0, 20.0, 270.0, 50.0, 380.0, 10.0, 90.0, 30.0, 560.0, 50.0, 50.0, -10.0, 10.0, 110.0, 10.0, 80.0, 160.0, 30.0, 40.0, 10.0, 40.0, 10.0, 20.0, 0.0, 60.0, 0.0, 40.0, 0.0, 20.0, 20.0, 100.0, 120.0, 0.0, 10.0, 10.0, 40.0, 10.0, 20.0, 10.0, 10.0, 0.0, 0.0, 260.0, 0.0, 50.0, 70.0, -210.0, 20.0, 10.0, 50.0, 20.0, 10.0, 0.0, 30.0, 90.0, 0.0, 40.0, 30.0, 0.0, 30.0, 0.0, 0.0, 0.0, 20.0, 10.0, 50.0, 40.0, 20.0, 70.0, 60.0, 360.0, 0.0, 40.0, 170.0, 10.0, 60.0, 10.0, 0.0, 70.0, 30.0, 30.0, 0.0, 0.0, 20.0, 110.0, 30.0, 0.0, 70.0, 40.0, 190.0, 250.0, 260.0, 20.0, 20.0, 30.0, 30.0, 10.0, 40.0, 205.0, 480.0, 190.0, 10.0, 50.0, 5.0, 30.0, 180.0, 30.0, 0.0, 150.0, 15.0, 20.0, 20.0, 90.0, 10.0, 30.0, 70.0, 10.0, 0.0, 20.0, 80.0, 20.0, 0.0, 10.0, 0.0, 40.0, 60.0, 10.0, 50.0, 40.0, 30.0, 40.0, 370.0, 35.0, 160.0, 30.0, 0.0, 100.0, 60.0, 0.0, 0.0, 40.0, 20.0, 0.0, 0.0, 20.0, 200.0, 150.0, 50.0, 30.0, 0.0, 40.0, 40.0, 260.0, 30.0, 30.0, 60.0, 40.0, 80.0, 60.0, 60.0, 20.0, 0.0, 30.0, 40.0, 40.0, 30.0, 40.0, 30.0, 10.0, 150.0, 10.0, 10.0, 50.0, 380.0, 30.0, 70.0, 40.0, 90.0, 10.0, 160.0, 250.0, 30.0, 20.0, 20.0, 70.0, 30.0, 40.0, 50.0, 20.0, 30.0, 0.0, 0.0, 170.0, 0.0, 30.0, 0.0, 20.0, 90.0, 10.0, 0.0, 40.0, 0.0, 10.0, 30.0, 30.0, 30.0, 40.0, 40.0, 0.0, 30.0, 30.0, 60.0, 70.0, 40.0, 40.0, 90.0, 20.0, -10.0, 40.0, 10.0, 370.0, 60.0, -40.0, 20.0, 30.0, 270.0, -50.0, 20.0, 0.0, 0.0, 30.0, 30.0, 30.0, 30.0, 270.0, 30.0, 40.0, 0.0, 20.0, 0.0, 80.0, 30.0, 50.0, 10.0, 10.0, 0.0, 270.0, 10.0, 190.0, 40.0, 30.0, 30.0, 20.0, 0.0, 30.0, 100.0, 10.0, 350.0, 0.0, 20.0, 30.0, 50.0, 0.0, 0.0, 20.0, 0.0, 40.0, 510.0, 0.0, 10.0, 10.0, 20.0, 70.0, 10.0, 40.0, 20.0, 30.0, 30.0, 30.0, 0.0, 120.0, 20.0, 30.0, 110.0, 680.0, 20.0, 30.0, 30.0, 60.0, -50.0, 10.0, 60.0, 0.0, 10.0, 0.0, 160.0, 0.0, 50.0, 70.0, 30.0, 30.0, 100.0, 10.0, 480.0, 80.0, 20.0, 0.0, 20.0, 100.0, 200.0, 40.0, 50.0, 50.0, 580.0, 90.0, 100.0, 80.0, 120.0, 30.0, 10.0, -1700.0, 70.0, 60.0, 10.0, 210.0, 110.0, 30.0, 30.0, 10.0, 30.0, 30.0, 210.0, 30.0, 20.0, 400.0, 0.0, 10.0, 30.0, 40.0, 0.0, 30.0, 280.0, 20.0, 80.0, 10.0, 0.0, 50.0, 0.0, 40.0, 50.0, 20.0, 20.0, 650.0, 10.0, 0.0, 10.0, 0.0, 170.0, 40.0, 60.0, 0.0, 20.0, 30.0, 20.0, 90.0, 10.0, 30.0, 20.0, 0.0, 30.0, 380.0, 40.0, 0.0, 40.0, 50.0, 0.0, 0.0, 40.0, 20.0, 0.0, 70.0, 180.0, 220.0, 60.0, 40.0, -30.0, 70.0, 20.0, 90.0, 60.0, 15.0, 50.0, 70.0, 20.0, 490.0, 50.0, 20.0, 30.0, 0.0, 30.0, 0.0, 40.0, 0.0, 20.0, 30.0, 0.0, 10.0, 270.0, 50.0, 20.0, 80.0, 110.0, 40.0, 10.0, 50.0, 0.0, 0.0, 40.0, 20.0, 20.0, 30.0, 10.0, 0.0, 20.0, 20.0, 5.0, 30.0, 40.0, 80.0, 40.0, 30.0, -20.0, -50.0, 20.0, 10.0, 70.0, 60.0, 20.0, 40.0, 40.0, 40.0, 360.0, 10.0, 10.0, 60.0, 60.0, 50.0, 10.0, 0.0, 50.0, 40.0, 20.0, 20.0, 0.0, 70.0, 60.0, 150.0, 50.0, 90.0, 150.0, 470.0, 60.0, 5.0, 0.0, 60.0, 90.0, 70.0, 20.0, 70.0, 0.0, 40.0, 10.0, 0.0, 0.0, 150.0, 0.0, 0.0, 0.0, 30.0, 20.0, 20.0, 10.0, 80.0, 20.0, 40.0, 20.0, 160.0, 30.0, 150.0, 40.0, 40.0, 0.0, 0.0, 10.0, 80.0, 30.0, 310.0, 30.0, 80.0, 90.0, 10.0, 30.0, 10.0, 90.0, 110.0, 30.0, 30.0, 10.0, 20.0, 40.0, 50.0, 0.0, 90.0, 40.0, 0.0, 40.0, 20.0, 0.0, 30.0, 0.0, 170.0, 30.0, 0.0, 160.0, 40.0, 0.0, 70.0, 20.0, 130.0, 30.0, 30.0, 30.0, 10.0, 40.0, 0.0, 40.0, 40.0, 30.0, 120.0, 130.0, 20.0, 30.0, 80.0, 0.0, 170.0, 10.0, 50.0, 20.0, 10.0, 30.0, 10.0, 20.0, 50.0, 0.0, 20.0, 40.0, -15.0, 570.0, 30.0, 50.0, 30.0, 160.0, 10.0, 40.0, -10.0, -80.0, 30.0, 20.0, 40.0, 40.0, 30.0, 40.0, 40.0, 10.0, 0.0, 20.0, 10.0, 280.0, 0.0, 30.0, 70.0, 80.0, 20.0, 30.0, 20.0, 30.0, -5.0, 30.0, 200.0, 380.0, 60.0, 50.0, 50.0, 190.0, 20.0, 10.0, 40.0, 170.0, 40.0, 200.0, 20.0, 10.0, 30.0, 40.0, 5.0, 40.0, 0.0, 40.0, 60.0, 260.0, 70.0, 55.0, 70.0, 0.0, 20.0, 260.0, 10.0, 30.0, 0.0, 30.0, 0.0, 0.0, 80.0, 30.0, 250.0, 20.0, 30.0, 10.0, 60.0, 40.0, 10.0, 40.0, 10.0, 10.0, 10.0, 20.0, 20.0, 0.0, 150.0, 30.0, 120.0, 20.0, 30.0, 200.0, 30.0, 80.0, 20.0, 10.0, 70.0, 20.0, -20.0, 30.0, 10.0, 20.0, 160.0, 60.0, 30.0, 280.0, 50.0, 20.0, 60.0, 20.0, 40.0, 280.0, 40.0, 160.0, 70.0, 50.0, 560.0, 40.0, 40.0, 70.0, 160.0, 360.0, 10.0, 60.0, 30.0, 30.0, 10.0, 60.0, 10.0, 0.0, 50.0, 0.0, 0.0, 40.0, 60.0, 0.0, 50.0, 0.0, 60.0, 30.0, 230.0, 30.0, 30.0, 50.0, -10.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 1.4030614659890954, "mean_inference_ms": 1.6034962415765848, "mean_action_processing_ms": 0.417047145238503, "mean_env_wait_ms": 1.2915250823904512, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0554354190826416, "StateBufferConnector_ms": 0.015226125717163086, "ViewRequirementAgentConnector_ms": 0.378448486328125}, "num_episodes": 22, "episode_return_max": 1740.0, "episode_return_min": -1050.0, "episode_return_mean": 591.1}, "num_healthy_workers": 9, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 35.58233178446528, "num_env_steps_trained_throughput_per_sec": 35.58233178446528, "timesteps_total": 600000, "num_env_steps_sampled_lifetime": 600000, "num_agent_steps_sampled_lifetime": 6000000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 6000000, "timers": {"training_iteration_time_ms": 110875.125, "restore_workers_time_ms": 0.013, "training_step_time_ms": 110875.078, "sample_time_ms": 2421.454, "learn_time_ms": 108433.491, "learn_throughput": 36.889, "synch_weights_time_ms": 12.305}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 6000000, "num_agent_steps_trained": 6000000}, "done": true, "training_iteration": 150, "trial_id": "57140_00000", "date": "2024-06-27_03-55-42", "timestamp": 1719474942, "time_this_iter_s": 112.42804098129272, "time_total_s": 16866.546152591705, "pid": 61897, "hostname": "Joys-MacBook-Pro.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 0, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "aot_eager", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "aot_eager", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "EvolutionEnv", "env_config": {"num_agents": 10, "render_mode": "None", "human_player": false, "map_size": 50, "grid_size": 24, "food_count": 20, "fps": 120, "food_size": 1, "player_size": 1, "size_increase": 0.25, "player_speed": 0.5, "max_speed": 1, "max_boost": 10, "decay_rate": 0.001, "episode_length": 200, "scale": 10, "food_reward": 10, "kill_reward": 100, "kill_penalty": 50, "wall_penalty": 5}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.99, "lr": 5e-05, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": [[16, [3, 3], 2], [32, [3, 3], 3], [32, [3, 3], 3]], "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function main.<locals>.<lambda> at 0x3b18e1af0>", "policies_to_train": null, "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": "stdout", "__stderr_file__": "stderr", "lambda": 1.0, "input": "sampler", "policies": {"policy_0": [null, "Dict('boost_info': Box(0.0, 1.0, (1,), float32), 'visual': Box(0.0, 1.0, (24, 24, 3), float32))", "Discrete(5)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 9, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 16866.546152591705, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 18.633962264150945, "ram_util_percent": 78.89811320754717}}
